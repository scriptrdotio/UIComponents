function kvLookup(a,b,c,d,e,f){var g=d,h=!1;if(null!==a&&void 0!==a&&(null!==c&&void 0!==c&&"object"==typeof c&&a in c?(g=c[a],h=!0):null!==b&&void 0!==b&&"object"==typeof b&&a in b?(g=b[a],h=!0):g=d,!0===h&&null!==e&&void 0!==e))switch(e){case"int":g=parseInt(g,10);break;case"float":g=parseFloat(g)}return g}function getColor(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,d=d||e.length>0;if(e.length>0)for(var t=0;t<e.length;t++)if(a>e[t].lo&&a<=e[t].hi)return e[t].color;if(1===(f=c.length))return c[0];for(g=d?1/f:1/(f-1),h=[],t=0;t<c.length;t++)i=d?g*(t+1):g*t,j=parseInt(cutHex(c[t]).substring(0,2),16),k=parseInt(cutHex(c[t]).substring(2,4),16),l=parseInt(cutHex(c[t]).substring(4,6),16),h[t]={pct:i,color:{r:j,g:k,b:l}};if(0===b)return"rgb("+[h[0].color.r,h[0].color.g,h[0].color.b].join(",")+")";for(var u=0;u<h.length;u++)if(b<=h[u].pct)return d?"rgb("+[h[u].color.r,h[u].color.g,h[u].color.b].join(",")+")":(m=h[u-1],n=h[u],o=n.pct-m.pct,p=(b-m.pct)/o,q=1-p,r=p,s={r:Math.floor(m.color.r*q+n.color.r*r),g:Math.floor(m.color.g*q+n.color.g*r),b:Math.floor(m.color.b*q+n.color.b*r)},"rgb("+[s.r,s.g,s.b].join(",")+")")}function setDy(a,b,c){(!ie||ie>9)&&a.node.firstChild.attributes.dy&&(a.node.firstChild.attributes.dy.value=0)}function getRandomInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}function cutHex(a){return"#"==a.charAt(0)?a.substring(1,7):a}function humanFriendlyNumber(a,b){var c,d,e,f;for(c=Math.pow,d=c(10,b),e=7;e;)f=c(10,3*e--),a>=f&&(a=Math.round(a*d/f)/d+"KMGTPE"[e]);return a}function formatNumber(a){var b=a.toString().split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")}function getStyle(a,b){var c="";return document.defaultView&&document.defaultView.getComputedStyle?c=document.defaultView.getComputedStyle(a,"").getPropertyValue(b):a.currentStyle&&(b=b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),c=a.currentStyle[b]),c}function onCreateElementNsReady(a){void 0!==document.createElementNS?a():setTimeout(function(){onCreateElementNsReady(a)},100)}function extend(a){a=a||{};for(var b=1;b<arguments.length;b++)if(arguments[b])for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&(a[c]=arguments[b][c]);return a}(function(){function a(a){function b(b,c,d,e,f,g){for(;f>=0&&g>f;f+=a){var h=e?e[f]:f;d=c(d,b[h],h,b)}return d}return function(c,d,e,f){d=t(d,f,4);var g=!A(c)&&s.keys(c),h=(g||c).length,i=a>0?0:h-1;return arguments.length<3&&(e=c[g?g[i]:i],i+=a),b(c,d,e,g,i,h)}}function b(a){return function(b,c,d){c=u(c,d);for(var e=z(b),f=a>0?0:e-1;f>=0&&e>f;f+=a)if(c(b[f],f,b))return f;return-1}}function c(a,b,c){return function(d,e,f){var g=0,h=z(d);if("number"==typeof f)a>0?g=f>=0?f:Math.max(f+h,g):h=f>=0?Math.min(f+1,h):f+h+1;else if(c&&f&&h)return f=c(d,e),d[f]===e?f:-1;if(e!==e)return f=b(k.call(d,g,h),s.isNaN),f>=0?f+g:-1;for(f=a>0?g:h-1;f>=0&&h>f;f+=a)if(d[f]===e)return f;return-1}}function d(a,b){var c=F.length,d=a.constructor,e=s.isFunction(d)&&d.prototype||h,f="constructor";for(s.has(a,f)&&!s.contains(b,f)&&b.push(f);c--;)(f=F[c])in a&&a[f]!==e[f]&&!s.contains(b,f)&&b.push(f)}var e=this,f=e._,g=Array.prototype,h=Object.prototype,i=Function.prototype,j=g.push,k=g.slice,l=h.toString,m=h.hasOwnProperty,n=Array.isArray,o=Object.keys,p=i.bind,q=Object.create,r=function(){},s=function(a){return a instanceof s?a:this instanceof s?void(this._wrapped=a):new s(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=s),exports._=s):e._=s,s.VERSION="1.8.3";var t=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},u=function(a,b,c){return null==a?s.identity:s.isFunction(a)?t(a,b,c):s.isObject(a)?s.matcher(a):s.property(a)};s.iteratee=function(a,b){return u(a,b,1/0)};var v=function(a,b){return function(c){var d=arguments.length;if(2>d||null==c)return c;for(var e=1;d>e;e++)for(var f=arguments[e],g=a(f),h=g.length,i=0;h>i;i++){var j=g[i];b&&void 0!==c[j]||(c[j]=f[j])}return c}},w=function(a){if(!s.isObject(a))return{};if(q)return q(a);r.prototype=a;var b=new r;return r.prototype=null,b},x=function(a){return function(b){return null==b?void 0:b[a]}},y=Math.pow(2,53)-1,z=x("length"),A=function(a){var b=z(a);return"number"==typeof b&&b>=0&&y>=b};s.each=s.forEach=function(a,b,c){b=t(b,c);var d,e;if(A(a))for(d=0,e=a.length;e>d;d++)b(a[d],d,a);else{var f=s.keys(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a},s.map=s.collect=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=Array(e),g=0;e>g;g++){var h=d?d[g]:g;f[g]=b(a[h],h,a)}return f},s.reduce=s.foldl=s.inject=a(1),s.reduceRight=s.foldr=a(-1),s.find=s.detect=function(a,b,c){var d;return d=A(a)?s.findIndex(a,b,c):s.findKey(a,b,c),void 0!==d&&-1!==d?a[d]:void 0},s.filter=s.select=function(a,b,c){var d=[];return b=u(b,c),s.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d},s.reject=function(a,b,c){return s.filter(a,s.negate(u(b)),c)},s.every=s.all=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(!b(a[g],g,a))return!1}return!0},s.some=s.any=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(b(a[g],g,a))return!0}return!1},s.contains=s.includes=s.include=function(a,b,c,d){return A(a)||(a=s.values(a)),("number"!=typeof c||d)&&(c=0),s.indexOf(a,b,c)>=0},s.invoke=function(a,b){var c=k.call(arguments,2),d=s.isFunction(b);return s.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})},s.pluck=function(a,b){return s.map(a,s.property(b))},s.where=function(a,b){return s.filter(a,s.matcher(b))},s.findWhere=function(a,b){return s.find(a,s.matcher(b))},s.max=function(a,b,c){var d,e,f=-1/0,g=-1/0;if(null==b&&null!=a){a=A(a)?a:s.values(a);for(var h=0,i=a.length;i>h;h++)(d=a[h])>f&&(f=d)}else b=u(b,c),s.each(a,function(a,c,d){((e=b(a,c,d))>g||e===-1/0&&f===-1/0)&&(f=a,g=e)});return f},s.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b&&null!=a){a=A(a)?a:s.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],f>d&&(f=d)}else b=u(b,c),s.each(a,function(a,c,d){e=b(a,c,d),(g>e||1/0===e&&1/0===f)&&(f=a,g=e)});return f},s.shuffle=function(a){for(var b,c=A(a)?a:s.values(a),d=c.length,e=Array(d),f=0;d>f;f++)b=s.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e},s.sample=function(a,b,c){return null==b||c?(A(a)||(a=s.values(a)),a[s.random(a.length-1)]):s.shuffle(a).slice(0,Math.max(0,b))},s.sortBy=function(a,b,c){return b=u(b,c),s.pluck(s.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var B=function(a){return function(b,c,d){var e={};return c=u(c,d),s.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)}),e}};s.groupBy=B(function(a,b,c){s.has(a,c)?a[c].push(b):a[c]=[b]}),s.indexBy=B(function(a,b,c){a[c]=b}),s.countBy=B(function(a,b,c){s.has(a,c)?a[c]++:a[c]=1}),s.toArray=function(a){return a?s.isArray(a)?k.call(a):A(a)?s.map(a,s.identity):s.values(a):[]},s.size=function(a){return null==a?0:A(a)?a.length:s.keys(a).length},s.partition=function(a,b,c){b=u(b,c);var d=[],e=[];return s.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)}),[d,e]},s.first=s.head=s.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:s.initial(a,a.length-b)},s.initial=function(a,b,c){return k.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},s.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:s.rest(a,Math.max(0,a.length-b))},s.rest=s.tail=s.drop=function(a,b,c){return k.call(a,null==b||c?1:b)},s.compact=function(a){return s.filter(a,s.identity)};var C=function(a,b,c,d){for(var e=[],f=0,g=d||0,h=z(a);h>g;g++){var i=a[g];if(A(i)&&(s.isArray(i)||s.isArguments(i))){b||(i=C(i,b,c));var j=0,k=i.length;for(e.length+=k;k>j;)e[f++]=i[j++]}else c||(e[f++]=i)}return e};s.flatten=function(a,b){return C(a,b,!1)},s.without=function(a){return s.difference(a,k.call(arguments,1))},s.uniq=s.unique=function(a,b,c,d){s.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=u(c,d));for(var e=[],f=[],g=0,h=z(a);h>g;g++){var i=a[g],j=c?c(i,g,a):i;b?(g&&f===j||e.push(i),f=j):c?s.contains(f,j)||(f.push(j),e.push(i)):s.contains(e,i)||e.push(i)}return e},s.union=function(){return s.uniq(C(arguments,!0,!0))},s.intersection=function(a){for(var b=[],c=arguments.length,d=0,e=z(a);e>d;d++){var f=a[d];if(!s.contains(b,f)){for(var g=1;c>g&&s.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},s.difference=function(a){var b=C(arguments,!0,!0,1);return s.filter(a,function(a){return!s.contains(b,a)})},s.zip=function(){return s.unzip(arguments)},s.unzip=function(a){for(var b=a&&s.max(a,z).length||0,c=Array(b),d=0;b>d;d++)c[d]=s.pluck(a,d);return c},s.object=function(a,b){for(var c={},d=0,e=z(a);e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},s.findIndex=b(1),s.findLastIndex=b(-1),s.sortedIndex=function(a,b,c,d){c=u(c,d,1);for(var e=c(b),f=0,g=z(a);g>f;){var h=Math.floor((f+g)/2);c(a[h])<e?f=h+1:g=h}return f},s.indexOf=c(1,s.findIndex,s.sortedIndex),s.lastIndexOf=c(-1,s.findLastIndex),s.range=function(a,b,c){null==b&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e};var D=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);var f=w(a.prototype),g=a.apply(f,e);return s.isObject(g)?g:f};s.bind=function(a,b){if(p&&a.bind===p)return p.apply(a,k.call(arguments,1));if(!s.isFunction(a))throw new TypeError("Bind must be called on a function");var c=k.call(arguments,2),d=function(){return D(a,d,b,this,c.concat(k.call(arguments)))};return d},s.partial=function(a){var b=k.call(arguments,1),c=function(){for(var d=0,e=b.length,f=Array(e),g=0;e>g;g++)f[g]=b[g]===s?arguments[d++]:b[g];for(;d<arguments.length;)f.push(arguments[d++]);return D(a,c,this,this,f)};return c},s.bindAll=function(a){var b,c,d=arguments.length;if(1>=d)throw new Error("bindAll must be passed function names");for(b=1;d>b;b++)c=arguments[b],a[c]=s.bind(a[c],a);return a},s.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);return s.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},s.delay=function(a,b){var c=k.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},s.defer=s.partial(s.delay,s,1),s.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=!1===c.leading?0:s.now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=s.now();h||!1!==c.leading||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(g&&(clearTimeout(g),g=null),h=j,f=a.apply(d,e),g||(d=e=null)):g||!1===c.trailing||(g=setTimeout(i,k)),f}},s.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=s.now()-g;b>j&&j>=0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=s.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},s.wrap=function(a,b){return s.partial(b,a)},s.negate=function(a){return function(){return!a.apply(this,arguments)}},s.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},s.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},s.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),1>=a&&(b=null),c}},s.once=s.partial(s.before,2);var E=!{toString:null}.propertyIsEnumerable("toString"),F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];s.keys=function(a){if(!s.isObject(a))return[];if(o)return o(a);var b=[];for(var c in a)s.has(a,c)&&b.push(c);return E&&d(a,b),b},s.allKeys=function(a){if(!s.isObject(a))return[];var b=[];for(var c in a)b.push(c);return E&&d(a,b),b},s.values=function(a){for(var b=s.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},s.mapObject=function(a,b,c){b=u(b,c);for(var d,e=s.keys(a),f=e.length,g={},h=0;f>h;h++)d=e[h],g[d]=b(a[d],d,a);return g},s.pairs=function(a){for(var b=s.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},s.invert=function(a){for(var b={},c=s.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},s.functions=s.methods=function(a){var b=[];for(var c in a)s.isFunction(a[c])&&b.push(c);return b.sort()},s.extend=v(s.allKeys),s.extendOwn=s.assign=v(s.keys),s.findKey=function(a,b,c){b=u(b,c);for(var d,e=s.keys(a),f=0,g=e.length;g>f;f++)if(d=e[f],b(a[d],d,a))return d},s.pick=function(a,b,c){var d,e,f={},g=a;if(null==g)return f;s.isFunction(b)?(e=s.allKeys(g),d=t(b,c)):(e=C(arguments,!1,!1,1),d=function(a,b,c){return b in c},g=Object(g));for(var h=0,i=e.length;i>h;h++){var j=e[h],k=g[j];d(k,j,g)&&(f[j]=k)}return f},s.omit=function(a,b,c){if(s.isFunction(b))b=s.negate(b);else{var d=s.map(C(arguments,!1,!1,1),String);b=function(a,b){return!s.contains(d,b)}}return s.pick(a,b,c)},s.defaults=v(s.allKeys,!0),s.create=function(a,b){var c=w(a);return b&&s.extendOwn(c,b),c},s.clone=function(a){return s.isObject(a)?s.isArray(a)?a.slice():s.extend({},a):a},s.tap=function(a,b){return b(a),a},s.isMatch=function(a,b){var c=s.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;d>f;f++){var g=c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var G=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof s&&(a=a._wrapped),b instanceof s&&(b=b._wrapped);var e=l.call(a);if(e!==l.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!=+a?+b!=+b:0==+a?1/+a==1/b:+a==+b;case"[object Date]":case"[object Boolean]":return+a==+b}var f="[object Array]"===e;if(!f){if("object"!=typeof a||"object"!=typeof b)return!1;var g=a.constructor,h=b.constructor;if(g!==h&&!(s.isFunction(g)&&g instanceof g&&s.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1}c=c||[],d=d||[];for(var i=c.length;i--;)if(c[i]===a)return d[i]===b;if(c.push(a),d.push(b),f){if((i=a.length)!==b.length)return!1;for(;i--;)if(!G(a[i],b[i],c,d))return!1}else{var j,k=s.keys(a);if(i=k.length,s.keys(b).length!==i)return!1;for(;i--;)if(j=k[i],!s.has(b,j)||!G(a[j],b[j],c,d))return!1}return c.pop(),d.pop(),!0};s.isEqual=function(a,b){return G(a,b)},s.isEmpty=function(a){return null==a||(A(a)&&(s.isArray(a)||s.isString(a)||s.isArguments(a))?0===a.length:0===s.keys(a).length)},s.isElement=function(a){return!(!a||1!==a.nodeType)},s.isArray=n||function(a){return"[object Array]"===l.call(a)},s.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},s.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(a){s["is"+a]=function(b){return l.call(b)==="[object "+a+"]"}}),s.isArguments(arguments)||(s.isArguments=function(a){return s.has(a,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(s.isFunction=function(a){return"function"==typeof a||!1}),s.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},s.isNaN=function(a){return s.isNumber(a)&&a!==+a},s.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"===l.call(a)},s.isNull=function(a){return null===a},s.isUndefined=function(a){return void 0===a},s.has=function(a,b){return null!=a&&m.call(a,b)},s.noConflict=function(){return e._=f,this},s.identity=function(a){return a},s.constant=function(a){return function(){return a}},s.noop=function(){},s.property=x,s.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}},s.matcher=s.matches=function(a){return a=s.extendOwn({},a),function(b){return s.isMatch(b,a)}},s.times=function(a,b,c){var d=Array(Math.max(0,a));b=t(b,c,1);for(var e=0;a>e;e++)d[e]=b(e);return d},s.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},s.now=Date.now||function(){return(new Date).getTime()};var H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},I=s.invert(H),J=function(a){var b=function(b){return a[b]},c="(?:"+s.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};s.escape=J(H),s.unescape=J(I),s.result=function(a,b,c){var d=null==a?void 0:a[b];return void 0===d&&(d=c),s.isFunction(d)?d.call(a):d};var K=0;s.uniqueId=function(a){var b=++K+"";return a?a+b:b},s.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\u2028|\u2029/g,O=function(a){return"\\"+M[a]};s.template=function(a,b,c){!b&&c&&(b=c),b=s.defaults({},b,s.templateSettings);var d=RegExp([(b.escape||L).source,(b.interpolate||L).source,(b.evaluate||L).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(N,O),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(b.variable||"obj","_",f)}catch(a){throw a.source=f,a}var h=function(a){return g.call(this,a,s)};return h.source="function("+(b.variable||"obj")+"){\n"+f+"}",h},s.chain=function(a){var b=s(a);return b._chain=!0,b};var P=function(a,b){return a._chain?s(b).chain():b};s.mixin=function(a){s.each(s.functions(a),function(b){var c=s[b]=a[b];s.prototype[b]=function(){var a=[this._wrapped];return j.apply(a,arguments),P(this,c.apply(s,a))}})},s.mixin(s),s.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=g[a];s.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],P(this,c)}}),s.each(["concat","join","slice"],function(a){var b=g[a];s.prototype[a]=function(){return P(this,b.apply(this._wrapped,arguments))}}),s.prototype.value=function(){return this._wrapped},s.prototype.valueOf=s.prototype.toJSON=s.prototype.value,s.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return s})}).call(this),function(a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define([],a):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Plotly=a()}(function(){return function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){return e(b[g][1][a]||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}}()({1:[function(a,b,c){"use strict";var d=a("../src/lib"),e={"X,X div":"direction:ltr;font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color 0.3s ease 0s;-moz-transition:background-color 0.3s ease 0s;-ms-transition:background-color 0.3s ease 0s;-o-transition:background-color 0.3s ease 0s;transition:background-color 0.3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans';position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var f in e){var g=f.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");d.addStyleRule(g,e[f])}},{"../src/lib":719}],2:[function(a,b,c){"use strict";b.exports=a("../src/transforms/aggregate")},{"../src/transforms/aggregate":1279}],3:[function(a,b,c){"use strict";b.exports=a("../src/traces/bar")},{"../src/traces/bar":865}],4:[function(a,b,c){"use strict";b.exports=a("../src/traces/barpolar")},{"../src/traces/barpolar":877}],5:[function(a,b,c){"use strict";b.exports=a("../src/traces/box")},{"../src/traces/box":887}],6:[function(a,b,c){"use strict";b.exports=a("../src/components/calendars")},{"../src/components/calendars":592}],7:[function(a,b,c){"use strict";b.exports=a("../src/traces/candlestick")},{"../src/traces/candlestick":896}],8:[function(a,b,c){"use strict";b.exports=a("../src/traces/carpet")},{"../src/traces/carpet":915}],9:[function(a,b,c){"use strict";b.exports=a("../src/traces/choropleth")},{"../src/traces/choropleth":929}],10:[function(a,b,c){"use strict";b.exports=a("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":936}],11:[function(a,b,c){"use strict";b.exports=a("../src/traces/cone")},{"../src/traces/cone":942}],12:[function(a,b,c){"use strict";b.exports=a("../src/traces/contour")},{"../src/traces/contour":957}],13:[function(a,b,c){"use strict";b.exports=a("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":968}],14:[function(a,b,c){"use strict";b.exports=a("../src/core")},{"../src/core":697}],15:[function(a,b,c){"use strict";b.exports=a("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":976}],16:[function(a,b,c){"use strict";b.exports=a("../src/transforms/filter")},{"../src/transforms/filter":1280}],17:[function(a,b,c){"use strict";b.exports=a("../src/traces/funnel")},{"../src/traces/funnel":986}],18:[function(a,b,c){"use strict";b.exports=a("../src/traces/funnelarea")},{"../src/traces/funnelarea":995}],19:[function(a,b,c){"use strict";b.exports=a("../src/transforms/groupby")},{"../src/transforms/groupby":1281}],20:[function(a,b,c){"use strict";b.exports=a("../src/traces/heatmap")},{"../src/traces/heatmap":1008}],21:[function(a,b,c){"use strict";b.exports=a("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":1017}],22:[function(a,b,c){"use strict";b.exports=a("../src/traces/histogram")},{"../src/traces/histogram":1029}],23:[function(a,b,c){"use strict";b.exports=a("../src/traces/histogram2d")},{"../src/traces/histogram2d":1035}],24:[function(a,b,c){"use strict";b.exports=a("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":1039}],25:[function(a,b,c){"use strict";var d=a("./core");d.register([a("./bar"),a("./box"),a("./heatmap"),a("./histogram"),a("./histogram2d"),a("./histogram2dcontour"),a("./contour"),a("./scatterternary"),a("./violin"),a("./funnel"),a("./waterfall"),a("./pie"),a("./sunburst"),a("./treemap"),a("./funnelarea"),a("./scatter3d"),a("./surface"),a("./isosurface"),a("./volume"),a("./mesh3d"),a("./cone"),a("./streamtube"),a("./scattergeo"),a("./choropleth"),a("./scattergl"),a("./splom"),a("./pointcloud"),a("./heatmapgl"),a("./parcoords"),a("./parcats"),a("./scattermapbox"),a("./choroplethmapbox"),a("./densitymapbox"),a("./sankey"),a("./indicator"),a("./table"),a("./carpet"),a("./scattercarpet"),a("./contourcarpet"),a("./ohlc"),a("./candlestick"),a("./scatterpolar"),a("./scatterpolargl"),a("./barpolar")]),d.register([a("./aggregate"),a("./filter"),a("./groupby"),a("./sort")]),d.register([a("./calendars")]),b.exports=d},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./indicator":26,"./isosurface":27,"./mesh3d":28,"./ohlc":29,"./parcats":30,"./parcoords":31,"./pie":32,"./pointcloud":33,"./sankey":34,"./scatter3d":35,"./scattercarpet":36,"./scattergeo":37,"./scattergl":38,"./scattermapbox":39,"./scatterpolar":40,"./scatterpolargl":41,"./scatterternary":42,"./sort":43,"./splom":44,"./streamtube":45,"./sunburst":46,"./surface":47,"./table":48,"./treemap":49,"./violin":50,"./volume":51,"./waterfall":52}],26:[function(a,b,c){"use strict";b.exports=a("../src/traces/indicator")},{"../src/traces/indicator":1045}],27:[function(a,b,c){"use strict";b.exports=a("../src/traces/isosurface")},{"../src/traces/isosurface":1051}],28:[function(a,b,c){"use strict";b.exports=a("../src/traces/mesh3d")},{"../src/traces/mesh3d":1056}],29:[function(a,b,c){"use strict";b.exports=a("../src/traces/ohlc")},{"../src/traces/ohlc":1061}],30:[function(a,b,c){"use strict";b.exports=a("../src/traces/parcats")},{"../src/traces/parcats":1070}],31:[function(a,b,c){"use strict";b.exports=a("../src/traces/parcoords")},{"../src/traces/parcoords":1080}],32:[function(a,b,c){"use strict";b.exports=a("../src/traces/pie")},{"../src/traces/pie":1091}],33:[function(a,b,c){"use strict";b.exports=a("../src/traces/pointcloud")},{"../src/traces/pointcloud":1100}],34:[function(a,b,c){"use strict";b.exports=a("../src/traces/sankey")},{"../src/traces/sankey":1106}],35:[function(a,b,c){"use strict";b.exports=a("../src/traces/scatter3d")},{"../src/traces/scatter3d":1142}],36:[function(a,b,c){"use strict";b.exports=a("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1148}],37:[function(a,b,c){"use strict";b.exports=a("../src/traces/scattergeo")},{"../src/traces/scattergeo":1155}],38:[function(a,b,c){"use strict";b.exports=a("../src/traces/scattergl")},{"../src/traces/scattergl":1166}],39:[function(a,b,c){"use strict";b.exports=a("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1175}],40:[function(a,b,c){"use strict";b.exports=a("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1182}],41:[function(a,b,c){"use strict";b.exports=a("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1188}],42:[function(a,b,c){"use strict";b.exports=a("../src/traces/scatterternary")},{"../src/traces/scatterternary":1195}],43:[function(a,b,c){"use strict";b.exports=a("../src/transforms/sort")},{"../src/transforms/sort":1283}],44:[function(a,b,c){"use strict";b.exports=a("../src/traces/splom")},{"../src/traces/splom":1204}],45:[function(a,b,c){"use strict";b.exports=a("../src/traces/streamtube")},{"../src/traces/streamtube":1212}],46:[function(a,b,c){"use strict";b.exports=a("../src/traces/sunburst")},{"../src/traces/sunburst":1220}],47:[function(a,b,c){"use strict";b.exports=a("../src/traces/surface")},{"../src/traces/surface":1229}],48:[function(a,b,c){"use strict";b.exports=a("../src/traces/table")},{"../src/traces/table":1237}],49:[function(a,b,c){"use strict";b.exports=a("../src/traces/treemap")},{"../src/traces/treemap":1246}],50:[function(a,b,c){"use strict";b.exports=a("../src/traces/violin")},{"../src/traces/violin":1258}],51:[function(a,b,c){"use strict";b.exports=a("../src/traces/volume")},{"../src/traces/volume":1266}],52:[function(a,b,c){"use strict";b.exports=a("../src/traces/waterfall")},{"../src/traces/waterfall":1274}],53:[function(a,b,c){"use strict";function d(a,b){this._controllerNames=Object.keys(a),this._controllerList=this._controllerNames.map(function(b){return a[b]}),this._mode=b,this._active=a[b],this._active||(this._mode="turntable",this._active=a.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}b.exports=function(a){var b=(a=a||{}).eye||[0,0,1],c=a.center||[0,0,0],h=a.up||[0,1,0],i=a.distanceLimits||[0,1/0],j=a.mode||"turntable",k=e(),l=f(),m=g();return k.setDistanceLimits(i[0],i[1]),k.lookAt(0,b,c,h),l.setDistanceLimits(i[0],i[1]),l.lookAt(0,b,c,h),m.setDistanceLimits(i[0],i[1]),m.lookAt(0,b,c,h),new d({turntable:k,orbit:l,matrix:m},j)};var e=a("turntable-camera-controller"),f=a("orbit-camera-controller"),g=a("matrix-camera-controller"),h=d.prototype;[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]].forEach(function(a){for(var b=a[0],c=[],d=0;d<a[1];++d)c.push("a"+d)
;var e="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+a[0]+"("+c.join()+")}";h[b]=Function.apply(null,c.concat(e))}),h.recalcMatrix=function(a){this._active.recalcMatrix(a)},h.getDistance=function(a){return this._active.getDistance(a)},h.getDistanceLimits=function(a){return this._active.getDistanceLimits(a)},h.lastT=function(){return this._active.lastT()},h.setMode=function(a){if(a!==this._mode){var b=this._controllerNames.indexOf(a);if(!(b<0)){var c=this._active,d=this._controllerList[b],e=Math.max(c.lastT(),d.lastT());c.recalcMatrix(e),d.setMatrix(e,c.computedMatrix),this._active=d,this._mode=a,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},h.getMode=function(){return this._mode}},{"matrix-camera-controller":434,"orbit-camera-controller":457,"turntable-camera-controller":543}],54:[function(a,b,c){var d,e;d=this,e=function(a,b,c,d,e){"use strict";function f(a){return a.target.depth}function g(a,b){return a.sourceLinks.length?a.depth:b-1}function h(a){return function(){return a}}function i(a,b){return k(a.source,b.source)||a.index-b.index}function j(a,b){return k(a.target,b.target)||a.index-b.index}function k(a,b){return a.partOfCycle===b.partOfCycle?a.y0-b.y0:"top"===a.circularLinkType||"bottom"===b.circularLinkType?-1:1}function l(a){return a.value}function m(a){return(a.y0+a.y1)/2}function n(a){return m(a.source)}function o(a){return m(a.target)}function p(a){return a.index}function q(a){return a.nodes}function r(a){return a.links}function s(a,b){var c=a.get(b);if(!c)throw new Error("missing: "+b);return c}function t(a,b){return b(a)}function u(a,b){var c=0,d=0;a.links.forEach(function(e){e.circular&&(e.source.circularLinkType||e.target.circularLinkType?e.circularLinkType=e.source.circularLinkType?e.source.circularLinkType:e.target.circularLinkType:e.circularLinkType=c<d?"top":"bottom","top"==e.circularLinkType?c+=1:d+=1,a.nodes.forEach(function(a){t(a,b)!=t(e.source,b)&&t(a,b)!=t(e.target,b)||(a.circularLinkType=e.circularLinkType)}))}),a.links.forEach(function(a){a.circular&&(a.source.circularLinkType==a.target.circularLinkType&&(a.circularLinkType=a.source.circularLinkType),Q(a,b)&&(a.circularLinkType=a.source.circularLinkType))})}function v(a){var b=Math.abs(a.y1-a.y0),c=Math.abs(a.target.x0-a.source.x1);return Math.atan(c/b)}function w(a,b){var c=0;a.sourceLinks.forEach(function(a){c=a.circular&&!Q(a,b)?c+1:c});var d=0;return a.targetLinks.forEach(function(a){d=a.circular&&!Q(a,b)?d+1:d}),c+d}function x(a){var b=a.source.sourceLinks,c=0;b.forEach(function(a){c=a.circular?c+1:c});var d=a.target.targetLinks,e=0;return d.forEach(function(a){e=a.circular?e+1:e}),!(c>1||e>1)}function y(a,b,c){return a.sort(A),a.forEach(function(d,e){var f,g,h=0;if(Q(d,c)&&x(d))d.circularPathData.verticalBuffer=h+d.width/2;else{for(var i=0;i<e;i++)if(f=a[e],g=a[i],!(f.source.column<g.target.column||f.target.column>g.source.column)){var j=a[i].circularPathData.verticalBuffer+a[i].width/2+b;h=j>h?j:h}d.circularPathData.verticalBuffer=h+d.width/2}}),a}function z(a,c,e,f){var g=b.min(a.links,function(a){return a.source.y0});a.links.forEach(function(a){a.circular&&(a.circularPathData={})}),y(a.links.filter(function(a){return"top"==a.circularLinkType}),c,f),y(a.links.filter(function(a){return"bottom"==a.circularLinkType}),c,f),a.links.forEach(function(b){if(b.circular){if(b.circularPathData.arcRadius=b.width+T,b.circularPathData.leftNodeBuffer=5,b.circularPathData.rightNodeBuffer=5,b.circularPathData.sourceWidth=b.source.x1-b.source.x0,b.circularPathData.sourceX=b.source.x0+b.circularPathData.sourceWidth,b.circularPathData.targetX=b.target.x0,b.circularPathData.sourceY=b.y0,b.circularPathData.targetY=b.y1,Q(b,f)&&x(b))b.circularPathData.leftSmallArcRadius=T+b.width/2,b.circularPathData.leftLargeArcRadius=T+b.width/2,b.circularPathData.rightSmallArcRadius=T+b.width/2,b.circularPathData.rightLargeArcRadius=T+b.width/2,"bottom"==b.circularLinkType?(b.circularPathData.verticalFullExtent=b.source.y1+S+b.circularPathData.verticalBuffer,b.circularPathData.verticalLeftInnerExtent=b.circularPathData.verticalFullExtent-b.circularPathData.leftLargeArcRadius,b.circularPathData.verticalRightInnerExtent=b.circularPathData.verticalFullExtent-b.circularPathData.rightLargeArcRadius):(b.circularPathData.verticalFullExtent=b.source.y0-S-b.circularPathData.verticalBuffer,b.circularPathData.verticalLeftInnerExtent=b.circularPathData.verticalFullExtent+b.circularPathData.leftLargeArcRadius,b.circularPathData.verticalRightInnerExtent=b.circularPathData.verticalFullExtent+b.circularPathData.rightLargeArcRadius);else{var h=b.source.column,i=b.circularLinkType,j=a.links.filter(function(a){return a.source.column==h&&a.circularLinkType==i});"bottom"==b.circularLinkType?j.sort(C):j.sort(B);var k=0;j.forEach(function(a,d){a.circularLinkID==b.circularLinkID&&(b.circularPathData.leftSmallArcRadius=T+b.width/2+k,b.circularPathData.leftLargeArcRadius=T+b.width/2+d*c+k),k+=a.width}),h=b.target.column,j=a.links.filter(function(a){return a.target.column==h&&a.circularLinkType==i}),"bottom"==b.circularLinkType?j.sort(E):j.sort(D),k=0,j.forEach(function(a,d){a.circularLinkID==b.circularLinkID&&(b.circularPathData.rightSmallArcRadius=T+b.width/2+k,b.circularPathData.rightLargeArcRadius=T+b.width/2+d*c+k),k+=a.width}),"bottom"==b.circularLinkType?(b.circularPathData.verticalFullExtent=Math.max(e,b.source.y1,b.target.y1)+S+b.circularPathData.verticalBuffer,b.circularPathData.verticalLeftInnerExtent=b.circularPathData.verticalFullExtent-b.circularPathData.leftLargeArcRadius,b.circularPathData.verticalRightInnerExtent=b.circularPathData.verticalFullExtent-b.circularPathData.rightLargeArcRadius):(b.circularPathData.verticalFullExtent=g-S-b.circularPathData.verticalBuffer,b.circularPathData.verticalLeftInnerExtent=b.circularPathData.verticalFullExtent+b.circularPathData.leftLargeArcRadius,b.circularPathData.verticalRightInnerExtent=b.circularPathData.verticalFullExtent+b.circularPathData.rightLargeArcRadius)}b.circularPathData.leftInnerExtent=b.circularPathData.sourceX+b.circularPathData.leftNodeBuffer,b.circularPathData.rightInnerExtent=b.circularPathData.targetX-b.circularPathData.rightNodeBuffer,b.circularPathData.leftFullExtent=b.circularPathData.sourceX+b.circularPathData.leftLargeArcRadius+b.circularPathData.leftNodeBuffer,b.circularPathData.rightFullExtent=b.circularPathData.targetX-b.circularPathData.rightLargeArcRadius-b.circularPathData.rightNodeBuffer}if(b.circular)b.path=function(a){return"top"==a.circularLinkType?"M"+a.circularPathData.sourceX+" "+a.circularPathData.sourceY+" L"+a.circularPathData.leftInnerExtent+" "+a.circularPathData.sourceY+" A"+a.circularPathData.leftLargeArcRadius+" "+a.circularPathData.leftSmallArcRadius+" 0 0 0 "+a.circularPathData.leftFullExtent+" "+(a.circularPathData.sourceY-a.circularPathData.leftSmallArcRadius)+" L"+a.circularPathData.leftFullExtent+" "+a.circularPathData.verticalLeftInnerExtent+" A"+a.circularPathData.leftLargeArcRadius+" "+a.circularPathData.leftLargeArcRadius+" 0 0 0 "+a.circularPathData.leftInnerExtent+" "+a.circularPathData.verticalFullExtent+" L"+a.circularPathData.rightInnerExtent+" "+a.circularPathData.verticalFullExtent+" A"+a.circularPathData.rightLargeArcRadius+" "+a.circularPathData.rightLargeArcRadius+" 0 0 0 "+a.circularPathData.rightFullExtent+" "+a.circularPathData.verticalRightInnerExtent+" L"+a.circularPathData.rightFullExtent+" "+(a.circularPathData.targetY-a.circularPathData.rightSmallArcRadius)+" A"+a.circularPathData.rightLargeArcRadius+" "+a.circularPathData.rightSmallArcRadius+" 0 0 0 "+a.circularPathData.rightInnerExtent+" "+a.circularPathData.targetY+" L"+a.circularPathData.targetX+" "+a.circularPathData.targetY:"M"+a.circularPathData.sourceX+" "+a.circularPathData.sourceY+" L"+a.circularPathData.leftInnerExtent+" "+a.circularPathData.sourceY+" A"+a.circularPathData.leftLargeArcRadius+" "+a.circularPathData.leftSmallArcRadius+" 0 0 1 "+a.circularPathData.leftFullExtent+" "+(a.circularPathData.sourceY+a.circularPathData.leftSmallArcRadius)+" L"+a.circularPathData.leftFullExtent+" "+a.circularPathData.verticalLeftInnerExtent+" A"+a.circularPathData.leftLargeArcRadius+" "+a.circularPathData.leftLargeArcRadius+" 0 0 1 "+a.circularPathData.leftInnerExtent+" "+a.circularPathData.verticalFullExtent+" L"+a.circularPathData.rightInnerExtent+" "+a.circularPathData.verticalFullExtent+" A"+a.circularPathData.rightLargeArcRadius+" "+a.circularPathData.rightLargeArcRadius+" 0 0 1 "+a.circularPathData.rightFullExtent+" "+a.circularPathData.verticalRightInnerExtent+" L"+a.circularPathData.rightFullExtent+" "+(a.circularPathData.targetY+a.circularPathData.rightSmallArcRadius)+" A"+a.circularPathData.rightLargeArcRadius+" "+a.circularPathData.rightSmallArcRadius+" 0 0 1 "+a.circularPathData.rightInnerExtent+" "+a.circularPathData.targetY+" L"+a.circularPathData.targetX+" "+a.circularPathData.targetY}(b);else{var l=d.linkHorizontal().source(function(a){return[a.source.x0+(a.source.x1-a.source.x0),a.y0]}).target(function(a){return[a.target.x0,a.y1]});b.path=l(b)}})}function A(a,b){return F(a)==F(b)?"bottom"==a.circularLinkType?C(a,b):B(a,b):F(b)-F(a)}function B(a,b){return a.y0-b.y0}function C(a,b){return b.y0-a.y0}function D(a,b){return a.y1-b.y1}function E(a,b){return b.y1-a.y1}function F(a){return a.target.column-a.source.column}function G(a){return a.target.x0-a.source.x1}function H(a,b){var c=v(a),d=G(b)/Math.tan(c);return"up"==P(a)?a.y1+d:a.y1-d}function I(a,b){var c=v(a),d=G(b)/Math.tan(c);return"up"==P(a)?a.y1-d:a.y1+d}function J(a,b,c,d){a.links.forEach(function(e){if(!e.circular&&e.target.column-e.source.column>1){var f=e.source.column+1,g=e.target.column-1,h=1,i=g-f+1;for(h=1;f<=g;f++,h++)a.nodes.forEach(function(g){if(g.column==f){var j,k=h/(i+1),l=Math.pow(1-k,3),m=3*k*Math.pow(1-k,2),n=3*Math.pow(k,2)*(1-k),o=Math.pow(k,3),p=l*e.y0+m*e.y0+n*e.y1+o*e.y1,q=p-e.width/2,r=p+e.width/2;q>g.y0&&q<g.y1?(j=g.y1-q+10,j="bottom"==g.circularLinkType?j:-j,g=L(g,j,b,c),a.nodes.forEach(function(a){t(a,d)!=t(g,d)&&a.column==g.column&&K(g,a)&&L(a,j,b,c)})):r>g.y0&&r<g.y1?(j=r-g.y0+10,g=L(g,j,b,c),a.nodes.forEach(function(a){t(a,d)!=t(g,d)&&a.column==g.column&&a.y0<g.y1&&a.y1>g.y1&&L(a,j,b,c)})):q<g.y0&&r>g.y1&&(j=r-g.y0+10,g=L(g,j,b,c),a.nodes.forEach(function(a){t(a,d)!=t(g,d)&&a.column==g.column&&a.y0<g.y1&&a.y1>g.y1&&L(a,j,b,c)}))}})}})}function K(a,b){return a.y0>b.y0&&a.y0<b.y1||a.y1>b.y0&&a.y1<b.y1||a.y0<b.y0&&a.y1>b.y1}function L(a,b,c,d){return a.y0+b>=c&&a.y1+b<=d&&(a.y0=a.y0+b,a.y1=a.y1+b,a.targetLinks.forEach(function(a){a.y1=a.y1+b}),a.sourceLinks.forEach(function(a){a.y0=a.y0+b})),a}function M(a,b,c,d){a.nodes.forEach(function(e){d&&e.y+(e.y1-e.y0)>b&&(e.y=e.y-(e.y+(e.y1-e.y0)-b));var f=a.links.filter(function(a){return t(a.source,c)==t(e,c)}),g=f.length;g>1&&f.sort(function(a,b){if(!a.circular&&!b.circular){if(a.target.column==b.target.column)return a.y1-b.y1;if(!O(a,b))return a.y1-b.y1;if(a.target.column>b.target.column){var c=I(b,a);return a.y1-c}if(b.target.column>a.target.column)return I(a,b)-b.y1}return a.circular&&!b.circular?"top"==a.circularLinkType?-1:1:b.circular&&!a.circular?"top"==b.circularLinkType?1:-1:a.circular&&b.circular?a.circularLinkType===b.circularLinkType&&"top"==a.circularLinkType?a.target.column===b.target.column?a.target.y1-b.target.y1:b.target.column-a.target.column:a.circularLinkType===b.circularLinkType&&"bottom"==a.circularLinkType?a.target.column===b.target.column?b.target.y1-a.target.y1:a.target.column-b.target.column:"top"==a.circularLinkType?-1:1:void 0});var h=e.y0;f.forEach(function(a){a.y0=h+a.width/2,h+=a.width}),f.forEach(function(a,b){if("bottom"==a.circularLinkType){for(var c=b+1,d=0;c<g;c++)d+=f[c].width;a.y0=e.y1-d-a.width/2}})})}function N(a,b,c){a.nodes.forEach(function(b){var d=a.links.filter(function(a){return t(a.target,c)==t(b,c)}),e=d.length;e>1&&d.sort(function(a,b){if(!a.circular&&!b.circular){if(a.source.column==b.source.column)return a.y0-b.y0;if(!O(a,b))return a.y0-b.y0;if(b.source.column<a.source.column){var c=H(b,a);return a.y0-c}if(a.source.column<b.source.column)return H(a,b)-b.y0}return a.circular&&!b.circular?"top"==a.circularLinkType?-1:1:b.circular&&!a.circular?"top"==b.circularLinkType?1:-1:a.circular&&b.circular?a.circularLinkType===b.circularLinkType&&"top"==a.circularLinkType?a.source.column===b.source.column?a.source.y1-b.source.y1:a.source.column-b.source.column:a.circularLinkType===b.circularLinkType&&"bottom"==a.circularLinkType?a.source.column===b.source.column?a.source.y1-b.source.y1:b.source.column-a.source.column:"top"==a.circularLinkType?-1:1:void 0});var f=b.y0;d.forEach(function(a){a.y1=f+a.width/2,f+=a.width}),d.forEach(function(a,c){if("bottom"==a.circularLinkType){for(var f=c+1,g=0;f<e;f++)g+=d[f].width;a.y1=b.y1-g-a.width/2}})})}function O(a,b){return P(a)==P(b)}function P(a){return a.y0-a.y1>0?"up":"down"}function Q(a,b){return t(a.source,b)==t(a.target,b)}e=e&&e.hasOwnProperty("default")?e.default:e;var R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},S=25,T=10;a.sankeyCircular=function(){function a(){var a={nodes:E.apply(null,arguments),links:F.apply(null,arguments)};!function(a){a.nodes.forEach(function(a,b){a.index=b,a.sourceLinks=[],a.targetLinks=[]});var b=c.map(a.nodes,C);a.links.forEach(function(a,c){a.index=c;var d=a.source,e=a.target;"object"!==(void 0===d?"undefined":R(d))&&(d=a.source=s(b,d)),"object"!==(void 0===e?"undefined":R(e))&&(e=a.target=s(b,e)),d.sourceLinks.push(a),e.targetLinks.push(a)})}(a),function(a,b,c){var d=0;if(null===c){for(var f=[],g=0;g<a.links.length;g++){var h=a.links[g],i=h.source.index,j=h.target.index;f[i]||(f[i]=[]),f[j]||(f[j]=[]),-1===f[i].indexOf(j)&&f[i].push(j)}var k=e(f);k.sort(function(a,b){return a.length-b.length});var l={};for(g=0;g<k.length;g++){var m=k[g],n=m.slice(-2);l[n[0]]||(l[n[0]]={}),l[n[0]][n[1]]=!0}a.links.forEach(function(a){var b=a.target.index,c=a.source.index;b===c||l[c]&&l[c][b]?(a.circular=!0,a.circularLinkID=d,d+=1):a.circular=!1})}else a.links.forEach(function(a){a.source[c]<a.target[c]?a.circular=!1:(a.circular=!0,a.circularLinkID=d,d+=1)})}(a,0,I),function(a){a.nodes.forEach(function(a){a.partOfCycle=!1,a.value=Math.max(b.sum(a.sourceLinks,l),b.sum(a.targetLinks,l)),a.sourceLinks.forEach(function(b){b.circular&&(a.partOfCycle=!0,a.circularLinkType=b.circularLinkType)}),a.targetLinks.forEach(function(b){b.circular&&(a.partOfCycle=!0,a.circularLinkType=b.circularLinkType)})})}(a),function(a){var b,c,d;for(b=a.nodes,c=[],d=0;b.length;++d,b=c,c=[])b.forEach(function(a){a.depth=d,a.sourceLinks.forEach(function(a){c.indexOf(a.target)<0&&!a.circular&&c.push(a.target)})});for(b=a.nodes,c=[],d=0;b.length;++d,b=c,c=[])b.forEach(function(a){a.height=d,a.targetLinks.forEach(function(a){c.indexOf(a.source)<0&&!a.circular&&c.push(a.source)})});a.nodes.forEach(function(a){a.column=Math.floor(D.call(null,a,d))})}(a),u(a,C),function(a,d,e){function g(){h.forEach(function(a){var b,c,d,e=x,g=a.length;for(a.sort(k),d=0;d<g;++d)b=a[d],(c=e-b.y0)>0&&(b.y0+=c,b.y1+=c),e=b.y1+f;if((c=e-f-A)>0)for(e=b.y0-=c,b.y1-=c,d=g-2;d>=0;--d)b=a[d],(c=b.y1+f-e)>0&&(b.y0-=c,b.y1-=c),e=b.y0})}var h=c.nest().key(function(a){return a.column}).sortKeys(b.ascending).entries(a.nodes).map(function(a){return a.values});(function(c){if(t){var d=1/0;h.forEach(function(a){var b=A*t/(a.length+1);d=b<d?b:d}),f=d}var e=b.min(h,function(a){return(A-x-(a.length-1)*f)/b.sum(a,l)});e*=.3,a.links.forEach(function(a){a.width=a.value*e});var g=function(a){var c=0,d=0,e=0,f=0,g=b.max(a.nodes,function(a){return a.column});return a.links.forEach(function(a){a.circular&&("top"==a.circularLinkType?c+=a.width:d+=a.width,0==a.target.column&&(f+=a.width),a.source.column==g&&(e+=a.width))}),{top:c=c>0?c+S+T:c,bottom:d=d>0?d+S+T:d,left:f=f>0?f+S+T:f,right:e=e>0?e+S+T:e}}(a),i=function(a,c){var d=b.max(a.nodes,function(a){return a.column}),e=y-v,f=A-x,g=e+c.right+c.left,h=f+c.top+c.bottom,i=e/g,j=f/h;return v=v*i+c.left,y=0==c.right?y:y*i,x=x*j+c.top,A*=j,a.nodes.forEach(function(a){a.x0=v+a.column*((y-v-B)/d),a.x1=a.x0+B}),j}(a,g);e*=i,a.links.forEach(function(a){a.width=a.value*e}),h.forEach(function(a){var b=a.length;a.forEach(function(a,d){a.depth==h.length-1&&1==b?(a.y0=A/2-a.value*e,a.y1=a.y0+a.value*e):0==a.depth&&1==b?(a.y0=A/2-a.value*e,a.y1=a.y0+a.value*e):a.partOfCycle?0==w(a,c)?(a.y0=A/2+d,a.y1=a.y0+a.value*e):"top"==a.circularLinkType?(a.y0=x+d,a.y1=a.y0+a.value*e):(a.y0=A-a.value*e-d,a.y1=a.y0+a.value*e):0==g.top||0==g.bottom?(a.y0=(A-x)/b*d,a.y1=a.y0+a.value*e):(a.y0=(A-x)/2-b/2+d,a.y1=a.y0+a.value*e)})})})(e),g();for(var i=1,j=d;j>0;--j)(function(a,c){var d=h.length;h.forEach(function(e){var f=e.length,g=e[0].depth;e.forEach(function(e){var h;if(e.sourceLinks.length||e.targetLinks.length)if(e.partOfCycle&&w(e,c)>0);else if(0==g&&1==f)h=e.y1-e.y0,e.y0=A/2-h/2,e.y1=A/2+h/2;else if(g==d-1&&1==f)h=e.y1-e.y0,e.y0=A/2-h/2,e.y1=A/2+h/2;else{var i=b.mean(e.sourceLinks,o),j=b.mean(e.targetLinks,n),k=((i&&j?(i+j)/2:i||j)-m(e))*a;e.y0+=k,e.y1+=k}})})})(i*=.99,e),g()}(a,G,C),d(a);for(var g=0;g<4;g++)M(a,A,C),N(a,0,C),J(a,x,A,C),M(a,A,C),N(a,0,C);return function(a,c,d){var e=a.nodes,f=a.links,g=!1,h=!1;if(f.forEach(function(a){"top"==a.circularLinkType?g=!0:"bottom"==a.circularLinkType&&(h=!0)}),0==g||0==h){var i=b.min(e,function(a){return a.y0}),j=b.max(e,function(a){return a.y1}),k=j-i,l=d-c,m=l/k;e.forEach(function(a){var b=(a.y1-a.y0)*m;a.y0=(a.y0-i)*m,a.y1=a.y0+b}),f.forEach(function(a){a.y0=(a.y0-i)*m,a.y1=(a.y1-i)*m,a.width=a.width*m})}}(a,x,A),z(a,H,A,C),a}function d(a){a.nodes.forEach(function(a){a.sourceLinks.sort(j),a.targetLinks.sort(i)}),a.nodes.forEach(function(a){var b=a.y0,c=b,d=a.y1,e=d;a.sourceLinks.forEach(function(a){a.circular?(a.y0=d-a.width/2,d-=a.width):(a.y0=b+a.width/2,b+=a.width)}),a.targetLinks.forEach(function(a){a.circular?(a.y1=e-a.width/2,e-=a.width):(a.y1=c+a.width/2,c+=a.width)})})}var f,t,v=0,x=0,y=1,A=1,B=24,C=p,D=g,E=q,F=r,G=32,H=2,I=null;return a.nodeId=function(b){return arguments.length?(C="function"==typeof b?b:h(b),a):C},a.nodeAlign=function(b){return arguments.length?(D="function"==typeof b?b:h(b),a):D},a.nodeWidth=function(b){return arguments.length?(B=+b,a):B},a.nodePadding=function(b){return arguments.length?(f=+b,a):f},a.nodes=function(b){return arguments.length?(E="function"==typeof b?b:h(b),a):E},a.links=function(b){return arguments.length?(F="function"==typeof b?b:h(b),a):F},a.size=function(b){return arguments.length?(v=x=0,y=+b[0],A=+b[1],a):[y-v,A-x]},a.extent=function(b){return arguments.length?(v=+b[0][0],y=+b[1][0],x=+b[0][1],A=+b[1][1],a):[[v,x],[y,A]]},a.iterations=function(b){return arguments.length?(G=+b,a):G},a.circularLinkGap=function(b){return arguments.length?(H=+b,a):H},a.nodePaddingRatio=function(b){return arguments.length?(t=+b,a):t},a.sortNodes=function(b){return arguments.length?(I=b,a):I},a.update=function(a){return u(a,C),d(a),a.links.forEach(function(a){a.circular&&(a.circularLinkType=a.y0+a.y1<A?"top":"bottom",a.source.circularLinkType=a.circularLinkType,a.target.circularLinkType=a.circularLinkType)}),M(a,A,C,!1),N(a,0,C),z(a,H,A,C),a},a},a.sankeyCenter=function(a){return a.targetLinks.length?a.depth:a.sourceLinks.length?b.min(a.sourceLinks,f)-1:0},a.sankeyLeft=function(a){return a.depth},a.sankeyRight=function(a,b){return b-1-a.height},a.sankeyJustify=g,Object.defineProperty(a,"__esModule",{value:!0})},"object"==typeof c&&void 0!==b?e(c,a("d3-array"),a("d3-collection"),a("d3-shape"),a("elementary-circuits-directed-graph")):e(d.d3=d.d3||{},d.d3,d.d3,d.d3,null)},{"d3-array":153,"d3-collection":154,"d3-shape":162,"elementary-circuits-directed-graph":173}],55:[function(a,b,c){var d,e;d=this,e=function(a,b,c,d){"use strict";function e(a){return a.target.depth}function f(a,b){return a.sourceLinks.length?a.depth:b-1}function g(a){return function(){return a}}function h(a,b){return j(a.source,b.source)||a.index-b.index}function i(a,b){return j(a.target,b.target)||a.index-b.index}function j(a,b){return a.y0-b.y0}function k(a){return a.value}function l(a){return(a.y0+a.y1)/2}function m(a){return l(a.source)*a.value}function n(a){return l(a.target)*a.value}function o(a){return a.index}function p(a){return a.nodes}function q(a){return a.links}function r(a,b){var c=a.get(b);if(!c)throw new Error("missing: "+b);return c}function s(a){return[a.source.x1,a.y0]}function t(a){return[a.target.x0,a.y1]}a.sankey=function(){function a(){var a={nodes:z.apply(null,arguments),links:A.apply(null,arguments)};return function(a){a.nodes.forEach(function(a,b){a.index=b,a.sourceLinks=[],a.targetLinks=[]});var b=c.map(a.nodes,x);a.links.forEach(function(a,c){a.index=c;var d=a.source,e=a.target;"object"!=typeof d&&(d=a.source=r(b,d)),"object"!=typeof e&&(e=a.target=r(b,e)),d.sourceLinks.push(a),e.targetLinks.push(a)})}(a),function(a){a.nodes.forEach(function(a){a.value=Math.max(b.sum(a.sourceLinks,k),b.sum(a.targetLinks,k))})}(a),function(a){var b,c,d;for(b=a.nodes,c=[],d=0;b.length;++d,b=c,c=[])b.forEach(function(a){a.depth=d,a.sourceLinks.forEach(function(a){c.indexOf(a.target)<0&&c.push(a.target)})});for(b=a.nodes,c=[],d=0;b.length;++d,b=c,c=[])b.forEach(function(a){a.height=d,a.targetLinks.forEach(function(a){c.indexOf(a.source)<0&&c.push(a.source)})});var f=(t-e-v)/(d-1);a.nodes.forEach(function(a){a.x1=(a.x0=e+Math.max(0,Math.min(d-1,Math.floor(y.call(null,a,d))))*f)+v})}(a),function(a){function d(){e.forEach(function(a){var b,c,d,e=s,f=a.length;for(a.sort(j),d=0;d<f;++d)b=a[d],(c=e-b.y0)>0&&(b.y0+=c,b.y1+=c),e=b.y1+w;if((c=e-w-u)>0)for(e=b.y0-=c,b.y1-=c,d=f-2;d>=0;--d)b=a[d],(c=b.y1+w-e)>0&&(b.y0-=c,b.y1-=c),e=b.y0})}var e=c.nest().key(function(a){return a.x0}).sortKeys(b.ascending).entries(a.nodes).map(function(a){return a.values});(function(){var c=b.max(e,function(a){return a.length}),d=C*(u-s)/(c-1);w>d&&(w=d);var f=b.min(e,function(a){return(u-s-(a.length-1)*w)/b.sum(a,k)});e.forEach(function(a){a.forEach(function(a,b){a.y1=(a.y0=b)+a.value*f})}),a.links.forEach(function(a){a.width=a.value*f})})(),d();for(var f=1,g=B;g>0;--g)(function(a){e.slice().reverse().forEach(function(c){c.forEach(function(c){if(c.sourceLinks.length){var d=(b.sum(c.sourceLinks,n)/b.sum(c.sourceLinks,k)-l(c))*a;c.y0+=d,c.y1+=d}})})})(f*=.99),d(),function(a){e.forEach(function(c){c.forEach(function(c){if(c.targetLinks.length){var d=(b.sum(c.targetLinks,m)/b.sum(c.targetLinks,k)-l(c))*a;c.y0+=d,c.y1+=d}})})}(f),d()}(a),d(a),a}function d(a){a.nodes.forEach(function(a){a.sourceLinks.sort(i),a.targetLinks.sort(h)}),a.nodes.forEach(function(a){var b=a.y0,c=b;a.sourceLinks.forEach(function(a){a.y0=b+a.width/2,b+=a.width}),a.targetLinks.forEach(function(a){a.y1=c+a.width/2,c+=a.width})})}var e=0,s=0,t=1,u=1,v=24,w=8,x=o,y=f,z=p,A=q,B=32,C=2/3;return a.update=function(a){return d(a),a},a.nodeId=function(b){return arguments.length?(x="function"==typeof b?b:g(b),a):x},a.nodeAlign=function(b){return arguments.length?(y="function"==typeof b?b:g(b),a):y},a.nodeWidth=function(b){return arguments.length?(v=+b,a):v},a.nodePadding=function(b){return arguments.length?(w=+b,a):w},a.nodes=function(b){return arguments.length?(z="function"==typeof b?b:g(b),a):z},a.links=function(b){return arguments.length?(A="function"==typeof b?b:g(b),a):A},a.size=function(b){return arguments.length?(e=s=0,t=+b[0],u=+b[1],a):[t-e,u-s]},a.extent=function(b){return arguments.length?(e=+b[0][0],t=+b[1][0],s=+b[0][1],u=+b[1][1],a):[[e,s],[t,u]]},a.iterations=function(b){return arguments.length?(B=+b,a):B},a},a.sankeyCenter=function(a){return a.targetLinks.length?a.depth:a.sourceLinks.length?b.min(a.sourceLinks,e)-1:0},a.sankeyLeft=function(a){return a.depth},a.sankeyRight=function(a,b){return b-1-a.height},a.sankeyJustify=f,a.sankeyLinkHorizontal=function(){return d.linkHorizontal().source(s).target(t)},Object.defineProperty(a,"__esModule",{value:!0})},"object"==typeof c&&void 0!==b?e(c,a("d3-array"),a("d3-collection"),a("d3-shape")):e(d.d3=d.d3||{},d.d3,d.d3,d.d3)},{"d3-array":153,"d3-collection":154,"d3-shape":162}],56:[function(a,b,c){"use strict";function d(a){var b=0;if(a&&a.length>0){b+=Math.abs(e(a[0]));for(var c=1;c<a.length;c++)b-=Math.abs(e(a[c]))}return b}function e(a){var b,c,d,e,g,i,j=0,k=a.length;if(k>2){for(i=0;i<k;i++)i===k-2?(d=k-2,e=k-1,g=0):i===k-1?(d=k-1,e=0,g=1):(d=i,e=i+1,g=i+2),b=a[d],c=a[e],j+=(f(a[g][0])-f(b[0]))*Math.sin(f(c[1]));j=j*h*h/2}return j}function f(a){return a*Math.PI/180}Object.defineProperty(c,"__esModule",{value:!0});var g=a("@turf/meta"),h=6378137;c.default=function(a){return g.geomReduce(a,function(a,b){return a+function(a){var b,c=0;switch(a.type){case"Polygon":return d(a.coordinates);case"MultiPolygon":for(b=0;b<a.coordinates.length;b++)c+=d(a.coordinates[b]);return c;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(b)},0)}},{"@turf/meta":59}],57:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("@turf/meta"),e=a("@turf/helpers");c.default=function(a,b){void 0===b&&(b={});var c=0,f=0,g=0;return d.coordEach(a,function(a){c+=a[0],f+=a[1],g++}),e.point([c/g,f/g],b.properties)}},{"@turf/helpers":58,"@turf/meta":59}],58:[function(a,b,c){"use strict";function d(a,b,c){void 0===c&&(c={});var d={type:"Feature"};return(0===c.id||c.id)&&(d.id=c.id),c.bbox&&(d.bbox=c.bbox),d.properties=b||{},d.geometry=a,d}function e(a,b,c){return void 0===c&&(c={}),d({type:"Point",coordinates:a},b,c)}function f(a,b,c){void 0===c&&(c={});for(var e=0,f=a;e<f.length;e++){var g=f[e];if(g.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var h=0;h<g[g.length-1].length;h++)if(g[g.length-1][h]!==g[0][h])throw new Error("First and last Position are not equivalent.")}return d({type:"Polygon",coordinates:a},b,c)}function g(a,b,c){if(void 0===c&&(c={}),a.length<2)throw new Error("coordinates must be an array of two or more positions");return d({type:"LineString",coordinates:a},b,c)}function h(a,b){void 0===b&&(b={});var c={type:"FeatureCollection"};return b.id&&(c.id=b.id),b.bbox&&(c.bbox=b.bbox),c.features=a,c}function i(a,b,c){return void 0===c&&(c={}),d({type:"MultiLineString",coordinates:a},b,c)}function j(a,b,c){return void 0===c&&(c={}),d({type:"MultiPoint",coordinates:a},b,c)}function k(a,b,c){return void 0===c&&(c={}),d({type:"MultiPolygon",coordinates:a},b,c)}function l(a,b){void 0===b&&(b="kilometers");var d=c.factors[b];if(!d)throw new Error(b+" units is invalid");return a*d}function m(a,b){void 0===b&&(b="kilometers");var d=c.factors[b];if(!d)throw new Error(b+" units is invalid");return a/d}function n(a){return a%(2*Math.PI)*180/Math.PI}function o(a){return!isNaN(a)&&null!==a&&!Array.isArray(a)&&!/^\s*$/.test(a)}Object.defineProperty(c,"__esModule",{value:!0}),c.earthRadius=6371008.8,c.factors={centimeters:100*c.earthRadius,centimetres:100*c.earthRadius,degrees:c.earthRadius/111325,feet:3.28084*c.earthRadius,inches:39.37*c.earthRadius,kilometers:c.earthRadius/1e3,kilometres:c.earthRadius/1e3,meters:c.earthRadius,metres:c.earthRadius,miles:c.earthRadius/1609.344,millimeters:1e3*c.earthRadius,millimetres:1e3*c.earthRadius,nauticalmiles:c.earthRadius/1852,radians:1,yards:c.earthRadius/1.0936},c.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/c.earthRadius,yards:1/1.0936},c.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:3.86e-7,millimeters:1e6,millimetres:1e6,yards:1.195990046},c.feature=d,c.geometry=function(a,b,c){switch(void 0===c&&(c={}),a){case"Point":return e(b).geometry;case"LineString":return g(b).geometry;case"Polygon":return f(b).geometry;case"MultiPoint":return j(b).geometry;case"MultiLineString":return i(b).geometry;case"MultiPolygon":return k(b).geometry;default:throw new Error(a+" is invalid")}},c.point=e,c.points=function(a,b,c){return void 0===c&&(c={}),h(a.map(function(a){return e(a,b)}),c)},c.polygon=f,c.polygons=function(a,b,c){return void 0===c&&(c={}),h(a.map(function(a){return f(a,b)}),c)},c.lineString=g,c.lineStrings=function(a,b,c){return void 0===c&&(c={}),h(a.map(function(a){return g(a,b)}),c)},c.featureCollection=h,c.multiLineString=i,c.multiPoint=j,c.multiPolygon=k,c.geometryCollection=function(a,b,c){return void 0===c&&(c={}),d({type:"GeometryCollection",geometries:a},b,c)},c.round=function(a,b){if(void 0===b&&(b=0),b&&!(b>=0))throw new Error("precision must be a positive number");var c=Math.pow(10,b||0);return Math.round(a*c)/c},c.radiansToLength=l,c.lengthToRadians=m,c.lengthToDegrees=function(a,b){return n(m(a,b))},c.bearingToAzimuth=function(a){var b=a%360;return b<0&&(b+=360),b},c.radiansToDegrees=n,c.degreesToRadians=function(a){return a%360*Math.PI/180},c.convertLength=function(a,b,c){if(void 0===b&&(b="kilometers"),void 0===c&&(c="kilometers"),!(a>=0))throw new Error("length must be a positive number");return l(m(a,b),c)},c.convertArea=function(a,b,d){if(void 0===b&&(b="meters"),void 0===d&&(d="kilometers"),!(a>=0))throw new Error("area must be a positive number");var e=c.areaFactors[b];if(!e)throw new Error("invalid original units");var f=c.areaFactors[d];if(!f)throw new Error("invalid final units");return a/e*f},c.isNumber=o,c.isObject=function(a){return!!a&&a.constructor===Object},c.validateBBox=function(a){if(!a)throw new Error("bbox is required");if(!Array.isArray(a))throw new Error("bbox must be an Array");if(4!==a.length&&6!==a.length)throw new Error("bbox must be an Array of 4 or 6 numbers");a.forEach(function(a){if(!o(a))throw new Error("bbox must only contain numbers")})},c.validateId=function(a){if(!a)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof a))throw new Error("id must be a number or a string")},c.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},c.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},c.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},c.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},c.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},c.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},c.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],59:[function(a,b,c){"use strict";function d(a,b,c){if(null!==a)for(var e,f,g,h,i,j,k,l,m=0,n=0,o=a.type,p="FeatureCollection"===o,q="Feature"===o,r=p?a.features.length:1,s=0;s<r;s++){i=(l=!!(k=p?a.features[s].geometry:q?a.geometry:a)&&"GeometryCollection"===k.type)?k.geometries.length:1;for(var t=0;t<i;t++){var u=0,v=0;if(null!==(h=l?k.geometries[t]:k)){j=h.coordinates;var w=h.type;switch(m=!c||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===b(j,n,s,u,v))return!1;n++,u++;break;case"LineString":case"MultiPoint":for(e=0;e<j.length;e++){if(!1===b(j[e],n,s,u,v))return!1;n++,"MultiPoint"===w&&u++}"LineString"===w&&u++;break;case"Polygon":case"MultiLineString":for(e=0;e<j.length;e++){for(f=0;f<j[e].length-m;f++){if(!1===b(j[e][f],n,s,u,v))return!1;n++}"MultiLineString"===w&&u++,"Polygon"===w&&v++}"Polygon"===w&&u++;break;case"MultiPolygon":for(e=0;e<j.length;e++){for(v=0,f=0;f<j[e].length;f++){for(g=0;g<j[e][f].length-m;g++){if(!1===b(j[e][f][g],n,s,u,v))return!1;n++}v++}u++}break;case"GeometryCollection":for(e=0;e<h.geometries.length;e++)if(!1===d(h.geometries[e],b,c))return!1;break;default:
throw new Error("Unknown Geometry Type")}}}}}function e(a,b){var c;switch(a.type){case"FeatureCollection":for(c=0;c<a.features.length&&!1!==b(a.features[c].properties,c);c++);break;case"Feature":b(a.properties,0)}}function f(a,b){if("Feature"===a.type)b(a,0);else if("FeatureCollection"===a.type)for(var c=0;c<a.features.length&&!1!==b(a.features[c],c);c++);}function g(a,b){var c,d,e,f,g,h,i,j,k,l,m=0,n="FeatureCollection"===a.type,o="Feature"===a.type,p=n?a.features.length:1;for(c=0;c<p;c++){for(h=n?a.features[c].geometry:o?a.geometry:a,j=n?a.features[c].properties:o?a.properties:{},k=n?a.features[c].bbox:o?a.bbox:void 0,l=n?a.features[c].id:o?a.id:void 0,g=(i=!!h&&"GeometryCollection"===h.type)?h.geometries.length:1,e=0;e<g;e++)if(null!==(f=i?h.geometries[e]:h))switch(f.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===b(f,m,j,k,l))return!1;break;case"GeometryCollection":for(d=0;d<f.geometries.length;d++)if(!1===b(f.geometries[d],m,j,k,l))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===b(null,m,j,k,l))return!1;m++}}function h(a,b){g(a,function(a,c,d,e,f){var g,h=null===a?null:a.type;switch(h){case null:case"Point":case"LineString":case"Polygon":return!1!==b(k.feature(a,d,{bbox:e,id:f}),c,0)&&void 0}switch(h){case"MultiPoint":g="Point";break;case"MultiLineString":g="LineString";break;case"MultiPolygon":g="Polygon"}for(var i=0;i<a.coordinates.length;i++){var j={type:g,coordinates:a.coordinates[i]};if(!1===b(k.feature(j,d),c,i))return!1}})}function i(a,b){h(a,function(a,c,e){var f=0;if(a.geometry){var g=a.geometry.type;if("Point"!==g&&"MultiPoint"!==g){var h,i=0,j=0,l=0;return!1!==d(a,function(d,g,m,n,o){if(void 0===h||c>i||n>j||o>l)return h=d,i=c,j=n,l=o,void(f=0);var p=k.lineString([h,d],a.properties);if(!1===b(p,c,e,o,f))return!1;f++,h=d})&&void 0}}})}function j(a,b){if(!a)throw new Error("geojson is required");h(a,function(a,c,d){if(null!==a.geometry){var e=a.geometry.type,f=a.geometry.coordinates;switch(e){case"LineString":if(!1===b(a,c,d,0,0))return!1;break;case"Polygon":for(var g=0;g<f.length;g++)if(!1===b(k.lineString(f[g],a.properties),c,d,g))return!1}}})}Object.defineProperty(c,"__esModule",{value:!0});var k=a("@turf/helpers");c.coordEach=d,c.coordReduce=function(a,b,c,e){var f=c;return d(a,function(a,d,e,g,h){f=0===d&&void 0===c?a:b(f,a,d,e,g,h)},e),f},c.propEach=e,c.propReduce=function(a,b,c){var d=c;return e(a,function(a,e){d=0===e&&void 0===c?a:b(d,a,e)}),d},c.featureEach=f,c.featureReduce=function(a,b,c){var d=c;return f(a,function(a,e){d=0===e&&void 0===c?a:b(d,a,e)}),d},c.coordAll=function(a){var b=[];return d(a,function(a){b.push(a)}),b},c.geomEach=g,c.geomReduce=function(a,b,c){var d=c;return g(a,function(a,e,f,g,h){d=0===e&&void 0===c?a:b(d,a,e,f,g,h)}),d},c.flattenEach=h,c.flattenReduce=function(a,b,c){var d=c;return h(a,function(a,e,f){d=0===e&&0===f&&void 0===c?a:b(d,a,e,f)}),d},c.segmentEach=i,c.segmentReduce=function(a,b,c){var d=c,e=!1;return i(a,function(a,f,g,h,i){d=!1===e&&void 0===c?a:b(d,a,f,g,h,i),e=!0}),d},c.lineEach=j,c.lineReduce=function(a,b,c){var d=c;return j(a,function(a,e,f,g){d=0===e&&void 0===c?a:b(d,a,e,f,g)}),d},c.findSegment=function(a,b){if(b=b||{},!k.isObject(b))throw new Error("options is invalid");var c,d=b.featureIndex||0,e=b.multiFeatureIndex||0,f=b.geometryIndex||0,g=b.segmentIndex||0,h=b.properties;switch(a.type){case"FeatureCollection":d<0&&(d=a.features.length+d),h=h||a.features[d].properties,c=a.features[d].geometry;break;case"Feature":h=h||a.properties,c=a.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":c=a;break;default:throw new Error("geojson is invalid")}if(null===c)return null;var i=c.coordinates;switch(c.type){case"Point":case"MultiPoint":return null;case"LineString":return g<0&&(g=i.length+g-1),k.lineString([i[g],i[g+1]],h,b);case"Polygon":return f<0&&(f=i.length+f),g<0&&(g=i[f].length+g-1),k.lineString([i[f][g],i[f][g+1]],h,b);case"MultiLineString":return e<0&&(e=i.length+e),g<0&&(g=i[e].length+g-1),k.lineString([i[e][g],i[e][g+1]],h,b);case"MultiPolygon":return e<0&&(e=i.length+e),f<0&&(f=i[e].length+f),g<0&&(g=i[e][f].length-g-1),k.lineString([i[e][f][g],i[e][f][g+1]],h,b)}throw new Error("geojson is invalid")},c.findPoint=function(a,b){if(b=b||{},!k.isObject(b))throw new Error("options is invalid");var c,d=b.featureIndex||0,e=b.multiFeatureIndex||0,f=b.geometryIndex||0,g=b.coordIndex||0,h=b.properties;switch(a.type){case"FeatureCollection":d<0&&(d=a.features.length+d),h=h||a.features[d].properties,c=a.features[d].geometry;break;case"Feature":h=h||a.properties,c=a.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":c=a;break;default:throw new Error("geojson is invalid")}if(null===c)return null;var i=c.coordinates;switch(c.type){case"Point":return k.point(i,h,b);case"MultiPoint":return e<0&&(e=i.length+e),k.point(i[e],h,b);case"LineString":return g<0&&(g=i.length+g),k.point(i[g],h,b);case"Polygon":return f<0&&(f=i.length+f),g<0&&(g=i[f].length+g),k.point(i[f][g],h,b);case"MultiLineString":return e<0&&(e=i.length+e),g<0&&(g=i[e].length+g),k.point(i[e][g],h,b);case"MultiPolygon":return e<0&&(e=i.length+e),f<0&&(f=i[e].length+f),g<0&&(g=i[e][f].length-g),k.point(i[e][f][g],h,b)}throw new Error("geojson is invalid")}},{"@turf/helpers":58}],60:[function(a,b,c){"use strict";var d="undefined"==typeof WeakMap?a("weak-map"):WeakMap,e=a("gl-buffer"),f=a("gl-vao"),g=new d;b.exports=function(a){var b=g.get(a),c=b&&(b._triangleBuffer.handle||b._triangleBuffer.buffer);if(!c||!a.isBuffer(c)){var d=e(a,new Float32Array([-1,-1,-1,4,4,-1]));(b=f(a,[{buffer:d,type:a.FLOAT,size:2}]))._triangleBuffer=d,g.set(a,b)}b.bind(),a.drawArrays(a.TRIANGLES,0,3),b.unbind()}},{"gl-buffer":242,"gl-vao":328,"weak-map":553}],61:[function(a,b,c){b.exports=function(a){var b=0,c=0,d=0,e=0;return a.map(function(a){var f=(a=a.slice())[0],g=f.toUpperCase();if(f!=g)switch(a[0]=g,f){case"a":a[6]+=d,a[7]+=e;break;case"v":a[1]+=e;break;case"h":a[1]+=d;break;default:for(var h=1;h<a.length;)a[h++]+=d,a[h++]+=e}switch(g){case"Z":d=b,e=c;break;case"H":d=a[1];break;case"V":e=a[1];break;case"M":d=b=a[1],e=c=a[2];break;default:d=a[a.length-2],e=a[a.length-1]}return a})}},{}],62:[function(a,b,c){var d=a("pad-left");b.exports=function(a,b,c){b="number"==typeof b?b:1,c=c||": ";var e=a.split(/\r?\n/),f=String(e.length+b-1).length;return e.map(function(a,e){var g=e+b,h=String(g).length;return d(g,f-h)+c+a}).join("\n")}},{"pad-left":458}],63:[function(a,b,c){"use strict";function d(a,b){for(var c=new Array(b+1),d=0;d<a.length;++d)c[d]=a[d];for(d=0;d<=a.length;++d){for(var f=a.length;f<=b;++f){for(var g=new Array(b),h=0;h<b;++h)g[h]=Math.pow(f+1-d,h);c[f]=g}if(e.apply(void 0,c))return!0}return!1}b.exports=function(a){var b=a.length;if(0===b)return[];if(1===b)return[0];for(var c=a[0].length,e=[a[0]],f=[0],g=1;g<b;++g)if(e.push(a[g]),d(e,c)){if(f.push(g),f.length===c+1)return f}else e.pop();return f};var e=a("robust-orientation")},{"robust-orientation":511}],64:[function(a,b,c){"use strict";b.exports=function(a,b){return d(b).filter(function(c){for(var d=new Array(c.length),f=0;f<c.length;++f)d[f]=b[c[f]];return e(d)*a<1})};var d=a("delaunay-triangulate"),e=a("circumradius")},{circumradius:115,"delaunay-triangulate":166}],65:[function(a,b,c){b.exports=function(a,b){return e(d(a,b))};var d=a("alpha-complex"),e=a("simplicial-complex-boundary")},{"alpha-complex":64,"simplicial-complex-boundary":518}],66:[function(a,b,c){"use strict";b.exports=function(a,b){if(!a||null==a.length)throw Error("Argument should be an array");b=null==b?1:Math.floor(b);for(var c=Array(2*b),d=0;d<b;d++){for(var e=-1/0,f=1/0,g=d,h=a.length;g<h;g+=b)a[g]>e&&(e=a[g]),a[g]<f&&(f=a[g]);c[d]=f,c[b+d]=e}return c}},{}],67:[function(a,b,c){"use strict";var d=a("array-bounds");b.exports=function(a,b,c){if(!a||null==a.length)throw Error("Argument should be an array");null==b&&(b=1),null==c&&(c=d(a,b));for(var e=0;e<b;e++){var f=c[b+e],g=c[e],h=e,i=a.length;if(f===1/0&&g===-1/0)for(h=e;h<i;h+=b)a[h]=a[h]===f?1:a[h]===g?0:.5;else if(f===1/0)for(h=e;h<i;h+=b)a[h]=a[h]===f?1:0;else if(g===-1/0)for(h=e;h<i;h+=b)a[h]=a[h]===g?0:1;else{var j=f-g;for(h=e;h<i;h+=b)a[h]=0===j?.5:(a[h]-g)/j}}return a}},{"array-bounds":66}],68:[function(a,b,c){b.exports=function(a,b){var c="number"==typeof a,d="number"==typeof b;c&&!d?(b=a,a=0):c||d||(a=0,b=0);var e=(b|=0)-(a|=0);if(e<0)throw new Error("array length must be positive");for(var f=new Array(e),g=0,h=a;g<e;g++,h++)f[g]=h;return f}},{}],69:[function(a,b,c){(function(c){"use strict";function d(a,b){if(a===b)return 0;for(var c=a.length,d=b.length,e=0,f=Math.min(c,d);e<f;++e)if(a[e]!==b[e]){c=a[e],d=b[e];break}return c<d?-1:d<c?1:0}function e(a){return c.Buffer&&"function"==typeof c.Buffer.isBuffer?c.Buffer.isBuffer(a):!(null==a||!a._isBuffer)}function f(a){return Object.prototype.toString.call(a)}function g(a){return!e(a)&&"function"==typeof c.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):!!a&&(a instanceof DataView||!!(a.buffer&&a.buffer instanceof ArrayBuffer)))}function h(a){if(r.isFunction(a)){if(u)return a.name;var b=a.toString().match(w);return b&&b[1]}}function i(a,b){return"string"==typeof a?a.length<b?a:a.slice(0,b):a}function j(a){if(u||!r.isFunction(a))return r.inspect(a);var b=h(a);return"[Function"+(b?": "+b:"")+"]"}function k(a,b,c,d,e){throw new v.AssertionError({message:c,actual:a,expected:b,operator:d,stackStartFunction:e})}function l(a,b){a||k(a,!0,b,"==",v.ok)}function m(a,b,c,h){if(a===b)return!0;if(e(a)&&e(b))return 0===d(a,b);if(r.isDate(a)&&r.isDate(b))return a.getTime()===b.getTime();if(r.isRegExp(a)&&r.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.multiline===b.multiline&&a.lastIndex===b.lastIndex&&a.ignoreCase===b.ignoreCase;if(null!==a&&"object"==typeof a||null!==b&&"object"==typeof b){if(g(a)&&g(b)&&f(a)===f(b)&&!(a instanceof Float32Array||a instanceof Float64Array))return 0===d(new Uint8Array(a.buffer),new Uint8Array(b.buffer));if(e(a)!==e(b))return!1;var i=(h=h||{actual:[],expected:[]}).actual.indexOf(a);return-1!==i&&i===h.expected.indexOf(b)||(h.actual.push(a),h.expected.push(b),function(a,b,c,d){if(null==a||null==b)return!1;if(r.isPrimitive(a)||r.isPrimitive(b))return a===b;if(c&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return!1;var e=n(a),f=n(b);if(e&&!f||!e&&f)return!1;if(e)return a=t.call(a),b=t.call(b),m(a,b,c);var g,h,i=x(a),j=x(b);if(i.length!==j.length)return!1;for(i.sort(),j.sort(),h=i.length-1;h>=0;h--)if(i[h]!==j[h])return!1;for(h=i.length-1;h>=0;h--)if(g=i[h],!m(a[g],b[g],c,d))return!1;return!0}(a,b,c,h))}return c?a===b:a==b}function n(a){return"[object Arguments]"==Object.prototype.toString.call(a)}function o(a,b){if(!a||!b)return!1;if("[object RegExp]"==Object.prototype.toString.call(b))return b.test(a);try{if(a instanceof b)return!0}catch(a){}return!Error.isPrototypeOf(b)&&!0===b.call({},a)}function p(a,b,c,d){var e;if("function"!=typeof b)throw new TypeError('"block" argument must be a function');"string"==typeof c&&(d=c,c=null),e=function(a){var b;try{a()}catch(a){b=a}return b}(b),d=(c&&c.name?" ("+c.name+").":".")+(d?" "+d:"."),a&&!e&&k(e,c,"Missing expected exception"+d);var f="string"==typeof d,g=!a&&e&&!c;if((!a&&r.isError(e)&&f&&o(e,c)||g)&&k(e,c,"Got unwanted exception"+d),a&&e&&c&&!o(e,c)||!a&&e)throw e}var q=a("object-assign"),r=a("util/"),s=Object.prototype.hasOwnProperty,t=Array.prototype.slice,u="foo"===function(){}.name,v=b.exports=l,w=/\s*function\s+([^\(\s]*)\s*/;v.AssertionError=function(a){var b;this.name="AssertionError",this.actual=a.actual,this.expected=a.expected,this.operator=a.operator,a.message?(this.message=a.message,this.generatedMessage=!1):(this.message=i(j((b=this).actual),128)+" "+b.operator+" "+i(j(b.expected),128),this.generatedMessage=!0);var c=a.stackStartFunction||k;if(Error.captureStackTrace)Error.captureStackTrace(this,c);else{var d=new Error;if(d.stack){var e=d.stack,f=h(c),g=e.indexOf("\n"+f);if(g>=0){var l=e.indexOf("\n",g+1);e=e.substring(l+1)}this.stack=e}}},r.inherits(v.AssertionError,Error),v.fail=k,v.ok=l,v.equal=function(a,b,c){a!=b&&k(a,b,c,"==",v.equal)},v.notEqual=function(a,b,c){a==b&&k(a,b,c,"!=",v.notEqual)},v.deepEqual=function(a,b,c){m(a,b,!1)||k(a,b,c,"deepEqual",v.deepEqual)},v.deepStrictEqual=function(a,b,c){m(a,b,!0)||k(a,b,c,"deepStrictEqual",v.deepStrictEqual)},v.notDeepEqual=function(a,b,c){m(a,b,!1)&&k(a,b,c,"notDeepEqual",v.notDeepEqual)},v.notDeepStrictEqual=function a(b,c,d){m(b,c,!0)&&k(b,c,d,"notDeepStrictEqual",a)},v.strictEqual=function(a,b,c){a!==b&&k(a,b,c,"===",v.strictEqual)},v.notStrictEqual=function(a,b,c){a===b&&k(a,b,c,"!==",v.notStrictEqual)},v.throws=function(a,b,c){p(!0,a,b,c)},v.doesNotThrow=function(a,b,c){p(!1,a,b,c)},v.ifError=function(a){if(a)throw a},v.strict=q(function a(b,c){b||k(b,!0,c,"==",a)},v,{equal:v.strictEqual,deepEqual:v.deepStrictEqual,notEqual:v.notStrictEqual,notDeepEqual:v.notDeepStrictEqual}),v.strict.strict=v.strict;var x=Object.keys||function(a){var b=[];for(var c in a)s.call(a,c)&&b.push(c);return b}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"object-assign":455,"util/":72}],70:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],71:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],72:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),l(b)?d.showHidden=b:b&&c._extend(d,b),p(d.showHidden)&&(d.showHidden=!1),p(d.depth)&&(d.depth=2),p(d.colors)&&(d.colors=!1),p(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),h(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a,b,d){if(a.customInspect&&b&&u(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return o(e)||(e=h(a,e,d)),e}var f=function(a,b){if(p(b))return a.stylize("undefined","undefined");if(o(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return n(b)?a.stylize(""+b,"number"):l(b)?a.stylize(""+b,"boolean"):m(b)?a.stylize("null","null"):void 0}(a,b);if(f)return f;var g=Object.keys(b),r=function(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),t(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return i(b);if(0===g.length){if(u(b)){var v=b.name?": "+b.name:"";return a.stylize("[Function"+v+"]","special")}if(q(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(s(b))return a.stylize(Date.prototype.toString.call(b),"date");if(t(b))return i(b)}var w,y="",z=!1,A=["{","}"];return k(b)&&(z=!0,A=["[","]"]),u(b)&&(y=" [Function"+(b.name?": "+b.name:"")+"]"),q(b)&&(y=" "+RegExp.prototype.toString.call(b)),s(b)&&(y=" "+Date.prototype.toUTCString.call(b)),t(b)&&(y=" "+i(b)),0!==g.length||z&&0!=b.length?d<0?q(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special"):(a.seen.push(b),w=z?function(a,b,c,d,e){for(var f=[],g=0,h=b.length;g<h;++g)x(b,String(g))?f.push(j(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(j(a,b,c,d,e,!0))}),f}(a,b,d,r,g):g.map(function(c){return j(a,b,d,r,c,z)}),a.seen.pop(),function(a,b,c){return a.reduce(function(a,b){return b.indexOf("\n"),a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}(w,y,A)):A[0]+y+A[1]}function i(a){return"["+Error.prototype.toString.call(a)+"]"}function j(a,b,c,d,e,f){var g,i,j;if((j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]}).get?i=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(i=a.stylize("[Setter]","special")),x(d,e)||(g="["+e+"]"),i||(a.seen.indexOf(j.value)<0?(i=m(c)?h(a,j.value,null):h(a,j.value,c-1)).indexOf("\n")>-1&&(i=f?i.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+i.split("\n").map(function(a){return"   "+a}).join("\n")):i=a.stylize("[Circular]","special")),p(g)){if(f&&e.match(/^\d+$/))return i;(g=JSON.stringify(""+e)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+i}function k(a){return Array.isArray(a)}function l(a){return"boolean"==typeof a}function m(a){return null===a}function n(a){return"number"==typeof a}function o(a){return"string"==typeof a}function p(a){return void 0===a}function q(a){return r(a)&&"[object RegExp]"===v(a)}function r(a){return"object"==typeof a&&null!==a}function s(a){return r(a)&&"[object Date]"===v(a)}function t(a){return r(a)&&("[object Error]"===v(a)||a instanceof Error)}function u(a){return"function"==typeof a}function v(a){return Object.prototype.toString.call(a)}function w(a){return a<10?"0"+a.toString(10):a.toString(10)}function x(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var y=/%[sdj%]/g;c.format=function(a){if(!o(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}c=1;for(var d=arguments,f=d.length,g=String(a).replace(y,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(a){return"[Circular]"}default:return a}}),h=d[c];c<f;h=d[++c])m(h)||!r(h)?g+=" "+h:g+=" "+e(h);return g},c.deprecate=function(a,e){if(p(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(!0===b.noDeprecation)return a;var f=!1;return function(){if(!f){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),f=!0}return a.apply(this,arguments)}};var z,A={};c.debuglog=function(a){if(p(z)&&(z=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!A[a])if(new RegExp("\\b"+a+"\\b","i").test(z)){var d=b.pid;A[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else A[a]=function(){};return A[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=k,c.isBoolean=l,c.isNull=m,c.isNullOrUndefined=function(a){return null==a},c.isNumber=n,c.isString=o,c.isSymbol=function(a){return"symbol"==typeof a},c.isUndefined=p,c.isRegExp=q,c.isObject=r,c.isDate=s,c.isError=t,c.isFunction=u,c.isPrimitive=function(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||void 0===a},c.isBuffer=a("./support/isBuffer");var B=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){var a,b;console.log("%s - %s",(a=new Date,b=[w(a.getHours()),w(a.getMinutes()),w(a.getSeconds())].join(":"),[a.getDate(),B[a.getMonth()],b].join(" ")),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!r(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":71,_process:483,inherits:70}],73:[function(a,b,c){b.exports=function(a){return atob(a)}},{}],74:[function(a,b,c){"use strict";function d(a){for(var b=0,c=0;c<a.length;++c)b+=a[c];return b}b.exports=function(a,b){for(var c=b.length,f=new Array(c+1),g=0;g<c;++g){for(var h=new Array(c+1),i=0;i<=c;++i)h[i]=a[i][g];f[g]=h}f[c]=new Array(c+1);for(var g=0;g<=c;++g)f[c][g]=1;for(var j=new Array(c+1),g=0;g<c;++g)j[g]=b[g];j[c]=1;var k=e(f,j),l=d(k[c+1]);0===l&&(l=1);for(var m=new Array(c+1),g=0;g<=c;++g)m[g]=d(k[g])/l;return m};var e=a("robust-linear-solve")},{"robust-linear-solve":510}],75:[function(a,b,c){"use strict";function d(a){var b=a.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");return-1===c&&(c=b),[c,c===b?0:4-c%4]}function e(a,b,c){for(var d,e,g=[],h=b;h<c;h+=3)d=(a[h]<<16&16711680)+(a[h+1]<<8&65280)+(255&a[h+2]),g.push(f[(e=d)>>18&63]+f[e>>12&63]+f[e>>6&63]+f[63&e]);return g.join("")}c.byteLength=function(a){var b=d(a),c=b[0],e=b[1];return 3*(c+e)/4-e},c.toByteArray=function(a){var b,c,e=d(a),f=e[0],i=e[1],j=new h(function(a,b,c){return 3*(b+c)/4-c}(0,f,i)),k=0,l=i>0?f-4:f;for(c=0;c<l;c+=4)b=g[a.charCodeAt(c)]<<18|g[a.charCodeAt(c+1)]<<12|g[a.charCodeAt(c+2)]<<6|g[a.charCodeAt(c+3)],j[k++]=b>>16&255,j[k++]=b>>8&255,j[k++]=255&b;return 2===i&&(b=g[a.charCodeAt(c)]<<2|g[a.charCodeAt(c+1)]>>4,j[k++]=255&b),1===i&&(b=g[a.charCodeAt(c)]<<10|g[a.charCodeAt(c+1)]<<4|g[a.charCodeAt(c+2)]>>2,j[k++]=b>>8&255,j[k++]=255&b),j},c.fromByteArray=function(a){for(var b,c=a.length,d=c%3,g=[],h=0,i=c-d;h<i;h+=16383)g.push(e(a,h,h+16383>i?i:h+16383));return 1===d?(b=a[c-1],g.push(f[b>>2]+f[b<<4&63]+"==")):2===d&&(b=(a[c-2]<<8)+a[c-1],g.push(f[b>>10]+f[b>>4&63]+f[b<<2&63]+"=")),g.join("")};for(var f=[],g=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",j=0,k=i.length;j<k;++j)f[j]=i[j],g[i.charCodeAt(j)]=j;g["-".charCodeAt(0)]=62,g["_".charCodeAt(0)]=63},{}],76:[function(a,b,c){"use strict";var d=a("./lib/rationalize");b.exports=function(a,b){return d(a[0].mul(b[1]).add(b[0].mul(a[1])),a[1].mul(b[1]))}},{"./lib/rationalize":86}],77:[function(a,b,c){"use strict";b.exports=function(a,b){return a[0].mul(b[1]).cmp(b[0].mul(a[1]))}},{}],78:[function(a,b,c){"use strict";var d=a("./lib/rationalize");b.exports=function(a,b){return d(a[0].mul(b[1]),a[1].mul(b[0]))}},{"./lib/rationalize":86}],79:[function(a,b,c){"use strict";var d=a("./is-rat"),e=a("./lib/is-bn"),f=a("./lib/num-to-bn"),g=a("./lib/str-to-bn"),h=a("./lib/rationalize"),i=a("./div");b.exports=function a(b,c){if(d(b))return c?i(b,a(c)):[b[0].clone(),b[1].clone()];var j,k,l=0;if(e(b))j=b.clone();else if("string"==typeof b)j=g(b);else{if(0===b)return[f(0),f(1)];if(b===Math.floor(b))j=f(b);else{for(;b!==Math.floor(b);)b*=Math.pow(2,256),l-=256;j=f(b)}}if(d(c))j.mul(c[1]),k=c[0].clone();else if(e(c))k=c.clone();else if("string"==typeof c)k=g(c);else if(c)if(c===Math.floor(c))k=f(c);else{for(;c!==Math.floor(c);)c*=Math.pow(2,256),l+=256;k=f(c)}else k=f(1);return l>0?j=j.ushln(l):l<0&&(k=k.ushln(-l)),h(j,k)}},{"./div":78,"./is-rat":80,"./lib/is-bn":84,"./lib/num-to-bn":85,"./lib/rationalize":86,"./lib/str-to-bn":87}],80:[function(a,b,c){"use strict";var d=a("./lib/is-bn");b.exports=function(a){return Array.isArray(a)&&2===a.length&&d(a[0])&&d(a[1])}},{"./lib/is-bn":84}],81:[function(a,b,c){"use strict";var d=a("bn.js");b.exports=function(a){return a.cmp(new d(0))}},{"bn.js":95}],82:[function(a,b,c){"use strict";var d=a("./bn-sign");b.exports=function(a){var b=a.length,c=a.words,e=0;if(1===b)e=c[0];else if(2===b)e=c[0]+67108864*c[1];else for(var f=0;f<b;f++){var g=c[f];e+=g*Math.pow(67108864,f)}return d(a)*e}},{"./bn-sign":81}],83:[function(a,b,c){"use strict";var d=a("double-bits"),e=a("bit-twiddle").countTrailingZeros;b.exports=function(a){var b=e(d.lo(a));if(b<32)return b;var c=e(d.hi(a));return c>20?52:c+32}},{"bit-twiddle":93,"double-bits":168}],84:[function(a,b,c){"use strict";a("bn.js"),b.exports=function(a){return a&&"object"==typeof a&&Boolean(a.words)}},{"bn.js":95}],85:[function(a,b,c){"use strict";var d=a("bn.js"),e=a("double-bits");b.exports=function(a){var b=e.exponent(a);return b<52?new d(a):new d(a*Math.pow(2,52-b)).ushln(b-52)}},{"bn.js":95,"double-bits":168}],86:[function(a,b,c){"use strict";var d=a("./num-to-bn"),e=a("./bn-sign");b.exports=function(a,b){var c=e(a),f=e(b);if(0===c)return[d(0),d(1)];if(0===f)return[d(0),d(0)];f<0&&(a=a.neg(),b=b.neg());var g=a.gcd(b);return g.cmpn(1)?[a.div(g),b.div(g)]:[a,b]}},{"./bn-sign":81,"./num-to-bn":85}],87:[function(a,b,c){"use strict";var d=a("bn.js");b.exports=function(a){return new d(a)}},{"bn.js":95}],88:[function(a,b,c){"use strict";var d=a("./lib/rationalize");b.exports=function(a,b){return d(a[0].mul(b[0]),a[1].mul(b[1]))}},{"./lib/rationalize":86}],89:[function(a,b,c){"use strict";var d=a("./lib/bn-sign");b.exports=function(a){return d(a[0])*d(a[1])}},{"./lib/bn-sign":81}],90:[function(a,b,c){"use strict";var d=a("./lib/rationalize");b.exports=function(a,b){return d(a[0].mul(b[1]).sub(a[1].mul(b[0])),a[1].mul(b[1]))}},{"./lib/rationalize":86}],91:[function(a,b,c){"use strict";var d=a("./lib/bn-to-num"),e=a("./lib/ctz");b.exports=function(a){var b=a[0],c=a[1];if(0===b.cmpn(0))return 0;var f=b.abs().divmod(c.abs()),g=f.div,h=d(g),i=f.mod,j=b.negative!==c.negative?-1:1;if(0===i.cmpn(0))return j*h;if(h){var k=e(h)+4,l=d(i.ushln(k).divRound(c));return j*(h+l*Math.pow(2,-k))}var m=c.bitLength()-i.bitLength()+53,l=d(i.ushln(m).divRound(c));return m<1023?j*l*Math.pow(2,-m):(l*=Math.pow(2,-1023),j*l*Math.pow(2,1023-m))}},{"./lib/bn-to-num":82,"./lib/ctz":83}],92:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){var g=["function ",a,"(a,l,h,",d.join(","),"){",f?"":"var i=",c?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",e?".get(m)":"[m]"];return f?b.indexOf("c")<0?g.push(";if(x===y){return m}else if(x<=y){"):g.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):g.push(";if(",b,"){i=m;"),c?g.push("l=m+1}else{h=m-1}"):g.push("h=m-1}else{l=m+1}"),g.push("}"),f?g.push("return -1};"):g.push("return i};"),g.join("")}function e(a,b,c,e){return new Function([d("A","x"+a+"y",b,["y"],!1,e),d("B","x"+a+"y",b,["y"],!0,e),d("P","c(x,y)"+a+"0",b,["y","c"],!1,e),d("Q","c(x,y)"+a+"0",b,["y","c"],!0,e),"function dispatchBsearch",c,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",c].join(""))()}b.exports={ge:e(">=",!1,"GE"),gt:e(">",!1,"GT"),lt:e("<",!0,"LT"),le:e("<=",!0,"LE"),eq:e("-",!0,"EQ",!0)}},{}],93:[function(a,b,c){"use strict";function d(a){var b=32;return(a&=-a)&&b--,65535&a&&(b-=16),16711935&a&&(b-=8),252645135&a&&(b-=4),858993459&a&&(b-=2),1431655765&a&&(b-=1),b}c.INT_BITS=32,c.INT_MAX=2147483647,c.INT_MIN=-1<<31,c.sign=function(a){return(a>0)-(a<0)},c.abs=function(a){var b=a>>31;return(a^b)-b},c.min=function(a,b){return b^(a^b)&-(a<b)},c.max=function(a,b){return a^(a^b)&-(a<b)},c.isPow2=function(a){return!(a&a-1||!a)},c.log2=function(a){var b,c;return b=(a>65535)<<4,b|=c=((a>>>=b)>255)<<3,b|=c=((a>>>=c)>15)<<2,(b|=c=((a>>>=c)>3)<<1)|(a>>>=c)>>1},c.log10=function(a){return a>=1e9?9:a>=1e8?8:a>=1e7?7:a>=1e6?6:a>=1e5?5:a>=1e4?4:a>=1e3?3:a>=100?2:a>=10?1:0},c.popCount=function(a){return 16843009*((a=(858993459&(a-=a>>>1&1431655765))+(a>>>2&858993459))+(a>>>4)&252645135)>>>24},c.countTrailingZeros=d,c.nextPow2=function(a){return a+=0===a,--a,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,1+(a|=a>>>16)},c.prevPow2=function(a){return a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,(a|=a>>>16)-(a>>>1)},c.parity=function(a){return a^=a>>>16,a^=a>>>8,a^=a>>>4,27030>>>(a&=15)&1};var e=new Array(256);!function(a){for(var b=0;b<256;++b){var c=b,d=b,e=7;for(c>>>=1;c;c>>>=1)d<<=1,d|=1&c,--e;a[b]=d<<e&255}}(e),c.reverse=function(a){return e[255&a]<<24|e[a>>>8&255]<<16|e[a>>>16&255]<<8|e[a>>>24&255]},c.interleave2=function(a,b){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a&=65535)|a<<8))|a<<4))|a<<2))|a<<1))|(b=1431655765&((b=858993459&((b=252645135&((b=16711935&((b&=65535)|b<<8))|b<<4))|b<<2))|b<<1))<<1},c.deinterleave2=function(a,b){return(a=65535&((a=16711935&((a=252645135&((a=858993459&((a=a>>>b&1431655765)|a>>>1))|a>>>2))|a>>>4))|a>>>16))<<16>>16},c.interleave3=function(a,b,c){return a=1227133513&((a=3272356035&((a=251719695&((a=4278190335&((a&=1023)|a<<16))|a<<8))|a<<4))|a<<2),(a|=(b=1227133513&((b=3272356035&((b=251719695&((b=4278190335&((b&=1023)|b<<16))|b<<8))|b<<4))|b<<2))<<1)|(c=1227133513&((c=3272356035&((c=251719695&((c=4278190335&((c&=1023)|c<<16))|c<<8))|c<<4))|c<<2))<<2},c.deinterleave3=function(a,b){return(a=1023&((a=4278190335&((a=251719695&((a=3272356035&((a=a>>>b&1227133513)|a>>>2))|a>>>4))|a>>>8))|a>>>16))<<22>>22},c.nextCombination=function(a){var b=a|a-1;return b+1|(~b&-~b)-1>>>d(a)+1}},{}],94:[function(a,b,c){"use strict";function d(a,b,c,d,f,g,h){for(var i=0;i<b;i++){for(var j=0;j<c;j++)d[j]=a[j*b+i];for(e(d,f,g,h,c),j=0;j<c;j++)a[j*b+i]=f[j]}for(j=0;j<c;j++){for(i=0;i<b;i++)d[i]=a[j*b+i];for(e(d,f,g,h,b),i=0;i<b;i++)a[j*b+i]=Math.sqrt(f[i])}}function e(a,b,c,d,e){c[0]=0,d[0]=-g,d[1]=+g;for(var f=1,h=0;f<e;f++){for(var i=(a[f]+f*f-(a[c[h]]+c[h]*c[h]))/(2*f-2*c[h]);i<=d[h];)h--,i=(a[f]+f*f-(a[c[h]]+c[h]*c[h]))/(2*f-2*c[h]);c[++h]=f,d[h]=i,d[h+1]=+g}for(f=0,h=0;f<e;f++){for(;d[h+1]<f;)h++;b[f]=(f-c[h])*(f-c[h])+a[c[h]]}}var f=a("clamp");b.exports=function(a,b){b||(b={});var c,e,h,i,j,k,l,m,n,o,p,q=null==b.cutoff?.25:b.cutoff,r=null==b.radius?8:b.radius,s=b.channel||0;if(ArrayBuffer.isView(a)||Array.isArray(a)){if(!b.width||!b.height)throw Error("For raw data width and height should be provided by options");c=b.width,e=b.height,i=a,k=b.stride?b.stride:Math.floor(a.length/c/e)}else window.HTMLCanvasElement&&a instanceof window.HTMLCanvasElement?(l=(m=a).getContext("2d"),c=m.width,e=m.height,n=l.getImageData(0,0,c,e),i=n.data,k=4):window.CanvasRenderingContext2D&&a instanceof window.CanvasRenderingContext2D?(m=a.canvas,l=a,c=m.width,e=m.height,n=l.getImageData(0,0,c,e),i=n.data,k=4):window.ImageData&&a instanceof window.ImageData&&(n=a,c=a.width,e=a.height,i=n.data,k=4);if(h=Math.max(c,e),window.Uint8ClampedArray&&i instanceof window.Uint8ClampedArray||window.Uint8Array&&i instanceof window.Uint8Array)for(j=i,i=Array(c*e),o=0,p=j.length;o<p;o++)i[o]=j[o*k+s]/255;else if(1!==k)throw Error("Raw data can have only 1 value per pixel");var t=Array(c*e),u=Array(c*e),v=Array(h),w=Array(h),x=Array(h+1),y=Array(h);for(o=0,p=c*e;o<p;o++){var z=i[o];t[o]=1===z?0:0===z?g:Math.pow(Math.max(0,.5-z),2),u[o]=1===z?g:0===z?0:Math.pow(Math.max(0,z-.5),2)}d(t,c,e,v,w,y,x),d(u,c,e,v,w,y,x);var A=window.Float32Array?new Float32Array(c*e):new Array(c*e);for(o=0,p=c*e;o<p;o++)A[o]=f(1-((t[o]-u[o])/r+q),0,1);return A};var g=1e20},{clamp:116}],95:[function(a,b,c){!function(b,c){"use strict";function d(a,b){if(!a)throw new Error(b||"Assertion failed")}function e(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}function f(a,b,c){if(f.isBN(a))return a;this.negative=0,this.words=null,this.length=0,this.red=null,null!==a&&("le"!==b&&"be"!==b||(c=b,b=10),this._init(a||0,b||10,c||"be"))}function g(a,b,c){for(var d=0,e=Math.min(a.length,c),f=b;f<e;f++){var g=a.charCodeAt(f)-48;d<<=4,d|=g>=49&&g<=54?g-49+10:g>=17&&g<=22?g-17+10:15&g}return d}function h(a,b,c,d){for(var e=0,f=Math.min(a.length,c),g=b;g<f;g++){var h=a.charCodeAt(g)-48;e*=d,e+=h>=49?h-49+10:h>=17?h-17+10:h}return e}function i(a,b,c){c.negative=b.negative^a.negative;var d=a.length+b.length|0;c.length=d,d=d-1|0;var e=0|a.words[0],f=0|b.words[0],g=e*f,h=67108863&g,i=g/67108864|0;c.words[0]=h;for(var j=1;j<d;j++){
for(var k=i>>>26,l=67108863&i,m=Math.min(j,b.length-1),n=Math.max(0,j-a.length+1);n<=m;n++){var o=j-n|0;k+=(g=(e=0|a.words[o])*(f=0|b.words[n])+l)/67108864|0,l=67108863&g}c.words[j]=0|l,i=0|k}return 0!==i?c.words[j]=0|i:c.length--,c.strip()}function j(a,b,c){return(new k).mulp(a,b,c)}function k(a,b){this.x=a,this.y=b}function l(a,b){this.name=a,this.p=new f(b,16),this.n=this.p.bitLength(),this.k=new f(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function m(){l.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function n(){l.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function o(){l.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function p(){l.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function q(a){if("string"==typeof a){var b=f._prime(a);this.m=b.p,this.prime=b}else d(a.gtn(1),"modulus must be greater than 1"),this.m=a,this.prime=null}function r(a){q.call(this,a),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new f(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}var s;"object"==typeof b?b.exports=f:c.BN=f,f.BN=f,f.wordSize=26;try{s=a("buffer").Buffer}catch(a){}f.isBN=function(a){return a instanceof f||null!==a&&"object"==typeof a&&a.constructor.wordSize===f.wordSize&&Array.isArray(a.words)},f.max=function(a,b){return a.cmp(b)>0?a:b},f.min=function(a,b){return a.cmp(b)<0?a:b},f.prototype._init=function(a,b,c){if("number"==typeof a)return this._initNumber(a,b,c);if("object"==typeof a)return this._initArray(a,b,c);"hex"===b&&(b=16),d(b===(0|b)&&b>=2&&b<=36);var e=0;"-"===(a=a.toString().replace(/\s+/g,""))[0]&&e++,16===b?this._parseHex(a,e):this._parseBase(a,b,e),"-"===a[0]&&(this.negative=1),this.strip(),"le"===c&&this._initArray(this.toArray(),b,c)},f.prototype._initNumber=function(a,b,c){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[67108863&a],this.length=1):a<4503599627370496?(this.words=[67108863&a,a/67108864&67108863],this.length=2):(d(a<9007199254740992),this.words=[67108863&a,a/67108864&67108863,1],this.length=3),"le"===c&&this._initArray(this.toArray(),b,c)},f.prototype._initArray=function(a,b,c){if(d("number"==typeof a.length),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var e=0;e<this.length;e++)this.words[e]=0;var f,g,h=0;if("be"===c)for(e=a.length-1,f=0;e>=0;e-=3)g=a[e]|a[e-1]<<8|a[e-2]<<16,this.words[f]|=g<<h&67108863,this.words[f+1]=g>>>26-h&67108863,(h+=24)>=26&&(h-=26,f++);else if("le"===c)for(e=0,f=0;e<a.length;e+=3)g=a[e]|a[e+1]<<8|a[e+2]<<16,this.words[f]|=g<<h&67108863,this.words[f+1]=g>>>26-h&67108863,(h+=24)>=26&&(h-=26,f++);return this.strip()},f.prototype._parseHex=function(a,b){this.length=Math.ceil((a.length-b)/6),this.words=new Array(this.length);for(var c=0;c<this.length;c++)this.words[c]=0;var d,e,f=0;for(c=a.length-6,d=0;c>=b;c-=6)e=g(a,c,c+6),this.words[d]|=e<<f&67108863,this.words[d+1]|=e>>>26-f&4194303,(f+=24)>=26&&(f-=26,d++);c+6!==b&&(e=g(a,b,c+6),this.words[d]|=e<<f&67108863,this.words[d+1]|=e>>>26-f&4194303),this.strip()},f.prototype._parseBase=function(a,b,c){this.words=[0],this.length=1;for(var d=0,e=1;e<=67108863;e*=b)d++;d--,e=e/b|0;for(var f=a.length-c,g=f%d,i=Math.min(f,f-g)+c,j=0,k=c;k<i;k+=d)j=h(a,k,k+d,b),this.imuln(e),this.words[0]+j<67108864?this.words[0]+=j:this._iaddn(j);if(0!==g){var l=1;for(j=h(a,k,a.length,b),k=0;k<g;k++)l*=b;this.imuln(l),this.words[0]+j<67108864?this.words[0]+=j:this._iaddn(j)}},f.prototype.copy=function(a){a.words=new Array(this.length);for(var b=0;b<this.length;b++)a.words[b]=this.words[b];a.length=this.length,a.negative=this.negative,a.red=this.red},f.prototype.clone=function(){var a=new f(null);return this.copy(a),a},f.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},f.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},f.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},f.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var t=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],v=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];f.prototype.toString=function(a,b){var c;if(b=0|b||1,16===(a=a||10)||"hex"===a){c="";for(var e=0,f=0,g=0;g<this.length;g++){var h=this.words[g],i=(16777215&(h<<e|f)).toString(16);c=0!=(f=h>>>24-e&16777215)||g!==this.length-1?t[6-i.length]+i+c:i+c,(e+=2)>=26&&(e-=26,g--)}for(0!==f&&(c=f.toString(16)+c);c.length%b!=0;)c="0"+c;return 0!==this.negative&&(c="-"+c),c}if(a===(0|a)&&a>=2&&a<=36){var j=u[a],k=v[a];c="";var l=this.clone();for(l.negative=0;!l.isZero();){var m=l.modn(k).toString(a);c=(l=l.idivn(k)).isZero()?m+c:t[j-m.length]+m+c}for(this.isZero()&&(c="0"+c);c.length%b!=0;)c="0"+c;return 0!==this.negative&&(c="-"+c),c}d(!1,"Base should be between 2 and 36")},f.prototype.toNumber=function(){var a=this.words[0];return 2===this.length?a+=67108864*this.words[1]:3===this.length&&1===this.words[2]?a+=4503599627370496+67108864*this.words[1]:this.length>2&&d(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-a:a},f.prototype.toJSON=function(){return this.toString(16)},f.prototype.toBuffer=function(a,b){return d(void 0!==s),this.toArrayLike(s,a,b)},f.prototype.toArray=function(a,b){return this.toArrayLike(Array,a,b)},f.prototype.toArrayLike=function(a,b,c){var e=this.byteLength(),f=c||Math.max(1,e);d(e<=f,"byte array longer than desired length"),d(f>0,"Requested array length <= 0"),this.strip();var g,h,i="le"===b,j=new a(f),k=this.clone();if(i){for(h=0;!k.isZero();h++)g=k.andln(255),k.iushrn(8),j[h]=g;for(;h<f;h++)j[h]=0}else{for(h=0;h<f-e;h++)j[h]=0;for(h=0;!k.isZero();h++)g=k.andln(255),k.iushrn(8),j[f-h-1]=g}return j},Math.clz32?f.prototype._countBits=function(a){return 32-Math.clz32(a)}:f.prototype._countBits=function(a){var b=a,c=0;return b>=4096&&(c+=13,b>>>=13),b>=64&&(c+=7,b>>>=7),b>=8&&(c+=4,b>>>=4),b>=2&&(c+=2,b>>>=2),c+b},f.prototype._zeroBits=function(a){if(0===a)return 26;var b=a,c=0;return 0==(8191&b)&&(c+=13,b>>>=13),0==(127&b)&&(c+=7,b>>>=7),0==(15&b)&&(c+=4,b>>>=4),0==(3&b)&&(c+=2,b>>>=2),0==(1&b)&&c++,c},f.prototype.bitLength=function(){var a=this.words[this.length-1],b=this._countBits(a);return 26*(this.length-1)+b},f.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,b=0;b<this.length;b++){var c=this._zeroBits(this.words[b]);if(a+=c,26!==c)break}return a},f.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},f.prototype.toTwos=function(a){return 0!==this.negative?this.abs().inotn(a).iaddn(1):this.clone()},f.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},f.prototype.isNeg=function(){return 0!==this.negative},f.prototype.neg=function(){return this.clone().ineg()},f.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},f.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var b=0;b<a.length;b++)this.words[b]=this.words[b]|a.words[b];return this.strip()},f.prototype.ior=function(a){return d(0==(this.negative|a.negative)),this.iuor(a)},f.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},f.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},f.prototype.iuand=function(a){var b;b=this.length>a.length?a:this;for(var c=0;c<b.length;c++)this.words[c]=this.words[c]&a.words[c];return this.length=b.length,this.strip()},f.prototype.iand=function(a){return d(0==(this.negative|a.negative)),this.iuand(a)},f.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},f.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},f.prototype.iuxor=function(a){var b,c;this.length>a.length?(b=this,c=a):(b=a,c=this);for(var d=0;d<c.length;d++)this.words[d]=b.words[d]^c.words[d];if(this!==b)for(;d<b.length;d++)this.words[d]=b.words[d];return this.length=b.length,this.strip()},f.prototype.ixor=function(a){return d(0==(this.negative|a.negative)),this.iuxor(a)},f.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},f.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},f.prototype.inotn=function(a){d("number"==typeof a&&a>=0);var b=0|Math.ceil(a/26),c=a%26;this._expand(b),c>0&&b--;for(var e=0;e<b;e++)this.words[e]=67108863&~this.words[e];return c>0&&(this.words[e]=~this.words[e]&67108863>>26-c),this.strip()},f.prototype.notn=function(a){return this.clone().inotn(a)},f.prototype.setn=function(a,b){d("number"==typeof a&&a>=0);var c=a/26|0,e=a%26;return this._expand(c+1),this.words[c]=b?this.words[c]|1<<e:this.words[c]&~(1<<e),this.strip()},f.prototype.iadd=function(a){var b,c,d;if(0!==this.negative&&0===a.negative)return this.negative=0,b=this.isub(a),this.negative^=1,this._normSign();if(0===this.negative&&0!==a.negative)return a.negative=0,b=this.isub(a),a.negative=1,b._normSign();this.length>a.length?(c=this,d=a):(c=a,d=this);for(var e=0,f=0;f<d.length;f++)b=(0|c.words[f])+(0|d.words[f])+e,this.words[f]=67108863&b,e=b>>>26;for(;0!==e&&f<c.length;f++)b=(0|c.words[f])+e,this.words[f]=67108863&b,e=b>>>26;if(this.length=c.length,0!==e)this.words[this.length]=e,this.length++;else if(c!==this)for(;f<c.length;f++)this.words[f]=c.words[f];return this},f.prototype.add=function(a){var b;return 0!==a.negative&&0===this.negative?(a.negative=0,b=this.sub(a),a.negative^=1,b):0===a.negative&&0!==this.negative?(this.negative=0,b=a.sub(this),this.negative=1,b):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},f.prototype.isub=function(a){if(0!==a.negative){a.negative=0;var b=this.iadd(a);return a.negative=1,b._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var c,d,e=this.cmp(a);if(0===e)return this.negative=0,this.length=1,this.words[0]=0,this;e>0?(c=this,d=a):(c=a,d=this);for(var f=0,g=0;g<d.length;g++)f=(b=(0|c.words[g])-(0|d.words[g])+f)>>26,this.words[g]=67108863&b;for(;0!==f&&g<c.length;g++)f=(b=(0|c.words[g])+f)>>26,this.words[g]=67108863&b;if(0===f&&g<c.length&&c!==this)for(;g<c.length;g++)this.words[g]=c.words[g];return this.length=Math.max(this.length,g),c!==this&&(this.negative=1),this.strip()},f.prototype.sub=function(a){return this.clone().isub(a)};var w=function(a,b,c){var d,e,f,g=a.words,h=b.words,i=c.words,j=0,k=0|g[0],l=8191&k,m=k>>>13,n=0|g[1],o=8191&n,p=n>>>13,q=0|g[2],r=8191&q,s=q>>>13,t=0|g[3],u=8191&t,v=t>>>13,w=0|g[4],x=8191&w,y=w>>>13,z=0|g[5],A=8191&z,B=z>>>13,C=0|g[6],D=8191&C,E=C>>>13,F=0|g[7],G=8191&F,H=F>>>13,I=0|g[8],J=8191&I,K=I>>>13,L=0|g[9],M=8191&L,N=L>>>13,O=0|h[0],P=8191&O,Q=O>>>13,R=0|h[1],S=8191&R,T=R>>>13,U=0|h[2],V=8191&U,W=U>>>13,X=0|h[3],Y=8191&X,Z=X>>>13,$=0|h[4],_=8191&$,aa=$>>>13,ba=0|h[5],ca=8191&ba,da=ba>>>13,ea=0|h[6],fa=8191&ea,ga=ea>>>13,ha=0|h[7],ia=8191&ha,ja=ha>>>13,ka=0|h[8],la=8191&ka,ma=ka>>>13,na=0|h[9],oa=8191&na,pa=na>>>13;c.negative=a.negative^b.negative,c.length=19;var qa=(j+(d=Math.imul(l,P))|0)+((8191&(e=(e=Math.imul(l,Q))+Math.imul(m,P)|0))<<13)|0;j=((f=Math.imul(m,Q))+(e>>>13)|0)+(qa>>>26)|0,qa&=67108863,d=Math.imul(o,P),e=(e=Math.imul(o,Q))+Math.imul(p,P)|0,f=Math.imul(p,Q);var ra=(j+(d=d+Math.imul(l,S)|0)|0)+((8191&(e=(e=e+Math.imul(l,T)|0)+Math.imul(m,S)|0))<<13)|0;j=((f=f+Math.imul(m,T)|0)+(e>>>13)|0)+(ra>>>26)|0,ra&=67108863,d=Math.imul(r,P),e=(e=Math.imul(r,Q))+Math.imul(s,P)|0,f=Math.imul(s,Q),d=d+Math.imul(o,S)|0,e=(e=e+Math.imul(o,T)|0)+Math.imul(p,S)|0,f=f+Math.imul(p,T)|0;var sa=(j+(d=d+Math.imul(l,V)|0)|0)+((8191&(e=(e=e+Math.imul(l,W)|0)+Math.imul(m,V)|0))<<13)|0;j=((f=f+Math.imul(m,W)|0)+(e>>>13)|0)+(sa>>>26)|0,sa&=67108863,d=Math.imul(u,P),e=(e=Math.imul(u,Q))+Math.imul(v,P)|0,f=Math.imul(v,Q),d=d+Math.imul(r,S)|0,e=(e=e+Math.imul(r,T)|0)+Math.imul(s,S)|0,f=f+Math.imul(s,T)|0,d=d+Math.imul(o,V)|0,e=(e=e+Math.imul(o,W)|0)+Math.imul(p,V)|0,f=f+Math.imul(p,W)|0;var ta=(j+(d=d+Math.imul(l,Y)|0)|0)+((8191&(e=(e=e+Math.imul(l,Z)|0)+Math.imul(m,Y)|0))<<13)|0;j=((f=f+Math.imul(m,Z)|0)+(e>>>13)|0)+(ta>>>26)|0,ta&=67108863,d=Math.imul(x,P),e=(e=Math.imul(x,Q))+Math.imul(y,P)|0,f=Math.imul(y,Q),d=d+Math.imul(u,S)|0,e=(e=e+Math.imul(u,T)|0)+Math.imul(v,S)|0,f=f+Math.imul(v,T)|0,d=d+Math.imul(r,V)|0,e=(e=e+Math.imul(r,W)|0)+Math.imul(s,V)|0,f=f+Math.imul(s,W)|0,d=d+Math.imul(o,Y)|0,e=(e=e+Math.imul(o,Z)|0)+Math.imul(p,Y)|0,f=f+Math.imul(p,Z)|0;var ua=(j+(d=d+Math.imul(l,_)|0)|0)+((8191&(e=(e=e+Math.imul(l,aa)|0)+Math.imul(m,_)|0))<<13)|0;j=((f=f+Math.imul(m,aa)|0)+(e>>>13)|0)+(ua>>>26)|0,ua&=67108863,d=Math.imul(A,P),e=(e=Math.imul(A,Q))+Math.imul(B,P)|0,f=Math.imul(B,Q),d=d+Math.imul(x,S)|0,e=(e=e+Math.imul(x,T)|0)+Math.imul(y,S)|0,f=f+Math.imul(y,T)|0,d=d+Math.imul(u,V)|0,e=(e=e+Math.imul(u,W)|0)+Math.imul(v,V)|0,f=f+Math.imul(v,W)|0,d=d+Math.imul(r,Y)|0,e=(e=e+Math.imul(r,Z)|0)+Math.imul(s,Y)|0,f=f+Math.imul(s,Z)|0,d=d+Math.imul(o,_)|0,e=(e=e+Math.imul(o,aa)|0)+Math.imul(p,_)|0,f=f+Math.imul(p,aa)|0;var va=(j+(d=d+Math.imul(l,ca)|0)|0)+((8191&(e=(e=e+Math.imul(l,da)|0)+Math.imul(m,ca)|0))<<13)|0;j=((f=f+Math.imul(m,da)|0)+(e>>>13)|0)+(va>>>26)|0,va&=67108863,d=Math.imul(D,P),e=(e=Math.imul(D,Q))+Math.imul(E,P)|0,f=Math.imul(E,Q),d=d+Math.imul(A,S)|0,e=(e=e+Math.imul(A,T)|0)+Math.imul(B,S)|0,f=f+Math.imul(B,T)|0,d=d+Math.imul(x,V)|0,e=(e=e+Math.imul(x,W)|0)+Math.imul(y,V)|0,f=f+Math.imul(y,W)|0,d=d+Math.imul(u,Y)|0,e=(e=e+Math.imul(u,Z)|0)+Math.imul(v,Y)|0,f=f+Math.imul(v,Z)|0,d=d+Math.imul(r,_)|0,e=(e=e+Math.imul(r,aa)|0)+Math.imul(s,_)|0,f=f+Math.imul(s,aa)|0,d=d+Math.imul(o,ca)|0,e=(e=e+Math.imul(o,da)|0)+Math.imul(p,ca)|0,f=f+Math.imul(p,da)|0;var wa=(j+(d=d+Math.imul(l,fa)|0)|0)+((8191&(e=(e=e+Math.imul(l,ga)|0)+Math.imul(m,fa)|0))<<13)|0;j=((f=f+Math.imul(m,ga)|0)+(e>>>13)|0)+(wa>>>26)|0,wa&=67108863,d=Math.imul(G,P),e=(e=Math.imul(G,Q))+Math.imul(H,P)|0,f=Math.imul(H,Q),d=d+Math.imul(D,S)|0,e=(e=e+Math.imul(D,T)|0)+Math.imul(E,S)|0,f=f+Math.imul(E,T)|0,d=d+Math.imul(A,V)|0,e=(e=e+Math.imul(A,W)|0)+Math.imul(B,V)|0,f=f+Math.imul(B,W)|0,d=d+Math.imul(x,Y)|0,e=(e=e+Math.imul(x,Z)|0)+Math.imul(y,Y)|0,f=f+Math.imul(y,Z)|0,d=d+Math.imul(u,_)|0,e=(e=e+Math.imul(u,aa)|0)+Math.imul(v,_)|0,f=f+Math.imul(v,aa)|0,d=d+Math.imul(r,ca)|0,e=(e=e+Math.imul(r,da)|0)+Math.imul(s,ca)|0,f=f+Math.imul(s,da)|0,d=d+Math.imul(o,fa)|0,e=(e=e+Math.imul(o,ga)|0)+Math.imul(p,fa)|0,f=f+Math.imul(p,ga)|0;var xa=(j+(d=d+Math.imul(l,ia)|0)|0)+((8191&(e=(e=e+Math.imul(l,ja)|0)+Math.imul(m,ia)|0))<<13)|0;j=((f=f+Math.imul(m,ja)|0)+(e>>>13)|0)+(xa>>>26)|0,xa&=67108863,d=Math.imul(J,P),e=(e=Math.imul(J,Q))+Math.imul(K,P)|0,f=Math.imul(K,Q),d=d+Math.imul(G,S)|0,e=(e=e+Math.imul(G,T)|0)+Math.imul(H,S)|0,f=f+Math.imul(H,T)|0,d=d+Math.imul(D,V)|0,e=(e=e+Math.imul(D,W)|0)+Math.imul(E,V)|0,f=f+Math.imul(E,W)|0,d=d+Math.imul(A,Y)|0,e=(e=e+Math.imul(A,Z)|0)+Math.imul(B,Y)|0,f=f+Math.imul(B,Z)|0,d=d+Math.imul(x,_)|0,e=(e=e+Math.imul(x,aa)|0)+Math.imul(y,_)|0,f=f+Math.imul(y,aa)|0,d=d+Math.imul(u,ca)|0,e=(e=e+Math.imul(u,da)|0)+Math.imul(v,ca)|0,f=f+Math.imul(v,da)|0,d=d+Math.imul(r,fa)|0,e=(e=e+Math.imul(r,ga)|0)+Math.imul(s,fa)|0,f=f+Math.imul(s,ga)|0,d=d+Math.imul(o,ia)|0,e=(e=e+Math.imul(o,ja)|0)+Math.imul(p,ia)|0,f=f+Math.imul(p,ja)|0;var ya=(j+(d=d+Math.imul(l,la)|0)|0)+((8191&(e=(e=e+Math.imul(l,ma)|0)+Math.imul(m,la)|0))<<13)|0;j=((f=f+Math.imul(m,ma)|0)+(e>>>13)|0)+(ya>>>26)|0,ya&=67108863,d=Math.imul(M,P),e=(e=Math.imul(M,Q))+Math.imul(N,P)|0,f=Math.imul(N,Q),d=d+Math.imul(J,S)|0,e=(e=e+Math.imul(J,T)|0)+Math.imul(K,S)|0,f=f+Math.imul(K,T)|0,d=d+Math.imul(G,V)|0,e=(e=e+Math.imul(G,W)|0)+Math.imul(H,V)|0,f=f+Math.imul(H,W)|0,d=d+Math.imul(D,Y)|0,e=(e=e+Math.imul(D,Z)|0)+Math.imul(E,Y)|0,f=f+Math.imul(E,Z)|0,d=d+Math.imul(A,_)|0,e=(e=e+Math.imul(A,aa)|0)+Math.imul(B,_)|0,f=f+Math.imul(B,aa)|0,d=d+Math.imul(x,ca)|0,e=(e=e+Math.imul(x,da)|0)+Math.imul(y,ca)|0,f=f+Math.imul(y,da)|0,d=d+Math.imul(u,fa)|0,e=(e=e+Math.imul(u,ga)|0)+Math.imul(v,fa)|0,f=f+Math.imul(v,ga)|0,d=d+Math.imul(r,ia)|0,e=(e=e+Math.imul(r,ja)|0)+Math.imul(s,ia)|0,f=f+Math.imul(s,ja)|0,d=d+Math.imul(o,la)|0,e=(e=e+Math.imul(o,ma)|0)+Math.imul(p,la)|0,f=f+Math.imul(p,ma)|0;var za=(j+(d=d+Math.imul(l,oa)|0)|0)+((8191&(e=(e=e+Math.imul(l,pa)|0)+Math.imul(m,oa)|0))<<13)|0;j=((f=f+Math.imul(m,pa)|0)+(e>>>13)|0)+(za>>>26)|0,za&=67108863,d=Math.imul(M,S),e=(e=Math.imul(M,T))+Math.imul(N,S)|0,f=Math.imul(N,T),d=d+Math.imul(J,V)|0,e=(e=e+Math.imul(J,W)|0)+Math.imul(K,V)|0,f=f+Math.imul(K,W)|0,d=d+Math.imul(G,Y)|0,e=(e=e+Math.imul(G,Z)|0)+Math.imul(H,Y)|0,f=f+Math.imul(H,Z)|0,d=d+Math.imul(D,_)|0,e=(e=e+Math.imul(D,aa)|0)+Math.imul(E,_)|0,f=f+Math.imul(E,aa)|0,d=d+Math.imul(A,ca)|0,e=(e=e+Math.imul(A,da)|0)+Math.imul(B,ca)|0,f=f+Math.imul(B,da)|0,d=d+Math.imul(x,fa)|0,e=(e=e+Math.imul(x,ga)|0)+Math.imul(y,fa)|0,f=f+Math.imul(y,ga)|0,d=d+Math.imul(u,ia)|0,e=(e=e+Math.imul(u,ja)|0)+Math.imul(v,ia)|0,f=f+Math.imul(v,ja)|0,d=d+Math.imul(r,la)|0,e=(e=e+Math.imul(r,ma)|0)+Math.imul(s,la)|0,f=f+Math.imul(s,ma)|0;var Aa=(j+(d=d+Math.imul(o,oa)|0)|0)+((8191&(e=(e=e+Math.imul(o,pa)|0)+Math.imul(p,oa)|0))<<13)|0;j=((f=f+Math.imul(p,pa)|0)+(e>>>13)|0)+(Aa>>>26)|0,Aa&=67108863,d=Math.imul(M,V),e=(e=Math.imul(M,W))+Math.imul(N,V)|0,f=Math.imul(N,W),d=d+Math.imul(J,Y)|0,e=(e=e+Math.imul(J,Z)|0)+Math.imul(K,Y)|0,f=f+Math.imul(K,Z)|0,d=d+Math.imul(G,_)|0,e=(e=e+Math.imul(G,aa)|0)+Math.imul(H,_)|0,f=f+Math.imul(H,aa)|0,d=d+Math.imul(D,ca)|0,e=(e=e+Math.imul(D,da)|0)+Math.imul(E,ca)|0,f=f+Math.imul(E,da)|0,d=d+Math.imul(A,fa)|0,e=(e=e+Math.imul(A,ga)|0)+Math.imul(B,fa)|0,f=f+Math.imul(B,ga)|0,d=d+Math.imul(x,ia)|0,e=(e=e+Math.imul(x,ja)|0)+Math.imul(y,ia)|0,f=f+Math.imul(y,ja)|0,d=d+Math.imul(u,la)|0,e=(e=e+Math.imul(u,ma)|0)+Math.imul(v,la)|0,f=f+Math.imul(v,ma)|0;var Ba=(j+(d=d+Math.imul(r,oa)|0)|0)+((8191&(e=(e=e+Math.imul(r,pa)|0)+Math.imul(s,oa)|0))<<13)|0;j=((f=f+Math.imul(s,pa)|0)+(e>>>13)|0)+(Ba>>>26)|0,Ba&=67108863,d=Math.imul(M,Y),e=(e=Math.imul(M,Z))+Math.imul(N,Y)|0,f=Math.imul(N,Z),d=d+Math.imul(J,_)|0,e=(e=e+Math.imul(J,aa)|0)+Math.imul(K,_)|0,f=f+Math.imul(K,aa)|0,d=d+Math.imul(G,ca)|0,e=(e=e+Math.imul(G,da)|0)+Math.imul(H,ca)|0,f=f+Math.imul(H,da)|0,d=d+Math.imul(D,fa)|0,e=(e=e+Math.imul(D,ga)|0)+Math.imul(E,fa)|0,f=f+Math.imul(E,ga)|0,d=d+Math.imul(A,ia)|0,e=(e=e+Math.imul(A,ja)|0)+Math.imul(B,ia)|0,f=f+Math.imul(B,ja)|0,d=d+Math.imul(x,la)|0,e=(e=e+Math.imul(x,ma)|0)+Math.imul(y,la)|0,f=f+Math.imul(y,ma)|0;var Ca=(j+(d=d+Math.imul(u,oa)|0)|0)+((8191&(e=(e=e+Math.imul(u,pa)|0)+Math.imul(v,oa)|0))<<13)|0;j=((f=f+Math.imul(v,pa)|0)+(e>>>13)|0)+(Ca>>>26)|0,Ca&=67108863,d=Math.imul(M,_),e=(e=Math.imul(M,aa))+Math.imul(N,_)|0,f=Math.imul(N,aa),d=d+Math.imul(J,ca)|0,e=(e=e+Math.imul(J,da)|0)+Math.imul(K,ca)|0,f=f+Math.imul(K,da)|0,d=d+Math.imul(G,fa)|0,e=(e=e+Math.imul(G,ga)|0)+Math.imul(H,fa)|0,f=f+Math.imul(H,ga)|0,d=d+Math.imul(D,ia)|0,e=(e=e+Math.imul(D,ja)|0)+Math.imul(E,ia)|0,f=f+Math.imul(E,ja)|0,d=d+Math.imul(A,la)|0,e=(e=e+Math.imul(A,ma)|0)+Math.imul(B,la)|0,f=f+Math.imul(B,ma)|0;var Da=(j+(d=d+Math.imul(x,oa)|0)|0)+((8191&(e=(e=e+Math.imul(x,pa)|0)+Math.imul(y,oa)|0))<<13)|0;j=((f=f+Math.imul(y,pa)|0)+(e>>>13)|0)+(Da>>>26)|0,Da&=67108863,d=Math.imul(M,ca),e=(e=Math.imul(M,da))+Math.imul(N,ca)|0,f=Math.imul(N,da),d=d+Math.imul(J,fa)|0,e=(e=e+Math.imul(J,ga)|0)+Math.imul(K,fa)|0,f=f+Math.imul(K,ga)|0,d=d+Math.imul(G,ia)|0,e=(e=e+Math.imul(G,ja)|0)+Math.imul(H,ia)|0,f=f+Math.imul(H,ja)|0,d=d+Math.imul(D,la)|0,e=(e=e+Math.imul(D,ma)|0)+Math.imul(E,la)|0,f=f+Math.imul(E,ma)|0;var Ea=(j+(d=d+Math.imul(A,oa)|0)|0)+((8191&(e=(e=e+Math.imul(A,pa)|0)+Math.imul(B,oa)|0))<<13)|0;j=((f=f+Math.imul(B,pa)|0)+(e>>>13)|0)+(Ea>>>26)|0,Ea&=67108863,d=Math.imul(M,fa),e=(e=Math.imul(M,ga))+Math.imul(N,fa)|0,f=Math.imul(N,ga),d=d+Math.imul(J,ia)|0,e=(e=e+Math.imul(J,ja)|0)+Math.imul(K,ia)|0,f=f+Math.imul(K,ja)|0,d=d+Math.imul(G,la)|0,e=(e=e+Math.imul(G,ma)|0)+Math.imul(H,la)|0,f=f+Math.imul(H,ma)|0;var Fa=(j+(d=d+Math.imul(D,oa)|0)|0)+((8191&(e=(e=e+Math.imul(D,pa)|0)+Math.imul(E,oa)|0))<<13)|0;j=((f=f+Math.imul(E,pa)|0)+(e>>>13)|0)+(Fa>>>26)|0,Fa&=67108863,d=Math.imul(M,ia),e=(e=Math.imul(M,ja))+Math.imul(N,ia)|0,f=Math.imul(N,ja),d=d+Math.imul(J,la)|0,e=(e=e+Math.imul(J,ma)|0)+Math.imul(K,la)|0,f=f+Math.imul(K,ma)|0;var Ga=(j+(d=d+Math.imul(G,oa)|0)|0)+((8191&(e=(e=e+Math.imul(G,pa)|0)+Math.imul(H,oa)|0))<<13)|0;j=((f=f+Math.imul(H,pa)|0)+(e>>>13)|0)+(Ga>>>26)|0,Ga&=67108863,d=Math.imul(M,la),e=(e=Math.imul(M,ma))+Math.imul(N,la)|0,f=Math.imul(N,ma);var Ha=(j+(d=d+Math.imul(J,oa)|0)|0)+((8191&(e=(e=e+Math.imul(J,pa)|0)+Math.imul(K,oa)|0))<<13)|0;j=((f=f+Math.imul(K,pa)|0)+(e>>>13)|0)+(Ha>>>26)|0,Ha&=67108863;var Ia=(j+(d=Math.imul(M,oa))|0)+((8191&(e=(e=Math.imul(M,pa))+Math.imul(N,oa)|0))<<13)|0;return j=((f=Math.imul(N,pa))+(e>>>13)|0)+(Ia>>>26)|0,Ia&=67108863,i[0]=qa,i[1]=ra,i[2]=sa,i[3]=ta,i[4]=ua,i[5]=va,i[6]=wa,i[7]=xa,i[8]=ya,i[9]=za,i[10]=Aa,i[11]=Ba,i[12]=Ca,i[13]=Da,i[14]=Ea,i[15]=Fa,i[16]=Ga,i[17]=Ha,i[18]=Ia,0!==j&&(i[19]=j,c.length++),c};Math.imul||(w=i),f.prototype.mulTo=function(a,b){var c=this.length+a.length;return 10===this.length&&10===a.length?w(this,a,b):c<63?i(this,a,b):c<1024?function(a,b,c){c.negative=b.negative^a.negative,c.length=a.length+b.length;for(var d=0,e=0,f=0;f<c.length-1;f++){var g=e;e=0;for(var h=67108863&d,i=Math.min(f,b.length-1),j=Math.max(0,f-a.length+1);j<=i;j++){var k=f-j,l=(0|a.words[k])*(0|b.words[j]),m=67108863&l;h=67108863&(m=m+h|0),e+=(g=(g=g+(l/67108864|0)|0)+(m>>>26)|0)>>>26,g&=67108863}c.words[f]=h,d=g,g=e}return 0!==d?c.words[f]=d:c.length--,c.strip()}(this,a,b):j(this,a,b)},k.prototype.makeRBT=function(a){for(var b=new Array(a),c=f.prototype._countBits(a)-1,d=0;d<a;d++)b[d]=this.revBin(d,c,a);return b},k.prototype.revBin=function(a,b,c){if(0===a||a===c-1)return a;for(var d=0,e=0;e<b;e++)d|=(1&a)<<b-e-1,a>>=1;return d},k.prototype.permute=function(a,b,c,d,e,f){for(var g=0;g<f;g++)d[g]=b[a[g]],e[g]=c[a[g]]},k.prototype.transform=function(a,b,c,d,e,f){this.permute(f,a,b,c,d,e);for(var g=1;g<e;g<<=1)for(var h=g<<1,i=Math.cos(2*Math.PI/h),j=Math.sin(2*Math.PI/h),k=0;k<e;k+=h)for(var l=i,m=j,n=0;n<g;n++){var o=c[k+n],p=d[k+n],q=c[k+n+g],r=d[k+n+g],s=l*q-m*r;r=l*r+m*q,q=s,c[k+n]=o+q,d[k+n]=p+r,c[k+n+g]=o-q,d[k+n+g]=p-r,n!==h&&(s=i*l-j*m,m=i*m+j*l,l=s)}},k.prototype.guessLen13b=function(a,b){var c=1|Math.max(b,a),d=1&c,e=0;for(c=c/2|0;c;c>>>=1)e++;return 1<<e+1+d},k.prototype.conjugate=function(a,b,c){if(!(c<=1))for(var d=0;d<c/2;d++){var e=a[d];a[d]=a[c-d-1],a[c-d-1]=e,e=b[d],b[d]=-b[c-d-1],b[c-d-1]=-e}},k.prototype.normalize13b=function(a,b){for(var c=0,d=0;d<b/2;d++){var e=8192*Math.round(a[2*d+1]/b)+Math.round(a[2*d]/b)+c;a[d]=67108863&e,c=e<67108864?0:e/67108864|0}return a},k.prototype.convert13b=function(a,b,c,e){for(var f=0,g=0;g<b;g++)f+=0|a[g],c[2*g]=8191&f,f>>>=13,c[2*g+1]=8191&f,f>>>=13;for(g=2*b;g<e;++g)c[g]=0;d(0===f),d(0==(-8192&f))},k.prototype.stub=function(a){for(var b=new Array(a),c=0;c<a;c++)b[c]=0;return b},k.prototype.mulp=function(a,b,c){var d=2*this.guessLen13b(a.length,b.length),e=this.makeRBT(d),f=this.stub(d),g=new Array(d),h=new Array(d),i=new Array(d),j=new Array(d),k=new Array(d),l=new Array(d),m=c.words;m.length=d,this.convert13b(a.words,a.length,g,d),this.convert13b(b.words,b.length,j,d),this.transform(g,f,h,i,d,e),this.transform(j,f,k,l,d,e);for(var n=0;n<d;n++){var o=h[n]*k[n]-i[n]*l[n];i[n]=h[n]*l[n]+i[n]*k[n],h[n]=o}return this.conjugate(h,i,d),this.transform(h,i,m,f,d,e),this.conjugate(m,f,d),this.normalize13b(m,d),c.negative=a.negative^b.negative,c.length=a.length+b.length,c.strip()},f.prototype.mul=function(a){var b=new f(null);return b.words=new Array(this.length+a.length),this.mulTo(a,b)},f.prototype.mulf=function(a){var b=new f(null);return b.words=new Array(this.length+a.length),j(this,a,b)},f.prototype.imul=function(a){return this.clone().mulTo(a,this)},f.prototype.imuln=function(a){d("number"==typeof a),d(a<67108864);for(var b=0,c=0;c<this.length;c++){var e=(0|this.words[c])*a,f=(67108863&e)+(67108863&b);b>>=26,b+=e/67108864|0,b+=f>>>26,this.words[c]=67108863&f}return 0!==b&&(this.words[c]=b,this.length++),this},f.prototype.muln=function(a){return this.clone().imuln(a)},f.prototype.sqr=function(){return this.mul(this)},f.prototype.isqr=function(){return this.imul(this.clone())},f.prototype.pow=function(a){var b=function(a){for(var b=new Array(a.bitLength()),c=0;c<b.length;c++){var d=c/26|0,e=c%26;b[c]=(a.words[d]&1<<e)>>>e}return b}(a);if(0===b.length)return new f(1);for(var c=this,d=0;d<b.length&&0===b[d];d++,c=c.sqr());if(++d<b.length)for(var e=c.sqr();d<b.length;d++,e=e.sqr())0!==b[d]&&(c=c.mul(e));return c},f.prototype.iushln=function(a){d("number"==typeof a&&a>=0);var b,c=a%26,e=(a-c)/26,f=67108863>>>26-c<<26-c;if(0!==c){var g=0;for(b=0;b<this.length;b++){var h=this.words[b]&f,i=(0|this.words[b])-h<<c;this.words[b]=i|g,g=h>>>26-c}g&&(this.words[b]=g,this.length++)}if(0!==e){for(b=this.length-1;b>=0;b--)this.words[b+e]=this.words[b];for(b=0;b<e;b++)this.words[b]=0;this.length+=e}return this.strip()},f.prototype.ishln=function(a){return d(0===this.negative),this.iushln(a)},f.prototype.iushrn=function(a,b,c){var e;d("number"==typeof a&&a>=0),e=b?(b-b%26)/26:0;var f=a%26,g=Math.min((a-f)/26,this.length),h=67108863^67108863>>>f<<f,i=c;if(e-=g,e=Math.max(0,e),i){for(var j=0;j<g;j++)i.words[j]=this.words[j];i.length=g}if(0===g);else if(this.length>g)for(this.length-=g,j=0;j<this.length;j++)this.words[j]=this.words[j+g];else this.words[0]=0,this.length=1;var k=0;for(j=this.length-1;j>=0&&(0!==k||j>=e);j--){var l=0|this.words[j];this.words[j]=k<<26-f|l>>>f,k=l&h}return i&&0!==k&&(i.words[i.length++]=k),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},f.prototype.ishrn=function(a,b,c){return d(0===this.negative),this.iushrn(a,b,c)},f.prototype.shln=function(a){return this.clone().ishln(a)},f.prototype.ushln=function(a){return this.clone().iushln(a)},f.prototype.shrn=function(a){return this.clone().ishrn(a)},f.prototype.ushrn=function(a){return this.clone().iushrn(a)},f.prototype.testn=function(a){d("number"==typeof a&&a>=0);var b=a%26,c=(a-b)/26,e=1<<b;return!(this.length<=c||!(this.words[c]&e))},f.prototype.imaskn=function(a){d("number"==typeof a&&a>=0);var b=a%26,c=(a-b)/26;if(d(0===this.negative,"imaskn works only with positive numbers"),this.length<=c)return this;if(0!==b&&c++,this.length=Math.min(c,this.length),0!==b){var e=67108863^67108863>>>b<<b;this.words[this.length-1]&=e}return this.strip()},f.prototype.maskn=function(a){return this.clone().imaskn(a)},f.prototype.iaddn=function(a){return d("number"==typeof a),d(a<67108864),a<0?this.isubn(-a):0!==this.negative?1===this.length&&(0|this.words[0])<a?(this.words[0]=a-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},f.prototype._iaddn=function(a){this.words[0]+=a;for(var b=0;b<this.length&&this.words[b]>=67108864;b++)this.words[b]-=67108864,b===this.length-1?this.words[b+1]=1:this.words[b+1]++;return this.length=Math.max(this.length,b+1),this},f.prototype.isubn=function(a){if(d("number"==typeof a),d(a<67108864),a<0)return this.iaddn(-a);if(0!==this.negative)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var b=0;b<this.length&&this.words[b]<0;b++)this.words[b]+=67108864,this.words[b+1]-=1;return this.strip()},f.prototype.addn=function(a){return this.clone().iaddn(a)},f.prototype.subn=function(a){return this.clone().isubn(a)},f.prototype.iabs=function(){return this.negative=0,this},f.prototype.abs=function(){return this.clone().iabs()},f.prototype._ishlnsubmul=function(a,b,c){var e,f,g=a.length+c;this._expand(g);var h=0;for(e=0;e<a.length;e++){f=(0|this.words[e+c])+h;var i=(0|a.words[e])*b;h=((f-=67108863&i)>>26)-(i/67108864|0),this.words[e+c]=67108863&f}for(;e<this.length-c;e++)h=(f=(0|this.words[e+c])+h)>>26,this.words[e+c]=67108863&f;if(0===h)return this.strip();for(d(-1===h),h=0,e=0;e<this.length;e++)h=(f=-(0|this.words[e])+h)>>26,this.words[e]=67108863&f;return this.negative=1,this.strip()},f.prototype._wordDiv=function(a,b){var c=(this.length,a.length),d=this.clone(),e=a,g=0|e.words[e.length-1];0!=(c=26-this._countBits(g))&&(e=e.ushln(c),d.iushln(c),g=0|e.words[e.length-1]);var h,i=d.length-e.length;if("mod"!==b){(h=new f(null)).length=i+1,h.words=new Array(h.length);for(var j=0;j<h.length;j++)h.words[j]=0}var k=d.clone()._ishlnsubmul(e,1,i);0===k.negative&&(d=k,h&&(h.words[i]=1));for(var l=i-1;l>=0;l--){var m=67108864*(0|d.words[e.length+l])+(0|d.words[e.length+l-1]);for(m=Math.min(m/g|0,67108863),d._ishlnsubmul(e,m,l);0!==d.negative;)m--,d.negative=0,d._ishlnsubmul(e,1,l),d.isZero()||(d.negative^=1);h&&(h.words[l]=m)}return h&&h.strip(),d.strip(),"div"!==b&&0!==c&&d.iushrn(c),{div:h||null,mod:d}},f.prototype.divmod=function(a,b,c){return d(!a.isZero()),this.isZero()?{div:new f(0),mod:new f(0)}:0!==this.negative&&0===a.negative?(h=this.neg().divmod(a,b),"mod"!==b&&(e=h.div.neg()),"div"!==b&&(g=h.mod.neg(),c&&0!==g.negative&&g.iadd(a)),{div:e,mod:g}):0===this.negative&&0!==a.negative?(h=this.divmod(a.neg(),b),"mod"!==b&&(e=h.div.neg()),{div:e,mod:h.mod}):0!=(this.negative&a.negative)?(h=this.neg().divmod(a.neg(),b),"div"!==b&&(g=h.mod.neg(),c&&0!==g.negative&&g.isub(a)),{div:h.div,mod:g}):a.length>this.length||this.cmp(a)<0?{div:new f(0),mod:this}:1===a.length?"div"===b?{div:this.divn(a.words[0]),mod:null}:"mod"===b?{div:null,mod:new f(this.modn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new f(this.modn(a.words[0]))}:this._wordDiv(a,b);var e,g,h},f.prototype.div=function(a){return this.divmod(a,"div",!1).div},f.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},f.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},f.prototype.divRound=function(a){var b=this.divmod(a);if(b.mod.isZero())return b.div;var c=0!==b.div.negative?b.mod.isub(a):b.mod,d=a.ushrn(1),e=a.andln(1),f=c.cmp(d);return f<0||1===e&&0===f?b.div:0!==b.div.negative?b.div.isubn(1):b.div.iaddn(1)},f.prototype.modn=function(a){d(a<=67108863);for(var b=(1<<26)%a,c=0,e=this.length-1;e>=0;e--)c=(b*c+(0|this.words[e]))%a;return c},f.prototype.idivn=function(a){d(a<=67108863);for(var b=0,c=this.length-1;c>=0;c--){var e=(0|this.words[c])+67108864*b;this.words[c]=e/a|0,b=e%a}return this.strip()},f.prototype.divn=function(a){return this.clone().idivn(a)},f.prototype.egcd=function(a){d(0===a.negative),d(!a.isZero());var b=this,c=a.clone();b=0!==b.negative?b.umod(a):b.clone();for(var e=new f(1),g=new f(0),h=new f(0),i=new f(1),j=0;b.isEven()&&c.isEven();)b.iushrn(1),c.iushrn(1),++j;for(var k=c.clone(),l=b.clone();!b.isZero();){for(var m=0,n=1;0==(b.words[0]&n)&&m<26;++m,n<<=1);if(m>0)for(b.iushrn(m);m-- >0;)(e.isOdd()||g.isOdd())&&(e.iadd(k),g.isub(l)),e.iushrn(1),g.iushrn(1);for(var o=0,p=1;0==(c.words[0]&p)&&o<26;++o,p<<=1);
if(o>0)for(c.iushrn(o);o-- >0;)(h.isOdd()||i.isOdd())&&(h.iadd(k),i.isub(l)),h.iushrn(1),i.iushrn(1);b.cmp(c)>=0?(b.isub(c),e.isub(h),g.isub(i)):(c.isub(b),h.isub(e),i.isub(g))}return{a:h,b:i,gcd:c.iushln(j)}},f.prototype._invmp=function(a){d(0===a.negative),d(!a.isZero());var b=this,c=a.clone();b=0!==b.negative?b.umod(a):b.clone();for(var e,g=new f(1),h=new f(0),i=c.clone();b.cmpn(1)>0&&c.cmpn(1)>0;){for(var j=0,k=1;0==(b.words[0]&k)&&j<26;++j,k<<=1);if(j>0)for(b.iushrn(j);j-- >0;)g.isOdd()&&g.iadd(i),g.iushrn(1);for(var l=0,m=1;0==(c.words[0]&m)&&l<26;++l,m<<=1);if(l>0)for(c.iushrn(l);l-- >0;)h.isOdd()&&h.iadd(i),h.iushrn(1);b.cmp(c)>=0?(b.isub(c),g.isub(h)):(c.isub(b),h.isub(g))}return(e=0===b.cmpn(1)?g:h).cmpn(0)<0&&e.iadd(a),e},f.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var b=this.clone(),c=a.clone();b.negative=0,c.negative=0;for(var d=0;b.isEven()&&c.isEven();d++)b.iushrn(1),c.iushrn(1);for(;;){for(;b.isEven();)b.iushrn(1);for(;c.isEven();)c.iushrn(1);var e=b.cmp(c);if(e<0){var f=b;b=c,c=f}else if(0===e||0===c.cmpn(1))break;b.isub(c)}return c.iushln(d)},f.prototype.invm=function(a){return this.egcd(a).a.umod(a)},f.prototype.isEven=function(){return 0==(1&this.words[0])},f.prototype.isOdd=function(){return 1==(1&this.words[0])},f.prototype.andln=function(a){return this.words[0]&a},f.prototype.bincn=function(a){d("number"==typeof a);var b=a%26,c=(a-b)/26,e=1<<b;if(this.length<=c)return this._expand(c+1),this.words[c]|=e,this;for(var f=e,g=c;0!==f&&g<this.length;g++){var h=0|this.words[g];f=(h+=f)>>>26,h&=67108863,this.words[g]=h}return 0!==f&&(this.words[g]=f,this.length++),this},f.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},f.prototype.cmpn=function(a){var b,c=a<0;if(0!==this.negative&&!c)return-1;if(0===this.negative&&c)return 1;if(this.strip(),this.length>1)b=1;else{c&&(a=-a),d(a<=67108863,"Number is too big");var e=0|this.words[0];b=e===a?0:e<a?-1:1}return 0!==this.negative?0|-b:b},f.prototype.cmp=function(a){if(0!==this.negative&&0===a.negative)return-1;if(0===this.negative&&0!==a.negative)return 1;var b=this.ucmp(a);return 0!==this.negative?0|-b:b},f.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var b=0,c=this.length-1;c>=0;c--){var d=0|this.words[c],e=0|a.words[c];if(d!==e){d<e?b=-1:d>e&&(b=1);break}}return b},f.prototype.gtn=function(a){return 1===this.cmpn(a)},f.prototype.gt=function(a){return 1===this.cmp(a)},f.prototype.gten=function(a){return this.cmpn(a)>=0},f.prototype.gte=function(a){return this.cmp(a)>=0},f.prototype.ltn=function(a){return-1===this.cmpn(a)},f.prototype.lt=function(a){return-1===this.cmp(a)},f.prototype.lten=function(a){return this.cmpn(a)<=0},f.prototype.lte=function(a){return this.cmp(a)<=0},f.prototype.eqn=function(a){return 0===this.cmpn(a)},f.prototype.eq=function(a){return 0===this.cmp(a)},f.red=function(a){return new q(a)},f.prototype.toRed=function(a){return d(!this.red,"Already a number in reduction context"),d(0===this.negative,"red works only with positives"),a.convertTo(this)._forceRed(a)},f.prototype.fromRed=function(){return d(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},f.prototype._forceRed=function(a){return this.red=a,this},f.prototype.forceRed=function(a){return d(!this.red,"Already a number in reduction context"),this._forceRed(a)},f.prototype.redAdd=function(a){return d(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},f.prototype.redIAdd=function(a){return d(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},f.prototype.redSub=function(a){return d(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},f.prototype.redISub=function(a){return d(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},f.prototype.redShl=function(a){return d(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},f.prototype.redMul=function(a){return d(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},f.prototype.redIMul=function(a){return d(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},f.prototype.redSqr=function(){return d(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},f.prototype.redISqr=function(){return d(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},f.prototype.redSqrt=function(){return d(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},f.prototype.redInvm=function(){return d(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},f.prototype.redNeg=function(){return d(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},f.prototype.redPow=function(a){return d(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var x={k256:null,p224:null,p192:null,p25519:null};l.prototype._tmp=function(){var a=new f(null);return a.words=new Array(Math.ceil(this.n/13)),a},l.prototype.ireduce=function(a){var b,c=a;do{this.split(c,this.tmp),b=(c=(c=this.imulK(c)).iadd(this.tmp)).bitLength()}while(b>this.n);var d=b<this.n?-1:c.ucmp(this.p);return 0===d?(c.words[0]=0,c.length=1):d>0?c.isub(this.p):c.strip(),c},l.prototype.split=function(a,b){a.iushrn(this.n,0,b)},l.prototype.imulK=function(a){return a.imul(this.k)},e(m,l),m.prototype.split=function(a,b){for(var c=Math.min(a.length,9),d=0;d<c;d++)b.words[d]=a.words[d];if(b.length=c,a.length<=9)return a.words[0]=0,void(a.length=1);var e=a.words[9];for(b.words[b.length++]=4194303&e,d=10;d<a.length;d++){var f=0|a.words[d];a.words[d-10]=(4194303&f)<<4|e>>>22,e=f}e>>>=22,a.words[d-10]=e,0===e&&a.length>10?a.length-=10:a.length-=9},m.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var b=0,c=0;c<a.length;c++){var d=0|a.words[c];b+=977*d,a.words[c]=67108863&b,b=64*d+(b/67108864|0)}return 0===a.words[a.length-1]&&(a.length--,0===a.words[a.length-1]&&a.length--),a},e(n,l),e(o,l),e(p,l),p.prototype.imulK=function(a){for(var b=0,c=0;c<a.length;c++){var d=19*(0|a.words[c])+b,e=67108863&d;d>>>=26,a.words[c]=e,b=d}return 0!==b&&(a.words[a.length++]=b),a},f._prime=function(a){if(x[a])return x[a];var b;if("k256"===a)b=new m;else if("p224"===a)b=new n;else if("p192"===a)b=new o;else{if("p25519"!==a)throw new Error("Unknown prime "+a);b=new p}return x[a]=b,b},q.prototype._verify1=function(a){d(0===a.negative,"red works only with positives"),d(a.red,"red works only with red numbers")},q.prototype._verify2=function(a,b){d(0==(a.negative|b.negative),"red works only with positives"),d(a.red&&a.red===b.red,"red works only with red numbers")},q.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):a.umod(this.m)._forceRed(this)},q.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},q.prototype.add=function(a,b){this._verify2(a,b);var c=a.add(b);return c.cmp(this.m)>=0&&c.isub(this.m),c._forceRed(this)},q.prototype.iadd=function(a,b){this._verify2(a,b);var c=a.iadd(b);return c.cmp(this.m)>=0&&c.isub(this.m),c},q.prototype.sub=function(a,b){this._verify2(a,b);var c=a.sub(b);return c.cmpn(0)<0&&c.iadd(this.m),c._forceRed(this)},q.prototype.isub=function(a,b){this._verify2(a,b);var c=a.isub(b);return c.cmpn(0)<0&&c.iadd(this.m),c},q.prototype.shl=function(a,b){return this._verify1(a),this.imod(a.ushln(b))},q.prototype.imul=function(a,b){return this._verify2(a,b),this.imod(a.imul(b))},q.prototype.mul=function(a,b){return this._verify2(a,b),this.imod(a.mul(b))},q.prototype.isqr=function(a){return this.imul(a,a.clone())},q.prototype.sqr=function(a){return this.mul(a,a)},q.prototype.sqrt=function(a){if(a.isZero())return a.clone();var b=this.m.andln(3);if(d(b%2==1),3===b){var c=this.m.add(new f(1)).iushrn(2);return this.pow(a,c)}for(var e=this.m.subn(1),g=0;!e.isZero()&&0===e.andln(1);)g++,e.iushrn(1);d(!e.isZero());var h=new f(1).toRed(this),i=h.redNeg(),j=this.m.subn(1).iushrn(1),k=this.m.bitLength();for(k=new f(2*k*k).toRed(this);0!==this.pow(k,j).cmp(i);)k.redIAdd(i);for(var l=this.pow(k,e),m=this.pow(a,e.addn(1).iushrn(1)),n=this.pow(a,e),o=g;0!==n.cmp(h);){for(var p=n,q=0;0!==p.cmp(h);q++)p=p.redSqr();d(q<o);var r=this.pow(l,new f(1).iushln(o-q-1));m=m.redMul(r),l=r.redSqr(),n=n.redMul(l),o=q}return m},q.prototype.invm=function(a){var b=a._invmp(this.m);return 0!==b.negative?(b.negative=0,this.imod(b).redNeg()):this.imod(b)},q.prototype.pow=function(a,b){if(b.isZero())return new f(1).toRed(this);if(0===b.cmpn(1))return a.clone();var c=new Array(16);c[0]=new f(1).toRed(this),c[1]=a;for(var d=2;d<c.length;d++)c[d]=this.mul(c[d-1],a);var e=c[0],g=0,h=0,i=b.bitLength()%26;for(0===i&&(i=26),d=b.length-1;d>=0;d--){for(var j=b.words[d],k=i-1;k>=0;k--){var l=j>>k&1;e!==c[0]&&(e=this.sqr(e)),0!==l||0!==g?(g<<=1,g|=l,(4==++h||0===d&&0===k)&&(e=this.mul(e,c[g]),h=0,g=0)):h=0}i=26}return e},q.prototype.convertTo=function(a){var b=a.umod(this.m);return b===a?b.clone():b},q.prototype.convertFrom=function(a){var b=a.clone();return b.red=null,b},f.mont=function(a){return new r(a)},e(r,q),r.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},r.prototype.convertFrom=function(a){var b=this.imod(a.mul(this.rinv));return b.red=null,b},r.prototype.imul=function(a,b){if(a.isZero()||b.isZero())return a.words[0]=0,a.length=1,a;var c=a.imul(b),d=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=c.isub(d).iushrn(this.shift),f=e;return e.cmp(this.m)>=0?f=e.isub(this.m):e.cmpn(0)<0&&(f=e.iadd(this.m)),f._forceRed(this)},r.prototype.mul=function(a,b){if(a.isZero()||b.isZero())return new f(0)._forceRed(this);var c=a.mul(b),d=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=c.isub(d).iushrn(this.shift),g=e;return e.cmp(this.m)>=0?g=e.isub(this.m):e.cmpn(0)<0&&(g=e.iadd(this.m)),g._forceRed(this)},r.prototype.invm=function(a){return this.imod(a._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===b||b,this)},{buffer:104}],96:[function(a,b,c){"use strict";b.exports=function(a){var b,c,d,e=a.length,f=0;for(b=0;b<e;++b)f+=a[b].length;var g=new Array(f),h=0;for(b=0;b<e;++b){var i=a[b],j=i.length;for(c=0;c<j;++c){var k=g[h++]=new Array(j-1),l=0;for(d=0;d<j;++d)d!==c&&(k[l++]=i[d]);if(1&c){var m=k[1];k[1]=k[0],k[0]=m}}}return g}},{}],97:[function(a,b,c){"use strict";function d(a,b){for(var c=0;c<a;++c)if(!(b[c]<=b[c+a]))return!0;return!1}function e(a,b,c,e){for(var f=0,g=0,h=0,i=a.length;h<i;++h){var j=a[h];if(!d(b,j)){for(var k=0;k<2*b;++k)c[f++]=j[k];e[g++]=h}}return g}function f(a,b,c,d){var f=a.length,g=b.length;if(!(f<=0||g<=0)){var h=a[0].length>>>1;if(!(h<=0)){var l,m=i.mallocDouble(2*h*f),n=i.mallocInt32(f);if((f=e(a,h,m,n))>0){if(1===h&&d)j.init(f),l=j.sweepComplete(h,c,0,f,m,n,0,f,m,n);else{var o=i.mallocDouble(2*h*g),p=i.mallocInt32(g);(g=e(b,h,o,p))>0&&(j.init(f+g),l=1===h?j.sweepBipartite(h,c,0,f,m,n,0,g,o,p):k(h,c,d,f,m,n,g,o,p),i.free(o),i.free(p))}i.free(m),i.free(n)}return l}}}function g(a,b){h.push([a,b])}b.exports=function(a,b,c){switch(arguments.length){case 1:return h=[],f(d=a,d,g,!0),h;case 2:return"function"==typeof b?f(a,a,b,!0):function(a,b){return h=[],f(a,b,g,!1),h}(a,b);case 3:return f(a,b,c,!1);default:throw new Error("box-intersect: Invalid arguments")}var d};var h,i=a("typedarray-pool"),j=a("./lib/sweep"),k=a("./lib/intersect")},{"./lib/intersect":99,"./lib/sweep":103,"typedarray-pool":546}],98:[function(a,b,c){"use strict";function d(a){function b(b,c){var h=function(a,b,c){var d="bruteForce"+(a?"Red":"Blue")+(b?"Flip":"")+(c?"Full":""),h=["function ",d,"(",v.join(),"){","var ",i,"=2*",e,";"],w="for(var i="+j+","+n+"="+i+"*"+j+";i<"+k+";++i,"+n+"+="+i+"){var x0="+l+"["+f+"+"+n+"],x1="+l+"["+f+"+"+n+"+"+e+"],xi="+m+"[i];",x="for(var j="+o+","+s+"="+i+"*"+o+";j<"+p+";++j,"+s+"+="+i+"){var y0="+q+"["+f+"+"+s+"],"+(c?"y1="+q+"["+f+"+"+s+"+"+e+"],":"")+"yi="+r+"[j];";return a?h.push(w,u,":",x):h.push(x,u,":",w),c?h.push("if(y1<x0||x1<y0)continue;"):b?h.push("if(y0<=x0||x1<y0)continue;"):h.push("if(y0<x0||x1<y0)continue;"),h.push("for(var k="+f+"+1;k<"+e+";++k){var r0="+l+"[k+"+n+"],r1="+l+"[k+"+e+"+"+n+"],b0="+q+"[k+"+s+"],b1="+q+"[k+"+e+"+"+s+"];if(r1<b0||b1<r0)continue "+u+";}var "+t+"="+g+"("),b?h.push("yi,xi"):h.push("xi,yi"),h.push(");if("+t+"!==void 0)return "+t+";}}}"),{name:d,code:h.join("")}}(b,c,a);d.push(h.code),x.push("return "+h.name+"("+v.join()+");")}var c="bruteForce"+(a?"Full":"Partial"),d=[],w=v.slice();a||w.splice(3,0,h);var x=["function "+c+"("+w.join()+"){"];x.push("if("+k+"-"+j+">"+p+"-"+o+"){"),a?(b(!0,!1),x.push("}else{"),b(!1,!1)):(x.push("if("+h+"){"),b(!0,!0),x.push("}else{"),b(!0,!1),x.push("}}else{if("+h+"){"),b(!1,!0),x.push("}else{"),b(!1,!1),x.push("}")),x.push("}}return "+c);var y=d.join("")+x.join("");return new Function(y)()}var e="d",f="ax",g="vv",h="fp",i="es",j="rs",k="re",l="rb",m="ri",n="rp",o="bs",p="be",q="bb",r="bi",s="bp",t="rv",u="Q",v=[e,f,g,j,k,l,m,o,p,q,r];c.partial=d(!1),c.full=d(!0)},{}],99:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g,h,i){var j=x*a;z[j]=b,z[j+1]=c,z[j+2]=d,z[j+3]=e,z[j+4]=f,z[j+5]=g;var k=y*a;A[k]=h,A[k+1]=i}function e(a,b,c,d,e,f,g,h,i,j,k){var l=2*a,m=i*l,n=j[m+b];a:for(var o=e,p=e*l;o<f;++o,p+=l){var q=g[p+b],r=g[p+b+a];if(!(n<q||r<n||d&&n===q)){for(var s,t=h[o],u=b+1;u<a;++u){q=g[p+u],r=g[p+u+a];var v=j[m+u],w=j[m+u+a];if(r<v||w<q)continue a}if(void 0!==(s=d?c(k,t):c(t,k)))return s}}}function f(a,b,c,d,e,f,g,h,i,j){var k=2*a,l=h*k,m=i[l+b];a:for(var n=d,o=d*k;n<e;++n,o+=k){var p=g[n];if(p!==j){var q=f[o+b],r=f[o+b+a];if(!(m<q||r<m)){for(var s=b+1;s<a;++s){q=f[o+s],r=f[o+s+a];var t=i[l+s],u=i[l+s+a];if(r<t||u<q)continue a}var v=c(p,j);if(void 0!==v)return v}}}}b.exports=function(a,b,c,i,n,B,C,D,E){!function(a,b){var c=8*h.log2(b+1)*(a+1)|0,d=h.nextPow2(x*c);z.length<d&&(g.free(z),z=g.mallocInt32(d));var e=h.nextPow2(y*c);A<e&&(g.free(A),A=g.mallocDouble(e))}(a,i+C);var F,G=0,H=2*a;for(d(G++,0,0,i,0,C,c?16:0,-1/0,1/0),c||d(G++,0,0,C,0,i,1,-1/0,1/0);G>0;){var I=(G-=1)*x,J=z[I],K=z[I+1],L=z[I+2],M=z[I+3],N=z[I+4],O=z[I+5],P=G*y,Q=A[P],R=A[P+1],S=1&O,T=!!(16&O),U=n,V=B,W=D,X=E;if(S&&(U=D,V=E,W=n,X=B),!(2&O&&(L=t(a,J,K,L,U,V,R),K>=L)||4&O&&(K=u(a,J,K,L,U,V,Q))>=L)){var Y=L-K,Z=N-M;if(T){if(a*Y*(Y+Z)<q){if(void 0!==(F=l.scanComplete(a,J,b,K,L,U,V,M,N,W,X)))return F;continue}}else{if(a*Math.min(Y,Z)<o){if(void 0!==(F=j(a,J,b,S,K,L,U,V,M,N,W,X)))return F;continue}if(a*Y*Z<p){if(void 0!==(F=l.scanBipartite(a,J,b,S,K,L,U,V,M,N,W,X)))return F;continue}}var $=r(a,J,K,L,U,V,Q,R);if(K<$)if(a*($-K)<o){if(void 0!==(F=k(a,J+1,b,K,$,U,V,M,N,W,X)))return F}else if(J===a-2){if(void 0!==(F=S?l.sweepBipartite(a,b,M,N,W,X,K,$,U,V):l.sweepBipartite(a,b,K,$,U,V,M,N,W,X)))return F}else d(G++,J+1,K,$,M,N,S,-1/0,1/0),d(G++,J+1,M,N,K,$,1^S,-1/0,1/0);if($<L){var _=m(a,J,M,N,W,X),aa=W[H*_+J],ba=s(a,J,_,N,W,X,aa);if(ba<N&&d(G++,J,$,L,ba,N,(4|S)+(T?16:0),aa,R),M<_&&d(G++,J,$,L,M,_,(2|S)+(T?16:0),Q,aa),_+1===ba){if(void 0!==(F=T?f(a,J,b,$,L,U,V,_,W,X[_]):e(a,J,b,S,$,L,U,V,_,W,X[_])))return F}else if(_<ba){var ca;if(T){if(ca=v(a,J,$,L,U,V,aa),$<ca){var da=s(a,J,$,ca,U,V,aa);if(J===a-2){if($<da&&void 0!==(F=l.sweepComplete(a,b,$,da,U,V,_,ba,W,X)))return F;if(da<ca&&void 0!==(F=l.sweepBipartite(a,b,da,ca,U,V,_,ba,W,X)))return F}else $<da&&d(G++,J+1,$,da,_,ba,16,-1/0,1/0),da<ca&&(d(G++,J+1,da,ca,_,ba,0,-1/0,1/0),d(G++,J+1,_,ba,da,ca,1,-1/0,1/0))}}else ca=S?w(a,J,$,L,U,V,aa):v(a,J,$,L,U,V,aa),$<ca&&(J===a-2?F=S?l.sweepBipartite(a,b,_,ba,W,X,$,ca,U,V):l.sweepBipartite(a,b,$,ca,U,V,_,ba,W,X):(d(G++,J+1,$,ca,_,ba,S,-1/0,1/0),d(G++,J+1,_,ba,$,ca,1^S,-1/0,1/0)))}}}}};var g=a("typedarray-pool"),h=a("bit-twiddle"),i=a("./brute"),j=i.partial,k=i.full,l=a("./sweep"),m=a("./median"),n=a("./partition"),o=128,p=1<<22,q=1<<22,r=n("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),s=n("lo===p0",["p0"]),t=n("lo<p0",["p0"]),u=n("hi<=p0",["p0"]),v=n("lo<=p0&&p0<=hi",["p0"]),w=n("lo<p0&&p0<=hi",["p0"]),x=6,y=2,z=g.mallocInt32(1024),A=g.mallocDouble(1024)},{"./brute":98,"./median":100,"./partition":101,"./sweep":103,"bit-twiddle":93,"typedarray-pool":546}],100:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){for(var g=2*a,h=g*(c+1)+b,i=c+1;i<d;++i,h+=g)for(var j=e[h],k=i,l=g*(i-1);k>c&&e[l+b]>j;--k,l-=g){for(var m=l,n=l+g,o=0;o<g;++o,++m,++n){var p=e[m];e[m]=e[n],e[n]=p}var q=f[k];f[k]=f[k-1],f[k-1]=q}}b.exports=function(a,b,c,g,h,i){if(g<=c+1)return c;for(var j=c,k=g,l=g+c>>>1,m=2*a,n=l,o=h[m*l+b];j<k;){if(k-j<f){d(a,b,j,k,h,i),o=h[m*l+b];break}var p=k-j,q=Math.random()*p+j|0,r=h[m*q+b],s=Math.random()*p+j|0,t=h[m*s+b],u=Math.random()*p+j|0,v=h[m*u+b];r<=t?v>=t?(n=s,o=t):r>=v?(n=q,o=r):(n=u,o=v):t>=v?(n=s,o=t):v>=r?(n=q,o=r):(n=u,o=v);for(var w=m*(k-1),x=m*n,y=0;y<m;++y,++w,++x){var z=h[w];h[w]=h[x],h[x]=z}var A=i[k-1];i[k-1]=i[n],i[n]=A,n=e(a,b,j,k-1,h,i,o);for(var w=m*(k-1),x=m*n,y=0;y<m;++y,++w,++x){var z=h[w];h[w]=h[x],h[x]=z}var A=i[k-1];if(i[k-1]=i[n],i[n]=A,l<n){for(k=n-1;j<k&&h[m*(k-1)+b]===o;)k-=1;k+=1}else{if(!(n<l))break;for(j=n+1;j<k&&h[m*j+b]===o;)j+=1}}return e(a,b,c,l,h,i,h[m*l+b])};var e=a("./partition")("lo<p0",["p0"]),f=8},{"./partition":101}],101:[function(a,b,c){"use strict";b.exports=function(a,b){var c="abcdef".split("").concat(b),e=[];return a.indexOf("lo")>=0&&e.push("lo=e[k+n]"),a.indexOf("hi")>=0&&e.push("hi=e[k+o]"),c.push(d.replace("_",e.join()).replace("$",a)),Function.apply(void 0,c)};var d="for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m"},{}],102:[function(a,b,c){"use strict";function d(a,b,c){for(var d=2*(a+1),e=a+1;e<=b;++e){for(var f=c[d++],g=c[d++],h=e,i=d-2;h-- >a;){var j=c[i-2],k=c[i-1];if(j<f)break;if(j===f&&k<g)break;c[i]=j,c[i+1]=k,i-=2}c[i]=f,c[i+1]=g}}function e(a,b,c){b*=2;var d=c[a*=2],e=c[a+1];c[a]=c[b],c[a+1]=c[b+1],c[b]=d,c[b+1]=e}function f(a,b,c){b*=2,c[a*=2]=c[b],c[a+1]=c[b+1]}function g(a,b,c,d){b*=2,c*=2;var e=d[a*=2],f=d[a+1];d[a]=d[b],d[a+1]=d[b+1],d[b]=d[c],d[b+1]=d[c+1],d[c]=e,d[c+1]=f}function h(a,b,c,d,e){b*=2,e[a*=2]=e[b],e[b]=c,e[a+1]=e[b+1],e[b+1]=d}function i(a,b,c){b*=2;var d=c[a*=2],e=c[b];return!(d<e)&&(d!==e||c[a+1]>c[b+1])}function j(a,b,c,d){var e=d[a*=2];return e<b||e===b&&d[a+1]<c}b.exports=function(a,b){b<=4*k?d(0,b-1,a):function a(b,c,l){var m=(c-b+1)/6|0,n=b+m,o=c-m,p=b+c>>1,q=p-m,r=p+m,s=n,t=q,u=p,v=r,w=o,x=b+1,y=c-1,z=0;i(s,t,l)&&(z=s,s=t,t=z),i(v,w,l)&&(z=v,v=w,w=z),i(s,u,l)&&(z=s,s=u,u=z),i(t,u,l)&&(z=t,t=u,u=z),i(s,v,l)&&(z=s,s=v,v=z),i(u,v,l)&&(z=u,u=v,v=z),i(t,w,l)&&(z=t,t=w,w=z),i(t,u,l)&&(z=t,t=u,u=z),i(v,w,l)&&(z=v,v=w,w=z);for(var A=l[2*t],B=l[2*t+1],C=l[2*v],D=l[2*v+1],E=2*s,F=2*u,G=2*w,H=2*n,I=2*p,J=2*o,K=0;K<2;++K){var L=l[E+K],M=l[F+K],N=l[G+K];l[H+K]=L,l[I+K]=M,l[J+K]=N}f(q,b,l),f(r,c,l);for(var O=x;O<=y;++O)if(j(O,A,B,l))O!==x&&e(O,x,l),++x;else if(!j(O,C,D,l))for(;;){if(j(y,C,D,l)){j(y,A,B,l)?(g(O,x,y,l),++x,--y):(e(O,y,l),--y);break}if(--y<O)break}h(b,x-1,A,B,l),h(c,y+1,C,D,l),x-2-b<=k?d(b,x-2,l):a(b,x-2,l),c-(y+2)<=k?d(y+2,c,l):a(y+2,c,l),y-x<=k?d(x,y,l):a(x,y,l)}(0,b-1,a)};var k=32},{}],103:[function(a,b,c){"use strict";function d(a,b,c,d){var e=b[d],f=a[c-1];a[e]=f,b[f]=e}function e(a,b,c,d){a[c]=d,b[d]=c}b.exports={init:function(a){var b=g.nextPow2(a);j.length<b&&(f.free(j),j=f.mallocInt32(b)),k.length<b&&(f.free(k),k=f.mallocInt32(b)),l.length<b&&(f.free(l),l=f.mallocInt32(b)),m.length<b&&(f.free(m),m=f.mallocInt32(b)),n.length<b&&(f.free(n),n=f.mallocInt32(b)),o.length<b&&(f.free(o),o=f.mallocInt32(b));var c=8*b;p.length<c&&(f.free(p),p=f.mallocDouble(c))},sweepBipartite:function(a,b,c,f,g,n,o,q,r,s){for(var t=0,u=2*a,v=a-1,w=u-1,x=c;x<f;++x){var y=n[x],z=u*x;p[t++]=g[z+v],p[t++]=-(y+1),p[t++]=g[z+w],p[t++]=y}for(var x=o;x<q;++x){var y=s[x]+i,A=u*x;p[t++]=r[A+v],p[t++]=-y,p[t++]=r[A+w],p[t++]=y}var B=t>>>1;h(p,B);for(var C=0,D=0,x=0;x<B;++x){var E=0|p[2*x+1];if(E>=i)d(l,m,D--,E=E-i|0);else if(E>=0)d(j,k,C--,E);else if(E<=-i){E=-E-i|0;for(var F=0;F<C;++F){var G=b(j[F],E);if(void 0!==G)return G}e(l,m,D++,E)}else{E=-E-1|0;for(var F=0;F<D;++F){var G=b(E,l[F]);if(void 0!==G)return G}e(j,k,C++,E)}}},sweepComplete:function(a,b,c,f,g,i,q,r,s,t){for(var u=0,v=2*a,w=a-1,x=v-1,y=c;y<f;++y){var z=i[y]+1<<1,A=v*y;p[u++]=g[A+w],p[u++]=-z,p[u++]=g[A+x],p[u++]=z}for(var y=q;y<r;++y){var z=t[y]+1<<1,B=v*y;p[u++]=s[B+w],p[u++]=1|-z,p[u++]=s[B+x],p[u++]=1|z}var C=u>>>1;h(p,C);for(var D=0,E=0,F=0,y=0;y<C;++y){var G=0|p[2*y+1],H=1&G;if(y<C-1&&G>>1==p[2*y+3]>>1&&(H=2,y+=1),G<0){for(var I=-(G>>1)-1,J=0;J<F;++J){var K=b(n[J],I);if(void 0!==K)return K}if(0!==H)for(var J=0;J<D;++J){var K=b(j[J],I);if(void 0!==K)return K}if(1!==H)for(var J=0;J<E;++J){var K=b(l[J],I);if(void 0!==K)return K}0===H?e(j,k,D++,I):1===H?e(l,m,E++,I):2===H&&e(n,o,F++,I)}else{var I=(G>>1)-1;0===H?d(j,k,D--,I):1===H?d(l,m,E--,I):2===H&&d(n,o,F--,I)}}},scanBipartite:function(a,b,c,f,g,l,m,n,o,q,r,s){var t=0,u=2*a,v=b,w=b+a,x=1,y=1;f?y=i:x=i;for(var z=g;z<l;++z){var A=z+x,B=u*z;p[t++]=m[B+v],p[t++]=-A,p[t++]=m[B+w],p[t++]=A}for(var z=o;z<q;++z){var A=z+y,C=u*z;p[t++]=r[C+v],p[t++]=-A}var D=t>>>1;h(p,D);for(var E=0,z=0;z<D;++z){var F=0|p[2*z+1];if(F<0){var A=-F,G=!1;if(A>=i?(G=!f,A-=i):(G=!!f,A-=1),G)e(j,k,E++,A);else{var H=s[A],I=u*A,J=r[I+b+1],K=r[I+b+1+a];a:for(var L=0;L<E;++L){var M=j[L],N=u*M;if(!(K<m[N+b+1]||m[N+b+1+a]<J)){for(var O=b+2;O<a;++O)if(r[I+O+a]<m[N+O]||m[N+O+a]<r[I+O])continue a;var P,Q=n[M];if(void 0!==(P=f?c(H,Q):c(Q,H)))return P}}}}else d(j,k,E--,F-x)}},scanComplete:function(a,b,c,d,e,f,g,k,l,m,n){for(var o=0,q=2*a,r=b,s=b+a,t=d;t<e;++t){var u=t+i,v=q*t;p[o++]=f[v+r],p[o++]=-u,p[o++]=f[v+s],p[o++]=u}for(var t=k;t<l;++t){var u=t+1,w=q*t;p[o++]=m[w+r],p[o++]=-u}var x=o>>>1;h(p,x);for(var y=0,t=0;t<x;++t){var z=0|p[2*t+1];if(z<0){var u=-z;if(u>=i)j[y++]=u-i;else{var A=n[u-=1],B=q*u,C=m[B+b+1],D=m[B+b+1+a];a:for(var E=0;E<y;++E){var F=j[E],G=g[F];if(G===A)break;var H=q*F;if(!(D<f[H+b+1]||f[H+b+1+a]<C)){for(var I=b+2;I<a;++I)if(m[B+I+a]<f[H+I]||f[H+I+a]<m[B+I])continue a;var J=c(G,A);if(void 0!==J)return J}}}}else{for(var u=z-i,E=y-1;E>=0;--E)if(j[E]===u){for(var I=E+1;I<y;++I)j[I-1]=j[I];break}--y}}}};var f=a("typedarray-pool"),g=a("bit-twiddle"),h=a("./sort"),i=1<<28,j=f.mallocInt32(1024),k=f.mallocInt32(1024),l=f.mallocInt32(1024),m=f.mallocInt32(1024),n=f.mallocInt32(1024),o=f.mallocInt32(1024),p=f.mallocDouble(8192)},{"./sort":102,"bit-twiddle":93,"typedarray-pool":546}],104:[function(a,b,c){},{}],105:[function(a,b,c){function d(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=l(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}function e(a){return void 0===a._maxListeners?d.defaultMaxListeners:a._maxListeners}function f(a,b,c,d){var f,g,h;if("function"!=typeof c)throw new TypeError('"listener" argument must be a function');if((g=a._events)?(g.newListener&&(a.emit("newListener",b,c.listener?c.listener:c),g=a._events),h=g[b]):(g=a._events=l(null),a._eventsCount=0),h){if("function"==typeof h?h=g[b]=d?[c,h]:[h,c]:d?h.unshift(c):h.push(c),!h.warned&&(f=e(a))&&f>0&&h.length>f){h.warned=!0;var i=new Error("Possible EventEmitter memory leak detected. "+h.length+' "'+String(b)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');i.name="MaxListenersExceededWarning",i.emitter=a,i.type=b,i.count=h.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",i.name,i.message)}}else h=g[b]=c,++a._eventsCount;return a}function g(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var a=new Array(arguments.length),b=0;b<a.length;++b)a[b]=arguments[b];this.listener.apply(this.target,a)}}function h(a,b,c){var d={fired:!1,wrapFn:void 0,target:a,type:b,listener:c},e=n.call(g,d);return e.listener=c,d.wrapFn=e,e}function i(a,b,c){var d=a._events;if(!d)return[];var e=d[b];return e?"function"==typeof e?c?[e.listener||e]:[e]:c?function(a){for(var b=new Array(a.length),c=0;c<b.length;++c)b[c]=a[c].listener||a[c];return b}(e):k(e,e.length):[]}function j(a){var b=this._events;if(b){var c=b[a];if("function"==typeof c)return 1;if(c)return c.length}return 0}function k(a,b){for(var c=new Array(b),d=0;d<b;++d)c[d]=a[d];return c}var l=Object.create||function(a){var b=function(){};return b.prototype=a,new b},m=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return c},n=Function.prototype.bind||function(a){var b=this;return function(){return b.apply(a,arguments)}};b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0;var o,p=10;try{var q={};Object.defineProperty&&Object.defineProperty(q,"x",{value:0}),o=0===q.x}catch(a){o=!1}o?Object.defineProperty(d,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(a){if("number"!=typeof a||a<0||a!=a)throw new TypeError('"defaultMaxListeners" must be a positive number');p=a}}):d.defaultMaxListeners=p,d.prototype.setMaxListeners=function(a){if("number"!=typeof a||a<0||isNaN(a))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=a,this},d.prototype.getMaxListeners=function(){return e(this)},d.prototype.emit=function(a){var b,c,d,e,f,g,h="error"===a;if(g=this._events)h=h&&null==g.error;else if(!h)return!1;if(h){if(arguments.length>1&&(b=arguments[1]),b instanceof Error)throw b;var i=new Error('Unhandled "error" event. ('+b+")");throw i.context=b,i}if(!(c=g[a]))return!1;var j="function"==typeof c;switch(d=arguments.length){case 1:!function(a,b,c){if(b)a.call(c);else for(var d=a.length,e=k(a,d),f=0;f<d;++f)e[f].call(c)}(c,j,this);break;case 2:!function(a,b,c,d){if(b)a.call(c,d);else for(var e=a.length,f=k(a,e),g=0;g<e;++g)f[g].call(c,d)}(c,j,this,arguments[1]);break;case 3:!function(a,b,c,d,e){if(b)a.call(c,d,e);else for(var f=a.length,g=k(a,f),h=0;h<f;++h)g[h].call(c,d,e)}(c,j,this,arguments[1],arguments[2]);break;case 4:!function(a,b,c,d,e,f){if(b)a.call(c,d,e,f);else for(var g=a.length,h=k(a,g),i=0;i<g;++i)h[i].call(c,d,e,f)}(c,j,this,arguments[1],arguments[2],arguments[3]);break;default:for(e=new Array(d-1),f=1;f<d;f++)e[f-1]=arguments[f];!function(a,b,c,d){if(b)a.apply(c,d);else for(var e=a.length,f=k(a,e),g=0;g<e;++g)f[g].apply(c,d)}(c,j,this,e)}return!0},d.prototype.addListener=function(a,b){return f(this,a,b,!1)},d.prototype.on=d.prototype.addListener,d.prototype.prependListener=function(a,b){return f(this,a,b,!0)},d.prototype.once=function(a,b){if("function"!=typeof b)throw new TypeError('"listener" argument must be a function');return this.on(a,h(this,a,b)),this},d.prototype.prependOnceListener=function(a,b){if("function"!=typeof b)throw new TypeError('"listener" argument must be a function');return this.prependListener(a,h(this,a,b)),this},d.prototype.removeListener=function(a,b){var c,d,e,f,g;if("function"!=typeof b)throw new TypeError('"listener" argument must be a function');if(!(d=this._events))return this;if(!(c=d[a]))return this;if(c===b||c.listener===b)0==--this._eventsCount?this._events=l(null):(delete d[a],d.removeListener&&this.emit("removeListener",a,c.listener||b));else if("function"!=typeof c){for(e=-1,f=c.length-1;f>=0;f--)if(c[f]===b||c[f].listener===b){g=c[f].listener,e=f;break}if(e<0)return this;0===e?c.shift():function(a,b){for(var c=b,d=c+1,e=a.length;d<e;c+=1,d+=1)a[c]=a[d];a.pop()}(c,e),1===c.length&&(d[a]=c[0]),d.removeListener&&this.emit("removeListener",a,g||b)}return this},d.prototype.removeAllListeners=function(a){var b,c,d;if(!(c=this._events))return this;if(!c.removeListener)return 0===arguments.length?(this._events=l(null),this._eventsCount=0):c[a]&&(0==--this._eventsCount?this._events=l(null):delete c[a]),this;if(0===arguments.length){var e,f=m(c);for(d=0;d<f.length;++d)"removeListener"!==(e=f[d])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=l(null),this._eventsCount=0,this}if("function"==typeof(b=c[a]))this.removeListener(a,b);else if(b)for(d=b.length-1;d>=0;d--)this.removeListener(a,b[d]);return this},d.prototype.listeners=function(a){return i(this,a,!0)},d.prototype.rawListeners=function(a){return i(this,a,!1)},d.listenerCount=function(a,b){return"function"==typeof a.listenerCount?a.listenerCount(b):j.call(a,b)},d.prototype.listenerCount=j,d.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],106:[function(a,b,c){(function(b){"use strict";function d(a){if(a>N)throw new RangeError('The value "'+a+'" is invalid for option "size"');var c=new Uint8Array(a);return Object.setPrototypeOf(c,b.prototype),c}function b(a,b,c){if("number"==typeof a){if("string"==typeof b)throw new TypeError('The "string" argument must be of type string. Received type number');return g(a)}return e(a,b,c)}function e(a,c,e){if("string"==typeof a)return function(a,c){if("string"==typeof c&&""!==c||(c="utf8"),!b.isEncoding(c))throw new TypeError("Unknown encoding: "+c);var e=0|j(a,c),f=d(e),g=f.write(a,c);return g!==e&&(f=f.slice(0,g)),f}(a,c);if(ArrayBuffer.isView(a))return h(a);if(null==a)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(I(a,ArrayBuffer)||a&&I(a.buffer,ArrayBuffer))return function(a,c,d){if(c<0||a.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(a.byteLength<c+(d||0))throw new RangeError('"length" is outside of buffer bounds');var e;return e=void 0===c&&void 0===d?new Uint8Array(a):void 0===d?new Uint8Array(a,c):new Uint8Array(a,c,d),Object.setPrototypeOf(e,b.prototype),e}(a,c,e);if("number"==typeof a)throw new TypeError('The "value" argument must not be of type number. Received type number');var f=a.valueOf&&a.valueOf();if(null!=f&&f!==a)return b.from(f,c,e);var g=function(a){if(b.isBuffer(a)){var c=0|i(a.length),e=d(c);return 0===e.length?e:(a.copy(e,0,0,c),e)}return void 0!==a.length?"number"!=typeof a.length||J(a.length)?d(0):h(a):"Buffer"===a.type&&Array.isArray(a.data)?h(a.data):void 0}(a);if(g)return g;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return b.from(a[Symbol.toPrimitive]("string"),c,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function f(a){if("number"!=typeof a)throw new TypeError('"size" argument must be of type number');if(a<0)throw new RangeError('The value "'+a+'" is invalid for option "size"')}function g(a){return f(a),d(a<0?0:0|i(a))}function h(a){for(var b=a.length<0?0:0|i(a.length),c=d(b),e=0;e<b;e+=1)c[e]=255&a[e];return c}function i(a){if(a>=N)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+N.toString(16)+" bytes");return 0|a}function j(a,c){if(b.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||I(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);var d=a.length,e=arguments.length>2&&!0===arguments[2];if(!e&&0===d)return 0;for(var f=!1;;)switch(c){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":return F(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*d;case"hex":return d>>>1;case"base64":return G(a).length;default:if(f)return e?-1:F(a).length;c=(""+c).toLowerCase(),f=!0}}function k(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function l(a,c,d,e,f){if(0===a.length)return-1;if("string"==typeof d?(e=d,
d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),J(d=+d)&&(d=f?0:a.length-1),d<0&&(d=a.length+d),d>=a.length){if(f)return-1;d=a.length-1}else if(d<0){if(!f)return-1;d=0}if("string"==typeof c&&(c=b.from(c,e)),b.isBuffer(c))return 0===c.length?-1:m(a,c,d,e,f);if("number"==typeof c)return c&=255,"function"==typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(a,c,d):Uint8Array.prototype.lastIndexOf.call(a,c,d):m(a,[c],d,e,f);throw new TypeError("val must be string, number or Buffer")}function m(a,b,c,d,e){function f(a,b){return 1===h?a[b]:a.readUInt16BE(b*h)}var g,h=1,i=a.length,j=b.length;if(void 0!==d&&("ucs2"===(d=String(d).toLowerCase())||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return-1;h=2,i/=2,j/=2,c/=2}if(e){var k=-1;for(g=c;g<i;g++)if(f(a,g)===f(b,-1===k?0:g-k)){if(-1===k&&(k=g),g-k+1===j)return k*h}else-1!==k&&(g-=g-k),k=-1}else for(c+j>i&&(c=i-j),g=c;g>=0;g--){for(var l=!0,m=0;m<j;m++)if(f(a,g+m)!==f(b,m)){l=!1;break}if(l)return g}return-1}function n(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d))>e&&(d=e):d=e;var f=b.length;d>f/2&&(d=f/2);for(var g=0;g<d;++g){var h=parseInt(b.substr(2*g,2),16);if(J(h))return g;a[c+g]=h}return g}function o(a,b,c,d){return H(F(b,a.length-c),a,c,d)}function p(a,b,c,d){return H(function(a){for(var b=[],c=0;c<a.length;++c)b.push(255&a.charCodeAt(c));return b}(b),a,c,d)}function q(a,b,c,d){return p(a,b,c,d)}function r(a,b,c,d){return H(G(b),a,c,d)}function s(a,b,c,d){return H(function(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);++g)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}(b,a.length-c),a,c,d)}function t(a,b,c){return 0===b&&c===a.length?K.fromByteArray(a):K.fromByteArray(a.slice(b,c))}function u(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;e<c;){var f,g,h,i,j=a[e],k=null,l=j>239?4:j>223?3:j>191?2:1;if(e+l<=c)switch(l){case 1:j<128&&(k=j);break;case 2:128==(192&(f=a[e+1]))&&(i=(31&j)<<6|63&f)>127&&(k=i);break;case 3:f=a[e+1],g=a[e+2],128==(192&f)&&128==(192&g)&&(i=(15&j)<<12|(63&f)<<6|63&g)>2047&&(i<55296||i>57343)&&(k=i);break;case 4:f=a[e+1],g=a[e+2],h=a[e+3],128==(192&f)&&128==(192&g)&&128==(192&h)&&(i=(15&j)<<18|(63&f)<<12|(63&g)<<6|63&h)>65535&&i<1114112&&(k=i)}null===k?(k=65533,l=1):k>65535&&(k-=65536,d.push(k>>>10&1023|55296),k=56320|1023&k),d.push(k),e+=l}return function(a){var b=a.length;if(b<=O)return String.fromCharCode.apply(String,a);for(var c="",d=0;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=O));return c}(d)}function v(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;++e)d+=String.fromCharCode(127&a[e]);return d}function w(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}function x(a,b,c){var d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);for(var e="",f=b;f<c;++f)e+=E(a[f]);return e}function y(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function z(a,b,c){if(a%1!=0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function A(a,c,d,e,f,g){if(!b.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>f||c<g)throw new RangeError('"value" argument is out of bounds');if(d+e>a.length)throw new RangeError("Index out of range")}function B(a,b,c,d,e,f){if(c+d>a.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function C(a,b,c,d,e){return b=+b,c>>>=0,e||B(a,0,c,4),L.write(a,b,c,d,23,4),c+4}function D(a,b,c,d,e){return b=+b,c>>>=0,e||B(a,0,c,8),L.write(a,b,c,d,52,8),c+8}function E(a){return a<16?"0"+a.toString(16):a.toString(16)}function F(a,b){var c;b=b||1/0;for(var d=a.length,e=null,f=[],g=0;g<d;++g){if((c=a.charCodeAt(g))>55295&&c<57344){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=65536+(e-55296<<10|c-56320)}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(c<1114112))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function G(a){return K.toByteArray(function(a){if((a=(a=a.split("=")[0]).trim().replace(P,"")).length<2)return"";for(;a.length%4!=0;)a+="=";return a}(a))}function H(a,b,c,d){for(var e=0;e<d&&!(e+c>=b.length||e>=a.length);++e)b[e+c]=a[e];return e}function I(a,b){return a instanceof b||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===b.name}function J(a){return a!=a}var K=a("base64-js"),L=a("ieee754"),M="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;c.Buffer=b,c.SlowBuffer=function(a){return+a!=a&&(a=0),b.alloc(+a)},c.INSPECT_MAX_BYTES=50;var N=2147483647;c.kMaxLength=N,b.TYPED_ARRAY_SUPPORT=function(){try{var a=new Uint8Array(1),b={foo:function(){return 42}};return Object.setPrototypeOf(b,Uint8Array.prototype),Object.setPrototypeOf(a,b),42===a.foo()}catch(a){return!1}}(),b.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(b.prototype,"parent",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.buffer}}),Object.defineProperty(b.prototype,"offset",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&b[Symbol.species]===b&&Object.defineProperty(b,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),b.poolSize=8192,b.from=function(a,b,c){return e(a,b,c)},Object.setPrototypeOf(b.prototype,Uint8Array.prototype),Object.setPrototypeOf(b,Uint8Array),b.alloc=function(a,b,c){return function(a,b,c){return f(a),a<=0?d(a):void 0!==b?"string"==typeof c?d(a).fill(b,c):d(a).fill(b):d(a)}(a,b,c)},b.allocUnsafe=function(a){return g(a)},b.allocUnsafeSlow=function(a){return g(a)},b.isBuffer=function(a){return null!=a&&!0===a._isBuffer&&a!==b.prototype},b.compare=function(a,c){if(I(a,Uint8Array)&&(a=b.from(a,a.offset,a.byteLength)),I(c,Uint8Array)&&(c=b.from(c,c.offset,c.byteLength)),!b.isBuffer(a)||!b.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===c)return 0;for(var d=a.length,e=c.length,f=0,g=Math.min(d,e);f<g;++f)if(a[f]!==c[f]){d=a[f],e=c[f];break}return d<e?-1:e<d?1:0},b.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},b.concat=function(a,c){if(!Array.isArray(a))throw new TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return b.alloc(0);var d;if(void 0===c)for(c=0,d=0;d<a.length;++d)c+=a[d].length;var e=b.allocUnsafe(c),f=0;for(d=0;d<a.length;++d){var g=a[d];if(I(g,Uint8Array)&&(g=b.from(g)),!b.isBuffer(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(e,f),f+=g.length}return e},b.byteLength=j,b.prototype._isBuffer=!0,b.prototype.swap16=function(){var a=this.length;if(a%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<a;b+=2)k(this,b,b+1);return this},b.prototype.swap32=function(){var a=this.length;if(a%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<a;b+=4)k(this,b,b+3),k(this,b+1,b+2);return this},b.prototype.swap64=function(){var a=this.length;if(a%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<a;b+=8)k(this,b,b+7),k(this,b+1,b+6),k(this,b+2,b+5),k(this,b+3,b+4);return this},b.prototype.toString=function(){var a=this.length;return 0===a?"":0===arguments.length?u(this,0,a):function(a,b,c){var d=!1;if((void 0===b||b<0)&&(b=0),b>this.length)return"";if((void 0===c||c>this.length)&&(c=this.length),c<=0)return"";if((c>>>=0)<=(b>>>=0))return"";for(a||(a="utf8");;)switch(a){case"hex":return x(this,b,c);case"utf8":case"utf-8":return u(this,b,c);case"ascii":return v(this,b,c);case"latin1":case"binary":return w(this,b,c);case"base64":return t(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}.apply(this,arguments)},b.prototype.toLocaleString=b.prototype.toString,b.prototype.equals=function(a){if(!b.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a||0===b.compare(this,a)},b.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return a=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(a+=" ... "),"<Buffer "+a+">"},M&&(b.prototype[M]=b.prototype.inspect),b.prototype.compare=function(a,c,d,e,f){if(I(a,Uint8Array)&&(a=b.from(a,a.offset,a.byteLength)),!b.isBuffer(a))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(void 0===c&&(c=0),void 0===d&&(d=a?a.length:0),void 0===e&&(e=0),void 0===f&&(f=this.length),c<0||d>a.length||e<0||f>this.length)throw new RangeError("out of range index");if(e>=f&&c>=d)return 0;if(e>=f)return-1;if(c>=d)return 1;if(this===a)return 0;for(var g=(f>>>=0)-(e>>>=0),h=(d>>>=0)-(c>>>=0),i=Math.min(g,h),j=this.slice(e,f),k=a.slice(c,d),l=0;l<i;++l)if(j[l]!==k[l]){g=j[l],h=k[l];break}return g<h?-1:h<g?1:0},b.prototype.includes=function(a,b,c){return-1!==this.indexOf(a,b,c)},b.prototype.indexOf=function(a,b,c){return l(this,a,b,c,!0)},b.prototype.lastIndexOf=function(a,b,c){return l(this,a,b,c,!1)},b.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else{if(!isFinite(b))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");b>>>=0,isFinite(c)?(c>>>=0,void 0===d&&(d="utf8")):(d=c,c=void 0)}var e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(c<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(var f=!1;;)switch(d){case"hex":return n(this,a,b,c);case"utf8":case"utf-8":return o(this,a,b,c);case"ascii":return p(this,a,b,c);case"latin1":case"binary":return q(this,a,b,c);case"base64":return r(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s(this,a,b,c);default:if(f)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;b.prototype.slice=function(a,c){var d=this.length;(a=~~a)<0?(a+=d)<0&&(a=0):a>d&&(a=d),(c=void 0===c?d:~~c)<0?(c+=d)<0&&(c=0):c>d&&(c=d),c<a&&(c=a);var e=this.subarray(a,c);return Object.setPrototypeOf(e,b.prototype),e},b.prototype.readUIntLE=function(a,b,c){a>>>=0,b>>>=0,c||z(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},b.prototype.readUIntBE=function(a,b,c){a>>>=0,b>>>=0,c||z(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},b.prototype.readUInt8=function(a,b){return a>>>=0,b||z(a,1,this.length),this[a]},b.prototype.readUInt16LE=function(a,b){return a>>>=0,b||z(a,2,this.length),this[a]|this[a+1]<<8},b.prototype.readUInt16BE=function(a,b){return a>>>=0,b||z(a,2,this.length),this[a]<<8|this[a+1]},b.prototype.readUInt32LE=function(a,b){return a>>>=0,b||z(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},b.prototype.readUInt32BE=function(a,b){return a>>>=0,b||z(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},b.prototype.readIntLE=function(a,b,c){a>>>=0,b>>>=0,c||z(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d>=(e*=128)&&(d-=Math.pow(2,8*b)),d},b.prototype.readIntBE=function(a,b,c){a>>>=0,b>>>=0,c||z(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return f>=(e*=128)&&(f-=Math.pow(2,8*b)),f},b.prototype.readInt8=function(a,b){return a>>>=0,b||z(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},b.prototype.readInt16LE=function(a,b){a>>>=0,b||z(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},b.prototype.readInt16BE=function(a,b){a>>>=0,b||z(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},b.prototype.readInt32LE=function(a,b){return a>>>=0,b||z(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},b.prototype.readInt32BE=function(a,b){return a>>>=0,b||z(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},b.prototype.readFloatLE=function(a,b){return a>>>=0,b||z(a,4,this.length),L.read(this,a,!0,23,4)},b.prototype.readFloatBE=function(a,b){return a>>>=0,b||z(a,4,this.length),L.read(this,a,!1,23,4)},b.prototype.readDoubleLE=function(a,b){return a>>>=0,b||z(a,8,this.length),L.read(this,a,!0,52,8)},b.prototype.readDoubleBE=function(a,b){return a>>>=0,b||z(a,8,this.length),L.read(this,a,!1,52,8)},b.prototype.writeUIntLE=function(a,b,c,d){a=+a,b>>>=0,c>>>=0,d||A(this,a,b,c,Math.pow(2,8*c)-1,0);var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},b.prototype.writeUIntBE=function(a,b,c,d){a=+a,b>>>=0,c>>>=0,d||A(this,a,b,c,Math.pow(2,8*c)-1,0);var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},b.prototype.writeUInt8=function(a,b,c){return a=+a,b>>>=0,c||A(this,a,b,1,255,0),this[b]=255&a,b+1},b.prototype.writeUInt16LE=function(a,b,c){return a=+a,b>>>=0,c||A(this,a,b,2,65535,0),this[b]=255&a,this[b+1]=a>>>8,b+2},b.prototype.writeUInt16BE=function(a,b,c){return a=+a,b>>>=0,c||A(this,a,b,2,65535,0),this[b]=a>>>8,this[b+1]=255&a,b+2},b.prototype.writeUInt32LE=function(a,b,c){return a=+a,b>>>=0,c||A(this,a,b,4,4294967295,0),this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a,b+4},b.prototype.writeUInt32BE=function(a,b,c){return a=+a,b>>>=0,c||A(this,a,b,4,4294967295,0),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},b.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b>>>=0,!d){var e=Math.pow(2,8*c-1);A(this,a,b,c,e-1,-e)}var f=0,g=1,h=0;for(this[b]=255&a;++f<c&&(g*=256);)a<0&&0===h&&0!==this[b+f-1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},b.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b>>>=0,!d){var e=Math.pow(2,8*c-1);A(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0;for(this[b+f]=255&a;--f>=0&&(g*=256);)a<0&&0===h&&0!==this[b+f+1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},b.prototype.writeInt8=function(a,b,c){return a=+a,b>>>=0,c||A(this,a,b,1,127,-128),a<0&&(a=255+a+1),this[b]=255&a,b+1},b.prototype.writeInt16LE=function(a,b,c){return a=+a,b>>>=0,c||A(this,a,b,2,32767,-32768),this[b]=255&a,this[b+1]=a>>>8,b+2},b.prototype.writeInt16BE=function(a,b,c){return a=+a,b>>>=0,c||A(this,a,b,2,32767,-32768),this[b]=a>>>8,this[b+1]=255&a,b+2},b.prototype.writeInt32LE=function(a,b,c){return a=+a,b>>>=0,c||A(this,a,b,4,2147483647,-2147483648),this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24,b+4},b.prototype.writeInt32BE=function(a,b,c){return a=+a,b>>>=0,c||A(this,a,b,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},b.prototype.writeFloatLE=function(a,b,c){return C(this,a,b,!0,c)},b.prototype.writeFloatBE=function(a,b,c){return C(this,a,b,!1,c)},b.prototype.writeDoubleLE=function(a,b,c){return D(this,a,b,!0,c)},b.prototype.writeDoubleBE=function(a,b,c){return D(this,a,b,!1,c)},b.prototype.copy=function(a,c,d,e){if(!b.isBuffer(a))throw new TypeError("argument should be a Buffer");if(d||(d=0),e||0===e||(e=this.length),c>=a.length&&(c=a.length),c||(c=0),e>0&&e<d&&(e=d),e===d)return 0;if(0===a.length||0===this.length)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),a.length-c<e-d&&(e=a.length-c+d);var f=e-d;if(this===a&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(c,d,e);else if(this===a&&d<c&&c<e)for(var g=f-1;g>=0;--g)a[g+c]=this[g+d];else Uint8Array.prototype.set.call(a,this.subarray(d,e),c);return f},b.prototype.fill=function(a,c,d,e){if("string"==typeof a){if("string"==typeof c?(e=c,c=0,d=this.length):"string"==typeof d&&(e=d,d=this.length),void 0!==e&&"string"!=typeof e)throw new TypeError("encoding must be a string");if("string"==typeof e&&!b.isEncoding(e))throw new TypeError("Unknown encoding: "+e);if(1===a.length){var f=a.charCodeAt(0);("utf8"===e&&f<128||"latin1"===e)&&(a=f)}}else"number"==typeof a?a&=255:"boolean"==typeof a&&(a=Number(a));if(c<0||this.length<c||this.length<d)throw new RangeError("Out of range index");if(d<=c)return this;var g;if(c>>>=0,d=void 0===d?this.length:d>>>0,a||(a=0),"number"==typeof a)for(g=c;g<d;++g)this[g]=a;else{var h=b.isBuffer(a)?a:b.from(a,e),i=h.length;if(0===i)throw new TypeError('The value "'+a+'" is invalid for argument "value"');for(g=0;g<d-c;++g)this[g+c]=h[g%i]}return this};var P=/[^+\/0-9A-Za-z-_]/g}).call(this,a("buffer").Buffer)},{"base64-js":75,buffer:106,ieee754:413}],107:[function(a,b,c){"use strict";function d(a){return[Math.min(a[0],a[1]),Math.max(a[0],a[1])]}function e(a,b){return a[0]-b[0]||a[1]-b[1]}function f(a,b,c){return b in a?a[b]:c}var g=a("./lib/monotone"),h=a("./lib/triangulation"),i=a("./lib/delaunay"),j=a("./lib/filter");b.exports=function(a,b,c){Array.isArray(b)?(c=c||{},b=b||[]):(c=b||{},b=[]);var k=!!f(c,"delaunay",!0),l=!!f(c,"interior",!0),m=!!f(c,"exterior",!0),n=!!f(c,"infinity",!1);if(!l&&!m||0===a.length)return[];var o=g(a,b);if(k||l!==m||n){for(var p=h(a.length,function(a){return a.map(d).sort(e)}(b)),q=0;q<o.length;++q){var r=o[q];p.addTriangle(r[0],r[1],r[2])}return k&&i(a,p),m?l?n?j(p,0,n):p.cells():j(p,1,n):j(p,-1)}return o}},{"./lib/delaunay":108,"./lib/filter":109,"./lib/monotone":110,"./lib/triangulation":111}],108:[function(a,b,c){"use strict";function d(a,b,c,d,f,g){var h=b.opposite(d,f);if(!(h<0)){if(f<d){var i=d;d=f,f=i,i=g,g=h,h=i}b.isConstraint(d,f)||e(a[d],a[f],a[g],a[h])<0&&c.push(d,f)}}var e=a("robust-in-sphere")[4];a("binary-search-bounds"),b.exports=function(a,b){for(var c=[],f=a.length,g=b.stars,h=0;h<f;++h)for(var i=g[h],j=1;j<i.length;j+=2){var k=i[j];if(!(k<h||b.isConstraint(h,k))){for(var l=i[j-1],m=-1,n=1;n<i.length;n+=2)if(i[n-1]===k){m=i[n];break}m<0||e(a[h],a[k],a[l],a[m])<0&&c.push(h,k)}}for(;c.length>0;){for(var k=c.pop(),h=c.pop(),l=-1,m=-1,i=g[h],o=1;o<i.length;o+=2){var p=i[o-1],q=i[o];p===k?m=q:q===k&&(l=p)}l<0||m<0||e(a[h],a[k],a[l],a[m])>=0||(b.flip(h,k),d(a,b,c,l,h,m),d(a,b,c,h,m,l),d(a,b,c,m,k,l),d(a,b,c,k,l,m))}}},{"binary-search-bounds":112,"robust-in-sphere":509}],109:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g){this.cells=a,this.neighbor=b,this.flags=d,this.constraint=c,this.active=e,this.next=f,this.boundary=g}function e(a,b){return a[0]-b[0]||a[1]-b[1]||a[2]-b[2]}var f,g=a("binary-search-bounds");b.exports=function(a,b,c){var f=function(a,b){for(var c=a.cells(),f=c.length,g=0;g<f;++g){var h=c[g],i=h[0],j=h[1],k=h[2];j<k?j<i&&(h[0]=j,h[1]=k,h[2]=i):k<i&&(h[0]=k,h[1]=i,h[2]=j)}c.sort(e);for(var l=new Array(f),g=0;g<l.length;++g)l[g]=0;var m=[],n=[],o=new Array(3*f),p=new Array(3*f),q=null;b&&(q=[]);for(var r=new d(c,o,p,l,m,n,q),g=0;g<f;++g)for(var h=c[g],s=0;s<3;++s){var i=h[s],j=h[(s+1)%3],t=o[3*g+s]=r.locate(j,i,a.opposite(j,i)),u=p[3*g+s]=a.isConstraint(i,j);t<0&&(u?n.push(g):(m.push(g),l[g]=1),b&&q.push([j,i,-1]))}return r}(a,c);if(0===b)return c?f.cells.concat(f.boundary):f.cells;for(var g=1,h=f.active,i=f.next,j=f.flags,k=f.cells,l=f.constraint,m=f.neighbor;h.length>0||i.length>0;){for(;h.length>0;){var n=h.pop();if(j[n]!==-g){j[n]=g,k[n];for(var o=0;o<3;++o){var p=m[3*n+o];p>=0&&0===j[p]&&(l[3*n+o]?i.push(p):(h.push(p),j[p]=g))}}}var q=i;i=h,h=q,i.length=0,g=-g}var r=function(a,b,c){for(var d=0,e=0;e<a.length;++e)b[e]===c&&(a[d++]=a[e]);return a.length=d,a}(k,j,b);return c?r.concat(f.boundary):r},d.prototype.locate=(f=[0,0,0],function(a,b,c){var d=a,h=b,i=c;return b<c?b<a&&(d=b,h=c,i=a):c<a&&(d=c,h=a,i=b),d<0?-1:(f[0]=d,f[1]=h,f[2]=i,g.eq(this.cells,f,e))})},{"binary-search-bounds":112}],110:[function(a,b,c){"use strict";function d(a,b,c,d,e){this.a=a,this.b=b,this.idx=c,this.lowerIds=d,this.upperIds=e}function e(a,b,c,d){this.a=a,this.b=b,this.type=c,this.idx=d}function f(a,b){var c=a.a[0]-b.a[0]||a.a[1]-b.a[1]||a.type-b.type;return c||(a.type!==n&&(c=m(a.a,a.b,b.b))?c:a.idx-b.idx)}function g(a,b){return m(a.a,a.b,b)}function h(a,b,c,d,e){for(var f=l.lt(b,d,g),h=l.gt(b,d,g),i=f;i<h;++i){for(var j=b[i],k=j.lowerIds,n=k.length;n>1&&m(c[k[n-2]],c[k[n-1]],d)>0;)a.push([k[n-1],k[n-2],e]),n-=1;k.length=n,k.push(e);var o=j.upperIds;for(n=o.length;n>1&&m(c[o[n-2]],c[o[n-1]],d)<0;)a.push([o[n-2],o[n-1],e]),n-=1;o.length=n,o.push(e)}}function i(a,b){var c;return(c=a.a[0]<b.a[0]?m(a.a,a.b,b.a):m(b.b,b.a,a.a))?c:(c=b.b[0]<a.b[0]?m(a.a,a.b,b.b):m(b.b,b.a,a.b))||a.idx-b.idx}function j(a,b,c){var e=l.le(a,c,i),f=a[e],g=f.upperIds,h=g[g.length-1];f.upperIds=[h],a.splice(e+1,0,new d(c.a,c.b,c.idx,[h],g))}function k(a,b,c){var d=c.a;c.a=c.b,c.b=d;var e=l.eq(a,c,i),f=a[e];a[e-1].upperIds=f.upperIds,a.splice(e,1)}var l=a("binary-search-bounds"),m=a("robust-orientation")[3],n=0;b.exports=function(a,b){for(var c=a.length,g=b.length,i=[],l=0;l<c;++l)i.push(new e(a[l],null,n,l));for(var l=0;l<g;++l){var m=b[l],o=a[m[0]],p=a[m[1]];o[0]<p[0]?i.push(new e(o,p,2,l),new e(p,o,1,l)):o[0]>p[0]&&i.push(new e(p,o,2,l),new e(o,p,1,l))}i.sort(f);for(var q=i[0].a[0]-(1+Math.abs(i[0].a[0]))*Math.pow(2,-52),r=[new d([q,1],[q,0],-1,[],[],[],[])],s=[],l=0,t=i.length;l<t;++l){var u=i[l],v=u.type;v===n?h(s,r,a,u.a,u.idx):2===v?j(r,a,u):k(r,a,u)}return s}},{"binary-search-bounds":112,"robust-orientation":511}],111:[function(a,b,c){"use strict";function d(a,b){this.stars=a,this.edges=b}function e(a,b,c){for(var d=1,e=a.length;d<e;d+=2)if(a[d-1]===b&&a[d]===c)return a[d-1]=a[e-2],a[d]=a[e-1],void(a.length=e-2)}var f=a("binary-search-bounds");b.exports=function(a,b){for(var c=new Array(a),e=0;e<a;++e)c[e]=[];return new d(c,b)};var g=d.prototype;g.isConstraint=function(){function a(a,b){return a[0]-b[0]||a[1]-b[1]}var b=[0,0];return function(c,d){return b[0]=Math.min(c,d),b[1]=Math.max(c,d),f.eq(this.edges,b,a)>=0}}(),g.removeTriangle=function(a,b,c){var d=this.stars;e(d[a],b,c),e(d[b],c,a),e(d[c],a,b)},g.addTriangle=function(a,b,c){var d=this.stars;d[a].push(b,c),d[b].push(c,a),d[c].push(a,b)},g.opposite=function(a,b){for(var c=this.stars[b],d=1,e=c.length;d<e;d+=2)if(c[d]===a)return c[d-1];return-1},g.flip=function(a,b){var c=this.opposite(a,b),d=this.opposite(b,a);this.removeTriangle(a,b,c),this.removeTriangle(b,a,d),this.addTriangle(a,d,c),this.addTriangle(b,c,d)},g.edges=function(){for(var a=this.stars,b=[],c=0,d=a.length;c<d;++c)for(var e=a[c],f=0,g=e.length;f<g;f+=2)b.push([e[f],e[f+1]]);return b},g.cells=function(){for(var a=this.stars,b=[],c=0,d=a.length;c<d;++c)for(var e=a[c],f=0,g=e.length;f<g;f+=2){var h=e[f],i=e[f+1];c<Math.min(h,i)&&b.push([c,h,i])}return b}},{"binary-search-bounds":112}],112:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=["function ",a,"(a,l,h,",d.join(","),"){",e?"":"var i=",c?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return e?b.indexOf("c")<0?f.push(";if(x===y){return m}else if(x<=y){"):f.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):f.push(";if(",b,"){i=m;"),c?f.push("l=m+1}else{h=m-1}"):f.push("h=m-1}else{l=m+1}"),f.push("}"),e?f.push("return -1};"):f.push("return i};"),f.join("")}function e(a,b,c,e){return new Function([d("A","x"+a+"y",b,["y"],e),d("P","c(x,y)"+a+"0",b,["y","c"],e),"function dispatchBsearch",c,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",c].join(""))()}b.exports={ge:e(">=",!1,"GE"),gt:e(">",!1,"GT"),lt:e("<",!0,"LT"),le:e("<=",!0,"LE"),eq:e("-",!0,"EQ",!0)}},{}],113:[function(a,b,c){"use strict";b.exports=function(a){for(var b=1,c=1;c<a.length;++c)for(var d=0;d<c;++d)if(a[c]<a[d])b=-b;else if(a[d]===a[c])return 0;return b}},{}],114:[function(a,b,c){"use strict";function d(a,b){for(var c=0,d=a.length,e=0;e<d;++e)c+=a[e]*b[e];return c}function e(a){var b=a.length;if(0===b)return[];a[0].length;var c=g([a.length+1,a.length+1],1),e=g([a.length+1],1);c[b][b]=0;for(var f=0;f<b;++f){for(var i=0;i<=f;++i)c[i][f]=c[f][i]=2*d(a[f],a[i]);e[f]=d(a[f],a[f])}var j=h(c,e),k=0,l=j[b+1];for(f=0;f<l.length;++f)k+=l[f];var m=new Array(b);for(f=0;f<b;++f){l=j[f];var n=0;for(i=0;i<l.length;++i)n+=l[i];m[f]=n/k}return m}function f(a){if(0===a.length)return[];for(var b=a[0].length,c=g([b]),d=e(a),f=0;f<a.length;++f)for(var h=0;h<b;++h)c[h]+=a[f][h]*d[f];return c}var g=a("dup"),h=a("robust-linear-solve");f.barycenetric=e,b.exports=f},{dup:171,"robust-linear-solve":510}],115:[function(a,b,c){b.exports=function(a){for(var b=d(a),c=0,e=0;e<a.length;++e)for(var f=a[e],g=0;g<b.length;++g)c+=Math.pow(f[g]-b[g],2);return Math.sqrt(c/a.length)};var d=a("circumcenter")},{circumcenter:114}],116:[function(a,b,c){b.exports=function(a,b,c){return b<c?a<b?b:a>c?c:a:a<c?c:a>b?b:a}},{}],117:[function(a,b,c){"use strict";function d(a){var b=p(a);return[r(b,-1/0),r(b,1/0)]}function e(a){for(var b=new Array(a.length),c=0;c<a.length;++c){var d=a[c];b[c]=[r(d[0],-1/0),r(d[1],-1/0),r(d[0],1/0),r(d[1],1/0)]}return b}function f(a,b,c){for(var e=b.length,f=new k(e),g=[],h=0;h<b.length;++h){var i=b[h],j=d(i[0]),m=d(i[1]);g.push([r(j[0],-1/0),r(m[0],-1/0),r(j[1],1/0),r(m[1],1/0)])}l(g,function(a,b){f.link(a,b)});var n=!0,o=new Array(e);for(h=0;h<e;++h)(q=f.find(h))!==h&&(n=!1,a[q]=[Math.min(a[h][0],a[q][0]),Math.min(a[h][1],a[q][1])]);if(n)return null;var p=0;for(h=0;h<e;++h){var q;(q=f.find(h))===h?(o[h]=p,a[p++]=a[h]):o[h]=-1}for(a.length=p,h=0;h<e;++h)o[h]<0&&(o[h]=o[f.find(h)]);return o}function g(a,b){return a[0]-b[0]||a[1]-b[1]}function h(a,b){return a[0]-b[0]||a[1]-b[1]||(a[2]<b[2]?-1:a[2]>b[2]?1:0)}function i(a,b,c){if(0!==a.length){if(b)for(var d=0;d<a.length;++d){var e=b[(i=a[d])[0]],f=b[i[1]];i[0]=Math.min(e,f),i[1]=Math.max(e,f)}else for(d=0;d<a.length;++d){var i;e=(i=a[d])[0],f=i[1],i[0]=Math.min(e,f),i[1]=Math.max(e,f)}c?a.sort(h):a.sort(g);var j=1;for(d=1;d<a.length;++d){var k=a[d-1],l=a[d];(l[0]!==k[0]||l[1]!==k[1]||c&&l[2]!==k[2])&&(a[j++]=l)}a.length=j}}function j(a,b,c){var d=function(a,b){for(var c=new Array(b.length),d=0;d<b.length;++d){var e=b[d],f=a[e[0]],g=a[e[1]];c[d]=[r(Math.min(f[0],g[0]),-1/0),r(Math.min(f[1],g[1]),-1/0),r(Math.max(f[0],g[0]),1/0),r(Math.max(f[1],g[1]),1/0)]}return c}(a,b),g=function(a,b,c){var d=[];return l(c,function(c,e){var f=b[c],g=b[e];if(f[0]!==g[0]&&f[0]!==g[1]&&f[1]!==g[0]&&f[1]!==g[1]){var h=a[f[0]],i=a[f[1]],j=a[g[0]],k=a[g[1]];m(h,i,j,k)&&d.push([c,e])}}),d}(a,b,d),h=e(a),j=function(a,b,c,d){var e=[];return l(c,d,function(c,d){var f=b[c];if(f[0]!==d&&f[1]!==d){var g=a[d],h=a[f[0]],i=a[f[1]];m(h,i,g,g)&&e.push([c,d])}}),e}(a,b,d,h),k=f(a,function(a,b,c,d,e){var f,g,h=a.map(function(a){return[n(a[0]),n(a[1])]});for(f=0;f<c.length;++f){var i=c[f];g=i[0];var j=i[1],k=b[g],l=b[j],m=s(q(a[k[0]]),q(a[k[1]]),q(a[l[0]]),q(a[l[1]]));if(m){var r=a.length;a.push([p(m[0]),p(m[1])]),h.push(m),d.push([g,r],[j,r])}}for(d.sort(function(a,b){if(a[0]!==b[0])return a[0]-b[0];var c=h[a[1]],d=h[b[1]];return o(c[0],d[0])||o(c[1],d[1])}),f=d.length-1;f>=0;--f){var t=b[g=(B=d[f])[0]],u=t[0],v=t[1],w=a[u],x=a[v];if((w[0]-x[0]||w[1]-x[1])<0){var y=u;u=v,v=y}t[0]=u;var z,A=t[1]=B[1];for(e&&(z=t[2]);f>0&&d[f-1][0]===g;){var B,C=(B=d[--f])[1];e?b.push([A,C,z]):b.push([A,C]),A=C}e?b.push([A,v,z]):b.push([A,v])}return h}(a,b,g,j,c));return i(b,k,c),!!k||g.length>0||j.length>0}b.exports=function(a,b,c){var d;if(c){d=b;for(var g=new Array(b.length),h=0;h<b.length;++h){var k=b[h];g[h]=[k[0],k[1],c[h]]}b=g}for(var l=function(a,b,c){var d=f(a,[],e(a));return i(b,d,c),!!d}(a,b,!!c);j(a,b,!!c);)l=!0;if(c&&l){d.length=0,c.length=0;for(var h=0;h<b.length;++h){var k=b[h];d.push([k[0],k[1]]),c.push(k[2])}}return l};var k=a("union-find"),l=a("box-intersect"),m=a("robust-segment-intersect"),n=a("big-rat"),o=a("big-rat/cmp"),p=a("big-rat/to-float"),q=a("rat-vec"),r=a("nextafter"),s=a("./lib/rat-seg-intersect")},{"./lib/rat-seg-intersect":118,"big-rat":79,"big-rat/cmp":77,"big-rat/to-float":91,"box-intersect":97,nextafter:452,"rat-vec":487,"robust-segment-intersect":514,"union-find":547}],118:[function(a,b,c){"use strict";function d(a,b){return g(e(a[0],b[1]),e(a[1],b[0]))}b.exports=function(a,b,c,e){var g=i(b,a),l=i(e,c),m=d(g,l);if(0===h(m))return null;var n=i(a,c),o=d(l,n),p=f(o,m),q=k(g,p);return j(a,q)};var e=a("big-rat/mul"),f=a("big-rat/div"),g=a("big-rat/sub"),h=a("big-rat/sign"),i=a("rat-vec/sub"),j=a("rat-vec/add"),k=a("rat-vec/muls")},{"big-rat/div":78,"big-rat/mul":88,"big-rat/sign":89,"big-rat/sub":90,"rat-vec/add":486,"rat-vec/muls":488,"rat-vec/sub":489}],119:[function(a,b,c){"use strict";function d(a,b){null==b&&(b=!0);var c=a[0],d=a[1],f=a[2],g=a[3];return null==g&&(g=b?1:255),b&&(c*=255,d*=255,f*=255,g*=255),16777216*(c=255&e(c,0,255))+((d=255&e(d,0,255))<<16)+((f=255&e(f,0,255))<<8)+(g=255&e(g,0,255))}var e=a("clamp");b.exports=d,b.exports.to=d,b.exports.from=function(a,b){var c=(a=+a)>>>24,d=(16711680&a)>>>16,e=(65280&a)>>>8,f=255&a;return!1===b?[c,d,e,f]:[c/255,d/255,e/255,f/255]}},{clamp:116}],120:[function(a,b,c){"use strict";b.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],
mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],121:[function(a,b,c){"use strict";var d=a("color-rgba"),e=a("clamp"),f=a("dtype");b.exports=function(a,b){"float"!==b&&b||(b="array"),"uint"===b&&(b="uint8"),"uint_clamped"===b&&(b="uint8_clamped");var c=new(f(b))(4),g="uint8"!==b&&"uint8_clamped"!==b;return a.length&&"string"!=typeof a||((a=d(a))[0]/=255,a[1]/=255,a[2]/=255),function(a){return a instanceof Uint8Array||a instanceof Uint8ClampedArray||!!(Array.isArray(a)&&(a[0]>1||0===a[0])&&(a[1]>1||0===a[1])&&(a[2]>1||0===a[2])&&(!a[3]||a[3]>1))}(a)?(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=null!=a[3]?a[3]:255,g&&(c[0]/=255,c[1]/=255,c[2]/=255,c[3]/=255),c):(g?(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=null!=a[3]?a[3]:1):(c[0]=e(Math.floor(255*a[0]),0,255),c[1]=e(Math.floor(255*a[1]),0,255),c[2]=e(Math.floor(255*a[2]),0,255),c[3]=null==a[3]?255:e(Math.floor(255*a[3]),0,255)),c)}},{clamp:116,"color-rgba":123,dtype:170}],122:[function(a,b,c){(function(c){"use strict";var d=a("color-name"),e=a("is-plain-obj"),f=a("defined");b.exports=function(a){var b,h,i=[],j=1;if("string"==typeof a)if(d[a])i=d[a].slice(),h="rgb";else if("transparent"===a)j=0,h="rgb",i=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(a)){var k=a.slice(1),l=k.length,m=l<=4;j=1,m?(i=[parseInt(k[0]+k[0],16),parseInt(k[1]+k[1],16),parseInt(k[2]+k[2],16)],4===l&&(j=parseInt(k[3]+k[3],16)/255)):(i=[parseInt(k[0]+k[1],16),parseInt(k[2]+k[3],16),parseInt(k[4]+k[5],16)],8===l&&(j=parseInt(k[6]+k[7],16)/255)),i[0]||(i[0]=0),i[1]||(i[1]=0),i[2]||(i[2]=0),h="rgb"}else if(b=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(a)){var n=b[1],o="rgb"===n,k=n.replace(/a$/,"");h=k;var l="cmyk"===k?4:"gray"===k?1:3;i=b[2].trim().split(/\s*,\s*/).map(function(a,b){if(/%$/.test(a))return b===l?parseFloat(a)/100:"rgb"===k?255*parseFloat(a)/100:parseFloat(a);if("h"===k[b]){if(/deg$/.test(a))return parseFloat(a);if(void 0!==g[a])return g[a]}return parseFloat(a)}),n===k&&i.push(1),j=o?1:void 0===i[l]?1:i[l],i=i.slice(0,l)}else a.length>10&&/[0-9](?:\s|\/)/.test(a)&&(i=a.match(/([0-9]+)/g).map(function(a){return parseFloat(a)}),h=a.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(a))if(e(a)){var p=f(a.r,a.red,a.R,null);null!==p?(h="rgb",i=[p,f(a.g,a.green,a.G),f(a.b,a.blue,a.B)]):(h="hsl",i=[f(a.h,a.hue,a.H),f(a.s,a.saturation,a.S),f(a.l,a.lightness,a.L,a.b,a.brightness)]),j=f(a.a,a.alpha,a.opacity,1),null!=a.opacity&&(j/=100)}else(Array.isArray(a)||c.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(a))&&(i=[a[0],a[1],a[2]],h="rgb",j=4===a.length?a[3]:1);else h="rgb",i=[a>>>16,(65280&a)>>>8,255&a];return{space:h,values:i,alpha:j}};var g={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"color-name":120,defined:165,"is-plain-obj":423}],123:[function(a,b,c){"use strict";var d=a("color-parse"),e=a("color-space/hsl"),f=a("clamp");b.exports=function(a){var b,c=d(a);return c.space?((b=Array(3))[0]=f(c.values[0],0,255),b[1]=f(c.values[1],0,255),b[2]=f(c.values[2],0,255),"h"===c.space[0]&&(b=e.rgb(b)),b.push(f(c.alpha,0,1)),b):[]}},{clamp:116,"color-parse":122,"color-space/hsl":124}],124:[function(a,b,c){"use strict";var d=a("./rgb");b.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(a){var b,c,d,e,f,g=a[0]/360,h=a[1]/100,i=a[2]/100;if(0===h)return[f=255*i,f,f];b=2*i-(c=i<.5?i*(1+h):i+h-i*h),e=[0,0,0];for(var j=0;j<3;j++)(d=g+1/3*-(j-1))<0?d++:d>1&&d--,f=6*d<1?b+6*(c-b)*d:2*d<1?c:3*d<2?b+(c-b)*(2/3-d)*6:b,e[j]=255*f;return e}},d.hsl=function(a){var b,c,d=a[0]/255,e=a[1]/255,f=a[2]/255,g=Math.min(d,e,f),h=Math.max(d,e,f),i=h-g;return h===g?b=0:d===h?b=(e-f)/i:e===h?b=2+(f-d)/i:f===h&&(b=4+(d-e)/i),(b=Math.min(60*b,360))<0&&(b+=360),c=(g+h)/2,[b,100*(h===g?0:c<=.5?i/(h+g):i/(2-h-g)),100*c]}},{"./rgb":125}],125:[function(a,b,c){"use strict";b.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],126:[function(a,b,c){b.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],127:[function(a,b,c){"use strict";function d(a){return[a[0]/255,a[1]/255,a[2]/255,a[3]]}function e(a){for(var b,c="#",d=0;d<3;++d)c+=("00"+(b=(b=a[d]).toString(16))).substr(b.length);return c}function f(a){return"rgba("+a.join(",")+")"}var g=a("./colorScale"),h=a("lerp");b.exports=function(a){var b,c,i,j,k,l,m,n,o,p;if(a||(a={}),n=(a.nshades||72)-1,m=a.format||"hex",(l=a.colormap)||(l="jet"),"string"==typeof l){if(l=l.toLowerCase(),!g[l])throw Error(l+" not a supported colorscale");k=g[l]}else{if(!Array.isArray(l))throw Error("unsupported colormap option",l);k=l.slice()}if(k.length>n+1)throw new Error(l+" map requires nshades to be at least size "+k.length);o=Array.isArray(a.alpha)?2!==a.alpha.length?[1,1]:a.alpha.slice():"number"==typeof a.alpha?[a.alpha,a.alpha]:[1,1],b=k.map(function(a){return Math.round(a.index*n)}),o[0]=Math.min(Math.max(o[0],0),1),o[1]=Math.min(Math.max(o[1],0),1);var q=k.map(function(a,b){var c=k[b].index,d=k[b].rgb.slice();return 4===d.length&&d[3]>=0&&d[3]<=1?d:(d[3]=o[0]+(o[1]-o[0])*c,d)}),r=[];for(p=0;p<b.length-1;++p){j=b[p+1]-b[p],c=q[p],i=q[p+1];for(var s=0;s<j;s++){var t=s/j;r.push([Math.round(h(c[0],i[0],t)),Math.round(h(c[1],i[1],t)),Math.round(h(c[2],i[2],t)),h(c[3],i[3],t)])}}return r.push(k[k.length-1].rgb.concat(o[1])),"hex"===m?r=r.map(e):"rgbaString"===m?r=r.map(f):"float"===m&&(r=r.map(d)),r}},{"./colorScale":126,lerp:426}],128:[function(a,b,c){"use strict";function d(a,b,c){var d=g(a[0],-b[0]),e=g(a[1],-b[1]),f=g(c[0],-b[0]),j=g(c[1],-b[1]),k=i(h(d,f),h(e,j));return k[k.length-1]>=0}b.exports=function(a,b,c,g){var h=e(b,c,g);if(0===h){var i=f(e(a,b,c)),j=f(e(a,b,g));if(i===j){if(0===i){var k=d(a,b,c);return k===d(a,b,g)?0:k?1:-1}return 0}return 0===j?i>0?-1:d(a,b,g)?-1:1:0===i?j>0?1:d(a,b,c)?1:-1:f(j-i)}var l=e(a,b,c);return l>0?h>0&&e(a,b,g)>0?1:-1:l<0?h>0||e(a,b,g)>0?1:-1:e(a,b,g)>0?1:d(a,b,c)?1:-1};var e=a("robust-orientation"),f=a("signum"),g=a("two-sum"),h=a("robust-product"),i=a("robust-sum")},{"robust-orientation":511,"robust-product":512,"robust-sum":516,signum:517,"two-sum":545}],129:[function(a,b,c){function d(a,b){return a-b}b.exports=function(a,b){var c=a.length,f=a.length-b.length;if(f)return f;switch(c){case 0:return 0;case 1:return a[0]-b[0];case 2:return a[0]+a[1]-b[0]-b[1]||e(a[0],a[1])-e(b[0],b[1]);case 3:var g=a[0]+a[1],h=b[0]+b[1];if(f=g+a[2]-(h+b[2]))return f;var i=e(a[0],a[1]),j=e(b[0],b[1]);return e(i,a[2])-e(j,b[2])||e(i+a[2],g)-e(j+b[2],h);case 4:var k=a[0],l=a[1],m=a[2],n=a[3],o=b[0],p=b[1],q=b[2],r=b[3];return k+l+m+n-(o+p+q+r)||e(k,l,m,n)-e(o,p,q,r,o)||e(k+l,k+m,k+n,l+m,l+n,m+n)-e(o+p,o+q,o+r,p+q,p+r,q+r)||e(k+l+m,k+l+n,k+m+n,l+m+n)-e(o+p+q,o+p+r,o+q+r,p+q+r);default:for(var s=a.slice().sort(d),t=b.slice().sort(d),u=0;u<c;++u)if(f=s[u]-t[u])return f;return 0}};var e=Math.min},{}],130:[function(a,b,c){"use strict";var d=a("compare-cell"),e=a("cell-orientation");b.exports=function(a,b){return d(a,b)||e(a)-e(b)}},{"cell-orientation":113,"compare-cell":129}],131:[function(a,b,c){"use strict";var d=a("./lib/ch1d"),e=a("./lib/ch2d"),f=a("./lib/chnd");b.exports=function(a){var b=a.length;if(0===b)return[];if(1===b)return[[0]];var c=a[0].length;return 0===c?[]:1===c?d(a):2===c?e(a):f(a,c)}},{"./lib/ch1d":132,"./lib/ch2d":133,"./lib/chnd":134}],132:[function(a,b,c){"use strict";b.exports=function(a){for(var b=0,c=0,d=1;d<a.length;++d)a[d][0]<a[b][0]&&(b=d),a[d][0]>a[c][0]&&(c=d);return b<c?[[b],[c]]:b>c?[[c],[b]]:[[b]]}},{}],133:[function(a,b,c){"use strict";b.exports=function(a){var b=d(a),c=b.length;if(c<=2)return[];for(var e=new Array(c),f=b[c-1],g=0;g<c;++g){var h=b[g];e[g]=[f,h],f=h}return e};var d=a("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":435}],134:[function(a,b,c){"use strict";b.exports=function(a,b){try{return d(a,!0)}catch(h){var c=e(a);if(c.length<=b)return[];var f=function(a,b){for(var c=a.length,d=new Array(c),e=0;e<b.length;++e)d[e]=a[b[e]];for(var f=b.length,e=0;e<c;++e)b.indexOf(e)<0&&(d[f++]=a[e]);return d}(a,c),g=d(f,!0);return function(a,b){for(var c=a.length,d=b.length,e=0;e<c;++e)for(var f=a[e],g=0;g<f.length;++g){var h=f[g];if(h<d)f[g]=b[h];else{h-=d;for(var i=0;i<d;++i)h>=b[i]&&(h+=1);f[g]=h}}return a}(g,c)}};var d=a("incremental-convex-hull"),e=a("affine-hull")},{"affine-hull":63,"incremental-convex-hull":414}],135:[function(a,b,c){b.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|)o.?tom(e|)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],136:[function(a,b,c){b.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],137:[function(a,b,c){b.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],138:[function(a,b,c){b.exports=["normal","italic","oblique"]},{}],139:[function(a,b,c){b.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],140:[function(a,b,c){"use strict";b.exports={parse:a("./parse"),stringify:a("./stringify")}},{"./parse":142,"./stringify":143}],141:[function(a,b,c){"use strict";var d=a("css-font-size-keywords");b.exports={isSize:function(a){return/^[\d\.]/.test(a)||-1!==a.indexOf("/")||-1!==d.indexOf(a)}}},{"css-font-size-keywords":136}],142:[function(a,b,c){"use strict";function d(a){if("string"!=typeof a)throw new Error("Font argument must be a string.");if(n[a])return n[a];if(""===a)throw new Error("Cannot parse an empty string.");if(-1!==h.indexOf(a))return n[a]={system:a};for(var b,c={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},d=l(a,/\s+/);b=d.shift();){if(-1!==g.indexOf(b))return["style","variant","weight","stretch"].forEach(function(a){c[a]=b}),n[a]=c;if(-1===j.indexOf(b))if("normal"!==b&&"small-caps"!==b)if(-1===k.indexOf(b)){if(-1===i.indexOf(b)){if(m(b)){var o=l(b,"/");if(c.size=o[0],null!=o[1]?c.lineHeight=e(o[1]):"/"===d[0]&&(d.shift(),c.lineHeight=e(d.shift())),!d.length)throw new Error("Missing required font-family.");return c.family=l(d.join(" "),/\s*,\s*/).map(f),n[a]=c}throw new Error("Unknown or unsupported font token: "+b)}c.weight=b}else c.stretch=b;else c.variant=b;else c.style=b}throw new Error("Missing required font-size.")}function e(a){var b=parseFloat(a);return b.toString()===a?b:a}var f=a("unquote"),g=a("css-global-keywords"),h=a("css-system-font-keywords"),i=a("css-font-weight-keywords"),j=a("css-font-style-keywords"),k=a("css-font-stretch-keywords"),l=a("string-split-by"),m=a("./lib/util").isSize;b.exports=d;var n=d.cache={}},{"./lib/util":141,"css-font-stretch-keywords":137,"css-font-style-keywords":138,"css-font-weight-keywords":139,"css-global-keywords":144,"css-system-font-keywords":145,"string-split-by":530,unquote:549}],143:[function(a,b,c){"use strict";function d(a,b){if(a&&!b[a]&&!h[a])throw Error("Unknown keyword `"+a+"`");return a}function e(a){for(var b={},c=0;c<a.length;c++)b[a[c]]=1;return b}var f=a("pick-by-alias"),g=a("./lib/util").isSize,h=e(a("css-global-keywords")),i=e(a("css-system-font-keywords")),j=e(a("css-font-weight-keywords")),k=e(a("css-font-style-keywords")),l=e(a("css-font-stretch-keywords")),m={normal:1,"small-caps":1},n={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},o="serif";b.exports=function(a){if((a=f(a,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return a.system&&d(a.system,i),a.system;if(d(a.style,k),d(a.variant,m),d(a.weight,j),d(a.stretch,l),null==a.size&&(a.size="1rem"),"number"==typeof a.size&&(a.size+="px"),!g)throw Error("Bad size value `"+a.size+"`");a.family||(a.family=o),Array.isArray(a.family)&&(a.family.length||(a.family=[o]),a.family=a.family.map(function(a){return n[a]?a:'"'+a+'"'}).join(", "));var b=[];return b.push(a.style),a.variant!==a.style&&b.push(a.variant),a.weight!==a.variant&&a.weight!==a.style&&b.push(a.weight),a.stretch!==a.weight&&a.stretch!==a.variant&&a.stretch!==a.style&&b.push(a.stretch),b.push(a.size+(null==a.lineHeight||"normal"===a.lineHeight||a.lineHeight+""=="1"?"":"/"+a.lineHeight)),b.push(a.family),b.filter(Boolean).join(" ")}},{"./lib/util":141,"css-font-stretch-keywords":137,"css-font-style-keywords":138,"css-font-weight-keywords":139,"css-global-keywords":144,"css-system-font-keywords":145,"pick-by-alias":466}],144:[function(a,b,c){b.exports=["inherit","initial","unset"]},{}],145:[function(a,b,c){b.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],146:[function(a,b,c){"use strict";b.exports=function(a,b,c,d,e,f){var g=e-1,h=e*e,i=g*g,j=(1+2*e)*i,k=e*i,l=h*(3-2*e),m=h*g;if(a.length){f||(f=new Array(a.length));for(var n=a.length-1;n>=0;--n)f[n]=j*a[n]+k*b[n]+l*c[n]+m*d[n];return f}return j*a+k*b+l*c+m*d},b.exports.derivative=function(a,b,c,d,e,f){var g=6*e*e-6*e,h=3*e*e-4*e+1,i=-6*e*e+6*e,j=3*e*e-2*e;if(a.length){f||(f=new Array(a.length));for(var k=a.length-1;k>=0;--k)f[k]=g*a[k]+h*b[k]+i*c[k]+j*d[k];return f}return g*a+h*b+i*c[k]+j*d}},{}],147:[function(a,b,c){"use strict";function d(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}var e=a("./lib/thunk.js");b.exports=function(a){var b=new d;b.pre=a.pre,b.body=a.body,b.post=a.post;var c=a.args.slice(0);b.argTypes=c;for(var f=0;f<c.length;++f){var g=c[f];if("array"===g||"object"==typeof g&&g.blockIndices){if(b.argTypes[f]="array",b.arrayArgs.push(f),b.arrayBlockIndices.push(g.blockIndices?g.blockIndices:0),b.shimArgs.push("array"+f),f<b.pre.args.length&&b.pre.args[f].count>0)throw new Error("cwise: pre() block may not reference array args");if(f<b.post.args.length&&b.post.args[f].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===g)b.scalarArgs.push(f),b.shimArgs.push("scalar"+f);else if("index"===g){if(b.indexArgs.push(f),f<b.pre.args.length&&b.pre.args[f].count>0)throw new Error("cwise: pre() block may not reference array index");if(f<b.body.args.length&&b.body.args[f].lvalue)throw new Error("cwise: body() block may not write to array index");if(f<b.post.args.length&&b.post.args[f].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===g){if(b.shapeArgs.push(f),f<b.pre.args.length&&b.pre.args[f].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(f<b.body.args.length&&b.body.args[f].lvalue)throw new Error("cwise: body() block may not write to array shape");if(f<b.post.args.length&&b.post.args[f].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{
if("object"!=typeof g||!g.offset)throw new Error("cwise: Unknown argument type "+c[f]);b.argTypes[f]="offset",b.offsetArgs.push({array:g.array,offset:g.offset}),b.offsetArgIndex.push(f)}}if(b.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(b.pre.args.length>c.length)throw new Error("cwise: Too many arguments in pre() block");if(b.body.args.length>c.length)throw new Error("cwise: Too many arguments in body() block");if(b.post.args.length>c.length)throw new Error("cwise: Too many arguments in post() block");return b.debug=!!a.printCode||!!a.debug,b.funcName=a.funcName||"cwise",b.blockSize=a.blockSize||64,e(b)}},{"./lib/thunk.js":149}],148:[function(a,b,c){"use strict";function d(a,b,c){var d,e,f=a.length,g=b.arrayArgs.length,h=b.indexArgs.length>0,i=[],j=[],k=0,l=0;for(d=0;d<f;++d)j.push(["i",d,"=0"].join(""));for(e=0;e<g;++e)for(d=0;d<f;++d)l=k,k=a[d],0===d?j.push(["d",e,"s",d,"=t",e,"p",k].join("")):j.push(["d",e,"s",d,"=(t",e,"p",k,"-s",l,"*t",e,"p",l,")"].join(""));for(j.length>0&&i.push("var "+j.join(",")),d=f-1;d>=0;--d)k=a[d],i.push(["for(i",d,"=0;i",d,"<s",k,";++i",d,"){"].join(""));for(i.push(c),d=0;d<f;++d){for(l=k,k=a[d],e=0;e<g;++e)i.push(["p",e,"+=d",e,"s",d].join(""));h&&(d>0&&i.push(["index[",l,"]-=s",l].join("")),i.push(["++index[",k,"]"].join(""))),i.push("}")}return i.join("\n")}function e(a,b,c){for(var d=a.body,e=[],f=[],g=0;g<a.args.length;++g){var h=a.args[g];if(!(h.count<=0)){var i=new RegExp(h.name,"g"),j="",k=b.arrayArgs.indexOf(g);switch(b.argTypes[g]){case"offset":var l=b.offsetArgIndex.indexOf(g);k=b.offsetArgs[l].array,j="+q"+l;case"array":j="p"+k+j;var m="l"+g,n="a"+k;if(0===b.arrayBlockIndices[k])1===h.count?"generic"===c[k]?h.lvalue?(e.push(["var ",m,"=",n,".get(",j,")"].join("")),d=d.replace(i,m),f.push([n,".set(",j,",",m,")"].join(""))):d=d.replace(i,[n,".get(",j,")"].join("")):d=d.replace(i,[n,"[",j,"]"].join("")):"generic"===c[k]?(e.push(["var ",m,"=",n,".get(",j,")"].join("")),d=d.replace(i,m),h.lvalue&&f.push([n,".set(",j,",",m,")"].join(""))):(e.push(["var ",m,"=",n,"[",j,"]"].join("")),d=d.replace(i,m),h.lvalue&&f.push([n,"[",j,"]=",m].join("")));else{for(var o=[h.name],p=[j],q=0;q<Math.abs(b.arrayBlockIndices[k]);q++)o.push("\\s*\\[([^\\]]+)\\]"),p.push("$"+(q+1)+"*t"+k+"b"+q);if(i=new RegExp(o.join(""),"g"),j=p.join("+"),"generic"===c[k])throw new Error("cwise: Generic arrays not supported in combination with blocks!");d=d.replace(i,[n,"[",j,"]"].join(""))}break;case"scalar":d=d.replace(i,"Y"+b.scalarArgs.indexOf(g));break;case"index":d=d.replace(i,"index");break;case"shape":d=d.replace(i,"shape")}}}return[e.join("\n"),d,f.join("\n")].join("\n").trim()}var f=a("uniq");b.exports=function(a,b){for(var c=b[1].length-Math.abs(a.arrayBlockIndices[0])|0,g=new Array(a.arrayArgs.length),h=new Array(a.arrayArgs.length),i=0;i<a.arrayArgs.length;++i)h[i]=b[2*i],g[i]=b[2*i+1];var j=[],k=[],l=[],m=[],n=[];for(i=0;i<a.arrayArgs.length;++i){a.arrayBlockIndices[i]<0?(l.push(0),m.push(c),j.push(c),k.push(c+a.arrayBlockIndices[i])):(l.push(a.arrayBlockIndices[i]),m.push(a.arrayBlockIndices[i]+c),j.push(0),k.push(a.arrayBlockIndices[i]));for(var o=[],p=0;p<g[i].length;p++)l[i]<=g[i][p]&&g[i][p]<m[i]&&o.push(g[i][p]-l[i]);n.push(o)}var q=["SS"],r=["'use strict'"],s=[];for(p=0;p<c;++p)s.push(["s",p,"=SS[",p,"]"].join(""));for(i=0;i<a.arrayArgs.length;++i){for(q.push("a"+i),q.push("t"+i),q.push("p"+i),p=0;p<c;++p)s.push(["t",i,"p",p,"=t",i,"[",l[i]+p,"]"].join(""));for(p=0;p<Math.abs(a.arrayBlockIndices[i]);++p)s.push(["t",i,"b",p,"=t",i,"[",j[i]+p,"]"].join(""))}for(i=0;i<a.scalarArgs.length;++i)q.push("Y"+i);if(a.shapeArgs.length>0&&s.push("shape=SS.slice(0)"),a.indexArgs.length>0){var t=new Array(c);for(i=0;i<c;++i)t[i]="0";s.push(["index=[",t.join(","),"]"].join(""))}for(i=0;i<a.offsetArgs.length;++i){var u=a.offsetArgs[i],v=[];for(p=0;p<u.offset.length;++p)0!==u.offset[p]&&(1===u.offset[p]?v.push(["t",u.array,"p",p].join("")):v.push([u.offset[p],"*t",u.array,"p",p].join("")));0===v.length?s.push("q"+i+"=0"):s.push(["q",i,"=",v.join("+")].join(""))}var w=f([].concat(a.pre.thisVars).concat(a.body.thisVars).concat(a.post.thisVars));for((s=s.concat(w)).length>0&&r.push("var "+s.join(",")),i=0;i<a.arrayArgs.length;++i)r.push("p"+i+"|=0");a.pre.body.length>3&&r.push(e(a.pre,a,h));var x=e(a.body,a,h),y=function(a){for(var b=0,c=a[0].length;b<c;){for(var d=1;d<a.length;++d)if(a[d][b]!==a[0][b])return b;++b}return b}(n);y<c?r.push(function(a,b,c,e){for(var f=b.length,g=c.arrayArgs.length,h=c.blockSize,i=c.indexArgs.length>0,j=[],k=0;k<g;++k)j.push(["var offset",k,"=p",k].join(""));for(k=a;k<f;++k)j.push(["for(var j"+k+"=SS[",b[k],"]|0;j",k,">0;){"].join("")),j.push(["if(j",k,"<",h,"){"].join("")),j.push(["s",b[k],"=j",k].join("")),j.push(["j",k,"=0"].join("")),j.push(["}else{s",b[k],"=",h].join("")),j.push(["j",k,"-=",h,"}"].join("")),i&&j.push(["index[",b[k],"]=j",k].join(""));for(k=0;k<g;++k){for(var l=["offset"+k],m=a;m<f;++m)l.push(["j",m,"*t",k,"p",b[m]].join(""));j.push(["p",k,"=(",l.join("+"),")"].join(""))}for(j.push(d(b,c,e)),k=a;k<f;++k)j.push("}");return j.join("\n")}(y,n[0],a,x)):r.push(d(n[0],a,x)),a.post.body.length>3&&r.push(e(a.post,a,h)),a.debug&&console.log("-----Generated cwise routine for ",b,":\n"+r.join("\n")+"\n----------");var z=[a.funcName||"unnamed","_cwise_loop_",g[0].join("s"),"m",y,function(a){for(var b=new Array(a.length),c=!0,d=0;d<a.length;++d){var e=a[d],f=e.match(/\d+/);f=f?f[0]:"",0===e.charAt(0)?b[d]="u"+e.charAt(1)+f:b[d]=e.charAt(0)+f,d>0&&(c=c&&b[d]===b[d-1])}return c?b[0]:b.join("")}(h)].join("");return new Function(["function ",z,"(",q.join(","),"){",r.join("\n"),"} return ",z].join(""))()}},{uniq:548}],149:[function(a,b,c){"use strict";var d=a("./compile.js");b.exports=function(a){var b=["'use strict'","var CACHED={}"],c=[],e=a.funcName+"_cwise_thunk";b.push(["return function ",e,"(",a.shimArgs.join(","),"){"].join(""));for(var f=[],g=[],h=[["array",a.arrayArgs[0],".shape.slice(",Math.max(0,a.arrayBlockIndices[0]),a.arrayBlockIndices[0]<0?","+a.arrayBlockIndices[0]+")":")"].join("")],i=[],j=[],k=0;k<a.arrayArgs.length;++k){var l=a.arrayArgs[k];c.push(["t",l,"=array",l,".dtype,","r",l,"=array",l,".order"].join("")),f.push("t"+l),f.push("r"+l),g.push("t"+l),g.push("r"+l+".join()"),h.push("array"+l+".data"),h.push("array"+l+".stride"),h.push("array"+l+".offset|0"),k>0&&(i.push("array"+a.arrayArgs[0]+".shape.length===array"+l+".shape.length+"+(Math.abs(a.arrayBlockIndices[0])-Math.abs(a.arrayBlockIndices[k]))),j.push("array"+a.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,a.arrayBlockIndices[0])+"]===array"+l+".shape[shapeIndex+"+Math.max(0,a.arrayBlockIndices[k])+"]"))}for(a.arrayArgs.length>1&&(b.push("if (!("+i.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),b.push("for(var shapeIndex=array"+a.arrayArgs[0]+".shape.length-"+Math.abs(a.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),b.push("if (!("+j.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),b.push("}")),k=0;k<a.scalarArgs.length;++k)h.push("scalar"+a.scalarArgs[k]);return c.push(["type=[",g.join(","),"].join()"].join("")),c.push("proc=CACHED[type]"),b.push("var "+c.join(",")),b.push(["if(!proc){","CACHED[type]=proc=compile([",f.join(","),"])}","return proc(",h.join(","),")}"].join("")),a.debug&&console.log("-----Generated thunk:\n"+b.join("\n")+"\n----------"),new Function("compile",b.join("\n"))(d.bind(void 0,a))}},{"./compile.js":148}],150:[function(a,b,c){b.exports=a("cwise-compiler")},{"cwise-compiler":147}],151:[function(a,b,c){"use strict";var d,e=a("es5-ext/object/copy"),f=a("es5-ext/object/normalize-options"),g=a("es5-ext/object/valid-callable"),h=a("es5-ext/object/map"),i=a("es5-ext/object/valid-callable"),j=a("es5-ext/object/valid-value"),k=Function.prototype.bind,l=Object.defineProperty,m=Object.prototype.hasOwnProperty;d=function(a,b,c){var d,f=j(b)&&i(b.value);return delete(d=e(b)).writable,delete d.value,d.get=function(){return!c.overwriteDefinition&&m.call(this,a)?f:(b.value=k.call(f,c.resolveContext?c.resolveContext(this):this),l(this,a,b),this[a])},d},b.exports=function(a){var b=f(arguments[1]);return null!=b.resolveContext&&g(b.resolveContext),h(a,function(a,c){return d(c,a,b)})}},{"es5-ext/object/copy":190,"es5-ext/object/map":199,"es5-ext/object/normalize-options":200,"es5-ext/object/valid-callable":204,"es5-ext/object/valid-value":206}],152:[function(a,b,c){"use strict";var d=a("es5-ext/object/assign"),e=a("es5-ext/object/normalize-options"),f=a("es5-ext/object/is-callable"),g=a("es5-ext/string/#/contains");(b.exports=function(a,b){var c,f,h,i,j;return arguments.length<2||"string"!=typeof a?(i=b,b=a,a=null):i=arguments[2],null==a?(c=h=!0,f=!1):(c=g.call(a,"c"),f=g.call(a,"e"),h=g.call(a,"w")),j={value:b,configurable:c,enumerable:f,writable:h},i?d(e(i),j):j}).gs=function(a,b,c){var h,i,j,k;return"string"!=typeof a?(j=c,c=b,b=a,a=null):j=arguments[3],null==b?b=void 0:f(b)?null==c?c=void 0:f(c)||(j=c,c=void 0):(j=b,b=c=void 0),null==a?(h=!0,i=!1):(h=g.call(a,"c"),i=g.call(a,"e")),k={get:b,set:c,configurable:h,enumerable:i},j?d(e(j),k):k}},{"es5-ext/object/assign":187,"es5-ext/object/is-callable":193,"es5-ext/object/normalize-options":200,"es5-ext/string/#/contains":207}],153:[function(a,b,c){var d;d=this,function(a){"use strict";function b(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function c(a){var c;return 1===a.length&&(c=a,a=function(a,d){return b(c(a),d)}),{left:function(b,c,d,e){for(null==d&&(d=0),null==e&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(null==d&&(d=0),null==e&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}function d(a,b){return[a,b]}function e(a){return null===a?NaN:+a}function f(a,b){var c,d,f=a.length,g=0,h=-1,i=0,j=0;if(null==b)for(;++h<f;)isNaN(c=e(a[h]))||(j+=(d=c-i)*(c-(i+=d/++g)));else for(;++h<f;)isNaN(c=e(b(a[h],h,a)))||(j+=(d=c-i)*(c-(i+=d/++g)));if(g>1)return j/(g-1)}function g(a,b){var c=f(a,b);return c?Math.sqrt(c):c}function h(a,b){var c,d,e,f=a.length,g=-1;if(null==b){for(;++g<f;)if(null!=(c=a[g])&&c>=c)for(d=e=c;++g<f;)null!=(c=a[g])&&(d>c&&(d=c),e<c&&(e=c))}else for(;++g<f;)if(null!=(c=b(a[g],g,a))&&c>=c)for(d=e=c;++g<f;)null!=(c=b(a[g],g,a))&&(d>c&&(d=c),e<c&&(e=c));return[d,e]}function i(a){return function(){return a}}function j(a){return a}function k(a,b,c){a=+a,b=+b,c=(e=arguments.length)<2?(b=a,a=0,1):e<3?1:+c;for(var d=-1,e=0|Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a+d*c;return f}function l(a,b,c){var d=(b-a)/Math.max(0,c),e=Math.floor(Math.log(d)/Math.LN10),f=d/Math.pow(10,e);return e>=0?(f>=y?10:f>=z?5:f>=A?2:1)*Math.pow(10,e):-Math.pow(10,-e)/(f>=y?10:f>=z?5:f>=A?2:1)}function m(a,b,c){var d=Math.abs(b-a)/Math.max(0,c),e=Math.pow(10,Math.floor(Math.log(d)/Math.LN10)),f=d/e;return f>=y?e*=10:f>=z?e*=5:f>=A&&(e*=2),b<a?-e:e}function n(a){return Math.ceil(Math.log(a.length)/Math.LN2)+1}function o(a,b,c){if(null==c&&(c=e),d=a.length){if((b=+b)<=0||d<2)return+c(a[0],0,a);if(b>=1)return+c(a[d-1],d-1,a);var d,f=(d-1)*b,g=Math.floor(f),h=+c(a[g],g,a);return h+(+c(a[g+1],g+1,a)-h)*(f-g)}}function p(a,b){var c,d,e=a.length,f=-1;if(null==b){for(;++f<e;)if(null!=(c=a[f])&&c>=c)for(d=c;++f<e;)null!=(c=a[f])&&d>c&&(d=c)}else for(;++f<e;)if(null!=(c=b(a[f],f,a))&&c>=c)for(d=c;++f<e;)null!=(c=b(a[f],f,a))&&d>c&&(d=c);return d}function q(a){if(!(e=a.length))return[];for(var b=-1,c=p(a,r),d=new Array(c);++b<c;)for(var e,f=-1,g=d[b]=new Array(e);++f<e;)g[f]=a[f][b];return d}function r(a){return a.length}var s=c(b),t=s.right,u=s.left,v=Array.prototype,w=v.slice,x=v.map,y=Math.sqrt(50),z=Math.sqrt(10),A=Math.sqrt(2);a.bisect=t,a.bisectRight=t,a.bisectLeft=u,a.ascending=b,a.bisector=c,a.cross=function(a,b,c){var e,f,g,h,i=a.length,j=b.length,k=new Array(i*j);for(null==c&&(c=d),e=g=0;e<i;++e)for(h=a[e],f=0;f<j;++f,++g)k[g]=c(h,b[f]);return k},a.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},a.deviation=g,a.extent=h,a.histogram=function(){function a(a){var e,f,g=a.length,h=new Array(g);for(e=0;e<g;++e)h[e]=b(a[e],e,a);var i=c(h),j=i[0],l=i[1],n=d(h,j,l);Array.isArray(n)||(n=m(j,l,n),n=k(Math.ceil(j/n)*n,l,n));for(var o=n.length;n[0]<=j;)n.shift(),--o;for(;n[o-1]>l;)n.pop(),--o;var p,q=new Array(o+1);for(e=0;e<=o;++e)(p=q[e]=[]).x0=e>0?n[e-1]:j,p.x1=e<o?n[e]:l;for(e=0;e<g;++e)j<=(f=h[e])&&f<=l&&q[t(n,f,0,o)].push(a[e]);return q}var b=j,c=h,d=n;return a.value=function(c){return arguments.length?(b="function"==typeof c?c:i(c),a):b},a.domain=function(b){return arguments.length?(c="function"==typeof b?b:i([b[0],b[1]]),a):c},a.thresholds=function(b){return arguments.length?(d="function"==typeof b?b:i(Array.isArray(b)?w.call(b):b),a):d},a},a.thresholdFreedmanDiaconis=function(a,c,d){return a=x.call(a,e).sort(b),Math.ceil((d-c)/(2*(o(a,.75)-o(a,.25))*Math.pow(a.length,-1/3)))},a.thresholdScott=function(a,b,c){return Math.ceil((c-b)/(3.5*g(a)*Math.pow(a.length,-1/3)))},a.thresholdSturges=n,a.max=function(a,b){var c,d,e=a.length,f=-1;if(null==b){for(;++f<e;)if(null!=(c=a[f])&&c>=c)for(d=c;++f<e;)null!=(c=a[f])&&c>d&&(d=c)}else for(;++f<e;)if(null!=(c=b(a[f],f,a))&&c>=c)for(d=c;++f<e;)null!=(c=b(a[f],f,a))&&c>d&&(d=c);return d},a.mean=function(a,b){var c,d=a.length,f=d,g=-1,h=0;if(null==b)for(;++g<d;)isNaN(c=e(a[g]))?--f:h+=c;else for(;++g<d;)isNaN(c=e(b(a[g],g,a)))?--f:h+=c;if(f)return h/f},a.median=function(a,c){var d,f=a.length,g=-1,h=[];if(null==c)for(;++g<f;)isNaN(d=e(a[g]))||h.push(d);else for(;++g<f;)isNaN(d=e(c(a[g],g,a)))||h.push(d);return o(h.sort(b),.5)},a.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(b=(d=a[e]).length;--b>=0;)c[--g]=d[b];return c},a.min=p,a.pairs=function(a,b){null==b&&(b=d);for(var c=0,e=a.length-1,f=a[0],g=new Array(e<0?0:e);c<e;)g[c]=b(f,f=a[++c]);return g},a.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},a.quantile=o,a.range=k,a.scan=function(a,c){if(d=a.length){var d,e,f=0,g=0,h=a[g];for(null==c&&(c=b);++f<d;)(c(e=a[f],h)<0||0!==c(h,h))&&(h=e,g=f);return 0===c(h,h)?g:void 0}},a.shuffle=function(a,b,c){for(var d,e,f=(null==c?a.length:c)-(b=null==b?0:+b);f;)e=Math.random()*f--|0,d=a[f+b],a[f+b]=a[e+b],a[e+b]=d;return a},a.sum=function(a,b){var c,d=a.length,e=-1,f=0;if(null==b)for(;++e<d;)(c=+a[e])&&(f+=c);else for(;++e<d;)(c=+b(a[e],e,a))&&(f+=c);return f},a.ticks=function(a,b,c){var d,e,f,g,h=-1;if(c=+c,(a=+a)==(b=+b)&&c>0)return[a];if((d=b<a)&&(e=a,a=b,b=e),0===(g=l(a,b,c))||!isFinite(g))return[];if(g>0)for(a=Math.ceil(a/g),b=Math.floor(b/g),f=new Array(e=Math.ceil(b-a+1));++h<e;)f[h]=(a+h)*g;else for(a=Math.floor(a*g),b=Math.ceil(b*g),f=new Array(e=Math.ceil(a-b+1));++h<e;)f[h]=(a-h)/g;return d&&f.reverse(),f},a.tickIncrement=l,a.tickStep=m,a.transpose=q,a.variance=f,a.zip=function(){return q(arguments)},Object.defineProperty(a,"__esModule",{value:!0})}("object"==typeof c&&void 0!==b?c:d.d3=d.d3||{})},{}],154:[function(a,b,c){var d;d=this,function(a){"use strict";function b(){}function c(a,c){var d=new b;if(a instanceof b)a.each(function(a,b){d.set(b,a)});else if(Array.isArray(a)){var e,f=-1,g=a.length;if(null==c)for(;++f<g;)d.set(f,a[f]);else for(;++f<g;)d.set(c(e=a[f],f,a),e)}else if(a)for(var h in a)d.set(h,a[h]);return d}function d(){return{}}function e(a,b,c){a[b]=c}function f(){return c()}function g(a,b,c){a.set(b,c)}function h(){}function i(a,b){var c=new h;if(a instanceof h)a.each(function(a){c.add(a)});else if(a){var d=-1,e=a.length;if(null==b)for(;++d<e;)c.add(a[d]);else for(;++d<e;)c.add(b(a[d],d,a))}return c}b.prototype=c.prototype={constructor:b,has:function(a){return"$"+a in this},get:function(a){return this["$"+a]},set:function(a,b){return this["$"+a]=b,this},remove:function(a){var b="$"+a;return b in this&&delete this[b]},clear:function(){for(var a in this)"$"===a[0]&&delete this[a]},keys:function(){var a=[];for(var b in this)"$"===b[0]&&a.push(b.slice(1));return a},values:function(){var a=[];for(var b in this)"$"===b[0]&&a.push(this[b]);return a},entries:function(){var a=[];for(var b in this)"$"===b[0]&&a.push({key:b.slice(1),value:this[b]});return a},size:function(){var a=0;for(var b in this)"$"===b[0]&&++a;return a},empty:function(){for(var a in this)if("$"===a[0])return!1;return!0},each:function(a){for(var b in this)"$"===b[0]&&a(this[b],b.slice(1),this)}};var j=c.prototype;h.prototype=i.prototype={constructor:h,has:j.has,add:function(a){return this["$"+(a+="")]=a,this},remove:j.remove,clear:j.clear,values:j.keys,size:j.size,empty:j.empty,each:j.each},a.nest=function(){function a(d,e,f,g){if(e>=j.length)return null!=b&&d.sort(b),null!=h?h(d):d;for(var i,k,l,m=-1,n=d.length,o=j[e++],p=c(),q=f();++m<n;)(l=p.get(i=o(k=d[m])+""))?l.push(k):p.set(i,[k]);return p.each(function(b,c){g(q,c,a(b,e,f,g))}),q}var b,h,i,j=[],k=[];return i={object:function(b){return a(b,0,d,e)},map:function(b){return a(b,0,f,g)},entries:function(b){return function a(b,c){if(++c>j.length)return b;var d,e=k[c-1];return null!=h&&c>=j.length?d=b.entries():(d=[],b.each(function(b,e){d.push({key:e,values:a(b,c)})})),null!=e?d.sort(function(a,b){return e(a.key,b.key)}):d}(a(b,0,f,g),0)},key:function(a){return j.push(a),i},sortKeys:function(a){return k[j.length-1]=a,i},sortValues:function(a){return b=a,i},rollup:function(a){return h=a,i}}},a.set=i,a.map=c,a.keys=function(a){var b=[];for(var c in a)b.push(c);return b},a.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},a.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},Object.defineProperty(a,"__esModule",{value:!0})}("object"==typeof c&&void 0!==b?c:d.d3=d.d3||{})},{}],155:[function(a,b,c){var d;d=this,function(a){"use strict";function b(a,b,c){a.prototype=b.prototype=c,c.constructor=a}function c(a,b){var c=Object.create(a.prototype);for(var d in b)c[d]=b[d];return c}function d(){}function e(a){var b;return a=(a+"").trim().toLowerCase(),(b=E.exec(a))?new j((b=parseInt(b[1],16))>>8&15|b>>4&240,b>>4&15|240&b,(15&b)<<4|15&b,1):(b=F.exec(a))?f(parseInt(b[1],16)):(b=G.exec(a))?new j(b[1],b[2],b[3],1):(b=H.exec(a))?new j(255*b[1]/100,255*b[2]/100,255*b[3]/100,1):(b=I.exec(a))?g(b[1],b[2],b[3],b[4]):(b=J.exec(a))?g(255*b[1]/100,255*b[2]/100,255*b[3]/100,b[4]):(b=K.exec(a))?l(b[1],b[2]/100,b[3]/100,1):(b=L.exec(a))?l(b[1],b[2]/100,b[3]/100,b[4]):M.hasOwnProperty(a)?f(M[a]):"transparent"===a?new j(NaN,NaN,NaN,0):null}function f(a){return new j(a>>16&255,a>>8&255,255&a,1)}function g(a,b,c,d){return d<=0&&(a=b=c=NaN),new j(a,b,c,d)}function h(a){return a instanceof d||(a=e(a)),a?new j((a=a.rgb()).r,a.g,a.b,a.opacity):new j}function i(a,b,c,d){return 1===arguments.length?h(a):new j(a,b,c,null==d?1:d)}function j(a,b,c,d){this.r=+a,this.g=+b,this.b=+c,this.opacity=+d}function k(a){return((a=Math.max(0,Math.min(255,Math.round(a)||0)))<16?"0":"")+a.toString(16)}function l(a,b,c,d){return d<=0?a=b=c=NaN:c<=0||c>=1?a=b=NaN:b<=0&&(a=NaN),new n(a,b,c,d)}function m(a,b,c,f){return 1===arguments.length?function(a){if(a instanceof n)return new n(a.h,a.s,a.l,a.opacity);if(a instanceof d||(a=e(a)),!a)return new n;if(a instanceof n)return a;var b=(a=a.rgb()).r/255,c=a.g/255,f=a.b/255,g=Math.min(b,c,f),h=Math.max(b,c,f),i=NaN,j=h-g,k=(h+g)/2;return j?(i=b===h?(c-f)/j+6*(c<f):c===h?(f-b)/j+2:(b-c)/j+4,j/=k<.5?h+g:2-h-g,i*=60):j=k>0&&k<1?0:i,new n(i,j,k,a.opacity)}(a):new n(a,b,c,null==f?1:f)}function n(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}function o(a,b,c){return 255*(a<60?b+(c-b)*a/60:a<180?c:a<240?b+(c-b)*(240-a)/60:b)}function p(a){if(a instanceof r)return new r(a.l,a.a,a.b,a.opacity);if(a instanceof y){if(isNaN(a.h))return new r(a.l,0,0,a.opacity);var b=a.h*N;return new r(a.l,Math.cos(b)*a.c,Math.sin(b)*a.c,a.opacity)}a instanceof j||(a=h(a));var c,d,e=v(a.r),f=v(a.g),g=v(a.b),i=s((.2225045*e+.7168786*f+.0606169*g)/Q);return e===f&&f===g?c=d=i:(c=s((.4360747*e+.3850649*f+.1430804*g)/P),d=s((.0139322*e+.0971045*f+.7141733*g)/R)),new r(116*i-16,500*(c-i),200*(i-d),a.opacity)}function q(a,b,c,d){return 1===arguments.length?p(a):new r(a,b,c,null==d?1:d)}function r(a,b,c,d){this.l=+a,this.a=+b,this.b=+c,this.opacity=+d}function s(a){return a>V?Math.pow(a,1/3):a/U+S}function t(a){return a>T?a*a*a:U*(a-S)}function u(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function v(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function w(a){if(a instanceof y)return new y(a.h,a.c,a.l,a.opacity);if(a instanceof r||(a=p(a)),0===a.a&&0===a.b)return new y(NaN,0,a.l,a.opacity);var b=Math.atan2(a.b,a.a)*O;return new y(b<0?b+360:b,Math.sqrt(a.a*a.a+a.b*a.b),a.l,a.opacity)}function x(a,b,c,d){return 1===arguments.length?w(a):new y(a,b,c,null==d?1:d)}function y(a,b,c,d){this.h=+a,this.c=+b,this.l=+c,this.opacity=+d}function z(a,b,c,d){return 1===arguments.length?function(a){if(a instanceof A)return new A(a.h,a.s,a.l,a.opacity);a instanceof j||(a=h(a));var b=a.r/255,c=a.g/255,d=a.b/255,e=(ba*d+_*b-aa*c)/(ba+_-aa),f=d-e,g=($*(c-e)-Y*f)/Z,i=Math.sqrt(g*g+f*f)/($*e*(1-e)),k=i?Math.atan2(g,f)*O-120:NaN;return new A(k<0?k+360:k,i,e,a.opacity)}(a):new A(a,b,c,null==d?1:d)}function A(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}var B="\\s*([+-]?\\d+)\\s*",C="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",D="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",E=/^#([0-9a-f]{3})$/,F=/^#([0-9a-f]{6})$/,G=new RegExp("^rgb\\("+[B,B,B]+"\\)$"),H=new RegExp("^rgb\\("+[D,D,D]+"\\)$"),I=new RegExp("^rgba\\("+[B,B,B,C]+"\\)$"),J=new RegExp("^rgba\\("+[D,D,D,C]+"\\)$"),K=new RegExp("^hsl\\("+[C,D,D]+"\\)$"),L=new RegExp("^hsla\\("+[C,D,D,C]+"\\)$"),M={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};b(d,e,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),b(j,i,c(d,{brighter:function(a){return a=null==a?1/.7:Math.pow(1/.7,a),new j(this.r*a,this.g*a,this.b*a,this.opacity)},darker:function(a){return a=null==a?.7:Math.pow(.7,a),new j(this.r*a,this.g*a,this.b*a,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+k(this.r)+k(this.g)+k(this.b)},toString:function(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}})),b(n,m,c(d,{brighter:function(a){return a=null==a?1/.7:Math.pow(1/.7,a),new n(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?.7:Math.pow(.7,a),new n(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=this.h%360+360*(this.h<0),b=isNaN(a)||isNaN(this.s)?0:this.s,c=this.l,d=c+(c<.5?c:1-c)*b,e=2*c-d;return new j(o(a>=240?a-240:a+120,e,d),o(a,e,d),o(a<120?a+240:a-120,e,d),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var N=Math.PI/180,O=180/Math.PI,P=.96422,Q=1,R=.82521,S=4/29,T=6/29,U=3*T*T,V=T*T*T;b(r,q,c(d,{brighter:function(a){return new r(this.l+18*(null==a?1:a),this.a,this.b,this.opacity)},darker:function(a){return new r(this.l-18*(null==a?1:a),this.a,this.b,this.opacity)},rgb:function(){var a=(this.l+16)/116,b=isNaN(this.a)?a:a+this.a/500,c=isNaN(this.b)?a:a-this.b/200;return new j(u(3.1338561*(b=P*t(b))-1.6168667*(a=Q*t(a))-.4906146*(c=R*t(c))),u(-.9787684*b+1.9161415*a+.033454*c),u(.0719453*b-.2289914*a+1.4052427*c),this.opacity)}})),b(y,x,c(d,{brighter:function(a){return new y(this.h,this.c,this.l+18*(null==a?1:a),this.opacity)},darker:function(a){return new y(this.h,this.c,this.l-18*(null==a?1:a),this.opacity)},rgb:function(){return p(this).rgb()}}));var W=-.14861,X=1.78277,Y=-.29227,Z=-.90649,$=1.97294,_=$*Z,aa=$*X,ba=X*Y-Z*W;b(A,z,c(d,{brighter:function(a){return a=null==a?1/.7:Math.pow(1/.7,a),new A(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?.7:Math.pow(.7,a),new A(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=isNaN(this.h)?0:(this.h+120)*N,b=+this.l,c=isNaN(this.s)?0:this.s*b*(1-b),d=Math.cos(a),e=Math.sin(a);return new j(255*(b+c*(W*d+X*e)),255*(b+c*(Y*d+Z*e)),255*(b+c*($*d)),this.opacity)}})),a.color=e,a.rgb=i,a.hsl=m,a.lab=q,a.hcl=x,a.lch=function(a,b,c,d){return 1===arguments.length?w(a):new y(c,b,a,null==d?1:d)},a.gray=function(a,b){return new r(a,0,0,null==b?1:b)},a.cubehelix=z,Object.defineProperty(a,"__esModule",{value:!0})}("object"==typeof c&&void 0!==b?c:d.d3=d.d3||{})},{}],156:[function(a,b,c){var d;d=this,function(a){"use strict";function b(){for(var a,b=0,d=arguments.length,e={};b<d;++b){if(!(a=arguments[b]+"")||a in e)throw new Error("illegal type: "+a);e[a]=[]}return new c(e)}function c(a){this._=a}function d(a,b){for(var c,d=0,e=a.length;d<e;++d)if((c=a[d]).name===b)return c.value}function e(a,b,c){for(var d=0,e=a.length;d<e;++d)if(a[d].name===b){a[d]=f,a=a.slice(0,d).concat(a.slice(d+1));break}return null!=c&&a.push({name:b,value:c}),a}var f={value:function(){}};c.prototype=b.prototype={constructor:c,on:function(a,b){var c,f,g=this._,h=(f=g,(a+"").trim().split(/^|\s+/).map(function(a){var b="",c=a.indexOf(".");if(c>=0&&(b=a.slice(c+1),a=a.slice(0,c)),a&&!f.hasOwnProperty(a))throw new Error("unknown type: "+a);return{type:a,name:b}})),i=-1,j=h.length;if(!(arguments.length<2)){if(null!=b&&"function"!=typeof b)throw new Error("invalid callback: "+b);for(;++i<j;)if(c=(a=h[i]).type)g[c]=e(g[c],a.name,b);else if(null==b)for(c in g)g[c]=e(g[c],a.name,null);return this}for(;++i<j;)if((c=(a=h[i]).type)&&(c=d(g[c],a.name)))return c},copy:function(){var a={},b=this._;for(var d in b)a[d]=b[d].slice();return new c(a)},call:function(a,b){if((c=arguments.length-2)>0)for(var c,d,e=new Array(c),f=0;f<c;++f)e[f]=arguments[f+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(f=0,c=(d=this._[a]).length;f<c;++f)d[f].value.apply(b,e)},apply:function(a,b,c){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var d=this._[a],e=0,f=d.length;e<f;++e)d[e].value.apply(b,c)}},a.dispatch=b,Object.defineProperty(a,"__esModule",{value:!0})}("object"==typeof c&&void 0!==b?c:d.d3=d.d3||{})},{}],157:[function(a,b,c){var d,e;d=this,e=function(a,b,c,d,e){"use strict";function f(a){return a.x+a.vx}function g(a){return a.y+a.vy}function h(a){return a.index}function i(a,b){var c=a.get(b);if(!c)throw new Error("missing: "+b);return c}function j(a){return a.x}function k(a){return a.y}var l=function(a){return function(){return a}},m=function(){return 1e-6*(Math.random()-.5)},n=Math.PI*(3-Math.sqrt(5));a.forceCenter=function(a,b){function c(){var c,e,f=d.length,g=0,h=0;for(c=0;c<f;++c)g+=(e=d[c]).x,h+=e.y;for(g=g/f-a,h=h/f-b,c=0;c<f;++c)(e=d[c]).x-=g,e.y-=h}var d;return null==a&&(a=0),null==b&&(b=0),c.initialize=function(a){d=a},c.x=function(b){return arguments.length?(a=+b,c):a},c.y=function(a){return arguments.length?(b=+a,c):b},c},a.forceCollide=function(a){function c(){function a(a,b,c,d,e){var f=a.data,g=a.r,h=p+g;if(!f)return b>n+h||d<n-h||c>o+h||e<o-h;if(f.index>l.index){var i=n-f.x-f.vx,k=o-f.y-f.vy,r=i*i+k*k;r<h*h&&(0===i&&(r+=(i=m())*i),0===k&&(r+=(k=m())*k),r=(h-(r=Math.sqrt(r)))/r*j,l.vx+=(i*=r)*(h=(g*=g)/(q+g)),l.vy+=(k*=r)*h,f.vx-=i*(h=1-h),f.vy-=k*h)}}for(var c,e,l,n,o,p,q,r=h.length,s=0;s<k;++s)for(e=b.quadtree(h,f,g).visitAfter(d),c=0;c<r;++c)l=h[c],p=i[l.index],q=p*p,n=l.x+l.vx,o=l.y+l.vy,e.visit(a)}function d(a){if(a.data)return a.r=i[a.data.index];for(var b=a.r=0;b<4;++b)a[b]&&a[b].r>a.r&&(a.r=a[b].r)}function e(){if(h){var b,c,d=h.length;for(i=new Array(d),b=0;b<d;++b)c=h[b],i[c.index]=+a(c,b,h)}}var h,i,j=1,k=1;return"function"!=typeof a&&(a=l(null==a?1:+a)),c.initialize=function(a){h=a,e()},c.iterations=function(a){return arguments.length?(k=+a,c):k},c.strength=function(a){return arguments.length?(j=+a,c):j},c.radius=function(b){return arguments.length?(a="function"==typeof b?b:l(+b),e(),c):a},c},a.forceLink=function(a){function b(b){for(var c=0,d=a.length;c<s;++c)for(var e,f,h,i,k,l,n,p=0;p<d;++p)f=(e=a[p]).source,i=(h=e.target).x+h.vx-f.x-f.vx||m(),k=h.y+h.vy-f.y-f.vy||m(),i*=l=((l=Math.sqrt(i*i+k*k))-j[p])/l*b*g[p],k*=l,h.vx-=i*(n=o[p]),h.vy-=k*n,f.vx+=i*(n=1-n),f.vy+=k*n}function d(){if(k){var b,d,h=k.length,l=a.length,m=c.map(k,p);for(b=0,n=new Array(h);b<l;++b)(d=a[b]).index=b,"object"!=typeof d.source&&(d.source=i(m,d.source)),"object"!=typeof d.target&&(d.target=i(m,d.target)),n[d.source.index]=(n[d.source.index]||0)+1,n[d.target.index]=(n[d.target.index]||0)+1;for(b=0,o=new Array(l);b<l;++b)d=a[b],o[b]=n[d.source.index]/(n[d.source.index]+n[d.target.index]);g=new Array(l),e(),j=new Array(l),f()}}function e(){if(k)for(var b=0,c=a.length;b<c;++b)g[b]=+q(a[b],b,a)}function f(){if(k)for(var b=0,c=a.length;b<c;++b)j[b]=+r(a[b],b,a)}var g,j,k,n,o,p=h,q=function(a){return 1/Math.min(n[a.source.index],n[a.target.index])},r=l(30),s=1;return null==a&&(a=[]),b.initialize=function(a){k=a,d()},b.links=function(c){return arguments.length?(a=c,d(),b):a},b.id=function(a){return arguments.length?(p=a,b):p},b.iterations=function(a){return arguments.length?(s=+a,b):s},b.strength=function(a){return arguments.length?(q="function"==typeof a?a:l(+a),e(),b):q},b.distance=function(a){
return arguments.length?(r="function"==typeof a?a:l(+a),f(),b):r},b},a.forceManyBody=function(){function a(a){var c,i=f.length,l=b.quadtree(f,j,k).visitAfter(d);for(h=a,c=0;c<i;++c)g=f[c],l.visit(e)}function c(){if(f){var a,b,c=f.length;for(i=new Array(c),a=0;a<c;++a)b=f[a],i[b.index]=+n(b,a,f)}}function d(a){var b,c,d,e,f,g=0,h=0;if(a.length){for(d=e=f=0;f<4;++f)(b=a[f])&&(c=Math.abs(b.value))&&(g+=b.value,h+=c,d+=c*b.x,e+=c*b.y);a.x=d/h,a.y=e/h}else{(b=a).x=b.data.x,b.y=b.data.y;do{g+=i[b.data.index]}while(b=b.next)}a.value=g}function e(a,b,c,d){if(!a.value)return!0;var e=a.x-g.x,f=a.y-g.y,j=d-b,k=e*e+f*f;if(j*j/q<k)return k<p&&(0===e&&(k+=(e=m())*e),0===f&&(k+=(f=m())*f),k<o&&(k=Math.sqrt(o*k)),g.vx+=e*a.value*h/k,g.vy+=f*a.value*h/k),!0;if(!(a.length||k>=p)){(a.data!==g||a.next)&&(0===e&&(k+=(e=m())*e),0===f&&(k+=(f=m())*f),k<o&&(k=Math.sqrt(o*k)));do{a.data!==g&&(j=i[a.data.index]*h/k,g.vx+=e*j,g.vy+=f*j)}while(a=a.next)}}var f,g,h,i,n=l(-30),o=1,p=1/0,q=.81;return a.initialize=function(a){f=a,c()},a.strength=function(b){return arguments.length?(n="function"==typeof b?b:l(+b),c(),a):n},a.distanceMin=function(b){return arguments.length?(o=b*b,a):Math.sqrt(o)},a.distanceMax=function(b){return arguments.length?(p=b*b,a):Math.sqrt(p)},a.theta=function(b){return arguments.length?(q=b*b,a):Math.sqrt(q)},a},a.forceRadial=function(a,b,c){function d(a){for(var d=0,e=f.length;d<e;++d){var i=f[d],j=i.x-b||1e-6,k=i.y-c||1e-6,l=Math.sqrt(j*j+k*k),m=(h[d]-l)*g[d]*a/l;i.vx+=j*m,i.vy+=k*m}}function e(){if(f){var b,c=f.length;for(g=new Array(c),h=new Array(c),b=0;b<c;++b)h[b]=+a(f[b],b,f),g[b]=isNaN(h[b])?0:+i(f[b],b,f)}}var f,g,h,i=l(.1);return"function"!=typeof a&&(a=l(+a)),null==b&&(b=0),null==c&&(c=0),d.initialize=function(a){f=a,e()},d.strength=function(a){return arguments.length?(i="function"==typeof a?a:l(+a),e(),d):i},d.radius=function(b){return arguments.length?(a="function"==typeof b?b:l(+b),e(),d):a},d.x=function(a){return arguments.length?(b=+a,d):b},d.y=function(a){return arguments.length?(c=+a,d):c},d},a.forceSimulation=function(a){function b(){f(),r.call("tick",i),j<k&&(q.stop(),r.call("end",i))}function f(){var b,c,d=a.length;for(j+=(m-j)*l,p.each(function(a){a(j)}),b=0;b<d;++b)null==(c=a[b]).fx?c.x+=c.vx*=o:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=o:(c.y=c.fy,c.vy=0)}function g(){for(var b,c=0,d=a.length;c<d;++c){if((b=a[c]).index=c,isNaN(b.x)||isNaN(b.y)){var e=10*Math.sqrt(c),f=c*n;b.x=e*Math.cos(f),b.y=e*Math.sin(f)}(isNaN(b.vx)||isNaN(b.vy))&&(b.vx=b.vy=0)}}function h(b){return b.initialize&&b.initialize(a),b}var i,j=1,k=.001,l=1-Math.pow(k,1/300),m=0,o=.6,p=c.map(),q=e.timer(b),r=d.dispatch("tick","end");return null==a&&(a=[]),g(),i={tick:f,restart:function(){return q.restart(b),i},stop:function(){return q.stop(),i},nodes:function(b){return arguments.length?(a=b,g(),p.each(h),i):a},alpha:function(a){return arguments.length?(j=+a,i):j},alphaMin:function(a){return arguments.length?(k=+a,i):k},alphaDecay:function(a){return arguments.length?(l=+a,i):+l},alphaTarget:function(a){return arguments.length?(m=+a,i):m},velocityDecay:function(a){return arguments.length?(o=1-a,i):1-o},force:function(a,b){return arguments.length>1?(null==b?p.remove(a):p.set(a,h(b)),i):p.get(a)},find:function(b,c,d){var e,f,g,h,i,j=0,k=a.length;for(null==d?d=1/0:d*=d,j=0;j<k;++j)(g=(e=b-(h=a[j]).x)*e+(f=c-h.y)*f)<d&&(i=h,d=g);return i},on:function(a,b){return arguments.length>1?(r.on(a,b),i):r.on(a)}}},a.forceX=function(a){function b(a){for(var b,c=0,g=d.length;c<g;++c)(b=d[c]).vx+=(f[c]-b.x)*e[c]*a}function c(){if(d){var b,c=d.length;for(e=new Array(c),f=new Array(c),b=0;b<c;++b)e[b]=isNaN(f[b]=+a(d[b],b,d))?0:+g(d[b],b,d)}}var d,e,f,g=l(.1);return"function"!=typeof a&&(a=l(null==a?0:+a)),b.initialize=function(a){d=a,c()},b.strength=function(a){return arguments.length?(g="function"==typeof a?a:l(+a),c(),b):g},b.x=function(d){return arguments.length?(a="function"==typeof d?d:l(+d),c(),b):a},b},a.forceY=function(a){function b(a){for(var b,c=0,g=d.length;c<g;++c)(b=d[c]).vy+=(f[c]-b.y)*e[c]*a}function c(){if(d){var b,c=d.length;for(e=new Array(c),f=new Array(c),b=0;b<c;++b)e[b]=isNaN(f[b]=+a(d[b],b,d))?0:+g(d[b],b,d)}}var d,e,f,g=l(.1);return"function"!=typeof a&&(a=l(null==a?0:+a)),b.initialize=function(a){d=a,c()},b.strength=function(a){return arguments.length?(g="function"==typeof a?a:l(+a),c(),b):g},b.y=function(d){return arguments.length?(a="function"==typeof d?d:l(+d),c(),b):a},b},Object.defineProperty(a,"__esModule",{value:!0})},"object"==typeof c&&void 0!==b?e(c,a("d3-quadtree"),a("d3-collection"),a("d3-dispatch"),a("d3-timer")):e(d.d3=d.d3||{},d.d3,d.d3,d.d3,d.d3)},{"d3-collection":154,"d3-dispatch":156,"d3-quadtree":161,"d3-timer":163}],158:[function(a,b,c){var d;d=this,function(a){"use strict";function b(a,b){return a.parent===b.parent?1:2}function c(a,b){return a+b.x}function d(a,b){return Math.max(a,b.y)}function e(a){var b=0,c=a.children,d=c&&c.length;if(d)for(;--d>=0;)b+=c[d].value;else b=1;a.value=b}function f(a,b){var c,d,e,f,h,k=new j(a),l=+a.value&&(k.value=a.value),m=[k];for(null==b&&(b=g);c=m.pop();)if(l&&(c.value=+c.data.value),(e=b(c.data))&&(h=e.length))for(c.children=new Array(h),f=h-1;f>=0;--f)m.push(d=c.children[f]=new j(e[f])),d.parent=c,d.depth=c.depth+1;return k.eachBefore(i)}function g(a){return a.children}function h(a){a.data=a.data.data}function i(a){var b=0;do{a.height=b}while((a=a.parent)&&a.height<++b)}function j(a){this.data=a,this.depth=this.height=0,this.parent=null}function k(a){for(var b,c,d=0,e=(a=function(a){for(var b,c,d=a.length;d;)c=Math.random()*d--|0,b=a[d],a[d]=a[c],a[c]=b;return a}(Q.call(a))).length,f=[];d<e;)b=a[d],c&&n(c,b)?++d:(c=p(f=l(f,b)),d=0);return c}function l(a,b){var c,d;if(o(b,a))return[b];for(c=0;c<a.length;++c)if(m(b,a[c])&&o(q(a[c],b),a))return[a[c],b];for(c=0;c<a.length-1;++c)for(d=c+1;d<a.length;++d)if(m(q(a[c],a[d]),b)&&m(q(a[c],b),a[d])&&m(q(a[d],b),a[c])&&o(r(a[c],a[d],b),a))return[a[c],a[d],b];throw new Error}function m(a,b){var c=a.r-b.r,d=b.x-a.x,e=b.y-a.y;return c<0||c*c<d*d+e*e}function n(a,b){var c=a.r-b.r+1e-6,d=b.x-a.x,e=b.y-a.y;return c>0&&c*c>d*d+e*e}function o(a,b){for(var c=0;c<b.length;++c)if(!n(a,b[c]))return!1;return!0}function p(a){switch(a.length){case 1:return{x:(b=a[0]).x,y:b.y,r:b.r};case 2:return q(a[0],a[1]);case 3:return r(a[0],a[1],a[2])}var b}function q(a,b){var c=a.x,d=a.y,e=a.r,f=b.x,g=b.y,h=b.r,i=f-c,j=g-d,k=h-e,l=Math.sqrt(i*i+j*j);return{x:(c+f+i/l*k)/2,y:(d+g+j/l*k)/2,r:(l+e+h)/2}}function r(a,b,c){var d=a.x,e=a.y,f=a.r,g=b.x,h=b.y,i=b.r,j=c.x,k=c.y,l=c.r,m=d-g,n=d-j,o=e-h,p=e-k,q=i-f,r=l-f,s=d*d+e*e-f*f,t=s-g*g-h*h+i*i,u=s-j*j-k*k+l*l,v=n*o-m*p,w=(o*u-p*t)/(2*v)-d,x=(p*q-o*r)/v,y=(n*t-m*u)/(2*v)-e,z=(m*r-n*q)/v,A=x*x+z*z-1,B=2*(f+w*x+y*z),C=w*w+y*y-f*f,D=-(A?(B+Math.sqrt(B*B-4*A*C))/(2*A):C/B);return{x:d+w+x*D,y:e+y+z*D,r:D}}function s(a,b,c){var d,e,f,g,h=a.x-b.x,i=a.y-b.y,j=h*h+i*i;j?(e=b.r+c.r,e*=e,g=a.r+c.r,e>(g*=g)?(d=(j+g-e)/(2*j),f=Math.sqrt(Math.max(0,g/j-d*d)),c.x=a.x-d*h-f*i,c.y=a.y-d*i+f*h):(d=(j+e-g)/(2*j),f=Math.sqrt(Math.max(0,e/j-d*d)),c.x=b.x+d*h-f*i,c.y=b.y+d*i+f*h)):(c.x=b.x+c.r,c.y=b.y)}function t(a,b){var c=a.r+b.r-1e-6,d=b.x-a.x,e=b.y-a.y;return c>0&&c*c>d*d+e*e}function u(a){var b=a._,c=a.next._,d=b.r+c.r,e=(b.x*c.r+c.x*b.r)/d,f=(b.y*c.r+c.y*b.r)/d;return e*e+f*f}function v(a){this._=a,this.next=null,this.previous=null}function w(a){if(!(e=a.length))return 0;var b,c,d,e,f,g,h,i,j,l,m;if((b=a[0]).x=0,b.y=0,!(e>1))return b.r;if(c=a[1],b.x=-c.r,c.x=b.r,c.y=0,!(e>2))return b.r+c.r;s(c,b,d=a[2]),b=new v(b),c=new v(c),d=new v(d),b.next=d.previous=c,c.next=b.previous=d,d.next=c.previous=b;a:for(h=3;h<e;++h){s(b._,c._,d=a[h]),d=new v(d),i=c.next,j=b.previous,l=c._.r,m=b._.r;do{if(l<=m){if(t(i._,d._)){c=i,b.next=c,c.previous=b,--h;continue a}l+=i._.r,i=i.next}else{if(t(j._,d._)){(b=j).next=c,c.previous=b,--h;continue a}m+=j._.r,j=j.previous}}while(i!==j.next);for(d.previous=b,d.next=c,b.next=c.previous=c=d,f=u(b);(d=d.next)!==c;)(g=u(d))<f&&(b=d,f=g);c=b.next}for(b=[c._],d=c;(d=d.next)!==c;)b.push(d._);for(d=k(b),h=0;h<e;++h)(b=a[h]).x-=d.x,b.y-=d.y;return d.r}function x(a){if("function"!=typeof a)throw new Error;return a}function y(){return 0}function z(a){return function(){return a}}function A(a){return Math.sqrt(a.value)}function B(a){return function(b){b.children||(b.r=Math.max(0,+a(b)||0))}}function C(a,b){return function(c){if(d=c.children){var d,e,f,g=d.length,h=a(c)*b||0;if(h)for(e=0;e<g;++e)d[e].r+=h;if(f=w(d),h)for(e=0;e<g;++e)d[e].r-=h;c.r=f+h}}}function D(a){return function(b){var c=b.parent;b.r*=a,c&&(b.x=c.x+a*b.x,b.y=c.y+a*b.y)}}function E(a){a.x0=Math.round(a.x0),a.y0=Math.round(a.y0),a.x1=Math.round(a.x1),a.y1=Math.round(a.y1)}function F(a,b,c,d,e){for(var f,g=a.children,h=-1,i=g.length,j=a.value&&(d-b)/a.value;++h<i;)(f=g[h]).y0=c,f.y1=e,f.x0=b,f.x1=b+=f.value*j}function G(a){return a.id}function H(a){return a.parentId}function I(a,b){return a.parent===b.parent?1:2}function J(a){var b=a.children;return b?b[0]:a.t}function K(a){var b=a.children;return b?b[b.length-1]:a.t}function L(a,b,c){var d=c/(b.i-a.i);b.c-=d,b.s+=c,a.c+=d,b.z+=c,b.m+=c}function M(a,b,c){return a.a.parent===b.parent?a.a:c}function N(a,b){this._=a,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=b}function O(a,b,c,d,e){for(var f,g=a.children,h=-1,i=g.length,j=a.value&&(e-c)/a.value;++h<i;)(f=g[h]).x0=b,f.x1=d,f.y0=c,f.y1=c+=f.value*j}function P(a,b,c,d,e,f){for(var g,h,i,j,k,l,m,n,o,p,q,r=[],s=b.children,t=0,u=0,v=s.length,w=b.value;t<v;){i=e-c,j=f-d;do{k=s[u++].value}while(!k&&u<v);for(l=m=k,q=k*k*(p=Math.max(j/i,i/j)/(w*a)),o=Math.max(m/q,q/l);u<v;++u){if(k+=h=s[u].value,h<l&&(l=h),h>m&&(m=h),q=k*k*p,(n=Math.max(m/q,q/l))>o){k-=h;break}o=n}r.push(g={value:k,dice:i<j,children:s.slice(t,u)}),g.dice?F(g,c,d,e,w?d+=j*k/w:f):O(g,c,d,w?c+=i*k/w:e,f),w-=k,t=u}return r}j.prototype=f.prototype={constructor:j,count:function(){return this.eachAfter(e)},each:function(a){var b,c,d,e,f=this,g=[f];do{for(b=g.reverse(),g=[];f=b.pop();)if(a(f),c=f.children)for(d=0,e=c.length;d<e;++d)g.push(c[d])}while(g.length);return this},eachAfter:function(a){for(var b,c,d,e=this,f=[e],g=[];e=f.pop();)if(g.push(e),b=e.children)for(c=0,d=b.length;c<d;++c)f.push(b[c]);for(;e=g.pop();)a(e);return this},eachBefore:function(a){for(var b,c,d=this,e=[d];d=e.pop();)if(a(d),b=d.children)for(c=b.length-1;c>=0;--c)e.push(b[c]);return this},sum:function(a){return this.eachAfter(function(b){for(var c=+a(b.data)||0,d=b.children,e=d&&d.length;--e>=0;)c+=d[e].value;b.value=c})},sort:function(a){return this.eachBefore(function(b){b.children&&b.children.sort(a)})},path:function(a){for(var b=this,c=function(a,b){if(a===b)return a;var c=a.ancestors(),d=b.ancestors(),e=null;for(a=c.pop(),b=d.pop();a===b;)e=a,a=c.pop(),b=d.pop();return e}(b,a),d=[b];b!==c;)b=b.parent,d.push(b);for(var e=d.length;a!==c;)d.splice(e,0,a),a=a.parent;return d},ancestors:function(){for(var a=this,b=[a];a=a.parent;)b.push(a);return b},descendants:function(){var a=[];return this.each(function(b){a.push(b)}),a},leaves:function(){var a=[];return this.eachBefore(function(b){b.children||a.push(b)}),a},links:function(){var a=this,b=[];return a.each(function(c){c!==a&&b.push({source:c.parent,target:c})}),b},copy:function(){return f(this).eachBefore(h)}};var Q=Array.prototype.slice,R="$",S={depth:-1},T={};N.prototype=Object.create(j.prototype);var U=(1+Math.sqrt(5))/2,V=function a(b){function c(a,c,d,e,f){P(b,a,c,d,e,f)}return c.ratio=function(b){return a((b=+b)>1?b:1)},c}(U),W=function a(b){function c(a,c,d,e,f){if((g=a._squarify)&&g.ratio===b)for(var g,h,i,j,k,l=-1,m=g.length,n=a.value;++l<m;){for(i=(h=g[l]).children,j=h.value=0,k=i.length;j<k;++j)h.value+=i[j].value;h.dice?F(h,c,d,e,d+=(f-d)*h.value/n):O(h,c,d,c+=(e-c)*h.value/n,f),n-=h.value}else a._squarify=g=P(b,a,c,d,e,f),g.ratio=b}return c.ratio=function(b){return a((b=+b)>1?b:1)},c}(U);a.cluster=function(){function a(a){var b,i=0;a.eachAfter(function(a){var f=a.children;f?(a.x=function(a){return a.reduce(c,0)/a.length}(f),a.y=function(a){return 1+a.reduce(d,0)}(f)):(a.x=b?i+=e(a,b):0,a.y=0,b=a)});var j=function(a){for(var b;b=a.children;)a=b[0];return a}(a),k=function(a){for(var b;b=a.children;)a=b[b.length-1];return a}(a),l=j.x-e(j,k)/2,m=k.x+e(k,j)/2;return a.eachAfter(h?function(b){b.x=(b.x-a.x)*f,b.y=(a.y-b.y)*g}:function(b){b.x=(b.x-l)/(m-l)*f,b.y=(1-(a.y?b.y/a.y:1))*g})}var e=b,f=1,g=1,h=!1;return a.separation=function(b){return arguments.length?(e=b,a):e},a.size=function(b){return arguments.length?(h=!1,f=+b[0],g=+b[1],a):h?null:[f,g]},a.nodeSize=function(b){return arguments.length?(h=!0,f=+b[0],g=+b[1],a):h?[f,g]:null},a},a.hierarchy=f,a.pack=function(){function a(a){return a.x=c/2,a.y=d/2,b?a.eachBefore(B(b)).eachAfter(C(e,.5)).eachBefore(D(1)):a.eachBefore(B(A)).eachAfter(C(y,1)).eachAfter(C(e,a.r/Math.min(c,d))).eachBefore(D(Math.min(c,d)/(2*a.r))),a}var b=null,c=1,d=1,e=y;return a.radius=function(c){return arguments.length?(b=null==(d=c)?null:x(d),a):b;var d},a.size=function(b){return arguments.length?(c=+b[0],d=+b[1],a):[c,d]},a.padding=function(b){return arguments.length?(e="function"==typeof b?b:z(+b),a):e},a},a.packSiblings=function(a){return w(a),a},a.packEnclose=k,a.partition=function(){function a(a){var f=a.height+1;return a.x0=a.y0=d,a.x1=b,a.y1=c/f,a.eachBefore(function(a,b){return function(c){c.children&&F(c,c.x0,a*(c.depth+1)/b,c.x1,a*(c.depth+2)/b);var e=c.x0,f=c.y0,g=c.x1-d,h=c.y1-d;g<e&&(e=g=(e+g)/2),h<f&&(f=h=(f+h)/2),c.x0=e,c.y0=f,c.x1=g,c.y1=h}}(c,f)),e&&a.eachBefore(E),a}var b=1,c=1,d=0,e=!1;return a.round=function(b){return arguments.length?(e=!!b,a):e},a.size=function(d){return arguments.length?(b=+d[0],c=+d[1],a):[b,c]},a.padding=function(b){return arguments.length?(d=+b,a):d},a},a.stratify=function(){function a(a){var d,e,f,g,h,k,l,m=a.length,n=new Array(m),o={};for(e=0;e<m;++e)d=a[e],h=n[e]=new j(d),null!=(k=b(d,e,a))&&(k+="")&&(o[l=R+(h.id=k)]=l in o?T:h);for(e=0;e<m;++e)if(h=n[e],null!=(k=c(a[e],e,a))&&(k+="")){if(!(g=o[R+k]))throw new Error("missing: "+k);if(g===T)throw new Error("ambiguous: "+k);g.children?g.children.push(h):g.children=[h],h.parent=g}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(f.parent=S,f.eachBefore(function(a){a.depth=a.parent.depth+1,--m}).eachBefore(i),f.parent=null,m>0)throw new Error("cycle");return f}var b=G,c=H;return a.id=function(c){return arguments.length?(b=x(c),a):b},a.parentId=function(b){return arguments.length?(c=x(b),a):c},a},a.tree=function(){function a(a){var i=function(a){for(var b,c,d,e,f,g=new N(a,0),h=[g];b=h.pop();)if(d=b._.children)for(b.children=new Array(f=d.length),e=f-1;e>=0;--e)h.push(c=b.children[e]=new N(d[e],e)),c.parent=b;return(g.parent=new N(null,0)).children=[g],g}(a);if(i.eachAfter(b),i.parent.m=-i.z,i.eachBefore(c),h)a.eachBefore(d);else{var j=a,k=a,l=a;a.eachBefore(function(a){a.x<j.x&&(j=a),a.x>k.x&&(k=a),a.depth>l.depth&&(l=a)});var m=j===k?1:e(j,k)/2,n=m-j.x,o=f/(k.x+m+n),p=g/(l.depth||1);a.eachBefore(function(a){a.x=(a.x+n)*o,a.y=a.depth*p})}return a}function b(a){var b=a.children,c=a.parent.children,d=a.i?c[a.i-1]:null;if(b){!function(a){for(var b,c=0,d=0,e=a.children,f=e.length;--f>=0;)(b=e[f]).z+=c,b.m+=c,c+=b.s+(d+=b.c)}(a);var f=(b[0].z+b[b.length-1].z)/2;d?(a.z=d.z+e(a._,d._),a.m=a.z-f):a.z=f}else d&&(a.z=d.z+e(a._,d._));a.parent.A=function(a,b,c){if(b){for(var d,f=a,g=a,h=b,i=f.parent.children[0],j=f.m,k=g.m,l=h.m,m=i.m;h=K(h),f=J(f),h&&f;)i=J(i),(g=K(g)).a=a,(d=h.z+l-f.z-j+e(h._,f._))>0&&(L(M(h,a,c),a,d),j+=d,k+=d),l+=h.m,j+=f.m,m+=i.m,k+=g.m;h&&!K(g)&&(g.t=h,g.m+=l-k),f&&!J(i)&&(i.t=f,i.m+=j-m,c=a)}return c}(a,d,a.parent.A||c[0])}function c(a){a._.x=a.z+a.parent.m,a.m+=a.parent.m}function d(a){a.x*=f,a.y=a.depth*g}var e=I,f=1,g=1,h=null;return a.separation=function(b){return arguments.length?(e=b,a):e},a.size=function(b){return arguments.length?(h=!1,f=+b[0],g=+b[1],a):h?null:[f,g]},a.nodeSize=function(b){return arguments.length?(h=!0,f=+b[0],g=+b[1],a):h?[f,g]:null},a},a.treemap=function(){function a(a){return a.x0=a.y0=0,a.x1=e,a.y1=f,a.eachBefore(b),g=[0],d&&a.eachBefore(E),a}function b(a){var b=g[a.depth],d=a.x0+b,e=a.y0+b,f=a.x1-b,m=a.y1-b;f<d&&(d=f=(d+f)/2),m<e&&(e=m=(e+m)/2),a.x0=d,a.y0=e,a.x1=f,a.y1=m,a.children&&(b=g[a.depth+1]=h(a)/2,d+=l(a)-b,e+=i(a)-b,(f-=j(a)-b)<d&&(d=f=(d+f)/2),(m-=k(a)-b)<e&&(e=m=(e+m)/2),c(a,d,e,f,m))}var c=V,d=!1,e=1,f=1,g=[0],h=y,i=y,j=y,k=y,l=y;return a.round=function(b){return arguments.length?(d=!!b,a):d},a.size=function(b){return arguments.length?(e=+b[0],f=+b[1],a):[e,f]},a.tile=function(b){return arguments.length?(c=x(b),a):c},a.padding=function(b){return arguments.length?a.paddingInner(b).paddingOuter(b):a.paddingInner()},a.paddingInner=function(b){return arguments.length?(h="function"==typeof b?b:z(+b),a):h},a.paddingOuter=function(b){return arguments.length?a.paddingTop(b).paddingRight(b).paddingBottom(b).paddingLeft(b):a.paddingTop()},a.paddingTop=function(b){return arguments.length?(i="function"==typeof b?b:z(+b),a):i},a.paddingRight=function(b){return arguments.length?(j="function"==typeof b?b:z(+b),a):j},a.paddingBottom=function(b){return arguments.length?(k="function"==typeof b?b:z(+b),a):k},a.paddingLeft=function(b){return arguments.length?(l="function"==typeof b?b:z(+b),a):l},a},a.treemapBinary=function(a,b,c,d,e){var f,g,h=a.children,i=h.length,j=new Array(i+1);for(j[0]=g=f=0;f<i;++f)j[f+1]=g+=h[f].value;!function a(b,c,d,e,f,g,i){if(b>=c-1){var k=h[b];return k.x0=e,k.y0=f,k.x1=g,void(k.y1=i)}for(var l=j[b],m=d/2+l,n=b+1,o=c-1;n<o;){var p=n+o>>>1;j[p]<m?n=p+1:o=p}m-j[n-1]<j[n]-m&&b+1<n&&--n;var q=j[n]-l,r=d-q;if(g-e>i-f){var s=(e*r+g*q)/d;a(b,n,q,e,f,s,i),a(n,c,r,s,f,g,i)}else{var t=(f*r+i*q)/d;a(b,n,q,e,f,g,t),a(n,c,r,e,t,g,i)}}(0,i,a.value,b,c,d,e)},a.treemapDice=F,a.treemapSlice=O,a.treemapSliceDice=function(a,b,c,d,e){(1&a.depth?O:F)(a,b,c,d,e)},a.treemapSquarify=V,a.treemapResquarify=W,Object.defineProperty(a,"__esModule",{value:!0})}("object"==typeof c&&void 0!==b?c:d.d3=d.d3||{})},{}],159:[function(a,b,c){var d,e;d=this,e=function(a,b){"use strict";function c(a,b,c,d,e){var f=a*a,g=f*a;return((1-3*a+3*f-g)*b+(4-6*f+3*g)*c+(1+3*a+3*f-3*g)*d+g*e)/6}function d(a){var b=a.length-1;return function(d){var e=d<=0?d=0:d>=1?(d=1,b-1):Math.floor(d*b),f=a[e],g=a[e+1],h=e>0?a[e-1]:2*f-g,i=e<b-1?a[e+2]:2*g-f;return c((d-e/b)*b,h,f,g,i)}}function e(a){var b=a.length;return function(d){var e=Math.floor(((d%=1)<0?++d:d)*b),f=a[(e+b-1)%b],g=a[e%b],h=a[(e+1)%b],i=a[(e+2)%b];return c((d-e/b)*b,f,g,h,i)}}function f(a){return function(){return a}}function g(a,b){return function(c){return a+c*b}}function h(a,b){var c=b-a;return c?g(a,c>180||c<-180?c-360*Math.round(c/360):c):f(isNaN(a)?b:a)}function i(a){return 1==(a=+a)?j:function(b,c){return c-b?function(a,b,c){return a=Math.pow(a,c),b=Math.pow(b,c)-a,c=1/c,function(d){return Math.pow(a+d*b,c)}}(b,c,a):f(isNaN(b)?c:b)}}function j(a,b){var c=b-a;return c?g(a,c):f(isNaN(a)?b:a)}function k(a){return function(c){var d,e,f=c.length,g=new Array(f),h=new Array(f),i=new Array(f);for(d=0;d<f;++d)e=b.rgb(c[d]),g[d]=e.r||0,h[d]=e.g||0,i[d]=e.b||0;return g=a(g),h=a(h),i=a(i),e.opacity=1,function(a){return e.r=g(a),e.g=h(a),e.b=i(a),e+""}}}function l(a,b){var c,d=b?b.length:0,e=a?Math.min(d,a.length):0,f=new Array(e),g=new Array(d);for(c=0;c<e;++c)f[c]=q(a[c],b[c]);for(;c<d;++c)g[c]=b[c];return function(a){for(c=0;c<e;++c)g[c]=f[c](a);return g}}function m(a,b){var c=new Date;return b-=a=+a,function(d){return c.setTime(a+b*d),c}}function n(a,b){return b-=a=+a,function(c){return a+b*c}}function o(a,b){var c,d={},e={};for(c in null!==a&&"object"==typeof a||(a={}),null!==b&&"object"==typeof b||(b={}),b)c in a?d[c]=q(a[c],b[c]):e[c]=b[c];return function(a){for(c in d)e[c]=d[c](a);return e}}function p(a,b){var c,d,e,f=E.lastIndex=F.lastIndex=0,g=-1,h=[],i=[];for(a+="",b+="";(c=E.exec(a))&&(d=F.exec(b));)(e=d.index)>f&&(e=b.slice(f,e),h[g]?h[g]+=e:h[++g]=e),(c=c[0])===(d=d[0])?h[g]?h[g]+=d:h[++g]=d:(h[++g]=null,i.push({i:g,x:n(c,d)})),f=F.lastIndex;return f<b.length&&(e=b.slice(f),h[g]?h[g]+=e:h[++g]=e),h.length<2?i[0]?function(a){return function(b){return a(b)+""}}(i[0].x):function(a){return function(){return a}}(b):(b=i.length,function(a){for(var c,d=0;d<b;++d)h[(c=i[d]).i]=c.x(a);return h.join("")})}function q(a,c){var d,e=typeof c;return null==c||"boolean"===e?f(c):("number"===e?n:"string"===e?(d=b.color(c))?(c=d,B):p:c instanceof b.color?B:c instanceof Date?m:Array.isArray(c)?l:"function"!=typeof c.valueOf&&"function"!=typeof c.toString||isNaN(c)?o:n)(a,c)}function r(a,b,c,d,e,f){var g,h,i;return(g=Math.sqrt(a*a+b*b))&&(a/=g,b/=g),(i=a*c+b*d)&&(c-=a*i,d-=b*i),(h=Math.sqrt(c*c+d*d))&&(c/=h,d/=h,i/=h),a*d<b*c&&(a=-a,b=-b,i=-i,g=-g),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*G,skewX:Math.atan(i)*G,scaleX:g,scaleY:h}}function s(a,b,c,d){function e(a){return a.length?a.pop()+" ":""}return function(f,g){var h=[],i=[];return f=a(f),g=a(g),function(a,d,e,f,g,h){if(a!==e||d!==f){var i=g.push("translate(",null,b,null,c);h.push({i:i-4,x:n(a,e)},{i:i-2,x:n(d,f)})}else(e||f)&&g.push("translate("+e+b+f+c)}(f.translateX,f.translateY,g.translateX,g.translateY,h,i),function(a,b,c,f){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),f.push({i:c.push(e(c)+"rotate(",null,d)-2,x:n(a,b)})):b&&c.push(e(c)+"rotate("+b+d)}(f.rotate,g.rotate,h,i),function(a,b,c,f){a!==b?f.push({i:c.push(e(c)+"skewX(",null,d)-2,x:n(a,b)}):b&&c.push(e(c)+"skewX("+b+d)}(f.skewX,g.skewX,h,i),function(a,b,c,d,f,g){if(a!==c||b!==d){var h=f.push(e(f)+"scale(",null,",",null,")");g.push({i:h-4,x:n(a,c)},{i:h-2,x:n(b,d)})}else 1===c&&1===d||f.push(e(f)+"scale("+c+","+d+")")}(f.scaleX,f.scaleY,g.scaleX,g.scaleY,h,i),f=g=null,function(a){for(var b,c=-1,d=i.length;++c<d;)h[(b=i[c]).i]=b.x(a);return h.join("")}}}function t(a){return((a=Math.exp(a))+1/a)/2}function u(a){return function(c,d){var e=a((c=b.hsl(c)).h,(d=b.hsl(d)).h),f=j(c.s,d.s),g=j(c.l,d.l),h=j(c.opacity,d.opacity);return function(a){return c.h=e(a),c.s=f(a),c.l=g(a),c.opacity=h(a),c+""}}}function v(a){return function(c,d){var e=a((c=b.hcl(c)).h,(d=b.hcl(d)).h),f=j(c.c,d.c),g=j(c.l,d.l),h=j(c.opacity,d.opacity);return function(a){return c.h=e(a),c.c=f(a),c.l=g(a),c.opacity=h(a),c+""}}}function w(a){return function c(d){function e(c,e){var f=a((c=b.cubehelix(c)).h,(e=b.cubehelix(e)).h),g=j(c.s,e.s),h=j(c.l,e.l),i=j(c.opacity,e.opacity);return function(a){return c.h=f(a),c.s=g(a),c.l=h(Math.pow(a,d)),c.opacity=i(a),c+""}}return d=+d,e.gamma=c,e}(1)}var x,y,z,A,B=function a(c){function d(a,c){var d=e((a=b.rgb(a)).r,(c=b.rgb(c)).r),f=e(a.g,c.g),g=e(a.b,c.b),h=j(a.opacity,c.opacity);return function(b){return a.r=d(b),a.g=f(b),a.b=g(b),a.opacity=h(b),a+""}}var e=i(c);return d.gamma=a,d}(1),C=k(d),D=k(e),E=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,F=new RegExp(E.source,"g"),G=180/Math.PI,H={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},I=s(function(a){return"none"===a?H:(x||(x=document.createElement("DIV"),y=document.documentElement,z=document.defaultView),x.style.transform=a,a=z.getComputedStyle(y.appendChild(x),null).getPropertyValue("transform"),y.removeChild(x),r(+(a=a.slice(7,-1).split(","))[0],+a[1],+a[2],+a[3],+a[4],+a[5]))},"px, ","px)","deg)"),J=s(function(a){return null==a?H:(A||(A=document.createElementNS("http://www.w3.org/2000/svg","g")),A.setAttribute("transform",a),(a=A.transform.baseVal.consolidate())?r((a=a.matrix).a,a.b,a.c,a.d,a.e,a.f):H)},", ",")",")"),K=Math.SQRT2,L=u(h),M=u(j),N=v(h),O=v(j),P=w(h),Q=w(j);a.interpolate=q,a.interpolateArray=l,a.interpolateBasis=d,a.interpolateBasisClosed=e,a.interpolateDate=m,a.interpolateDiscrete=function(a){var b=a.length;return function(c){return a[Math.max(0,Math.min(b-1,Math.floor(c*b)))]}},a.interpolateHue=function(a,b){var c=h(+a,+b);return function(a){var b=c(a);return b-360*Math.floor(b/360)}},a.interpolateNumber=n,a.interpolateObject=o,a.interpolateRound=function(a,b){return b-=a=+a,function(c){return Math.round(a+b*c)}},a.interpolateString=p,a.interpolateTransformCss=I,a.interpolateTransformSvg=J,a.interpolateZoom=function(a,b){var c,d,e=a[0],f=a[1],g=a[2],h=b[0],i=b[1],j=b[2],k=h-e,l=i-f,m=k*k+l*l;if(m<1e-12)d=Math.log(j/g)/K,c=function(a){return[e+a*k,f+a*l,g*Math.exp(K*a*d)]};else{var n=Math.sqrt(m),o=(j*j-g*g+4*m)/(2*g*2*n),p=(j*j-g*g-4*m)/(2*j*2*n),q=Math.log(Math.sqrt(o*o+1)-o),r=Math.log(Math.sqrt(p*p+1)-p);d=(r-q)/K,c=function(a){var b,c=a*d,h=t(q),i=g/(2*n)*(h*(b=K*c+q,((b=Math.exp(2*b))-1)/(b+1))-function(a){return((a=Math.exp(a))-1/a)/2}(q));return[e+i*k,f+i*l,g*h/t(K*c+q)]}}return c.duration=1e3*d,c},a.interpolateRgb=B,a.interpolateRgbBasis=C,a.interpolateRgbBasisClosed=D,a.interpolateHsl=L,a.interpolateHslLong=M,a.interpolateLab=function(a,c){var d=j((a=b.lab(a)).l,(c=b.lab(c)).l),e=j(a.a,c.a),f=j(a.b,c.b),g=j(a.opacity,c.opacity);return function(b){return a.l=d(b),a.a=e(b),a.b=f(b),a.opacity=g(b),a+""}},a.interpolateHcl=N,a.interpolateHclLong=O,a.interpolateCubehelix=P,a.interpolateCubehelixLong=Q,a.piecewise=function(a,b){for(var c=0,d=b.length-1,e=b[0],f=new Array(d<0?0:d);c<d;)f[c]=a(e,e=b[++c]);return function(a){var b=Math.max(0,Math.min(d-1,Math.floor(a*=d)));return f[b](a-b)}},a.quantize=function(a,b){for(var c=new Array(b),d=0;d<b;++d)c[d]=a(d/(b-1));return c},Object.defineProperty(a,"__esModule",{value:!0})},"object"==typeof c&&void 0!==b?e(c,a("d3-color")):e(d.d3=d.d3||{},d.d3)},{"d3-color":155}],160:[function(a,b,c){var d;d=this,function(a){"use strict";function b(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function c(){return new b}var d=Math.PI,e=2*d,f=e-1e-6;b.prototype=c.prototype={constructor:b,moveTo:function(a,b){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+b)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(a,b){this._+="L"+(this._x1=+a)+","+(this._y1=+b)},quadraticCurveTo:function(a,b,c,d){this._+="Q"+ +a+","+ +b+","+(this._x1=+c)+","+(this._y1=+d)},bezierCurveTo:function(a,b,c,d,e,f){this._+="C"+ +a+","+ +b+","+ +c+","+ +d+","+(this._x1=+e)+","+(this._y1=+f)},arcTo:function(a,b,c,e,f){a=+a,b=+b,c=+c,e=+e,f=+f;var g=this._x1,h=this._y1,i=c-a,j=e-b,k=g-a,l=h-b,m=k*k+l*l;if(f<0)throw new Error("negative radius: "+f);if(null===this._x1)this._+="M"+(this._x1=a)+","+(this._y1=b);else if(m>1e-6)if(Math.abs(l*i-j*k)>1e-6&&f){var n=c-g,o=e-h,p=i*i+j*j,q=n*n+o*o,r=Math.sqrt(p),s=Math.sqrt(m),t=f*Math.tan((d-Math.acos((p+m-q)/(2*r*s)))/2),u=t/s,v=t/r;Math.abs(u-1)>1e-6&&(this._+="L"+(a+u*k)+","+(b+u*l)),this._+="A"+f+","+f+",0,0,"+ +(l*n>k*o)+","+(this._x1=a+v*i)+","+(this._y1=b+v*j)}else this._+="L"+(this._x1=a)+","+(this._y1=b)},arc:function(a,b,c,g,h,i){a=+a,b=+b;var j=(c=+c)*Math.cos(g),k=c*Math.sin(g),l=a+j,m=b+k,n=1^i,o=i?g-h:h-g;if(c<0)throw new Error("negative radius: "+c);null===this._x1?this._+="M"+l+","+m:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-m)>1e-6)&&(this._+="L"+l+","+m),c&&(o<0&&(o=o%e+e),o>f?this._+="A"+c+","+c+",0,1,"+n+","+(a-j)+","+(b-k)+"A"+c+","+c+",0,1,"+n+","+(this._x1=l)+","+(this._y1=m):o>1e-6&&(this._+="A"+c+","+c+",0,"+ +(o>=d)+","+n+","+(this._x1=a+c*Math.cos(h))+","+(this._y1=b+c*Math.sin(h))))},rect:function(a,b,c,d){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+b)+"h"+ +c+"v"+ +d+"h"+-c+"Z"},toString:function(){return this._}},a.path=c,Object.defineProperty(a,"__esModule",{value:!0})}("object"==typeof c&&void 0!==b?c:d.d3=d.d3||{})},{}],161:[function(a,b,c){var d;d=this,function(a){"use strict";function b(a,b,c,d){if(isNaN(b)||isNaN(c))return a;var e,f,g,h,i,j,k,l,m,n=a._root,o={data:d},p=a._x0,q=a._y0,r=a._x1,s=a._y1;if(!n)return a._root=o,a;for(;n.length;)if((j=b>=(f=(p+r)/2))?p=f:r=f,(k=c>=(g=(q+s)/2))?q=g:s=g,e=n,!(n=n[l=k<<1|j]))return e[l]=o,a;if(h=+a._x.call(null,n.data),i=+a._y.call(null,n.data),b===h&&c===i)return o.next=n,e?e[l]=o:a._root=o,a;do{e=e?e[l]=new Array(4):a._root=new Array(4),(j=b>=(f=(p+r)/2))?p=f:r=f,(k=c>=(g=(q+s)/2))?q=g:s=g}while((l=k<<1|j)==(m=(i>=g)<<1|h>=f));return e[m]=n,e[l]=o,a}function c(a){return a[0]}function d(a){return a[1]}function e(a,b,e){var g=new f(null==b?c:b,null==e?d:e,NaN,NaN,NaN,NaN);return null==a?g:g.addAll(a)}function f(a,b,c,d,e,f){this._x=a,this._y=b,this._x0=c,this._y0=d,this._x1=e,this._y1=f,this._root=void 0}function g(a){for(var b={data:a.data},c=b;a=a.next;)c=c.next={data:a.data};return b}var h=function(a,b,c,d,e){this.node=a,this.x0=b,this.y0=c,this.x1=d,this.y1=e},i=e.prototype=f.prototype;i.copy=function(){var a,b,c=new f(this._x,this._y,this._x0,this._y0,this._x1,this._y1),d=this._root;if(!d)return c;if(!d.length)return c._root=g(d),c;for(a=[{source:d,target:c._root=new Array(4)}];d=a.pop();)for(var e=0;e<4;++e)(b=d.source[e])&&(b.length?a.push({source:b,target:d.target[e]=new Array(4)}):d.target[e]=g(b));return c},i.add=function(a){var c=+this._x.call(null,a),d=+this._y.call(null,a);return b(this.cover(c,d),c,d,a)},i.addAll=function(a){var c,d,e,f,g=a.length,h=new Array(g),i=new Array(g),j=1/0,k=1/0,l=-1/0,m=-1/0;for(d=0;d<g;++d)isNaN(e=+this._x.call(null,c=a[d]))||isNaN(f=+this._y.call(null,c))||(h[d]=e,i[d]=f,e<j&&(j=e),e>l&&(l=e),f<k&&(k=f),f>m&&(m=f));for(l<j&&(j=this._x0,l=this._x1),m<k&&(k=this._y0,m=this._y1),this.cover(j,k).cover(l,m),d=0;d<g;++d)b(this,h[d],i[d],a[d]);return this},i.cover=function(a,b){if(isNaN(a=+a)||isNaN(b=+b))return this;var c=this._x0,d=this._y0,e=this._x1,f=this._y1;if(isNaN(c))e=(c=Math.floor(a))+1,f=(d=Math.floor(b))+1;else{if(!(c>a||a>e||d>b||b>f))return this;var g,h,i=e-c,j=this._root;switch(h=(b<(d+f)/2)<<1|a<(c+e)/2){case 0:do{(g=new Array(4))[h]=j,j=g}while(f=d+(i*=2),a>(e=c+i)||b>f);break;case 1:do{(g=new Array(4))[h]=j,j=g}while(f=d+(i*=2),(c=e-i)>a||b>f);break;case 2:do{(g=new Array(4))[h]=j,j=g}while(d=f-(i*=2),a>(e=c+i)||d>b);break;case 3:do{(g=new Array(4))[h]=j,j=g}while(d=f-(i*=2),(c=e-i)>a||d>b)}this._root&&this._root.length&&(this._root=j)}return this._x0=c,this._y0=d,this._x1=e,this._y1=f,this},i.data=function(){var a=[];return this.visit(function(b){if(!b.length)do{a.push(b.data)}while(b=b.next)}),a},i.extent=function(a){return arguments.length?this.cover(+a[0][0],+a[0][1]).cover(+a[1][0],+a[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},i.find=function(a,b,c){var d,e,f,g,i,j,k,l=this._x0,m=this._y0,n=this._x1,o=this._y1,p=[],q=this._root;for(q&&p.push(new h(q,l,m,n,o)),null==c?c=1/0:(l=a-c,m=b-c,n=a+c,o=b+c,c*=c);j=p.pop();)if(!(!(q=j.node)||(e=j.x0)>n||(f=j.y0)>o||(g=j.x1)<l||(i=j.y1)<m))if(q.length){var r=(e+g)/2,s=(f+i)/2;p.push(new h(q[3],r,s,g,i),new h(q[2],e,s,r,i),new h(q[1],r,f,g,s),new h(q[0],e,f,r,s)),(k=(b>=s)<<1|a>=r)&&(j=p[p.length-1],p[p.length-1]=p[p.length-1-k],p[p.length-1-k]=j)}else{var t=a-+this._x.call(null,q.data),u=b-+this._y.call(null,q.data),v=t*t+u*u;if(v<c){var w=Math.sqrt(c=v);l=a-w,m=b-w,n=a+w,o=b+w,d=q.data}}return d},i.remove=function(a){if(isNaN(f=+this._x.call(null,a))||isNaN(g=+this._y.call(null,a)))return this;var b,c,d,e,f,g,h,i,j,k,l,m,n=this._root,o=this._x0,p=this._y0,q=this._x1,r=this._y1;if(!n)return this;if(n.length)for(;;){if((j=f>=(h=(o+q)/2))?o=h:q=h,(k=g>=(i=(p+r)/2))?p=i:r=i,b=n,!(n=n[l=k<<1|j]))return this;if(!n.length)break;(b[l+1&3]||b[l+2&3]||b[l+3&3])&&(c=b,m=l)}for(;n.data!==a;)if(d=n,!(n=n.next))return this;return(e=n.next)&&delete n.next,d?(e?d.next=e:delete d.next,this):b?(e?b[l]=e:delete b[l],(n=b[0]||b[1]||b[2]||b[3])&&n===(b[3]||b[2]||b[1]||b[0])&&!n.length&&(c?c[m]=n:this._root=n),this):(this._root=e,this)},i.removeAll=function(a){for(var b=0,c=a.length;b<c;++b)this.remove(a[b]);return this},i.root=function(){return this._root},i.size=function(){var a=0;return this.visit(function(b){if(!b.length)do{++a}while(b=b.next)}),a},i.visit=function(a){var b,c,d,e,f,g,i=[],j=this._root;for(j&&i.push(new h(j,this._x0,this._y0,this._x1,this._y1));b=i.pop();)if(!a(j=b.node,d=b.x0,e=b.y0,f=b.x1,g=b.y1)&&j.length){var k=(d+f)/2,l=(e+g)/2;(c=j[3])&&i.push(new h(c,k,l,f,g)),(c=j[2])&&i.push(new h(c,d,l,k,g)),
(c=j[1])&&i.push(new h(c,k,e,f,l)),(c=j[0])&&i.push(new h(c,d,e,k,l))}return this},i.visitAfter=function(a){var b,c=[],d=[];for(this._root&&c.push(new h(this._root,this._x0,this._y0,this._x1,this._y1));b=c.pop();){var e=b.node;if(e.length){var f,g=b.x0,i=b.y0,j=b.x1,k=b.y1,l=(g+j)/2,m=(i+k)/2;(f=e[0])&&c.push(new h(f,g,i,l,m)),(f=e[1])&&c.push(new h(f,l,i,j,m)),(f=e[2])&&c.push(new h(f,g,m,l,k)),(f=e[3])&&c.push(new h(f,l,m,j,k))}d.push(b)}for(;b=d.pop();)a(b.node,b.x0,b.y0,b.x1,b.y1);return this},i.x=function(a){return arguments.length?(this._x=a,this):this._x},i.y=function(a){return arguments.length?(this._y=a,this):this._y},a.quadtree=e,Object.defineProperty(a,"__esModule",{value:!0})}("object"==typeof c&&void 0!==b?c:d.d3=d.d3||{})},{}],162:[function(a,b,c){var d,e;d=this,e=function(a,b){"use strict";function c(a){return function(){return a}}function d(a){return a>=1?ra:a<=-1?-ra:Math.asin(a)}function e(a){return a.innerRadius}function f(a){return a.outerRadius}function g(a){return a.startAngle}function h(a){return a.endAngle}function i(a){return a&&a.padAngle}function j(a,b,c,d,e,f,g){var h=a-c,i=b-d,j=(g?f:-f)/oa(h*h+i*i),k=j*i,l=-j*h,m=a+k,n=b+l,o=c+k,p=d+l,q=(m+o)/2,r=(n+p)/2,s=o-m,t=p-n,u=s*s+t*t,v=e-f,w=m*p-o*n,x=(t<0?-1:1)*oa(la(0,v*v*u-w*w)),y=(w*t-s*x)/u,z=(-w*s-t*x)/u,A=(w*t+s*x)/u,B=(-w*s+t*x)/u,C=y-q,D=z-r,E=A-q,F=B-r;return C*C+D*D>E*E+F*F&&(y=A,z=B),{cx:y,cy:z,x01:-k,y01:-l,x11:y*(e/v-1),y11:z*(e/v-1)}}function k(a){this._context=a}function l(a){return new k(a)}function m(a){return a[0]}function n(a){return a[1]}function o(){function a(a){var c,j,k,l=a.length,m=!1;for(null==g&&(i=h(k=b.path())),c=0;c<=l;++c)!(c<l&&f(j=a[c],c,a))===m&&((m=!m)?i.lineStart():i.lineEnd()),m&&i.point(+d(j,c,a),+e(j,c,a));if(k)return i=null,k+""||null}var d=m,e=n,f=c(!0),g=null,h=l,i=null;return a.x=function(b){return arguments.length?(d="function"==typeof b?b:c(+b),a):d},a.y=function(b){return arguments.length?(e="function"==typeof b?b:c(+b),a):e},a.defined=function(b){return arguments.length?(f="function"==typeof b?b:c(!!b),a):f},a.curve=function(b){return arguments.length?(h=b,null!=g&&(i=h(g)),a):h},a.context=function(b){return arguments.length?(null==b?g=i=null:i=h(g=b),a):g},a}function p(){function a(a){var c,d,l,m,n,o=a.length,q=!1,r=new Array(o),s=new Array(o);for(null==j&&(p=k(n=b.path())),c=0;c<=o;++c){if(!(c<o&&i(m=a[c],c,a))===q)if(q=!q)d=c,p.areaStart(),p.lineStart();else{for(p.lineEnd(),p.lineStart(),l=c-1;l>=d;--l)p.point(r[l],s[l]);p.lineEnd(),p.areaEnd()}q&&(r[c]=+e(m,c,a),s[c]=+g(m,c,a),p.point(f?+f(m,c,a):r[c],h?+h(m,c,a):s[c]))}if(n)return p=null,n+""||null}function d(){return o().defined(i).curve(k).context(j)}var e=m,f=null,g=c(0),h=n,i=c(!0),j=null,k=l,p=null;return a.x=function(b){return arguments.length?(e="function"==typeof b?b:c(+b),f=null,a):e},a.x0=function(b){return arguments.length?(e="function"==typeof b?b:c(+b),a):e},a.x1=function(b){return arguments.length?(f=null==b?null:"function"==typeof b?b:c(+b),a):f},a.y=function(b){return arguments.length?(g="function"==typeof b?b:c(+b),h=null,a):g},a.y0=function(b){return arguments.length?(g="function"==typeof b?b:c(+b),a):g},a.y1=function(b){return arguments.length?(h=null==b?null:"function"==typeof b?b:c(+b),a):h},a.lineX0=a.lineY0=function(){return d().x(e).y(g)},a.lineY1=function(){return d().x(e).y(h)},a.lineX1=function(){return d().x(f).y(g)},a.defined=function(b){return arguments.length?(i="function"==typeof b?b:c(!!b),a):i},a.curve=function(b){return arguments.length?(k=b,null!=j&&(p=k(j)),a):k},a.context=function(b){return arguments.length?(null==b?j=p=null:p=k(j=b),a):j},a}function q(a,b){return b<a?-1:b>a?1:b>=a?0:NaN}function r(a){return a}function s(a){this._curve=a}function t(a){function b(b){return new s(a(b))}return b._curve=a,b}function u(a){var b=a.curve;return a.angle=a.x,delete a.x,a.radius=a.y,delete a.y,a.curve=function(a){return arguments.length?b(t(a)):b()._curve},a}function v(){return u(o().curve(ta))}function w(){var a=p().curve(ta),b=a.curve,c=a.lineX0,d=a.lineX1,e=a.lineY0,f=a.lineY1;return a.angle=a.x,delete a.x,a.startAngle=a.x0,delete a.x0,a.endAngle=a.x1,delete a.x1,a.radius=a.y,delete a.y,a.innerRadius=a.y0,delete a.y0,a.outerRadius=a.y1,delete a.y1,a.lineStartAngle=function(){return u(c())},delete a.lineX0,a.lineEndAngle=function(){return u(d())},delete a.lineX1,a.lineInnerRadius=function(){return u(e())},delete a.lineY0,a.lineOuterRadius=function(){return u(f())},delete a.lineY1,a.curve=function(a){return arguments.length?b(t(a)):b()._curve},a}function x(a,b){return[(b=+b)*Math.cos(a-=Math.PI/2),b*Math.sin(a)]}function y(a){return a.source}function z(a){return a.target}function A(a){function d(){var c,d=ua.call(arguments),j=e.apply(this,d),k=f.apply(this,d);if(i||(i=c=b.path()),a(i,+g.apply(this,(d[0]=j,d)),+h.apply(this,d),+g.apply(this,(d[0]=k,d)),+h.apply(this,d)),c)return i=null,c+""||null}var e=y,f=z,g=m,h=n,i=null;return d.source=function(a){return arguments.length?(e=a,d):e},d.target=function(a){return arguments.length?(f=a,d):f},d.x=function(a){return arguments.length?(g="function"==typeof a?a:c(+a),d):g},d.y=function(a){return arguments.length?(h="function"==typeof a?a:c(+a),d):h},d.context=function(a){return arguments.length?(i=null==a?null:a,d):i},d}function B(a,b,c,d,e){a.moveTo(b,c),a.bezierCurveTo(b=(b+d)/2,c,b,e,d,e)}function C(a,b,c,d,e){a.moveTo(b,c),a.bezierCurveTo(b,c=(c+e)/2,d,c,d,e)}function D(a,b,c,d,e){var f=x(b,c),g=x(b,c=(c+e)/2),h=x(d,c),i=x(d,e);a.moveTo(f[0],f[1]),a.bezierCurveTo(g[0],g[1],h[0],h[1],i[0],i[1])}function E(){}function F(a,b,c){a._context.bezierCurveTo((2*a._x0+a._x1)/3,(2*a._y0+a._y1)/3,(a._x0+2*a._x1)/3,(a._y0+2*a._y1)/3,(a._x0+4*a._x1+b)/6,(a._y0+4*a._y1+c)/6)}function G(a){this._context=a}function H(a){this._context=a}function I(a){this._context=a}function J(a,b){this._basis=new G(a),this._beta=b}function K(a,b,c){a._context.bezierCurveTo(a._x1+a._k*(a._x2-a._x0),a._y1+a._k*(a._y2-a._y0),a._x2+a._k*(a._x1-b),a._y2+a._k*(a._y1-c),a._x2,a._y2)}function L(a,b){this._context=a,this._k=(1-b)/6}function M(a,b){this._context=a,this._k=(1-b)/6}function N(a,b){this._context=a,this._k=(1-b)/6}function O(a,b,c){var d=a._x1,e=a._y1,f=a._x2,g=a._y2;if(a._l01_a>pa){var h=2*a._l01_2a+3*a._l01_a*a._l12_a+a._l12_2a,i=3*a._l01_a*(a._l01_a+a._l12_a);d=(d*h-a._x0*a._l12_2a+a._x2*a._l01_2a)/i,e=(e*h-a._y0*a._l12_2a+a._y2*a._l01_2a)/i}if(a._l23_a>pa){var j=2*a._l23_2a+3*a._l23_a*a._l12_a+a._l12_2a,k=3*a._l23_a*(a._l23_a+a._l12_a);f=(f*j+a._x1*a._l23_2a-b*a._l12_2a)/k,g=(g*j+a._y1*a._l23_2a-c*a._l12_2a)/k}a._context.bezierCurveTo(d,e,f,g,a._x2,a._y2)}function P(a,b){this._context=a,this._alpha=b}function Q(a,b){this._context=a,this._alpha=b}function R(a,b){this._context=a,this._alpha=b}function S(a){this._context=a}function T(a){return a<0?-1:1}function U(a,b,c){var d=a._x1-a._x0,e=b-a._x1,f=(a._y1-a._y0)/(d||e<0&&-0),g=(c-a._y1)/(e||d<0&&-0),h=(f*e+g*d)/(d+e);return(T(f)+T(g))*Math.min(Math.abs(f),Math.abs(g),.5*Math.abs(h))||0}function V(a,b){var c=a._x1-a._x0;return c?(3*(a._y1-a._y0)/c-b)/2:b}function W(a,b,c){var d=a._x0,e=a._y0,f=a._x1,g=a._y1,h=(f-d)/3;a._context.bezierCurveTo(d+h,e+h*b,f-h,g-h*c,f,g)}function X(a){this._context=a}function Y(a){this._context=new Z(a)}function Z(a){this._context=a}function $(a){this._context=a}function _(a){var b,c,d=a.length-1,e=new Array(d),f=new Array(d),g=new Array(d);for(e[0]=0,f[0]=2,g[0]=a[0]+2*a[1],b=1;b<d-1;++b)e[b]=1,f[b]=4,g[b]=4*a[b]+2*a[b+1];for(e[d-1]=2,f[d-1]=7,g[d-1]=8*a[d-1]+a[d],b=1;b<d;++b)c=e[b]/f[b-1],f[b]-=c,g[b]-=c*g[b-1];for(e[d-1]=g[d-1]/f[d-1],b=d-2;b>=0;--b)e[b]=(g[b]-e[b+1])/f[b];for(f[d-1]=(a[d]+e[d-1])/2,b=0;b<d-1;++b)f[b]=2*a[b+1]-e[b+1];return[e,f]}function aa(a,b){this._context=a,this._t=b}function ba(a,b){if((e=a.length)>1)for(var c,d,e,f=1,g=a[b[0]],h=g.length;f<e;++f)for(d=g,g=a[b[f]],c=0;c<h;++c)g[c][1]+=g[c][0]=isNaN(d[c][1])?d[c][0]:d[c][1]}function ca(a){for(var b=a.length,c=new Array(b);--b>=0;)c[b]=b;return c}function da(a,b){return a[b]}function ea(a){var b=a.map(fa);return ca(a).sort(function(a,c){return b[a]-b[c]})}function fa(a){for(var b,c=-1,d=0,e=a.length,f=-1/0;++c<e;)(b=+a[c][1])>f&&(f=b,d=c);return d}function ga(a){var b=a.map(ha);return ca(a).sort(function(a,c){return b[a]-b[c]})}function ha(a){for(var b,c=0,d=-1,e=a.length;++d<e;)(b=+a[d][1])&&(c+=b);return c}var ia=Math.abs,ja=Math.atan2,ka=Math.cos,la=Math.max,ma=Math.min,na=Math.sin,oa=Math.sqrt,pa=1e-12,qa=Math.PI,ra=qa/2,sa=2*qa;k.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;default:this._context.lineTo(a,b)}}};var ta=t(l);s.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(a,b){this._curve.point(b*Math.sin(a),b*-Math.cos(a))}};var ua=Array.prototype.slice,va={draw:function(a,b){var c=Math.sqrt(b/qa);a.moveTo(c,0),a.arc(0,0,c,0,sa)}},wa={draw:function(a,b){var c=Math.sqrt(b/5)/2;a.moveTo(-3*c,-c),a.lineTo(-c,-c),a.lineTo(-c,-3*c),a.lineTo(c,-3*c),a.lineTo(c,-c),a.lineTo(3*c,-c),a.lineTo(3*c,c),a.lineTo(c,c),a.lineTo(c,3*c),a.lineTo(-c,3*c),a.lineTo(-c,c),a.lineTo(-3*c,c),a.closePath()}},xa=Math.sqrt(1/3),ya=2*xa,za={draw:function(a,b){var c=Math.sqrt(b/ya),d=c*xa;a.moveTo(0,-c),a.lineTo(d,0),a.lineTo(0,c),a.lineTo(-d,0),a.closePath()}},Aa=Math.sin(qa/10)/Math.sin(7*qa/10),Ba=Math.sin(sa/10)*Aa,Ca=-Math.cos(sa/10)*Aa,Da={draw:function(a,b){var c=Math.sqrt(.8908130915292852*b),d=Ba*c,e=Ca*c;a.moveTo(0,-c),a.lineTo(d,e);for(var f=1;f<5;++f){var g=sa*f/5,h=Math.cos(g),i=Math.sin(g);a.lineTo(i*c,-h*c),a.lineTo(h*d-i*e,i*d+h*e)}a.closePath()}},Ea={draw:function(a,b){var c=Math.sqrt(b),d=-c/2;a.rect(d,d,c,c)}},Fa=Math.sqrt(3),Ga={draw:function(a,b){var c=-Math.sqrt(b/(3*Fa));a.moveTo(0,2*c),a.lineTo(-Fa*c,-c),a.lineTo(Fa*c,-c),a.closePath()}},Ha=-.5,Ia=Math.sqrt(3)/2,Ja=1/Math.sqrt(12),Ka=3*(Ja/2+1),La={draw:function(a,b){var c=Math.sqrt(b/Ka),d=c/2,e=c*Ja,f=d,g=c*Ja+c,h=-f,i=g;a.moveTo(d,e),a.lineTo(f,g),a.lineTo(h,i),a.lineTo(Ha*d-Ia*e,Ia*d+Ha*e),a.lineTo(Ha*f-Ia*g,Ia*f+Ha*g),a.lineTo(Ha*h-Ia*i,Ia*h+Ha*i),a.lineTo(Ha*d+Ia*e,Ha*e-Ia*d),a.lineTo(Ha*f+Ia*g,Ha*g-Ia*f),a.lineTo(Ha*h+Ia*i,Ha*i-Ia*h),a.closePath()}},Ma=[va,wa,za,Ea,Da,Ga,La];G.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:F(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:F(this,a,b)}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=b}},H.prototype={areaStart:E,areaEnd:E,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._x2=a,this._y2=b;break;case 1:this._point=2,this._x3=a,this._y3=b;break;case 2:this._point=3,this._x4=a,this._y4=b,this._context.moveTo((this._x0+4*this._x1+a)/6,(this._y0+4*this._y1+b)/6);break;default:F(this,a,b)}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=b}},I.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var c=(this._x0+4*this._x1+a)/6,d=(this._y0+4*this._y1+b)/6;this._line?this._context.lineTo(c,d):this._context.moveTo(c,d);break;case 3:this._point=4;default:F(this,a,b)}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=b}},J.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var a=this._x,b=this._y,c=a.length-1;if(c>0)for(var d,e=a[0],f=b[0],g=a[c]-e,h=b[c]-f,i=-1;++i<=c;)d=i/c,this._basis.point(this._beta*a[i]+(1-this._beta)*(e+d*g),this._beta*b[i]+(1-this._beta)*(f+d*h));this._x=this._y=null,this._basis.lineEnd()},point:function(a,b){this._x.push(+a),this._y.push(+b)}};var Na=function a(b){function c(a){return 1===b?new G(a):new J(a,b)}return c.beta=function(b){return a(+b)},c}(.85);L.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:K(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2,this._x1=a,this._y1=b;break;case 2:this._point=3;default:K(this,a,b)}this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var Oa=function a(b){function c(a){return new L(a,b)}return c.tension=function(b){return a(+b)},c}(0);M.prototype={areaStart:E,areaEnd:E,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._x3=a,this._y3=b;break;case 1:this._point=2,this._context.moveTo(this._x4=a,this._y4=b);break;case 2:this._point=3,this._x5=a,this._y5=b;break;default:K(this,a,b)}this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var Pa=function a(b){function c(a){return new M(a,b)}return c.tension=function(b){return a(+b)},c}(0);N.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:K(this,a,b)}this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var Qa=function a(b){function c(a){return new N(a,b)}return c.tension=function(b){return a(+b)},c}(0);P.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){if(a=+a,b=+b,this._point){var c=this._x2-a,d=this._y2-b;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(c*c+d*d,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;break;case 2:this._point=3;default:O(this,a,b)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var Ra=function a(b){function c(a){return b?new P(a,b):new L(a,0)}return c.alpha=function(b){return a(+b)},c}(.5);Q.prototype={areaStart:E,areaEnd:E,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(a,b){if(a=+a,b=+b,this._point){var c=this._x2-a,d=this._y2-b;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(c*c+d*d,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=a,this._y3=b;break;case 1:this._point=2,this._context.moveTo(this._x4=a,this._y4=b);break;case 2:this._point=3,this._x5=a,this._y5=b;break;default:O(this,a,b)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var Sa=function a(b){function c(a){return b?new Q(a,b):new M(a,0)}return c.alpha=function(b){return a(+b)},c}(.5);R.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){if(a=+a,b=+b,this._point){var c=this._x2-a,d=this._y2-b;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(c*c+d*d,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:O(this,a,b)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var Ta=function a(b){function c(a){return b?new R(a,b):new N(a,0)}return c.alpha=function(b){return a(+b)},c}(.5);S.prototype={areaStart:E,areaEnd:E,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(a,b){a=+a,b=+b,this._point?this._context.lineTo(a,b):(this._point=1,this._context.moveTo(a,b))}},X.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:W(this,this._t0,V(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){var c=NaN;if(b=+b,(a=+a)!==this._x1||b!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;break;case 2:this._point=3,W(this,V(this,c=U(this,a,b)),c);break;default:W(this,this._t0,c=U(this,a,b))}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=b,this._t0=c}}},(Y.prototype=Object.create(X.prototype)).point=function(a,b){X.prototype.point.call(this,b,a)},Z.prototype={moveTo:function(a,b){this._context.moveTo(b,a)},closePath:function(){this._context.closePath()},lineTo:function(a,b){this._context.lineTo(b,a)},bezierCurveTo:function(a,b,c,d,e,f){this._context.bezierCurveTo(b,a,d,c,f,e)}},$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var a=this._x,b=this._y,c=a.length;if(c)if(this._line?this._context.lineTo(a[0],b[0]):this._context.moveTo(a[0],b[0]),2===c)this._context.lineTo(a[1],b[1]);else for(var d=_(a),e=_(b),f=0,g=1;g<c;++f,++g)this._context.bezierCurveTo(d[0][f],e[0][f],d[1][f],e[1][f],a[g],b[g]);(this._line||0!==this._line&&1===c)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(a,b){this._x.push(+a),this._y.push(+b)}},aa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,b),this._context.lineTo(a,b);else{var c=this._x*(1-this._t)+a*this._t;this._context.lineTo(c,this._y),this._context.lineTo(c,b)}}this._x=a,this._y=b}},a.arc=function(){function a(){var a,c,e,f=+k.apply(this,arguments),g=+l.apply(this,arguments),h=o.apply(this,arguments)-ra,i=p.apply(this,arguments)-ra,s=ia(i-h),t=i>h;if(r||(r=a=b.path()),g<f&&(c=g,g=f,f=c),g>pa)if(s>sa-pa)r.moveTo(g*ka(h),g*na(h)),r.arc(0,0,g,h,i,!t),f>pa&&(r.moveTo(f*ka(i),f*na(i)),r.arc(0,0,f,i,h,t));else{var u,v,w=h,x=i,y=h,z=i,A=s,B=s,C=q.apply(this,arguments)/2,D=C>pa&&(n?+n.apply(this,arguments):oa(f*f+g*g)),E=ma(ia(g-f)/2,+m.apply(this,arguments)),F=E,G=E;if(D>pa){var H=d(D/f*na(C)),I=d(D/g*na(C));(A-=2*H)>pa?(y+=H*=t?1:-1,z-=H):(A=0,y=z=(h+i)/2),(B-=2*I)>pa?(w+=I*=t?1:-1,x-=I):(B=0,w=x=(h+i)/2)}var J=g*ka(w),K=g*na(w),L=f*ka(z),M=f*na(z);if(E>pa){var N,O=g*ka(x),P=g*na(x),Q=f*ka(y),R=f*na(y);if(s<qa&&(N=function(a,b,c,d,e,f,g,h){var i=c-a,j=d-b,k=g-e,l=h-f,m=l*i-k*j;if(!(m*m<pa))return[a+(m=(k*(b-f)-l*(a-e))/m)*i,b+m*j]}(J,K,Q,R,O,P,L,M))){var S=J-N[0],T=K-N[1],U=O-N[0],V=P-N[1],W=1/na(((e=(S*U+T*V)/(oa(S*S+T*T)*oa(U*U+V*V)))>1?0:e<-1?qa:Math.acos(e))/2),X=oa(N[0]*N[0]+N[1]*N[1]);F=ma(E,(f-X)/(W-1)),G=ma(E,(g-X)/(W+1))}}B>pa?G>pa?(u=j(Q,R,J,K,g,G,t),v=j(O,P,L,M,g,G,t),r.moveTo(u.cx+u.x01,u.cy+u.y01),G<E?r.arc(u.cx,u.cy,G,ja(u.y01,u.x01),ja(v.y01,v.x01),!t):(r.arc(u.cx,u.cy,G,ja(u.y01,u.x01),ja(u.y11,u.x11),!t),r.arc(0,0,g,ja(u.cy+u.y11,u.cx+u.x11),ja(v.cy+v.y11,v.cx+v.x11),!t),r.arc(v.cx,v.cy,G,ja(v.y11,v.x11),ja(v.y01,v.x01),!t))):(r.moveTo(J,K),r.arc(0,0,g,w,x,!t)):r.moveTo(J,K),f>pa&&A>pa?F>pa?(u=j(L,M,O,P,f,-F,t),v=j(J,K,Q,R,f,-F,t),r.lineTo(u.cx+u.x01,u.cy+u.y01),F<E?r.arc(u.cx,u.cy,F,ja(u.y01,u.x01),ja(v.y01,v.x01),!t):(r.arc(u.cx,u.cy,F,ja(u.y01,u.x01),ja(u.y11,u.x11),!t),r.arc(0,0,f,ja(u.cy+u.y11,u.cx+u.x11),ja(v.cy+v.y11,v.cx+v.x11),t),r.arc(v.cx,v.cy,F,ja(v.y11,v.x11),ja(v.y01,v.x01),!t))):r.arc(0,0,f,z,y,t):r.lineTo(L,M)}else r.moveTo(0,0);if(r.closePath(),a)return r=null,a+""||null}var k=e,l=f,m=c(0),n=null,o=g,p=h,q=i,r=null;return a.centroid=function(){var a=(+k.apply(this,arguments)+ +l.apply(this,arguments))/2,b=(+o.apply(this,arguments)+ +p.apply(this,arguments))/2-qa/2;return[ka(b)*a,na(b)*a]},a.innerRadius=function(b){return arguments.length?(k="function"==typeof b?b:c(+b),a):k},a.outerRadius=function(b){return arguments.length?(l="function"==typeof b?b:c(+b),a):l},a.cornerRadius=function(b){return arguments.length?(m="function"==typeof b?b:c(+b),a):m},a.padRadius=function(b){return arguments.length?(n=null==b?null:"function"==typeof b?b:c(+b),a):n},a.startAngle=function(b){return arguments.length?(o="function"==typeof b?b:c(+b),a):o},a.endAngle=function(b){return arguments.length?(p="function"==typeof b?b:c(+b),a):p},a.padAngle=function(b){return arguments.length?(q="function"==typeof b?b:c(+b),a):q},a.context=function(b){return arguments.length?(r=null==b?null:b,a):r},a},a.area=p,a.line=o,a.pie=function(){function a(a){var c,i,j,k,l,m=a.length,n=0,o=new Array(m),p=new Array(m),q=+f.apply(this,arguments),r=Math.min(sa,Math.max(-sa,g.apply(this,arguments)-q)),s=Math.min(Math.abs(r)/m,h.apply(this,arguments)),t=s*(r<0?-1:1);for(c=0;c<m;++c)(l=p[o[c]=c]=+b(a[c],c,a))>0&&(n+=l);for(null!=d?o.sort(function(a,b){return d(p[a],p[b])}):null!=e&&o.sort(function(b,c){return e(a[b],a[c])}),c=0,j=n?(r-m*t)/n:0;c<m;++c,q=k)i=o[c],k=q+((l=p[i])>0?l*j:0)+t,p[i]={data:a[i],index:c,value:l,startAngle:q,endAngle:k,padAngle:s};return p}var b=r,d=q,e=null,f=c(0),g=c(sa),h=c(0);return a.value=function(d){return arguments.length?(b="function"==typeof d?d:c(+d),a):b},a.sortValues=function(b){return arguments.length?(d=b,e=null,a):d},a.sort=function(b){return arguments.length?(e=b,d=null,a):e},a.startAngle=function(b){return arguments.length?(f="function"==typeof b?b:c(+b),a):f},a.endAngle=function(b){return arguments.length?(g="function"==typeof b?b:c(+b),a):g},a.padAngle=function(b){return arguments.length?(h="function"==typeof b?b:c(+b),a):h},a},a.areaRadial=w,a.radialArea=w,a.lineRadial=v,a.radialLine=v,a.pointRadial=x,a.linkHorizontal=function(){return A(B)},a.linkVertical=function(){return A(C)},a.linkRadial=function(){var a=A(D);return a.angle=a.x,delete a.x,a.radius=a.y,delete a.y,a},a.symbol=function(){function a(){var a;if(f||(f=a=b.path()),d.apply(this,arguments).draw(f,+e.apply(this,arguments)),a)return f=null,a+""||null}var d=c(va),e=c(64),f=null;return a.type=function(b){return arguments.length?(d="function"==typeof b?b:c(b),a):d},a.size=function(b){return arguments.length?(e="function"==typeof b?b:c(+b),a):e},a.context=function(b){return arguments.length?(f=null==b?null:b,a):f},a},a.symbols=Ma,a.symbolCircle=va,a.symbolCross=wa,a.symbolDiamond=za,a.symbolSquare=Ea,a.symbolStar=Da,a.symbolTriangle=Ga,a.symbolWye=La,a.curveBasisClosed=function(a){return new H(a)},a.curveBasisOpen=function(a){return new I(a)},a.curveBasis=function(a){return new G(a)},a.curveBundle=Na,a.curveCardinalClosed=Pa,a.curveCardinalOpen=Qa,a.curveCardinal=Oa,a.curveCatmullRomClosed=Sa,a.curveCatmullRomOpen=Ta,a.curveCatmullRom=Ra,a.curveLinearClosed=function(a){return new S(a)},a.curveLinear=l,a.curveMonotoneX=function(a){return new X(a)},a.curveMonotoneY=function(a){return new Y(a)},a.curveNatural=function(a){return new $(a)},a.curveStep=function(a){return new aa(a,.5)},a.curveStepAfter=function(a){return new aa(a,1)},a.curveStepBefore=function(a){return new aa(a,0)},a.stack=function(){function a(a){var c,g,h=b.apply(this,arguments),i=a.length,j=h.length,k=new Array(j);for(c=0;c<j;++c){for(var l,m=h[c],n=k[c]=new Array(i),o=0;o<i;++o)n[o]=l=[0,+f(a[o],m,o,a)],l.data=a[o];n.key=m}for(c=0,g=d(k);c<j;++c)k[g[c]].index=c;return e(k,g),k}var b=c([]),d=ca,e=ba,f=da;return a.keys=function(d){return arguments.length?(b="function"==typeof d?d:c(ua.call(d)),a):b},a.value=function(b){return arguments.length?(f="function"==typeof b?b:c(+b),a):f},a.order=function(b){return arguments.length?(d=null==b?ca:"function"==typeof b?b:c(ua.call(b)),a):d},a.offset=function(b){return arguments.length?(e=null==b?ba:b,a):e},a},a.stackOffsetExpand=function(a,b){if((d=a.length)>0){for(var c,d,e,f=0,g=a[0].length;f<g;++f){for(e=c=0;c<d;++c)e+=a[c][f][1]||0;if(e)for(c=0;c<d;++c)a[c][f][1]/=e}ba(a,b)}},a.stackOffsetDiverging=function(a,b){if((h=a.length)>1)for(var c,d,e,f,g,h,i=0,j=a[b[0]].length;i<j;++i)for(f=g=0,c=0;c<h;++c)(e=(d=a[b[c]][i])[1]-d[0])>=0?(d[0]=f,d[1]=f+=e):e<0?(d[1]=g,d[0]=g+=e):d[0]=f},a.stackOffsetNone=ba,a.stackOffsetSilhouette=function(a,b){if((c=a.length)>0){for(var c,d=0,e=a[b[0]],f=e.length;d<f;++d){for(var g=0,h=0;g<c;++g)h+=a[g][d][1]||0;e[d][1]+=e[d][0]=-h/2}ba(a,b)}},a.stackOffsetWiggle=function(a,b){if((e=a.length)>0&&(d=(c=a[b[0]]).length)>0){for(var c,d,e,f=0,g=1;g<d;++g){for(var h=0,i=0,j=0;h<e;++h){for(var k=a[b[h]],l=k[g][1]||0,m=(l-(k[g-1][1]||0))/2,n=0;n<h;++n){var o=a[b[n]];m+=(o[g][1]||0)-(o[g-1][1]||0)}i+=l,j+=m*l}c[g-1][1]+=c[g-1][0]=f,i&&(f-=j/i)}c[g-1][1]+=c[g-1][0]=f,ba(a,b)}},a.stackOrderAppearance=ea,a.stackOrderAscending=ga,a.stackOrderDescending=function(a){return ga(a).reverse()},a.stackOrderInsideOut=function(a){var b,c,d=a.length,e=a.map(ha),f=ea(a),g=0,h=0,i=[],j=[];for(b=0;b<d;++b)c=f[b],g<h?(g+=e[c],i.push(c)):(h+=e[c],j.push(c));return j.reverse().concat(i)},a.stackOrderNone=ca,a.stackOrderReverse=function(a){return ca(a).reverse()},Object.defineProperty(a,"__esModule",{value:!0})},"object"==typeof c&&void 0!==b?e(c,a("d3-path")):e(d.d3=d.d3||{},d.d3)},{"d3-path":160}],163:[function(a,b,c){var d;d=this,function(a){"use strict";function b(){return q||(t(c),q=s.now()+r)}function c(){q=0}function d(){this._call=this._time=this._next=null}function e(a,b,c){var e=new d;return e.restart(a,b,c),e}function f(){b(),++l;for(var a,c=j;c;)(a=q-c._time)>=0&&c._call.call(null,a),c=c._next;--l}function g(){q=(p=s.now())+r,l=m=0;try{f()}finally{l=0,function(){for(var a,b,c=j,d=1/0;c;)c._call?(d>c._time&&(d=c._time),a=c,c=c._next):(b=c._next,c._next=null,c=a?a._next=b:j=b);k=a,i(d)}(),q=0}}function h(){var a=s.now(),b=a-p;b>o&&(r-=b,p=a)}function i(a){l||(m&&(m=clearTimeout(m)),a-q>24?(a<1/0&&(m=setTimeout(g,a-s.now()-r)),n&&(n=clearInterval(n))):(n||(p=s.now(),n=setInterval(h,o)),l=1,t(g)))}var j,k,l=0,m=0,n=0,o=1e3,p=0,q=0,r=0,s="object"==typeof performance&&performance.now?performance:Date,t="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(a){setTimeout(a,17)};d.prototype=e.prototype={constructor:d,restart:function(a,c,d){if("function"!=typeof a)throw new TypeError("callback is not a function");d=(null==d?b():+d)+(null==c?0:+c),this._next||k===this||(k?k._next=this:j=this,k=this),this._call=a,this._time=d,i()},stop:function(){this._call&&(this._call=null,this._time=1/0,i())}},a.now=b,a.timer=e,a.timerFlush=f,a.timeout=function(a,b,c){var e=new d;return b=null==b?0:+b,e.restart(function(c){e.stop(),a(c+b)},b,c),e},a.interval=function(a,c,e){var f=new d,g=c;return null==c?(f.restart(a,c,e),f):(c=+c,e=null==e?b():+e,f.restart(function b(d){d+=g,f.restart(b,g+=c,e),a(d)},c,e),f)},Object.defineProperty(a,"__esModule",{value:!0})}("object"==typeof c&&void 0!==b?c:d.d3=d.d3||{})},{}],164:[function(a,b,c){!function(){function a(a){return a&&(a.ownerDocument||a.document||a).documentElement}function c(a){return a&&(a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView)}function d(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function e(a){return null===a?NaN:+a}function f(a){return!isNaN(a)}function g(a){return{left:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}function h(a){return a.length}function i(a,b){for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}function j(){this._=Object.create(null)}function k(a){return(a+="")===ff||a[0]===gf?gf+a:a}function l(a){return(a+="")[0]===gf?a.slice(1):a}function m(a){return k(a)in this._}function n(a){return(a=k(a))in this._&&delete this._[a]}function o(){var a=[];for(var b in this._)a.push(l(b));return a}function p(){
var a=0;for(var b in this._)++a;return a}function q(){for(var a in this._)return!1;return!0}function r(){this._=Object.create(null)}function s(a){return a}function t(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function u(a,b){if(b in a)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(var c=0,d=hf.length;c<d;++c){var e=hf[c]+b;if(e in a)return e}}function v(){}function w(){}function x(a){function b(){for(var b,d=c,e=-1,f=d.length;++e<f;)(b=d[e].on)&&b.apply(this,arguments);return a}var c=[],d=new j;return b.on=function(b,e){var f,g=d.get(b);return arguments.length<2?g&&g.on:(g&&(g.on=null,c=c.slice(0,f=c.indexOf(g)).concat(c.slice(f+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function y(){We.event.preventDefault()}function z(){for(var a,b=We.event;a=b.sourceEvent;)b=a;return b}function A(a){for(var b=new w,c=0,d=arguments.length;++c<d;)b[arguments[c]]=x(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=We.event;e.target=a,We.event=e,b[e.type].apply(c,d)}finally{We.event=f}}},b}function B(a){return kf(a,of),a}function C(a){return"function"==typeof a?a:function(){return lf(a,this)}}function D(a){return"function"==typeof a?a:function(){return mf(a,this)}}function E(a,b){return a=We.ns.qualify(a),null==b?a.local?function(){this.removeAttributeNS(a.space,a.local)}:function(){this.removeAttribute(a)}:"function"==typeof b?a.local?function(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}:function(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}:a.local?function(){this.setAttributeNS(a.space,a.local,b)}:function(){this.setAttribute(a,b)}}function F(a){return a.trim().replace(/\s+/g," ")}function G(a){return new RegExp("(?:^|\\s+)"+We.requote(a)+"(?:\\s+|$)","g")}function H(a){return(a+"").trim().split(/^|\s+/)}function I(a,b){var c=(a=H(a).map(J)).length;return"function"==typeof b?function(){for(var d=-1,e=b.apply(this,arguments);++d<c;)a[d](this,e)}:function(){for(var d=-1;++d<c;)a[d](this,b)}}function J(a){var b=G(a);return function(c,d){if(e=c.classList)return d?e.add(a):e.remove(a);var e=c.getAttribute("class")||"";d?(b.lastIndex=0,b.test(e)||c.setAttribute("class",F(e+" "+a))):c.setAttribute("class",F(e.replace(b," ")))}}function K(a,b,c){return null==b?function(){this.style.removeProperty(a)}:"function"==typeof b?function(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}:function(){this.style.setProperty(a,b,c)}}function L(a,b){return null==b?function(){delete this[a]}:"function"==typeof b?function(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}:function(){this[a]=b}}function M(a){return"function"==typeof a?a:(a=We.ns.qualify(a)).local?function(){return this.ownerDocument.createElementNS(a.space,a.local)}:function(){var b=this.ownerDocument,c=this.namespaceURI;return c===pf&&b.documentElement.namespaceURI===pf?b.createElement(a):b.createElementNS(c,a)}}function N(){var a=this.parentNode;a&&a.removeChild(this)}function O(a){return{__data__:a}}function P(a){return function(){return nf(this,a)}}function Q(a,b){for(var c=0,d=a.length;c<d;c++)for(var e,f=a[c],g=0,h=f.length;g<h;g++)(e=f[g])&&b(e,g,c);return a}function R(a){return kf(a,rf),a}function S(a,b,c){function d(){var b=this[e];b&&(this.removeEventListener(a,b,b.$),delete this[e])}var e="__on"+a,f=a.indexOf("."),g=T;f>0&&(a=a.slice(0,f));var h=sf.get(a);return h&&(a=h,g=U),f?b?function(){var f=g(b,Ye(arguments));d.call(this),this.addEventListener(a,this[e]=f,f.$=c),f._=b}:d:b?v:function(){var b,c=new RegExp("^__on([^.]+)"+We.requote(a)+"$");for(var d in this)if(b=d.match(c)){var e=this[d];this.removeEventListener(b[1],e,e.$),delete this[d]}}}function T(a,b){return function(c){var d=We.event;We.event=c,b[0]=this.__data__;try{a.apply(this,b)}finally{We.event=d}}}function U(a,b){var c=T(a,b);return function(a){var b=a.relatedTarget;b&&(b===this||8&b.compareDocumentPosition(this))||c.call(this,a)}}function V(b){var d=".dragsuppress-"+ ++uf,e="click"+d,f=We.select(c(b)).on("touchmove"+d,y).on("dragstart"+d,y).on("selectstart"+d,y);if(null==tf&&(tf=!("onselectstart"in b)&&u(b.style,"userSelect")),tf){var g=a(b).style,h=g[tf];g[tf]="none"}return function(a){if(f.on(d,null),tf&&(g[tf]=h),a){var b=function(){f.on(e,null)};f.on(e,function(){y(),b()},!0),setTimeout(b,0)}}}function W(a,b){b.changedTouches&&(b=b.changedTouches[0]);var d=a.ownerSVGElement||a;if(d.createSVGPoint){var e=d.createSVGPoint();if(vf<0){var f=c(a);if(f.scrollX||f.scrollY){var g=(d=We.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();vf=!(g.f||g.e),d.remove()}}return vf?(e.x=b.pageX,e.y=b.pageY):(e.x=b.clientX,e.y=b.clientY),[(e=e.matrixTransform(a.getScreenCTM().inverse())).x,e.y]}var h=a.getBoundingClientRect();return[b.clientX-h.left-a.clientLeft,b.clientY-h.top-a.clientTop]}function X(){return We.event.changedTouches[0].identifier}function Y(a){return a>0?1:a<0?-1:0}function Z(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function $(a){return a>1?0:a<-1?yf:Math.acos(a)}function _(a){return a>1?Bf:a<-1?-Bf:Math.asin(a)}function aa(a){return((a=Math.exp(a))+1/a)/2}function ba(a){return(a=Math.sin(a/2))*a}function ca(){}function da(a,b,c){return this instanceof da?(this.h=+a,this.s=+b,void(this.l=+c)):arguments.length<2?a instanceof da?new da(a.h,a.s,a.l):ra(""+a,sa,da):new da(a,b,c)}function ea(a,b,c){function d(a){return Math.round(255*function(a){return a>360?a-=360:a<0&&(a+=360),a<60?e+(f-e)*a/60:a<180?f:a<240?e+(f-e)*(240-a)/60:e}(a))}var e,f;return a=isNaN(a)?0:(a%=360)<0?a+360:a,b=isNaN(b)?0:b<0?0:b>1?1:b,e=2*(c=c<0?0:c>1?1:c)-(f=c<=.5?c*(1+b):c+b-c*b),new na(d(a+120),d(a),d(a-120))}function fa(a,b,c){return this instanceof fa?(this.h=+a,this.c=+b,void(this.l=+c)):arguments.length<2?a instanceof fa?new fa(a.h,a.c,a.l):ja(a instanceof ha?a.l:(a=ta((a=We.rgb(a)).r,a.g,a.b)).l,a.a,a.b):new fa(a,b,c)}function ga(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),new ha(c,Math.cos(a*=Cf)*b,Math.sin(a)*b)}function ha(a,b,c){return this instanceof ha?(this.l=+a,this.a=+b,void(this.b=+c)):arguments.length<2?a instanceof ha?new ha(a.l,a.a,a.b):a instanceof fa?ga(a.h,a.c,a.l):ta((a=na(a)).r,a.g,a.b):new ha(a,b,c)}function ia(a,b,c){var d=(a+16)/116,e=d+b/500,f=d-c/200;return new na(ma(3.2404542*(e=ka(e)*Lf)-1.5371385*(d=ka(d)*Mf)-.4985314*(f=ka(f)*Nf)),ma(-.969266*e+1.8760108*d+.041556*f),ma(.0556434*e-.2040259*d+1.0572252*f))}function ja(a,b,c){return a>0?new fa(Math.atan2(c,b)*Df,Math.sqrt(b*b+c*c),a):new fa(NaN,NaN,a)}function ka(a){return a>.206893034?a*a*a:(a-4/29)/7.787037}function la(a){return a>.008856?Math.pow(a,1/3):7.787037*a+4/29}function ma(a){return Math.round(255*(a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function na(a,b,c){return this instanceof na?(this.r=~~a,this.g=~~b,void(this.b=~~c)):arguments.length<2?a instanceof na?new na(a.r,a.g,a.b):ra(""+a,na,ea):new na(a,b,c)}function oa(a){return new na(a>>16,a>>8&255,255&a)}function pa(a){return oa(a)+""}function qa(a){return a<16?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function ra(a,b,c){var d,e,f,g=0,h=0,i=0;if(d=/([a-z]+)\((.*)\)/.exec(a=a.toLowerCase()))switch(e=d[2].split(","),d[1]){case"hsl":return c(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100);case"rgb":return b(va(e[0]),va(e[1]),va(e[2]))}return(f=Qf.get(a))?b(f.r,f.g,f.b):(null==a||"#"!==a.charAt(0)||isNaN(f=parseInt(a.slice(1),16))||(4===a.length?(g=(3840&f)>>4,g|=g>>4,h=240&f,h|=h>>4,i=15&f,i|=i<<4):7===a.length&&(g=(16711680&f)>>16,h=(65280&f)>>8,i=255&f)),b(g,h,i))}function sa(a,b,c){var d,e,f=Math.min(a/=255,b/=255,c/=255),g=Math.max(a,b,c),h=g-f,i=(g+f)/2;return h?(e=i<.5?h/(g+f):h/(2-g-f),d=a==g?(b-c)/h+(b<c?6:0):b==g?(c-a)/h+2:(a-b)/h+4,d*=60):(d=NaN,e=i>0&&i<1?0:d),new da(d,e,i)}function ta(a,b,c){var d=la((.4124564*(a=ua(a))+.3575761*(b=ua(b))+.1804375*(c=ua(c)))/Lf),e=la((.2126729*a+.7151522*b+.072175*c)/Mf);return ha(116*e-16,500*(d-e),200*(e-la((.0193339*a+.119192*b+.9503041*c)/Nf)))}function ua(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function va(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}function wa(a){return"function"==typeof a?a:function(){return a}}function xa(a){return function(b,c,d){return 2===arguments.length&&"function"==typeof c&&(d=c,c=null),ya(b,c,a,d)}}function ya(a,b,c,d){function e(){var a,b=i.status;if(!b&&function(a){var b=a.responseType;return b&&"text"!==b?a.response:a.responseText}(i)||b>=200&&b<300||304===b){try{a=c.call(f,i)}catch(a){return void g.error.call(f,a)}g.load.call(f,a)}else g.error.call(f,i)}var f={},g=We.dispatch("beforesend","progress","load","error"),h={},i=new XMLHttpRequest,j=null;return!this.XDomainRequest||"withCredentials"in i||!/^(http(s)?:)?\/\//.test(a)||(i=new XDomainRequest),"onload"in i?i.onload=i.onerror=e:i.onreadystatechange=function(){i.readyState>3&&e()},i.onprogress=function(a){var b=We.event;We.event=a;try{g.progress.call(f,i)}finally{We.event=b}},f.header=function(a,b){return a=(a+"").toLowerCase(),arguments.length<2?h[a]:(null==b?delete h[a]:h[a]=b+"",f)},f.mimeType=function(a){return arguments.length?(b=null==a?null:a+"",f):b},f.responseType=function(a){return arguments.length?(j=a,f):j},f.response=function(a){return c=a,f},["get","post"].forEach(function(a){f[a]=function(){return f.send.apply(f,[a].concat(Ye(arguments)))}}),f.send=function(c,d,e){if(2===arguments.length&&"function"==typeof d&&(e=d,d=null),i.open(c,a,!0),null==b||"accept"in h||(h.accept=b+",*/*"),i.setRequestHeader)for(var k in h)i.setRequestHeader(k,h[k]);return null!=b&&i.overrideMimeType&&i.overrideMimeType(b),null!=j&&(i.responseType=j),null!=e&&f.on("error",e).on("load",function(a){e(null,a)}),g.beforesend.call(f,i),i.send(null==d?null:d),f},f.abort=function(){return i.abort(),f},We.rebind(f,g,"on"),null==d?f:f.get(function(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}(d))}function za(a,b,c){var d=arguments.length;d<2&&(b=0),d<3&&(c=Date.now());var e={c:a,t:c+b,n:null};return Sf?Sf.n=e:Rf=e,Sf=e,Tf||(Uf=clearTimeout(Uf),Tf=1,Vf(Aa)),e}function Aa(){var a=Ba(),b=Ca()-a;b>24?(isFinite(b)&&(clearTimeout(Uf),Uf=setTimeout(Aa,b)),Tf=0):(Tf=1,Vf(Aa))}function Ba(){for(var a=Date.now(),b=Rf;b;)a>=b.t&&b.c(a-b.t)&&(b.c=null),b=b.n;return a}function Ca(){for(var a,b=Rf,c=1/0;b;)b.c?(b.t<c&&(c=b.t),b=(a=b).n):b=a?a.n=b.n:Rf=b.n;return Sf=a,c}function Da(a,b){return b-(a?Math.ceil(Math.log(a)/Math.LN10):1)}function Ea(a){return a+""}function Fa(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ga(a,b,c){function d(b){var c=a(b),d=f(c,1);return b-c<d-b?c:d}function e(c){return b(c=a(new $f(c-1)),1),c}function f(a,c){return b(a=new $f(+a),c),a}function g(a,d,f){var g=e(a),h=[];if(f>1)for(;g<d;)c(g)%f||h.push(new Date(+g)),b(g,1);else for(;g<d;)h.push(new Date(+g)),b(g,1);return h}a.floor=a,a.round=d,a.ceil=e,a.offset=f,a.range=g;var h=a.utc=Ha(a);return h.floor=h,h.round=Ha(d),h.ceil=Ha(e),h.offset=Ha(f),h.range=function(a,b,c){try{$f=Fa;var d=new Fa;return d._=a,g(d,b,c)}finally{$f=Date}},a}function Ha(a){return function(b,c){try{$f=Fa;var d=new Fa;return d._=b,a(d,c)._}finally{$f=Date}}}function Ia(a,b,c){var d=a<0?"-":"",e=(d?-a:a)+"",f=e.length;return d+(f<c?new Array(c-f+1).join(b)+e:e)}function Ja(a){return new RegExp("^(?:"+a.map(We.requote).join("|")+")","i")}function Ka(a){for(var b=new j,c=-1,d=a.length;++c<d;)b.set(a[c].toLowerCase(),c);return b}function La(a,b,c){bg.lastIndex=0;var d=bg.exec(b.slice(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function Ma(a,b,c){bg.lastIndex=0;var d=bg.exec(b.slice(c));return d?(a.U=+d[0],c+d[0].length):-1}function Na(a,b,c){bg.lastIndex=0;var d=bg.exec(b.slice(c));return d?(a.W=+d[0],c+d[0].length):-1}function Oa(a,b,c){bg.lastIndex=0;var d=bg.exec(b.slice(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function Pa(a,b,c){bg.lastIndex=0;var d,e=bg.exec(b.slice(c,c+2));return e?(a.y=(d=+e[0])+(d>68?1900:2e3),c+e[0].length):-1}function Qa(a,b,c){return/^[+-]\d{4}$/.test(b=b.slice(c,c+5))?(a.Z=-b,c+5):-1}function Ra(a,b,c){bg.lastIndex=0;var d=bg.exec(b.slice(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function Sa(a,b,c){bg.lastIndex=0;var d=bg.exec(b.slice(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function Ta(a,b,c){bg.lastIndex=0;var d=bg.exec(b.slice(c,c+3));return d?(a.j=+d[0],c+d[0].length):-1}function Ua(a,b,c){bg.lastIndex=0;var d=bg.exec(b.slice(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function Va(a,b,c){bg.lastIndex=0;var d=bg.exec(b.slice(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function Wa(a,b,c){bg.lastIndex=0;var d=bg.exec(b.slice(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function Xa(a,b,c){bg.lastIndex=0;var d=bg.exec(b.slice(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function Ya(a){var b=a.getTimezoneOffset(),c=b>0?"-":"+",d=ef(b)/60|0,e=ef(b)%60;return c+Ia(d,"0",2)+Ia(e,"0",2)}function Za(a,b,c){cg.lastIndex=0;var d=cg.exec(b.slice(c,c+1));return d?c+d[0].length:-1}function $a(a){for(var b=a.length,c=-1;++c<b;)a[c][0]=this(a[c][0]);return function(b){for(var c=0,d=a[c];!d[1](b);)d=a[++c];return d[0](b)}}function _a(){}function ab(a,b,c){var d=c.s=a+b,e=d-a,f=d-e;c.t=a-f+(b-e)}function bb(a,b){a&&gg.hasOwnProperty(a.type)&&gg[a.type](a,b)}function cb(a,b,c){var d,e=-1,f=a.length-c;for(b.lineStart();++e<f;)d=a[e],b.point(d[0],d[1],d[2]);b.lineEnd()}function db(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)cb(a[c],b,1);b.polygonEnd()}function eb(){function a(a,b){b=b*Cf/2+yf/4;var c=(a*=Cf)-d,g=c>=0?1:-1,h=g*c,i=Math.cos(b),j=Math.sin(b),k=f*j,l=e*i+k*Math.cos(h),m=k*g*Math.sin(h);tg.add(Math.atan2(m,l)),d=a,e=i,f=j}var b,c,d,e,f;ug.point=function(g,h){ug.point=a,d=(b=g)*Cf,e=Math.cos(h=(c=h)*Cf/2+yf/4),f=Math.sin(h)},ug.lineEnd=function(){a(b,c)}}function fb(a){var b=a[0],c=a[1],d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}function gb(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function hb(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function ib(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function jb(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function kb(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b,a[1]/=b,a[2]/=b}function lb(a){return[Math.atan2(a[1],a[0]),_(a[2])]}function mb(a,b){return ef(a[0]-b[0])<wf&&ef(a[1]-b[1])<wf}function nb(a,b){a*=Cf;var c=Math.cos(b*=Cf);ob(c*Math.cos(a),c*Math.sin(a),Math.sin(b))}function ob(a,b,c){kg+=(a-kg)/++ig,lg+=(b-lg)/ig,mg+=(c-mg)/ig}function pb(){function a(a,e){a*=Cf;var f=Math.cos(e*=Cf),g=f*Math.cos(a),h=f*Math.sin(a),i=Math.sin(e),j=Math.atan2(Math.sqrt((j=c*i-d*h)*j+(j=d*g-b*i)*j+(j=b*h-c*g)*j),b*g+c*h+d*i);jg+=j,ng+=j*(b+(b=g)),og+=j*(c+(c=h)),pg+=j*(d+(d=i)),ob(b,c,d)}var b,c,d;vg.point=function(e,f){e*=Cf;var g=Math.cos(f*=Cf);b=g*Math.cos(e),c=g*Math.sin(e),d=Math.sin(f),vg.point=a,ob(b,c,d)}}function qb(){vg.point=nb}function rb(){function a(a,b){a*=Cf;var c=Math.cos(b*=Cf),g=c*Math.cos(a),h=c*Math.sin(a),i=Math.sin(b),j=e*i-f*h,k=f*g-d*i,l=d*h-e*g,m=Math.sqrt(j*j+k*k+l*l),n=d*g+e*h+f*i,o=m&&-$(n)/m,p=Math.atan2(m,n);qg+=o*j,rg+=o*k,sg+=o*l,jg+=p,ng+=p*(d+(d=g)),og+=p*(e+(e=h)),pg+=p*(f+(f=i)),ob(d,e,f)}var b,c,d,e,f;vg.point=function(g,h){b=g,c=h,vg.point=a,g*=Cf;var i=Math.cos(h*=Cf);d=i*Math.cos(g),e=i*Math.sin(g),f=Math.sin(h),ob(d,e,f)},vg.lineEnd=function(){a(b,c),vg.lineEnd=qb,vg.point=nb}}function sb(a,b){function c(c,d){return c=a(c,d),b(c[0],c[1])}return a.invert&&b.invert&&(c.invert=function(c,d){return(c=b.invert(c,d))&&a.invert(c[0],c[1])}),c}function tb(){return!0}function ub(a,b,c,d,e){var f=[],g=[];if(a.forEach(function(a){if(!((b=a.length-1)<=0)){var b,c=a[0],d=a[b];if(mb(c,d)){e.lineStart();for(var h=0;h<b;++h)e.point((c=a[h])[0],c[1]);e.lineEnd()}else{var i=new wb(c,a,null,!0),j=new wb(c,null,i,!1);i.o=j,f.push(i),g.push(j),i=new wb(d,a,null,!1),j=new wb(d,null,i,!0),i.o=j,f.push(i),g.push(j)}}}),g.sort(b),vb(f),vb(g),f.length){for(var h=0,i=c,j=g.length;h<j;++h)g[h].e=i=!i;for(var k,l,m=f[0];;){for(var n=m,o=!0;n.v;)if((n=n.n)===m)return;k=n.z,e.lineStart();do{if(n.v=n.o.v=!0,n.e){if(o)for(h=0,j=k.length;h<j;++h)e.point((l=k[h])[0],l[1]);else d(n.x,n.n.x,1,e);n=n.n}else{if(o)for(h=(k=n.p.z).length-1;h>=0;--h)e.point((l=k[h])[0],l[1]);else d(n.x,n.p.x,-1,e);n=n.p}k=(n=n.o).z,o=!o}while(!n.v);e.lineEnd()}}}function vb(a){if(b=a.length){for(var b,c,d=0,e=a[0];++d<b;)e.n=c=a[d],c.p=e,e=c;e.n=c=a[0],c.p=e}}function wb(a,b,c,d){this.x=a,this.z=b,this.o=c,this.e=d,this.v=!1,this.n=this.p=null}function xb(a,b,c,d){return function(e,f){function g(b,c){var d=e(b,c);a(b=d[0],c=d[1])&&f.point(b,c)}function h(a,b){var c=e(a,b);q.point(c[0],c[1])}function i(){s.point=h,q.lineStart()}function j(){s.point=g,q.lineEnd()}function k(a,b){p.push([a,b]);var c=e(a,b);u.point(c[0],c[1])}function l(){u.lineStart(),p=[]}function m(){k(p[0][0],p[0][1]),u.lineEnd();var a,b=u.clean(),c=t.buffer(),d=c.length;if(p.pop(),o.push(p),p=null,d)if(1&b){var e,g=-1;if((d=(a=c[0]).length-1)>0){for(v||(f.polygonStart(),v=!0),f.lineStart();++g<d;)f.point((e=a[g])[0],e[1]);f.lineEnd()}}else d>1&&2&b&&c.push(c.pop().concat(c.shift())),n.push(c.filter(yb))}var n,o,p,q=b(f),r=e.invert(d[0],d[1]),s={point:g,lineStart:i,lineEnd:j,polygonStart:function(){s.point=k,s.lineStart=l,s.lineEnd=m,n=[],o=[]},polygonEnd:function(){s.point=g,s.lineStart=i,s.lineEnd=j,n=We.merge(n);var a=function(a,b){var c=a[0],d=a[1],e=[Math.sin(c),-Math.cos(c),0],f=0,g=0;tg.reset();for(var h=0,i=b.length;h<i;++h){var j=b[h],k=j.length;if(k)for(var l=j[0],m=l[0],n=l[1]/2+yf/4,o=Math.sin(n),p=Math.cos(n),q=1;;){q===k&&(q=0);var r=(a=j[q])[0],s=a[1]/2+yf/4,t=Math.sin(s),u=Math.cos(s),v=r-m,w=v>=0?1:-1,x=w*v,y=x>yf,z=o*t;if(tg.add(Math.atan2(z*w*Math.sin(x),p*u+z*Math.cos(x))),f+=y?v+w*zf:v,y^m>=c^r>=c){var A=hb(fb(l),fb(a));kb(A);var B=hb(e,A);kb(B);var C=(y^v>=0?-1:1)*_(B[2]);(d>C||d===C&&(A[0]||A[1]))&&(g+=y^v>=0?1:-1)}if(!q++)break;m=r,o=t,p=u,l=a}}return(f<-wf||f<wf&&tg<-wf)^1&g}(r,o);n.length?(v||(f.polygonStart(),v=!0),ub(n,Ab,a,c,f)):a&&(v||(f.polygonStart(),v=!0),f.lineStart(),c(null,null,1,f),f.lineEnd()),v&&(f.polygonEnd(),v=!1),n=o=null},sphere:function(){f.polygonStart(),f.lineStart(),c(null,null,1,f),f.lineEnd(),f.polygonEnd()}},t=zb(),u=b(t),v=!1;return s}}function yb(a){return a.length>1}function zb(){var a,b=[];return{lineStart:function(){b.push(a=[])},point:function(b,c){a.push([b,c])},lineEnd:v,buffer:function(){var c=b;return b=[],a=null,c},rejoin:function(){b.length>1&&b.push(b.pop().concat(b.shift()))}}}function Ab(a,b){return((a=a.x)[0]<0?a[1]-Bf-wf:Bf-a[1])-((b=b.x)[0]<0?b[1]-Bf-wf:Bf-b[1])}function Bb(a,b,c,d){return function(e){var f,g=e.a,h=e.b,i=g.x,j=g.y,k=0,l=1,m=h.x-i,n=h.y-j;if(f=a-i,m||!(f>0)){if(f/=m,m<0){if(f<k)return;f<l&&(l=f)}else if(m>0){if(f>l)return;f>k&&(k=f)}if(f=c-i,m||!(f<0)){if(f/=m,m<0){if(f>l)return;f>k&&(k=f)}else if(m>0){if(f<k)return;f<l&&(l=f)}if(f=b-j,n||!(f>0)){if(f/=n,n<0){if(f<k)return;f<l&&(l=f)}else if(n>0){if(f>l)return;f>k&&(k=f)}if(f=d-j,n||!(f<0)){if(f/=n,n<0){if(f>l)return;f>k&&(k=f)}else if(n>0){if(f<k)return;f<l&&(l=f)}return k>0&&(e.a={x:i+k*m,y:j+k*n}),l<1&&(e.b={x:i+l*m,y:j+l*n}),e}}}}}}function Cb(a,b,c,d){function e(d,e){return ef(d[0]-a)<wf?e>0?0:3:ef(d[0]-c)<wf?e>0?2:1:ef(d[1]-b)<wf?e>0?1:0:e>0?3:2}function f(a,b){return g(a.x,b.x)}function g(a,b){var c=e(a,1),d=e(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(h){function i(f,h,i,j){var k=0,l=0;if(null==f||(k=e(f,i))!==(l=e(h,i))||g(f,h)<0^i>0)do{j.point(0===k||3===k?a:c,k>1?d:b)}while((k=(k+i+4)%4)!==l);else j.point(h[0],h[1])}function j(e,f){return a<=e&&e<=c&&b<=f&&f<=d}function k(a,b){j(a,b)&&h.point(a,b)}function l(a,b){var c=j(a=Math.max(-xg,Math.min(xg,a)),b=Math.max(-xg,Math.min(xg,b)));if(n&&o.push([a,b]),v)p=a,q=b,r=c,v=!1,c&&(h.lineStart(),h.point(a,b));else if(c&&u)h.point(a,b);else{var d={a:{x:s,y:t},b:{x:a,y:b}};z(d)?(u||(h.lineStart(),h.point(d.a.x,d.a.y)),h.point(d.b.x,d.b.y),c||h.lineEnd(),w=!1):c&&(h.lineStart(),h.point(a,b),w=!1)}s=a,t=b,u=c}var m,n,o,p,q,r,s,t,u,v,w,x=h,y=zb(),z=Bb(a,b,c,d),A={point:k,lineStart:function(){A.point=l,n&&n.push(o=[]),v=!0,u=!1,s=t=NaN},lineEnd:function(){m&&(l(p,q),r&&u&&y.rejoin(),m.push(y.buffer())),A.point=k,u&&h.lineEnd()},polygonStart:function(){h=y,m=[],n=[],w=!0},polygonEnd:function(){h=x,m=We.merge(m);var b=function(a){for(var b=0,c=n.length,d=a[1],e=0;e<c;++e)for(var f,g=1,h=n[e],i=h.length,j=h[0];g<i;++g)f=h[g],j[1]<=d?f[1]>d&&Z(j,f,a)>0&&++b:f[1]<=d&&Z(j,f,a)<0&&--b,j=f;return 0!==b}([a,d]),c=w&&b,e=m.length;(c||e)&&(h.polygonStart(),c&&(h.lineStart(),i(null,null,1,h),h.lineEnd()),e&&ub(m,f,b,i,h),h.polygonEnd()),m=n=o=null}};return A}}function Db(a){var b=0,c=yf/3,d=Rb(a),e=d(b,c);return e.parallels=function(a){return arguments.length?d(b=a[0]*yf/180,c=a[1]*yf/180):[b/yf*180,c/yf*180]},e}function Eb(a,b){function c(a,b){var c=Math.sqrt(f-2*e*Math.sin(b))/e;return[c*Math.sin(a*=e),g-c*Math.cos(a)]}var d=Math.sin(a),e=(d+Math.sin(b))/2,f=1+d*(2*e-d),g=Math.sqrt(f)/e;return c.invert=function(a,b){var c=g-b;return[Math.atan2(a,c)/e,_((f-(a*a+c*c)*e*e)/(2*e))]},c}function Fb(){function a(a,b){zg+=e*a-d*b,d=a,e=b}var b,c,d,e;Fg.point=function(f,g){Fg.point=a,b=d=f,c=e=g},Fg.lineEnd=function(){a(b,c)}}function Gb(){function a(a,b){g.push("M",a,",",b,f)}function b(a,b){g.push("M",a,",",b),h.point=c}function c(a,b){g.push("L",a,",",b)}function d(){h.point=a}function e(){g.push("Z")}var f=Hb(4.5),g=[],h={point:a,lineStart:function(){h.point=b},lineEnd:d,polygonStart:function(){h.lineEnd=e},polygonEnd:function(){h.lineEnd=d,h.point=a},pointRadius:function(a){return f=Hb(a),h},result:function(){if(g.length){var a=g.join("");return g=[],a}}};return h}function Hb(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function Ib(a,b){kg+=a,lg+=b,++mg}function Jb(){function a(a,d){var e=a-b,f=d-c,g=Math.sqrt(e*e+f*f);ng+=g*(b+a)/2,og+=g*(c+d)/2,pg+=g,Ib(b=a,c=d)}var b,c;Hg.point=function(d,e){Hg.point=a,Ib(b=d,c=e)}}function Kb(){Hg.point=Ib}function Lb(){function a(a,b){var c=a-d,f=b-e,g=Math.sqrt(c*c+f*f);ng+=g*(d+a)/2,og+=g*(e+b)/2,pg+=g,qg+=(g=e*a-d*b)*(d+a),rg+=g*(e+b),sg+=3*g,Ib(d=a,e=b)}var b,c,d,e;Hg.point=function(f,g){Hg.point=a,Ib(b=d=f,c=e=g)},Hg.lineEnd=function(){a(b,c)}}function Mb(a){function b(b,c){a.moveTo(b+g,c),a.arc(b,c,g,0,zf)}function c(b,c){a.moveTo(b,c),h.point=d}function d(b,c){a.lineTo(b,c)}function e(){h.point=b}function f(){a.closePath()}var g=4.5,h={point:b,lineStart:function(){h.point=c},lineEnd:e,polygonStart:function(){h.lineEnd=f},polygonEnd:function(){h.lineEnd=e,h.point=b},pointRadius:function(a){return g=a,h},result:v};return h}function Nb(a){function b(b){return(f?function(b){function d(c,d){c=a(c,d),b.point(c[0],c[1])}function e(){s=NaN,x.point=g,b.lineStart()}function g(d,e){var g=fb([d,e]),h=a(d,e);c(s,t,r,u,v,w,s=h[0],t=h[1],r=d,u=g[0],v=g[1],w=g[2],f,b),b.point(s,t)}function h(){x.point=d,b.lineEnd()}function i(){e(),x.point=j,x.lineEnd=k}function j(a,b){g(l=a,b),m=s,n=t,o=u,p=v,q=w,x.point=g}function k(){c(s,t,r,u,v,w,m,n,l,o,p,q,f,b),x.lineEnd=h,h()}var l,m,n,o,p,q,r,s,t,u,v,w,x={point:d,lineStart:e,lineEnd:h,polygonStart:function(){b.polygonStart(),x.lineStart=i},polygonEnd:function(){b.polygonEnd(),x.lineStart=e}};return x}:function(b){return Pb(b,function(c,d){c=a(c,d),b.point(c[0],c[1])})})(b)}function c(b,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=k-b,t=l-f,u=s*s+t*t;if(u>4*d&&q--){var v=h+n,w=i+o,x=j+p,y=Math.sqrt(v*v+w*w+x*x),z=Math.asin(x/=y),A=ef(ef(x)-1)<wf||ef(g-m)<wf?(g+m)/2:Math.atan2(w,v),B=a(A,z),C=B[0],D=B[1],E=C-b,F=D-f,G=t*E-s*F;(G*G/u>d||ef((s*E+t*F)/u-.5)>.3||h*n+i*o+j*p<e)&&(c(b,f,g,h,i,j,C,D,A,v/=y,w/=y,x,q,r),r.point(C,D),c(C,D,A,v,w,x,k,l,m,n,o,p,q,r))}}var d=.5,e=Math.cos(30*Cf),f=16;return b.precision=function(a){return arguments.length?(f=(d=a*a)>0&&16,b):Math.sqrt(d)},b}function Ob(a){this.stream=a}function Pb(a,b){return{point:b,sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function Qb(a){return Rb(function(){return a})()}function Rb(a){function b(a){return[(a=h(a[0]*Cf,a[1]*Cf))[0]*m+i,j-a[1]*m]}function c(a){return(a=h.invert((a[0]-i)/m,(j-a[1])/m))&&[a[0]*Df,a[1]*Df]}function d(){h=sb(g=Vb(r,t,u),f);var a=f(p,q);return i=n-a[0]*m,j=o+a[1]*m,e()}function e(){return k&&(k.valid=!1,k=null),b}var f,g,h,i,j,k,l=Nb(function(a,b){return[(a=f(a,b))[0]*m+i,j-a[1]*m]}),m=150,n=480,o=250,p=0,q=0,r=0,t=0,u=0,v=wg,w=s,x=null,y=null;return b.stream=function(a){return k&&(k.valid=!1),(k=Sb(v(g,l(w(a))))).valid=!0,k},b.clipAngle=function(a){return arguments.length?(v=null==a?(x=a,wg):function(a){function b(a,b){return Math.cos(a)*Math.cos(b)>e}function c(a,b,c){var d=[1,0,0],f=hb(fb(a),fb(b)),g=gb(f,f),h=f[0],i=g-h*h;if(!i)return!c&&a;var j=e*g/i,k=-e*h/i,l=hb(d,f),m=jb(d,j);ib(m,jb(f,k));var n=l,o=gb(m,n),p=gb(n,n),q=o*o-p*(gb(m,m)-1);if(!(q<0)){var r=Math.sqrt(q),s=jb(n,(-o-r)/p);if(ib(s,m),s=lb(s),!c)return s;var t,u=a[0],v=b[0],w=a[1],x=b[1];v<u&&(t=u,u=v,v=t);var y=v-u,z=ef(y-yf)<wf;if(!z&&x<w&&(t=w,w=x,x=t),z||y<wf?z?w+x>0^s[1]<(ef(s[0]-u)<wf?w:x):w<=s[1]&&s[1]<=x:y>yf^(u<=s[0]&&s[0]<=v)){var A=jb(n,(-o+r)/p);return ib(A,m),[s,lb(A)]}}}function d(b,c){var d=f?a:yf-a,e=0;return b<-d?e|=1:b>d&&(e|=2),c<-d?e|=4:c>d&&(e|=8),e}var e=Math.cos(a),f=e>0,g=ef(e)>wf;return xb(b,function(a){var e,h,i,j,k;return{lineStart:function(){j=i=!1,k=1},point:function(l,m){var n,o=[l,m],p=b(l,m),q=f?p?0:d(l,m):p?d(l+(l<0?yf:-yf),m):0;if(!e&&(j=i=p)&&a.lineStart(),p!==i&&(n=c(e,o),(mb(e,n)||mb(o,n))&&(o[0]+=wf,o[1]+=wf,p=b(o[0],o[1]))),p!==i)k=0,p?(a.lineStart(),n=c(o,e),a.point(n[0],n[1])):(n=c(e,o),a.point(n[0],n[1]),a.lineEnd()),e=n;else if(g&&e&&f^p){var r;q&h||!(r=c(o,e,!0))||(k=0,f?(a.lineStart(),a.point(r[0][0],r[0][1]),a.point(r[1][0],r[1][1]),a.lineEnd()):(a.point(r[1][0],r[1][1]),a.lineEnd(),a.lineStart(),a.point(r[0][0],r[0][1])))}!p||e&&mb(e,o)||a.point(o[0],o[1]),e=o,i=p,h=q},lineEnd:function(){i&&a.lineEnd(),e=null},clean:function(){return k|(j&&i)<<1}}},Zb(a,6*Cf),f?[0,-a]:[-yf,a-yf])}((x=+a)*Cf),e()):x},b.clipExtent=function(a){return arguments.length?(y=a,w=a?Cb(a[0][0],a[0][1],a[1][0],a[1][1]):s,e()):y},b.scale=function(a){return arguments.length?(m=+a,d()):m},b.translate=function(a){return arguments.length?(n=+a[0],o=+a[1],d()):[n,o]},b.center=function(a){return arguments.length?(p=a[0]%360*Cf,q=a[1]%360*Cf,d()):[p*Df,q*Df]},b.rotate=function(a){return arguments.length?(r=a[0]%360*Cf,t=a[1]%360*Cf,u=a.length>2?a[2]%360*Cf:0,d()):[r*Df,t*Df,u*Df]},We.rebind(b,l,"precision"),function(){return f=a.apply(this,arguments),b.invert=f.invert&&c,d()}}function Sb(a){return Pb(a,function(b,c){a.point(b*Cf,c*Cf)})}function Tb(a,b){return[a,b]}function Ub(a,b){return[a>yf?a-zf:a<-yf?a+zf:a,b]}function Vb(a,b,c){return a?b||c?sb(Xb(a),Yb(b,c)):Xb(a):b||c?Yb(b,c):Ub}function Wb(a){return function(b,c){return[(b+=a)>yf?b-zf:b<-yf?b+zf:b,c]}}function Xb(a){var b=Wb(a);return b.invert=Wb(-a),b}function Yb(a,b){function c(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*d+h*e;return[Math.atan2(i*f-k*g,h*d-j*e),_(k*f+i*g)]}var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b);return c.invert=function(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*f-i*g;return[Math.atan2(i*f+j*g,h*d+k*e),_(k*d-h*e)]},c}function Zb(a,b){var c=Math.cos(a),d=Math.sin(a);return function(e,f,g,h){var i=g*b;null!=e?(e=$b(c,e),f=$b(c,f),(g>0?e<f:e>f)&&(e+=g*zf)):(e=a+g*zf,f=a-.5*i);for(var j,k=e;g>0?k>f:k<f;k-=i)h.point((j=lb([c,-d*Math.cos(k),-d*Math.sin(k)]))[0],j[1])}}function $b(a,b){var c=fb(b);c[0]-=a,kb(c);var d=$(-c[1]);return((-c[2]<0?-d:d)+2*Math.PI-wf)%(2*Math.PI)}function _b(a,b,c){var d=We.range(a,b-wf,c).concat(b);return function(a){return d.map(function(b){return[a,b]})}}function ac(a,b,c){var d=We.range(a,b-wf,c).concat(b);return function(a){return d.map(function(b){return[b,a]})}}function bc(a){return a.source}function cc(a){return a.target}function dc(a,b){function c(b,c){var d=Math.cos(b),e=Math.cos(c),f=a(d*e);return[f*e*Math.sin(b),f*Math.sin(c)]}return c.invert=function(a,c){var d=Math.sqrt(a*a+c*c),e=b(d),f=Math.sin(e),g=Math.cos(e);return[Math.atan2(a*f,d*g),Math.asin(d&&c*f/d)]},c}function ec(a,b){function c(a,b){g>0?b<-Bf+wf&&(b=-Bf+wf):b>Bf-wf&&(b=Bf-wf);var c=g/Math.pow(e(b),f);return[c*Math.sin(f*a),g-c*Math.cos(f*a)]}var d=Math.cos(a),e=function(a){return Math.tan(yf/4+a/2)},f=a===b?Math.sin(a):Math.log(d/Math.cos(b))/Math.log(e(b)/e(a)),g=d*Math.pow(e(a),f)/f;return f?(c.invert=function(a,b){var c=g-b,d=Y(f)*Math.sqrt(a*a+c*c);return[Math.atan2(a,c)/f,2*Math.atan(Math.pow(g/d,1/f))-Bf]},c):gc}function fc(a,b){function c(a,b){var c=f-b;return[c*Math.sin(e*a),f-c*Math.cos(e*a)]}var d=Math.cos(a),e=a===b?Math.sin(a):(d-Math.cos(b))/(b-a),f=d/e+a;return ef(e)<wf?Tb:(c.invert=function(a,b){var c=f-b;return[Math.atan2(a,c)/e,f-Y(e)*Math.sqrt(a*a+c*c)]},c)}function gc(a,b){return[a,Math.log(Math.tan(yf/4+b/2))]}function hc(a){var b,c=Qb(a),d=c.scale,e=c.translate,f=c.clipExtent;return c.scale=function(){var a=d.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.translate=function(){var a=e.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.clipExtent=function(a){var g=f.apply(c,arguments);if(g===c){if(b=null==a){var h=yf*d(),i=e();f([[i[0]-h,i[1]-h],[i[0]+h,i[1]+h]])}}else b&&(g=null);return g},c.clipExtent(null)}function ic(a,b){return[Math.log(Math.tan(yf/4+b/2)),-a]}function jc(a){return a[0]}function kc(a){return a[1]}function lc(a){for(var b=a.length,c=[0,1],d=2,e=2;e<b;e++){for(;d>1&&Z(a[c[d-2]],a[c[d-1]],a[e])<=0;)--d;c[d++]=e}return c.slice(0,d)}function mc(a,b){return a[0]-b[0]||a[1]-b[1]}function nc(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function oc(a,b,c,d){var e=a[0],f=c[0],g=b[0]-e,h=d[0]-f,i=a[1],j=c[1],k=b[1]-i,l=d[1]-j,m=(h*(i-j)-l*(e-f))/(l*g-h*k);return[e+m*g,i+m*k]}function pc(a){var b=a[0],c=a[a.length-1];return!(b[0]-c[0]||b[1]-c[1])}function qc(){Ic(this),this.edge=this.site=this.circle=null}function rc(a){var b=Ug.pop()||new qc;return b.site=a,b}function sc(a){Bc(a),Rg.remove(a),Ug.push(a),Ic(a)}function tc(a){var b=a.circle,c=b.x,d=b.cy,e={x:c,y:d},f=a.P,g=a.N,h=[a];sc(a);for(var i=f;i.circle&&ef(c-i.circle.x)<wf&&ef(d-i.circle.cy)<wf;)f=i.P,h.unshift(i),sc(i),i=f;h.unshift(i),Bc(i);for(var j=g;j.circle&&ef(c-j.circle.x)<wf&&ef(d-j.circle.cy)<wf;)g=j.N,h.push(j),sc(j),j=g;h.push(j),Bc(j);var k,l=h.length;for(k=1;k<l;++k)j=h[k],i=h[k-1],Fc(j.edge,i.site,j.site,e);i=h[0],(j=h[l-1]).edge=Ec(i.site,j.site,null,e),Ac(i),Ac(j)}function uc(a){for(var b,c,d,e,f=a.x,g=a.y,h=Rg._;h;)if((d=vc(h,g)-f)>wf)h=h.L;else{if(!((e=f-wc(h,g))>wf)){d>-wf?(b=h.P,c=h):e>-wf?(b=h,c=h.N):b=c=h;break}if(!h.R){b=h;break}h=h.R}var i=rc(a);if(Rg.insert(b,i),b||c){if(b===c)return Bc(b),c=rc(b.site),Rg.insert(i,c),i.edge=c.edge=Ec(b.site,i.site),Ac(b),void Ac(c);if(c){Bc(b),Bc(c);var j=b.site,k=j.x,l=j.y,m=a.x-k,n=a.y-l,o=c.site,p=o.x-k,q=o.y-l,r=2*(m*q-n*p),s=m*m+n*n,t=p*p+q*q,u={x:(q*s-n*t)/r+k,y:(m*t-p*s)/r+l};Fc(c.edge,j,o,u),i.edge=Ec(j,a,null,u),c.edge=Ec(a,o,null,u),Ac(b),Ac(c)}else i.edge=Ec(b.site,i.site)}}function vc(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;var g=a.P;if(!g)return-1/0;var h=(c=g.site).x,i=c.y,j=i-b;if(!j)return h;var k=h-d,l=1/f-1/j,m=k/j;return l?(-m+Math.sqrt(m*m-2*l*(k*k/(-2*j)-i+j/2+e-f/2)))/l+d:(d+h)/2}function wc(a,b){var c=a.N;if(c)return vc(c,b);var d=a.site;return d.y===b?d.x:1/0}function xc(a){this.site=a,this.edges=[]}function yc(a,b){return b.angle-a.angle}function zc(){Ic(this),this.x=this.y=this.arc=this.site=this.cy=null}function Ac(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,e=a.site,f=c.site;if(d!==f){var g=e.x,h=e.y,i=d.x-g,j=d.y-h,k=f.x-g,l=2*(i*(q=f.y-h)-j*k);if(!(l>=-xf)){
var m=i*i+j*j,n=k*k+q*q,o=(q*m-j*n)/l,p=(i*n-k*m)/l,q=p+h,r=Vg.pop()||new zc;r.arc=a,r.site=e,r.x=o+g,r.y=q+Math.sqrt(o*o+p*p),r.cy=q,a.circle=r;for(var s=null,t=Tg._;t;)if(r.y<t.y||r.y===t.y&&r.x<=t.x){if(!t.L){s=t.P;break}t=t.L}else{if(!t.R){s=t;break}t=t.R}Tg.insert(s,r),s||(Sg=r)}}}}function Bc(a){var b=a.circle;b&&(b.P||(Sg=b.N),Tg.remove(b),Vg.push(b),Ic(b),a.circle=null)}function Cc(a,b){var c=a.b;if(c)return!0;var d,e,f=a.a,g=b[0][0],h=b[1][0],i=b[0][1],j=b[1][1],k=a.l,l=a.r,m=k.x,n=k.y,o=l.x,p=l.y,q=(m+o)/2,r=(n+p)/2;if(p===n){if(q<g||q>=h)return;if(m>o){if(f){if(f.y>=j)return}else f={x:q,y:i};c={x:q,y:j}}else{if(f){if(f.y<i)return}else f={x:q,y:j};c={x:q,y:i}}}else if(e=r-(d=(m-o)/(p-n))*q,d<-1||d>1)if(m>o){if(f){if(f.y>=j)return}else f={x:(i-e)/d,y:i};c={x:(j-e)/d,y:j}}else{if(f){if(f.y<i)return}else f={x:(j-e)/d,y:j};c={x:(i-e)/d,y:i}}else if(n<p){if(f){if(f.x>=h)return}else f={x:g,y:d*g+e};c={x:h,y:d*h+e}}else{if(f){if(f.x<g)return}else f={x:h,y:d*h+e};c={x:g,y:d*g+e}}return a.a=f,a.b=c,!0}function Dc(a,b){this.l=a,this.r=b,this.a=this.b=null}function Ec(a,b,c,d){var e=new Dc(a,b);return Pg.push(e),c&&Fc(e,a,b,c),d&&Fc(e,b,a,d),Qg[a.i].edges.push(new Gc(e,a,b)),Qg[b.i].edges.push(new Gc(e,b,a)),e}function Fc(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function Gc(a,b,c){var d=a.a,e=a.b;this.edge=a,this.site=b,this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function Hc(){this._=null}function Ic(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function Jc(a,b){var c=b,d=b.R,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.R=d.L,c.R&&(c.R.U=c),d.L=c}function Kc(a,b){var c=b,d=b.L,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.L=d.R,c.L&&(c.L.U=c),d.R=c}function Lc(a){for(;a.L;)a=a.L;return a}function Mc(a,b){var c,d,e,f=a.sort(Nc).pop();for(Pg=[],Qg=new Array(a.length),Rg=new Hc,Tg=new Hc;;)if(e=Sg,f&&(!e||f.y<e.y||f.y===e.y&&f.x<e.x))f.x===c&&f.y===d||(Qg[f.i]=new xc(f),uc(f),c=f.x,d=f.y),f=a.pop();else{if(!e)break;tc(e.arc)}b&&(function(a){for(var b,c=Pg,d=Bb(a[0][0],a[0][1],a[1][0],a[1][1]),e=c.length;e--;)(!Cc(b=c[e],a)||!d(b)||ef(b.a.x-b.b.x)<wf&&ef(b.a.y-b.b.y)<wf)&&(b.a=b.b=null,c.splice(e,1))}(b),function(a){for(var b,c,d,e,f,g,h,i,j,k,l=a[0][0],m=a[1][0],n=a[0][1],o=a[1][1],p=Qg,q=p.length;q--;)if((f=p[q])&&f.prepare())for(i=(h=f.edges).length,g=0;g<i;)d=(k=h[g].end()).x,e=k.y,b=(j=h[++g%i].start()).x,c=j.y,(ef(d-b)>wf||ef(e-c)>wf)&&(h.splice(g,0,new Gc((r=f.site,s=k,t=ef(d-l)<wf&&o-e>wf?{x:l,y:ef(b-l)<wf?c:o}:ef(e-o)<wf&&m-d>wf?{x:ef(c-o)<wf?b:m,y:o}:ef(d-m)<wf&&e-n>wf?{x:m,y:ef(b-m)<wf?c:n}:ef(e-n)<wf&&d-l>wf?{x:ef(c-n)<wf?b:l,y:n}:null,u=void 0,u=new Dc(r,null),u.a=s,u.b=t,Pg.push(u),u),f.site,null)),++i);var r,s,t,u}(b));var g={cells:Qg,edges:Pg};return Rg=Tg=Pg=Qg=null,g}function Nc(a,b){return b.y-a.y||b.x-a.x}function Oc(a){return a.x}function Pc(a){return a.y}function Qc(a,b){a=We.rgb(a),b=We.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+qa(Math.round(c+f*a))+qa(Math.round(d+g*a))+qa(Math.round(e+h*a))}}function Rc(a,b){var c,d={},e={};for(c in a)c in b?d[c]=Uc(a[c],b[c]):e[c]=a[c];for(c in b)c in a||(e[c]=b[c]);return function(a){for(c in d)e[c]=d[c](a);return e}}function Sc(a,b){return a=+a,b=+b,function(c){return a*(1-c)+b*c}}function Tc(a,b){var c,d,e,f=Xg.lastIndex=Yg.lastIndex=0,g=-1,h=[],i=[];for(a+="",b+="";(c=Xg.exec(a))&&(d=Yg.exec(b));)(e=d.index)>f&&(e=b.slice(f,e),h[g]?h[g]+=e:h[++g]=e),(c=c[0])===(d=d[0])?h[g]?h[g]+=d:h[++g]=d:(h[++g]=null,i.push({i:g,x:Sc(c,d)})),f=Yg.lastIndex;return f<b.length&&(e=b.slice(f),h[g]?h[g]+=e:h[++g]=e),h.length<2?i[0]?(b=i[0].x,function(a){return b(a)+""}):function(){return b}:(b=i.length,function(a){for(var c,d=0;d<b;++d)h[(c=i[d]).i]=c.x(a);return h.join("")})}function Uc(a,b){for(var c,d=We.interpolators.length;--d>=0&&!(c=We.interpolators[d](a,b)););return c}function Vc(a,b){var c,d=[],e=[],f=a.length,g=b.length,h=Math.min(a.length,b.length);for(c=0;c<h;++c)d.push(Uc(a[c],b[c]));for(;c<f;++c)e[c]=a[c];for(;c<g;++c)e[c]=b[c];return function(a){for(c=0;c<h;++c)e[c]=d[c](a);return e}}function Wc(a){return function(b){return 1-a(1-b)}}function Xc(a){return function(b){return.5*(b<.5?a(2*b):2-a(2-2*b))}}function Yc(a){return a*a}function Zc(a){return a*a*a}function $c(a){if(a<=0)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(a<.5?c:3*(a-b)+c-.75)}function _c(a){return 1-Math.cos(a*Bf)}function ad(a){return Math.pow(2,10*(a-1))}function bd(a){return 1-Math.sqrt(1-a*a)}function cd(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function dd(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function ed(a){var b,c,d,e=[a.a,a.b],f=[a.c,a.d],g=gd(e),h=fd(e,f),i=gd(((b=f)[0]+=(d=-h)*(c=e)[0],b[1]+=d*c[1],b))||0;e[0]*f[1]<f[0]*e[1]&&(e[0]*=-1,e[1]*=-1,g*=-1,h*=-1),this.rotate=(g?Math.atan2(e[1],e[0]):Math.atan2(-f[0],f[1]))*Df,this.translate=[a.e,a.f],this.scale=[g,i],this.skew=i?Math.atan2(h,i)*Df:0}function fd(a,b){return a[0]*b[0]+a[1]*b[1]}function gd(a){var b=Math.sqrt(fd(a,a));return b&&(a[0]/=b,a[1]/=b),b}function hd(a){return a.length?a.pop()+",":""}function id(a,b){var c=[],d=[];return a=We.transform(a),b=We.transform(b),function(a,b,c,d){if(a[0]!==b[0]||a[1]!==b[1]){var e=c.push("translate(",null,",",null,")");d.push({i:e-4,x:Sc(a[0],b[0])},{i:e-2,x:Sc(a[1],b[1])})}else(b[0]||b[1])&&c.push("translate("+b+")")}(a.translate,b.translate,c,d),function(a,b,c,d){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),d.push({i:c.push(hd(c)+"rotate(",null,")")-2,x:Sc(a,b)})):b&&c.push(hd(c)+"rotate("+b+")")}(a.rotate,b.rotate,c,d),function(a,b,c,d){a!==b?d.push({i:c.push(hd(c)+"skewX(",null,")")-2,x:Sc(a,b)}):b&&c.push(hd(c)+"skewX("+b+")")}(a.skew,b.skew,c,d),function(a,b,c,d){if(a[0]!==b[0]||a[1]!==b[1]){var e=c.push(hd(c)+"scale(",null,",",null,")");d.push({i:e-4,x:Sc(a[0],b[0])},{i:e-2,x:Sc(a[1],b[1])})}else 1===b[0]&&1===b[1]||c.push(hd(c)+"scale("+b+")")}(a.scale,b.scale,c,d),a=b=null,function(a){for(var b,e=-1,f=d.length;++e<f;)c[(b=d[e]).i]=b.x(a);return c.join("")}}function jd(a,b){return b=(b-=a=+a)||1/b,function(c){return(c-a)/b}}function kd(a,b){return b=(b-=a=+a)||1/b,function(c){return Math.max(0,Math.min(1,(c-a)/b))}}function ld(a){for(var b=a.source,c=a.target,d=function(a,b){if(a===b)return a;for(var c=md(a),d=md(b),e=c.pop(),f=d.pop(),g=null;e===f;)g=e,e=c.pop(),f=d.pop();return g}(b,c),e=[b];b!==d;)b=b.parent,e.push(b);for(var f=e.length;c!==d;)e.splice(f,0,c),c=c.parent;return e}function md(a){for(var b=[],c=a.parent;null!=c;)b.push(a),a=c,c=c.parent;return b.push(a),b}function nd(a){a.fixed|=2}function od(a){a.fixed&=-7}function pd(a){a.fixed|=4,a.px=a.x,a.py=a.y}function qd(a){a.fixed&=-5}function rd(a,b){return We.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=xd,a}function sd(a,b){for(var c=[a];null!=(a=c.pop());)if(b(a),(e=a.children)&&(d=e.length))for(var d,e;--d>=0;)c.push(e[d])}function td(a,b){for(var c=[a],d=[];null!=(a=c.pop());)if(d.push(a),(f=a.children)&&(e=f.length))for(var e,f,g=-1;++g<e;)c.push(f[g]);for(;null!=(a=d.pop());)b(a)}function ud(a){return a.children}function vd(a){return a.value}function wd(a,b){return b.value-a.value}function xd(a){return We.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function yd(a){return a.x}function zd(a){return a.y}function Ad(a,b,c){a.y0=b,a.y=c}function Bd(a){return We.range(a.length)}function Cd(a){for(var b=-1,c=a[0].length,d=[];++b<c;)d[b]=0;return d}function Dd(a){for(var b,c=1,d=0,e=a[0][1],f=a.length;c<f;++c)(b=a[c][1])>e&&(d=c,e=b);return d}function Ed(a){return a.reduce(Fd,0)}function Fd(a,b){return a+b[1]}function Gd(a,b){return Hd(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function Hd(a,b){for(var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];++c<=b;)f[c]=e*c+d;return f}function Id(a){return[We.min(a),We.max(a)]}function Jd(a,b){return a.value-b.value}function Kd(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function Ld(a,b){a._pack_next=b,b._pack_prev=a}function Md(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return.999*e*e>c*c+d*d}function Nd(a){function b(a){k=Math.min(a.x-a.r,k),l=Math.max(a.x+a.r,l),m=Math.min(a.y-a.r,m),n=Math.max(a.y+a.r,n)}if((c=a.children)&&(j=c.length)){var c,d,e,f,g,h,i,j,k=1/0,l=-1/0,m=1/0,n=-1/0;if(c.forEach(Od),(d=c[0]).x=-d.r,d.y=0,b(d),j>1&&((e=c[1]).x=e.r,e.y=0,b(e),j>2))for(Qd(d,e,f=c[2]),b(f),Kd(d,f),d._pack_prev=f,Kd(f,e),e=d._pack_next,g=3;g<j;g++){Qd(d,e,f=c[g]);var o=0,p=1,q=1;for(h=e._pack_next;h!==e;h=h._pack_next,p++)if(Md(h,f)){o=1;break}if(1==o)for(i=d._pack_prev;i!==h._pack_prev&&!Md(i,f);i=i._pack_prev,q++);o?(p<q||p==q&&e.r<d.r?Ld(d,e=h):Ld(d=i,e),g--):(Kd(d,f),e=f,b(f))}var r=(k+l)/2,s=(m+n)/2,t=0;for(g=0;g<j;g++)(f=c[g]).x-=r,f.y-=s,t=Math.max(t,f.r+Math.sqrt(f.x*f.x+f.y*f.y));a.r=t,c.forEach(Pd)}}function Od(a){a._pack_next=a._pack_prev=a}function Pd(a){delete a._pack_next,delete a._pack_prev}function Qd(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=e*e+f*f,i=.5+((d*=d)-(g*=g))/(2*h),j=Math.sqrt(Math.max(0,2*g*(d+h)-(d-=h)*d-g*g))/(2*h);c.x=a.x+i*e+j*f,c.y=a.y+i*f-j*e}else c.x=a.x+d,c.y=a.y}function Rd(a,b){return a.parent==b.parent?1:2}function Sd(a){var b=a.children;return b.length?b[0]:a.t}function Td(a){var b,c=a.children;return(b=c.length)?c[b-1]:a.t}function Ud(a,b,c){var d=c/(b.i-a.i);b.c-=d,b.s+=c,a.c+=d,b.z+=c,b.m+=c}function Vd(a,b,c){return a.a.parent===b.parent?a.a:c}function Wd(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function Xd(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return e<0&&(c+=e/2,e=0),f<0&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}function Yd(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]}function Zd(a){return a.rangeExtent?a.rangeExtent():Yd(a.range())}function $d(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function _d(a,b){var c,d=0,e=a.length-1,f=a[d],g=a[e];return g<f&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a}function ae(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:hh}function be(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;for(a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++g<=h;)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=We.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function ce(a,b){return We.rebind(a,b,"range","rangeRound","interpolate","clamp")}function de(a,b){return _d(a,ae(ee(a,b)[2])),_d(a,ae(ee(a,b)[2])),a}function ee(a,b){null==b&&(b=10);var c=Yd(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return f<=.15?e*=10:f<=.35?e*=5:f<=.75&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+.5*e,c[2]=e,c}function fe(a,b){return We.range.apply(We,ee(a,b))}function ge(a,b,c){var d=ee(a,b);if(c){var e=Xf.exec(c);if(e.shift(),"s"===e[8]){var f=We.formatPrefix(Math.max(ef(d[0]),ef(d[1])));return e[7]||(e[7]="."+he(f.scale(d[2]))),e[8]="f",c=We.format(e.join("")),function(a){return c(f.scale(a))+f.symbol}}e[7]||(e[7]="."+function(a,b){var c=he(b[2]);return a in ih?Math.abs(c-he(Math.max(ef(b[0]),ef(b[1]))))+ +("e"!==a):c-2*("%"===a)}(e[8],d)),c=e.join("")}else c=",."+he(d[2])+"f";return We.format(c)}function he(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function ie(a){return function(b){return b<0?-Math.pow(-b,a):Math.pow(b,a)}}function je(){return 0}function ke(a){return a.innerRadius}function le(a){return a.outerRadius}function me(a){return a.startAngle}function ne(a){return a.endAngle}function oe(a){return a&&a.padAngle}function pe(a,b,c,d){return(a-c)*b-(b-d)*a>0?0:1}function qe(a,b,c,d,e){var f=a[0]-b[0],g=a[1]-b[1],h=(e?d:-d)/Math.sqrt(f*f+g*g),i=h*g,j=-h*f,k=a[0]+i,l=a[1]+j,m=b[0]+i,n=b[1]+j,o=(k+m)/2,p=(l+n)/2,q=m-k,r=n-l,s=q*q+r*r,t=c-d,u=k*n-m*l,v=(r<0?-1:1)*Math.sqrt(Math.max(0,t*t*s-u*u)),w=(u*r-q*v)/s,x=(-u*q-r*v)/s,y=(u*r+q*v)/s,z=(-u*q+r*v)/s,A=w-o,B=x-p,C=y-o,D=z-p;return A*A+B*B>C*C+D*D&&(w=y,x=z),[[w-i,x-j],[w*c/t,x*c/t]]}function re(a){function b(b){function g(){j.push("M",f(a(k),h))}for(var i,j=[],k=[],l=-1,m=b.length,n=wa(c),o=wa(d);++l<m;)e.call(this,i=b[l],l)?k.push([+n.call(this,i,l),+o.call(this,i,l)]):k.length&&(g(),k=[]);return k.length&&g(),j.length?j.join(""):null}var c=jc,d=kc,e=tb,f=se,g=f.key,h=.7;return b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(e=a,b):e},b.interpolate=function(a){return arguments.length?(g="function"==typeof a?f=a:(f=qh.get(a)||se).key,b):g},b.tension=function(a){return arguments.length?(h=a,b):h},b}function se(a){return a.length>1?a.join("L"):a+"Z"}function te(a){return a.join("L")+"Z"}function ue(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function ve(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function we(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return se(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;if(c&&(d+="Q"+(f[0]-2*g[0]/3)+","+(f[1]-2*g[1]/3)+","+f[0]+","+f[1],e=a[1],i=2),b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+2*h[0]/3)+","+(f[1]+2*h[1]/3)+","+k[0]+","+k[1]}return d}function xe(a,b){for(var c,d=[],e=(1-b)/2,f=a[0],g=a[1],h=1,i=a.length;++h<i;)c=f,f=g,g=a[h],d.push([e*(g[0]-c[0]),e*(g[1]-c[1])]);return d}function ye(a){if(a.length<3)return se(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f,"L",ze(th,g),",",ze(th,h)];for(a.push(a[c-1]);++b<=c;)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),Ae(i,g,h);return a.pop(),i.push("L",d),i.join("")}function ze(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Ae(a,b,c){a.push("C",ze(rh,b),",",ze(rh,c),",",ze(sh,b),",",ze(sh,c),",",ze(th,b),",",ze(th,c))}function Be(a,b){return(b[1]-a[1])/(b[0]-a[0])}function Ce(a){for(var b,c,d,e=-1,f=a.length;++e<f;)c=(b=a[e])[0],d=b[1]-Bf,b[0]=c*Math.cos(d),b[1]=c*Math.sin(d);return a}function De(a){function b(b){function i(){p.push("M",h(a(r),l),k,j(a(q.reverse()),l),"Z")}for(var m,n,o,p=[],q=[],r=[],s=-1,t=b.length,u=wa(c),v=wa(e),w=c===d?function(){return n}:wa(d),x=e===f?function(){return o}:wa(f);++s<t;)g.call(this,m=b[s],s)?(q.push([n=+u.call(this,m,s),o=+v.call(this,m,s)]),r.push([+w.call(this,m,s),+x.call(this,m,s)])):q.length&&(i(),q=[],r=[]);return q.length&&i(),p.length?p.join(""):null}var c=jc,d=jc,e=0,f=kc,g=tb,h=se,i=h.key,j=h,k="L",l=.7;return b.x=function(a){return arguments.length?(c=d=a,b):d},b.x0=function(a){return arguments.length?(c=a,b):c},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=f=a,b):f},b.y0=function(a){return arguments.length?(e=a,b):e},b.y1=function(a){return arguments.length?(f=a,b):f},b.defined=function(a){return arguments.length?(g=a,b):g},b.interpolate=function(a){return arguments.length?(i="function"==typeof a?h=a:(h=qh.get(a)||se).key,j=h.reverse||h,k=h.closed?"M":"L",b):i},b.tension=function(a){return arguments.length?(l=a,b):l},b}function Ee(a){return a.radius}function Fe(a){return[a.x,a.y]}function Ge(){return 64}function He(){return"circle"}function Ie(a){var b=Math.sqrt(a/yf);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function Je(a){return function(){var b,c,d;(b=this[a])&&(d=b[c=b.active])&&(d.timer.c=null,d.timer.t=NaN,--b.count?delete b[c]:delete this[a],b.active+=.5,d.event&&d.event.interrupt.call(this,this.__data__,d.index))}}function Ke(a,b,c){return kf(a,Ah),a.namespace=b,a.id=c,a}function Le(a,b,c,d){var e=a.id,f=a.namespace;return Q(a,"function"==typeof c?function(a,g,h){a[f][e].tween.set(b,d(c.call(a,a.__data__,g,h)))}:(c=d(c),function(a){a[f][e].tween.set(b,c)}))}function Me(a){return null==a&&(a=""),function(){this.textContent=a}}function Ne(a){return null==a?"__transition__":"__transition_"+a+"__"}function Oe(a,b,c,d,e){function f(c){var e=n.active,f=n[e];for(var j in f&&(f.timer.c=null,f.timer.t=NaN,--n.count,delete n[e],f.event&&f.event.interrupt.call(a,a.__data__,f.index)),n)if(+j<d){var p=n[j];p.timer.c=null,p.timer.t=NaN,--n.count,delete n[j]}i.c=g,za(function(){return i.c&&g(c||1)&&(i.c=null,i.t=NaN),1},0,h),n.active=d,o.event&&o.event.start.call(a,a.__data__,b),m=[],o.tween.forEach(function(c,d){(d=d.call(a,a.__data__,b))&&m.push(d)}),l=o.ease,k=o.duration}function g(e){for(var f=e/k,g=l(f),h=m.length;h>0;)m[--h].call(a,g);if(f>=1)return o.event&&o.event.end.call(a,a.__data__,b),--n.count?delete n[d]:delete a[c],1}var h,i,k,l,m,n=a[c]||(a[c]={active:0,count:0}),o=n[d];o||(h=e.time,i=za(function(a){var b=o.delay;if(i.t=b+h,b<=a)return f(a-b);i.c=f},0,h),o=n[d]={tween:new j,time:h,timer:i,delay:e.delay,duration:e.duration,ease:e.ease,index:b},e=null,++n.count)}function Pe(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate("+(isFinite(d)?d:c(a))+",0)"})}function Qe(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate(0,"+(isFinite(d)?d:c(a))+")"})}function Re(a){return a.toISOString()}function Se(a,b,c){function d(b){return a(b)}function e(a,c){var d=(a[1]-a[0])/c,e=We.bisect(Jh,d);return e==Jh.length?[b.year,ee(a.map(function(a){return a/31536e6}),c)[2]]:e?b[d/Jh[e-1]<Jh[e]/d?e-1:e]:[Mh,ee(a,c)[2]]}return d.invert=function(b){return Te(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(Te)},d.nice=function(a,b){function c(c){return!isNaN(c)&&!a.range(c,Te(+c+1),b).length}var f=d.domain(),g=Yd(f),h=null==a?e(g,10):"number"==typeof a&&e(g,a);return h&&(a=h[0],b=h[1]),d.domain(_d(f,b>1?{floor:function(b){for(;c(b=a.floor(b));)b=Te(b-1);return b},ceil:function(b){for(;c(b=a.ceil(b));)b=Te(+b+1);return b}}:a))},d.ticks=function(a,b){var c=Yd(d.domain()),f=null==a?e(c,10):"number"==typeof a?e(c,a):!a.range&&[{range:a},b];return f&&(a=f[0],b=f[1]),a.range(c[0],Te(+c[1]+1),b<1?1:b)},d.tickFormat=function(){return c},d.copy=function(){return Se(a.copy(),b,c)},ce(d,a)}function Te(a){return new Date(a)}function Ue(a){return JSON.parse(a.responseText)}function Ve(a){var b=Ze.createRange();return b.selectNode(Ze.body),b.createContextualFragment(a.responseText)}var We={version:"3.5.17"},Xe=[].slice,Ye=function(a){return Xe.call(a)},Ze=this.document;if(Ze)try{Ye(Ze.documentElement.childNodes)[0].nodeType}catch(We){Ye=function(a){for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c}}if(Date.now||(Date.now=function(){return+new Date}),Ze)try{Ze.createElement("DIV").style.setProperty("opacity",0,"")}catch(We){var $e=this.Element.prototype,_e=$e.setAttribute,af=$e.setAttributeNS,bf=this.CSSStyleDeclaration.prototype,cf=bf.setProperty;$e.setAttribute=function(a,b){_e.call(this,a,b+"")},$e.setAttributeNS=function(a,b,c){af.call(this,a,b,c+"")},bf.setProperty=function(a,b,c){cf.call(this,a,b+"",c)}}We.ascending=d,We.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},We.min=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c},We.max=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c},We.extent=function(a,b){var c,d,e,f=-1,g=a.length;if(1===arguments.length){for(;++f<g;)if(null!=(d=a[f])&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),e<d&&(e=d))}else{for(;++f<g;)if(null!=(d=b.call(a,a[f],f))&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=b.call(a,a[f],f))&&(c>d&&(c=d),e<d&&(e=d))}return[c,e]},We.sum=function(a,b){var c,d=0,e=a.length,g=-1;if(1===arguments.length)for(;++g<e;)f(c=+a[g])&&(d+=c);else for(;++g<e;)f(c=+b.call(a,a[g],g))&&(d+=c);return d},We.mean=function(a,b){var c,d=0,g=a.length,h=-1,i=g;if(1===arguments.length)for(;++h<g;)f(c=e(a[h]))?d+=c:--i;else for(;++h<g;)f(c=e(b.call(a,a[h],h)))?d+=c:--i;if(i)return d/i},We.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},We.median=function(a,b){var c,g=[],h=a.length,i=-1;if(1===arguments.length)for(;++i<h;)f(c=e(a[i]))&&g.push(c);else for(;++i<h;)f(c=e(b.call(a,a[i],i)))&&g.push(c);if(g.length)return We.quantile(g.sort(d),.5)},We.variance=function(a,b){var c,d,g=a.length,h=0,i=0,j=-1,k=0;if(1===arguments.length)for(;++j<g;)f(c=e(a[j]))&&(i+=(d=c-h)*(c-(h+=d/++k)));else for(;++j<g;)f(c=e(b.call(a,a[j],j)))&&(i+=(d=c-h)*(c-(h+=d/++k)));if(k>1)return i/(k-1)},We.deviation=function(){var a=We.variance.apply(this,arguments);return a?Math.sqrt(a):a};var df=g(d);We.bisectLeft=df.left,We.bisect=We.bisectRight=df.right,We.bisector=function(a){return g(1===a.length?function(b,c){return d(a(b),c)}:a)},We.shuffle=function(a,b,c){(f=arguments.length)<3&&(c=a.length,f<2&&(b=0));for(var d,e,f=c-b;f;)e=Math.random()*f--|0,d=a[f+b],a[f+b]=a[e+b],a[e+b]=d;return a},We.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},We.pairs=function(a){for(var b=0,c=a.length-1,d=a[0],e=new Array(c<0?0:c);b<c;)e[b]=[d,d=a[++b]];return e},We.transpose=function(a){if(!(e=a.length))return[];for(var b=-1,c=We.min(a,h),d=new Array(c);++b<c;)for(var e,f=-1,g=d[b]=new Array(e);++f<e;)g[f]=a[f][b];return d},We.zip=function(){return We.transpose(arguments)},We.keys=function(a){var b=[];for(var c in a)b.push(c);return b},We.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},We.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},We.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(b=(d=a[e]).length;--b>=0;)c[--g]=d[b];return c};var ef=Math.abs;We.range=function(a,b,c){if(arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0)),(b-a)/c==1/0)throw new Error("infinite range");var d,e=[],f=function(a){for(var b=1;a*b%1;)b*=10;return b}(ef(c)),g=-1;if(a*=f,b*=f,(c*=f)<0)for(;(d=a+c*++g)>b;)e.push(d/f);else for(;(d=a+c*++g)<b;)e.push(d/f);return e},We.map=function(a,b){var c=new j;if(a instanceof j)a.forEach(function(a,b){c.set(a,b)});else if(Array.isArray(a)){var d,e=-1,f=a.length;if(1===arguments.length)for(;++e<f;)c.set(e,a[e]);else for(;++e<f;)c.set(b.call(a,d=a[e],e),d)}else for(var g in a)c.set(g,a[g]);return c};var ff="__proto__",gf="\0";i(j,{has:m,get:function(a){return this._[k(a)]},set:function(a,b){return this._[k(a)]=b},remove:n,keys:o,values:function(){var a=[];for(var b in this._)a.push(this._[b]);return a},entries:function(){var a=[];for(var b in this._)a.push({key:l(b),value:this._[b]});return a},size:p,empty:q,forEach:function(a){for(var b in this._)a.call(this,l(b),this._[b])}}),We.nest=function(){function a(f,g,h){if(h>=e.length)return c?c.call(d,g):b?g.sort(b):g;for(var i,k,l,m,n=-1,o=g.length,p=e[h++],q=new j;++n<o;)(m=q.get(i=p(k=g[n])))?m.push(k):q.set(i,[k]);return f?(k=f(),l=function(b,c){k.set(b,a(f,c,h))}):(k={},l=function(b,c){k[b]=a(f,c,h)}),q.forEach(l),k}var b,c,d={},e=[],f=[];return d.map=function(b,c){return a(c,b,0)},d.entries=function(b){return function a(b,c){if(c>=e.length)return b;var d=[],g=f[c++];return b.forEach(function(b,e){d.push({key:b,values:a(e,c)})}),g?d.sort(function(a,b){return g(a.key,b.key)}):d}(a(We.map,b,0),0)},d.key=function(a){return e.push(a),d},d.sortKeys=function(a){return f[e.length-1]=a,d},d.sortValues=function(a){return b=a,d},d.rollup=function(a){return c=a,d},d},We.set=function(a){var b=new r;if(a)for(var c=0,d=a.length;c<d;++c)b.add(a[c]);return b},i(r,{has:m,add:function(a){return this._[k(a+="")]=!0,a},remove:n,values:o,size:p,empty:q,forEach:function(a){for(var b in this._)a.call(this,l(b))}}),We.behavior={},We.rebind=function(a,b){for(var c,d=1,e=arguments.length;++d<e;)a[c=arguments[d]]=t(a,b,b[c]);return a};var hf=["webkit","ms","moz","Moz","o","O"];We.dispatch=function(){for(var a=new w,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=x(a);return a},w.prototype.on=function(a,b){var c=a.indexOf("."),d="";if(c>=0&&(d=a.slice(c+1),a=a.slice(0,c)),a)return arguments.length<2?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}},We.event=null,We.requote=function(a){return a.replace(jf,"\\$&")};var jf=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,kf={}.__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]},lf=function(a,b){return b.querySelector(a)},mf=function(a,b){return b.querySelectorAll(a)},nf=function(a,b){var c=a.matches||a[u(a,"matchesSelector")];return(nf=function(a,b){return c.call(a,b)})(a,b)};"function"==typeof Sizzle&&(lf=function(a,b){return Sizzle(a,b)[0]||null},mf=Sizzle,nf=Sizzle.matchesSelector),We.selection=function(){return We.select(Ze.documentElement)};var of=We.selection.prototype=[];of.select=function(a){var b,c,d,e,f=[];a=C(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]),b.parentNode=(d=this[g]).parentNode;for(var i=-1,j=d.length;++i<j;)(e=d[i])?(b.push(c=a.call(e,e.__data__,i,g)),c&&"__data__"in e&&(c.__data__=e.__data__)):b.push(null)}return B(f)},of.selectAll=function(a){var b,c,d=[];a=D(a);for(var e=-1,f=this.length;++e<f;)for(var g=this[e],h=-1,i=g.length;++h<i;)(c=g[h])&&(d.push(b=Ye(a.call(c,c.__data__,h,e))),b.parentNode=c);return B(d)};var pf="http://www.w3.org/1999/xhtml",qf={svg:"http://www.w3.org/2000/svg",xhtml:pf,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};We.ns={prefix:qf,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&"xmlns"!==(c=a.slice(0,b))&&(a=a.slice(b+1)),qf.hasOwnProperty(c)?{space:qf[c],local:a}:a}},of.attr=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node();return(a=We.ns.qualify(a)).local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(E(b,a[b]));return this}return this.each(E(a,b))},of.classed=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node(),d=(a=H(a)).length,e=-1;if(b=c.classList){for(;++e<d;)if(!b.contains(a[e]))return!1}else for(b=c.getAttribute("class");++e<d;)if(!G(a[e]).test(b))return!1;return!0}for(b in a)this.each(I(b,a[b]));return this}return this.each(I(a,b))},of.style=function(a,b,d){var e=arguments.length;if(e<3){if("string"!=typeof a){for(d in e<2&&(b=""),a)this.each(K(d,a[d],b));return this}if(e<2){var f=this.node();return c(f).getComputedStyle(f,null).getPropertyValue(a)}d=""}return this.each(K(a,b,d))},of.property=function(a,b){if(arguments.length<2){if("string"==typeof a)return this.node()[a];for(b in a)this.each(L(b,a[b]));return this}return this.each(L(a,b))},of.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},of.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},of.append=function(a){return a=M(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})},of.insert=function(a,b){return a=M(a),b=C(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})},of.remove=function(){return this.each(N)},of.data=function(a,b){function c(a,c){var d,e,f,g=a.length,l=c.length,m=Math.min(g,l),n=new Array(l),o=new Array(l),p=new Array(g);if(b){var q,r=new j,s=new Array(g);for(d=-1;++d<g;)(e=a[d])&&(r.has(q=b.call(e,e.__data__,d))?p[d]=e:r.set(q,e),s[d]=q);for(d=-1;++d<l;)(e=r.get(q=b.call(c,f=c[d],d)))?!0!==e&&(n[d]=e,e.__data__=f):o[d]=O(f),r.set(q,!0);for(d=-1;++d<g;)d in s&&!0!==r.get(s[d])&&(p[d]=a[d])}else{for(d=-1;++d<m;)e=a[d],f=c[d],e?(e.__data__=f,n[d]=e):o[d]=O(f);for(;d<l;++d)o[d]=O(c[d]);for(;d<g;++d)p[d]=a[d]}o.update=n,o.parentNode=n.parentNode=p.parentNode=a.parentNode,h.push(o),i.push(n),k.push(p)}var d,e,f=-1,g=this.length;if(!arguments.length){for(a=new Array(g=(d=this[0]).length);++f<g;)(e=d[f])&&(a[f]=e.__data__);return a}var h=R([]),i=B([]),k=B([]);if("function"==typeof a)for(;++f<g;)c(d=this[f],a.call(d,d.parentNode.__data__,f));else for(;++f<g;)c(d=this[f],a);return i.enter=function(){return h},i.exit=function(){return k},i},of.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},of.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=P(a));for(var f=0,g=this.length;f<g;f++){e.push(b=[]),b.parentNode=(c=this[f]).parentNode;for(var h=0,i=c.length;h<i;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return B(e)},of.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c,d=this[a],e=d.length-1,f=d[e];--e>=0;)(c=d[e])&&(f&&f!==c.nextSibling&&f.parentNode.insertBefore(c,f),f=c);return this},of.sort=function(a){a=function(a){return arguments.length||(a=d),function(b,c){return b&&c?a(b.__data__,c.__data__):!b-!c}}.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},of.each=function(a){return Q(this,function(b,c,d){a.call(b,b.__data__,c,d)})},of.call=function(a){var b=Ye(arguments);return a.apply(b[0]=this,b),this},of.empty=function(){return!this.node()},of.node=function(){for(var a=0,b=this.length;a<b;a++)for(var c=this[a],d=0,e=c.length;d<e;d++){var f=c[d];if(f)return f}return null},of.size=function(){var a=0;return Q(this,function(){++a}),a};var rf=[];We.selection.enter=R,We.selection.enter.prototype=rf,rf.append=of.append,rf.empty=of.empty,rf.node=of.node,rf.call=of.call,rf.size=of.size,rf.select=function(a){for(var b,c,d,e,f,g=[],h=-1,i=this.length;++h<i;){d=(e=this[h]).update,g.push(b=[]),b.parentNode=e.parentNode;for(var j=-1,k=e.length;++j<k;)(f=e[j])?(b.push(d[j]=c=a.call(e.parentNode,f.__data__,j,h)),c.__data__=f.__data__):b.push(null)}return B(g)},rf.insert=function(a,b){var c,d,e;return arguments.length<2&&(c=this,b=function(a,b,f){var g,h=c[f].update,i=h.length;for(f!=e&&(e=f,d=0),b>=d&&(d=b+1);!(g=h[d])&&++d<i;);return g}),of.insert.call(this,a,b)},We.select=function(b){var c;return"string"==typeof b?(c=[lf(b,Ze)]).parentNode=Ze.documentElement:(c=[b]).parentNode=a(b),B([c])},We.selectAll=function(a){var b;return"string"==typeof a?(b=Ye(mf(a,Ze))).parentNode=Ze.documentElement:(b=Ye(a)).parentNode=null,B([b])},of.on=function(a,b,c){var d=arguments.length;if(d<3){if("string"!=typeof a){for(c in d<2&&(b=!1),a)this.each(S(c,a[c],b));return this}if(d<2)return(d=this.node()["__on"+a])&&d._;c=!1}return this.each(S(a,b,c))};var sf=We.map({mouseenter:"mouseover",mouseleave:"mouseout"});Ze&&sf.forEach(function(a){"on"+a in Ze&&sf.remove(a)});var tf,uf=0;We.mouse=function(a){return W(a,z())};var vf=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;We.touch=function(a,b,c){if(arguments.length<3&&(c=b,b=z().changedTouches),b)for(var d,e=0,f=b.length;e<f;++e)if((d=b[e]).identifier===c)return W(a,d)},We.behavior.drag=function(){function a(){this.on("mousedown.drag",f).on("touchstart.drag",g)}function b(a,b,c,f,g){return function(){var h,i=We.event.target.correspondingElement||We.event.target,j=this.parentNode,k=d.of(this,arguments),l=0,m=a(),n=".drag"+(null==m?"":"-"+m),o=We.select(c(i)).on(f+n,function(){var a,c,d=b(j,m);d&&(a=d[0]-q[0],c=d[1]-q[1],l|=a|c,q=d,k({type:"drag",x:d[0]+h[0],y:d[1]+h[1],dx:a,dy:c}))}).on(g+n,function(){b(j,m)&&(o.on(f+n,null).on(g+n,null),p(l),k({type:"dragend"}))}),p=V(i),q=b(j,m);h=e?[(h=e.apply(this,arguments)).x-q[0],h.y-q[1]]:[0,0],k({
type:"dragstart"})}}var d=A(a,"drag","dragstart","dragend"),e=null,f=b(v,We.mouse,c,"mousemove","mouseup"),g=b(X,We.touch,s,"touchmove","touchend");return a.origin=function(b){return arguments.length?(e=b,a):e},We.rebind(a,d,"on")},We.touches=function(a,b){return arguments.length<2&&(b=z().touches),b?Ye(b).map(function(b){var c=W(a,b);return c.identifier=b.identifier,c}):[]};var wf=1e-6,xf=wf*wf,yf=Math.PI,zf=2*yf,Af=zf-wf,Bf=yf/2,Cf=yf/180,Df=180/yf,Ef=Math.SQRT2;We.interpolateZoom=function(a,b){var c,d,e=a[0],f=a[1],g=a[2],h=b[0],i=b[1],j=b[2],k=h-e,l=i-f,m=k*k+l*l;if(m<xf)d=Math.log(j/g)/Ef,c=function(a){return[e+a*k,f+a*l,g*Math.exp(Ef*a*d)]};else{var n=Math.sqrt(m),o=(j*j-g*g+4*m)/(2*g*2*n),p=(j*j-g*g-4*m)/(2*j*2*n),q=Math.log(Math.sqrt(o*o+1)-o),r=Math.log(Math.sqrt(p*p+1)-p);d=(r-q)/Ef,c=function(a){var b,c=a*d,h=aa(q),i=g/(2*n)*(h*(b=Ef*c+q,((b=Math.exp(2*b))-1)/(b+1))-function(a){return((a=Math.exp(a))-1/a)/2}(q));return[e+i*k,f+i*l,g*h/aa(Ef*c+q)]}}return c.duration=1e3*d,c},We.behavior.zoom=function(){function a(a){a.on(E,k).on(Gf+".zoom",m).on("dblclick.zoom",n).on(H,l)}function b(a){return[(a[0]-x.x)/x.k,(a[1]-x.y)/x.k]}function d(a){x.k=Math.max(B[0],Math.min(B[1],a))}function e(a,b){b=function(a){return[a[0]*x.k+x.x,a[1]*x.k+x.y]}(b),x.x+=a[0]-b[0],x.y+=a[1]-b[1]}function f(b,c,f,g){b.__chart__={x:x.x,y:x.y,k:x.k},d(Math.pow(2,g)),e(p=c,f),b=We.select(b),C>0&&(b=b.transition().duration(C)),b.call(a.event)}function g(){u&&u.domain(t.range().map(function(a){return(a-x.x)/x.k}).map(t.invert)),w&&w.domain(v.range().map(function(a){return(a-x.y)/x.k}).map(v.invert))}function h(a){D++||a({type:"zoomstart"})}function i(a){g(),a({type:"zoom",scale:x.k,translate:[x.x,x.y]})}function j(a){--D||(a({type:"zoomend"}),p=null)}function k(){var a=this,d=I.of(a,arguments),f=0,g=We.select(c(a)).on(F,function(){f=1,e(We.mouse(a),k),i(d)}).on(G,function(){g.on(F,null).on(G,null),l(f),j(d)}),k=b(We.mouse(a)),l=V(a);zh.call(a),h(d)}function l(){function a(){var a=We.touches(o);return n=x.k,a.forEach(function(a){a.identifier in q&&(q[a.identifier]=b(a))}),a}function c(){var b=We.event.target;We.select(b).on(u,g).on(v,m),w.push(b);for(var c=We.event.changedTouches,d=0,e=c.length;d<e;++d)q[c[d].identifier]=null;var h=a(),i=Date.now();if(1===h.length){if(i-s<500){var j=h[0];f(o,j,q[j.identifier],Math.floor(Math.log(x.k)/Math.LN2)+1),y()}s=i}else if(h.length>1){j=h[0];var k=h[1],l=j[0]-k[0],n=j[1]-k[1];r=l*l+n*n}}function g(){var a,b,c,f,g=We.touches(o);zh.call(o);for(var h=0,j=g.length;h<j;++h,f=null)if(c=g[h],f=q[c.identifier]){if(b)break;a=c,b=f}if(f){var k=(k=c[0]-a[0])*k+(k=c[1]-a[1])*k,l=r&&Math.sqrt(k/r);a=[(a[0]+c[0])/2,(a[1]+c[1])/2],b=[(b[0]+f[0])/2,(b[1]+f[1])/2],d(l*n)}s=null,e(a,b),i(p)}function m(){if(We.event.touches.length){for(var b=We.event.changedTouches,c=0,d=b.length;c<d;++c)delete q[b[c].identifier];for(var e in q)return void a()}We.selectAll(w).on(t,null),z.on(E,k).on(H,l),A(),j(p)}var n,o=this,p=I.of(o,arguments),q={},r=0,t=".zoom-"+We.event.changedTouches[0].identifier,u="touchmove"+t,v="touchend"+t,w=[],z=We.select(o),A=V(o);c(),h(p),z.on(E,null).on(H,c)}function m(){var a=I.of(this,arguments);r?clearTimeout(r):(zh.call(this),o=b(p=q||We.mouse(this)),h(a)),r=setTimeout(function(){r=null,j(a)},50),y(),d(Math.pow(2,.002*Ff())*x.k),e(p,o),i(a)}function n(){var a=We.mouse(this),c=Math.log(x.k)/Math.LN2;f(this,a,b(a),We.event.shiftKey?Math.ceil(c)-1:Math.floor(c)+1)}var o,p,q,r,s,t,u,v,w,x={x:0,y:0,k:1},z=[960,500],B=Hf,C=250,D=0,E="mousedown.zoom",F="mousemove.zoom",G="mouseup.zoom",H="touchstart.zoom",I=A(a,"zoomstart","zoom","zoomend");return Gf||(Gf="onwheel"in Ze?(Ff=function(){return-We.event.deltaY*(We.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Ze?(Ff=function(){return We.event.wheelDelta},"mousewheel"):(Ff=function(){return-We.event.detail},"MozMousePixelScroll")),a.event=function(a){a.each(function(){var a=I.of(this,arguments),b=x;xh?We.select(this).transition().each("start.zoom",function(){x=this.__chart__||{x:0,y:0,k:1},h(a)}).tween("zoom:zoom",function(){var c=z[0],d=z[1],e=p?p[0]:c/2,f=p?p[1]:d/2,g=We.interpolateZoom([(e-x.x)/x.k,(f-x.y)/x.k,c/x.k],[(e-b.x)/b.k,(f-b.y)/b.k,c/b.k]);return function(b){var d=g(b),h=c/d[2];this.__chart__=x={x:e-d[0]*h,y:f-d[1]*h,k:h},i(a)}}).each("interrupt.zoom",function(){j(a)}).each("end.zoom",function(){j(a)}):(this.__chart__=x,h(a),i(a),j(a))})},a.translate=function(b){return arguments.length?(x={x:+b[0],y:+b[1],k:x.k},g(),a):[x.x,x.y]},a.scale=function(b){return arguments.length?(x={x:x.x,y:x.y,k:null},d(+b),g(),a):x.k},a.scaleExtent=function(b){return arguments.length?(B=null==b?Hf:[+b[0],+b[1]],a):B},a.center=function(b){return arguments.length?(q=b&&[+b[0],+b[1]],a):q},a.size=function(b){return arguments.length?(z=b&&[+b[0],+b[1]],a):z},a.duration=function(b){return arguments.length?(C=+b,a):C},a.x=function(b){return arguments.length?(u=b,t=b.copy(),x={x:0,y:0,k:1},a):u},a.y=function(b){return arguments.length?(w=b,v=b.copy(),x={x:0,y:0,k:1},a):w},We.rebind(a,I,"on")};var Ff,Gf,Hf=[0,1/0];We.color=ca,ca.prototype.toString=function(){return this.rgb()+""},We.hsl=da;var If=da.prototype=new ca;If.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),new da(this.h,this.s,this.l/a)},If.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new da(this.h,this.s,a*this.l)},If.rgb=function(){return ea(this.h,this.s,this.l)},We.hcl=fa;var Jf=fa.prototype=new ca;Jf.brighter=function(a){return new fa(this.h,this.c,Math.min(100,this.l+Kf*(arguments.length?a:1)))},Jf.darker=function(a){return new fa(this.h,this.c,Math.max(0,this.l-Kf*(arguments.length?a:1)))},Jf.rgb=function(){return ga(this.h,this.c,this.l).rgb()},We.lab=ha;var Kf=18,Lf=.95047,Mf=1,Nf=1.08883,Of=ha.prototype=new ca;Of.brighter=function(a){return new ha(Math.min(100,this.l+Kf*(arguments.length?a:1)),this.a,this.b)},Of.darker=function(a){return new ha(Math.max(0,this.l-Kf*(arguments.length?a:1)),this.a,this.b)},Of.rgb=function(){return ia(this.l,this.a,this.b)},We.rgb=na;var Pf=na.prototype=new ca;Pf.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return b||c||d?(b&&b<e&&(b=e),c&&c<e&&(c=e),d&&d<e&&(d=e),new na(Math.min(255,b/a),Math.min(255,c/a),Math.min(255,d/a))):new na(e,e,e)},Pf.darker=function(a){return new na((a=Math.pow(.7,arguments.length?a:1))*this.r,a*this.g,a*this.b)},Pf.hsl=function(){return sa(this.r,this.g,this.b)},Pf.toString=function(){return"#"+qa(this.r)+qa(this.g)+qa(this.b)};var Qf=We.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Qf.forEach(function(a,b){Qf.set(a,oa(b))}),We.functor=wa,We.xhr=xa(s),We.dsv=function(a,b){function c(a,c,f){arguments.length<3&&(f=c,c=null);var g=ya(a,b,null==c?d:e(c),f);return g.row=function(a){return arguments.length?g.response(null==(c=a)?d:e(a)):c},g}function d(a){return c.parse(a.responseText)}function e(a){return function(b){return c.parse(b.responseText,a)}}function f(b){return b.map(g).join(a)}function g(a){return h.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var h=new RegExp('["'+a+"\n]"),i=a.charCodeAt(0);return c.parse=function(a,b){var d;return c.parseRows(a,function(a,c){if(d)return d(a,c-1);var e=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}");d=b?function(a,c){return b(e(a),c)}:e})},c.parseRows=function(a,b){function c(){if(k>=j)return g;if(e)return e=!1,f;var b=k;if(34===a.charCodeAt(b)){for(var c=b;c++<j;)if(34===a.charCodeAt(c)){if(34!==a.charCodeAt(c+1))break;++c}return k=c+2,13===(d=a.charCodeAt(c+1))?(e=!0,10===a.charCodeAt(c+2)&&++k):10===d&&(e=!0),a.slice(b+1,c).replace(/""/g,'"')}for(;k<j;){var d,h=1;if(10===(d=a.charCodeAt(k++)))e=!0;else if(13===d)e=!0,10===a.charCodeAt(k)&&(++k,++h);else if(d!==i)continue;return a.slice(b,k-h)}return a.slice(b)}for(var d,e,f={},g={},h=[],j=a.length,k=0,l=0;(d=c())!==g;){for(var m=[];d!==f&&d!==g;)m.push(d),d=c();b&&null==(m=b(m,l++))||h.push(m)}return h},c.format=function(b){if(Array.isArray(b[0]))return c.formatRows(b);var d=new r,e=[];return b.forEach(function(a){for(var b in a)d.has(b)||e.push(d.add(b))}),[e.map(g).join(a)].concat(b.map(function(b){return e.map(function(a){return g(b[a])}).join(a)})).join("\n")},c.formatRows=function(a){return a.map(f).join("\n")},c},We.csv=We.dsv(",","text/csv"),We.tsv=We.dsv("\t","text/tab-separated-values");var Rf,Sf,Tf,Uf,Vf=this[u(this,"requestAnimationFrame")]||function(a){setTimeout(a,17)};We.timer=function(){za.apply(this,arguments)},We.timer.flush=function(){Ba(),Ca()},We.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};var Wf=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(function(a,b){var c=Math.pow(10,3*ef(8-b));return{scale:b>8?function(a){return a/c}:function(a){return a*c},symbol:a}});We.formatPrefix=function(a,b){var c=0;return(a=+a)&&(a<0&&(a*=-1),b&&(a=We.round(a,Da(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((c-1)/3)))),Wf[8+c/3]};var Xf=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Yf=We.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=We.round(a,Da(a,b))).toFixed(Math.max(0,Math.min(20,Da(a*(1+1e-15),b))))}}),Zf=We.time={},$f=Date;Fa.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){_f.setUTCDate.apply(this._,arguments)},setDay:function(){_f.setUTCDay.apply(this._,arguments)},setFullYear:function(){_f.setUTCFullYear.apply(this._,arguments)},setHours:function(){_f.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){_f.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){_f.setUTCMinutes.apply(this._,arguments)},setMonth:function(){_f.setUTCMonth.apply(this._,arguments)},setSeconds:function(){_f.setUTCSeconds.apply(this._,arguments)},setTime:function(){_f.setTime.apply(this._,arguments)}};var _f=Date.prototype;Zf.year=Ga(function(a){return(a=Zf.day(a)).setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()}),Zf.years=Zf.year.range,Zf.years.utc=Zf.year.utc.range,Zf.day=Ga(function(a){var b=new $f(2e3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1}),Zf.days=Zf.day.range,Zf.days.utc=Zf.day.utc.range,Zf.dayOfYear=function(a){var b=Zf.year(a);return Math.floor((a-b-6e4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(a,b){b=7-b;var c=Zf[a]=Ga(function(a){return(a=Zf.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var c=Zf.year(a).getDay();return Math.floor((Zf.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});Zf[a+"s"]=c.range,Zf[a+"s"].utc=c.utc.range,Zf[a+"OfYear"]=function(a){var c=Zf.year(a).getDay();return Math.floor((Zf.dayOfYear(a)+(c+b)%7)/7)}}),Zf.week=Zf.sunday,Zf.weeks=Zf.sunday.range,Zf.weeks.utc=Zf.sunday.utc.range,Zf.weekOfYear=Zf.sundayOfYear;var ag={"-":"",_:" ",0:"0"},bg=/^\s*\d+/,cg=/^%/;We.locale=function(a){return{numberFormat:function(a){var b=a.decimal,c=a.thousands,d=a.grouping,e=a.currency,f=d&&c?function(a,b){for(var e=a.length,f=[],g=0,h=d[0],i=0;e>0&&h>0&&(i+h+1>b&&(h=Math.max(1,b-i)),f.push(a.substring(e-=h,e+h)),!((i+=h+1)>b));)h=d[g=(g+1)%d.length];return f.reverse().join(c)}:s;return function(a){var c=Xf.exec(a),d=c[1]||" ",g=c[2]||">",h=c[3]||"-",i=c[4]||"",j=c[5],k=+c[6],l=c[7],m=c[8],n=c[9],o=1,p="",q="",r=!1,s=!0;switch(m&&(m=+m.substring(1)),(j||"0"===d&&"="===g)&&(j=d="0",g="="),n){case"n":l=!0,n="g";break;case"%":o=100,q="%",n="f";break;case"p":o=100,q="%",n="r";break;case"b":case"o":case"x":case"X":"#"===i&&(p="0"+n.toLowerCase());case"c":s=!1;case"d":r=!0,m=0;break;case"s":o=-1,n="r"}"$"===i&&(p=e[0],q=e[1]),"r"!=n||m||(n="g"),null!=m&&("g"==n?m=Math.max(1,Math.min(21,m)):"e"!=n&&"f"!=n||(m=Math.max(0,Math.min(20,m)))),n=Yf.get(n)||Ea;var t=j&&l;return function(a){var c=q;if(r&&a%1)return"";var e=a<0||0===a&&1/a<0?(a=-a,"-"):"-"===h?"":h;if(o<0){var i=We.formatPrefix(a,m);a=i.scale(a),c=i.symbol+q}else a*=o;var u,v,w=(a=n(a,m)).lastIndexOf(".");if(w<0){var x=s?a.lastIndexOf("e"):-1;x<0?(u=a,v=""):(u=a.substring(0,x),v=a.substring(x))}else u=a.substring(0,w),v=b+a.substring(w+1);!j&&l&&(u=f(u,1/0));var y=p.length+u.length+v.length+(t?0:e.length),z=y<k?new Array(y=k-y+1).join(d):"";return t&&(u=f(z+u,z.length?k-v.length:1/0)),e+=p,a=u+v,("<"===g?e+a+z:">"===g?z+e+a:"^"===g?z.substring(0,y>>=1)+e+a+z.substring(y):e+(t?a:z+a))+c}}}(a),timeFormat:function(a){function b(a){function b(b){for(var c,e,f,g=[],h=-1,i=0;++h<d;)37===a.charCodeAt(h)&&(g.push(a.slice(i,h)),null!=(e=ag[c=a.charAt(++h)])&&(c=a.charAt(++h)),(f=u[c])&&(c=f(b,null==e?"e"===c?" ":"0":e)),g.push(c),i=h+1);return g.push(a.slice(i,h)),g.join("")}var d=a.length;return b.parse=function(b){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(c(d,a,b,0)!=b.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);var e=null!=d.Z&&$f!==Fa,f=new(e?Fa:$f);return"j"in d?f.setFullYear(d.y,0,d.j):"W"in d||"U"in d?("w"in d||(d.w="W"in d?1:0),f.setFullYear(d.y,0,1),f.setFullYear(d.y,0,"W"in d?(d.w+6)%7+7*d.W-(f.getDay()+5)%7:d.w+7*d.U-(f.getDay()+6)%7)):f.setFullYear(d.y,d.m,d.d),f.setHours(d.H+(d.Z/100|0),d.M+d.Z%100,d.S,d.L),e?f._:f},b.toString=function(){return a},b}function c(a,b,c,d){for(var e,f,g,h=0,i=b.length,j=c.length;h<i;){if(d>=j)return-1;if(37===(e=b.charCodeAt(h++))){if(g=b.charAt(h++),!(f=v[g in ag?b.charAt(h++):g])||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}var d=a.dateTime,e=a.date,f=a.time,g=a.periods,h=a.days,i=a.shortDays,j=a.months,k=a.shortMonths;b.utc=function(a){function c(a){try{var b=new($f=Fa);return b._=a,d(b)}finally{$f=Date}}var d=b(a);return c.parse=function(a){try{$f=Fa;var b=d.parse(a);return b&&b._}finally{$f=Date}},c.toString=d.toString,c},b.multi=b.utc.multi=$a;var l=We.map(),m=Ja(h),n=Ka(h),o=Ja(i),p=Ka(i),q=Ja(j),r=Ka(j),s=Ja(k),t=Ka(k);g.forEach(function(a,b){l.set(a.toLowerCase(),b)});var u={a:function(a){return i[a.getDay()]},A:function(a){return h[a.getDay()]},b:function(a){return k[a.getMonth()]},B:function(a){return j[a.getMonth()]},c:b(d),d:function(a,b){return Ia(a.getDate(),b,2)},e:function(a,b){return Ia(a.getDate(),b,2)},H:function(a,b){return Ia(a.getHours(),b,2)},I:function(a,b){return Ia(a.getHours()%12||12,b,2)},j:function(a,b){return Ia(1+Zf.dayOfYear(a),b,3)},L:function(a,b){return Ia(a.getMilliseconds(),b,3)},m:function(a,b){return Ia(a.getMonth()+1,b,2)},M:function(a,b){return Ia(a.getMinutes(),b,2)},p:function(a){return g[+(a.getHours()>=12)]},S:function(a,b){return Ia(a.getSeconds(),b,2)},U:function(a,b){return Ia(Zf.sundayOfYear(a),b,2)},w:function(a){return a.getDay()},W:function(a,b){return Ia(Zf.mondayOfYear(a),b,2)},x:b(e),X:b(f),y:function(a,b){return Ia(a.getFullYear()%100,b,2)},Y:function(a,b){return Ia(a.getFullYear()%1e4,b,4)},Z:Ya,"%":function(){return"%"}},v={a:function(a,b,c){o.lastIndex=0;var d=o.exec(b.slice(c));return d?(a.w=p.get(d[0].toLowerCase()),c+d[0].length):-1},A:function(a,b,c){m.lastIndex=0;var d=m.exec(b.slice(c));return d?(a.w=n.get(d[0].toLowerCase()),c+d[0].length):-1},b:function(a,b,c){s.lastIndex=0;var d=s.exec(b.slice(c));return d?(a.m=t.get(d[0].toLowerCase()),c+d[0].length):-1},B:function(a,b,c){q.lastIndex=0;var d=q.exec(b.slice(c));return d?(a.m=r.get(d[0].toLowerCase()),c+d[0].length):-1},c:function(a,b,d){return c(a,u.c.toString(),b,d)},d:Sa,e:Sa,H:Ua,I:Ua,j:Ta,L:Xa,m:Ra,M:Va,p:function(a,b,c){var d=l.get(b.slice(c,c+=2).toLowerCase());return null==d?-1:(a.p=d,c)},S:Wa,U:Ma,w:La,W:Na,x:function(a,b,d){return c(a,u.x.toString(),b,d)},X:function(a,b,d){return c(a,u.X.toString(),b,d)},y:Pa,Y:Oa,Z:Qa,"%":Za};return b}(a)}};var dg=We.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});We.format=dg.numberFormat,We.geo={},_a.prototype={s:0,t:0,add:function(a){ab(a,this.t,eg),ab(eg.s,this.s,this),this.s?this.t+=eg.t:this.s=eg.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var eg=new _a;We.geo.stream=function(a,b){a&&fg.hasOwnProperty(a.type)?fg[a.type](a,b):bb(a,b)};var fg={Feature:function(a,b){bb(a.geometry,b)},FeatureCollection:function(a,b){for(var c=a.features,d=-1,e=c.length;++d<e;)bb(c[d].geometry,b)}},gg={Sphere:function(a,b){b.sphere()},Point:function(a,b){a=a.coordinates,b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){cb(a.coordinates,b,0)},MultiLineString:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)cb(c[d],b,0)},Polygon:function(a,b){db(a.coordinates,b)},MultiPolygon:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)db(c[d],b)},GeometryCollection:function(a,b){for(var c=a.geometries,d=-1,e=c.length;++d<e;)bb(c[d],b)}};We.geo.area=function(a){return hg=0,We.geo.stream(a,ug),hg};var hg,ig,jg,kg,lg,mg,ng,og,pg,qg,rg,sg,tg=new _a,ug={sphere:function(){hg+=4*yf},point:v,lineStart:v,lineEnd:v,polygonStart:function(){tg.reset(),ug.lineStart=eb},polygonEnd:function(){var a=2*tg;hg+=a<0?4*yf+a:a,ug.lineStart=ug.lineEnd=ug.point=v}};We.geo.bounds=function(){function a(a,b){t.push(u=[k=a,m=a]),b<l&&(l=b),b>n&&(n=b)}function b(b,c){var d=fb([b*Cf,c*Cf]);if(r){var e=hb(r,d),f=hb([e[1],-e[0],0],e);kb(f),f=lb(f);var g=b-o,i=g>0?1:-1,j=f[0]*Df*i,p=ef(g)>180;if(p^(i*o<j&&j<i*b))(q=f[1]*Df)>n&&(n=q);else if(p^(i*o<(j=(j+360)%360-180)&&j<i*b)){var q;(q=-f[1]*Df)<l&&(l=q)}else c<l&&(l=c),c>n&&(n=c);p?b<o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b):m>=k?(b<k&&(k=b),b>m&&(m=b)):b>o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b)}else a(b,c);r=d,o=b}function c(){v.point=b}function d(){u[0]=k,u[1]=m,v.point=a,r=null}function e(a,c){if(r){var d=a-o;s+=ef(d)>180?d+(d>0?360:-360):d}else p=a,q=c;ug.point(a,c),b(a,c)}function f(){ug.lineStart()}function g(){e(p,q),ug.lineEnd(),ef(s)>wf&&(k=-(m=180)),u[0]=k,u[1]=m,r=null}function h(a,b){return(b-=a)<0?b+360:b}function i(a,b){return a[0]-b[0]}function j(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var k,l,m,n,o,p,q,r,s,t,u,v={point:a,lineStart:c,lineEnd:d,polygonStart:function(){v.point=e,v.lineStart=f,v.lineEnd=g,s=0,ug.polygonStart()},polygonEnd:function(){ug.polygonEnd(),v.point=a,v.lineStart=c,v.lineEnd=d,tg<0?(k=-(m=180),l=-(n=90)):s>wf?n=90:s<-wf&&(l=-90),u[0]=k,u[1]=m}};return function(a){if(n=m=-(k=l=1/0),t=[],We.geo.stream(a,v),e=t.length){t.sort(i);for(var b=1,c=[o=t[0]];b<e;++b)j((f=t[b])[0],o)||j(f[1],o)?(h(o[0],f[1])>h(o[0],o[1])&&(o[1]=f[1]),h(f[0],o[1])>h(o[0],o[1])&&(o[0]=f[0])):c.push(o=f);for(var d,e,f,g=-1/0,o=(b=0,c[e=c.length-1]);b<=e;o=f,++b)f=c[b],(d=h(o[1],f[0]))>g&&(g=d,k=f[0],m=o[1])}return t=u=null,k===1/0||l===1/0?[[NaN,NaN],[NaN,NaN]]:[[k,l],[m,n]]}}(),We.geo.centroid=function(a){ig=jg=kg=lg=mg=ng=og=pg=qg=rg=sg=0,We.geo.stream(a,vg);var b=qg,c=rg,d=sg,e=b*b+c*c+d*d;return e<xf&&(b=ng,c=og,d=pg,jg<wf&&(b=kg,c=lg,d=mg),(e=b*b+c*c+d*d)<xf)?[NaN,NaN]:[Math.atan2(c,b)*Df,_(d/Math.sqrt(e))*Df]};var vg={sphere:v,point:nb,lineStart:pb,lineEnd:qb,polygonStart:function(){vg.lineStart=rb},polygonEnd:function(){vg.lineStart=pb}},wg=xb(tb,function(a){var b,c=NaN,d=NaN,e=NaN;return{lineStart:function(){a.lineStart(),b=1},point:function(f,g){var h=f>0?yf:-yf,i=ef(f-c);ef(i-yf)<wf?(a.point(c,d=(d+g)/2>0?Bf:-Bf),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),a.point(f,d),b=0):e!==h&&i>=yf&&(ef(c-e)<wf&&(c-=e*wf),ef(f-h)<wf&&(f-=h*wf),d=function(a,b,c,d){var e,f,g=Math.sin(a-c);return ef(g)>wf?Math.atan((Math.sin(b)*(f=Math.cos(d))*Math.sin(c)-Math.sin(d)*(e=Math.cos(b))*Math.sin(a))/(e*f*g)):(b+d)/2}(c,d,f,g),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),b=0),a.point(c=f,d=g),e=h},lineEnd:function(){a.lineEnd(),c=d=NaN},clean:function(){return 2-b}}},function(a,b,c,d){var e;if(null==a)e=c*Bf,d.point(-yf,e),d.point(0,e),d.point(yf,e),d.point(yf,0),d.point(yf,-e),d.point(0,-e),d.point(-yf,-e),d.point(-yf,0),d.point(-yf,e);else if(ef(a[0]-b[0])>wf){var f=a[0]<b[0]?yf:-yf;e=c*f/2,d.point(-f,e),d.point(0,e),d.point(f,e)}else d.point(b[0],b[1])},[-yf,-yf/2]),xg=1e9;We.geo.clipExtent=function(){var a,b,c,d,e,f,g={stream:function(a){return e&&(e.valid=!1),(e=f(a)).valid=!0,e},extent:function(h){return arguments.length?(f=Cb(a=+h[0][0],b=+h[0][1],c=+h[1][0],d=+h[1][1]),e&&(e.valid=!1,e=null),g):[[a,b],[c,d]]}};return g.extent([[0,0],[960,500]])},(We.geo.conicEqualArea=function(){return Db(Eb)}).raw=Eb,We.geo.albers=function(){return We.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},We.geo.albersUsa=function(){function a(a){var f=a[0],g=a[1];return b=null,c(f,g),b||(d(f,g),b)||e(f,g),b}var b,c,d,e,f=We.geo.albers(),g=We.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),h=We.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(a,c){b=[a,c]}};return a.invert=function(a){var b=f.scale(),c=f.translate(),d=(a[0]-c[0])/b,e=(a[1]-c[1])/b;return(e>=.12&&e<.234&&d>=-.425&&d<-.214?g:e>=.166&&e<.234&&d>=-.214&&d<-.115?h:f).invert(a)},a.stream=function(a){var b=f.stream(a),c=g.stream(a),d=h.stream(a);return{point:function(a,e){b.point(a,e),c.point(a,e),d.point(a,e)},sphere:function(){b.sphere(),c.sphere(),d.sphere()},lineStart:function(){b.lineStart(),c.lineStart(),d.lineStart()},lineEnd:function(){b.lineEnd(),c.lineEnd(),d.lineEnd()},polygonStart:function(){b.polygonStart(),c.polygonStart(),d.polygonStart()},polygonEnd:function(){b.polygonEnd(),c.polygonEnd(),d.polygonEnd()}}},a.precision=function(b){return arguments.length?(f.precision(b),g.precision(b),h.precision(b),a):f.precision()},a.scale=function(b){return arguments.length?(f.scale(b),g.scale(.35*b),h.scale(b),a.translate(f.translate())):f.scale()},a.translate=function(b){if(!arguments.length)return f.translate();var j=f.scale(),k=+b[0],l=+b[1];return c=f.translate(b).clipExtent([[k-.455*j,l-.238*j],[k+.455*j,l+.238*j]]).stream(i).point,d=g.translate([k-.307*j,l+.201*j]).clipExtent([[k-.425*j+wf,l+.12*j+wf],[k-.214*j-wf,l+.234*j-wf]]).stream(i).point,e=h.translate([k-.205*j,l+.212*j]).clipExtent([[k-.214*j+wf,l+.166*j+wf],[k-.115*j-wf,l+.234*j-wf]]).stream(i).point,a},a.scale(1070)};var yg,zg,Ag,Bg,Cg,Dg,Eg,Fg={point:v,lineStart:v,lineEnd:v,polygonStart:function(){zg=0,Fg.lineStart=Fb},polygonEnd:function(){Fg.lineStart=Fg.lineEnd=Fg.point=v,yg+=ef(zg/2)}},Gg={point:function(a,b){a<Ag&&(Ag=a),a>Cg&&(Cg=a),b<Bg&&(Bg=b),b>Dg&&(Dg=b)},lineStart:v,lineEnd:v,polygonStart:v,polygonEnd:v},Hg={point:Ib,lineStart:Jb,lineEnd:Kb,polygonStart:function(){Hg.lineStart=Lb},polygonEnd:function(){Hg.point=Ib,Hg.lineStart=Jb,Hg.lineEnd=Kb}};We.geo.path=function(){function a(a){return a&&("function"==typeof h&&f.pointRadius(+h.apply(this,arguments)),g&&g.valid||(g=e(f)),We.geo.stream(a,g)),f.result()}function b(){return g=null,a}var c,d,e,f,g,h=4.5;return a.area=function(a){return yg=0,We.geo.stream(a,e(Fg)),yg},a.centroid=function(a){return kg=lg=mg=ng=og=pg=qg=rg=sg=0,We.geo.stream(a,e(Hg)),sg?[qg/sg,rg/sg]:pg?[ng/pg,og/pg]:mg?[kg/mg,lg/mg]:[NaN,NaN]},a.bounds=function(a){return Cg=Dg=-(Ag=Bg=1/0),We.geo.stream(a,e(Gg)),[[Ag,Bg],[Cg,Dg]]},a.projection=function(a){return arguments.length?(e=(c=a)?a.stream||(d=a,f=Nb(function(a,b){return d([a*Df,b*Df])}),function(a){return Sb(f(a))}):s,b()):c;var d,f},a.context=function(a){return arguments.length?(f=null==(d=a)?new Gb:new Mb(a),"function"!=typeof h&&f.pointRadius(h),b()):d},a.pointRadius=function(b){return arguments.length?(h="function"==typeof b?b:(f.pointRadius(+b),+b),a):h},a.projection(We.geo.albersUsa()).context(null)},We.geo.transform=function(a){return{stream:function(b){var c=new Ob(b);for(var d in a)c[d]=a[d];return c}}},Ob.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},We.geo.projection=Qb,We.geo.projectionMutator=Rb,(We.geo.equirectangular=function(){return Qb(Tb)}).raw=Tb.invert=Tb,We.geo.rotation=function(a){function b(b){return(b=a(b[0]*Cf,b[1]*Cf))[0]*=Df,b[1]*=Df,b}return a=Vb(a[0]%360*Cf,a[1]*Cf,a.length>2?a[2]*Cf:0),b.invert=function(b){return(b=a.invert(b[0]*Cf,b[1]*Cf))[0]*=Df,b[1]*=Df,b},b},Ub.invert=Tb,We.geo.circle=function(){function a(){var a="function"==typeof d?d.apply(this,arguments):d,b=Vb(-a[0]*Cf,-a[1]*Cf,0).invert,e=[];return c(null,null,1,{point:function(a,c){e.push(a=b(a,c)),a[0]*=Df,a[1]*=Df}}),{type:"Polygon",coordinates:[e]}}var b,c,d=[0,0],e=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=function(d){return arguments.length?(c=Zb((b=+d)*Cf,e*Cf),a):b},a.precision=function(d){return arguments.length?(c=Zb(b*Cf,(e=+d)*Cf),a):e},a.angle(90)},We.geo.distance=function(a,b){var c,d=(b[0]-a[0])*Cf,e=a[1]*Cf,f=b[1]*Cf,g=Math.sin(d),h=Math.cos(d),i=Math.sin(e),j=Math.cos(e),k=Math.sin(f),l=Math.cos(f);return Math.atan2(Math.sqrt((c=l*g)*c+(c=j*k-i*l*h)*c),i*k+j*l*h)},We.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return We.range(Math.ceil(f/q)*q,e,q).map(m).concat(We.range(Math.ceil(j/r)*r,i,r).map(n)).concat(We.range(Math.ceil(d/o)*o,c,o).filter(function(a){return ef(a%q)>wf}).map(k)).concat(We.range(Math.ceil(h/p)*p,g,p).filter(function(a){return ef(a%r)>wf}).map(l))}var c,d,e,f,g,h,i,j,k,l,m,n,o=10,p=o,q=90,r=360,s=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[m(f).concat(n(i).slice(1),m(e).reverse().slice(1),n(j).reverse().slice(1))]}},a.extent=function(b){return arguments.length?a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(f=+b[0][0],e=+b[1][0],j=+b[0][1],i=+b[1][1],f>e&&(b=f,f=e,e=b),j>i&&(b=j,j=i,i=b),a.precision(s)):[[f,j],[e,i]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],h=+b[0][1],g=+b[1][1],d>c&&(b=d,d=c,c=b),h>g&&(b=h,h=g,g=b),a.precision(s)):[[d,h],[c,g]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?(q=+b[0],r=+b[1],a):[q,r]},a.minorStep=function(b){return arguments.length?(o=+b[0],p=+b[1],a):[o,p]},a.precision=function(b){return arguments.length?(s=+b,k=_b(h,g,90),l=ac(d,c,s),m=_b(j,i,90),n=ac(f,e,s),a):s},a.majorExtent([[-180,-90+wf],[180,90-wf]]).minorExtent([[-180,-80-wf],[180,80+wf]])},We.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),c||e.apply(this,arguments)]}}var b,c,d=bc,e=cc;return a.distance=function(){return We.geo.distance(b||d.apply(this,arguments),c||e.apply(this,arguments))},a.source=function(c){return arguments.length?(d=c,b="function"==typeof c?null:c,a):d},a.target=function(b){return arguments.length?(e=b,c="function"==typeof b?null:b,a):e},a.precision=function(){return arguments.length?a:0},a},We.geo.interpolate=function(a,b){return c=a[0]*Cf,d=a[1]*Cf,e=b[0]*Cf,f=b[1]*Cf,g=Math.cos(d),h=Math.sin(d),i=Math.cos(f),j=Math.sin(f),k=g*Math.cos(c),l=g*Math.sin(c),m=i*Math.cos(e),n=i*Math.sin(e),o=2*Math.asin(Math.sqrt(ba(f-d)+g*i*ba(e-c))),p=1/Math.sin(o),(q=o?function(a){var b=Math.sin(a*=o)*p,c=Math.sin(o-a)*p,d=c*k+b*m,e=c*l+b*n,f=c*h+b*j;return[Math.atan2(e,d)*Df,Math.atan2(f,Math.sqrt(d*d+e*e))*Df]}:function(){return[c*Df,d*Df]}).distance=o,q;var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q},We.geo.length=function(a){return Eg=0,We.geo.stream(a,Ig),Eg};var Ig={sphere:v,point:v,lineStart:function(){function a(a,e){var f=Math.sin(e*=Cf),g=Math.cos(e),h=ef((a*=Cf)-b),i=Math.cos(h);Eg+=Math.atan2(Math.sqrt((h=g*Math.sin(h))*h+(h=d*f-c*g*i)*h),c*f+d*g*i),b=a,c=f,d=g}var b,c,d;Ig.point=function(e,f){b=e*Cf,c=Math.sin(f*=Cf),d=Math.cos(f),Ig.point=a},Ig.lineEnd=function(){Ig.point=Ig.lineEnd=v}},lineEnd:v,polygonStart:v,polygonEnd:v},Jg=dc(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(We.geo.azimuthalEqualArea=function(){
return Qb(Jg)}).raw=Jg;var Kg=dc(function(a){var b=Math.acos(a);return b&&b/Math.sin(b)},s);(We.geo.azimuthalEquidistant=function(){return Qb(Kg)}).raw=Kg,(We.geo.conicConformal=function(){return Db(ec)}).raw=ec,(We.geo.conicEquidistant=function(){return Db(fc)}).raw=fc;var Lg=dc(function(a){return 1/a},Math.atan);(We.geo.gnomonic=function(){return Qb(Lg)}).raw=Lg,gc.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-Bf]},(We.geo.mercator=function(){return hc(gc)}).raw=gc;var Mg=dc(function(){return 1},Math.asin);(We.geo.orthographic=function(){return Qb(Mg)}).raw=Mg;var Ng=dc(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(We.geo.stereographic=function(){return Qb(Ng)}).raw=Ng,ic.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-Bf]},(We.geo.transverseMercator=function(){var a=hc(ic),b=a.center,c=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):[(a=b())[1],-a[0]]},a.rotate=function(a){return a?c([a[0],a[1],a.length>2?a[2]+90:90]):[(a=c())[0],a[1],a[2]-90]},c([0,0,90])}).raw=ic,We.geom={},We.geom.hull=function(a){function b(a){if(a.length<3)return[];var b,e=wa(c),f=wa(d),g=a.length,h=[],i=[];for(b=0;b<g;b++)h.push([+e.call(this,a[b],b),+f.call(this,a[b],b),b]);for(h.sort(mc),b=0;b<g;b++)i.push([h[b][0],-h[b][1]]);var j=lc(h),k=lc(i),l=k[0]===j[0],m=k[k.length-1]===j[j.length-1],n=[];for(b=j.length-1;b>=0;--b)n.push(a[h[j[b]][2]]);for(b=+l;b<k.length-m;++b)n.push(a[h[k[b]][2]]);return n}var c=jc,d=kc;return arguments.length?b(a):(b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b)},We.geom.polygon=function(a){return kf(a,Og),a};var Og=We.geom.polygon.prototype=[];Og.area=function(){for(var a,b=-1,c=this.length,d=this[c-1],e=0;++b<c;)a=d,d=this[b],e+=a[1]*d[0]-a[0]*d[1];return.5*e},Og.centroid=function(a){var b,c,d=-1,e=this.length,f=0,g=0,h=this[e-1];for(arguments.length||(a=-1/(6*this.area()));++d<e;)b=h,h=this[d],c=b[0]*h[1]-h[0]*b[1],f+=(b[0]+h[0])*c,g+=(b[1]+h[1])*c;return[f*a,g*a]},Og.clip=function(a){for(var b,c,d,e,f,g,h=pc(a),i=-1,j=this.length-pc(this),k=this[j-1];++i<j;){for(b=a.slice(),a.length=0,e=this[i],f=b[(d=b.length-h)-1],c=-1;++c<d;)nc(g=b[c],k,e)?(nc(f,k,e)||a.push(oc(f,g,k,e)),a.push(g)):nc(f,k,e)&&a.push(oc(f,g,k,e)),f=g;h&&a.push(a[0]),k=e}return a};var Pg,Qg,Rg,Sg,Tg,Ug=[],Vg=[];xc.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)(a=b[c].edge).b&&a.a||b.splice(c,1);return b.sort(yc),b.length},Gc.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Hc.prototype={insert:function(a,b){var c,d,e;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=Lc(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);for(b.L=b.R=null,b.U=c,b.C=!0,a=b;c&&c.C;)c===(d=c.U).L?(e=d.R)&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.R&&(Jc(this,c),c=(a=c).U),c.C=!1,d.C=!0,Kc(this,d)):(e=d.L)&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.L&&(Kc(this,c),c=(a=c).U),c.C=!1,d.C=!0,Jc(this,d)),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,c,d,e=a.U,f=a.L,g=a.R;if(c=f?g?Lc(g):f:g,e?e.L===a?e.L=c:e.R=c:this._=c,f&&g?(d=c.C,c.C=a.C,c.L=f,f.U=c,c!==g?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=g,g.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d)if(a&&a.C)a.C=!1;else{do{if(a===this._)break;if(a===e.L){if((b=e.R).C&&(b.C=!1,e.C=!0,Jc(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,Kc(this,b),b=e.R),b.C=e.C,e.C=b.R.C=!1,Jc(this,e),a=this._;break}}else if((b=e.L).C&&(b.C=!1,e.C=!0,Kc(this,e),b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,Jc(this,b),b=e.L),b.C=e.C,e.C=b.L.C=!1,Kc(this,e),a=this._;break}b.C=!0,a=e,e=e.U}while(!a.C);a&&(a.C=!1)}}},We.geom.voronoi=function(a){function b(a){var b=new Array(a.length),d=h[0][0],e=h[0][1],f=h[1][0],g=h[1][1];return Mc(c(a),h).cells.forEach(function(c,h){var i=c.edges,j=c.site;(b[h]=i.length?i.map(function(a){var b=a.start();return[b.x,b.y]}):j.x>=d&&j.x<=f&&j.y>=e&&j.y<=g?[[d,g],[f,g],[f,e],[d,e]]:[]).point=a[h]}),b}function c(a){return a.map(function(a,b){return{x:Math.round(f(a,b)/wf)*wf,y:Math.round(g(a,b)/wf)*wf,i:b}})}var d=jc,e=kc,f=d,g=e,h=Wg;return a?b(a):(b.links=function(a){return Mc(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return Mc(c(a)).cells.forEach(function(c,d){for(var e,f,g,h,i=c.site,j=c.edges.sort(yc),k=-1,l=j.length,m=j[l-1].edge,n=m.l===i?m.r:m.l;++k<l;)e=n,n=(m=j[k].edge).l===i?m.r:m.l,d<e.i&&d<n.i&&(g=e,h=n,((f=i).x-h.x)*(g.y-f.y)-(f.x-g.x)*(h.y-f.y)<0)&&b.push([a[d],a[e.i],a[n.i]])}),b},b.x=function(a){return arguments.length?(f=wa(d=a),b):d},b.y=function(a){return arguments.length?(g=wa(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?Wg:a,b):h===Wg?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===Wg?null:h&&h[1]},b)};var Wg=[[-1e6,-1e6],[1e6,1e6]];We.geom.delaunay=function(a){return We.geom.voronoi().triangles(a)},We.geom.quadtree=function(a,b,c,d,e){function f(a){function f(a,b,c,d,e,f,g,h){if(!isNaN(c)&&!isNaN(d))if(a.leaf){var i=a.x,k=a.y;if(null!=i)if(ef(i-c)+ef(k-d)<.01)j(a,b,c,d,e,f,g,h);else{var l=a.point;a.x=a.y=a.point=null,j(a,l,i,k,e,f,g,h),j(a,b,c,d,e,f,g,h)}else a.x=c,a.y=d,a.point=b}else j(a,b,c,d,e,f,g,h)}function j(a,b,c,d,e,g,h,i){var j=.5*(e+h),k=.5*(g+i),l=c>=j,m=d>=k,n=m<<1|l;a.leaf=!1,l?e=j:h=j,m?g=k:i=k,f(a=a.nodes[n]||(a.nodes[n]={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(a){f(z,a,+t(a,++m),+u(a,m),p,q,r,s)}}),b,c,d,e,g,h,i)}var k,l,m,n,o,p,q,r,s,t=wa(h),u=wa(i);if(null!=b)p=b,q=c,r=d,s=e;else if(r=s=-(p=q=1/0),l=[],m=[],o=a.length,g)for(n=0;n<o;++n)(k=a[n]).x<p&&(p=k.x),k.y<q&&(q=k.y),k.x>r&&(r=k.x),k.y>s&&(s=k.y),l.push(k.x),m.push(k.y);else for(n=0;n<o;++n){var v=+t(k=a[n],n),w=+u(k,n);v<p&&(p=v),w<q&&(q=w),v>r&&(r=v),w>s&&(s=w),l.push(v),m.push(w)}var x=r-p,y=s-q;x>y?s=q+x:r=p+y;var z={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(a){f(z,a,+t(a,++n),+u(a,n),p,q,r,s)}};if(z.visit=function(a){!function a(b,c,d,e,f,g){if(!b(c,d,e,f,g)){var h=.5*(d+f),i=.5*(e+g),j=c.nodes;j[0]&&a(b,j[0],d,e,h,i),j[1]&&a(b,j[1],h,e,f,i),j[2]&&a(b,j[2],d,i,h,g),j[3]&&a(b,j[3],h,i,f,g)}}(a,z,p,q,r,s)},z.find=function(a){return function(a,b,c,d,e,f,g){var h,i=1/0;return function a(j,k,l,m,n){if(!(k>f||l>g||m<d||n<e)){if(o=j.point){var o,p=b-j.x,q=c-j.y,r=p*p+q*q;if(r<i){var s=Math.sqrt(i=r);d=b-s,e=c-s,f=b+s,g=c+s,h=o}}for(var t=j.nodes,u=.5*(k+m),v=.5*(l+n),w=(c>=v)<<1|b>=u,x=w+4;w<x;++w)if(j=t[3&w])switch(3&w){case 0:a(j,k,l,u,v);break;case 1:a(j,u,l,m,v);break;case 2:a(j,k,v,u,n);break;case 3:a(j,u,v,m,n)}}}(a,d,e,f,g),h}(z,a[0],a[1],p,q,r,s)},n=-1,null==b){for(;++n<o;)f(z,a[n],l[n],m[n],p,q,r,s);--n}else a.forEach(z.add);return l=m=a=k=null,z}var g,h=jc,i=kc;return(g=arguments.length)?(h=Oc,i=Pc,3===g&&(e=c,d=b,c=b=0),f(a)):(f.x=function(a){return arguments.length?(h=a,f):h},f.y=function(a){return arguments.length?(i=a,f):i},f.extent=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=+a[0][0],c=+a[0][1],d=+a[1][0],e=+a[1][1]),f):null==b?null:[[b,c],[d,e]]},f.size=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=c=0,d=+a[0],e=+a[1]),f):null==b?null:[d-b,e-c]},f)},We.interpolateRgb=Qc,We.interpolateObject=Rc,We.interpolateNumber=Sc,We.interpolateString=Tc;var Xg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yg=new RegExp(Xg.source,"g");We.interpolate=Uc,We.interpolators=[function(a,b){var c=typeof b;return("string"===c?Qf.has(b.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(b)?Qc:Tc:b instanceof ca?Qc:Array.isArray(b)?Vc:"object"===c&&isNaN(b)?Rc:Sc)(a,b)}],We.interpolateArray=Vc;var Zg=function(){return s},$g=We.map({linear:Zg,poly:function(a){return function(b){return Math.pow(b,a)}},quad:function(){return Yc},cubic:function(){return Zc},sin:function(){return _c},exp:function(){return ad},circle:function(){return bd},elastic:function(a,b){var c;return arguments.length<2&&(b=.45),arguments.length?c=b/zf*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-c)*zf/b)}},back:function(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}},bounce:function(){return cd}}),_g=We.map({in:s,out:Wc,"in-out":Xc,"out-in":function(a){return Xc(Wc(a))}});We.ease=function(a){var b,c=a.indexOf("-"),d=c>=0?a.slice(0,c):a,e=c>=0?a.slice(c+1):"in";return d=$g.get(d)||Zg,e=_g.get(e)||s,b=e(d.apply(null,Xe.call(arguments,1))),function(a){return a<=0?0:a>=1?1:b(a)}},We.interpolateHcl=function(a,b){a=We.hcl(a),b=We.hcl(b);var c=a.h,d=a.c,e=a.l,f=b.h-c,g=b.c-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.c:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:f<-180&&(f+=360),function(a){return ga(c+f*a,d+g*a,e+h*a)+""}},We.interpolateHsl=function(a,b){a=We.hsl(a),b=We.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.s:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:f<-180&&(f+=360),function(a){return ea(c+f*a,d+g*a,e+h*a)+""}},We.interpolateLab=function(a,b){a=We.lab(a),b=We.lab(b);var c=a.l,d=a.a,e=a.b,f=b.l-c,g=b.a-d,h=b.b-e;return function(a){return ia(c+f*a,d+g*a,e+h*a)+""}},We.interpolateRound=dd,We.transform=function(a){var b=Ze.createElementNS(We.ns.prefix.svg,"g");return(We.transform=function(a){if(null!=a){b.setAttribute("transform",a);var c=b.transform.baseVal.consolidate()}return new ed(c?c.matrix:ah)})(a)},ed.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ah={a:1,b:0,c:0,d:1,e:0,f:0};We.interpolateTransform=id,We.layout={},We.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(ld(a[c]));return b}},We.layout.chord=function(){function a(){var a,j,l,m,n,o={},p=[],q=We.range(f),r=[];for(c=[],d=[],a=0,m=-1;++m<f;){for(j=0,n=-1;++n<f;)j+=e[m][n];p.push(j),r.push(We.range(f)),a+=j}for(g&&q.sort(function(a,b){return g(p[a],p[b])}),h&&r.forEach(function(a,b){a.sort(function(a,c){return h(e[b][a],e[b][c])})}),a=(zf-k*f)/a,j=0,m=-1;++m<f;){for(l=j,n=-1;++n<f;){var s=q[m],t=r[s][n],u=e[s][t],v=j,w=j+=u*a;o[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}d[s]={index:s,startAngle:l,endAngle:j,value:p[s]},j+=k}for(m=-1;++m<f;)for(n=m-1;++n<f;){var x=o[m+"-"+n],y=o[n+"-"+m];(x.value||y.value)&&c.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}i&&b()}function b(){c.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var c,d,e,f,g,h,i,j={},k=0;return j.matrix=function(a){return arguments.length?(f=(e=a)&&e.length,c=d=null,j):e},j.padding=function(a){return arguments.length?(k=a,c=d=null,j):k},j.sortGroups=function(a){return arguments.length?(g=a,c=d=null,j):g},j.sortSubgroups=function(a){return arguments.length?(h=a,c=null,j):h},j.sortChords=function(a){return arguments.length?(i=a,c&&b(),j):i},j.chords=function(){return c||a(),c},j.groups=function(){return d||a(),d},j},We.layout.force=function(){function a(a){return function(b,c,d,e){if(b.point!==a){var f=b.cx-a.x,g=b.cy-a.y,h=e-c,i=f*f+g*g;if(h*h/r<i){if(i<p){var j=b.charge/i;a.px-=f*j,a.py-=g*j}return!0}b.point&&i&&i<p&&(j=b.pointCharge/i,a.px-=f*j,a.py-=g*j)}return!b.charge}}function b(a){a.px=We.event.x,a.py=We.event.y,i.resume()}var c,d,e,f,g,h,i={},j=We.dispatch("start","tick","end"),k=[1,1],l=.9,m=bh,n=ch,o=-30,p=dh,q=.1,r=.64,t=[],u=[];return i.tick=function(){if((e*=.99)<.005)return c=null,j.end({type:"end",alpha:e=0}),!0;var b,d,i,m,n,p,r,s,v,w=t.length,x=u.length;for(d=0;d<x;++d)m=(i=u[d]).source,(p=(s=(n=i.target).x-m.x)*s+(v=n.y-m.y)*v)&&(s*=p=e*g[d]*((p=Math.sqrt(p))-f[d])/p,v*=p,n.x-=s*(r=m.weight+n.weight?m.weight/(m.weight+n.weight):.5),n.y-=v*r,m.x+=s*(r=1-r),m.y+=v*r);if((r=e*q)&&(s=k[0]/2,v=k[1]/2,d=-1,r))for(;++d<w;)(i=t[d]).x+=(s-i.x)*r,i.y+=(v-i.y)*r;if(o)for(function a(b,c,d){var e=0,f=0;if(b.charge=0,!b.leaf)for(var g,h=b.nodes,i=h.length,j=-1;++j<i;)null!=(g=h[j])&&(a(g,c,d),b.charge+=g.charge,e+=g.charge*g.cx,f+=g.charge*g.cy);if(b.point){b.leaf||(b.point.x+=Math.random()-.5,b.point.y+=Math.random()-.5);var k=c*d[b.point.index];b.charge+=b.pointCharge=k,e+=k*b.point.x,f+=k*b.point.y}b.cx=e/b.charge,b.cy=f/b.charge}(b=We.geom.quadtree(t),e,h),d=-1;++d<w;)(i=t[d]).fixed||b.visit(a(i));for(d=-1;++d<w;)(i=t[d]).fixed?(i.x=i.px,i.y=i.py):(i.x-=(i.px-(i.px=i.x))*l,i.y-=(i.py-(i.py=i.y))*l);j.tick({type:"tick",alpha:e})},i.nodes=function(a){return arguments.length?(t=a,i):t},i.links=function(a){return arguments.length?(u=a,i):u},i.size=function(a){return arguments.length?(k=a,i):k},i.linkDistance=function(a){return arguments.length?(m="function"==typeof a?a:+a,i):m},i.distance=i.linkDistance,i.linkStrength=function(a){return arguments.length?(n="function"==typeof a?a:+a,i):n},i.friction=function(a){return arguments.length?(l=+a,i):l},i.charge=function(a){return arguments.length?(o="function"==typeof a?a:+a,i):o},i.chargeDistance=function(a){return arguments.length?(p=a*a,i):Math.sqrt(p)},i.gravity=function(a){return arguments.length?(q=+a,i):q},i.theta=function(a){return arguments.length?(r=a*a,i):Math.sqrt(r)},i.alpha=function(a){return arguments.length?(a=+a,e?a>0?e=a:(c.c=null,c.t=NaN,c=null,j.end({type:"end",alpha:e=0})):a>0&&(j.start({type:"start",alpha:e=a}),c=za(i.tick)),i):e},i.start=function(){function a(a,d){if(!c){for(c=new Array(e),i=0;i<e;++i)c[i]=[];for(i=0;i<j;++i){var f=u[i];c[f.source.index].push(f.target),c[f.target.index].push(f.source)}}for(var g,h=c[b],i=-1,k=h.length;++i<k;)if(!isNaN(g=h[i][a]))return g;return Math.random()*d}var b,c,d,e=t.length,j=u.length,l=k[0],p=k[1];for(b=0;b<e;++b)(d=t[b]).index=b,d.weight=0;for(b=0;b<j;++b)"number"==typeof(d=u[b]).source&&(d.source=t[d.source]),"number"==typeof d.target&&(d.target=t[d.target]),++d.source.weight,++d.target.weight;for(b=0;b<e;++b)d=t[b],isNaN(d.x)&&(d.x=a("x",l)),isNaN(d.y)&&(d.y=a("y",p)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(f=[],"function"==typeof m)for(b=0;b<j;++b)f[b]=+m.call(this,u[b],b);else for(b=0;b<j;++b)f[b]=m;if(g=[],"function"==typeof n)for(b=0;b<j;++b)g[b]=+n.call(this,u[b],b);else for(b=0;b<j;++b)g[b]=n;if(h=[],"function"==typeof o)for(b=0;b<e;++b)h[b]=+o.call(this,t[b],b);else for(b=0;b<e;++b)h[b]=o;return i.resume()},i.resume=function(){return i.alpha(.1)},i.stop=function(){return i.alpha(0)},i.drag=function(){if(d||(d=We.behavior.drag().origin(s).on("dragstart.force",nd).on("drag.force",b).on("dragend.force",od)),!arguments.length)return d;this.on("mouseover.force",pd).on("mouseout.force",qd).call(d)},We.rebind(i,j,"on")};var bh=20,ch=1,dh=1/0;We.layout.hierarchy=function(){function a(e){var f,g=[e],h=[];for(e.depth=0;null!=(f=g.pop());)if(h.push(f),(j=c.call(a,f,f.depth))&&(i=j.length)){for(var i,j,k;--i>=0;)g.push(k=j[i]),k.parent=f,k.depth=f.depth+1;d&&(f.value=0),f.children=j}else d&&(f.value=+d.call(a,f,f.depth)||0),delete f.children;return td(e,function(a){var c,e;b&&(c=a.children)&&c.sort(b),d&&(e=a.parent)&&(e.value+=a.value)}),h}var b=wd,c=ud,d=vd;return a.sort=function(c){return arguments.length?(b=c,a):b},a.children=function(b){return arguments.length?(c=b,a):c},a.value=function(b){return arguments.length?(d=b,a):d},a.revalue=function(b){return d&&(sd(b,function(a){a.children&&(a.value=0)}),td(b,function(b){var c;b.children||(b.value=+d.call(a,b,b.depth)||0),(c=b.parent)&&(c.value+=b.value)})),b},a},We.layout.partition=function(){function a(a,d){var e=b.call(this,a,d);return function a(b,c,d,e){var f=b.children;if(b.x=c,b.y=b.depth*e,b.dx=d,b.dy=e,f&&(g=f.length)){var g,h,i,j=-1;for(d=b.value?d/b.value:0;++j<g;)a(h=f[j],c,i=h.value*d,e),c+=i}}(e[0],0,c[0],c[1]/function a(b){var c=b.children,d=0;if(c&&(e=c.length))for(var e,f=-1;++f<e;)d=Math.max(d,a(c[f]));return 1+d}(e[0])),e}var b=We.layout.hierarchy(),c=[1,1];return a.size=function(b){return arguments.length?(c=b,a):c},rd(a,b)},We.layout.pie=function(){function a(g){var h,i=g.length,j=g.map(function(c,d){return+b.call(a,c,d)}),k=+("function"==typeof d?d.apply(this,arguments):d),l=("function"==typeof e?e.apply(this,arguments):e)-k,m=Math.min(Math.abs(l)/i,+("function"==typeof f?f.apply(this,arguments):f)),n=m*(l<0?-1:1),o=We.sum(j),p=o?(l-i*n)/o:0,q=We.range(i),r=[];return null!=c&&q.sort(c===eh?function(a,b){return j[b]-j[a]}:function(a,b){return c(g[a],g[b])}),q.forEach(function(a){r[a]={data:g[a],value:h=j[a],startAngle:k,endAngle:k+=h*p+n,padAngle:m}}),r}var b=Number,c=eh,d=0,e=zf,f=0;return a.value=function(c){return arguments.length?(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(e=b,a):e},a.padAngle=function(b){return arguments.length?(f=b,a):f},a};var eh={};We.layout.stack=function(){function a(h,i){if(!(m=h.length))return h;var j=h.map(function(c,d){return b.call(a,c,d)}),k=j.map(function(b){return b.map(function(b,c){return[f.call(a,b,c),g.call(a,b,c)]})}),l=c.call(a,k,i);j=We.permute(j,l),k=We.permute(k,l);var m,n,o,p,q=d.call(a,k,i),r=j[0].length;for(o=0;o<r;++o)for(e.call(a,j[0][o],p=q[o],k[0][o][1]),n=1;n<m;++n)e.call(a,j[n][o],p+=k[n-1][o][1],k[n][o][1]);return h}var b=s,c=Bd,d=Cd,e=Ad,f=yd,g=zd;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c="function"==typeof b?b:fh.get(b)||Bd,a):c},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:gh.get(b)||Cd,a):d},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(g=b,a):g},a.out=function(b){return arguments.length?(e=b,a):e},a};var fh=We.map({"inside-out":function(a){var b,c,d=a.length,e=a.map(Dd),f=a.map(Ed),g=We.range(d).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(b=0;b<d;++b)c=g[b],h<i?(h+=f[c],j.push(c)):(i+=f[c],k.push(c));return k.reverse().concat(j)},reverse:function(a){return We.range(a.length).reverse()},default:Bd}),gh=We.map({silhouette:function(a){var b,c,d,e=a.length,f=a[0].length,g=[],h=0,i=[];for(c=0;c<f;++c){for(b=0,d=0;b<e;b++)d+=a[b][c][1];d>h&&(h=d),g.push(d)}for(c=0;c<f;++c)i[c]=(h-g[c])/2;return i},wiggle:function(a){var b,c,d,e,f,g,h,i,j,k=a.length,l=a[0],m=l.length,n=[];for(n[0]=i=j=0,c=1;c<m;++c){for(b=0,e=0;b<k;++b)e+=a[b][c][1];for(b=0,f=0,h=l[c][0]-l[c-1][0];b<k;++b){for(d=0,g=(a[b][c][1]-a[b][c-1][1])/(2*h);d<b;++d)g+=(a[d][c][1]-a[d][c-1][1])/h;f+=g*a[b][c][1]}n[c]=i-=e?f/e*h:0,i<j&&(j=i)}for(c=0;c<m;++c)n[c]-=j;return n},expand:function(a){var b,c,d,e=a.length,f=a[0].length,g=1/e,h=[];for(c=0;c<f;++c){for(b=0,d=0;b<e;b++)d+=a[b][c][1];if(d)for(b=0;b<e;b++)a[b][c][1]/=d;else for(b=0;b<e;b++)a[b][c][1]=g}for(c=0;c<f;++c)h[c]=0;return h},zero:Cd});We.layout.histogram=function(){function a(a,f){for(var g,h,i=[],j=a.map(c,this),k=d.call(this,j,f),l=e.call(this,k,j,f),m=(f=-1,j.length),n=l.length-1,o=b?1:1/m;++f<n;)(g=i[f]=[]).dx=l[f+1]-(g.x=l[f]),g.y=0;if(n>0)for(f=-1;++f<m;)(h=j[f])>=k[0]&&h<=k[1]&&((g=i[We.bisect(l,h,1,n)-1]).y+=o,g.push(a[f]));return i}var b=!0,c=Number,d=Id,e=Gd;return a.value=function(b){return arguments.length?(c=b,a):c},a.range=function(b){return arguments.length?(d=wa(b),a):d},a.bins=function(b){return arguments.length?(e="number"==typeof b?function(a){return Hd(a,b)}:wa(b),a):e},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a},We.layout.pack=function(){function a(a,f){var g=c.call(this,a,f),h=g[0],i=e[0],j=e[1],k=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(h.x=h.y=0,td(h,function(a){a.r=+k(a.value)}),td(h,Nd),d){var l=d*(b?1:Math.max(2*h.r/i,2*h.r/j))/2;td(h,function(a){a.r+=l}),td(h,Nd),td(h,function(a){a.r-=l})}return function a(b,c,d,e){var f=b.children;if(b.x=c+=e*b.x,b.y=d+=e*b.y,b.r*=e,f)for(var g=-1,h=f.length;++g<h;)a(f[g],c,d,e)}(h,i/2,j/2,b?1:1/Math.max(2*h.r/i,2*h.r/j)),g}var b,c=We.layout.hierarchy().sort(Jd),d=0,e=[1,1];return a.size=function(b){return arguments.length?(e=b,a):e},a.radius=function(c){return arguments.length?(b=null==c||"function"==typeof c?c:+c,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},rd(a,c)},We.layout.tree=function(){function a(a,i){var j=e.call(this,a,i),k=j[0],l=function(a){for(var b,c={A:null,children:[a]},d=[c];null!=(b=d.pop());)for(var e,f=b.children,g=0,h=f.length;g<h;++g)d.push((f[g]=e={_:f[g],parent:b,children:(e=f[g].children)&&e.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:g}).a=e);return c.children[0]}(k);if(td(l,b),l.parent.m=-l.z,sd(l,c),h)sd(k,d);else{var m=k,n=k,o=k;sd(k,function(a){a.x<m.x&&(m=a),a.x>n.x&&(n=a),a.depth>o.depth&&(o=a)});var p=f(m,n)/2-m.x,q=g[0]/(n.x+f(n,m)/2+p),r=g[1]/(o.depth||1);sd(k,function(a){a.x=(a.x+p)*q,a.y=a.depth*r})}return j}function b(a){var b=a.children,c=a.parent.children,d=a.i?c[a.i-1]:null;if(b.length){!function(a){for(var b,c=0,d=0,e=a.children,f=e.length;--f>=0;)(b=e[f]).z+=c,b.m+=c,c+=b.s+(d+=b.c)}(a);var e=(b[0].z+b[b.length-1].z)/2;d?(a.z=d.z+f(a._,d._),a.m=a.z-e):a.z=e}else d&&(a.z=d.z+f(a._,d._));a.parent.A=function(a,b,c){if(b){for(var d,e=a,g=a,h=b,i=e.parent.children[0],j=e.m,k=g.m,l=h.m,m=i.m;h=Td(h),e=Sd(e),h&&e;)i=Sd(i),(g=Td(g)).a=a,(d=h.z+l-e.z-j+f(h._,e._))>0&&(Ud(Vd(h,a,c),a,d),j+=d,k+=d),l+=h.m,j+=e.m,m+=i.m,k+=g.m;h&&!Td(g)&&(g.t=h,g.m+=l-k),e&&!Sd(i)&&(i.t=e,i.m+=j-m,c=a)}return c}(a,d,a.parent.A||c[0])}function c(a){a._.x=a.z+a.parent.m,a.m+=a.parent.m}function d(a){a.x*=g[0],a.y=a.depth*g[1]}var e=We.layout.hierarchy().sort(null).value(null),f=Rd,g=[1,1],h=null;return a.separation=function(b){return arguments.length?(f=b,a):f},a.size=function(b){return arguments.length?(h=null==(g=b)?d:null,a):h?null:g},a.nodeSize=function(b){return arguments.length?(h=null==(g=b)?null:d,a):h?g:null},rd(a,e)},We.layout.cluster=function(){function a(a,f){var g,h=b.call(this,a,f),i=h[0],j=0;td(i,function(a){var b=a.children;b&&b.length?(a.x=function(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}(b),a.y=function(a){return 1+We.max(a,function(a){return a.y})}(b)):(a.x=g?j+=c(a,g):0,a.y=0,g=a)});var k=function a(b){var c=b.children;return c&&c.length?a(c[0]):b}(i),l=function a(b){var c,d=b.children;return d&&(c=d.length)?a(d[c-1]):b}(i),m=k.x-c(k,l)/2,n=l.x+c(l,k)/2;return td(i,e?function(a){a.x=(a.x-i.x)*d[0],a.y=(i.y-a.y)*d[1]}:function(a){a.x=(a.x-m)/(n-m)*d[0],a.y=(1-(i.y?a.y/i.y:1))*d[1]}),h}var b=We.layout.hierarchy().sort(null).value(null),c=Rd,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},rd(a,b)},We.layout.treemap=function(){function a(a,b){for(var c,d,e=-1,f=a.length;++e<f;)d=(c=a[e]).value*(b<0?0:b),c.area=isNaN(d)||d<=0?0:d}function b(c){var f=c.children;if(f&&f.length){var g,h,i,j=l(c),k=[],m=f.slice(),o=1/0,p="slice"===n?j.dx:"dice"===n?j.dy:"slice-dice"===n?1&c.depth?j.dy:j.dx:Math.min(j.dx,j.dy);for(a(m,j.dx*j.dy/c.value),k.area=0;(i=m.length)>0;)k.push(g=m[i-1]),k.area+=g.area,"squarify"!==n||(h=d(k,p))<=o?(m.pop(),o=h):(k.area-=k.pop().area,e(k,p,j,!1),p=Math.min(j.dx,j.dy),k.length=k.area=0,o=1/0);k.length&&(e(k,p,j,!0),k.length=k.area=0),f.forEach(b)}}function c(b){var d=b.children;if(d&&d.length){var f,g=l(b),h=d.slice(),i=[];for(a(h,g.dx*g.dy/b.value),i.area=0;f=h.pop();)i.push(f),i.area+=f.area,null!=f.z&&(e(i,f.z?g.dx:g.dy,g,!h.length),i.length=i.area=0);d.forEach(c)}}function d(a,b){for(var c,d=a.area,e=0,f=1/0,g=-1,h=a.length;++g<h;)(c=a[g].area)&&(c<f&&(f=c),c>e&&(e=c));return b*=b,(d*=d)?Math.max(b*e*o/d,d/(b*f*o)):1/0}function e(a,b,c,d){var e,f=-1,g=a.length,h=c.x,j=c.y,k=b?i(a.area/b):0;if(b==c.dx){for((d||k>c.dy)&&(k=c.dy);++f<g;)(e=a[f]).x=h,e.y=j,e.dy=k,h+=e.dx=Math.min(c.x+c.dx-h,k?i(e.area/k):0);e.z=!0,e.dx+=c.x+c.dx-h,c.y+=k,c.dy-=k}else{for((d||k>c.dx)&&(k=c.dx);++f<g;)(e=a[f]).x=h,e.y=j,e.dx=k,j+=e.dy=Math.min(c.y+c.dy-j,k?i(e.area/k):0);e.z=!1,e.dy+=c.y+c.dy-j,c.x+=k,c.dx-=k}}function f(d){var e=g||h(d),f=e[0];return f.x=f.y=0,f.value?(f.dx=j[0],f.dy=j[1]):f.dx=f.dy=0,g&&h.revalue(f),a([f],f.dx*f.dy/f.value),(g?c:b)(f),m&&(g=e),e}var g,h=We.layout.hierarchy(),i=Math.round,j=[1,1],k=null,l=Wd,m=!1,n="squarify",o=.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?(j=a,f):j},f.padding=function(a){function b(b){return Xd(b,a)}if(!arguments.length)return k;var c;return l=null==(k=a)?Wd:"function"==(c=typeof a)?function(b){var c=a.call(f,b,b.depth);return null==c?Wd(b):Xd(b,"number"==typeof c?[c,c,c,c]:c)}:"number"===c?(a=[a,a,a,a],b):b,f},f.round=function(a){return arguments.length?(i=a?Math.round:Number,f):i!=Number},f.sticky=function(a){return arguments.length?(m=a,g=null,f):m},f.ratio=function(a){return arguments.length?(o=a,f):o},f.mode=function(a){return arguments.length?(n=a+"",f):n},rd(f,h)},We.random={normal:function(a,b){var c=arguments.length;return c<2&&(b=1),c<1&&(a=0),function(){var c,d,e;do{e=(c=2*Math.random()-1)*c+(d=2*Math.random()-1)*d}while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var a=We.random.normal.apply(We,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=We.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,c=0;c<a;c++)b+=Math.random();return b}}},We.scale={};var hh={floor:s,ceil:s};We.scale.linear=function(){return function a(b,c,d,e){function f(){var a=Math.min(b.length,c.length)>2?be:$d,f=e?kd:jd;return h=a(b,c,f,d),i=a(c,b,f,Uc),g}function g(a){return h(a)}var h,i;return g.invert=function(a){return i(a)},g.domain=function(a){return arguments.length?(b=a.map(Number),f()):b},g.range=function(a){return arguments.length?(c=a,f()):c},g.rangeRound=function(a){return g.range(a).interpolate(dd)},g.clamp=function(a){return arguments.length?(e=a,f()):e},g.interpolate=function(a){return arguments.length?(d=a,f()):d},g.ticks=function(a){return fe(b,a)},g.tickFormat=function(a,c){return ge(b,a,c)},g.nice=function(a){return de(b,a),f()},g.copy=function(){return a(b,c,d,e)},f()}([0,1],[0,1],Uc,!1)};var ih={s:1,g:1,p:1,r:1,e:1};We.scale.log=function(){return function a(b,c,d,e){function f(a){return(d?Math.log(a<0?0:a):-Math.log(a>0?0:-a))/Math.log(c)}function g(a){return d?Math.pow(c,a):-Math.pow(c,-a)}function h(a){return b(f(a))}return h.invert=function(a){return g(b.invert(a))},h.domain=function(a){return arguments.length?(d=a[0]>=0,b.domain((e=a.map(Number)).map(f)),h):e},h.base=function(a){return arguments.length?(c=+a,b.domain(e.map(f)),h):c},h.nice=function(){var a=_d(e.map(f),d?Math:kh);return b.domain(a),e=a.map(g),h},h.ticks=function(){var a=Yd(e),b=[],h=a[0],i=a[1],j=Math.floor(f(h)),k=Math.ceil(f(i)),l=c%1?2:c;if(isFinite(k-j)){if(d){for(;j<k;j++)for(var m=1;m<l;m++)b.push(g(j)*m);b.push(g(j))}else for(b.push(g(j));j++<k;)for(var m=l-1;m>0;m--)b.push(g(j)*m);for(j=0;b[j]<h;j++);for(k=b.length;b[k-1]>i;k--);b=b.slice(j,k)}return b},h.tickFormat=function(a,b){if(!arguments.length)return jh;arguments.length<2?b=jh:"function"!=typeof b&&(b=We.format(b));var d=Math.max(1,c*a/h.ticks().length);return function(a){var e=a/g(Math.round(f(a)));return e*c<c-.5&&(e*=c),e<=d?b(a):""}},h.copy=function(){return a(b.copy(),c,d,e)},ce(h,b)}(We.scale.linear().domain([0,1]),10,!0,[1,10])};var jh=We.format(".0e"),kh={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};We.scale.pow=function(){return function a(b,c,d){function e(a){return b(f(a))}var f=ie(c),g=ie(1/c);return e.invert=function(a){return g(b.invert(a))},e.domain=function(a){return arguments.length?(b.domain((d=a.map(Number)).map(f)),e):d},e.ticks=function(a){return fe(d,a)},e.tickFormat=function(a,b){return ge(d,a,b)},e.nice=function(a){return e.domain(de(d,a))},e.exponent=function(a){return arguments.length?(f=ie(c=a),g=ie(1/c),b.domain(d.map(f)),e):c},e.copy=function(){return a(b.copy(),c,d)},ce(e,b)}(We.scale.linear(),1,[0,1])},We.scale.sqrt=function(){return We.scale.pow().exponent(.5)},We.scale.ordinal=function(){return function a(b,c){function d(a){return g[((f.get(a)||("range"===c.t?f.set(a,b.push(a)):NaN))-1)%g.length]}function e(a,c){return We.range(b.length).map(function(b){return a+c*b})}var f,g,h;return d.domain=function(a){if(!arguments.length)return b;b=[],f=new j;for(var e,g=-1,h=a.length;++g<h;)f.has(e=a[g])||f.set(e,b.push(e));return d[c.t].apply(d,c.a)},d.range=function(a){return arguments.length?(g=a,h=0,c={t:"range",a:arguments},d):g},d.rangePoints=function(a,f){arguments.length<2&&(f=0);var i=a[0],j=a[1],k=b.length<2?(i=(i+j)/2,0):(j-i)/(b.length-1+f);return g=e(i+k*f/2,k),h=0,c={t:"rangePoints",a:arguments},d},d.rangeRoundPoints=function(a,f){arguments.length<2&&(f=0);var i=a[0],j=a[1],k=b.length<2?(i=j=Math.round((i+j)/2),0):(j-i)/(b.length-1+f)|0;return g=e(i+Math.round(k*f/2+(j-i-(b.length-1+f)*k)/2),k),h=0,c={t:"rangeRoundPoints",a:arguments},d},d.rangeBands=function(a,f,i){arguments.length<2&&(f=0),arguments.length<3&&(i=f);var j=a[1]<a[0],k=a[j-0],l=a[1-j],m=(l-k)/(b.length-f+2*i);return g=e(k+m*i,m),j&&g.reverse(),h=m*(1-f),c={t:"rangeBands",a:arguments},d},d.rangeRoundBands=function(a,f,i){arguments.length<2&&(f=0),arguments.length<3&&(i=f);var j=a[1]<a[0],k=a[j-0],l=a[1-j],m=Math.floor((l-k)/(b.length-f+2*i));return g=e(k+Math.round((l-k-(b.length-f)*m)/2),m),j&&g.reverse(),h=Math.round(m*(1-f)),c={t:"rangeRoundBands",a:arguments},d},d.rangeBand=function(){return h},d.rangeExtent=function(){return Yd(c.a[0])},d.copy=function(){return a(b,c)},d.domain(b)}([],{t:"range",a:[[]]})},We.scale.category10=function(){return We.scale.ordinal().range(lh)},We.scale.category20=function(){return We.scale.ordinal().range(mh)},We.scale.category20b=function(){return We.scale.ordinal().range(nh)},We.scale.category20c=function(){return We.scale.ordinal().range(oh)};var lh=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(pa),mh=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(pa),nh=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(pa),oh=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(pa);We.scale.quantile=function(){return function a(b,c){function g(){var a=0,d=c.length;for(i=[];++a<d;)i[a-1]=We.quantile(b,a/d);return h}function h(a){if(!isNaN(a=+a))return c[We.bisect(i,a)]}var i;return h.domain=function(a){return arguments.length?(b=a.map(e).filter(f).sort(d),g()):b},h.range=function(a){return arguments.length?(c=a,g()):c},h.quantiles=function(){return i},h.invertExtent=function(a){return(a=c.indexOf(a))<0?[NaN,NaN]:[a>0?i[a-1]:b[0],a<i.length?i[a]:b[b.length-1]]},h.copy=function(){return a(b,c)},g()}([],[])},We.scale.quantize=function(){return function a(b,c,d){function e(a){return d[Math.max(0,Math.min(h,Math.floor(g*(a-b))))]}function f(){return g=d.length/(c-b),h=d.length-1,e}var g,h;return e.domain=function(a){return arguments.length?(b=+a[0],c=+a[a.length-1],f()):[b,c]},e.range=function(a){return arguments.length?(d=a,f()):d},e.invertExtent=function(a){return[a=(a=d.indexOf(a))<0?NaN:a/g+b,a+1/g]},e.copy=function(){return a(b,c,d)},f()}(0,1,[0,1])},We.scale.threshold=function(){return function a(b,c){function d(a){if(a<=a)return c[We.bisect(b,a)]}return d.domain=function(a){return arguments.length?(b=a,d):b},d.range=function(a){return arguments.length?(c=a,d):c},d.invertExtent=function(a){return a=c.indexOf(a),[b[a-1],b[a]]},d.copy=function(){return a(b,c)},d}([.5],[0,1])},We.scale.identity=function(){return function a(b){function c(a){return+a}return c.invert=c,c.domain=c.range=function(a){return arguments.length?(b=a.map(c),c):b},
c.ticks=function(a){return fe(b,a)},c.tickFormat=function(a,c){return ge(b,a,c)},c.copy=function(){return a(b)},c}([0,1])},We.svg={},We.svg.arc=function(){function a(){var a=Math.max(0,+c.apply(this,arguments)),j=Math.max(0,+d.apply(this,arguments)),k=g.apply(this,arguments)-Bf,l=h.apply(this,arguments)-Bf,m=Math.abs(l-k),n=k>l?0:1;if(j<a&&(o=j,j=a,a=o),m>=Af)return b(j,n)+(a?b(a,1-n):"")+"Z";var o,p,q,r,s,t,u,v,w,x,y,z,A=0,B=0,C=[];if((r=(+i.apply(this,arguments)||0)/2)&&(q=f===ph?Math.sqrt(a*a+j*j):+f.apply(this,arguments),n||(B*=-1),j&&(B=_(q/j*Math.sin(r))),a&&(A=_(q/a*Math.sin(r)))),j){s=j*Math.cos(k+B),t=j*Math.sin(k+B),u=j*Math.cos(l-B),v=j*Math.sin(l-B);var D=Math.abs(l-k-2*B)<=yf?0:1;if(B&&pe(s,t,u,v)===n^D){var E=(k+l)/2;s=j*Math.cos(E),t=j*Math.sin(E),u=v=null}}else s=t=0;if(a){w=a*Math.cos(l-A),x=a*Math.sin(l-A),y=a*Math.cos(k+A),z=a*Math.sin(k+A);var F=Math.abs(k-l+2*A)<=yf?0:1;if(A&&pe(w,x,y,z)===1-n^F){var G=(k+l)/2;w=a*Math.cos(G),x=a*Math.sin(G),y=z=null}}else w=x=0;if(m>wf&&(o=Math.min(Math.abs(j-a)/2,+e.apply(this,arguments)))>.001){p=a<j^n?0:1;var H=o,I=o;if(m<yf){var J=null==y?[w,x]:null==u?[s,t]:oc([s,t],[y,z],[u,v],[w,x]),K=s-J[0],L=t-J[1],M=u-J[0],N=v-J[1],O=1/Math.sin(Math.acos((K*M+L*N)/(Math.sqrt(K*K+L*L)*Math.sqrt(M*M+N*N)))/2),P=Math.sqrt(J[0]*J[0]+J[1]*J[1]);I=Math.min(o,(a-P)/(O-1)),H=Math.min(o,(j-P)/(O+1))}if(null!=u){var Q=qe(null==y?[w,x]:[y,z],[s,t],j,H,n),R=qe([u,v],[w,x],j,H,n);o===H?C.push("M",Q[0],"A",H,",",H," 0 0,",p," ",Q[1],"A",j,",",j," 0 ",1-n^pe(Q[1][0],Q[1][1],R[1][0],R[1][1]),",",n," ",R[1],"A",H,",",H," 0 0,",p," ",R[0]):C.push("M",Q[0],"A",H,",",H," 0 1,",p," ",R[0])}else C.push("M",s,",",t);if(null!=y){var S=qe([s,t],[y,z],a,-I,n),T=qe([w,x],null==u?[s,t]:[u,v],a,-I,n);o===I?C.push("L",T[0],"A",I,",",I," 0 0,",p," ",T[1],"A",a,",",a," 0 ",n^pe(T[1][0],T[1][1],S[1][0],S[1][1]),",",1-n," ",S[1],"A",I,",",I," 0 0,",p," ",S[0]):C.push("L",T[0],"A",I,",",I," 0 0,",p," ",S[0])}else C.push("L",w,",",x)}else C.push("M",s,",",t),null!=u&&C.push("A",j,",",j," 0 ",D,",",n," ",u,",",v),C.push("L",w,",",x),null!=y&&C.push("A",a,",",a," 0 ",F,",",1-n," ",y,",",z);return C.push("Z"),C.join("")}function b(a,b){return"M0,"+a+"A"+a+","+a+" 0 1,"+b+" 0,"+-a+"A"+a+","+a+" 0 1,"+b+" 0,"+a}var c=ke,d=le,e=je,f=ph,g=me,h=ne,i=oe;return a.innerRadius=function(b){return arguments.length?(c=wa(b),a):c},a.outerRadius=function(b){return arguments.length?(d=wa(b),a):d},a.cornerRadius=function(b){return arguments.length?(e=wa(b),a):e},a.padRadius=function(b){return arguments.length?(f=b==ph?ph:wa(b),a):f},a.startAngle=function(b){return arguments.length?(g=wa(b),a):g},a.endAngle=function(b){return arguments.length?(h=wa(b),a):h},a.padAngle=function(b){return arguments.length?(i=wa(b),a):i},a.centroid=function(){var a=(+c.apply(this,arguments)+ +d.apply(this,arguments))/2,b=(+g.apply(this,arguments)+ +h.apply(this,arguments))/2-Bf;return[Math.cos(b)*a,Math.sin(b)*a]},a};var ph="auto";We.svg.line=function(){return re(s)};var qh=We.map({linear:se,"linear-closed":te,step:function(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return c>1&&e.push("H",d[0]),e.join("")},"step-before":ue,"step-after":ve,basis:ye,"basis-open":function(a){if(a.length<4)return se(a);for(var b,c=[],d=-1,e=a.length,f=[0],g=[0];++d<3;)b=a[d],f.push(b[0]),g.push(b[1]);for(c.push(ze(th,f)+","+ze(th,g)),--d;++d<e;)b=a[d],f.shift(),f.push(b[0]),g.shift(),g.push(b[1]),Ae(c,f,g);return c.join("")},"basis-closed":function(a){for(var b,c,d=-1,e=a.length,f=e+4,g=[],h=[];++d<4;)c=a[d%e],g.push(c[0]),h.push(c[1]);for(b=[ze(th,g),",",ze(th,h)],--d;++d<f;)c=a[d%e],g.shift(),g.push(c[0]),h.shift(),h.push(c[1]),Ae(b,g,h);return b.join("")},bundle:function(a,b){var c=a.length-1;if(c)for(var d,e,f=a[0][0],g=a[0][1],h=a[c][0]-f,i=a[c][1]-g,j=-1;++j<=c;)d=a[j],e=j/c,d[0]=b*d[0]+(1-b)*(f+e*h),d[1]=b*d[1]+(1-b)*(g+e*i);return ye(a)},cardinal:function(a,b){return a.length<3?se(a):a[0]+we(a,xe(a,b))},"cardinal-open":function(a,b){return a.length<4?se(a):a[1]+we(a.slice(1,-1),xe(a,b))},"cardinal-closed":function(a,b){return a.length<3?te(a):a[0]+we((a.push(a[0]),a),xe([a[a.length-2]].concat(a,[a[1]]),b))},monotone:function(a){return a.length<3?se(a):a[0]+we(a,function(a){for(var b,c,d,e,f=[],g=function(a){for(var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=Be(e,f);++b<c;)d[b]=(g+(g=Be(e=f,f=a[b+1])))/2;return d[b]=g,d}(a),h=-1,i=a.length-1;++h<i;)b=Be(a[h],a[h+1]),ef(b)<wf?g[h]=g[h+1]=0:(c=g[h]/b,d=g[h+1]/b,(e=c*c+d*d)>9&&(e=3*b/Math.sqrt(e),g[h]=e*c,g[h+1]=e*d));for(h=-1;++h<=i;)e=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),f.push([e||0,g[h]*e||0]);return f}(a))}});qh.forEach(function(a,b){b.key=a,b.closed=/-closed$/.test(a)});var rh=[0,2/3,1/3,0],sh=[0,1/3,2/3,0],th=[0,1/6,2/3,1/6];We.svg.line.radial=function(){var a=re(Ce);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},ue.reverse=ve,ve.reverse=ue,We.svg.area=function(){return De(s)},We.svg.area.radial=function(){var a=De(Ce);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},We.svg.chord=function(){function a(a,g){var h,i,j=b(this,e,a,g),k=b(this,f,a,g);return"M"+j.p0+c(j.r,j.p1,j.a1-j.a0)+(i=k,(h=j).a0==i.a0&&h.a1==i.a1?d(j.r,j.p1,j.r,j.p0):d(j.r,j.p1,k.r,k.p0)+c(k.r,k.p1,k.a1-k.a0)+d(k.r,k.p1,j.r,j.p0))+"Z"}function b(a,b,c,d){var e=b.call(a,c,d),f=g.call(a,e,d),j=h.call(a,e,d)-Bf,k=i.call(a,e,d)-Bf;return{r:f,a0:j,a1:k,p0:[f*Math.cos(j),f*Math.sin(j)],p1:[f*Math.cos(k),f*Math.sin(k)]}}function c(a,b,c){return"A"+a+","+a+" 0 "+ +(c>yf)+",1 "+b}function d(a,b,c,d){return"Q 0,0 "+d}var e=bc,f=cc,g=Ee,h=me,i=ne;return a.radius=function(b){return arguments.length?(g=wa(b),a):g},a.source=function(b){return arguments.length?(e=wa(b),a):e},a.target=function(b){return arguments.length?(f=wa(b),a):f},a.startAngle=function(b){return arguments.length?(h=wa(b),a):h},a.endAngle=function(b){return arguments.length?(i=wa(b),a):i},a},We.svg.diagonal=function(){function a(a,e){var f=b.call(this,a,e),g=c.call(this,a,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return"M"+(i=i.map(d))[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var b=bc,c=cc,d=Fe;return a.source=function(c){return arguments.length?(b=wa(c),a):b},a.target=function(b){return arguments.length?(c=wa(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a},We.svg.diagonal.radial=function(){var a=We.svg.diagonal(),b=Fe,c=a.projection;return a.projection=function(a){return arguments.length?c(function(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]-Bf;return[c*Math.cos(d),c*Math.sin(d)]}}(b=a)):b},a},We.svg.symbol=function(){function a(a,d){return(uh.get(b.call(this,a,d))||Ie)(c.call(this,a,d))}var b=He,c=Ge;return a.type=function(c){return arguments.length?(b=wa(c),a):b},a.size=function(b){return arguments.length?(c=wa(b),a):c},a};var uh=We.map({circle:Ie,cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*wh)),c=b*wh;return"M0,"+-b+"L"+c+",0 0,"+b+" "+-c+",0Z"},square:function(a){var b=Math.sqrt(a)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/vh),c=b*vh/2;return"M0,"+c+"L"+b+","+-c+" "+-b+","+-c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/vh),c=b*vh/2;return"M0,"+-c+"L"+b+","+c+" "+-b+","+c+"Z"}});We.svg.symbolTypes=uh.keys();var vh=Math.sqrt(3),wh=Math.tan(30*Cf);of.transition=function(a){for(var b,c,d=xh||++Bh,e=Ne(a),f=[],g=yh||{time:Date.now(),ease:$c,delay:0,duration:250},h=-1,i=this.length;++h<i;){f.push(b=[]);for(var j=this[h],k=-1,l=j.length;++k<l;)(c=j[k])&&Oe(c,k,e,d,g),b.push(c)}return Ke(f,e,d)},of.interrupt=function(a){return this.each(null==a?zh:Je(Ne(a)))};var xh,yh,zh=Je(Ne()),Ah=[],Bh=0;Ah.call=of.call,Ah.empty=of.empty,Ah.node=of.node,Ah.size=of.size,We.transition=function(a,b){return a&&a.transition?xh?a.transition(b):a:We.selection().transition(a)},We.transition.prototype=Ah,Ah.select=function(a){var b,c,d,e=this.id,f=this.namespace,g=[];a=C(a);for(var h=-1,i=this.length;++h<i;){g.push(b=[]);for(var j=this[h],k=-1,l=j.length;++k<l;)(d=j[k])&&(c=a.call(d,d.__data__,k,h))?("__data__"in d&&(c.__data__=d.__data__),Oe(c,k,f,e,d[f][e]),b.push(c)):b.push(null)}return Ke(g,f,e)},Ah.selectAll=function(a){var b,c,d,e,f,g=this.id,h=this.namespace,i=[];a=D(a);for(var j=-1,k=this.length;++j<k;)for(var l=this[j],m=-1,n=l.length;++m<n;)if(d=l[m]){f=d[h][g],c=a.call(d,d.__data__,m,j),i.push(b=[]);for(var o=-1,p=c.length;++o<p;)(e=c[o])&&Oe(e,o,h,g,f),b.push(e)}return Ke(i,h,g)},Ah.filter=function(a){var b,c,d=[];"function"!=typeof a&&(a=P(a));for(var e=0,f=this.length;e<f;e++){d.push(b=[]);for(var g,h=0,i=(g=this[e]).length;h<i;h++)(c=g[h])&&a.call(c,c.__data__,h,e)&&b.push(c)}return Ke(d,this.namespace,this.id)},Ah.tween=function(a,b){var c=this.id,d=this.namespace;return arguments.length<2?this.node()[d][c].tween.get(a):Q(this,null==b?function(b){b[d][c].tween.remove(a)}:function(e){e[d][c].tween.set(a,b)})},Ah.attr=function(a,b){function c(){this.removeAttribute(f)}function d(){this.removeAttributeNS(f.space,f.local)}if(arguments.length<2){for(b in a)this.attr(b,a[b]);return this}var e="transform"==a?id:Uc,f=We.ns.qualify(a);return Le(this,"attr."+a,b,f.local?function(a){return null==a?d:(a+="",function(){var b,c=this.getAttributeNS(f.space,f.local);return c!==a&&(b=e(c,a),function(a){this.setAttributeNS(f.space,f.local,b(a))})})}:function(a){return null==a?c:(a+="",function(){var b,c=this.getAttribute(f);return c!==a&&(b=e(c,a),function(a){this.setAttribute(f,b(a))})})})},Ah.attrTween=function(a,b){var c=We.ns.qualify(a);return this.tween("attr."+a,c.local?function(a,d){var e=b.call(this,a,d,this.getAttributeNS(c.space,c.local));return e&&function(a){this.setAttributeNS(c.space,c.local,e(a))}}:function(a,d){var e=b.call(this,a,d,this.getAttribute(c));return e&&function(a){this.setAttribute(c,e(a))}})},Ah.style=function(a,b,d){function e(){this.style.removeProperty(a)}var f=arguments.length;if(f<3){if("string"!=typeof a){for(d in f<2&&(b=""),a)this.style(d,a[d],b);return this}d=""}return Le(this,"style."+a,b,function(b){return null==b?e:(b+="",function(){var e,f=c(this).getComputedStyle(this,null).getPropertyValue(a);return f!==b&&(e=Uc(f,b),function(b){this.style.setProperty(a,e(b),d)})})})},Ah.styleTween=function(a,b,d){return arguments.length<3&&(d=""),this.tween("style."+a,function(e,f){var g=b.call(this,e,f,c(this).getComputedStyle(this,null).getPropertyValue(a));return g&&function(b){this.style.setProperty(a,g(b),d)}})},Ah.text=function(a){return Le(this,"text",a,Me)},Ah.remove=function(){var a=this.namespace;return this.each("end.transition",function(){var b;this[a].count<2&&(b=this.parentNode)&&b.removeChild(this)})},Ah.ease=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].ease:("function"!=typeof a&&(a=We.ease.apply(We,arguments)),Q(this,function(d){d[c][b].ease=a}))},Ah.delay=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].delay:Q(this,"function"==typeof a?function(d,e,f){d[c][b].delay=+a.call(d,d.__data__,e,f)}:(a=+a,function(d){d[c][b].delay=a}))},Ah.duration=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].duration:Q(this,"function"==typeof a?function(d,e,f){d[c][b].duration=Math.max(1,a.call(d,d.__data__,e,f))}:(a=Math.max(1,a),function(d){d[c][b].duration=a}))},Ah.each=function(a,b){var c=this.id,d=this.namespace;if(arguments.length<2){var e=yh,f=xh;try{xh=c,Q(this,function(b,e,f){yh=b[d][c],a.call(b,b.__data__,e,f)})}finally{yh=e,xh=f}}else Q(this,function(e){var f=e[d][c];(f.event||(f.event=We.dispatch("start","end","interrupt"))).on(a,b)});return this},Ah.transition=function(){for(var a,b,c,d=this.id,e=++Bh,f=this.namespace,g=[],h=0,i=this.length;h<i;h++){g.push(a=[]);for(var j,k=0,l=(j=this[h]).length;k<l;k++)(b=j[k])&&Oe(b,k,f,e,{time:(c=b[f][d]).time,ease:c.ease,delay:c.delay+c.duration,duration:c.duration}),a.push(b)}return Ke(g,f,e)},We.svg.axis=function(){function a(a){a.each(function(){var a,j=We.select(this),k=this.__chart__||c,l=this.__chart__=c.copy(),m=null==i?l.ticks?l.ticks.apply(l,h):l.domain():i,n=null==b?l.tickFormat?l.tickFormat.apply(l,h):s:b,o=j.selectAll(".tick").data(m,l),p=o.enter().insert("g",".domain").attr("class","tick").style("opacity",wf),q=We.transition(o.exit()).style("opacity",wf).remove(),r=We.transition(o.order()).style("opacity",1),t=Math.max(e,0)+g,u=Zd(l),v=j.selectAll(".domain").data([0]),w=(v.enter().append("path").attr("class","domain"),We.transition(v));p.append("line"),p.append("text");var x,y,z,A,B=p.select("line"),C=r.select("line"),D=o.select("text").text(n),E=p.select("text"),F=r.select("text"),G="top"===d||"left"===d?-1:1;if("bottom"===d||"top"===d?(a=Pe,x="x",z="y",y="x2",A="y2",D.attr("dy",G<0?"0em":".71em").style("text-anchor","middle"),w.attr("d","M"+u[0]+","+G*f+"V0H"+u[1]+"V"+G*f)):(a=Qe,x="y",z="x",y="y2",A="x2",D.attr("dy",".32em").style("text-anchor",G<0?"end":"start"),w.attr("d","M"+G*f+","+u[0]+"H0V"+u[1]+"H"+G*f)),B.attr(A,G*e),E.attr(z,G*t),C.attr(y,0).attr(A,G*e),F.attr(x,0).attr(z,G*t),l.rangeBand){var H=l,I=H.rangeBand()/2;k=l=function(a){return H(a)+I}}else k.rangeBand?k=l:q.call(a,l,k);p.call(a,k,l),r.call(a,l,l)})}var b,c=We.scale.linear(),d=Ch,e=6,f=6,g=3,h=[10],i=null;return a.scale=function(b){return arguments.length?(c=b,a):c},a.orient=function(b){return arguments.length?(d=b in Dh?b+"":Ch,a):d},a.ticks=function(){return arguments.length?(h=Ye(arguments),a):h},a.tickValues=function(b){return arguments.length?(i=b,a):i},a.tickFormat=function(c){return arguments.length?(b=c,a):b},a.tickSize=function(b){var c=arguments.length;return c?(e=+b,f=+arguments[c-1],a):e},a.innerTickSize=function(b){return arguments.length?(e=+b,a):e},a.outerTickSize=function(b){return arguments.length?(f=+b,a):f},a.tickPadding=function(b){return arguments.length?(g=+b,a):g},a.tickSubdivide=function(){return arguments.length&&a},a};var Ch="bottom",Dh={top:1,right:1,bottom:1,left:1};We.svg.brush=function(){function a(c){c.each(function(){var c=We.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",f).on("touchstart.brush",f),g=c.selectAll(".background").data([0]);g.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),c.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var h=c.selectAll(".resize").data(p,s);h.exit().remove(),h.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Eh[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",a.empty()?"none":null);var i,l=We.transition(c),m=We.transition(g);j&&(i=Zd(j),m.attr("x",i[0]).attr("width",i[1]-i[0]),d(l)),k&&(i=Zd(k),m.attr("y",i[0]).attr("height",i[1]-i[0]),e(l)),b(l)})}function b(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+l[+/e$/.test(a)]+","+m[+/^s/.test(a)]+")"})}function d(a){a.select(".extent").attr("x",l[0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",l[1]-l[0])}function e(a){a.select(".extent").attr("y",m[0]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",m[1]-m[0])}function f(){function f(){var a=We.mouse(t),c=!1;s&&(a[0]+=s[0],a[1]+=s[1]),B||(We.event.altKey?(r||(r=[(l[0]+l[1])/2,(m[0]+m[1])/2]),D[0]=l[+(a[0]<r[0])],D[1]=m[+(a[1]<r[1])]):r=null),z&&p(a,j,0)&&(d(w),c=!0),A&&p(a,k,1)&&(e(w),c=!0),c&&(b(w),v({type:"brush",mode:B?"move":"resize"}))}function p(a,b,c){var d,e,f=Zd(b),i=f[0],j=f[1],k=D[c],p=c?m:l,q=p[1]-p[0];if(B&&(i-=k,j-=q+k),d=(c?o:n)?Math.max(i,Math.min(j,a[c])):a[c],B?e=(d+=k)+q:(r&&(k=Math.max(i,Math.min(j,2*r[c]-d))),k<d?(e=d,d=k):e=k),p[0]!=d||p[1]!=e)return c?h=null:g=null,p[0]=d,p[1]=e,!0}function q(){f(),w.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),We.select("body").style("cursor",null),E.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),C(),v({type:"brushend"})}var r,s,t=this,u=We.select(We.event.target),v=i.of(t,arguments),w=We.select(t),x=u.datum(),z=!/^(n|s)$/.test(x)&&j,A=!/^(e|w)$/.test(x)&&k,B=u.classed("extent"),C=V(t),D=We.mouse(t),E=We.select(c(t)).on("keydown.brush",function(){32==We.event.keyCode&&(B||(r=null,D[0]-=l[1],D[1]-=m[1],B=2),y())}).on("keyup.brush",function(){32==We.event.keyCode&&2==B&&(D[0]+=l[1],D[1]+=m[1],B=0,y())});if(We.event.changedTouches?E.on("touchmove.brush",f).on("touchend.brush",q):E.on("mousemove.brush",f).on("mouseup.brush",q),w.interrupt().selectAll("*").interrupt(),B)D[0]=l[0]-D[0],D[1]=m[0]-D[1];else if(x){var F=+/w$/.test(x),G=+/^n/.test(x);s=[l[1-F]-D[0],m[1-G]-D[1]],D[0]=l[F],D[1]=m[G]}else We.event.altKey&&(r=D.slice());w.style("pointer-events","none").selectAll(".resize").style("display",null),We.select("body").style("cursor",u.style("cursor")),v({type:"brushstart"}),f()}var g,h,i=A(a,"brushstart","brush","brushend"),j=null,k=null,l=[0,0],m=[0,0],n=!0,o=!0,p=Fh[0];return a.event=function(a){a.each(function(){var a=i.of(this,arguments),b={x:l,y:m,i:g,j:h},c=this.__chart__||b;this.__chart__=b,xh?We.select(this).transition().each("start.brush",function(){g=c.i,h=c.j,l=c.x,m=c.y,a({type:"brushstart"})}).tween("brush:brush",function(){var c=Vc(l,b.x),d=Vc(m,b.y);return g=h=null,function(e){l=b.x=c(e),m=b.y=d(e),a({type:"brush",mode:"resize"})}}).each("end.brush",function(){g=b.i,h=b.j,a({type:"brush",mode:"resize"}),a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(p=Fh[!(j=b)<<1|!k],a):j},a.y=function(b){return arguments.length?(p=Fh[!j<<1|!(k=b)],a):k},a.clamp=function(b){return arguments.length?(j&&k?(n=!!b[0],o=!!b[1]):j?n=!!b:k&&(o=!!b),a):j&&k?[n,o]:j?n:k?o:null},a.extent=function(b){var c,d,e,f,i;return arguments.length?(j&&(c=b[0],d=b[1],k&&(c=c[0],d=d[0]),g=[c,d],j.invert&&(c=j(c),d=j(d)),d<c&&(i=c,c=d,d=i),c==l[0]&&d==l[1]||(l=[c,d])),k&&(e=b[0],f=b[1],j&&(e=e[1],f=f[1]),h=[e,f],k.invert&&(e=k(e),f=k(f)),f<e&&(i=e,e=f,f=i),e==m[0]&&f==m[1]||(m=[e,f])),a):(j&&(g?(c=g[0],d=g[1]):(c=l[0],d=l[1],j.invert&&(c=j.invert(c),d=j.invert(d)),d<c&&(i=c,c=d,d=i))),k&&(h?(e=h[0],f=h[1]):(e=m[0],f=m[1],k.invert&&(e=k.invert(e),f=k.invert(f)),f<e&&(i=e,e=f,f=i))),j&&k?[[c,e],[d,f]]:j?[c,d]:k&&[e,f])},a.clear=function(){return a.empty()||(l=[0,0],m=[0,0],g=h=null),a},a.empty=function(){return!!j&&l[0]==l[1]||!!k&&m[0]==m[1]},We.rebind(a,i,"on")};var Eh={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Fh=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Gh=Zf.format=dg.timeFormat,Hh=Gh.utc,Ih=Hh("%Y-%m-%dT%H:%M:%S.%LZ");Gh.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Re:Ih,Re.parse=function(a){var b=new Date(a);return isNaN(b)?null:b},Re.toString=Ih.toString,Zf.second=Ga(function(a){return new $f(1e3*Math.floor(a/1e3))},function(a,b){a.setTime(a.getTime()+1e3*Math.floor(b))},function(a){return a.getSeconds()}),Zf.seconds=Zf.second.range,Zf.seconds.utc=Zf.second.utc.range,Zf.minute=Ga(function(a){return new $f(6e4*Math.floor(a/6e4))},function(a,b){a.setTime(a.getTime()+6e4*Math.floor(b))},function(a){return a.getMinutes()}),Zf.minutes=Zf.minute.range,Zf.minutes.utc=Zf.minute.utc.range,Zf.hour=Ga(function(a){var b=a.getTimezoneOffset()/60;return new $f(36e5*(Math.floor(a/36e5-b)+b))},function(a,b){a.setTime(a.getTime()+36e5*Math.floor(b))},function(a){return a.getHours()}),Zf.hours=Zf.hour.range,Zf.hours.utc=Zf.hour.utc.range,Zf.month=Ga(function(a){return(a=Zf.day(a)).setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()}),Zf.months=Zf.month.range,Zf.months.utc=Zf.month.utc.range;var Jh=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Kh=[[Zf.second,1],[Zf.second,5],[Zf.second,15],[Zf.second,30],[Zf.minute,1],[Zf.minute,5],[Zf.minute,15],[Zf.minute,30],[Zf.hour,1],[Zf.hour,3],[Zf.hour,6],[Zf.hour,12],[Zf.day,1],[Zf.day,2],[Zf.week,1],[Zf.month,1],[Zf.month,3],[Zf.year,1]],Lh=Gh.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",tb]]),Mh={range:function(a,b,c){return We.range(Math.ceil(a/c)*c,+b,c).map(Te)},floor:s,ceil:s};Kh.year=Zf.year,Zf.scale=function(){return Se(We.scale.linear(),Kh,Lh)};var Nh=Kh.map(function(a){return[a[0].utc,a[1]]}),Oh=Hh.multi([[".%L",function(a){return a.getUTCMilliseconds()}],[":%S",function(a){return a.getUTCSeconds()}],["%I:%M",function(a){return a.getUTCMinutes()}],["%I %p",function(a){return a.getUTCHours()}],["%a %d",function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],["%b %d",function(a){return 1!=a.getUTCDate()}],["%B",function(a){return a.getUTCMonth()}],["%Y",tb]]);Nh.year=Zf.year.utc,Zf.scale.utc=function(){return Se(We.scale.linear(),Nh,Oh)},We.text=xa(function(a){return a.responseText}),We.json=function(a,b){return ya(a,"application/json",Ue,b)},We.html=function(a,b){return ya(a,"text/html",Ve,b)},We.xml=xa(function(a){return a.responseXML}),"object"==typeof b&&b.exports?b.exports=We:this.d3=We}()},{}],165:[function(a,b,c){b.exports=function(){for(var a=0;a<arguments.length;a++)if(void 0!==arguments[a])return arguments[a]}},{}],166:[function(a,b,c){"use strict";function d(a,b){this.point=a,this.index=b}function e(a,b){for(var c=a.point,d=b.point,e=c.length,f=0;f<e;++f){var g=d[f]-c[f];if(g)return g}return 0}var f=a("incremental-convex-hull"),g=a("uniq");b.exports=function(a,b){var c=a.length;if(0===c)return[];var h=a[0].length;if(h<1)return[];if(1===h)return function(a,b,c){if(1===a)return c?[[-1,0]]:[];var d=b.map(function(a,b){return[a[0],b]});d.sort(function(a,b){return a[0]-b[0]});for(var e=new Array(a-1),f=1;f<a;++f){var g=d[f-1],h=d[f];e[f-1]=[g[1],h[1]]}return c&&e.push([-1,e[0][1]],[e[a-1][1],-1]),e}(c,a,b);for(var i=new Array(c),j=1,k=0;k<c;++k){for(var l=a[k],m=new Array(h+1),n=0,o=0;o<h;++o){var p=l[o];m[o]=p,n+=p*p}m[h]=n,i[k]=new d(m,k),j=Math.max(n,j)}g(i,e),c=i.length;for(var q=new Array(c+h+1),r=new Array(c+h+1),s=(h+1)*(h+1)*j,t=new Array(h+1),k=0;k<=h;++k)t[k]=0;t[h]=s,q[0]=t.slice(),r[0]=-1;for(var k=0;k<=h;++k){var m=t.slice();m[k]=1,q[k+1]=m,r[k+1]=-1}for(var k=0;k<c;++k){var u=i[k];q[k+h+1]=u.point,r[k+h+1]=u.index}var v=f(q,!1);if(v=b?v.filter(function(a){for(var b=0,c=0;c<=h;++c){var d=r[a[c]];if(d<0&&++b>=2)return!1;a[c]=d}return!0}):v.filter(function(a){for(var b=0;b<=h;++b){var c=r[a[b]];if(c<0)return!1;a[b]=c}return!0}),1&h)for(var k=0;k<v.length;++k){var u=v[k],m=u[0];u[0]=u[1],u[1]=m}return v}},{"incremental-convex-hull":414,uniq:548}],167:[function(a,b,c){"use strict";function d(a,b){Array.isArray(a)&&(a=a.join(", "));var c,d={},h=16,i=.05;b&&(2===b.length&&"number"==typeof b[0]?c=e(b):Array.isArray(b)?c=b:(b.o?c=e(b.o):b.pairs&&(c=b.pairs),b.fontSize&&(h=b.fontSize),null!=b.threshold&&(i=b.threshold))),c||(c=g),f.font=h+"px "+a;for(var j=0;j<c.length;j++){var k=c[j],l=f.measureText(k[0]).width+f.measureText(k[1]).width,m=f.measureText(k).width;if(Math.abs(l-m)>h*i){var n=(m-l)/h;d[k]=1e3*n}}return d}function e(a){for(var b=[],c=a[0];c<=a[1];c++)for(var d=String.fromCharCode(c),e=a[0];e<a[1];e++){var f=d+String.fromCharCode(e);b.push(f)}return b}b.exports=d;var f=(d.canvas=document.createElement("canvas")).getContext("2d"),g=e([32,126]);d.createPairs=e,d.ascii=g},{}],168:[function(a,b,c){(function(a){var c=!1;if("undefined"!=typeof Float64Array){var d=new Float64Array(1),e=new Uint32Array(d.buffer);d[0]=1,c=!0,1072693248===e[1]?(b.exports=function(a){return d[0]=a,[e[0],e[1]]},b.exports.pack=function(a,b){return e[0]=a,e[1]=b,d[0]},b.exports.lo=function(a){return d[0]=a,e[0]},b.exports.hi=function(a){return d[0]=a,e[1]}):1072693248===e[0]?(b.exports=function(a){return d[0]=a,[e[1],e[0]]},b.exports.pack=function(a,b){return e[1]=a,e[0]=b,d[0]},b.exports.lo=function(a){return d[0]=a,e[1]},b.exports.hi=function(a){return d[0]=a,e[0]}):c=!1}if(!c){var f=new a(8);b.exports=function(a){return f.writeDoubleLE(a,0,!0),[f.readUInt32LE(0,!0),f.readUInt32LE(4,!0)]},b.exports.pack=function(a,b){return f.writeUInt32LE(a,0,!0),f.writeUInt32LE(b,4,!0),f.readDoubleLE(0,!0)},b.exports.lo=function(a){return f.writeDoubleLE(a,0,!0),f.readUInt32LE(0,!0)},b.exports.hi=function(a){return f.writeDoubleLE(a,0,!0),f.readUInt32LE(4,!0)}}b.exports.sign=function(a){return b.exports.hi(a)>>>31},b.exports.exponent=function(a){return(b.exports.hi(a)<<1>>>21)-1023},b.exports.fraction=function(a){var c=b.exports.lo(a),d=b.exports.hi(a),e=1048575&d;return 2146435072&d&&(e+=1<<20),[c,e]},b.exports.denormalized=function(a){return!(2146435072&b.exports.hi(a))}}).call(this,a("buffer").Buffer)},{buffer:106}],169:[function(a,b,c){var d=a("abs-svg-path"),e=a("normalize-svg-path"),f={M:"moveTo",C:"bezierCurveTo"};b.exports=function(a,b){a.beginPath(),e(d(b)).forEach(function(b){var c=b[0],d=b.slice(1);a[f[c]].apply(a,d)}),a.closePath()}},{"abs-svg-path":61,"normalize-svg-path":453}],170:[function(a,b,c){b.exports=function(a){switch(a){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],171:[function(a,b,c){"use strict";b.exports=function(a,b){switch(void 0===b&&(b=0),typeof a){case"number":if(a>0)return function(a,b){var c,d;for(c=new Array(a),d=0;d<a;++d)c[d]=b;return c}(0|a,b);break;case"object":if("number"==typeof a.length)return function a(b,c,d){var e=0|b[d];if(e<=0)return[];var f,g=new Array(e);if(d===b.length-1)for(f=0;f<e;++f)g[f]=c;else for(f=0;f<e;++f)g[f]=a(b,c,d+1);return g}(a,b,0)}return[]}},{}],172:[function(a,b,c){"use strict";b.exports=function(a,b){var c=a.length;if("number"!=typeof b){b=0;for(var e=0;e<c;++e){var f=a[e];b=Math.max(b,f[0],f[1])}b=1+(0|b)}b|=0;for(var g=new Array(b),e=0;e<b;++e)g[e]=[];for(var e=0;e<c;++e){var f=a[e];g[f[0]].push(f[1]),g[f[1]].push(f[0])}for(var h=0;h<b;++h)d(g[h],function(a,b){return a-b});return g};var d=a("uniq")},{uniq:548}],173:[function(a,b,c){var d=a("strongly-connected-components");b.exports=function(a){function b(a){var d,f,k=!1;for(g.push(a),h[a]=!0,d=0;d<j[a].length;d++)(f=j[a][d])===e?(c(e,g),k=!0):h[f]||(k=b(f));if(k)!function a(b){h[b]=!1,i.hasOwnProperty(b)&&Object.keys(i[b]).forEach(function(c){delete i[b][c],h[c]&&a(c)})}(a);else for(d=0;d<j[a].length;d++){f=j[a][d];var l=i[f];l||(l={},i[f]=l),l[f]=!0}return g.pop(),k}function c(a,b){var c=[].concat(b).concat(a);f.push(c)}var e,f=[],g=[],h=[],i={},j=[];e=0;for(var k=a.length;e<k;){var l=function(b){!function(b){for(var c=0;c<a.length;c++)c<b&&(a[c]=[]),a[c]=a[c].filter(function(a){return a>=b})}(b);for(var c,e=d(a).components.filter(function(a){return a.length>1}),f=1/0,g=0;g<e.length;g++)for(var h=0;h<e[g].length;h++)e[g][h]<f&&(f=e[g][h],c=g);var i=e[c];return!!i&&{leastVertex:f,adjList:a.map(function(a,b){return-1===i.indexOf(b)?[]:a.filter(function(a){return-1!==i.indexOf(a)})})}}(e);if(e=l.leastVertex,j=l.adjList){for(var m=0;m<j.length;m++)for(var n=0;n<j[m].length;n++){var o=j[m][n];h[+o]=!1,i[o]={}}b(e),e+=1}else e=k}return f}},{"strongly-connected-components":531}],174:[function(a,b,c){"use strict";var d=a("../../object/valid-value");b.exports=function(){return d(this).length=0,this}},{"../../object/valid-value":206}],175:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?Array.from:a("./shim")},{"./is-implemented":176,"./shim":177}],176:[function(a,b,c){"use strict";b.exports=function(){var a,b,c=Array.from;return"function"==typeof c&&(b=c(a=["raz","dwa"]),Boolean(b&&b!==a&&"dwa"===b[1]))}},{}],177:[function(a,b,c){"use strict";var d=a("es6-symbol").iterator,e=a("../../function/is-arguments"),f=a("../../function/is-function"),g=a("../../number/to-pos-integer"),h=a("../../object/valid-callable"),i=a("../../object/valid-value"),j=a("../../object/is-value"),k=a("../../string/is-string"),l=Array.isArray,m=Function.prototype.call,n={configurable:!0,enumerable:!0,writable:!0,value:null},o=Object.defineProperty;b.exports=function(a){var b,c,p,q,r,s,t,u,v,w,x=arguments[1],y=arguments[2];if(a=Object(i(a)),j(x)&&h(x),this&&this!==Array&&f(this))b=this;else{if(!x){if(e(a))return 1!==(r=a.length)?Array.apply(null,a):((q=new Array(1))[0]=a[0],q);if(l(a)){for(q=new Array(r=a.length),c=0;c<r;++c)q[c]=a[c];return q}}q=[]}if(!l(a))if(void 0!==(v=a[d])){for(t=h(v).call(a),b&&(q=new b),u=t.next(),c=0;!u.done;)w=x?m.call(x,y,u.value,c):u.value,b?(n.value=w,o(q,c,n)):q[c]=w,u=t.next(),++c;r=c}else if(k(a)){for(r=a.length,b&&(q=new b),c=0,p=0;c<r;++c)w=a[c],c+1<r&&(s=w.charCodeAt(0))>=55296&&s<=56319&&(w+=a[++c]),w=x?m.call(x,y,w,p):w,b?(n.value=w,o(q,p,n)):q[p]=w,++p;r=p}if(void 0===r)for(r=g(a.length),b&&(q=new b(r)),c=0;c<r;++c)w=x?m.call(x,y,a[c],c):a[c],b?(n.value=w,o(q,c,n)):q[c]=w;return b&&(n.value=null,q.length=r),q}},{"../../function/is-arguments":178,"../../function/is-function":179,"../../number/to-pos-integer":185,"../../object/is-value":195,"../../object/valid-callable":204,"../../object/valid-value":206,"../../string/is-string":210,"es6-symbol":220}],178:[function(a,b,c){"use strict";var d=Object.prototype.toString,e=d.call(function(){return arguments}());b.exports=function(a){return d.call(a)===e}},{}],179:[function(a,b,c){"use strict";var d=Object.prototype.toString,e=d.call(a("./noop"));b.exports=function(a){return"function"==typeof a&&d.call(a)===e}},{"./noop":180}],180:[function(a,b,c){"use strict";b.exports=function(){}},{}],181:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?Math.sign:a("./shim")},{"./is-implemented":182,"./shim":183}],182:[function(a,b,c){"use strict";b.exports=function(){var a=Math.sign;return"function"==typeof a&&1===a(10)&&-1===a(-20)}},{}],183:[function(a,b,c){"use strict";b.exports=function(a){return a=Number(a),isNaN(a)||0===a?a:a>0?1:-1}},{}],184:[function(a,b,c){"use strict";var d=a("../math/sign"),e=Math.abs,f=Math.floor;b.exports=function(a){return isNaN(a)?0:0!==(a=Number(a))&&isFinite(a)?d(a)*f(e(a)):a}},{"../math/sign":181}],185:[function(a,b,c){"use strict";var d=a("./to-integer"),e=Math.max;b.exports=function(a){return e(0,d(a))}},{"./to-integer":184}],186:[function(a,b,c){"use strict";var d=a("./valid-callable"),e=a("./valid-value"),f=Function.prototype.bind,g=Function.prototype.call,h=Object.keys,i=Object.prototype.propertyIsEnumerable;b.exports=function(a,b){return function(c,j){var k,l=arguments[2],m=arguments[3];return c=Object(e(c)),d(j),k=h(c),m&&k.sort("function"==typeof m?f.call(m,c):void 0),"function"!=typeof a&&(a=k[a]),g.call(a,k,function(a,d){return i.call(c,a)?g.call(j,l,c[a],a,c,d):b})}}},{"./valid-callable":204,"./valid-value":206}],187:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?Object.assign:a("./shim")},{"./is-implemented":188,"./shim":189}],188:[function(a,b,c){"use strict";b.exports=function(){var a,b=Object.assign;return"function"==typeof b&&(b(a={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),a.foo+a.bar+a.trzy==="razdwatrzy")}},{}],189:[function(a,b,c){"use strict";var d=a("../keys"),e=a("../valid-value"),f=Math.max;b.exports=function(a,b){
var c,g,h,i=f(arguments.length,2);for(a=Object(e(a)),h=function(d){try{a[d]=b[d]}catch(a){c||(c=a)}},g=1;g<i;++g)b=arguments[g],d(b).forEach(h);if(void 0!==c)throw c;return a}},{"../keys":196,"../valid-value":206}],190:[function(a,b,c){"use strict";var d=a("../array/from"),e=a("./assign"),f=a("./valid-value");b.exports=function(a){var b=Object(f(a)),c=arguments[1],g=Object(arguments[2]);if(b!==a&&!c)return b;var h={};return c?d(c,function(b){(g.ensure||b in a)&&(h[b]=a[b])}):e(h,a),h}},{"../array/from":175,"./assign":187,"./valid-value":206}],191:[function(a,b,c){"use strict";var d,e,f,g,h=Object.create;a("./set-prototype-of/is-implemented")()||(d=a("./set-prototype-of/shim")),b.exports=d?1!==d.level?h:(e={},f={},g={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(a){f[a]="__proto__"!==a?g:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(e,f),Object.defineProperty(d,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:e}),function(a,b){return h(null===a?e:a,b)}):h},{"./set-prototype-of/is-implemented":202,"./set-prototype-of/shim":203}],192:[function(a,b,c){"use strict";b.exports=a("./_iterate")("forEach")},{"./_iterate":186}],193:[function(a,b,c){"use strict";b.exports=function(a){return"function"==typeof a}},{}],194:[function(a,b,c){"use strict";var d=a("./is-value"),e={function:!0,object:!0};b.exports=function(a){return d(a)&&e[typeof a]||!1}},{"./is-value":195}],195:[function(a,b,c){"use strict";var d=a("../function/noop")();b.exports=function(a){return a!==d&&null!==a}},{"../function/noop":180}],196:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?Object.keys:a("./shim")},{"./is-implemented":197,"./shim":198}],197:[function(a,b,c){"use strict";b.exports=function(){try{return Object.keys("primitive"),!0}catch(a){return!1}}},{}],198:[function(a,b,c){"use strict";var d=a("../is-value"),e=Object.keys;b.exports=function(a){return e(d(a)?Object(a):a)}},{"../is-value":195}],199:[function(a,b,c){"use strict";var d=a("./valid-callable"),e=a("./for-each"),f=Function.prototype.call;b.exports=function(a,b){var c={},g=arguments[2];return d(b),e(a,function(a,d,e,h){c[d]=f.call(b,g,a,d,e,h)}),c}},{"./for-each":192,"./valid-callable":204}],200:[function(a,b,c){"use strict";var d=a("./is-value"),e=Array.prototype.forEach,f=Object.create;b.exports=function(a){var b=f(null);return e.call(arguments,function(a){d(a)&&function(a,b){var c;for(c in a)b[c]=a[c]}(Object(a),b)}),b}},{"./is-value":195}],201:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?Object.setPrototypeOf:a("./shim")},{"./is-implemented":202,"./shim":203}],202:[function(a,b,c){"use strict";var d=Object.create,e=Object.getPrototypeOf,f={};b.exports=function(){var a=Object.setPrototypeOf,b=arguments[0]||d;return"function"==typeof a&&e(a(b(null),f))===f}},{}],203:[function(a,b,c){"use strict";var d,e,f,g,h=a("../is-object"),i=a("../valid-value"),j=Object.prototype.isPrototypeOf,k=Object.defineProperty,l={configurable:!0,enumerable:!1,writable:!0,value:void 0};d=function(a,b){if(i(a),null===b||h(b))return a;throw new TypeError("Prototype must be null or an object")},b.exports=(e=function(){var a,b=Object.create(null),c={},d=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(d){try{(a=d.set).call(b,c)}catch(a){}if(Object.getPrototypeOf(b)===c)return{set:a,level:2}}return b.__proto__=c,Object.getPrototypeOf(b)===c?{level:2}:((b={}).__proto__=c,Object.getPrototypeOf(b)===c&&{level:1})}())?(2===e.level?e.set?(g=e.set,f=function(a,b){return g.call(d(a,b),b),a}):f=function(a,b){return d(a,b).__proto__=b,a}:f=function a(b,c){var e;return d(b,c),(e=j.call(a.nullPolyfill,b))&&delete a.nullPolyfill.__proto__,null===c&&(c=a.nullPolyfill),b.__proto__=c,e&&k(a.nullPolyfill,"__proto__",l),b},Object.defineProperty(f,"level",{configurable:!1,enumerable:!1,writable:!1,value:e.level})):null,a("../create")},{"../create":191,"../is-object":194,"../valid-value":206}],204:[function(a,b,c){"use strict";b.exports=function(a){if("function"!=typeof a)throw new TypeError(a+" is not a function");return a}},{}],205:[function(a,b,c){"use strict";var d=a("./is-object");b.exports=function(a){if(!d(a))throw new TypeError(a+" is not an Object");return a}},{"./is-object":194}],206:[function(a,b,c){"use strict";var d=a("./is-value");b.exports=function(a){if(!d(a))throw new TypeError("Cannot use null or undefined");return a}},{"./is-value":195}],207:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?String.prototype.contains:a("./shim")},{"./is-implemented":208,"./shim":209}],208:[function(a,b,c){"use strict";var d="razdwatrzy";b.exports=function(){return"function"==typeof d.contains&&!0===d.contains("dwa")&&!1===d.contains("foo")}},{}],209:[function(a,b,c){"use strict";var d=String.prototype.indexOf;b.exports=function(a){return d.call(this,a,arguments[1])>-1}},{}],210:[function(a,b,c){"use strict";var d=Object.prototype.toString,e=d.call("");b.exports=function(a){return"string"==typeof a||a&&"object"==typeof a&&(a instanceof String||d.call(a)===e)||!1}},{}],211:[function(a,b,c){"use strict";var d=Object.create(null),e=Math.random;b.exports=function(){var a;do{a=e().toString(36).slice(2)}while(d[a]);return a}},{}],212:[function(a,b,c){"use strict";var d,e=a("es5-ext/object/set-prototype-of"),f=a("es5-ext/string/#/contains"),g=a("d"),h=a("es6-symbol"),i=a("./"),j=Object.defineProperty;d=b.exports=function(a,b){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");i.call(this,a),b=b?f.call(b,"key+value")?"key+value":f.call(b,"key")?"key":"value":"value",j(this,"__kind__",g("",b))},e&&e(d,i),delete d.prototype.constructor,d.prototype=Object.create(i.prototype,{_resolve:g(function(a){return"value"===this.__kind__?this.__list__[a]:"key+value"===this.__kind__?[a,this.__list__[a]]:a})}),j(d.prototype,h.toStringTag,g("c","Array Iterator"))},{"./":215,d:152,"es5-ext/object/set-prototype-of":201,"es5-ext/string/#/contains":207,"es6-symbol":220}],213:[function(a,b,c){"use strict";var d=a("es5-ext/function/is-arguments"),e=a("es5-ext/object/valid-callable"),f=a("es5-ext/string/is-string"),g=a("./get"),h=Array.isArray,i=Function.prototype.call,j=Array.prototype.some;b.exports=function(a,b){var c,k,l,m,n,o,p,q,r=arguments[2];if(h(a)||d(a)?c="array":f(a)?c="string":a=g(a),e(b),l=function(){m=!0},"array"!==c)if("string"!==c)for(k=a.next();!k.done;){if(i.call(b,r,k.value,l),m)return;k=a.next()}else for(o=a.length,n=0;n<o&&(p=a[n],n+1<o&&(q=p.charCodeAt(0))>=55296&&q<=56319&&(p+=a[++n]),i.call(b,r,p,l),!m);++n);else j.call(a,function(a){return i.call(b,r,a,l),m})}},{"./get":214,"es5-ext/function/is-arguments":178,"es5-ext/object/valid-callable":204,"es5-ext/string/is-string":210}],214:[function(a,b,c){"use strict";var d=a("es5-ext/function/is-arguments"),e=a("es5-ext/string/is-string"),f=a("./array"),g=a("./string"),h=a("./valid-iterable"),i=a("es6-symbol").iterator;b.exports=function(a){return"function"==typeof h(a)[i]?a[i]():d(a)?new f(a):e(a)?new g(a):new f(a)}},{"./array":212,"./string":217,"./valid-iterable":218,"es5-ext/function/is-arguments":178,"es5-ext/string/is-string":210,"es6-symbol":220}],215:[function(a,b,c){"use strict";var d,e=a("es5-ext/array/#/clear"),f=a("es5-ext/object/assign"),g=a("es5-ext/object/valid-callable"),h=a("es5-ext/object/valid-value"),i=a("d"),j=a("d/auto-bind"),k=a("es6-symbol"),l=Object.defineProperty,m=Object.defineProperties;b.exports=d=function(a,b){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");m(this,{__list__:i("w",h(a)),__context__:i("w",b),__nextIndex__:i("w",0)}),b&&(g(b.on),b.on("_add",this._onAdd),b.on("_delete",this._onDelete),b.on("_clear",this._onClear))},delete d.prototype.constructor,m(d.prototype,f({_next:i(function(){var a;if(this.__list__)return this.__redo__&&void 0!==(a=this.__redo__.shift())?a:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:i(function(){return this._createResult(this._next())}),_createResult:i(function(a){return void 0===a?{done:!0,value:void 0}:{done:!1,value:this._resolve(a)}}),_resolve:i(function(a){return this.__list__[a]}),_unBind:i(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:i(function(){return"[object "+(this[k.toStringTag]||"Object")+"]"})},j({_onAdd:i(function(a){a>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(b,c){b>=a&&(this.__redo__[c]=++b)},this),this.__redo__.push(a)):l(this,"__redo__",i("c",[a])))}),_onDelete:i(function(a){var b;a>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(b=this.__redo__.indexOf(a))&&this.__redo__.splice(b,1),this.__redo__.forEach(function(b,c){b>a&&(this.__redo__[c]=--b)},this)))}),_onClear:i(function(){this.__redo__&&e.call(this.__redo__),this.__nextIndex__=0})}))),l(d.prototype,k.iterator,i(function(){return this}))},{d:152,"d/auto-bind":151,"es5-ext/array/#/clear":174,"es5-ext/object/assign":187,"es5-ext/object/valid-callable":204,"es5-ext/object/valid-value":206,"es6-symbol":220}],216:[function(a,b,c){"use strict";var d=a("es5-ext/function/is-arguments"),e=a("es5-ext/object/is-value"),f=a("es5-ext/string/is-string"),g=a("es6-symbol").iterator,h=Array.isArray;b.exports=function(a){return!(!e(a)||!h(a)&&!f(a)&&!d(a)&&"function"!=typeof a[g])}},{"es5-ext/function/is-arguments":178,"es5-ext/object/is-value":195,"es5-ext/string/is-string":210,"es6-symbol":220}],217:[function(a,b,c){"use strict";var d,e=a("es5-ext/object/set-prototype-of"),f=a("d"),g=a("es6-symbol"),h=a("./"),i=Object.defineProperty;d=b.exports=function(a){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");a=String(a),h.call(this,a),i(this,"__length__",f("",a.length))},e&&e(d,h),delete d.prototype.constructor,d.prototype=Object.create(h.prototype,{_next:f(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:f(function(a){var b,c=this.__list__[a];return this.__nextIndex__===this.__length__?c:(b=c.charCodeAt(0))>=55296&&b<=56319?c+this.__list__[this.__nextIndex__++]:c})}),i(d.prototype,g.toStringTag,f("c","String Iterator"))},{"./":215,d:152,"es5-ext/object/set-prototype-of":201,"es6-symbol":220}],218:[function(a,b,c){"use strict";var d=a("./is-iterable");b.exports=function(a){if(!d(a))throw new TypeError(a+" is not iterable");return a}},{"./is-iterable":216}],219:[function(a,b,c){(function(d,e){!function(a,d){"object"==typeof c&&void 0!==b?b.exports=d():a.ES6Promise=d()}(this,function(){"use strict";function b(a){return"function"==typeof a}function c(){var a=setTimeout;return function(){return a(f,1)}}function f(){for(var a=0;a<C;a+=2)(0,L[a])(L[a+1]),L[a]=void 0,L[a+1]=void 0;C=0}function g(a,b){var c=arguments,d=this,e=new this.constructor(i);void 0===e[N]&&t(e);var f,g=d._state;return g?(f=c[g-1],F(function(){return s(g,e,f,d._result)})):p(d,e,a,b),e}function h(a){if(a&&"object"==typeof a&&a.constructor===this)return a;var b=new this(i);return l(b,a),b}function i(){}function j(a){try{return a.then}catch(a){return R.error=a,R}}function k(a,c,d){c.constructor===a.constructor&&d===g&&c.constructor.resolve===h?function(a,b){b._state===P?n(a,b._result):b._state===Q?o(a,b._result):p(b,void 0,function(b){return l(a,b)},function(b){return o(a,b)})}(a,c):d===R?o(a,R.error):void 0===d?n(a,c):b(d)?function(a,b,c){F(function(a){var d=!1,e=function(a,b,c,d){try{a.call(b,c,d)}catch(a){return a}}(c,b,function(c){d||(d=!0,b!==c?l(a,c):n(a,c))},function(b){d||(d=!0,o(a,b))},a._label);!d&&e&&(d=!0,o(a,e))},a)}(a,c,d):n(a,c)}function l(a,b){var c;a===b?o(a,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(c=b)||"object"==typeof c&&null!==c?k(a,b,j(b)):n(a,b)}function m(a){a._onerror&&a._onerror(a._result),q(a)}function n(a,b){a._state===O&&(a._result=b,a._state=P,0!==a._subscribers.length&&F(q,a))}function o(a,b){a._state===O&&(a._state=Q,a._result=b,F(m,a))}function p(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+P]=c,e[f+Q]=d,0===f&&a._state&&F(q,a)}function q(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d=void 0,e=void 0,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?s(c,d,e,f):e(f);a._subscribers.length=0}}function r(){this.error=null}function s(a,c,d,e){var f=b(d),g=void 0,h=void 0,i=void 0,j=void 0;if(f){if((g=function(a,b){try{return a(b)}catch(a){return S.error=a,S}}(d,e))===S?(j=!0,h=g.error,g=null):i=!0,c===g)return void o(c,new TypeError("A promises callback cannot return that same promise."))}else g=e,i=!0;c._state!==O||(f&&i?l(c,g):j?o(c,h):a===P?n(c,g):a===Q&&o(c,g))}function t(a){a[N]=T++,a._state=void 0,a._result=void 0,a._subscribers=[]}function u(a,b){this._instanceConstructor=a,this.promise=new a(i),this.promise[N]||t(this.promise),B(b)?(this._input=b,this.length=b.length,this._remaining=b.length,this._result=new Array(this.length),0===this.length?n(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&n(this.promise,this._result))):o(this.promise,new Error("Array Methods must be provided an Array"))}function v(a){this[N]=T++,this._result=this._state=void 0,this._subscribers=[],i!==a&&("function"!=typeof a&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof v?function(a,b){try{b(function(b){l(a,b)},function(b){o(a,b)})}catch(b){o(a,b)}}(this,a):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}function w(){var a=void 0;if(void 0!==e)a=e;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(a){throw new Error("polyfill failed because global object is unavailable in this environment")}var b=a.Promise;if(b){var c=null;try{c=Object.prototype.toString.call(b.resolve())}catch(a){}if("[object Promise]"===c&&!b.cast)return}a.Promise=v}var x,y,z,A,B=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},C=0,D=void 0,E=void 0,F=function(a,b){L[C]=a,L[C+1]=b,2===(C+=2)&&(E?E(f):M())},G="undefined"!=typeof window?window:void 0,H=G||{},I=H.MutationObserver||H.WebKitMutationObserver,J="undefined"==typeof self&&void 0!==d&&"[object process]"==={}.toString.call(d),K="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,L=new Array(1e3),M=void 0;J?M=function(){return d.nextTick(f)}:I?(y=0,z=new I(f),A=document.createTextNode(""),z.observe(A,{characterData:!0}),M=function(){A.data=y=++y%2}):K?((x=new MessageChannel).port1.onmessage=f,M=function(){return x.port2.postMessage(0)}):M=void 0===G&&"function"==typeof a?function(){try{var b=a("vertx");return D=b.runOnLoop||b.runOnContext,function(){D(f)}}catch(a){return c()}}():c();var N=Math.random().toString(36).substring(16),O=void 0,P=1,Q=2,R=new r,S=new r,T=0;return u.prototype._enumerate=function(){for(var a=this.length,b=this._input,c=0;this._state===O&&c<a;c++)this._eachEntry(b[c],c)},u.prototype._eachEntry=function(a,b){var c=this._instanceConstructor,d=c.resolve;if(d===h){var e=j(a);if(e===g&&a._state!==O)this._settledAt(a._state,b,a._result);else if("function"!=typeof e)this._remaining--,this._result[b]=a;else if(c===v){var f=new c(i);k(f,a,e),this._willSettleAt(f,b)}else this._willSettleAt(new c(function(b){return b(a)}),b)}else this._willSettleAt(d(a),b)},u.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===O&&(this._remaining--,a===Q?o(d,c):this._result[b]=c),0===this._remaining&&n(d,this._result)},u.prototype._willSettleAt=function(a,b){var c=this;p(a,void 0,function(a){return c._settledAt(P,b,a)},function(a){return c._settledAt(Q,b,a)})},v.all=function(a){return new u(this,a).promise},v.race=function(a){var b=this;return new b(B(a)?function(c,d){for(var e=a.length,f=0;f<e;f++)b.resolve(a[f]).then(c,d)}:function(a,b){return b(new TypeError("You must pass an array to race."))})},v.resolve=h,v.reject=function(a){var b=new this(i);return o(b,a),b},v._setScheduler=function(a){E=a},v._setAsap=function(a){F=a},v._asap=F,v.prototype={constructor:v,then:g,catch:function(a){return this.then(null,a)}},w(),v.polyfill=w,v.Promise=v,v})}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:483}],220:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?Symbol:a("./polyfill")},{"./is-implemented":221,"./polyfill":223}],221:[function(a,b,c){"use strict";var d={object:!0,symbol:!0};b.exports=function(){var a;if("function"!=typeof Symbol)return!1;a=Symbol("test symbol");try{String(a)}catch(a){return!1}return!!d[typeof Symbol.iterator]&&!!d[typeof Symbol.toPrimitive]&&!!d[typeof Symbol.toStringTag]}},{}],222:[function(a,b,c){"use strict";b.exports=function(a){return!!a&&("symbol"==typeof a||!!a.constructor&&"Symbol"===a.constructor.name&&"Symbol"===a[a.constructor.toStringTag])}},{}],223:[function(a,b,c){"use strict";var d,e,f,g,h=a("d"),i=a("./validate-symbol"),j=Object.create,k=Object.defineProperties,l=Object.defineProperty,m=Object.prototype,n=j(null);if("function"==typeof Symbol){d=Symbol;try{String(d()),g=!0}catch(a){}}var o,p=(o=j(null),function(a){for(var b,c,d=0;o[a+(d||"")];)++d;return o[a+=d||""]=!0,l(m,b="@@"+a,h.gs(null,function(a){c||(c=!0,l(this,b,h(a)),c=!1)})),b});f=function(a){if(this instanceof f)throw new TypeError("Symbol is not a constructor");return e(a)},b.exports=e=function a(b){var c;if(this instanceof a)throw new TypeError("Symbol is not a constructor");return g?d(b):(c=j(f.prototype),b=void 0===b?"":String(b),k(c,{__description__:h("",b),__name__:h("",p(b))}))},k(e,{for:h(function(a){return n[a]?n[a]:n[a]=e(String(a))}),keyFor:h(function(a){var b;for(b in i(a),n)if(n[b]===a)return b}),hasInstance:h("",d&&d.hasInstance||e("hasInstance")),isConcatSpreadable:h("",d&&d.isConcatSpreadable||e("isConcatSpreadable")),iterator:h("",d&&d.iterator||e("iterator")),match:h("",d&&d.match||e("match")),replace:h("",d&&d.replace||e("replace")),search:h("",d&&d.search||e("search")),species:h("",d&&d.species||e("species")),split:h("",d&&d.split||e("split")),toPrimitive:h("",d&&d.toPrimitive||e("toPrimitive")),toStringTag:h("",d&&d.toStringTag||e("toStringTag")),unscopables:h("",d&&d.unscopables||e("unscopables"))}),k(f.prototype,{constructor:h(e),toString:h("",function(){return this.__name__})}),k(e.prototype,{toString:h(function(){return"Symbol ("+i(this).__description__+")"}),valueOf:h(function(){return i(this)})}),l(e.prototype,e.toPrimitive,h("",function(){var a=i(this);return"symbol"==typeof a?a:a.toString()})),l(e.prototype,e.toStringTag,h("c","Symbol")),l(f.prototype,e.toStringTag,h("c",e.prototype[e.toStringTag])),l(f.prototype,e.toPrimitive,h("c",e.prototype[e.toPrimitive]))},{"./validate-symbol":224,d:152}],224:[function(a,b,c){"use strict";var d=a("./is-symbol");b.exports=function(a){if(!d(a))throw new TypeError(a+" is not a symbol");return a}},{"./is-symbol":222}],225:[function(a,b,c){"use strict";b.exports=function(a,b,c){var d=b||0,e=c||1;return[[a[12]+a[0],a[13]+a[1],a[14]+a[2],a[15]+a[3]],[a[12]-a[0],a[13]-a[1],a[14]-a[2],a[15]-a[3]],[a[12]+a[4],a[13]+a[5],a[14]+a[6],a[15]+a[7]],[a[12]-a[4],a[13]-a[5],a[14]-a[6],a[15]-a[7]],[d*a[12]+a[8],d*a[13]+a[9],d*a[14]+a[10],d*a[15]+a[11]],[e*a[12]-a[8],e*a[13]-a[9],e*a[14]-a[10],e*a[15]-a[11]]]}},{}],226:[function(a,b,c){"use strict";var d=a("is-string-blank");b.exports=function(a){var b=typeof a;if("string"===b){var c=a;if(0==(a=+a)&&d(c))return!1}else if("number"!==b)return!1;return a-a<1}},{"is-string-blank":424}],227:[function(a,b,c){"use strict";function d(a,b,c){return Math.min(b,Math.max(a,c))}function e(a,b,c){this.dimension=a.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var d=0;d<this.dimension;++d)this.bounds[0][d]=-1/0,this.bounds[1][d]=1/0;this._state=a.slice().reverse(),this._velocity=b.slice().reverse(),this._time=[c],this._scratch=[a.slice(),a.slice(),a.slice(),a.slice(),a.slice()]}function f(a){for(var b=new Array(a),c=0;c<a;++c)b[c]=0;return b}b.exports=function(a,b,c){switch(arguments.length){case 0:return new e([0],[0],0);case 1:if("number"==typeof a){var d=f(a);return new e(d,d,0)}return new e(a,f(a.length),0);case 2:if("number"==typeof b){var d=f(a.length);return new e(a,d,+b)}c=0;case 3:if(a.length!==b.length)throw new Error("state and velocity lengths must match");return new e(a,b,c)}};var g=a("cubic-hermite"),h=a("binary-search-bounds"),i=e.prototype;i.flush=function(a){var b=h.gt(this._time,a)-1;b<=0||(this._time.splice(0,b),this._state.splice(0,b*this.dimension),this._velocity.splice(0,b*this.dimension))},i.curve=function(a){var b=this._time,c=b.length,e=h.le(b,a),f=this._scratch[0],i=this._state,j=this._velocity,k=this.dimension,l=this.bounds;if(e<0)for(var m=k-1,n=0;n<k;++n,--m)f[n]=i[m];else if(e>=c-1){m=i.length-1;var o=a-b[c-1];for(n=0;n<k;++n,--m)f[n]=i[m]+o*j[m]}else{m=k*(e+1)-1;var p=b[e],q=b[e+1]-p||1,r=this._scratch[1],s=this._scratch[2],t=this._scratch[3],u=this._scratch[4],v=!0;for(n=0;n<k;++n,--m)r[n]=i[m],t[n]=j[m]*q,s[n]=i[m+k],u[n]=j[m+k]*q,v=v&&r[n]===s[n]&&t[n]===u[n]&&0===t[n];if(v)for(n=0;n<k;++n)f[n]=r[n];else g(r,t,s,u,(a-p)/q,f)}var w=l[0],x=l[1];for(n=0;n<k;++n)f[n]=d(w[n],x[n],f[n]);return f},i.dcurve=function(a){var b=this._time,c=b.length,d=h.le(b,a),e=this._scratch[0],f=this._state,i=this._velocity,j=this.dimension;if(d>=c-1)for(var k=f.length-1,l=(b[c-1],0);l<j;++l,--k)e[l]=i[k];else{k=j*(d+1)-1;var m=b[d],n=b[d+1]-m||1,o=this._scratch[1],p=this._scratch[2],q=this._scratch[3],r=this._scratch[4],s=!0;for(l=0;l<j;++l,--k)o[l]=f[k],q[l]=i[k]*n,p[l]=f[k+j],r[l]=i[k+j]*n,s=s&&o[l]===p[l]&&q[l]===r[l]&&0===q[l];if(s)for(l=0;l<j;++l)e[l]=0;else for(g.derivative(o,q,p,r,(a-m)/n,e),l=0;l<j;++l)e[l]/=n}return e},i.lastT=function(){var a=this._time;return a[a.length-1]},i.stable=function(){for(var a=this._velocity,b=a.length,c=this.dimension-1;c>=0;--c)if(a[--b])return!1;return!0},i.jump=function(a){var b=this.lastT(),c=this.dimension;if(!(a<b||arguments.length!==c+1)){var e=this._state,f=this._velocity,g=e.length-this.dimension,h=this.bounds,i=h[0],j=h[1];this._time.push(b,a);for(var k=0;k<2;++k)for(var l=0;l<c;++l)e.push(e[g++]),f.push(0);for(this._time.push(a),l=c;l>0;--l)e.push(d(i[l-1],j[l-1],arguments[l])),f.push(0)}},i.push=function(a){var b=this.lastT(),c=this.dimension;if(!(a<b||arguments.length!==c+1)){var e=this._state,f=this._velocity,g=e.length-this.dimension,h=a-b,i=this.bounds,j=i[0],k=i[1],l=h>1e-6?1/h:0;this._time.push(a);for(var m=c;m>0;--m){var n=d(j[m-1],k[m-1],arguments[m]);e.push(n),f.push((n-e[g++])*l)}}},i.set=function(a){var b=this.dimension;if(!(a<this.lastT()||arguments.length!==b+1)){var c=this._state,e=this._velocity,f=this.bounds,g=f[0],h=f[1];this._time.push(a);for(var i=b;i>0;--i)c.push(d(g[i-1],h[i-1],arguments[i])),e.push(0)}},i.move=function(a){var b=this.lastT(),c=this.dimension;if(!(a<=b||arguments.length!==c+1)){var e=this._state,f=this._velocity,g=e.length-this.dimension,h=this.bounds,i=h[0],j=h[1],k=a-b,l=k>1e-6?1/k:0;this._time.push(a);for(var m=c;m>0;--m){var n=arguments[m];e.push(d(i[m-1],j[m-1],e[g++]+n)),f.push(n*l)}}},i.idle=function(a){var b=this.lastT();if(!(a<b)){var c=this.dimension,e=this._state,f=this._velocity,g=e.length-c,h=this.bounds,i=h[0],j=h[1],k=a-b;this._time.push(a);for(var l=c-1;l>=0;--l)e.push(d(i[l],j[l],e[g]+k*f[g])),f.push(0),g+=1}}},{"binary-search-bounds":92,"cubic-hermite":146}],228:[function(a,b,c){var d=a("dtype");b.exports=function(a,b,c){if(!a)throw new TypeError("must specify data as first parameter");if(c=0|+(c||0),Array.isArray(a)&&a[0]&&"number"==typeof a[0][0]){var e,f,g,h,i=a[0].length,j=a.length*i;b&&"string"!=typeof b||(b=new(d(b||"float32"))(j+c));var k=b.length-c;if(j!==k)throw new Error("source length "+j+" ("+i+"x"+a.length+") does not match destination length "+k);for(e=0,g=c;e<a.length;e++)for(f=0;f<i;f++)b[g++]=null===a[e][f]?NaN:a[e][f]}else if(b&&"string"!=typeof b)b.set(a,c);else{var l=d(b||"float32");if(Array.isArray(a)||"array"===b)for(b=new l(a.length+c),e=0,g=c,h=b.length;g<h;g++,e++)b[g]=null===a[e]?NaN:a[e];else 0===c?b=new l(a):(b=new l(a.length+c)).set(a,c)}return b}},{dtype:170}],229:[function(a,b,c){"use strict";var d=a("css-font/stringify"),e=[32,126];b.exports=function(a){var b=(a=a||{}).shape?a.shape:a.canvas?[a.canvas.width,a.canvas.height]:[512,512],c=a.canvas||document.createElement("canvas"),f=a.font,g="number"==typeof a.step?[a.step,a.step]:a.step||[32,32],h=a.chars||e;if(f&&"string"!=typeof f&&(f=d(f)),Array.isArray(h)){if(2===h.length&&"number"==typeof h[0]&&"number"==typeof h[1]){for(var i=[],j=h[0],k=0;j<=h[1];j++)i[k++]=String.fromCharCode(j);h=i}}else h=String(h).split("");b=b.slice(),c.width=b[0],c.height=b[1];var l=c.getContext("2d");l.fillStyle="#000",l.fillRect(0,0,c.width,c.height),l.font=f,l.textAlign="center",l.textBaseline="middle",l.fillStyle="#fff";for(var m=g[0]/2,n=g[1]/2,j=0;j<h.length;j++)l.fillText(h[j],m,n),(m+=g[0])>b[0]-g[0]/2&&(m=g[0]/2,n+=g[1]);return c}},{"css-font/stringify":143}],230:[function(a,b,c){"use strict";function d(a,b){b||(b={}),("string"==typeof a||Array.isArray(a))&&(b.family=a);var c=Array.isArray(b.family)?b.family.join(", "):b.family;if(!c)throw Error("`family` must be defined");var h=b.size||b.fontSize||b.em||48,i=b.weight||b.fontWeight||"",j=(a=[b.style||b.fontStyle||"",i,h].join(" ")+"px "+c,b.origin||"top");if(d.cache[c]&&h<=d.cache[c].em)return e(d.cache[c],j);var k=b.canvas||d.canvas,l=k.getContext("2d"),m={upper:void 0!==b.upper?b.upper:"H",lower:void 0!==b.lower?b.lower:"x",descent:void 0!==b.descent?b.descent:"p",ascent:void 0!==b.ascent?b.ascent:"h",tittle:void 0!==b.tittle?b.tittle:"i",overshoot:void 0!==b.overshoot?b.overshoot:"O"},n=Math.ceil(1.5*h);k.height=n,k.width=.5*n,l.font=a;var o={top:0};l.clearRect(0,0,n,n),l.textBaseline="top",l.fillStyle="black",l.fillText("H",0,0);var p=f(l.getImageData(0,0,n,n));l.clearRect(0,0,n,n),l.textBaseline="bottom",l.fillText("H",0,n);var q=f(l.getImageData(0,0,n,n));o.lineHeight=o.bottom=n-q+p,l.clearRect(0,0,n,n),l.textBaseline="alphabetic",l.fillText("H",0,n);var r=n-f(l.getImageData(0,0,n,n))-1+p;o.baseline=o.alphabetic=r,l.clearRect(0,0,n,n),l.textBaseline="middle",l.fillText("H",0,.5*n);var s=f(l.getImageData(0,0,n,n));o.median=o.middle=n-s-1+p-.5*n,l.clearRect(0,0,n,n),l.textBaseline="hanging",l.fillText("H",0,.5*n);var t=f(l.getImageData(0,0,n,n));o.hanging=n-t-1+p-.5*n,l.clearRect(0,0,n,n),l.textBaseline="ideographic",l.fillText("H",0,n);var u=f(l.getImageData(0,0,n,n));if(o.ideographic=n-u-1+p,m.upper&&(l.clearRect(0,0,n,n),l.textBaseline="top",l.fillText(m.upper,0,0),o.upper=f(l.getImageData(0,0,n,n)),o.capHeight=o.baseline-o.upper),m.lower&&(l.clearRect(0,0,n,n),l.textBaseline="top",l.fillText(m.lower,0,0),o.lower=f(l.getImageData(0,0,n,n)),o.xHeight=o.baseline-o.lower),m.tittle&&(l.clearRect(0,0,n,n),l.textBaseline="top",l.fillText(m.tittle,0,0),o.tittle=f(l.getImageData(0,0,n,n))),m.ascent&&(l.clearRect(0,0,n,n),l.textBaseline="top",l.fillText(m.ascent,0,0),o.ascent=f(l.getImageData(0,0,n,n))),m.descent&&(l.clearRect(0,0,n,n),l.textBaseline="top",l.fillText(m.descent,0,0),o.descent=g(l.getImageData(0,0,n,n))),m.overshoot){l.clearRect(0,0,n,n),l.textBaseline="top",l.fillText(m.overshoot,0,0);var v=g(l.getImageData(0,0,n,n));o.overshoot=v-r}for(var w in o)o[w]/=h;return o.em=h,d.cache[c]=o,e(o,j)}function e(a,b){var c={};for(var d in"string"==typeof b&&(b=a[b]),a)"em"!==d&&(c[d]=a[d]-b);return c}function f(a){for(var b=a.height,c=a.data,d=3;d<c.length;d+=4)if(0!==c[d])return Math.floor(.25*(d-3)/b)}function g(a){for(var b=a.height,c=a.data,d=c.length-1;d>0;d-=4)if(0!==c[d])return Math.floor(.25*(d-3)/b)}b.exports=d,d.canvas=document.createElement("canvas"),d.cache={}},{}],231:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){this._color=a,this.key=b,this.value=c,this.left=d,this.right=e,this._count=f}function e(a){return new d(a._color,a.key,a.value,a.left,a.right,a._count)}function f(a,b){return new d(a,b.key,b.value,b.left,b.right,b._count)}function g(a){a._count=1+(a.left?a.left._count:0)+(a.right?a.right._count:0)}function h(a,b){this._compare=a,this.root=b}function i(a,b){this.tree=a,this._stack=b}function j(a,b){a.key=b.key,a.value=b.value,a.left=b.left,a.right=b.right,a._color=b._color,a._count=b._count}function k(a,b){return a<b?-1:a>b?1:0}b.exports=function(a){return new h(a||k,null)};var l=h.prototype;Object.defineProperty(l,"keys",{get:function(){var a=[];return this.forEach(function(b,c){a.push(b)}),a}}),Object.defineProperty(l,"values",{get:function(){var a=[];return this.forEach(function(b,c){a.push(c)}),a}}),Object.defineProperty(l,"length",{get:function(){return this.root?this.root._count:0}}),l.insert=function(a,b){for(var c=this._compare,e=this.root,i=[],j=[];e;){var k=c(a,e.key);i.push(e),j.push(k),e=k<=0?e.left:e.right}i.push(new d(0,a,b,null,null,1));for(var l=i.length-2;l>=0;--l)e=i[l],j[l]<=0?i[l]=new d(e._color,e.key,e.value,i[l+1],e.right,e._count+1):i[l]=new d(e._color,e.key,e.value,e.left,i[l+1],e._count+1);for(l=i.length-1;l>1;--l){var m=i[l-1];if(e=i[l],1===m._color||1===e._color)break;var n=i[l-2];if(n.left===m)if(m.left===e){if(!(o=n.right)||0!==o._color){n._color=0,n.left=m.right,m._color=1,m.right=n,i[l-2]=m,i[l-1]=e,g(n),g(m),l>=3&&((p=i[l-3]).left===n?p.left=m:p.right=m);break}m._color=1,n.right=f(1,o),n._color=0,l-=1}else{if(!(o=n.right)||0!==o._color){m.right=e.left,n._color=0,n.left=e.right,e._color=1,e.left=m,e.right=n,i[l-2]=e,i[l-1]=m,g(n),g(m),g(e),l>=3&&((p=i[l-3]).left===n?p.left=e:p.right=e);break}m._color=1,n.right=f(1,o),n._color=0,l-=1}else if(m.right===e){if(!(o=n.left)||0!==o._color){n._color=0,n.right=m.left,m._color=1,m.left=n,i[l-2]=m,i[l-1]=e,g(n),g(m),l>=3&&((p=i[l-3]).right===n?p.right=m:p.left=m);break}m._color=1,n.left=f(1,o),n._color=0,l-=1}else{var o;if(!(o=n.left)||0!==o._color){var p;m.left=e.right,n._color=0,n.right=e.left,e._color=1,e.right=m,e.left=n,i[l-2]=e,i[l-1]=m,g(n),g(m),g(e),l>=3&&((p=i[l-3]).right===n?p.right=e:p.left=e);break}m._color=1,n.left=f(1,o),n._color=0,l-=1}}return i[0]._color=1,new h(c,i[0])},l.forEach=function(a,b,c){if(this.root)switch(arguments.length){case 1:return function a(b,c){var d;return c.left&&(d=a(b,c.left))?d:(d=b(c.key,c.value))||(c.right?a(b,c.right):void 0)}(a,this.root);case 2:return function a(b,c,d,e){if(c(b,e.key)<=0){var f;if(e.left&&(f=a(b,c,d,e.left)))return f;if(f=d(e.key,e.value))return f}if(e.right)return a(b,c,d,e.right)}(b,this._compare,a,this.root);case 3:if(this._compare(b,c)>=0)return;return function a(b,c,d,e,f){var g,h=d(b,f.key),i=d(c,f.key);if(h<=0){if(f.left&&(g=a(b,c,d,e,f.left)))return g;if(i>0&&(g=e(f.key,f.value)))return g}if(i>0&&f.right)return a(b,c,d,e,f.right)}(b,c,this._compare,a,this.root)}},Object.defineProperty(l,"begin",{get:function(){for(var a=[],b=this.root;b;)a.push(b),b=b.left;return new i(this,a)}}),Object.defineProperty(l,"end",{get:function(){for(var a=[],b=this.root;b;)a.push(b),b=b.right;return new i(this,a)}}),l.at=function(a){if(a<0)return new i(this,[]);for(var b=this.root,c=[];;){if(c.push(b),b.left){if(a<b.left._count){b=b.left;continue}a-=b.left._count}if(!a)return new i(this,c);if(a-=1,!b.right)break;if(a>=b.right._count)break;b=b.right}return new i(this,[])},l.ge=function(a){for(var b=this._compare,c=this.root,d=[],e=0;c;){var f=b(a,c.key);d.push(c),f<=0&&(e=d.length),c=f<=0?c.left:c.right}return d.length=e,new i(this,d)},l.gt=function(a){for(var b=this._compare,c=this.root,d=[],e=0;c;){var f=b(a,c.key);d.push(c),f<0&&(e=d.length),c=f<0?c.left:c.right}return d.length=e,new i(this,d)},l.lt=function(a){for(var b=this._compare,c=this.root,d=[],e=0;c;){
var f=b(a,c.key);d.push(c),f>0&&(e=d.length),c=f<=0?c.left:c.right}return d.length=e,new i(this,d)},l.le=function(a){for(var b=this._compare,c=this.root,d=[],e=0;c;){var f=b(a,c.key);d.push(c),f>=0&&(e=d.length),c=f<0?c.left:c.right}return d.length=e,new i(this,d)},l.find=function(a){for(var b=this._compare,c=this.root,d=[];c;){var e=b(a,c.key);if(d.push(c),0===e)return new i(this,d);c=e<=0?c.left:c.right}return new i(this,[])},l.remove=function(a){var b=this.find(a);return b?b.remove():this},l.get=function(a){for(var b=this._compare,c=this.root;c;){var d=b(a,c.key);if(0===d)return c.value;c=d<=0?c.left:c.right}};var m=i.prototype;Object.defineProperty(m,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(m,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),m.clone=function(){return new i(this.tree,this._stack.slice())},m.remove=function(){var a=this._stack;if(0===a.length)return this.tree;var b=new Array(a.length),c=a[a.length-1];b[b.length-1]=new d(c._color,c.key,c.value,c.left,c.right,c._count);for(var i=a.length-2;i>=0;--i)(c=a[i]).left===a[i+1]?b[i]=new d(c._color,c.key,c.value,b[i+1],c.right,c._count):b[i]=new d(c._color,c.key,c.value,c.left,b[i+1],c._count);if((c=b[b.length-1]).left&&c.right){var k=b.length;for(c=c.left;c.right;)b.push(c),c=c.right;var l=b[k-1];for(b.push(new d(c._color,l.key,l.value,c.left,c.right,c._count)),b[k-1].key=c.key,b[k-1].value=c.value,i=b.length-2;i>=k;--i)c=b[i],b[i]=new d(c._color,c.key,c.value,c.left,b[i+1],c._count);b[k-1].left=b[k]}if(0===(c=b[b.length-1])._color){var m=b[b.length-2];for(m.left===c?m.left=null:m.right===c&&(m.right=null),b.pop(),i=0;i<b.length;++i)b[i]._count--;return new h(this.tree._compare,b[0])}if(c.left||c.right){for(c.left?j(c,c.left):c.right&&j(c,c.right),c._color=1,i=0;i<b.length-1;++i)b[i]._count--;return new h(this.tree._compare,b[0])}if(1===b.length)return new h(this.tree._compare,null);for(i=0;i<b.length;++i)b[i]._count--;var n=b[b.length-2];return function(a){for(var b,c,d,h,i=a.length-1;i>=0;--i){if(b=a[i],0===i)return void(b._color=1);if((c=a[i-1]).left===b){if((d=c.right).right&&0===d.right._color)return h=(d=c.right=e(d)).right=e(d.right),c.right=d.left,d.left=c,d.right=h,d._color=c._color,b._color=1,c._color=1,h._color=1,g(c),g(d),i>1&&((j=a[i-2]).left===c?j.left=d:j.right=d),void(a[i-1]=d);if(d.left&&0===d.left._color)return h=(d=c.right=e(d)).left=e(d.left),c.right=h.left,d.left=h.right,h.left=c,h.right=d,h._color=c._color,c._color=1,d._color=1,b._color=1,g(c),g(d),g(h),i>1&&((j=a[i-2]).left===c?j.left=h:j.right=h),void(a[i-1]=h);if(1===d._color){if(0===c._color)return c._color=1,void(c.right=f(0,d));c.right=f(0,d);continue}d=e(d),c.right=d.left,d.left=c,d._color=c._color,c._color=0,g(c),g(d),i>1&&((j=a[i-2]).left===c?j.left=d:j.right=d),a[i-1]=d,a[i]=c,i+1<a.length?a[i+1]=b:a.push(b),i+=2}else{if((d=c.left).left&&0===d.left._color)return h=(d=c.left=e(d)).left=e(d.left),c.left=d.right,d.right=c,d.left=h,d._color=c._color,b._color=1,c._color=1,h._color=1,g(c),g(d),i>1&&((j=a[i-2]).right===c?j.right=d:j.left=d),void(a[i-1]=d);if(d.right&&0===d.right._color)return h=(d=c.left=e(d)).right=e(d.right),c.left=h.right,d.right=h.left,h.right=c,h.left=d,h._color=c._color,c._color=1,d._color=1,b._color=1,g(c),g(d),g(h),i>1&&((j=a[i-2]).right===c?j.right=h:j.left=h),void(a[i-1]=h);if(1===d._color){if(0===c._color)return c._color=1,void(c.left=f(0,d));c.left=f(0,d);continue}var j;d=e(d),c.left=d.right,d.right=c,d._color=c._color,c._color=0,g(c),g(d),i>1&&((j=a[i-2]).right===c?j.right=d:j.left=d),a[i-1]=d,a[i]=c,i+1<a.length?a[i+1]=b:a.push(b),i+=2}}}(b),n.left===c?n.left=null:n.right=null,new h(this.tree._compare,b[0])},Object.defineProperty(m,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(m,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(m,"index",{get:function(){var a=0,b=this._stack;if(0===b.length){var c=this.tree.root;return c?c._count:0}b[b.length-1].left&&(a=b[b.length-1].left._count);for(var d=b.length-2;d>=0;--d)b[d+1]===b[d].right&&(++a,b[d].left&&(a+=b[d].left._count));return a},enumerable:!0}),m.next=function(){var a=this._stack;if(0!==a.length){var b=a[a.length-1];if(b.right)for(b=b.right;b;)a.push(b),b=b.left;else for(a.pop();a.length>0&&a[a.length-1].right===b;)b=a[a.length-1],a.pop()}},Object.defineProperty(m,"hasNext",{get:function(){var a=this._stack;if(0===a.length)return!1;if(a[a.length-1].right)return!0;for(var b=a.length-1;b>0;--b)if(a[b-1].left===a[b])return!0;return!1}}),m.update=function(a){var b=this._stack;if(0===b.length)throw new Error("Can't update empty node!");var c=new Array(b.length),e=b[b.length-1];c[c.length-1]=new d(e._color,e.key,a,e.left,e.right,e._count);for(var f=b.length-2;f>=0;--f)(e=b[f]).left===b[f+1]?c[f]=new d(e._color,e.key,e.value,c[f+1],e.right,e._count):c[f]=new d(e._color,e.key,e.value,e.left,c[f+1],e._count);return new h(this.tree._compare,c[0])},m.prev=function(){var a=this._stack;if(0!==a.length){var b=a[a.length-1];if(b.left)for(b=b.left;b;)a.push(b),b=b.right;else for(a.pop();a.length>0&&a[a.length-1].left===b;)b=a[a.length-1],a.pop()}},Object.defineProperty(m,"hasPrev",{get:function(){var a=this._stack;if(0===a.length)return!1;if(a[a.length-1].left)return!0;for(var b=a.length-1;b>0;--b)if(a[b-1].right===a[b])return!0;return!1}})},{}],232:[function(a,b,c){function d(a){if(a<0)return Number("0/0");for(var b=g[0],c=g.length-1;c>0;--c)b+=g[c]/(a+c);var d=a+f+.5;return.5*Math.log(2*Math.PI)+(a+.5)*Math.log(d)-d+Math.log(b)-Math.log(a)}var e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7],f=607/128,g=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];b.exports=function a(b){if(b<.5)return Math.PI/(Math.sin(Math.PI*b)*a(1-b));if(b>100)return Math.exp(d(b));b-=1;for(var c=e[0],f=1;f<9;f++)c+=e[f]/(b+f);var g=b+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(g,b+.5)*Math.exp(-g)*c},b.exports.log=d},{}],233:[function(a,b,c){b.exports=function(a,b){if("string"!=typeof a)throw new TypeError("must specify type string");if(b=b||{},"undefined"==typeof document&&!b.canvas)return null;var c=b.canvas||document.createElement("canvas");"number"==typeof b.width&&(c.width=b.width),"number"==typeof b.height&&(c.height=b.height);var d,e=b;try{var f=[a];0===a.indexOf("webgl")&&f.push("experimental-"+a);for(var g=0;g<f.length;g++)if(d=c.getContext(f[g],e))return d}catch(a){d=null}return d||null}},{}],234:[function(a,b,c){"use strict";function d(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a}function e(a){this.gl=a,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=j(a)}function f(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}function g(a,b,c,d,e){for(var f=a.primalOffset,g=a.primalMinor,h=a.mirrorOffset,i=a.mirrorMinor,j=d[b],k=0;k<3;++k)if(b!==k){var l=f,m=h,n=g,o=i;j&1<<k&&(l=h,m=f,n=i,o=g),l[k]=c[0][k],m[k]=c[1][k],e[k]>0?(n[k]=-1,o[k]=0):(n[k]=0,o[k]=1)}}b.exports=function(a,b){var c=new e(a);return c.update(b),c};var h=a("./lib/text.js"),i=a("./lib/lines.js"),j=a("./lib/background.js"),k=a("./lib/cube.js"),l=a("./lib/ticks.js"),m=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),n=e.prototype;n.update=function(a){function b(b,c,d){if(d in a){var e,f=a[d],g=this[d];(b?Array.isArray(f)&&Array.isArray(f[0]):Array.isArray(f))?this[d]=e=[c(f[0]),c(f[1]),c(f[2])]:this[d]=e=[c(f),c(f),c(f)];for(var h=0;h<3;++h)if(e[h]!==g[h])return!0}return!1}a=a||{};var c,d=b.bind(this,!1,Number),e=b.bind(this,!1,Boolean),f=b.bind(this,!1,String),g=b.bind(this,!0,function(a){if(Array.isArray(a)){if(3===a.length)return[+a[0],+a[1],+a[2],1];if(4===a.length)return[+a[0],+a[1],+a[2],+a[3]]}return[0,0,0,1]}),j=!1,k=!1;if("bounds"in a)for(var m=a.bounds,n=0;n<2;++n)for(var o=0;o<3;++o)m[n][o]!==this.bounds[n][o]&&(k=!0),this.bounds[n][o]=m[n][o];if("ticks"in a)for(c=a.ticks,j=!0,this.autoTicks=!1,n=0;n<3;++n)this.tickSpacing[n]=0;else d("tickSpacing")&&(this.autoTicks=!0,k=!0);if(this._firstInit&&("ticks"in a||"tickSpacing"in a||(this.autoTicks=!0),k=!0,j=!0,this._firstInit=!1),k&&this.autoTicks&&(c=l.create(this.bounds,this.tickSpacing),j=!0),j){for(n=0;n<3;++n)c[n].sort(function(a,b){return a.x-b.x});l.equal(c,this.ticks)?j=!1:this.ticks=c}e("tickEnable"),f("tickFont")&&(j=!0),d("tickSize"),d("tickAngle"),d("tickPad"),g("tickColor");var p=f("labels");f("labelFont")&&(p=!0),e("labelEnable"),d("labelSize"),d("labelPad"),g("labelColor"),e("lineEnable"),e("lineMirror"),d("lineWidth"),g("lineColor"),e("lineTickEnable"),e("lineTickMirror"),d("lineTickLength"),d("lineTickWidth"),g("lineTickColor"),e("gridEnable"),d("gridWidth"),g("gridColor"),e("zeroEnable"),g("zeroLineColor"),d("zeroLineWidth"),e("backgroundEnable"),g("backgroundColor"),this._text?this._text&&(p||j)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=h(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&j&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=i(this.gl,this.bounds,this.ticks))};var o=[new f,new f,new f],p=[0,0,0],q={model:m,view:m,projection:m,_ortho:!1};n.isOpaque=function(){return!0},n.isTransparent=function(){return!1},n.drawTransparent=function(a){};var r=[0,0,0],s=[0,0,0],t=[0,0,0];n.draw=function(a){function b(a){(N=[0,0,0])[a]=1}a=a||q;for(var c=this.gl,e=a.model||m,f=a.view||m,h=a.projection||m,i=this.bounds,j=a._ortho||!1,l=k(e,f,h,i,j),n=l.cubeEdges,u=l.axis,v=f[12],w=f[13],x=f[14],y=f[15],z=(j?2:1)*this.pixelRatio*(h[3]*v+h[7]*w+h[11]*x+h[15]*y)/c.drawingBufferHeight,A=0;A<3;++A)this.lastCubeProps.cubeEdges[A]=n[A],this.lastCubeProps.axis[A]=u[A];var B=o;for(A=0;A<3;++A)g(o[A],A,this.bounds,n,u);c=this.gl;var C,D=p;for(A=0;A<3;++A)this.backgroundEnable[A]?D[A]=u[A]:D[A]=0;for(this._background.draw(e,f,h,i,D,this.backgroundColor),this._lines.bind(e,f,h,this),A=0;A<3;++A){var E=[0,0,0];u[A]>0?E[A]=i[1][A]:E[A]=i[0][A];for(var F=0;F<2;++F){var G=(A+1+F)%3,H=(A+1+(1^F))%3;this.gridEnable[G]&&this._lines.drawGrid(G,H,this.bounds,E,this.gridColor[G],this.gridWidth[G]*this.pixelRatio)}for(F=0;F<2;++F)G=(A+1+F)%3,H=(A+1+(1^F))%3,this.zeroEnable[H]&&Math.min(i[0][H],i[1][H])<=0&&Math.max(i[0][H],i[1][H])>=0&&this._lines.drawZero(G,H,this.bounds,E,this.zeroLineColor[H],this.zeroLineWidth[H]*this.pixelRatio)}for(A=0;A<3;++A){this.lineEnable[A]&&this._lines.drawAxisLine(A,this.bounds,B[A].primalOffset,this.lineColor[A],this.lineWidth[A]*this.pixelRatio),this.lineMirror[A]&&this._lines.drawAxisLine(A,this.bounds,B[A].mirrorOffset,this.lineColor[A],this.lineWidth[A]*this.pixelRatio);var I=d(r,B[A].primalMinor),J=d(s,B[A].mirrorMinor),K=this.lineTickLength;for(F=0;F<3;++F){var L=z/e[5*F];I[F]*=K[F]*L,J[F]*=K[F]*L}this.lineTickEnable[A]&&this._lines.drawAxisTicks(A,B[A].primalOffset,I,this.lineTickColor[A],this.lineTickWidth[A]*this.pixelRatio),this.lineTickMirror[A]&&this._lines.drawAxisTicks(A,B[A].mirrorOffset,J,this.lineTickColor[A],this.lineTickWidth[A]*this.pixelRatio)}this._lines.unbind(),this._text.bind(e,f,h,this.pixelRatio);var M,N;for(A=0;A<3;++A){var O=B[A].primalMinor,P=B[A].mirrorMinor,Q=d(t,B[A].primalOffset);for(F=0;F<3;++F)this.lineTickEnable[A]&&(Q[F]+=z*O[F]*Math.max(this.lineTickLength[F],0)/e[5*F]);var R=[0,0,0];if(R[A]=1,this.tickEnable[A]){for(-3600===this.tickAngle[A]?(this.tickAngle[A]=0,this.tickAlign[A]="auto"):this.tickAlign[A]=-1,M=1,"auto"===(C=[this.tickAlign[A],.5,M])[0]?C[0]=0:C[0]=parseInt(""+C[0]),N=[0,0,0],function(a,c,d){var e=(a+1)%3,f=(a+2)%3,g=c[e],h=c[f],i=d[e],j=d[f];g>0&&j>0?b(e):g>0&&j<0?b(e):g<0&&j>0?b(e):g<0&&j<0?b(e):h>0&&i>0?b(f):h>0&&i<0?b(f):h<0&&i>0?b(f):h<0&&i<0&&b(f)}(A,O,P),F=0;F<3;++F)Q[F]+=z*O[F]*this.tickPad[F]/e[5*F];this._text.drawTicks(A,this.tickSize[A],this.tickAngle[A],Q,this.tickColor[A],R,N,C)}if(this.labelEnable[A]){for(M=0,N=[0,0,0],this.labels[A].length>4&&(b(A),M=1),"auto"===(C=[this.labelAlign[A],.5,M])[0]?C[0]=0:C[0]=parseInt(""+C[0]),F=0;F<3;++F)Q[F]+=z*O[F]*this.labelPad[F]/e[5*F];Q[A]+=.5*(i[0][A]+i[1][A]),this._text.drawLabel(A,this.labelSize[A],this.labelAngle[A],Q,this.labelColor[A],[0,0,0],N,C)}}this._text.unbind()},n.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":235,"./lib/cube.js":236,"./lib/lines.js":237,"./lib/text.js":239,"./lib/ticks.js":240}],235:[function(a,b,c){"use strict";function d(a,b,c,d){this.gl=a,this.buffer=b,this.vao=c,this.shader=d}b.exports=function(a){for(var b=[],c=[],h=0,i=0;i<3;++i)for(var j=(i+1)%3,k=(i+2)%3,l=[0,0,0],m=[0,0,0],n=-1;n<=1;n+=2){c.push(h,h+2,h+1,h+1,h+2,h+3),l[i]=n,m[i]=n;for(var o=-1;o<=1;o+=2){l[j]=o;for(var p=-1;p<=1;p+=2)l[k]=p,b.push(l[0],l[1],l[2],m[0],m[1],m[2]),h+=1}var q=j;j=k,k=q}var r=e(a,new Float32Array(b)),s=e(a,new Uint16Array(c),a.ELEMENT_ARRAY_BUFFER),t=f(a,[{buffer:r,type:a.FLOAT,size:3,offset:0,stride:24},{buffer:r,type:a.FLOAT,size:3,offset:12,stride:24}],s),u=g(a);return u.attributes.position.location=0,u.attributes.normal.location=1,new d(a,r,t,u)};var e=a("gl-buffer"),f=a("gl-vao"),g=a("./shaders").bg,h=d.prototype;h.draw=function(a,b,c,d,e,f){for(var g=!1,h=0;h<3;++h)g=g||e[h];if(g){var i=this.gl;i.enable(i.POLYGON_OFFSET_FILL),i.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:a,view:b,projection:c,bounds:d,enable:e,colors:f},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),i.disable(i.POLYGON_OFFSET_FILL)}},h.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":238,"gl-buffer":242,"gl-vao":328}],236:[function(a,b,c){"use strict";function d(a,b,c){for(var d=0;d<4;++d){a[d]=c[12+d];for(var e=0;e<3;++e)a[d]+=b[e]*c[4*e+d]}}function e(a){for(var b=0;b<o.length;++b)if((a=h.positive(a,o[b])).length<3)return 0;var c=a[0],d=c[0]/c[3],e=c[1]/c[3],f=0;for(b=1;b+1<a.length;++b){var g=a[b],i=a[b+1],j=g[0]/g[3]-d,k=g[1]/g[3]-e,l=i[0]/i[3]-d,m=i[1]/i[3]-e;f+=Math.abs(j*m-k*l)}return f}b.exports=function(a,b,c,h,o){g(j,b,a),g(j,c,j);for(var s=0,t=0;t<2;++t){m[2]=h[t][2];for(var u=0;u<2;++u){m[1]=h[u][1];for(var v=0;v<2;++v)m[0]=h[v][0],d(k[s],m,j),s+=1}}for(var w=-1,t=0;t<8;++t){for(var x=k[t][3],y=0;y<3;++y)l[t][y]=k[t][y]/x;o&&(l[t][2]*=-1),x<0&&(w<0?w=t:l[t][2]<l[w][2]&&(w=t))}if(w<0){w=0;for(var z=0;z<3;++z){for(var A=(z+2)%3,B=(z+1)%3,C=-1,D=-1,E=0;E<2;++E){var F=E<<z,G=F+(E<<A)+(1-E<<B),H=F+(1-E<<A)+(E<<B);i(l[F],l[G],l[H],n)<0||(E?C=1:D=1)}if(C<0||D<0)D>C&&(w|=1<<z);else{for(var E=0;E<2;++E){var F=E<<z,G=F+(E<<A)+(1-E<<B),H=F+(1-E<<A)+(E<<B),I=e([k[F],k[G],k[H],k[F+(1<<A)+(1<<B)]]);E?C=I:D=I}D>C&&(w|=1<<z)}}}for(var J=7^w,K=-1,t=0;t<8;++t)t!==w&&t!==J&&(K<0?K=t:l[K][1]>l[t][1]&&(K=t));for(var L=-1,t=0;t<3;++t){var M=K^1<<t;if(M!==w&&M!==J){L<0&&(L=M);var B=l[M];B[0]<l[L][0]&&(L=M)}}for(var N=-1,t=0;t<3;++t){var M=K^1<<t;if(M!==w&&M!==J&&M!==L){N<0&&(N=M);var B=l[M];B[0]>l[N][0]&&(N=M)}}var O=p;O[0]=O[1]=O[2]=0,O[f.log2(L^K)]=K&L,O[f.log2(K^N)]=K&N;var P=7^N;P===w||P===J?(P=7^L,O[f.log2(N^P)]=P&N):O[f.log2(L^P)]=P&L;for(var Q=q,R=w,z=0;z<3;++z)Q[z]=R&1<<z?-1:1;return r};var f=a("bit-twiddle"),g=a("gl-mat4/multiply"),h=a("split-polygon"),i=a("robust-orientation"),j=new Array(16),k=new Array(8),l=new Array(8),m=new Array(3),n=[0,0,0];!function(){for(var a=0;a<8;++a)k[a]=[1,1,1,1],l[a]=[1,1,1]}();var o=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]],p=[1,1,1],q=[0,0,0],r={cubeEdges:p,axis:q}},{"bit-twiddle":93,"gl-mat4/multiply":268,"robust-orientation":511,"split-polygon":528}],237:[function(a,b,c){"use strict";function d(a){return a[0]=a[1]=a[2]=0,a}function e(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a}function f(a,b,c,d,e,f,g,h){this.gl=a,this.vertBuffer=b,this.vao=c,this.shader=d,this.tickCount=e,this.tickOffset=f,this.gridCount=g,this.gridOffset=h}b.exports=function(a,b,c){var d=[],e=[0,0,0],j=[0,0,0],k=[0,0,0],l=[0,0,0];d.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var m=0;m<3;++m){for(var n=d.length/3|0,o=0;o<c[m].length;++o){var p=+c[m][o].x;d.push(p,0,1,p,1,1,p,0,-1,p,0,-1,p,1,1,p,1,-1)}var q=d.length/3|0;e[m]=n,j[m]=q-n;for(var n=d.length/3|0,r=0;r<c[m].length;++r){var p=+c[m][r].x;d.push(p,0,1,p,1,1,p,0,-1,p,0,-1,p,1,1,p,1,-1)}var q=d.length/3|0;k[m]=n,l[m]=q-n}var s=g(a,new Float32Array(d)),t=h(a,[{buffer:s,type:a.FLOAT,size:3,stride:0,offset:0}]),u=i(a);return u.attributes.position.location=0,new f(a,s,t,u,j,e,l,k)};var g=a("gl-buffer"),h=a("gl-vao"),i=a("./shaders").line,j=[0,0,0],k=[0,0,0],l=[0,0,0],m=[0,0,0],n=[1,1],o=f.prototype;o.bind=function(a,b,c){this.shader.bind(),this.shader.uniforms.model=a,this.shader.uniforms.view=b,this.shader.uniforms.projection=c,n[0]=this.gl.drawingBufferWidth,n[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=n,this.vao.bind()},o.unbind=function(){this.vao.unbind()},o.drawAxisLine=function(a,b,c,f,g){var h=d(k);this.shader.uniforms.majorAxis=k,h[a]=b[1][a]-b[0][a],this.shader.uniforms.minorAxis=h;var i,j=e(m,c);j[a]+=b[0][a],this.shader.uniforms.offset=j,this.shader.uniforms.lineWidth=g,this.shader.uniforms.color=f,(i=d(l))[(a+2)%3]=1,this.shader.uniforms.screenAxis=i,this.vao.draw(this.gl.TRIANGLES,6),(i=d(l))[(a+1)%3]=1,this.shader.uniforms.screenAxis=i,this.vao.draw(this.gl.TRIANGLES,6)},o.drawAxisTicks=function(a,b,c,e,f){if(this.tickCount[a]){var g=d(j);g[a]=1,this.shader.uniforms.majorAxis=g,this.shader.uniforms.offset=b,this.shader.uniforms.minorAxis=c,this.shader.uniforms.color=e,this.shader.uniforms.lineWidth=f;var h=d(l);h[a]=1,this.shader.uniforms.screenAxis=h,this.vao.draw(this.gl.TRIANGLES,this.tickCount[a],this.tickOffset[a])}},o.drawGrid=function(a,b,c,f,g,h){if(this.gridCount[a]){var i=d(k);i[b]=c[1][b]-c[0][b],this.shader.uniforms.minorAxis=i;var n=e(m,f);n[b]+=c[0][b],this.shader.uniforms.offset=n;var o=d(j);o[a]=1,this.shader.uniforms.majorAxis=o;var p=d(l);p[a]=1,this.shader.uniforms.screenAxis=p,this.shader.uniforms.lineWidth=h,this.shader.uniforms.color=g,this.vao.draw(this.gl.TRIANGLES,this.gridCount[a],this.gridOffset[a])}},o.drawZero=function(a,b,c,f,g,h){var i=d(k);this.shader.uniforms.majorAxis=i,i[a]=c[1][a]-c[0][a],this.shader.uniforms.minorAxis=i;var j=e(m,f);j[a]+=c[0][a],this.shader.uniforms.offset=j;var n=d(l);n[b]=1,this.shader.uniforms.screenAxis=n,this.shader.uniforms.lineWidth=h,this.shader.uniforms.color=g,this.vao.draw(this.gl.TRIANGLES,6)},o.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":238,"gl-buffer":242,"gl-vao":328}],238:[function(a,b,c){"use strict";var d=a("glslify"),e=a("gl-shader"),f=d(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]),g=d(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);c.line=function(a){return e(a,f,g,null,[{name:"position",type:"vec3"}])};var h=d(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]),i=d(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);c.text=function(a){return e(a,h,i,null,[{name:"position",type:"vec3"}])};var j=d(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]),k=d(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);c.bg=function(a){return e(a,j,k,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":302,glslify:410}],239:[function(a,b,c){(function(c){"use strict";function d(a,b,c,d){this.gl=a,this.shader=b,this.buffer=c,this.vao=d,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}b.exports=function(a,b,c,g,i,j){var k=e(a),l=f(a,[{buffer:k,size:3}]),m=h(a);m.attributes.position.location=0;var n=new d(a,m,k,l);return n.update(b,c,g,i,j),n};var e=a("gl-buffer"),f=a("gl-vao"),g=a("vectorize-text"),h=a("./shaders").text,i=window||c.global||{},j=i.__TEXT_CACHE||{};i.__TEXT_CACHE={};var k=d.prototype,l=[0,0];k.bind=function(a,b,c,d){this.vao.bind(),this.shader.bind();var e=this.shader.uniforms;e.model=a,e.view=b,e.projection=c,e.pixelScale=d,l[0]=this.gl.drawingBufferWidth,l[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=l},k.unbind=function(){this.vao.unbind()},k.update=function(a,b,c,d,e){function f(a,b,c,d,e,f){var i=j[c];i||(i=j[c]={});var k=i[b];k||(k=i[b]=function(a,b){try{return g(a,b)}catch(b){return console.warn('error vectorizing text:"'+a+'" error:',b),{cells:[],positions:[]}}}(b,{triangles:!0,font:c,textAlign:"center",textBaseline:"middle",lineSpacing:e,styletags:f}));for(var l=(d||12)/12,m=k.positions,n=k.cells,o=0,p=n.length;o<p;++o)for(var q=n[o],r=2;r>=0;--r){var s=m[q[r]];h.push(l*s[0],-l*s[1],a)}}for(var h=[],i=[0,0,0],k=[0,0,0],l=[0,0,0],m=[0,0,0],n={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},o=0;o<3;++o){l[o]=h.length/3|0,f(.5*(a[0][o]+a[1][o]),b[o],c[o],12,1.25,n),m[o]=(h.length/3|0)-l[o],i[o]=h.length/3|0;for(var p=0;p<d[o].length;++p)d[o][p].text&&f(d[o][p].x,d[o][p].text,d[o][p].font||e,d[o][p].fontSize||12,1.25,n);k[o]=(h.length/3|0)-i[o]}this.buffer.update(h),this.tickOffset=i,this.tickCount=k,this.labelOffset=l,this.labelCount=m},k.drawTicks=function(a,b,c,d,e,f,g,h){this.tickCount[a]&&(this.shader.uniforms.axis=f,this.shader.uniforms.color=e,this.shader.uniforms.angle=c,this.shader.uniforms.scale=b,this.shader.uniforms.offset=d,this.shader.uniforms.alignDir=g,this.shader.uniforms.alignOpt=h,this.vao.draw(this.gl.TRIANGLES,this.tickCount[a],this.tickOffset[a]))},k.drawLabel=function(a,b,c,d,e,f,g,h){this.labelCount[a]&&(this.shader.uniforms.axis=f,this.shader.uniforms.color=e,this.shader.uniforms.angle=c,this.shader.uniforms.scale=b,this.shader.uniforms.offset=d,this.shader.uniforms.alignDir=g,this.shader.uniforms.alignOpt=h,this.vao.draw(this.gl.TRIANGLES,this.labelCount[a],this.labelOffset[a]))},k.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this,a("_process"))},{"./shaders":238,_process:483,"gl-buffer":242,"gl-vao":328,"vectorize-text":551}],240:[function(a,b,c){"use strict";function d(a,b){var c=a+"",d=c.indexOf("."),e=0;d>=0&&(e=c.length-d-1);var f=Math.pow(10,e),g=Math.round(a*b*f),h=g+"";if(h.indexOf("e")>=0)return h;var i=g/f,j=g%f;g<0?(i=0|-Math.ceil(i),j=0|-j):(i=0|Math.floor(i),j|=0);var k=""+i;if(g<0&&(k="-"+k),e){for(var l=""+j;l.length<e;)l="0"+l;return k+"."+l}return k}c.create=function(a,b){for(var c=[],e=0;e<3;++e){for(var f=[],g=(a[0][e],a[1][e],0);g*b[e]<=a[1][e];++g)f.push({x:g*b[e],text:d(b[e],g)});for(var g=-1;g*b[e]>=a[0][e];--g)f.push({x:g*b[e],text:d(b[e],g)});c.push(f)}return c},c.equal=function(a,b){for(var c=0;c<3;++c){if(a[c].length!==b[c].length)return!1;for(var d=0;d<a[c].length;++d){var e=a[c][d],f=b[c][d];if(e.x!==f.x||e.text!==f.text||e.font!==f.font||e.fontColor!==f.fontColor||e.fontSize!==f.fontSize||e.dx!==f.dx||e.dy!==f.dy)return!1}}return!0}},{}],241:[function(a,b,c){"use strict";function d(a,b,c){this.lo=a,this.hi=b,this.pixelsPerDataUnit=c}function e(a,b,c,d,e){for(var f=0;f<3;++f){for(var g=n,h=o,i=0;i<3;++i)h[i]=g[i]=c[i];h[3]=g[3]=1,h[f]+=1,k(h,h,b),h[3]<0&&(a[f]=1/0),g[f]-=1,k(g,g,b),g[3]<0&&(a[f]=1/0);var j=(g[0]/g[3]-h[0]/h[3])*d,l=(g[1]/g[3]-h[1]/h[3])*e;a[f]=.25*Math.sqrt(j*j+l*l)}return a}b.exports=function(a,b,c,d,k){var n=b.model||l,o=b.view||l,r=b.projection||l,s=b._ortho||!1,t=a.bounds,u=(k=k||h(n,o,r,t,s)).axis;i(m,o,n),i(m,r,m);for(var v=p,w=0;w<3;++w)v[w].lo=1/0,v[w].hi=-1/0,v[w].pixelsPerDataUnit=1/0;var x=f(j(m,m));j(m,m);for(var y=0;y<3;++y){var z=(y+1)%3,A=(y+2)%3,B=q;a:for(var w=0;w<2;++w){var C=[];if(u[y]<0!=!!w){B[y]=t[w][y];for(var D=0;D<2;++D){B[z]=t[D^w][z];for(var E=0;E<2;++E)B[A]=t[E^D^w][A],C.push(B.slice())}for(var F=s?5:4,D=F;D===F;++D){if(0===C.length)continue a;C=g.positive(C,x[D])}for(var D=0;D<C.length;++D)for(var A=C[D],G=e(q,m,A,c,d),E=0;E<3;++E)v[E].lo=Math.min(v[E].lo,A[E]),v[E].hi=Math.max(v[E].hi,A[E]),E!==y&&(v[E].pixelsPerDataUnit=Math.min(v[E].pixelsPerDataUnit,Math.abs(G[E])))}}}return v};var f=a("extract-frustum-planes"),g=a("split-polygon"),h=a("./lib/cube.js"),i=a("gl-mat4/multiply"),j=a("gl-mat4/transpose"),k=a("gl-vec4/transformMat4"),l=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),m=new Float32Array(16),n=[0,0,0,1],o=[0,0,0,1],p=[new d(1/0,-1/0,1/0),new d(1/0,-1/0,1/0),new d(1/0,-1/0,1/0)],q=[0,0,0]},{"./lib/cube.js":236,"extract-frustum-planes":225,"gl-mat4/multiply":268,"gl-mat4/transpose":277,"gl-vec4/transformMat4":399,"split-polygon":528}],242:[function(a,b,c){"use strict";function d(a,b,c,d,e){this.gl=a,this.type=b,this.handle=c,this.length=d,this.usage=e}function e(a,b,c,d,e,f){var g=e.length*e.BYTES_PER_ELEMENT;if(f<0)return a.bufferData(b,e,d),g;if(g+f>c)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return a.bufferSubData(b,f,e),c}function f(a,b){
for(var c=g.malloc(a.length,b),d=a.length,e=0;e<d;++e)c[e]=a[e];return c}var g=a("typedarray-pool"),h=a("ndarray-ops"),i=a("ndarray"),j=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"],k=d.prototype;k.bind=function(){this.gl.bindBuffer(this.type,this.handle)},k.unbind=function(){this.gl.bindBuffer(this.type,null)},k.dispose=function(){this.gl.deleteBuffer(this.handle)},k.update=function(a,b){if("number"!=typeof b&&(b=-1),this.bind(),"object"==typeof a&&void 0!==a.shape){var c=a.dtype;if(j.indexOf(c)<0&&(c="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(c=gl.getExtension("OES_element_index_uint")&&"uint16"!==c?"uint32":"uint16"),c===a.dtype&&function(a,b){for(var c=1,d=b.length-1;d>=0;--d){if(b[d]!==c)return!1;c*=a[d]}return!0}(a.shape,a.stride))0===a.offset&&a.data.length===a.shape[0]?this.length=e(this.gl,this.type,this.length,this.usage,a.data,b):this.length=e(this.gl,this.type,this.length,this.usage,a.data.subarray(a.offset,a.shape[0]),b);else{var d=g.malloc(a.size,c),k=i(d,a.shape);h.assign(k,a),this.length=e(this.gl,this.type,this.length,this.usage,b<0?d:d.subarray(0,a.size),b),g.free(d)}}else if(Array.isArray(a)){var l;l=this.type===this.gl.ELEMENT_ARRAY_BUFFER?f(a,"uint16"):f(a,"float32"),this.length=e(this.gl,this.type,this.length,this.usage,b<0?l:l.subarray(0,a.length),b),g.free(l)}else if("object"==typeof a&&"number"==typeof a.length)this.length=e(this.gl,this.type,this.length,this.usage,a,b);else{if("number"!=typeof a&&void 0!==a)throw new Error("gl-buffer: Invalid data type");if(b>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(a|=0)<=0&&(a=1),this.gl.bufferData(this.type,0|a,this.usage),this.length=a}},b.exports=function(a,b,c,e){if(c=c||a.ARRAY_BUFFER,e=e||a.DYNAMIC_DRAW,c!==a.ARRAY_BUFFER&&c!==a.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(e!==a.DYNAMIC_DRAW&&e!==a.STATIC_DRAW&&e!==a.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var f=a.createBuffer(),g=new d(a,c,f,0,e);return g.update(b),g}},{ndarray:451,"ndarray-ops":445,"typedarray-pool":546}],243:[function(a,b,c){"use strict";var d=a("gl-vec3"),e=function(a,b){for(var c=0;c<a.length;c++)if(a[c]>=b)return c-1;return c},f=d.create(),g=d.create(),h=function(a,b,c){return a<b?b:a>c?c:a},i=function(a,b,c,i){var j=a[0],k=a[1],l=a[2],m=c[0].length,n=c[1].length,o=c[2].length,p=e(c[0],j),q=e(c[1],k),r=e(c[2],l),s=p+1,t=q+1,u=r+1;if(i&&(p=h(p,0,m-1),s=h(s,0,m-1),q=h(q,0,n-1),t=h(t,0,n-1),r=h(r,0,o-1),u=h(u,0,o-1)),p<0||q<0||r<0||s>=m||t>=n||u>=o)return d.create();var v=(j-c[0][p])/(c[0][s]-c[0][p]),w=(k-c[1][q])/(c[1][t]-c[1][q]),x=(l-c[2][r])/(c[2][u]-c[2][r]);(v<0||v>1||isNaN(v))&&(v=0),(w<0||w>1||isNaN(w))&&(w=0),(x<0||x>1||isNaN(x))&&(x=0);var y=r*m*n,z=u*m*n,A=q*m,B=t*m,C=p,D=s,E=b[A+y+C],F=b[A+y+D],G=b[B+y+C],H=b[B+y+D],I=b[A+z+C],J=b[A+z+D],K=b[B+z+C],L=b[B+z+D],M=d.create();return d.lerp(M,E,F,v),d.lerp(f,G,H,v),d.lerp(M,M,f,w),d.lerp(f,I,J,v),d.lerp(g,K,L,v),d.lerp(f,f,g,w),d.lerp(M,M,f,x),M};b.exports=function(a,b){var c;c=a.positions?a.positions:function(a){for(var b=a[0],c=a[1],d=a[2],e=[],f=0;f<d.length;f++)for(var g=0;g<c.length;g++)for(var h=0;h<b.length;h++)e.push([d[f],c[g],b[h]]);return e}(a.meshgrid);var e=a.meshgrid,f=a.vectors,g={positions:[],vertexIntensity:[],vertexIntensityBounds:a.vertexIntensityBounds,vertexNormals:[],vectors:[],cells:[],coneOffset:a.coneOffset,colormap:a.colormap};if(0===a.positions.length)return b&&(b[0]=[0,0,0],b[1]=[0,0,0]),g;for(var h=0,j=1/0,k=-1/0,l=1/0,m=-1/0,n=1/0,o=-1/0,p=null,q=null,r=[],s=1/0,t=0;t<c.length;t++){var u,v=c[t];j=Math.min(v[0],j),k=Math.max(v[0],k),l=Math.min(v[1],l),m=Math.max(v[1],m),n=Math.min(v[2],n),o=Math.max(v[2],o),u=e?i(v,f,e,!0):f[t],d.length(u)>h&&(h=d.length(u)),t&&(s=Math.min(s,2*d.distance(p,v)/(d.length(q)+d.length(u)))),p=v,q=u,r.push(u)}var w=[j,l,n],x=[k,m,o];b&&(b[0]=w,b[1]=x),0===h&&(h=1);var y=1/h;isFinite(s)&&!isNaN(s)||(s=1),g.vectorScale=s;var z=function(a,b,c){var e=d.create();return d.set(e,0,1,0),e}(),A=a.coneSize||.5;a.absoluteConeSize&&(A=a.absoluteConeSize*y),g.coneScale=A,t=0;for(var B=0;t<c.length;t++)for(var C=(v=c[t])[0],D=v[1],E=v[2],F=r[t],G=d.length(F)*y,H=0;H<8;H++){g.positions.push([C,D,E,B++]),g.positions.push([C,D,E,B++]),g.positions.push([C,D,E,B++]),g.positions.push([C,D,E,B++]),g.positions.push([C,D,E,B++]),g.positions.push([C,D,E,B++]),g.vectors.push(F),g.vectors.push(F),g.vectors.push(F),g.vectors.push(F),g.vectors.push(F),g.vectors.push(F),g.vertexIntensity.push(G,G,G),g.vertexIntensity.push(G,G,G),g.vertexNormals.push(z,z,z),g.vertexNormals.push(z,z,z);var I=g.positions.length;g.cells.push([I-6,I-5,I-4],[I-3,I-2,I-1])}return g},b.exports.createConeMesh=a("./lib/conemesh")},{"./lib/conemesh":244,"gl-vec3":347}],244:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w,x,y){this.gl=a,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=b,this.dirty=!0,this.triShader=c,this.pickShader=d,this.trianglePositions=e,this.triangleVectors=f,this.triangleColors=h,this.triangleNormals=j,this.triangleUVs=i,this.triangleIds=g,this.triangleVAO=k,this.triangleCount=0,this.lineWidth=1,this.edgePositions=l,this.edgeColors=n,this.edgeUVs=o,this.edgeIds=m,this.edgeVAO=p,this.edgeCount=0,this.pointPositions=q,this.pointColors=s,this.pointUVs=u,this.pointSizes=v,this.pointIds=r,this.pointVAO=w,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=x,this.contourVAO=y,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=t,this._view=t,this._projection=t,this._resolution=[1,1]}function e(a){var b=f(a,s.vertex,s.fragment,null,s.attributes);return b.attributes.position.location=0,b.attributes.id.location=1,b.attributes.vector.location=5,b}var f=a("gl-shader"),g=a("gl-buffer"),h=a("gl-vao"),i=a("gl-texture2d"),j=a("normals"),k=a("gl-mat4/multiply"),l=a("gl-mat4/invert"),m=a("ndarray"),n=a("colormap"),o=a("simplicial-complex-contour"),p=a("typedarray-pool"),q=a("./shaders"),r=q.meshShader,s=q.pickShader,t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=d.prototype;u.isOpaque=function(){return this.opacity>=1},u.isTransparent=function(){return this.opacity<1},u.pickSlots=1,u.setPickBase=function(a){this.pickId=a},u.highlight=function(a){if(a&&this.contourEnable){for(var b=o(this.cells,this.intensity,a.intensity),c=b.cells,d=b.vertexIds,e=b.vertexWeights,f=c.length,g=p.mallocFloat32(6*f),h=0,i=0;i<f;++i)for(var j=c[i],k=0;k<2;++k){var l=j[0];2===j.length&&(l=j[k]);for(var m=d[l][0],n=d[l][1],q=e[l],r=1-q,s=this.positions[m],t=this.positions[n],u=0;u<3;++u)g[h++]=q*s[u]+r*t[u]}this.contourCount=h/3|0,this.contourPositions.update(g.subarray(0,h)),p.free(g)}else this.contourCount=0},u.update=function(a){a=a||{};var b=this.gl;this.dirty=!0,"contourEnable"in a&&(this.contourEnable=a.contourEnable),"contourColor"in a&&(this.contourColor=a.contourColor),"lineWidth"in a&&(this.lineWidth=a.lineWidth),"lightPosition"in a&&(this.lightPosition=a.lightPosition),"opacity"in a&&(this.opacity=a.opacity),"ambient"in a&&(this.ambientLight=a.ambient),"diffuse"in a&&(this.diffuseLight=a.diffuse),"specular"in a&&(this.specularLight=a.specular),"roughness"in a&&(this.roughness=a.roughness),"fresnel"in a&&(this.fresnel=a.fresnel),void 0!==a.vectorScale&&(this.vectorScale=a.vectorScale),void 0!==a.coneScale&&(this.coneScale=a.coneScale),void 0!==a.coneOffset&&(this.coneOffset=a.coneOffset),a.texture?(this.texture.dispose(),this.texture=i(b,a.texture)):a.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=b.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=b.LINEAR,this.texture.setPixels(function(a){for(var b=n({colormap:a,nshades:256,format:"rgba"}),c=new Uint8Array(1024),d=0;d<256;++d){for(var e=b[d],f=0;f<3;++f)c[4*d+f]=e[f];c[4*d+3]=255*e[3]}return m(c,[256,256,4],[4,0,1])}(a.colormap)),this.texture.generateMipmap());var c=a.cells,d=a.positions,e=a.vectors;if(d&&c&&e){var f=[],g=[],h=[],k=[],l=[],o=[],p=[],q=[],r=[],s=[],t=[],u=[],v=[],w=[],x=[];this.cells=c,this.positions=d;var y=a.vertexNormals,z=a.cellNormals,A=void 0===a.vertexNormalsEpsilon?1e-6:a.vertexNormalsEpsilon,B=void 0===a.faceNormalsEpsilon?1e-6:a.faceNormalsEpsilon;a.useFacetNormals&&!z&&(z=j.faceNormals(c,d,B)),z||y||(y=j.vertexNormals(c,d,A));var C=a.vertexColors,D=a.cellColors,E=a.meshColor||[1,1,1,1],F=a.vertexUVs,G=a.vertexIntensity,H=a.cellUVs,I=a.cellIntensity,J=1/0,K=-1/0;if(!F&&!H)if(G)if(a.vertexIntensityBounds)J=+a.vertexIntensityBounds[0],K=+a.vertexIntensityBounds[1];else for(var L=0;L<G.length;++L){var M=G[L];J=Math.min(J,M),K=Math.max(K,M)}else if(I)for(L=0;L<I.length;++L)M=I[L],J=Math.min(J,M),K=Math.max(K,M);else for(L=0;L<d.length;++L)M=d[L][2],J=Math.min(J,M),K=Math.max(K,M);this.intensity=G||(I?function(a,b,c){for(var d=new Array(b),e=0;e<b;++e)d[e]=0;var f=a.length;for(e=0;e<f;++e)for(var g=a[e],h=0;h<g.length;++h)d[g[h]]=c[e];return d}(c,d.length,I):function(a){for(var b=a.length,c=new Array(b),d=0;d<b;++d)c[d]=a[d][2];return c}(d));var N=a.pointSizes,O=a.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],L=0;L<d.length;++L)for(var P=d[L],Q=0;Q<3;++Q)!isNaN(P[Q])&&isFinite(P[Q])&&(this.bounds[0][Q]=Math.min(this.bounds[0][Q],P[Q]),this.bounds[1][Q]=Math.max(this.bounds[1][Q],P[Q]));var R=0,S=0,T=0;a:for(L=0;L<c.length;++L){var U=c[L];switch(U.length){case 1:for(P=d[W=U[0]],Q=0;Q<3;++Q)if(isNaN(P[Q])||!isFinite(P[Q]))continue a;t.push(P[0],P[1],P[2],P[3]),3===(X=C?C[W]:D?D[L]:E).length?u.push(X[0],X[1],X[2],1):u.push(X[0],X[1],X[2],X[3]),Y=F?F[W]:G?[(G[W]-J)/(K-J),0]:H?H[L]:I?[(I[L]-J)/(K-J),0]:[(P[2]-J)/(K-J),0],v.push(Y[0],Y[1]),N?w.push(N[W]):w.push(O),x.push(L),T+=1;break;case 2:for(Q=0;Q<2;++Q){P=d[W=U[Q]];for(var V=0;V<3;++V)if(isNaN(P[V])||!isFinite(P[V]))continue a}for(Q=0;Q<2;++Q)P=d[W=U[Q]],p.push(P[0],P[1],P[2]),3===(X=C?C[W]:D?D[L]:E).length?q.push(X[0],X[1],X[2],1):q.push(X[0],X[1],X[2],X[3]),Y=F?F[W]:G?[(G[W]-J)/(K-J),0]:H?H[L]:I?[(I[L]-J)/(K-J),0]:[(P[2]-J)/(K-J),0],r.push(Y[0],Y[1]),s.push(L);S+=1;break;case 3:for(Q=0;Q<3;++Q)for(P=d[W=U[Q]],V=0;V<3;++V)if(isNaN(P[V])||!isFinite(P[V]))continue a;for(Q=0;Q<3;++Q){var W;P=d[W=U[2-Q]],f.push(P[0],P[1],P[2],P[3]);var X,Y,Z,$=e[W];g.push($[0],$[1],$[2]),3===(X=C?C[W]:D?D[L]:E).length?h.push(X[0],X[1],X[2],1):h.push(X[0],X[1],X[2],X[3]),Y=F?F[W]:G?[(G[W]-J)/(K-J),0]:H?H[L]:I?[(I[L]-J)/(K-J),0]:[(P[2]-J)/(K-J),0],l.push(Y[0],Y[1]),Z=y?y[W]:z[L],k.push(Z[0],Z[1],Z[2]),o.push(L)}R+=1}}this.pointCount=T,this.edgeCount=S,this.triangleCount=R,this.pointPositions.update(t),this.pointColors.update(u),this.pointUVs.update(v),this.pointSizes.update(w),this.pointIds.update(new Uint32Array(x)),this.edgePositions.update(p),this.edgeColors.update(q),this.edgeUVs.update(r),this.edgeIds.update(new Uint32Array(s)),this.trianglePositions.update(f),this.triangleVectors.update(g),this.triangleColors.update(h),this.triangleUVs.update(l),this.triangleNormals.update(k),this.triangleIds.update(new Uint32Array(o))}},u.drawTransparent=u.draw=function(a){a=a||{};for(var b=this.gl,c=a.model||t,d=a.view||t,e=a.projection||t,f=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],g=0;g<3;++g)f[0][g]=Math.max(f[0][g],this.clipBounds[0][g]),f[1][g]=Math.min(f[1][g],this.clipBounds[1][g]);var h={model:c,view:d,projection:e,inverseModel:t.slice(),clipBounds:f,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,contourColor:this.contourColor,texture:0};h.inverseModel=l(h.inverseModel,h.model),b.disable(b.CULL_FACE),this.texture.bind(0);var i=new Array(16);for(k(i,h.view,h.model),k(i,h.projection,i),l(i,i),g=0;g<3;++g)h.eyePosition[g]=i[12+g]/i[15];var j=i[15];for(g=0;g<3;++g)j+=this.lightPosition[g]*i[4*g+3];for(g=0;g<3;++g){for(var m=i[12+g],n=0;n<3;++n)m+=i[4*n+g]*this.lightPosition[n];h.lightPosition[g]=m/j}if(this.triangleCount>0){var o=this.triShader;o.bind(),o.uniforms=h,this.triangleVAO.bind(),b.drawArrays(b.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},u.drawPick=function(a){a=a||{};for(var b=this.gl,c=a.model||t,d=a.view||t,e=a.projection||t,f=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],g=0;g<3;++g)f[0][g]=Math.max(f[0][g],this.clipBounds[0][g]),f[1][g]=Math.min(f[1][g],this.clipBounds[1][g]);this._model=[].slice.call(c),this._view=[].slice.call(d),this._projection=[].slice.call(e),this._resolution=[b.drawingBufferWidth,b.drawingBufferHeight];var h={model:c,view:d,projection:e,clipBounds:f,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},i=this.pickShader;i.bind(),i.uniforms=h,this.triangleCount>0&&(this.triangleVAO.bind(),b.drawArrays(b.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),b.lineWidth(this.lineWidth*this.pixelRatio),b.drawArrays(b.LINES,0,2*this.edgeCount),this.edgeVAO.unbind())},u.pick=function(a){if(!a)return null;if(a.id!==this.pickId)return null;var b=a.value[0]+256*a.value[1]+65536*a.value[2],c=this.cells[b],d=this.positions[c[1]].slice(0,3);return{index:Math.floor(c[1]/48),position:d,dataCoordinate:d}},u.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose()},b.exports=function(a,b){1===arguments.length&&(a=(b=a).gl);var c=b.triShader||function(a){var b=f(a,r.vertex,r.fragment,null,r.attributes);return b.attributes.position.location=0,b.attributes.color.location=2,b.attributes.uv.location=3,b.attributes.vector.location=5,b}(a),j=e(a),k=i(a,m(new Uint8Array([255,255,255,255]),[1,1,4]));k.generateMipmap(),k.minFilter=a.LINEAR_MIPMAP_LINEAR,k.magFilter=a.LINEAR;var l=g(a),n=g(a),o=g(a),p=g(a),q=g(a),s=g(a),t=h(a,[{buffer:l,type:a.FLOAT,size:4},{buffer:s,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:o,type:a.FLOAT,size:4},{buffer:p,type:a.FLOAT,size:2},{buffer:q,type:a.FLOAT,size:3},{buffer:n,type:a.FLOAT,size:3}]),u=g(a),v=g(a),w=g(a),x=g(a),y=h(a,[{buffer:u,type:a.FLOAT,size:3},{buffer:x,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:v,type:a.FLOAT,size:4},{buffer:w,type:a.FLOAT,size:2}]),z=g(a),A=g(a),B=g(a),C=g(a),D=g(a),E=h(a,[{buffer:z,type:a.FLOAT,size:3},{buffer:D,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:A,type:a.FLOAT,size:4},{buffer:B,type:a.FLOAT,size:2},{buffer:C,type:a.FLOAT,size:1}]),F=g(a),G=new d(a,k,c,j,l,n,s,o,p,q,t,u,x,v,w,y,z,D,A,B,C,E,F,h(a,[{buffer:F,type:a.FLOAT,size:3}]));return G.update(b),G}},{"./shaders":245,colormap:127,"gl-buffer":242,"gl-mat4/invert":266,"gl-mat4/multiply":268,"gl-shader":302,"gl-texture2d":323,"gl-vao":328,ndarray:451,normals:454,"simplicial-complex-contour":519,"typedarray-pool":546}],245:[function(a,b,c){var d=a("glslify"),e=d(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\nuniform float vectorScale;\nuniform float coneScale;\n\nuniform float coneOffset;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * conePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal,0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),f=d(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),g=d(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nuniform float vectorScale;\nuniform float coneScale;\nuniform float coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),h=d(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);c.meshShader={vertex:e,fragment:f,attributes:[{name:"position",type:"vec4"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},c.pickShader={vertex:g,fragment:h,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:410}],246:[function(a,b,c){b.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",
35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],247:[function(a,b,c){var d=a("./1.0/numbers");b.exports=function(a){return d[a]}},{"./1.0/numbers":246}],248:[function(a,b,c){"use strict";function d(a,b,c,d){this.gl=a,this.shader=d,this.buffer=b,this.vao=c,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}function e(a,b){for(var c=0;c<3;++c)a[0][c]=Math.min(a[0][c],b[c]),a[1][c]=Math.max(a[1][c],b[c])}function f(a,b,c,d){for(var e=l[d],f=0;f<e.length;++f){var g=e[f];a.push(b[0],b[1],b[2],c[0],c[1],c[2],c[3],g[0],g[1],g[2])}return e.length}b.exports=function(a){var b=a.gl,c=g(b),e=h(b,[{buffer:c,type:b.FLOAT,size:3,offset:0,stride:40},{buffer:c,type:b.FLOAT,size:4,offset:12,stride:40},{buffer:c,type:b.FLOAT,size:3,offset:28,stride:40}]),f=i(b);f.attributes.position.location=0,f.attributes.color.location=1,f.attributes.offset.location=2;var j=new d(b,c,e,f);return j.update(a),j};var g=a("gl-buffer"),h=a("gl-vao"),i=a("./shaders/index"),j=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],k=d.prototype;k.isOpaque=function(){return!this.hasAlpha},k.isTransparent=function(){return this.hasAlpha},k.drawTransparent=k.draw=function(a){var b=this.gl,c=this.shader.uniforms;this.shader.bind();var d=c.view=a.view||j,e=c.projection=a.projection||j;c.model=a.model||j,c.clipBounds=this.clipBounds,c.opacity=this.opacity;var f=d[12],g=d[13],h=d[14],i=d[15],k=(a._ortho?2:1)*this.pixelRatio*(e[3]*f+e[7]*g+e[11]*h+e[15]*i)/b.drawingBufferHeight;this.vao.bind();for(var l=0;l<3;++l)b.lineWidth(this.lineWidth[l]*this.pixelRatio),c.capSize=this.capSize[l]*k,this.lineCount[l]&&b.drawArrays(b.LINES,this.lineOffset[l],this.lineCount[l]);this.vao.unbind()};var l=function(){for(var a=new Array(3),b=0;b<3;++b){for(var c=[],d=1;d<=2;++d)for(var e=-1;e<=1;e+=2){var f=[0,0,0];f[(d+b)%3]=e,c.push(f)}a[b]=c}return a}();k.update=function(a){"lineWidth"in(a=a||{})&&(this.lineWidth=a.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in a&&(this.capSize=a.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in a&&(this.opacity=+a.opacity,this.opacity<1&&(this.hasAlpha=!0));var b=a.color||[[0,0,0],[0,0,0],[0,0,0]],c=a.position,d=a.error;if(Array.isArray(b[0])||(b=[b,b,b]),c&&d){var g=[],h=c.length,i=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var j=0;j<3;++j){this.lineOffset[j]=i;a:for(var k=0;k<h;++k){for(var l=c[k],m=0;m<3;++m)if(isNaN(l[m])||!isFinite(l[m]))continue a;var n=d[k],o=b[j];if(Array.isArray(o[0])&&(o=b[k]),3===o.length?o=[o[0],o[1],o[2],1]:4===o.length&&(o=[o[0],o[1],o[2],o[3]],!this.hasAlpha&&o[3]<1&&(this.hasAlpha=!0)),!isNaN(n[0][j])&&!isNaN(n[1][j])){var p;n[0][j]<0&&((p=l.slice())[j]+=n[0][j],g.push(l[0],l[1],l[2],o[0],o[1],o[2],o[3],0,0,0,p[0],p[1],p[2],o[0],o[1],o[2],o[3],0,0,0),e(this.bounds,p),i+=2+f(g,p,o,j)),n[1][j]>0&&((p=l.slice())[j]+=n[1][j],g.push(l[0],l[1],l[2],o[0],o[1],o[2],o[3],0,0,0,p[0],p[1],p[2],o[0],o[1],o[2],o[3],0,0,0),e(this.bounds,p),i+=2+f(g,p,o,j))}}this.lineCount[j]=i-this.lineOffset[j]}this.buffer.update(g)}},k.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":249,"gl-buffer":242,"gl-vao":328}],249:[function(a,b,c){"use strict";var d=a("glslify"),e=a("gl-shader"),f=d(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]),g=d(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);b.exports=function(a){return e(a,f,g,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":302,glslify:410}],250:[function(a,b,c){"use strict";function d(a){return[a.getParameter(a.FRAMEBUFFER_BINDING),a.getParameter(a.RENDERBUFFER_BINDING),a.getParameter(a.TEXTURE_BINDING_2D)]}function e(a,b){a.bindFramebuffer(a.FRAMEBUFFER,b[0]),a.bindRenderbuffer(a.RENDERBUFFER,b[1]),a.bindTexture(a.TEXTURE_2D,b[2])}function f(a){switch(a){case l:throw new Error("gl-fbo: Framebuffer unsupported");case m:throw new Error("gl-fbo: Framebuffer incomplete attachment");case n:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case o:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function g(a,b,c,d,e,f){if(!d)return null;var g=k(a,b,c,e,d);return g.magFilter=a.NEAREST,g.minFilter=a.NEAREST,g.mipSamples=1,g.bind(),a.framebufferTexture2D(a.FRAMEBUFFER,f,a.TEXTURE_2D,g.handle,0),g}function h(a,b,c,d,e){var f=a.createRenderbuffer();return a.bindRenderbuffer(a.RENDERBUFFER,f),a.renderbufferStorage(a.RENDERBUFFER,d,b,c),a.framebufferRenderbuffer(a.FRAMEBUFFER,e,a.RENDERBUFFER,f),f}function i(a,b,c,i,j,k,l,m){this.gl=a,this._shape=[0|b,0|c],this._destroyed=!1,this._ext=m,this.color=new Array(j);for(var n=0;n<j;++n)this.color[n]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=i,this._useDepth=k,this._useStencil=l;var o=this,q=[0|b,0|c];Object.defineProperties(q,{0:{get:function(){return o._shape[0]},set:function(a){return o.width=a}},1:{get:function(){return o._shape[1]},set:function(a){return o.height=a}}}),this._shapeVector=q,function(a){var b=d(a.gl),c=a.gl,i=a.handle=c.createFramebuffer(),j=a._shape[0],k=a._shape[1],l=a.color.length,m=a._ext,n=a._useStencil,o=a._useDepth,q=a._colorType;c.bindFramebuffer(c.FRAMEBUFFER,i);for(var r=0;r<l;++r)a.color[r]=g(c,j,k,q,c.RGBA,c.COLOR_ATTACHMENT0+r);0===l?(a._color_rb=h(c,j,k,c.RGBA4,c.COLOR_ATTACHMENT0),m&&m.drawBuffersWEBGL(p[0])):l>1&&m.drawBuffersWEBGL(p[l]);var s=c.getExtension("WEBGL_depth_texture");s?n?a.depth=g(c,j,k,s.UNSIGNED_INT_24_8_WEBGL,c.DEPTH_STENCIL,c.DEPTH_STENCIL_ATTACHMENT):o&&(a.depth=g(c,j,k,c.UNSIGNED_SHORT,c.DEPTH_COMPONENT,c.DEPTH_ATTACHMENT)):o&&n?a._depth_rb=h(c,j,k,c.DEPTH_STENCIL,c.DEPTH_STENCIL_ATTACHMENT):o?a._depth_rb=h(c,j,k,c.DEPTH_COMPONENT16,c.DEPTH_ATTACHMENT):n&&(a._depth_rb=h(c,j,k,c.STENCIL_INDEX,c.STENCIL_ATTACHMENT));var t=c.checkFramebufferStatus(c.FRAMEBUFFER);if(t!==c.FRAMEBUFFER_COMPLETE){for(a._destroyed=!0,c.bindFramebuffer(c.FRAMEBUFFER,null),c.deleteFramebuffer(a.handle),a.handle=null,a.depth&&(a.depth.dispose(),a.depth=null),a._depth_rb&&(c.deleteRenderbuffer(a._depth_rb),a._depth_rb=null),r=0;r<a.color.length;++r)a.color[r].dispose(),a.color[r]=null;a._color_rb&&(c.deleteRenderbuffer(a._color_rb),a._color_rb=null),e(c,b),f(t)}e(c,b)}(this)}function j(a,b,c){if(a._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(a._shape[0]!==b||a._shape[1]!==c){var g=a.gl,h=g.getParameter(g.MAX_RENDERBUFFER_SIZE);if(b<0||b>h||c<0||c>h)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");a._shape[0]=b,a._shape[1]=c;for(var i=d(g),j=0;j<a.color.length;++j)a.color[j].shape=a._shape;a._color_rb&&(g.bindRenderbuffer(g.RENDERBUFFER,a._color_rb),g.renderbufferStorage(g.RENDERBUFFER,g.RGBA4,a._shape[0],a._shape[1])),a.depth&&(a.depth.shape=a._shape),a._depth_rb&&(g.bindRenderbuffer(g.RENDERBUFFER,a._depth_rb),a._useDepth&&a._useStencil?g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_STENCIL,a._shape[0],a._shape[1]):a._useDepth?g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_COMPONENT16,a._shape[0],a._shape[1]):a._useStencil&&g.renderbufferStorage(g.RENDERBUFFER,g.STENCIL_INDEX,a._shape[0],a._shape[1])),g.bindFramebuffer(g.FRAMEBUFFER,a.handle);var k=g.checkFramebufferStatus(g.FRAMEBUFFER);k!==g.FRAMEBUFFER_COMPLETE&&(a.dispose(),e(g,i),f(k)),e(g,i)}}var k=a("gl-texture2d");b.exports=function(a,b,c,d){l||(l=a.FRAMEBUFFER_UNSUPPORTED,m=a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,n=a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,o=a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var e=a.getExtension("WEBGL_draw_buffers");if(!p&&e&&function(a,b){var c=a.getParameter(b.MAX_COLOR_ATTACHMENTS_WEBGL);p=new Array(c+1);for(var d=0;d<=c;++d){for(var e=new Array(c),f=0;f<d;++f)e[f]=a.COLOR_ATTACHMENT0+f;for(var f=d;f<c;++f)e[f]=a.NONE;p[d]=e}}(a,e),Array.isArray(b)&&(d=c,c=0|b[1],b=0|b[0]),"number"!=typeof b)throw new Error("gl-fbo: Missing shape parameter");var f=a.getParameter(a.MAX_RENDERBUFFER_SIZE);if(b<0||b>f||c<0||c>f)throw new Error("gl-fbo: Parameters are too large for FBO");var g=1;if("color"in(d=d||{})){if((g=Math.max(0|d.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(g>1){if(!e)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(g>a.getParameter(e.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+g+" draw buffers")}}var h=a.UNSIGNED_BYTE,j=a.getExtension("OES_texture_float");if(d.float&&g>0){if(!j)throw new Error("gl-fbo: Context does not support floating point textures");h=a.FLOAT}else d.preferFloat&&g>0&&j&&(h=a.FLOAT);var k=!0;"depth"in d&&(k=!!d.depth);var q=!1;return"stencil"in d&&(q=!!d.stencil),new i(a,b,c,h,g,k,q,e)};var l,m,n,o,p=null,q=i.prototype;Object.defineProperties(q,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(a){if(Array.isArray(a)||(a=[0|a,0|a]),2!==a.length)throw new Error("gl-fbo: Shape vector must be length 2");var b=0|a[0],c=0|a[1];return j(this,b,c),[b,c]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(a){return j(this,a|=0,this._shape[1]),a},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(a){return a|=0,j(this,this._shape[0],a),a},enumerable:!1}}),q.bind=function(){if(!this._destroyed){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,this.handle),a.viewport(0,0,this._shape[0],this._shape[1])}},q.dispose=function(){if(!this._destroyed){this._destroyed=!0;var a=this.gl;a.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(a.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var b=0;b<this.color.length;++b)this.color[b].dispose(),this.color[b]=null;this._color_rb&&(a.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":323}],251:[function(a,b,c){var d=a("sprintf-js").sprintf,e=a("gl-constants/lookup"),f=a("glsl-shader-name"),g=a("add-line-numbers");b.exports=function(a,b,c){"use strict";var h=f(b)||"of unknown name (see npm glsl-shader-name)",i="unknown type";void 0!==c&&(i=c===e.FRAGMENT_SHADER?"fragment":"vertex");for(var j=d("Error compiling %s shader %s:\n",i,h),k=d("%s%s",j,a),l=a.split("\n"),m={},n=0;n<l.length;n++){var o=l[n];if(""!==o&&"\0"!==o){var p=parseInt(o.split(":")[2]);if(isNaN(p))throw new Error(d("Could not parse error: %s",o));m[p]=o}}for(var q=g(b).split("\n"),n=0;n<q.length;n++)if(m[n+3]||m[n+2]||m[n+1]){var r=q[n];if(j+=r+"\n",m[n+1]){var s=m[n+1];s=s.substr(s.split(":",3).join(":").length+1).trim(),j+=d("^^^ %s\n\n",s)}}return{long:j.trim(),short:k.trim()}}},{"add-line-numbers":62,"gl-constants/lookup":247,"glsl-shader-name":402,"sprintf-js":529}],252:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g){this.plot=a,this.shader=b,this.pickShader=c,this.positionBuffer=d,this.weightBuffer=e,this.colorBuffer=f,this.idBuffer=g,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}b.exports=function(a,b){var c=a.gl,e=i(c,k.vertex,k.fragment),f=i(c,k.pickVertex,k.pickFragment),g=j(c),h=j(c),l=j(c),m=j(c),n=new d(a,e,f,g,h,l,m);return n.update(b),a.addObject(n),n};var e,f=a("binary-search-bounds"),g=a("iota-array"),h=a("typedarray-pool"),i=a("gl-shader"),j=a("gl-buffer"),k=a("./lib/shaders"),l=d.prototype,m=[0,0,1,0,0,1,1,0,1,1,0,1];l.draw=(e=[1,0,0,0,1,0,0,0,1],function(){var a=this.plot,b=this.shader,c=this.bounds,d=this.numVertices;if(!(d<=0)){var f=a.gl,g=a.dataBox,h=c[2]-c[0],i=c[3]-c[1],j=g[2]-g[0],k=g[3]-g[1];e[0]=2*h/j,e[4]=2*i/k,e[6]=2*(c[0]-g[0])/j-1,e[7]=2*(c[1]-g[1])/k-1,b.bind();var l=b.uniforms;l.viewTransform=e,l.shape=this.shape;var m=b.attributes;this.positionBuffer.bind(),m.position.pointer(),this.weightBuffer.bind(),m.weight.pointer(f.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),m.color.pointer(f.UNSIGNED_BYTE,!0),f.drawArrays(f.TRIANGLES,0,d)}}),l.drawPick=function(){var a=[1,0,0,0,1,0,0,0,1],b=[0,0,0,0];return function(c){var d=this.plot,e=this.pickShader,f=this.bounds,g=this.numVertices;if(!(g<=0)){var h=d.gl,i=d.dataBox,j=f[2]-f[0],k=f[3]-f[1],l=i[2]-i[0],m=i[3]-i[1];a[0]=2*j/l,a[4]=2*k/m,a[6]=2*(f[0]-i[0])/l-1,a[7]=2*(f[1]-i[1])/m-1;for(var n=0;n<4;++n)b[n]=c>>8*n&255;this.pickOffset=c,e.bind();var o=e.uniforms;o.viewTransform=a,o.pickOffset=b,o.shape=this.shape;var p=e.attributes;return this.positionBuffer.bind(),p.position.pointer(),this.weightBuffer.bind(),p.weight.pointer(h.UNSIGNED_BYTE,!1),this.idBuffer.bind(),p.pickId.pointer(h.UNSIGNED_BYTE,!1),h.drawArrays(h.TRIANGLES,0,g),c+this.shape[0]*this.shape[1]}}}(),l.pick=function(a,b,c){var d=this.pickOffset,e=this.shape[0]*this.shape[1];if(c<d||c>=d+e)return null;var f=c-d,g=this.xData,h=this.yData;return{object:this,pointId:f,dataCoord:[g[f%this.shape[0]],h[f/this.shape[0]|0]]}},l.update=function(a){var b=(a=a||{}).shape||[0,0],c=a.x||g(b[0]),d=a.y||g(b[1]),e=a.z||new Float32Array(b[0]*b[1]);this.xData=c,this.yData=d;var i=a.colorLevels||[0],j=a.colorValues||[0,0,0,1],k=i.length,l=this.bounds,n=l[0]=c[0],o=l[1]=d[0],p=1/((l[2]=c[c.length-1])-n),q=1/((l[3]=d[d.length-1])-o),r=b[0],s=b[1];this.shape=[r,s];var t=(r-1)*(s-1)*(m.length>>>1);this.numVertices=t;for(var u=h.mallocUint8(4*t),v=h.mallocFloat32(2*t),w=h.mallocUint8(2*t),x=h.mallocUint32(t),y=0,z=0;z<s-1;++z)for(var A=q*(d[z]-o),B=q*(d[z+1]-o),C=0;C<r-1;++C)for(var D=p*(c[C]-n),E=p*(c[C+1]-n),F=0;F<m.length;F+=2){var G,H,I,J,K=m[F],L=m[F+1],M=e[(z+L)*r+(C+K)],N=f.le(i,M);if(N<0)G=j[0],H=j[1],I=j[2],J=j[3];else if(N===k-1)G=j[4*k-4],H=j[4*k-3],I=j[4*k-2],J=j[4*k-1];else{var O=(M-i[N])/(i[N+1]-i[N]),P=1-O,Q=4*N,R=4*(N+1);G=P*j[Q]+O*j[R],H=P*j[Q+1]+O*j[R+1],I=P*j[Q+2]+O*j[R+2],J=P*j[Q+3]+O*j[R+3]}u[4*y]=255*G,u[4*y+1]=255*H,u[4*y+2]=255*I,u[4*y+3]=255*J,v[2*y]=.5*D+.5*E,v[2*y+1]=.5*A+.5*B,w[2*y]=K,w[2*y+1]=L,x[y]=z*r+C,y+=1}this.positionBuffer.update(v),this.weightBuffer.update(w),this.colorBuffer.update(u),this.idBuffer.update(x),h.free(v),h.free(u),h.free(w),h.free(x)},l.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":253,"binary-search-bounds":254,"gl-buffer":242,"gl-shader":302,"iota-array":417,"typedarray-pool":546}],253:[function(a,b,c){"use strict";var d=a("glslify");b.exports={fragment:d(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:d(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:d(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:d(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:410}],254:[function(a,b,c){arguments[4][112][0].apply(c,arguments)},{dup:112}],255:[function(a,b,c){var d=a("glslify"),e=a("gl-shader"),f=d(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]),g=d(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]),h=d(["precision highp float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\nlowp vec4 encode_float_1540259130(highp float v) {\n  highp float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n  \n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n  \n  //Unpack exponent\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0; \n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, encode_float_1540259130(pixelArcLength).xyz);\n}"]),i=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];c.createShader=function(a){return e(a,f,g,null,i)},c.createPickShader=function(a){return e(a,f,h,null,i)}},{"gl-shader":302,glslify:410}],256:[function(a,b,c){"use strict";function d(a,b){for(var c=0,d=0;d<3;++d){var e=a[d]-b[d];c+=e*e}return Math.sqrt(c)}function e(a){for(var b=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],c=0;c<3;++c)b[0][c]=Math.max(a[0][c],b[0][c]),b[1][c]=Math.min(a[1][c],b[1][c]);return b}function f(a,b,c,d){this.arcLength=a,this.position=b,this.index=c,this.dataCoordinate=d}function g(a,b,c,d,e,f){this.gl=a,this.shader=b,this.pickShader=c,this.buffer=d,this.vao=e,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=f,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}b.exports=function(a){var b=a.gl||a.scene&&a.scene.gl,c=o(b);c.attributes.position.location=0,c.attributes.nextPosition.location=1,c.attributes.arcLength.location=2,c.attributes.lineWidth.location=3,c.attributes.color.location=4;var d=p(b);d.attributes.position.location=0,d.attributes.nextPosition.location=1,d.attributes.arcLength.location=2,d.attributes.lineWidth.location=3,d.attributes.color.location=4;for(var e=h(b),f=i(b,[{buffer:e,size:3,offset:0,stride:48},{buffer:e,size:3,offset:12,stride:48},{buffer:e,size:1,offset:24,stride:48},{buffer:e,size:1,offset:28,stride:48},{buffer:e,size:4,offset:32,stride:48}]),k=m(new Array(1024),[256,1,4]),l=0;l<1024;++l)k.data[l]=255;var n=j(b,k);n.wrap=b.REPEAT;var q=new g(b,c,d,e,f,n);return q.update(a),q};var h=a("gl-buffer"),i=a("gl-vao"),j=a("gl-texture2d"),k=a("glsl-read-float"),l=a("binary-search-bounds"),m=a("ndarray"),n=a("./lib/shaders"),o=n.createShader,p=n.createPickShader,q=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=g.prototype;r.isTransparent=function(){return this.hasAlpha},r.isOpaque=function(){return!this.hasAlpha},r.pickSlots=1,r.setPickBase=function(a){this.pickId=a},r.drawTransparent=r.draw=function(a){if(this.vertexCount){var b=this.gl,c=this.shader,d=this.vao;c.bind(),c.uniforms={model:a.model||q,view:a.view||q,projection:a.projection||q,clipBounds:e(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},d.bind(),d.draw(b.TRIANGLE_STRIP,this.vertexCount),d.unbind()}},r.drawPick=function(a){if(this.vertexCount){var b=this.gl,c=this.pickShader,d=this.vao;c.bind(),c.uniforms={model:a.model||q,view:a.view||q,projection:a.projection||q,pickId:this.pickId,clipBounds:e(this.clipBounds),screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},d.bind(),d.draw(b.TRIANGLE_STRIP,this.vertexCount),d.unbind()}},r.update=function(a){var b,c;this.dirty=!0;var e=!!a.connectGaps;"dashScale"in a&&(this.dashScale=a.dashScale),this.hasAlpha=!1,"opacity"in a&&(this.opacity=+a.opacity,this.opacity<1&&(this.hasAlpha=!0));var f=[],g=[],h=[],i=0,j=0,k=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],n=a.position||a.positions;if(n){var o=a.color||a.colors||[0,0,0,1],p=a.lineWidth||1,q=!1;a:for(b=1;b<n.length;++b){var r,s,t,u=n[b-1],v=n[b];for(g.push(i),h.push(u.slice()),c=0;c<3;++c){if(isNaN(u[c])||isNaN(v[c])||!isFinite(u[c])||!isFinite(v[c])){if(!e&&f.length>0){for(var w=0;w<24;++w)f.push(f[f.length-12]);j+=2,q=!0}continue a}k[0][c]=Math.min(k[0][c],u[c],v[c]),k[1][c]=Math.max(k[1][c],u[c],v[c])}Array.isArray(o[0])?(r=o.length>b-1?o[b-1]:o.length>0?o[o.length-1]:[0,0,0,1],s=o.length>b?o[b]:o.length>0?o[o.length-1]:[0,0,0,1]):r=s=o,3===r.length&&(r=[r[0],r[1],r[2],1]),3===s.length&&(s=[s[0],s[1],s[2],1]),!this.hasAlpha&&r[3]<1&&(this.hasAlpha=!0),t=Array.isArray(p)?p.length>b-1?p[b-1]:p.length>0?p[p.length-1]:[0,0,0,1]:p;var x=i;if(i+=d(u,v),q){for(c=0;c<2;++c)f.push(u[0],u[1],u[2],v[0],v[1],v[2],x,t,r[0],r[1],r[2],r[3]);j+=2,q=!1}f.push(u[0],u[1],u[2],v[0],v[1],v[2],x,t,r[0],r[1],r[2],r[3],u[0],u[1],u[2],v[0],v[1],v[2],x,-t,r[0],r[1],r[2],r[3],v[0],v[1],v[2],u[0],u[1],u[2],i,-t,s[0],s[1],s[2],s[3],v[0],v[1],v[2],u[0],u[1],u[2],i,t,s[0],s[1],s[2],s[3]),j+=4}}if(this.buffer.update(f),g.push(i),h.push(n[n.length-1].slice()),this.bounds=k,this.vertexCount=j,this.points=h,this.arcLength=g,"dashes"in a){var y=a.dashes.slice();for(y.unshift(0),b=1;b<y.length;++b)y[b]=y[b-1]+y[b];var z=m(new Array(1024),[256,1,4]);for(b=0;b<256;++b){for(c=0;c<4;++c)z.set(b,0,c,0);1&l.le(y,y[y.length-1]*b/255)?z.set(b,0,0,0):z.set(b,0,0,255)}this.texture.setPixels(z)}},r.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},r.pick=function(a){if(!a)return null;if(a.id!==this.pickId)return null;var b=k(a.value[0],a.value[1],a.value[2],0),c=l.le(this.arcLength,b);if(c<0)return null;if(c===this.arcLength.length-1)return new f(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),c);for(var d=this.points[c],e=this.points[Math.min(c+1,this.points.length-1)],g=(b-this.arcLength[c])/(this.arcLength[c+1]-this.arcLength[c]),h=1-g,i=[0,0,0],j=0;j<3;++j)i[j]=h*d[j]+g*e[j];var m=Math.min(g<.5?c:c+1,this.points.length-1);return new f(b,i,m,this.points[m])}},{"./lib/shaders":255,"binary-search-bounds":257,"gl-buffer":242,"gl-texture2d":323,"gl-vao":328,"glsl-read-float":401,ndarray:451}],257:[function(a,b,c){arguments[4][112][0].apply(c,arguments)},{dup:112}],258:[function(a,b,c){b.exports=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*f-e*d;return g?(g=1/g,a[0]=f*g,a[1]=-d*g,a[2]=-e*g,a[3]=c*g,a):null}},{}],259:[function(a,b,c){b.exports=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=k*g-h*j,m=-k*f+h*i,n=j*f-g*i,o=c*l+d*m+e*n;return o?(o=1/o,a[0]=l*o,a[1]=(-k*d+e*j)*o,a[2]=(h*d-e*g)*o,a[3]=m*o,a[4]=(k*c-e*i)*o,a[5]=(-h*c+e*f)*o,a[6]=n*o,a[7]=(-j*c+d*i)*o,a[8]=(g*c-d*f)*o,a):null}},{}],260:[function(a,b,c){b.exports=function(a){var b=new Float32Array(16);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b}},{}],261:[function(a,b,c){b.exports=function(){var a=new Float32Array(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],262:[function(a,b,c){b.exports=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15];return(b*g-c*f)*(l*q-m*p)-(b*h-d*f)*(k*q-m*o)+(b*i-e*f)*(k*p-l*o)+(c*h-d*g)*(j*q-m*n)-(c*i-e*g)*(j*p-l*n)+(d*i-e*h)*(j*o-k*n)}},{}],263:[function(a,b,c){b.exports=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,i=e+e,j=c*g,k=d*g,l=d*h,m=e*g,n=e*h,o=e*i,p=f*g,q=f*h,r=f*i;return a[0]=1-l-o,a[1]=k+r,a[2]=m-q,a[3]=0,a[4]=k-r,a[5]=1-j-o,a[6]=n+p,a[7]=0,a[8]=m+q,a[9]=n-p,a[10]=1-j-l,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],264:[function(a,b,c){b.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=d+d,i=e+e,j=f+f,k=d*h,l=d*i,m=d*j,n=e*i,o=e*j,p=f*j,q=g*h,r=g*i,s=g*j;return a[0]=1-(n+p),a[1]=l+s,a[2]=m-r,a[3]=0,a[4]=l-s,a[5]=1-(k+p),a[6]=o+q,a[7]=0,a[8]=m+r,a[9]=o-q,a[10]=1-(k+n),a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a}},{}],265:[function(a,b,c){b.exports=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],266:[function(a,b,c){b.exports=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(h*D-i*C+j*B)*E,a[1]=(e*C-d*D-f*B)*E,a[2]=(p*x-q*w+r*v)*E,a[3]=(m*w-l*x-n*v)*E,a[4]=(i*A-g*D-j*z)*E,a[5]=(c*D-e*A+f*z)*E,a[6]=(q*u-o*x-r*t)*E,a[7]=(k*x-m*u+n*t)*E,a[8]=(g*C-h*A+j*y)*E,a[9]=(d*A-c*C-f*y)*E,a[10]=(o*w-p*u+r*s)*E,a[11]=(l*u-k*w-n*s)*E,a[12]=(h*z-g*B-i*y)*E,a[13]=(c*B-d*z+e*y)*E,a[14]=(p*t-o*v-q*s)*E,a[15]=(k*v-l*t+m*s)*E,a):null}},{}],267:[function(a,b,c){var d=a("./identity");b.exports=function(a,b,c,e){var f,g,h,i,j,k,l,m,n,o,p=b[0],q=b[1],r=b[2],s=e[0],t=e[1],u=e[2],v=c[0],w=c[1],x=c[2];return Math.abs(p-v)<1e-6&&Math.abs(q-w)<1e-6&&Math.abs(r-x)<1e-6?d(a):(l=p-v,m=q-w,n=r-x,o=1/Math.sqrt(l*l+m*m+n*n),f=t*(n*=o)-u*(m*=o),g=u*(l*=o)-s*n,h=s*m-t*l,(o=Math.sqrt(f*f+g*g+h*h))?(f*=o=1/o,g*=o,
h*=o):(f=0,g=0,h=0),i=m*h-n*g,j=n*f-l*h,k=l*g-m*f,(o=Math.sqrt(i*i+j*j+k*k))?(i*=o=1/o,j*=o,k*=o):(i=0,j=0,k=0),a[0]=f,a[1]=i,a[2]=l,a[3]=0,a[4]=g,a[5]=j,a[6]=m,a[7]=0,a[8]=h,a[9]=k,a[10]=n,a[11]=0,a[12]=-(f*p+g*q+h*r),a[13]=-(i*p+j*q+k*r),a[14]=-(l*p+m*q+n*r),a[15]=1,a)}},{"./identity":265}],268:[function(a,b,c){b.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a}},{}],269:[function(a,b,c){b.exports=function(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a}},{}],270:[function(a,b,c){b.exports=function(a,b,c,d,e){var f=1/Math.tan(b/2),g=1/(d-e);return a[0]=f/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*g,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*g,a[15]=0,a}},{}],271:[function(a,b,c){b.exports=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=d[0],D=d[1],E=d[2],F=Math.sqrt(C*C+D*D+E*E);return Math.abs(F)<1e-6?null:(C*=F=1/F,D*=F,E*=F,e=Math.sin(c),f=Math.cos(c),g=1-f,h=b[0],i=b[1],j=b[2],k=b[3],l=b[4],m=b[5],n=b[6],o=b[7],p=b[8],q=b[9],r=b[10],s=b[11],t=C*C*g+f,u=D*C*g+E*e,v=E*C*g-D*e,w=C*D*g-E*e,x=D*D*g+f,y=E*D*g+C*e,z=C*E*g+D*e,A=D*E*g-C*e,B=E*E*g+f,a[0]=h*t+l*u+p*v,a[1]=i*t+m*u+q*v,a[2]=j*t+n*u+r*v,a[3]=k*t+o*u+s*v,a[4]=h*w+l*x+p*y,a[5]=i*w+m*x+q*y,a[6]=j*w+n*x+r*y,a[7]=k*w+o*x+s*y,a[8]=h*z+l*A+p*B,a[9]=i*z+m*A+q*B,a[10]=j*z+n*A+r*B,a[11]=k*z+o*A+s*B,b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a)}},{}],272:[function(a,b,c){b.exports=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[4],g=b[5],h=b[6],i=b[7],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=f*e+j*d,a[5]=g*e+k*d,a[6]=h*e+l*d,a[7]=i*e+m*d,a[8]=j*e-f*d,a[9]=k*e-g*d,a[10]=l*e-h*d,a[11]=m*e-i*d,a}},{}],273:[function(a,b,c){b.exports=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e-j*d,a[1]=g*e-k*d,a[2]=h*e-l*d,a[3]=i*e-m*d,a[8]=f*d+j*e,a[9]=g*d+k*e,a[10]=h*d+l*e,a[11]=i*d+m*e,a}},{}],274:[function(a,b,c){b.exports=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e+j*d,a[1]=g*e+k*d,a[2]=h*e+l*d,a[3]=i*e+m*d,a[4]=j*e-f*d,a[5]=k*e-g*d,a[6]=l*e-h*d,a[7]=m*e-i*d,a}},{}],275:[function(a,b,c){b.exports=function(a,b,c){var d=c[0],e=c[1],f=c[2];return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d,a[4]=b[4]*e,a[5]=b[5]*e,a[6]=b[6]*e,a[7]=b[7]*e,a[8]=b[8]*f,a[9]=b[9]*f,a[10]=b[10]*f,a[11]=b[11]*f,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a}},{}],276:[function(a,b,c){b.exports=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=c[0],q=c[1],r=c[2];return b===a?(a[12]=b[0]*p+b[4]*q+b[8]*r+b[12],a[13]=b[1]*p+b[5]*q+b[9]*r+b[13],a[14]=b[2]*p+b[6]*q+b[10]*r+b[14],a[15]=b[3]*p+b[7]*q+b[11]*r+b[15]):(d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=j,a[7]=k,a[8]=l,a[9]=m,a[10]=n,a[11]=o,a[12]=d*p+h*q+l*r+b[12],a[13]=e*p+i*q+m*r+b[13],a[14]=f*p+j*q+n*r+b[14],a[15]=g*p+k*q+o*r+b[15]),a}},{}],277:[function(a,b,c){b.exports=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=c,a[6]=b[9],a[7]=b[13],a[8]=d,a[9]=f,a[11]=b[14],a[12]=e,a[13]=g,a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}},{}],278:[function(a,b,c){"use strict";b.exports=function(a,b){switch(b.length){case 0:break;case 1:a[0]=1/b[0];break;case 4:d(a,b);break;case 9:e(a,b);break;case 16:f(a,b);break;default:throw new Error("currently supports matrices up to 4x4")}return a};var d=a("gl-mat2/invert"),e=a("gl-mat3/invert"),f=a("gl-mat4/invert")},{"gl-mat2/invert":258,"gl-mat3/invert":259,"gl-mat4/invert":266}],279:[function(a,b,c){"use strict";function d(a,b){for(var c=[0,0,0,0],d=0;d<4;++d)for(var e=0;e<4;++e)c[e]+=a[4*d+e]*b[d];return c}function e(a,b,c,e,f){for(var g=d(e,d(c,d(b,[a[0],a[1],a[2],1]))),h=0;h<3;++h)g[h]/=g[3];return[.5*f[0]*(1+g[0]),.5*f[1]*(1-g[1])]}var f=a("barycentric"),g=a("polytope-closest-point/lib/closest_point_2d.js");b.exports=function(a,b,c,d,h,i){if(1===a.length)return[0,a[0].slice()];for(var j=new Array(a.length),k=0;k<a.length;++k)j[k]=e(a[k],c,d,h,i);for(var l=0,m=1/0,k=0;k<j.length;++k){for(var n=0,o=0;o<2;++o)n+=Math.pow(j[k][o]-b[o],2);n<m&&(m=n,l=k)}for(var p=function(a,b){if(2===a.length){for(var c=0,d=0,e=0;e<2;++e)c+=Math.pow(b[e]-a[0][e],2),d+=Math.pow(b[e]-a[1][e],2);return c=Math.sqrt(c),d=Math.sqrt(d),c+d<1e-6?[1,0]:[d/(c+d),c/(d+c)]}if(3===a.length){var h=[0,0];return g(a[0],a[1],a[2],b,h),f(a,h)}return[]}(j,b),q=0,k=0;k<3;++k){if(p[k]<-.001||p[k]>1.0001)return null;q+=p[k]}return Math.abs(q-1)>.001?null:[l,function(a,b){for(var c=[0,0,0],d=0;d<a.length;++d)for(var e=a[d],f=b[d],g=0;g<3;++g)c[g]+=f*e[g];return c}(a,p),p]}},{barycentric:74,"polytope-closest-point/lib/closest_point_2d.js":482}],280:[function(a,b,c){var d=a("glslify"),e=d(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  gl_Position      = project(position);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * vec4(position , 1.0);\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  f_color          = color;\n  f_data           = position;\n  f_uv             = uv;\n}\n"]),f=d(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (f_color.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], f_data)\n  ) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d\n\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * f_color.a;\n}\n"]),g=d(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]),h=d(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),i=d(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]),j=d(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),k=d(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]),l=d(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]),m=d(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]),n=d(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]),o=d(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor, 1.0);\n}\n"]);c.meshShader={vertex:e,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},c.wireShader={vertex:g,fragment:h,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},c.pointShader={vertex:i,fragment:j,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},c.pickShader={vertex:k,fragment:l,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},c.pointPickShader={vertex:m,fragment:l,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},c.contourShader={vertex:n,fragment:o,attributes:[{name:"position",type:"vec3"}]}},{glslify:410}],281:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){this.gl=a,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=b,this.dirty=!0,this.triShader=c,this.lineShader=d,this.pointShader=e,this.pickShader=f,this.pointPickShader=g,this.contourShader=h,this.trianglePositions=i,this.triangleColors=k,this.triangleNormals=m,this.triangleUVs=l,this.triangleIds=j,this.triangleVAO=n,this.triangleCount=0,this.lineWidth=1,this.edgePositions=o,this.edgeColors=q,this.edgeUVs=r,this.edgeIds=p,this.edgeVAO=s,this.edgeCount=0,this.pointPositions=t,this.pointColors=v,this.pointUVs=w,this.pointSizes=x,this.pointIds=u,this.pointVAO=y,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=z,this.contourVAO=A,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=C,this._view=C,this._projection=C,this._resolution=[1,1]}function e(a,b){if(!b)return 1;if(!b.length)return 1;for(var c=0;c<b.length;++c){if(b.length<2)return 1;if(b[c][0]===a)return b[c][1];if(b[c][0]>a&&c>0){var d=(b[c][0]-a)/(b[c][0]-b[c-1][0]);return b[c][1]*(1-d)+d*b[c-1][1]}}return 1}function f(a){var b=j(a,y.vertex,y.fragment);return b.attributes.position.location=0,b.attributes.color.location=2,b.attributes.uv.location=3,b.attributes.pointSize.location=4,b}function g(a){var b=j(a,z.vertex,z.fragment);return b.attributes.position.location=0,b.attributes.id.location=1,b}function h(a){var b=j(a,A.vertex,A.fragment);return b.attributes.position.location=0,b.attributes.id.location=1,b.attributes.pointSize.location=4,b}function i(a){var b=j(a,B.vertex,B.fragment);return b.attributes.position.location=0,b}var j=a("gl-shader"),k=a("gl-buffer"),l=a("gl-vao"),m=a("gl-texture2d"),n=a("normals"),o=a("gl-mat4/multiply"),p=a("gl-mat4/invert"),q=a("ndarray"),r=a("colormap"),s=a("simplicial-complex-contour"),t=a("typedarray-pool"),u=a("./lib/shaders"),v=a("./lib/closest-point"),w=u.meshShader,x=u.wireShader,y=u.pointShader,z=u.pickShader,A=u.pointPickShader,B=u.contourShader,C=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],D=d.prototype;D.isOpaque=function(){return!this.hasAlpha},D.isTransparent=function(){return this.hasAlpha},D.pickSlots=1,D.setPickBase=function(a){this.pickId=a},D.highlight=function(a){if(a&&this.contourEnable){for(var b=s(this.cells,this.intensity,a.intensity),c=b.cells,d=b.vertexIds,e=b.vertexWeights,f=c.length,g=t.mallocFloat32(6*f),h=0,i=0;i<f;++i)for(var j=c[i],k=0;k<2;++k){var l=j[0];2===j.length&&(l=j[k]);for(var m=d[l][0],n=d[l][1],o=e[l],p=1-o,q=this.positions[m],r=this.positions[n],u=0;u<3;++u)g[h++]=o*q[u]+p*r[u]}this.contourCount=h/3|0,this.contourPositions.update(g.subarray(0,h)),t.free(g)}else this.contourCount=0},D.update=function(a){a=a||{};var b=this.gl;this.dirty=!0,"contourEnable"in a&&(this.contourEnable=a.contourEnable),"contourColor"in a&&(this.contourColor=a.contourColor),"lineWidth"in a&&(this.lineWidth=a.lineWidth),"lightPosition"in a&&(this.lightPosition=a.lightPosition),this.hasAlpha=!1,"opacity"in a&&(this.opacity=a.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in a&&(this.opacityscale=a.opacityscale,this.hasAlpha=!0),"ambient"in a&&(this.ambientLight=a.ambient),"diffuse"in a&&(this.diffuseLight=a.diffuse),"specular"in a&&(this.specularLight=a.specular),"roughness"in a&&(this.roughness=a.roughness),"fresnel"in a&&(this.fresnel=a.fresnel),a.texture?(this.texture.dispose(),this.texture=m(b,a.texture)):a.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=b.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=b.LINEAR,this.texture.setPixels(function(a,b){for(var c=r({colormap:a,nshades:256,format:"rgba"}),d=new Uint8Array(1024),f=0;f<256;++f){for(var g=c[f],h=0;h<3;++h)d[4*f+h]=g[h];d[4*f+3]=b?255*e(f/255,b):255*g[3]}return q(d,[256,256,4],[4,0,1])}(a.colormap,this.opacityscale)),this.texture.generateMipmap());var c=a.cells,d=a.positions;if(d&&c){var f=[],g=[],h=[],i=[],j=[],k=[],l=[],o=[],p=[],s=[],t=[],u=[],v=[],w=[];this.cells=c,this.positions=d;var x=a.vertexNormals,y=a.cellNormals,z=void 0===a.vertexNormalsEpsilon?1e-6:a.vertexNormalsEpsilon,A=void 0===a.faceNormalsEpsilon?1e-6:a.faceNormalsEpsilon;a.useFacetNormals&&!y&&(y=n.faceNormals(c,d,A)),y||x||(x=n.vertexNormals(c,d,z));var B=a.vertexColors,C=a.cellColors,D=a.meshColor||[1,1,1,1],E=a.vertexUVs,F=a.vertexIntensity,G=a.cellUVs,H=a.cellIntensity,I=1/0,J=-1/0;if(!E&&!G)if(F)if(a.vertexIntensityBounds)I=+a.vertexIntensityBounds[0],J=+a.vertexIntensityBounds[1];else for(var K=0;K<F.length;++K){var L=F[K];I=Math.min(I,L),J=Math.max(J,L)}else if(H)for(K=0;K<H.length;++K)L=H[K],I=Math.min(I,L),J=Math.max(J,L);else for(K=0;K<d.length;++K)L=d[K][2],I=Math.min(I,L),J=Math.max(J,L);this.intensity=F||(H?function(a,b,c){for(var d=new Array(b),e=0;e<b;++e)d[e]=0;var f=a.length;for(e=0;e<f;++e)for(var g=a[e],h=0;h<g.length;++h)d[g[h]]=c[e];return d}(c,d.length,H):function(a){for(var b=a.length,c=new Array(b),d=0;d<b;++d)c[d]=a[d][2];return c}(d));var M=a.pointSizes,N=a.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],K=0;K<d.length;++K)for(var O=d[K],P=0;P<3;++P)!isNaN(O[P])&&isFinite(O[P])&&(this.bounds[0][P]=Math.min(this.bounds[0][P],O[P]),this.bounds[1][P]=Math.max(this.bounds[1][P],O[P]));var Q=0,R=0,S=0;a:for(K=0;K<c.length;++K){var T=c[K];switch(T.length){case 1:for(O=d[V=T[0]],P=0;P<3;++P)if(isNaN(O[P])||!isFinite(O[P]))continue a;s.push(O[0],O[1],O[2]),W=B?B[V]:C?C[K]:D,this.opacityscale&&F?g.push(W[0],W[1],W[2],this.opacity*e((F[V]-I)/(J-I),this.opacityscale)):3===W.length?t.push(W[0],W[1],W[2],this.opacity):(t.push(W[0],W[1],W[2],W[3]*this.opacity),!this.hasAlpha&&W[3]<1&&(this.hasAlpha=!0)),X=E?E[V]:F?[(F[V]-I)/(J-I),0]:G?G[K]:H?[(H[K]-I)/(J-I),0]:[(O[2]-I)/(J-I),0],u.push(X[0],X[1]),M?v.push(M[V]):v.push(N),w.push(K),S+=1;break;case 2:for(P=0;P<2;++P){O=d[V=T[P]];for(var U=0;U<3;++U)if(isNaN(O[U])||!isFinite(O[U]))continue a}for(P=0;P<2;++P)O=d[V=T[P]],k.push(O[0],O[1],O[2]),W=B?B[V]:C?C[K]:D,this.opacityscale&&F?g.push(W[0],W[1],W[2],this.opacity*e((F[V]-I)/(J-I),this.opacityscale)):3===W.length?l.push(W[0],W[1],W[2],this.opacity):(l.push(W[0],W[1],W[2],W[3]*this.opacity),!this.hasAlpha&&W[3]<1&&(this.hasAlpha=!0)),X=E?E[V]:F?[(F[V]-I)/(J-I),0]:G?G[K]:H?[(H[K]-I)/(J-I),0]:[(O[2]-I)/(J-I),0],o.push(X[0],X[1]),p.push(K);R+=1;break;case 3:for(P=0;P<3;++P)for(O=d[V=T[P]],U=0;U<3;++U)if(isNaN(O[U])||!isFinite(O[U]))continue a;for(P=0;P<3;++P){var V,W,X,Y;O=d[V=T[2-P]],f.push(O[0],O[1],O[2]),W=B?B[V]:C?C[K]:D,this.opacityscale&&F?g.push(W[0],W[1],W[2],this.opacity*e((F[V]-I)/(J-I),this.opacityscale)):3===W.length?g.push(W[0],W[1],W[2],this.opacity):(g.push(W[0],W[1],W[2],W[3]*this.opacity),!this.hasAlpha&&W[3]<1&&(this.hasAlpha=!0)),X=E?E[V]:F?[(F[V]-I)/(J-I),0]:G?G[K]:H?[(H[K]-I)/(J-I),0]:[(O[2]-I)/(J-I),0],i.push(X[0],X[1]),Y=x?x[V]:y[K],h.push(Y[0],Y[1],Y[2]),j.push(K)}Q+=1}}this.pointCount=S,this.edgeCount=R,this.triangleCount=Q,this.pointPositions.update(s),this.pointColors.update(t),this.pointUVs.update(u),this.pointSizes.update(v),this.pointIds.update(new Uint32Array(w)),this.edgePositions.update(k),this.edgeColors.update(l),this.edgeUVs.update(o),this.edgeIds.update(new Uint32Array(p)),this.trianglePositions.update(f),this.triangleColors.update(g),this.triangleUVs.update(i),this.triangleNormals.update(h),this.triangleIds.update(new Uint32Array(j))}},D.drawTransparent=D.draw=function(a){a=a||{};for(var b=this.gl,c=a.model||C,d=a.view||C,e=a.projection||C,f=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],g=0;g<3;++g)f[0][g]=Math.max(f[0][g],this.clipBounds[0][g]),f[1][g]=Math.min(f[1][g],this.clipBounds[1][g]);var h={model:c,view:d,projection:e,inverseModel:C.slice(),clipBounds:f,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};h.inverseModel=p(h.inverseModel,h.model),b.disable(b.CULL_FACE),this.texture.bind(0);var i=new Array(16);for(o(i,h.view,h.model),o(i,h.projection,i),p(i,i),g=0;g<3;++g)h.eyePosition[g]=i[12+g]/i[15];var j,k=i[15];for(g=0;g<3;++g)k+=this.lightPosition[g]*i[4*g+3];for(g=0;g<3;++g){for(var l=i[12+g],m=0;m<3;++m)l+=i[4*m+g]*this.lightPosition[m];h.lightPosition[g]=l/k}this.triangleCount>0&&((j=this.triShader).bind(),j.uniforms=h,this.triangleVAO.bind(),b.drawArrays(b.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((j=this.lineShader).bind(),j.uniforms=h,this.edgeVAO.bind(),b.lineWidth(this.lineWidth*this.pixelRatio),b.drawArrays(b.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((j=this.pointShader).bind(),j.uniforms=h,this.pointVAO.bind(),b.drawArrays(b.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((j=this.contourShader).bind(),j.uniforms=h,this.contourVAO.bind(),b.drawArrays(b.LINES,0,this.contourCount),this.contourVAO.unbind())},D.drawPick=function(a){a=a||{};for(var b=this.gl,c=a.model||C,d=a.view||C,e=a.projection||C,f=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],g=0;g<3;++g)f[0][g]=Math.max(f[0][g],this.clipBounds[0][g]),f[1][g]=Math.min(f[1][g],this.clipBounds[1][g]);this._model=[].slice.call(c),this._view=[].slice.call(d),this._projection=[].slice.call(e),this._resolution=[b.drawingBufferWidth,b.drawingBufferHeight];var h,i={model:c,view:d,projection:e,clipBounds:f,pickId:this.pickId/255};(h=this.pickShader).bind(),h.uniforms=i,this.triangleCount>0&&(this.triangleVAO.bind(),b.drawArrays(b.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),b.lineWidth(this.lineWidth*this.pixelRatio),b.drawArrays(b.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((h=this.pointPickShader).bind(),h.uniforms=i,this.pointVAO.bind(),b.drawArrays(b.POINTS,0,this.pointCount),this.pointVAO.unbind())},D.pick=function(a){if(!a)return null;if(a.id!==this.pickId)return null;for(var b=a.value[0]+256*a.value[1]+65536*a.value[2],c=this.cells[b],d=this.positions,e=new Array(c.length),f=0;f<c.length;++f)e[f]=d[c[f]];var g=v(e,[a.coord[0],this._resolution[1]-a.coord[1]],this._model,this._view,this._projection,this._resolution);if(!g)return null;var h=g[2],i=0;for(f=0;f<c.length;++f)i+=h[f]*this.intensity[c[f]];return{position:g[1],index:c[g[0]],cell:c,cellId:b,intensity:i,dataCoordinate:this.positions[c[g[0]]]}},D.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},b.exports=function(a,b){if(1===arguments.length&&(a=(b=a).gl),!(a.getExtension("OES_standard_derivatives")||a.getExtension("MOZ_OES_standard_derivatives")||a.getExtension("WEBKIT_OES_standard_derivatives")))throw new Error("derivatives not supported");var c=function(a){var b=j(a,w.vertex,w.fragment);return b.attributes.position.location=0,b.attributes.color.location=2,b.attributes.uv.location=3,b.attributes.normal.location=4,b}(a),e=function(a){var b=j(a,x.vertex,x.fragment);return b.attributes.position.location=0,b.attributes.color.location=2,b.attributes.uv.location=3,b}(a),n=f(a),o=g(a),p=h(a),r=i(a),s=m(a,q(new Uint8Array([255,255,255,255]),[1,1,4]));s.generateMipmap(),s.minFilter=a.LINEAR_MIPMAP_LINEAR,s.magFilter=a.LINEAR;var t=k(a),u=k(a),v=k(a),y=k(a),z=k(a),A=l(a,[{buffer:t,type:a.FLOAT,size:3},{buffer:z,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:u,type:a.FLOAT,size:4},{buffer:v,type:a.FLOAT,size:2},{buffer:y,type:a.FLOAT,size:3}]),B=k(a),C=k(a),D=k(a),E=k(a),F=l(a,[{buffer:B,type:a.FLOAT,size:3},{buffer:E,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:C,type:a.FLOAT,size:4},{buffer:D,type:a.FLOAT,size:2}]),G=k(a),H=k(a),I=k(a),J=k(a),K=k(a),L=l(a,[{buffer:G,type:a.FLOAT,size:3},{buffer:K,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:H,type:a.FLOAT,size:4},{buffer:I,type:a.FLOAT,size:2},{buffer:J,type:a.FLOAT,size:1}]),M=k(a),N=new d(a,s,c,e,n,o,p,r,t,z,u,v,y,A,B,E,C,D,F,G,K,H,I,J,L,M,l(a,[{buffer:M,type:a.FLOAT,size:3}]));return N.update(b),N}},{"./lib/closest-point":279,"./lib/shaders":280,colormap:127,"gl-buffer":242,"gl-mat4/invert":266,"gl-mat4/multiply":268,"gl-shader":302,"gl-texture2d":323,"gl-vao":328,ndarray:451,normals:454,"simplicial-complex-contour":519,"typedarray-pool":546}],282:[function(a,b,c){"use strict";function d(a,b,c){this.plot=a,this.vbo=b,this.shader=c}b.exports=function(a){var b=a.gl;return new d(a,g(b,[0,0,0,1,1,0,1,1]),h(b,i.boxVert,i.lineFrag))};var e,f,g=a("gl-buffer"),h=a("gl-shader"),i=a("./shaders"),j=d.prototype;j.bind=function(){var a=this.shader;this.vbo.bind(),this.shader.bind(),a.attributes.coord.pointer(),a.uniforms.screenBox=this.plot.screenBox},j.drawBox=(e=[0,0],f=[0,0],function(a,b,c,d,g){var h=this.plot,i=this.shader,j=h.gl;e[0]=a,e[1]=b,f[0]=c,f[1]=d,i.uniforms.lo=e,i.uniforms.hi=f,i.uniforms.color=g,j.drawArrays(j.TRIANGLE_STRIP,0,4)}),j.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":285,"gl-buffer":242,"gl-shader":302}],283:[function(a,b,c){"use strict";function d(a,b,c,d){this.plot=a,this.vbo=b,this.shader=c,this.tickShader=d,this.ticks=[[],[]]}function e(a,b){return a-b}b.exports=function(a){var b=a.gl;return new d(a,k(b),l(b,n.gridVert,n.gridFrag),l(b,n.tickVert,n.gridFrag))};var f,g,h,i,j,k=a("gl-buffer"),l=a("gl-shader"),m=a("binary-search-bounds"),n=a("./shaders"),o=d.prototype;o.draw=(f=[0,0],g=[0,0],h=[0,0],function(){for(var a=this.plot,b=this.vbo,c=this.shader,d=this.ticks,e=a.gl,i=a._tickBounds,j=a.dataBox,k=a.viewBox,l=a.gridLineWidth,m=a.gridLineColor,n=a.gridLineEnable,o=a.pixelRatio,p=0;p<2;++p){var q=i[p],r=i[p+2]-q,s=.5*(j[p+2]+j[p]),t=j[p+2]-j[p];g[p]=2*r/t,f[p]=2*(q-s)/t}c.bind(),b.bind(),c.attributes.dataCoord.pointer(),c.uniforms.dataShift=f,c.uniforms.dataScale=g;var u=0;for(p=0;p<2;++p){h[0]=h[1]=0,h[p]=1,c.uniforms.dataAxis=h,c.uniforms.lineWidth=l[p]/(k[p+2]-k[p])*o,c.uniforms.color=m[p];var v=6*d[p].length;n[p]&&v&&e.drawArrays(e.TRIANGLES,u,v),u+=v}}),o.drawTickMarks=function(){var a=[0,0],b=[0,0],c=[1,0],d=[0,1],f=[0,0],g=[0,0];return function(){for(var h=this.plot,i=this.vbo,j=this.tickShader,k=this.ticks,l=h.gl,n=h._tickBounds,o=h.dataBox,p=h.viewBox,q=h.pixelRatio,r=h.screenBox,s=r[2]-r[0],t=r[3]-r[1],u=p[2]-p[0],v=p[3]-p[1],w=0;w<2;++w){var x=n[w],y=n[w+2]-x,z=.5*(o[w+2]+o[w]),A=o[w+2]-o[w];b[w]=2*y/A,a[w]=2*(x-z)/A}b[0]*=u/s,a[0]*=u/s,b[1]*=v/t,a[1]*=v/t,j.bind(),i.bind(),j.attributes.dataCoord.pointer();var B=j.uniforms;B.dataShift=a,B.dataScale=b;var C=h.tickMarkLength,D=h.tickMarkWidth,E=h.tickMarkColor,F=6*k[0].length,G=Math.min(m.ge(k[0],(o[0]-n[0])/(n[2]-n[0]),e),k[0].length),H=Math.min(m.gt(k[0],(o[2]-n[0])/(n[2]-n[0]),e),k[0].length),I=0+6*G,J=6*Math.max(0,H-G),K=Math.min(m.ge(k[1],(o[1]-n[1])/(n[3]-n[1]),e),k[1].length),L=Math.min(m.gt(k[1],(o[3]-n[1])/(n[3]-n[1]),e),k[1].length),M=F+6*K,N=6*Math.max(0,L-K);f[0]=2*(p[0]-C[1])/s-1,f[1]=(p[3]+p[1])/t-1,g[0]=C[1]*q/s,g[1]=D[1]*q/t,N&&(B.color=E[1],B.tickScale=g,B.dataAxis=d,B.screenOffset=f,l.drawArrays(l.TRIANGLES,M,N)),f[0]=(p[2]+p[0])/s-1,f[1]=2*(p[1]-C[0])/t-1,g[0]=D[0]*q/s,g[1]=C[0]*q/t,J&&(B.color=E[0],B.tickScale=g,B.dataAxis=c,B.screenOffset=f,l.drawArrays(l.TRIANGLES,I,J)),f[0]=2*(p[2]+C[3])/s-1,f[1]=(p[3]+p[1])/t-1,g[0]=C[3]*q/s,g[1]=D[3]*q/t,N&&(B.color=E[3],
B.tickScale=g,B.dataAxis=d,B.screenOffset=f,l.drawArrays(l.TRIANGLES,M,N)),f[0]=(p[2]+p[0])/s-1,f[1]=2*(p[3]+C[2])/t-1,g[0]=D[2]*q/s,g[1]=C[2]*q/t,J&&(B.color=E[2],B.tickScale=g,B.dataAxis=c,B.screenOffset=f,l.drawArrays(l.TRIANGLES,I,J))}}(),o.update=(i=[1,1,-1,-1,1,-1],j=[1,-1,1,1,-1,-1],function(a){for(var b=a.ticks,c=a.bounds,d=new Float32Array(18*(b[0].length+b[1].length)),e=(this.plot.zeroLineEnable,0),f=[[],[]],g=0;g<2;++g)for(var h=f[g],k=b[g],l=c[g],m=c[g+2],n=0;n<k.length;++n){var o=(k[n].x-l)/(m-l);h.push(o);for(var p=0;p<6;++p)d[e++]=o,d[e++]=i[p],d[e++]=j[p]}this.ticks=f,this.vbo.update(d)}),o.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":285,"binary-search-bounds":287,"gl-buffer":242,"gl-shader":302}],284:[function(a,b,c){"use strict";function d(a,b,c){this.plot=a,this.vbo=b,this.shader=c}b.exports=function(a){var b=a.gl;return new d(a,g(b,[-1,-1,-1,1,1,-1,1,1]),h(b,i.lineVert,i.lineFrag))};var e,f,g=a("gl-buffer"),h=a("gl-shader"),i=a("./shaders"),j=d.prototype;j.bind=function(){var a=this.shader;this.vbo.bind(),this.shader.bind(),a.attributes.coord.pointer(),a.uniforms.screenBox=this.plot.screenBox},j.drawLine=(e=[0,0],f=[0,0],function(a,b,c,d,g,h){var i=this.plot,j=this.shader,k=i.gl;e[0]=a,e[1]=b,f[0]=c,f[1]=d,j.uniforms.start=e,j.uniforms.end=f,j.uniforms.width=g*i.pixelRatio,j.uniforms.color=h,k.drawArrays(k.TRIANGLE_STRIP,0,4)}),j.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":285,"gl-buffer":242,"gl-shader":302}],285:[function(a,b,c){"use strict";var d=a("glslify"),e=d(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);b.exports={lineVert:d(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:e,textVert:d(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:e,gridVert:d(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:e,boxVert:d(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:d(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:410}],286:[function(a,b,c){"use strict";function d(a,b,c){this.plot=a,this.vbo=b,this.shader=c,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}b.exports=function(a){var b=a.gl;return new d(a,k(b),l(b,o.textVert,o.textFrag))};var e,f,g,h,i,j,k=a("gl-buffer"),l=a("gl-shader"),m=a("text-cache"),n=a("binary-search-bounds"),o=a("./shaders"),p=d.prototype;p.drawTicks=(e=[0,0],f=[0,0],g=[0,0],function(a){var b=this.plot,c=this.shader,d=this.tickX[a],h=this.tickOffset[a],i=b.gl,j=b.viewBox,k=b.dataBox,l=b.screenBox,m=b.pixelRatio,o=b.tickEnable,p=b.tickPad,q=b.tickColor,r=b.tickAngle,s=b.labelEnable,t=b.labelPad,u=b.labelColor,v=b.labelAngle,w=this.labelOffset[a],x=this.labelCount[a],y=n.lt(d,k[a]),z=n.le(d,k[a+2]);e[0]=e[1]=0,e[a]=1,f[a]=(j[2+a]+j[a])/(l[2+a]-l[a])-1;var A=2/l[2+(1^a)]-l[1^a];f[1^a]=A*j[1^a]-1,o[a]&&(f[1^a]-=A*m*p[a],y<z&&h[z]>h[y]&&(c.uniforms.dataAxis=e,c.uniforms.screenOffset=f,c.uniforms.color=q[a],c.uniforms.angle=r[a],i.drawArrays(i.TRIANGLES,h[y],h[z]-h[y]))),s[a]&&x&&(f[1^a]-=A*m*t[a],c.uniforms.dataAxis=g,c.uniforms.screenOffset=f,c.uniforms.color=u[a],c.uniforms.angle=v[a],i.drawArrays(i.TRIANGLES,w,x)),f[1^a]=A*j[2+(1^a)]-1,o[a+2]&&(f[1^a]+=A*m*p[a+2],y<z&&h[z]>h[y]&&(c.uniforms.dataAxis=e,c.uniforms.screenOffset=f,c.uniforms.color=q[a+2],c.uniforms.angle=r[a+2],i.drawArrays(i.TRIANGLES,h[y],h[z]-h[y]))),s[a+2]&&x&&(f[1^a]+=A*m*t[a+2],c.uniforms.dataAxis=g,c.uniforms.screenOffset=f,c.uniforms.color=u[a+2],c.uniforms.angle=v[a+2],i.drawArrays(i.TRIANGLES,w,x))}),p.drawTitle=function(){var a=[0,0],b=[0,0];return function(){var c=this.plot,d=this.shader,e=c.gl,f=c.screenBox,g=c.titleCenter,h=c.titleAngle,i=c.titleColor,j=c.pixelRatio;if(this.titleCount){for(var k=0;k<2;++k)b[k]=2*(g[k]*j-f[k])/(f[2+k]-f[k])-1;d.bind(),d.uniforms.dataAxis=a,d.uniforms.screenOffset=b,d.uniforms.angle=h,d.uniforms.color=i,e.drawArrays(e.TRIANGLES,this.titleOffset,this.titleCount)}}}(),p.bind=(h=[0,0],i=[0,0],j=[0,0],function(){var a=this.plot,b=this.shader,c=a._tickBounds,d=a.dataBox,e=a.screenBox,f=a.viewBox;b.bind();for(var g=0;g<2;++g){var k=c[g],l=c[g+2]-k,m=.5*(d[g+2]+d[g]),n=d[g+2]-d[g],o=f[g],p=f[g+2]-o,q=e[g],r=e[g+2]-q;i[g]=2*l/n*p/r,h[g]=2*(k-m)/n*p/r}j[1]=2*a.pixelRatio/(e[3]-e[1]),j[0]=j[1]*(e[3]-e[1])/(e[2]-e[0]),b.uniforms.dataScale=i,b.uniforms.dataShift=h,b.uniforms.textScale=j,this.vbo.bind(),b.attributes.textCoordinate.pointer()}),p.update=function(a){var b,c,d,e,f,g=[],h=a.ticks,i=a.bounds;for(f=0;f<2;++f){var j=[Math.floor(g.length/3)],k=[-1/0],l=h[f];for(b=0;b<l.length;++b){var n=l[b],o=n.x,p=n.text,q=n.font||"sans-serif";e=n.fontSize||12;for(var r=1/(i[f+2]-i[f]),s=i[f],t=p.split("\n"),u=0;u<t.length;u++)for(d=m(q,t[u]).data,c=0;c<d.length;c+=2)g.push(d[c]*e,-d[c+1]*e-u*e*1.2,(o-s)*r);j.push(Math.floor(g.length/3)),k.push(o)}this.tickOffset[f]=j,this.tickX[f]=k}for(f=0;f<2;++f){for(this.labelOffset[f]=Math.floor(g.length/3),d=m(a.labelFont[f],a.labels[f],{textAlign:"center"}).data,e=a.labelSize[f],b=0;b<d.length;b+=2)g.push(d[b]*e,-d[b+1]*e,0);this.labelCount[f]=Math.floor(g.length/3)-this.labelOffset[f]}for(this.titleOffset=Math.floor(g.length/3),d=m(a.titleFont,a.title).data,e=a.titleSize,b=0;b<d.length;b+=2)g.push(d[b]*e,-d[b+1]*e,0);this.titleCount=Math.floor(g.length/3)-this.titleOffset,this.vbo.update(g)},p.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":285,"binary-search-bounds":287,"gl-buffer":242,"gl-shader":302,"text-cache":537}],287:[function(a,b,c){arguments[4][112][0].apply(c,arguments)},{dup:112}],288:[function(a,b,c){"use strict";function d(a,b){this.gl=a,this.pickBuffer=b,this.screenBox=[0,0,a.drawingBufferWidth,a.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}function e(a){for(var b=a.slice(),c=0;c<b.length;++c)b[c]=b[c].slice();return b}function f(a,b){return a.x-b.x}b.exports=function(a){var b=a.gl,c=g(b,[b.drawingBufferWidth,b.drawingBufferHeight]),e=new d(b,c);return e.grid=h(e),e.text=i(e),e.line=j(e),e.box=k(e),e.update(a),e};var g=a("gl-select-static"),h=a("./lib/grid"),i=a("./lib/text"),j=a("./lib/line"),k=a("./lib/box"),l=d.prototype;l.setDirty=function(){this.dirty=this.pickDirty=!0},l.setOverlayDirty=function(){this.dirty=!0},l.nextDepthValue=function(){return this._depthCounter++/65536},l.draw=function(){var a=this.gl,b=this.screenBox,c=this.viewBox,d=this.dataBox,e=this.pixelRatio,f=this.grid,g=this.line,h=this.text,i=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,a.bindFramebuffer(a.FRAMEBUFFER,null),a.enable(a.SCISSOR_TEST),a.disable(a.DEPTH_TEST),a.depthFunc(a.LESS),a.depthMask(!1),a.enable(a.BLEND),a.blendEquation(a.FUNC_ADD,a.FUNC_ADD),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),this.borderColor){a.scissor(b[0],b[1],b[2]-b[0],b[3]-b[1]);var j=this.borderColor;a.clearColor(j[0]*j[3],j[1]*j[3],j[2]*j[3],j[3]),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT)}a.scissor(c[0],c[1],c[2]-c[0],c[3]-c[1]),a.viewport(c[0],c[1],c[2]-c[0],c[3]-c[1]);var k=this.backgroundColor;a.clearColor(k[0]*k[3],k[1]*k[3],k[2]*k[3],k[3]),a.clear(a.COLOR_BUFFER_BIT),f.draw();var l=this.zeroLineEnable,m=this.zeroLineColor,n=this.zeroLineWidth;if(l[0]||l[1]){g.bind();for(var o=0;o<2;++o)if(l[o]&&d[o]<=0&&d[o+2]>=0){var p=b[o]-d[o]*(b[o+2]-b[o])/(d[o+2]-d[o]);0===o?g.drawLine(p,b[1],p,b[3],n[o],m[o]):g.drawLine(b[0],p,b[2],p,n[o],m[o])}}for(o=0;o<i.length;++o)i[o].draw();a.viewport(b[0],b[1],b[2]-b[0],b[3]-b[1]),a.scissor(b[0],b[1],b[2]-b[0],b[3]-b[1]),this.grid.drawTickMarks(),g.bind();var q=this.borderLineEnable,r=this.borderLineWidth,s=this.borderLineColor;for(q[1]&&g.drawLine(c[0],c[1]-.5*r[1]*e,c[0],c[3]+.5*r[3]*e,r[1],s[1]),q[0]&&g.drawLine(c[0]-.5*r[0]*e,c[1],c[2]+.5*r[2]*e,c[1],r[0],s[0]),q[3]&&g.drawLine(c[2],c[1]-.5*r[1]*e,c[2],c[3]+.5*r[3]*e,r[3],s[3]),q[2]&&g.drawLine(c[0]-.5*r[0]*e,c[3],c[2]+.5*r[2]*e,c[3],r[2],s[2]),h.bind(),o=0;o<2;++o)h.drawTicks(o);this.titleEnable&&h.drawTitle();var t=this.overlays;for(o=0;o<t.length;++o)t[o].draw();a.disable(a.SCISSOR_TEST),a.disable(a.BLEND),a.depthMask(!0)}},l.drawPick=function(){if(!this.static){var a=this.pickBuffer;this.gl,this._pickTimeout=null,a.begin();for(var b=1,c=this.objects,d=0;d<c.length;++d)b=c[d].drawPick(b);a.end()}},l.pick=function(a,b){if(!this.static){var c=this.pixelRatio,d=this.pickPixelRatio,e=this.viewBox,f=0|Math.round((a-e[0]/c)*d),g=0|Math.round((b-e[1]/c)*d),h=this.pickBuffer.query(f,g,this.pickRadius);if(!h)return null;for(var i=h.id+(h.value[0]<<8)+(h.value[1]<<16)+(h.value[2]<<24),j=this.objects,k=0;k<j.length;++k){var l=j[k].pick(f,g,i);if(l)return l}return null}},l.setScreenBox=function(a){var b=this.screenBox,c=this.pixelRatio;b[0]=0|Math.round(a[0]*c),b[1]=0|Math.round(a[1]*c),b[2]=0|Math.round(a[2]*c),b[3]=0|Math.round(a[3]*c),this.setDirty()},l.setDataBox=function(a){var b=this.dataBox;(b[0]!==a[0]||b[1]!==a[1]||b[2]!==a[2]||b[3]!==a[3])&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],this.setDirty())},l.setViewBox=function(a){var b=this.pixelRatio,c=this.viewBox;c[0]=0|Math.round(a[0]*b),c[1]=0|Math.round(a[1]*b),c[2]=0|Math.round(a[2]*b),c[3]=0|Math.round(a[3]*b);var d=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((a[2]-a[0])*d),0|Math.round((a[3]-a[1])*d)],this.setDirty()},l.update=function(a){a=a||{};var b=this.gl;this.pixelRatio=a.pixelRatio||1;var c=this.pixelRatio;this.pickPixelRatio=Math.max(c,1),this.setScreenBox(a.screenBox||[0,0,b.drawingBufferWidth/c,b.drawingBufferHeight/c]),this.screenBox,this.setViewBox(a.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/c,.125*(this.screenBox[3]-this.screenBox[1])/c,.875*(this.screenBox[2]-this.screenBox[0])/c,.875*(this.screenBox[3]-this.screenBox[1])/c]);var d=this.viewBox,g=(d[2]-d[0])/(d[3]-d[1]);this.setDataBox(a.dataBox||[-10,-10/g,10,10/g]),this.borderColor=!1!==a.borderColor&&(a.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(a.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(a.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(a.gridLineWidth||[1,1]).slice(),this.gridLineColor=e(a.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(a.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(a.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=e(a.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(a.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(a.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=e(a.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(a.titleCenter||[.5*(d[0]+d[2])/c,(d[3]+120)/c]).slice(),this.titleEnable=!("titleEnable"in a&&!a.titleEnable),this.titleAngle=a.titleAngle||0,this.titleColor=(a.titleColor||[0,0,0,1]).slice(),this.labelPad=(a.labelPad||[15,15,15,15]).slice(),this.labelAngle=(a.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(a.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=e(a.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(a.tickPad||[15,15,15,15]).slice(),this.tickAngle=(a.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(a.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=e(a.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(a.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(a.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=e(a.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var h=a.ticks||[[],[]],i=this._tickBounds;i[0]=i[1]=1/0,i[2]=i[3]=-1/0;for(var j=0;j<2;++j){var k=h[j].slice(0);0!==k.length&&(k.sort(f),i[j]=Math.min(i[j],k[0].x),i[j+2]=Math.max(i[j+2],k[k.length-1].x))}this.grid.update({bounds:i,ticks:h}),this.text.update({bounds:i,ticks:h,labels:a.labels||["x","y"],labelSize:a.labelSize||[12,12],labelFont:a.labelFont||["sans-serif","sans-serif"],title:a.title||"",titleSize:a.titleSize||18,titleFont:a.titleFont||"sans-serif"}),this.static=!!a.static,this.setDirty()},l.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var a=this.objects.length-1;a>=0;--a)this.objects[a].dispose();for(this.objects.length=0,a=this.overlays.length-1;a>=0;--a)this.overlays[a].dispose();this.overlays.length=0,this.gl=null},l.addObject=function(a){this.objects.indexOf(a)<0&&(this.objects.push(a),this.setDirty())},l.removeObject=function(a){for(var b=this.objects,c=0;c<b.length;++c)if(b[c]===a){b.splice(c,1),this.setDirty();break}},l.addOverlay=function(a){this.overlays.indexOf(a)<0&&(this.overlays.push(a),this.setOverlayDirty())},l.removeOverlay=function(a){for(var b=this.overlays,c=0;c<b.length;++c)if(b[c]===a){b.splice(c,1),this.setOverlayDirty();break}}},{"./lib/box":282,"./lib/grid":283,"./lib/line":284,"./lib/text":286,"gl-select-static":301}],289:[function(a,b,c){"use strict";b.exports=function(a,b){a=a||document.body,b=b||{};var c=[.01,1/0];"distanceLimits"in b&&(c[0]=b.distanceLimits[0],c[1]=b.distanceLimits[1]),"zoomMin"in b&&(c[0]=b.zoomMin),"zoomMax"in b&&(c[1]=b.zoomMax);var j=e({center:b.center||[0,0,0],up:b.up||[0,1,0],eye:b.eye||[0,0,10],mode:b.mode||"orbit",distanceLimits:c}),k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0,m=a.clientWidth,n=a.clientHeight,o={keyBindingMode:"rotate",enableWheel:!0,view:j,element:a,delay:b.delay||16,rotateSpeed:b.rotateSpeed||1,zoomSpeed:b.zoomSpeed||1,translateSpeed:b.translateSpeed||1,flipX:!!b.flipX,flipY:!!b.flipY,modes:j.modes,_ortho:b._ortho||b.projection&&"orthographic"===b.projection.type||!1,tick:function(){var b=d(),c=this.delay,e=b-2*c;j.idle(b-c),j.recalcMatrix(e),j.flush(b-(100+2*c));for(var f=!0,g=j.computedMatrix,h=0;h<16;++h)f=f&&k[h]===g[h],k[h]=g[h];var i=a.clientWidth===m&&a.clientHeight===n;return m=a.clientWidth,n=a.clientHeight,f?!i:(l=Math.exp(j.computedRadius[0]),!0)},lookAt:function(a,b,c){j.lookAt(j.lastT(),a,b,c)},rotate:function(a,b,c){j.rotate(j.lastT(),a,b,c)},pan:function(a,b,c){j.pan(j.lastT(),a,b,c)},translate:function(a,b,c){j.translate(j.lastT(),a,b,c)}};return Object.defineProperties(o,{matrix:{get:function(){return j.computedMatrix},set:function(a){return j.setMatrix(j.lastT(),a),j.computedMatrix},enumerable:!0},mode:{get:function(){return j.getMode()},set:function(a){var b=j.computedUp.slice(),c=j.computedEye.slice(),e=j.computedCenter.slice();if(j.setMode(a),"turntable"===a){var f=d();j._active.lookAt(f,c,e,b),j._active.lookAt(f+500,c,e,[0,0,1]),j._active.flush(f)}return j.getMode()},enumerable:!0},center:{get:function(){return j.computedCenter},set:function(a){return j.lookAt(j.lastT(),null,a),j.computedCenter},enumerable:!0},eye:{get:function(){return j.computedEye},set:function(a){return j.lookAt(j.lastT(),a),j.computedEye},enumerable:!0},up:{get:function(){return j.computedUp},set:function(a){return j.lookAt(j.lastT(),null,null,a),j.computedUp},enumerable:!0},distance:{get:function(){return l},set:function(a){return j.setDistance(j.lastT(),a),a},enumerable:!0},distanceLimits:{get:function(){return j.getDistanceLimits(c)},set:function(a){return j.setDistanceLimits(a),a},enumerable:!0}}),a.addEventListener("contextmenu",function(a){return a.preventDefault(),!1}),o._lastX=-1,o._lastY=-1,o._lastMods={shift:!1,control:!1,alt:!1,meta:!1},o.enableMouseListeners=function(){function b(b,c,e,f){var g=o.keyBindingMode;if(!1!==g){var h="rotate"===g,i="pan"===g,k="zoom"===g,m=!!f.control,n=!!f.alt,p=!!f.shift,q=!!(1&b),r=!!(2&b),s=!!(4&b),t=1/a.clientHeight,u=t*(c-o._lastX),v=t*(e-o._lastY),w=o.flipX?1:-1,x=o.flipY?1:-1,y=Math.PI*o.rotateSpeed,z=d();if(-1!==o._lastX&&-1!==o._lastY&&((h&&q&&!m&&!n&&!p||q&&!m&&!n&&p)&&j.rotate(z,w*y*u,-x*y*v,0),(i&&q&&!m&&!n&&!p||r||q&&m&&!n&&!p)&&j.pan(z,-o.translateSpeed*u*l,o.translateSpeed*v*l,0),k&&q&&!m&&!n&&!p||s||q&&!m&&n&&!p)){var A=-o.zoomSpeed*v/window.innerHeight*(z-j.lastT())*100;j.pan(z,0,0,l*(Math.exp(A)-1))}return o._lastX=c,o._lastY=e,o._lastMods=f,!0}}o.mouseListener=f(a,b),a.addEventListener("touchstart",function(c){var d=h(c.changedTouches[0],a);b(0,d[0],d[1],o._lastMods),b(1,d[0],d[1],o._lastMods),c.preventDefault()},!!i&&{passive:!1}),a.addEventListener("touchmove",function(c){var d=h(c.changedTouches[0],a);b(1,d[0],d[1],o._lastMods),c.preventDefault()},!!i&&{passive:!1}),a.addEventListener("touchend",function(a){b(0,o._lastX,o._lastY,o._lastMods),a.preventDefault()},!!i&&{passive:!1}),o.wheelListener=g(a,function(a,b){if(!1!==o.keyBindingMode&&o.enableWheel){var c=o.flipX?1:-1,e=o.flipY?1:-1,f=d();if(Math.abs(a)>Math.abs(b))j.rotate(f,0,0,-a*c*Math.PI*o.rotateSpeed/window.innerWidth);else if(!o._ortho){var g=-o.zoomSpeed*e*b/window.innerHeight*(f-j.lastT())/20;j.pan(f,0,0,l*(Math.exp(g)-1))}}},!0)},o.enableMouseListeners(),o};var d=a("right-now"),e=a("3d-view"),f=a("mouse-change"),g=a("mouse-wheel"),h=a("mouse-event-offset"),i=a("has-passive-events")},{"3d-view":53,"has-passive-events":412,"mouse-change":436,"mouse-event-offset":437,"mouse-wheel":439,"right-now":505}],290:[function(a,b,c){var d=a("glslify"),e=a("gl-shader"),f=d(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]),g=d(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);b.exports=function(a){return e(a,f,g,null,[{name:"position",type:"vec2"}])}},{"gl-shader":302,glslify:410}],291:[function(a,b,c){"use strict";function d(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function e(a){var b=Math.round(Math.log(Math.abs(a))/Math.log(10));if(b<0){var c=Math.round(Math.pow(10,-b));return Math.ceil(a*c)/c}return b>0?(c=Math.round(Math.pow(10,b)),Math.ceil(a/c)*c):Math.ceil(a)}function f(a){return"boolean"!=typeof a||a}var g=a("./camera.js"),h=a("gl-axes3d"),i=a("gl-axes3d/properties"),j=a("gl-spikes3d"),k=a("gl-select-static"),l=a("gl-fbo"),m=a("a-big-triangle"),n=a("mouse-change"),o=a("mouse-wheel"),p=a("gl-mat4/perspective"),q=a("gl-mat4/ortho"),r=a("./lib/shader"),s=a("is-mobile")({tablet:!0});b.exports={createScene:function(a){function b(){if(!T._stopped&&T.autoResize){var a=v.parentNode,b=1,c=1;a&&a!==document.body?(b=a.clientWidth,c=a.clientHeight):(b=window.innerWidth,c=window.innerHeight);var d=0|Math.ceil(b*T.pixelRatio),e=0|Math.ceil(c*T.pixelRatio);if(d!==v.width||e!==v.height){v.width=d,v.height=e;var f=v.style;f.position=f.position||"absolute",f.left="0px",f.top="0px",f.width=b+"px",f.height=c+"px",M=!0}}}function c(){for(var a=I.length,b=L.length,c=0;c<b;++c)K[c]=0;a:for(var c=0;c<a;++c){var d=I[c],e=d.pickSlots;if(e){for(var f=0;f<b;++f)if(K[f]+e<255){J[c]=f,d.setPickBase(K[f]+1),K[f]+=e;continue a}var g=k(x,R);J[c]=b,L.push(g),K.push(e),d.setPickBase(1),b+=1}else J[c]=-1}for(;b>0&&0===K[b-1];)K.pop(),L.pop().dispose()}function t(){if(T.contextLost)return!0;x.isContextLost()&&(T.contextLost=!0,T.mouseListener.enabled=!1,T.selection.object=null,T.oncontextloss&&T.oncontextloss())}function u(){if(!t()){b();var a=T.camera.tick();Q.view=T.camera.matrix,M=M||a,N=N||a,F.pixelRatio=T.pixelRatio,H.pixelRatio=T.pixelRatio;var c=I.length,d=V[0],f=V[1];d[0]=d[1]=d[2]=1/0,f[0]=f[1]=f[2]=-1/0;for(var g=0;g<c;++g){var h=I[g];h.pixelRatio=T.pixelRatio,h.axes=T.axes,M=M||!!h.dirty,N=N||!!h.dirty;var j=h.bounds;if(j)for(var k=j[0],l=j[1],n=0;n<3;++n)d[n]=Math.min(d[n],k[n]),f[n]=Math.max(f[n],l[n])}var o=T.bounds;if(T.autoBounds)for(var n=0;n<3;++n){if(f[n]<d[n])d[n]=-1,f[n]=1;else{d[n]===f[n]&&(d[n]-=1,f[n]+=1);var r=.05*(f[n]-d[n]);d[n]=d[n]-r,f[n]=f[n]+r}o[0][n]=d[n],o[1][n]=f[n]}for(var s=!1,n=0;n<3;++n)s=s||W[0][n]!==o[0][n]||W[1][n]!==o[1][n],W[0][n]=o[0][n],W[1][n]=o[1][n];if(N=N||s,M=M||s){if(s){for(var u=[0,0,0],g=0;g<3;++g)u[g]=e((o[1][g]-o[0][g])/10);F.autoTicks?F.update({bounds:o,tickSpacing:u}):F.update({bounds:o})}var v=x.drawingBufferWidth,w=x.drawingBufferHeight;R[0]=v,R[1]=w,U[0]=0|Math.max(v/T.pixelRatio,1),U[1]=0|Math.max(w/T.pixelRatio,1),C?(q(O,-v/w,v/w,-1,1,T.zNear,T.zFar),Q._ortho=!0):(p(O,T.fovy,v/w,T.zNear,T.zFar),Q._ortho=!1);for(var g=0;g<16;++g)P[g]=0;P[15]=1;for(var y=0,g=0;g<3;++g)y=Math.max(y,o[1][g]-o[0][g]);for(var g=0;g<3;++g)T.autoScale?P[5*g]=T.aspect[g]/(o[1][g]-o[0][g]):P[5*g]=1/y,T.autoCenter&&(P[12+g]=.5*-P[5*g]*(o[0][g]+o[1][g]));for(var g=0;g<c;++g){var h=I[g];h.axesBounds=o,T.clipToBounds&&(h.clipBounds=o)}z.object&&(T.snapToData?H.position=z.dataCoordinate:H.position=z.dataPosition,H.bounds=o),N&&(N=!1,function(){if(!t()){x.colorMask(!0,!0,!0,!0),x.depthMask(!0),x.disable(x.BLEND),x.enable(x.DEPTH_TEST),x.depthFunc(x.LEQUAL);for(var a=I.length,b=L.length,c=0;c<b;++c){var d=L[c];d.shape=U,d.begin();for(var e=0;e<a;++e)if(J[e]===c){var f=I[e];f.drawPick&&(f.pixelRatio=1,f.drawPick(Q))}d.end()}}}()),T.axesPixels=i(T.axes,Q,v,w),T.onrender&&T.onrender(),x.bindFramebuffer(x.FRAMEBUFFER,null),x.viewport(0,0,v,w);var D=T.clearColor;x.clearColor(D[0],D[1],D[2],D[3]),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT),x.depthMask(!0),x.colorMask(!0,!0,!0,!0),x.enable(x.DEPTH_TEST),x.depthFunc(x.LEQUAL),x.disable(x.BLEND),x.disable(x.CULL_FACE);var E=!1;F.enable&&(E=E||F.isTransparent(),F.draw(Q)),H.axes=F,z.object&&H.draw(Q),x.disable(x.CULL_FACE);for(var g=0;g<c;++g){var h=I[g];h.axes=F,h.pixelRatio=T.pixelRatio,h.isOpaque&&h.isOpaque()&&h.draw(Q),h.isTransparent&&h.isTransparent()&&(E=!0)}if(E){A.shape=R,A.bind(),x.clear(x.DEPTH_BUFFER_BIT),x.colorMask(!1,!1,!1,!1),x.depthMask(!0),x.depthFunc(x.LESS),F.enable&&F.isTransparent()&&F.drawTransparent(Q);for(var g=0;g<c;++g){var h=I[g];h.isOpaque&&h.isOpaque()&&h.draw(Q)}x.enable(x.BLEND),x.blendEquation(x.FUNC_ADD),x.blendFunc(x.ONE,x.ONE_MINUS_SRC_ALPHA),x.colorMask(!0,!0,!0,!0),x.depthMask(!1),x.clearColor(0,0,0,0),x.clear(x.COLOR_BUFFER_BIT),F.isTransparent()&&F.drawTransparent(Q);for(var g=0;g<c;++g){var h=I[g];h.isTransparent&&h.isTransparent()&&h.drawTransparent(Q)}x.bindFramebuffer(x.FRAMEBUFFER,null),x.blendFunc(x.ONE,x.ONE_MINUS_SRC_ALPHA),x.disable(x.DEPTH_TEST),B.bind(),A.color[0].bind(0),B.uniforms.accumBuffer=0,m(x),x.disable(x.BLEND)}M=!1;for(var g=0;g<c;++g)I[g].dirty=!1}}}(a=a||{}).camera=a.camera||{};var v=a.canvas;if(!v)if(v=document.createElement("canvas"),a.container){var w=a.container;w.appendChild(v)}else document.body.appendChild(v);var x=a.gl;if(x||(x=function(a,b){var c=null;try{(c=a.getContext("webgl",b))||(c=a.getContext("experimental-webgl",b))}catch(a){return null}return c}(v,a.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:s})),!x)throw new Error("webgl not supported");var y=a.bounds||[[-10,-10,-10],[10,10,10]],z=new d,A=l(x,[x.drawingBufferWidth,x.drawingBufferHeight],{preferFloat:!s}),B=r(x),C=a.cameraObject&&!0===a.cameraObject._ortho||a.camera.projection&&"orthographic"===a.camera.projection.type||!1,D={eye:a.camera.eye||[2,0,0],center:a.camera.center||[0,0,0],up:a.camera.up||[0,1,0],zoomMin:a.camera.zoomMax||.1,zoomMax:a.camera.zoomMin||100,mode:a.camera.mode||"turntable",_ortho:C},E=a.axes||{},F=h(x,E);F.enable=!E.disable;var G=a.spikes||{},H=j(x,G),I=[],J=[],K=[],L=[],M=!0,N=!0,O=new Array(16),P=new Array(16),Q={view:null,projection:O,model:P,_ortho:!1},N=!0,R=[x.drawingBufferWidth,x.drawingBufferHeight],S=a.cameraObject||g(v,D),T={gl:x,contextLost:!1,pixelRatio:a.pixelRatio||1,canvas:v,selection:z,camera:S,axes:F,axesPixels:null,spikes:H,bounds:y,objects:I,shape:R,aspect:a.aspectRatio||[1,1,1],pickRadius:a.pickRadius||10,zNear:a.zNear||.01,zFar:a.zFar||1e3,fovy:a.fovy||Math.PI/4,clearColor:a.clearColor||[0,0,0,0],autoResize:f(a.autoResize),autoBounds:f(a.autoBounds),autoScale:!!a.autoScale,autoCenter:f(a.autoCenter),clipToBounds:f(a.clipToBounds),snapToData:!!a.snapToData,onselect:a.onselect||null,onrender:a.onrender||null,onclick:a.onclick||null,cameraParams:Q,oncontextloss:null,mouseListener:null,_stopped:!1},U=[x.drawingBufferWidth/T.pixelRatio|0,x.drawingBufferHeight/T.pixelRatio|0];T.autoResize&&b(),window.addEventListener("resize",b),T.update=function(a){T._stopped||(a=a||{},M=!0,N=!0)},T.add=function(a){T._stopped||(a.axes=F,I.push(a),J.push(-1),M=!0,N=!0,c())},T.remove=function(a){if(!T._stopped){var b=I.indexOf(a);b<0||(I.splice(b,1),J.pop(),M=!0,N=!0,c())}},T.dispose=function(){if(!T._stopped&&(T._stopped=!0,window.removeEventListener("resize",b),v.removeEventListener("webglcontextlost",t),T.mouseListener.enabled=!1,!T.contextLost)){F.dispose(),H.dispose();for(var a=0;a<I.length;++a)I[a].dispose();A.dispose();for(var a=0;a<L.length;++a)L[a].dispose();B.dispose(),x=null,F=null,H=null,I=[]}},T.wheelListener=o(v,function(a,b){if(!1!==S.keyBindingMode&&S.enableWheel&&S._ortho){var c=a>b?1.1:1/1.1;T.aspect[0]*=c,T.aspect[1]*=c,T.aspect[2]*=c,T.redraw()}},!0),T._mouseRotating=!1,T._prevButtons=0,T.enableMouseListeners=function(){T.mouseListener=n(v,function(a,b,c){if(!T._stopped){var d=L.length,e=I.length,f=z.object;z.distance=1/0,z.mouse[0]=b,z.mouse[1]=c,z.object=null,z.screen=null,z.dataCoordinate=z.dataPosition=null;var g=!1;if(a&&T._prevButtons)T._mouseRotating=!0;else{T._mouseRotating&&(N=!0),T._mouseRotating=!1;for(var h=0;h<d;++h){var i=L[h].query(b,U[1]-c-1,T.pickRadius);if(i){if(i.distance>z.distance)continue;for(var j=0;j<e;++j){var k=I[j];if(J[j]===h){var l=k.pick(i);l&&(z.buttons=a,z.screen=i.coord,z.distance=i.distance,z.object=k,z.index=l.distance,z.dataPosition=l.position,z.dataCoordinate=l.dataCoordinate,z.data=l,g=!0)}}}}}f&&f!==z.object&&(f.highlight&&f.highlight(null),M=!0),z.object&&(z.object.highlight&&z.object.highlight(z.data),M=!0),(g=g||z.object!==f)&&T.onselect&&T.onselect(z),1&a&&!(1&T._prevButtons)&&T.onclick&&T.onclick(z),T._prevButtons=a}})},v.addEventListener("webglcontextlost",t);var V=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],W=[V[0].slice(),V[1].slice()];return T.enableMouseListeners(),function a(){T._stopped||T.contextLost||(u(),requestAnimationFrame(a))}(),T.redraw=function(){T._stopped||(M=!0,u())},T},createCamera:g}},{"./camera.js":289,"./lib/shader":290,"a-big-triangle":60,"gl-axes3d":234,"gl-axes3d/properties":241,"gl-fbo":250,"gl-mat4/ortho":269,"gl-mat4/perspective":270,"gl-select-static":301,"gl-spikes3d":311,"is-mobile":421,"mouse-change":436,"mouse-wheel":439}],292:[function(a,b,c){var d=a("glslify");c.pointVertex=d(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]),c.pointFragment=d(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]),c.pickVertex=d(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]),c.pickFragment=d(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:410}],293:[function(a,b,c){"use strict";function d(a,b,c,d,e){this.plot=a,this.offsetBuffer=b,this.pickBuffer=c,this.shader=d,this.pickShader=e,
this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}var e=a("gl-shader"),f=a("gl-buffer"),g=a("typedarray-pool"),h=a("./lib/shader");b.exports=function(a,b){var c=a.gl,g=f(c),i=f(c),j=e(c,h.pointVertex,h.pointFragment),k=e(c,h.pickVertex,h.pickFragment),l=new d(a,g,i,j,k);return l.update(b),a.addObject(l),l};var i,j,k=d.prototype;k.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},k.update=function(a){function b(b,c){return b in a?a[b]:c}var c;a=a||{},this.sizeMin=b("sizeMin",.5),this.sizeMax=b("sizeMax",20),this.color=b("color",[1,0,0,1]).slice(),this.areaRatio=b("areaRatio",1),this.borderColor=b("borderColor",[0,0,0,1]).slice(),this.blend=b("blend",!1);var d=a.positions.length>>>1,e=a.positions instanceof Float32Array,f=a.idToIndex instanceof Int32Array&&a.idToIndex.length>=d,h=a.positions,i=e?h:g.mallocFloat32(h.length),j=f?a.idToIndex:g.mallocInt32(d);if(e||i.set(h),!f)for(i.set(h),c=0;c<d;c++)j[c]=c;this.points=h,this.offsetBuffer.update(i),this.pickBuffer.update(j),e||g.free(i),f||g.free(j),this.pointCount=d,this.pickOffset=0},k.unifiedDraw=(i=[1,0,0,0,1,0,0,0,1],j=[0,0,0,0],function(a){var b=void 0!==a,c=b?this.pickShader:this.shader,d=this.plot.gl,e=this.plot.dataBox;if(0===this.pointCount)return a;var f=e[2]-e[0],g=e[3]-e[1],h=function(a,b){var c,d=0,e=a.length>>>1;for(c=0;c<e;c++){var f=a[2*c],g=a[2*c+1];f>=b[0]&&f<=b[2]&&g>=b[1]&&g<=b[3]&&d++}return d}(this.points,e),k=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(h,.33333)));i[0]=2/f,i[4]=2/g,i[6]=-2*e[0]/f-1,i[7]=-2*e[1]/g-1,this.offsetBuffer.bind(),c.bind(),c.attributes.position.pointer(),c.uniforms.matrix=i,c.uniforms.color=this.color,c.uniforms.borderColor=this.borderColor,c.uniforms.pointCloud=k<5,c.uniforms.pointSize=k,c.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),b&&(j[0]=255&a,j[1]=a>>8&255,j[2]=a>>16&255,j[3]=a>>24&255,this.pickBuffer.bind(),c.attributes.pickId.pointer(d.UNSIGNED_BYTE),c.uniforms.pickOffset=j,this.pickOffset=a);var l=d.getParameter(d.BLEND),m=d.getParameter(d.DITHER);return l&&!this.blend&&d.disable(d.BLEND),m&&d.disable(d.DITHER),d.drawArrays(d.POINTS,0,this.pointCount),l&&!this.blend&&d.enable(d.BLEND),m&&d.enable(d.DITHER),a+this.pointCount}),k.draw=k.unifiedDraw,k.drawPick=k.unifiedDraw,k.pick=function(a,b,c){var d=this.pickOffset,e=this.pointCount;if(c<d||c>=d+e)return null;var f=c-d,g=this.points;return{object:this,pointId:f,dataCoord:[g[2*f],g[2*f+1]]}}},{"./lib/shader":292,"gl-buffer":242,"gl-shader":302,"typedarray-pool":546}],294:[function(a,b,c){b.exports=function(a,b,c,d){var e,f,g,h,i,j=b[0],k=b[1],l=b[2],m=b[3],n=c[0],o=c[1],p=c[2],q=c[3];return(f=j*n+k*o+l*p+m*q)<0&&(f=-f,n=-n,o=-o,p=-p,q=-q),1-f>1e-6?(e=Math.acos(f),g=Math.sin(e),h=Math.sin((1-d)*e)/g,i=Math.sin(d*e)/g):(h=1-d,i=d),a[0]=h*j+i*n,a[1]=h*k+i*o,a[2]=h*l+i*p,a[3]=h*m+i*q,a}},{}],295:[function(a,b,c){"use strict";b.exports=function(a){return a||0===a?a.toString():""}},{}],296:[function(a,b,c){"use strict";var d=a("vectorize-text");b.exports=function(a,b,c){var f=e[b];if(f||(f=e[b]={}),a in f)return f[a];var g={textAlign:"center",textBaseline:"middle",lineHeight:1,font:b,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},h=d(a,g);g.triangles=!1;var i,j,k=d(a,g);if(c&&1!==c){for(i=0;i<h.positions.length;++i)for(j=0;j<h.positions[i].length;++j)h.positions[i][j]/=c;for(i=0;i<k.positions.length;++i)for(j=0;j<k.positions[i].length;++j)k.positions[i][j]/=c}var l=[[1/0,1/0],[-1/0,-1/0]],m=k.positions.length;for(i=0;i<m;++i){var n=k.positions[i];for(j=0;j<2;++j)l[0][j]=Math.min(l[0][j],n[j]),l[1][j]=Math.max(l[1][j],n[j])}return f[a]=[h,k,l]};var e={}},{"vectorize-text":551}],297:[function(a,b,c){function d(a,b){var c=e(a,b),d=c.attributes;return d.position.location=0,d.color.location=1,d.glyph.location=2,d.id.location=3,c}var e=a("gl-shader"),f=a("glslify"),g=f(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),h=f(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),i=f(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]),j=f(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (\n    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||\n    interpColor.a * opacity == 0.\n  ) discard;\n  gl_FragColor = interpColor * opacity;\n}\n"]),k=f(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]),l=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],m={vertex:g,fragment:j,attributes:l},n={vertex:h,fragment:j,attributes:l},o={vertex:i,fragment:j,attributes:l},p={vertex:g,fragment:k,attributes:l},q={vertex:h,fragment:k,attributes:l},r={vertex:i,fragment:k,attributes:l};c.createPerspective=function(a){return d(a,m)},c.createOrtho=function(a){return d(a,n)},c.createProject=function(a){return d(a,o)},c.createPickPerspective=function(a){return d(a,p)},c.createPickOrtho=function(a){return d(a,q)},c.createPickProject=function(a){return d(a,r)}},{"gl-shader":302,glslify:410}],298:[function(a,b,c){"use strict";function d(a,b){var c=a[0],d=a[1],e=a[2],f=a[3];return a[0]=b[0]*c+b[4]*d+b[8]*e+b[12]*f,a[1]=b[1]*c+b[5]*d+b[9]*e+b[13]*f,a[2]=b[2]*c+b[6]*d+b[10]*e+b[14]*f,a[3]=b[3]*c+b[7]*d+b[11]*e+b[15]*f,a}function e(a,b,c,e){return d(e,e),d(e,e),d(e,e)}function f(a,b){this.index=a,this.dataCoordinate=this.position=b}function g(a){return!0===a?1:a>1?1:a}function h(a,b,c,d,e,g,h,i,j,k,l,m){this.gl=a,this.pixelRatio=1,this.shader=b,this.orthoShader=c,this.projectShader=d,this.pointBuffer=e,this.colorBuffer=g,this.glyphBuffer=h,this.idBuffer=i,this.vao=j,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=k,this.pickOrthoShader=l,this.pickProjectShader=m,this.points=[],this._selectResult=new f(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}function i(a){return a[0]=a[1]=a[2]=0,a}function j(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=1,a}function k(a,b,c,d){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[c]=d,a}function l(a,b,c,d){var f,g=b.axesProject,h=b.gl,l=a.uniforms,m=c.model||w,n=c.view||w,o=c.projection||w,p=b.axesBounds,q=function(a){for(var b=F,c=0;c<2;++c)for(var d=0;d<3;++d)b[c][d]=Math.max(Math.min(a[c][d],1e8),-1e8);return b}(b.clipBounds);f=b.axes&&b.axes.lastCubeProps?b.axes.lastCubeProps.axis:[1,1,1],y[0]=2/h.drawingBufferWidth,y[1]=2/h.drawingBufferHeight,a.bind(),l.view=n,l.projection=o,l.screenSize=y,l.highlightId=b.highlightId,l.highlightScale=b.highlightScale,l.clipBounds=q,l.pickGroup=b.pickId/255,l.pixelRatio=d;for(var r=0;r<3;++r)if(g[r]){l.scale=b.projectScale[r],l.opacity=b.projectOpacity[r];for(var t=D,u=0;u<16;++u)t[u]=0;for(u=0;u<4;++u)t[5*u]=1;t[5*r]=0,f[r]<0?t[12+r]=p[0][r]:t[12+r]=p[1][r],s(t,m,t),l.model=t;var v=(r+1)%3,x=(r+2)%3,G=i(z),H=i(A);G[v]=1,H[x]=1;var I=e(0,0,0,j(B,G)),J=e(0,0,0,j(C,H));if(Math.abs(I[1])>Math.abs(J[1])){var K=I;I=J,J=K,K=G,G=H,H=K;var L=v;v=x,x=L}I[0]<0&&(G[v]=-1),J[1]>0&&(H[x]=-1);var M=0,N=0;for(u=0;u<4;++u)M+=Math.pow(m[4*v+u],2),N+=Math.pow(m[4*x+u],2);G[v]/=Math.sqrt(M),H[x]/=Math.sqrt(N),l.axes[0]=G,l.axes[1]=H,l.fragClipBounds[0]=k(E,q[0],r,-1e8),l.fragClipBounds[1]=k(E,q[1],r,1e8),b.vao.bind(),b.vao.draw(h.TRIANGLES,b.vertexCount),b.lineWidth>0&&(h.lineWidth(b.lineWidth*d),b.vao.draw(h.LINES,b.lineVertexCount,b.vertexCount)),b.vao.unbind()}}function m(a,b,c,d,e,f,g){var h=c.gl;if((f===c.projectHasAlpha||g)&&l(b,c,d,e),f===c.hasAlpha||g){a.bind();var i=a.uniforms;i.model=d.model||w,i.view=d.view||w,i.projection=d.projection||w,y[0]=2/h.drawingBufferWidth,y[1]=2/h.drawingBufferHeight,i.screenSize=y,i.highlightId=c.highlightId,i.highlightScale=c.highlightScale,i.fragClipBounds=G,i.clipBounds=c.axes.bounds,i.opacity=c.opacity,i.pickGroup=c.pickId/255,i.pixelRatio=e,c.vao.bind(),c.vao.draw(h.TRIANGLES,c.vertexCount),c.lineWidth>0&&(h.lineWidth(c.lineWidth*e),c.vao.draw(h.LINES,c.lineVertexCount,c.vertexCount)),c.vao.unbind()}}function n(a,b,c,d){var e;e=Array.isArray(a)?b<a.length?a[b]:void 0:a,e=v(e);var f=!0;o(e)&&(e="",f=!1);var g=u(e,c,d);return{mesh:g[0],lines:g[1],bounds:g[2],visible:f}}var o=a("is-string-blank"),p=a("gl-buffer"),q=a("gl-vao"),r=a("typedarray-pool"),s=a("gl-mat4/multiply"),t=a("./lib/shaders"),u=a("./lib/glyphs"),v=a("./lib/get-simple-string"),w=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];b.exports=function(a){var b=a.gl,c=t.createPerspective(b),d=t.createOrtho(b),e=t.createProject(b),f=t.createPickPerspective(b),g=t.createPickOrtho(b),i=t.createPickProject(b),j=p(b),k=p(b),l=p(b),m=p(b),n=q(b,[{buffer:j,size:3,type:b.FLOAT},{buffer:k,size:4,type:b.FLOAT},{buffer:l,size:2,type:b.FLOAT},{buffer:m,size:4,type:b.UNSIGNED_BYTE,normalized:!0}]),o=new h(b,c,d,e,j,k,l,m,n,f,g,i);return o.update(a),o};var x=h.prototype;x.pickSlots=1,x.setPickBase=function(a){this.pickId=a},x.isTransparent=function(){if(this.hasAlpha)return!0;for(var a=0;a<3;++a)if(this.axesProject[a]&&this.projectHasAlpha)return!0;return!1},x.isOpaque=function(){if(!this.hasAlpha)return!0;for(var a=0;a<3;++a)if(this.axesProject[a]&&!this.projectHasAlpha)return!0;return!1};var y=[0,0],z=[0,0,0],A=[0,0,0],B=[0,0,0,1],C=[0,0,0,1],D=w.slice(),E=[0,0,0],F=[[0,0,0],[0,0,0]],G=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];x.draw=function(a){m(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,a,this.pixelRatio,!1,!1)},x.drawTransparent=function(a){m(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,a,this.pixelRatio,!0,!1)},x.drawPick=function(a){m(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,a,1,!0,!0)},x.pick=function(a){if(!a)return null;if(a.id!==this.pickId)return null;var b=a.value[2]+(a.value[1]<<8)+(a.value[0]<<16);if(b>=this.pointCount||b<0)return null;var c=this.points[b],d=this._selectResult;d.index=b;for(var e=0;e<3;++e)d.position[e]=d.dataCoordinate[e]=c[e];return d},x.highlight=function(a){if(a){var b=a.index,c=255&b,d=b>>8&255,e=b>>16&255;this.highlightId=[c/255,d/255,e/255,0]}else this.highlightId=[1,1,1,1]},x.update=function(a){if("perspective"in(a=a||{})&&(this.useOrtho=!a.perspective),"orthographic"in a&&(this.useOrtho=!!a.orthographic),"lineWidth"in a&&(this.lineWidth=a.lineWidth),"project"in a)if(Array.isArray(a.project))this.axesProject=a.project;else{var b=!!a.project;this.axesProject=[b,b,b]}if("projectScale"in a)if(Array.isArray(a.projectScale))this.projectScale=a.projectScale.slice();else{var c=+a.projectScale;this.projectScale=[c,c,c]}if(this.projectHasAlpha=!1,"projectOpacity"in a){Array.isArray(a.projectOpacity)?this.projectOpacity=a.projectOpacity.slice():(c=+a.projectOpacity,this.projectOpacity=[c,c,c]);for(var d=0;d<3;++d)this.projectOpacity[d]=g(this.projectOpacity[d]),this.projectOpacity[d]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in a&&(this.opacity=g(a.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var e,f,h=a.position,i=a.font||"normal",j=a.alignment||[0,0];if(2===j.length)e=j[0],f=j[1];else for(e=[],f=[],d=0;d<j.length;++d)e[d]=j[d][0],f[d]=j[d][1];var k=[1/0,1/0,1/0],l=[-1/0,-1/0,-1/0],m=a.glyph,o=a.color,p=a.size,q=a.angle,s=a.lineColor,t=-1,u=0,v=0,w=0;if(h.length){w=h.length;a:for(d=0;d<w;++d){for(var x=h[d],y=0;y<3;++y)if(isNaN(x[y])||!isFinite(x[y]))continue a;var z=(N=n(m,d,i,this.pixelRatio)).mesh,A=N.lines,B=N.bounds;u+=3*z.cells.length,v+=2*A.edges.length}}var C=u+v,D=r.mallocFloat(3*C),E=r.mallocFloat(4*C),F=r.mallocFloat(2*C),G=r.mallocUint32(C);if(C>0){var H=0,I=u,J=[0,0,0,1],K=[0,0,0,1],L=Array.isArray(o)&&Array.isArray(o[0]),M=Array.isArray(s)&&Array.isArray(s[0]);a:for(d=0;d<w;++d){for(t+=1,x=h[d],y=0;y<3;++y){if(isNaN(x[y])||!isFinite(x[y]))continue a;l[y]=Math.max(l[y],x[y]),k[y]=Math.min(k[y],x[y])}z=(N=n(m,d,i,this.pixelRatio)).mesh,A=N.lines,B=N.bounds;var N,O=N.visible;if(O)if(Array.isArray(o)){if(3===(P=L?d<o.length?o[d]:[0,0,0,0]:o).length){for(y=0;y<3;++y)J[y]=P[y];J[3]=1}else if(4===P.length){for(y=0;y<4;++y)J[y]=P[y];!this.hasAlpha&&P[3]<1&&(this.hasAlpha=!0)}}else J[0]=J[1]=J[2]=0,J[3]=1;else J=[1,1,1,0];if(O)if(Array.isArray(s)){var P;if(3===(P=M?d<s.length?s[d]:[0,0,0,0]:s).length){for(y=0;y<3;++y)K[y]=P[y];K[y]=1}else if(4===P.length){for(y=0;y<4;++y)K[y]=P[y];!this.hasAlpha&&P[3]<1&&(this.hasAlpha=!0)}}else K[0]=K[1]=K[2]=0,K[3]=1;else K=[1,1,1,0];var Q=.5;O?Array.isArray(p)?Q=d<p.length?+p[d]:12:p?Q=+p:this.useOrtho&&(Q=12):Q=0;var R=0;Array.isArray(q)?R=d<q.length?+q[d]:0:q&&(R=+q);var S=Math.cos(R),T=Math.sin(R);for(x=h[d],y=0;y<3;++y)l[y]=Math.max(l[y],x[y]),k[y]=Math.min(k[y],x[y]);var U=e,V=f;U=0,Array.isArray(e)?U=d<e.length?e[d]:0:e&&(U=e),V=0,Array.isArray(f)?V=d<f.length?f[d]:0:f&&(V=f);var W=[U*=U>0?1-B[0][0]:U<0?1+B[1][0]:1,V*=V>0?1-B[0][1]:V<0?1+B[1][1]:1],X=z.cells||[],Y=z.positions||[];for(y=0;y<X.length;++y)for(var Z=X[y],$=0;$<3;++$){for(var _=0;_<3;++_)D[3*H+_]=x[_];for(_=0;_<4;++_)E[4*H+_]=J[_];G[H]=t;var aa=Y[Z[$]];F[2*H]=Q*(S*aa[0]-T*aa[1]+W[0]),F[2*H+1]=Q*(T*aa[0]+S*aa[1]+W[1]),H+=1}for(X=A.edges,Y=A.positions,y=0;y<X.length;++y)for(Z=X[y],$=0;$<2;++$){for(_=0;_<3;++_)D[3*I+_]=x[_];for(_=0;_<4;++_)E[4*I+_]=K[_];G[I]=t,aa=Y[Z[$]],F[2*I]=Q*(S*aa[0]-T*aa[1]+W[0]),F[2*I+1]=Q*(T*aa[0]+S*aa[1]+W[1]),I+=1}}}this.bounds=[k,l],this.points=h,this.pointCount=h.length,this.vertexCount=u,this.lineVertexCount=v,this.pointBuffer.update(D),this.colorBuffer.update(E),this.glyphBuffer.update(F),this.idBuffer.update(G),r.free(D),r.free(E),r.free(F),r.free(G)},x.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":295,"./lib/glyphs":296,"./lib/shaders":297,"gl-buffer":242,"gl-mat4/multiply":268,"gl-vao":328,"is-string-blank":424,"typedarray-pool":546}],299:[function(a,b,c){"use strict";var d=a("glslify");c.boxVertex=d(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]),c.boxFragment=d(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:410}],300:[function(a,b,c){"use strict";function d(a,b,c){this.plot=a,this.boxBuffer=b,this.boxShader=c,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}var e=a("gl-shader"),f=a("gl-buffer"),g=a("./lib/shaders");b.exports=function(a,b){var c=a.gl,h=f(c,[0,0,0,1,1,0,1,1]),i=e(c,g.boxVertex,g.boxFragment),j=new d(a,h,i);return j.update(b),a.addOverlay(j),j};var h=d.prototype;h.draw=function(){if(this.enabled){var a=this.plot,b=this.selectBox,c=this.borderWidth,d=(this.innerFill,this.innerColor),e=(this.outerFill,this.outerColor),f=this.borderColor,g=a.box,h=a.screenBox,i=a.dataBox,j=a.viewBox,k=a.pixelRatio,l=(b[0]-i[0])*(j[2]-j[0])/(i[2]-i[0])+j[0],m=(b[1]-i[1])*(j[3]-j[1])/(i[3]-i[1])+j[1],n=(b[2]-i[0])*(j[2]-j[0])/(i[2]-i[0])+j[0],o=(b[3]-i[1])*(j[3]-j[1])/(i[3]-i[1])+j[1];if(l=Math.max(l,j[0]),m=Math.max(m,j[1]),n=Math.min(n,j[2]),o=Math.min(o,j[3]),!(n<l||o<m)){g.bind();var p=h[2]-h[0],q=h[3]-h[1];if(this.outerFill&&(g.drawBox(0,0,p,m,e),g.drawBox(0,m,l,o,e),g.drawBox(0,o,p,q,e),g.drawBox(n,m,p,o,e)),this.innerFill&&g.drawBox(l,m,n,o,d),c>0){var r=c*k;g.drawBox(l-r,m-r,n+r,m+r,f),g.drawBox(l-r,o-r,n+r,o+r,f),g.drawBox(l-r,m-r,l+r,o+r,f),g.drawBox(n-r,m-r,n+r,o+r,f)}}}},h.update=function(a){a=a||{},this.innerFill=!!a.innerFill,this.outerFill=!!a.outerFill,this.innerColor=(a.innerColor||[0,0,0,.5]).slice(),this.outerColor=(a.outerColor||[0,0,0,.5]).slice(),this.borderColor=(a.borderColor||[0,0,0,1]).slice(),this.borderWidth=a.borderWidth||0,this.selectBox=(a.selectBox||this.selectBox).slice()},h.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":299,"gl-buffer":242,"gl-shader":302}],301:[function(a,b,c){"use strict";function d(a,b,c,d,e){this.coord=[a,b],this.id=c,this.value=d,this.distance=e}function e(a,b,c){this.gl=a,this.fbo=b,this.buffer=c,this._readTimeout=null;var d=this;this._readCallback=function(){d.gl&&(b.bind(),a.readPixels(0,0,b.shape[0],b.shape[1],a.RGBA,a.UNSIGNED_BYTE,d.buffer),d._readTimeout=null)}}b.exports=function(a,b){return new e(a,f(a,b),g.mallocUint8(b[0]*b[1]*4))};var f=a("gl-fbo"),g=a("typedarray-pool"),h=a("ndarray"),i=a("bit-twiddle").nextPow2,j=a("cwise/lib/wrapper")({args:["array",{offset:[0,0,1],array:0},{offset:[0,0,2],array:0},{offset:[0,0,3],array:0},"scalar","scalar","index"],pre:{body:"{this_closestD2=1e8,this_closestX=-1,this_closestY=-1}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},body:{body:"{if(_inline_16_arg0_<255||_inline_16_arg1_<255||_inline_16_arg2_<255||_inline_16_arg3_<255){var _inline_16_l=_inline_16_arg4_-_inline_16_arg6_[0],_inline_16_a=_inline_16_arg5_-_inline_16_arg6_[1],_inline_16_f=_inline_16_l*_inline_16_l+_inline_16_a*_inline_16_a;_inline_16_f<this_closestD2&&(this_closestD2=_inline_16_f,this_closestX=_inline_16_arg6_[0],this_closestY=_inline_16_arg6_[1])}}",args:[{name:"_inline_16_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg4_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg5_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg6_",lvalue:!1,rvalue:!0,count:4}],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:["_inline_16_a","_inline_16_f","_inline_16_l"]},post:{body:"{return[this_closestX,this_closestY,this_closestD2]}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},debug:!1,funcName:"cwise",blockSize:64}),k=e.prototype;Object.defineProperty(k,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(a){if(this.gl){this.fbo.shape=a;var b=this.fbo.shape[0],c=this.fbo.shape[1];if(c*b*4>this.buffer.length){g.free(this.buffer);for(var d=this.buffer=g.mallocUint8(i(c*b*4)),e=0;e<c*b*4;++e)d[e]=255}return a}}}),k.begin=function(){var a=this.gl;this.shape,a&&(this.fbo.bind(),a.clearColor(1,1,1,1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT))},k.end=function(){var a=this.gl;a&&(a.bindFramebuffer(a.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},k.query=function(a,b,c){if(!this.gl)return null;var e=this.fbo.shape.slice();a|=0,b|=0,"number"!=typeof c&&(c=1);var f=0|Math.min(Math.max(a-c,0),e[0]),g=0|Math.min(Math.max(a+c,0),e[0]),i=0|Math.min(Math.max(b-c,0),e[1]),k=0|Math.min(Math.max(b+c,0),e[1]);if(g<=f||k<=i)return null;var l=[g-f,k-i],m=h(this.buffer,[l[0],l[1],4],[4,4*e[0],1],4*(f+e[0]*i)),n=j(m.hi(l[0],l[1],1),c,c),o=n[0],p=n[1];return o<0||Math.pow(this.radius,2)<n[2]?null:new d(o+f|0,p+i|0,m.get(o,p,0),[m.get(o,p,1),m.get(o,p,2),m.get(o,p,3)],Math.sqrt(n[2]))},k.dispose=function(){this.gl&&(this.fbo.dispose(),g.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":93,"cwise/lib/wrapper":150,"gl-fbo":250,ndarray:451,"typedarray-pool":546}],302:[function(a,b,c){"use strict";function d(a){this.gl=a,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function e(a,b){return a.name<b.name?-1:1}var f=a("./lib/create-uniforms"),g=a("./lib/create-attributes"),h=a("./lib/reflect"),i=a("./lib/shader-cache"),j=a("./lib/runtime-reflect"),k=a("./lib/GLError"),l=d.prototype;l.bind=function(){var a;this.program||this._relink();var b=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),c=this.gl.lastAttribCount;if(b>c)for(a=c;a<b;a++)this.gl.enableVertexAttribArray(a);else if(c>b)for(a=b;a<c;a++)this.gl.disableVertexAttribArray(a);this.gl.lastAttribCount=b,this.gl.useProgram(this.program)},l.dispose=function(){for(var a=this.gl.lastAttribCount,b=0;b<a;b++)this.gl.disableVertexAttribArray(b);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},l.update=function(a,b,c,d){function l(){n.program=i.program(o,n._vref,n._fref,v,w);for(var a=0;a<c.length;++a)C[a]=o.getUniformLocation(n.program,c[a].name)}if(!b||1===arguments.length){var m=a;a=m.vertex,b=m.fragment,c=m.uniforms,d=m.attributes}var n=this,o=n.gl,p=n._vref;n._vref=i.shader(o,o.VERTEX_SHADER,a),p&&p.dispose(),n.vertShader=n._vref.shader;var q=this._fref;if(n._fref=i.shader(o,o.FRAGMENT_SHADER,b),q&&q.dispose(),n.fragShader=n._fref.shader,!c||!d){var r=o.createProgram();if(o.attachShader(r,n.fragShader),o.attachShader(r,n.vertShader),o.linkProgram(r),!o.getProgramParameter(r,o.LINK_STATUS)){var s=o.getProgramInfoLog(r);throw new k(s,"Error linking program:"+s)}c=c||j.uniforms(o,r),d=d||j.attributes(o,r),o.deleteProgram(r)}(d=d.slice()).sort(e);var t,u=[],v=[],w=[];for(t=0;t<d.length;++t){var x=d[t];if(x.type.indexOf("mat")>=0){for(var y=0|x.type.charAt(x.type.length-1),z=new Array(y),A=0;A<y;++A)z[A]=w.length,v.push(x.name+"["+A+"]"),"number"==typeof x.location?w.push(x.location+A):Array.isArray(x.location)&&x.location.length===y&&"number"==typeof x.location[A]?w.push(0|x.location[A]):w.push(-1);u.push({name:x.name,type:x.type,locations:z})}else u.push({name:x.name,type:x.type,locations:[w.length]}),v.push(x.name),"number"==typeof x.location?w.push(0|x.location):w.push(-1)}var B=0;for(t=0;t<w.length;++t)if(w[t]<0){for(;w.indexOf(B)>=0;)B+=1;w[t]=B}var C=new Array(c.length);l(),n._relink=l,n.types={uniforms:h(c),attributes:h(d)},n.attributes=g(o,n,u,w),Object.defineProperty(n,"uniforms",f(o,n,c,C))},b.exports=function(a,b,c,e,f){var g=new d(a);return g.update(b,c,e,f),g}},{"./lib/GLError":303,"./lib/create-attributes":304,"./lib/create-uniforms":305,"./lib/reflect":306,"./lib/runtime-reflect":307,"./lib/shader-cache":308}],303:[function(a,b,c){function d(a,b,c){this.shortMessage=b||"",this.longMessage=c||"",this.rawError=a||"",this.message="gl-shader: "+(b||a||"")+(c?"\n"+c:""),this.stack=(new Error).stack}d.prototype=new Error,d.prototype.name="GLError",d.prototype.constructor=d,b.exports=d},{}],304:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){this._gl=a,this._wrapper=b,this._index=c,this._locations=d,this._dimension=e,this._constFunc=f}function e(a,b,c,e,f,g,h){for(var i=["gl","v"],j=[],k=0;k<f;++k)i.push("x"+k),j.push("x"+k);i.push("if(x0.length===void 0){return gl.vertexAttrib"+f+"f(v,"+j.join()+")}else{return gl.vertexAttrib"+f+"fv(v,x0)}");var l=Function.apply(null,i),m=new d(a,b,c,e,f,l);Object.defineProperty(g,h,{set:function(b){return a.disableVertexAttribArray(e[c]),l(a,e[c],b),b},get:function(){return m},enumerable:!0})}function f(a,b,c,d,f,g,h){for(var i=new Array(f),j=new Array(f),k=0;k<f;++k)e(a,b,c[k],d,f,i,k),j[k]=i[k];Object.defineProperty(i,"location",{set:function(a){if(Array.isArray(a))for(var b=0;b<f;++b)j[b].location=a[b];else for(b=0;b<f;++b)j[b].location=a+b;return a},get:function(){for(var a=new Array(f),b=0;b<f;++b)a[b]=d[c[b]];return a},enumerable:!0}),i.pointer=function(b,e,g,h){b=b||a.FLOAT,e=!!e,g=g||f*f,h=h||0;for(var i=0;i<f;++i){var j=d[c[i]];a.vertexAttribPointer(j,f,b,e,g,h+i*f),a.enableVertexAttribArray(j)}};var l=new Array(f),m=a["vertexAttrib"+f+"fv"];Object.defineProperty(g,h,{set:function(b){for(var e=0;e<f;++e){var g=d[c[e]];if(a.disableVertexAttribArray(g),Array.isArray(b[0]))m.call(a,g,b[e]);else{for(var h=0;h<f;++h)l[h]=b[f*e+h];m.call(a,g,l)}}return b},get:function(){return i},enumerable:!0})}b.exports=function(a,b,c,d){for(var h={},i=0,j=c.length;i<j;++i){var k=c[i],l=k.name,m=k.type,n=k.locations;switch(m){case"bool":case"int":case"float":e(a,b,n[0],d,1,h,l);break;default:if(m.indexOf("vec")>=0){var o=m.charCodeAt(m.length-1)-48;if(o<2||o>4)throw new g("","Invalid data type for attribute "+l+": "+m);e(a,b,n[0],d,o,h,l)}else{if(!(m.indexOf("mat")>=0))throw new g("","Unknown data type for attribute "+l+": "+m);var o=m.charCodeAt(m.length-1)-48;if(o<2||o>4)throw new g("","Invalid data type for attribute "+l+": "+m);f(a,b,n,d,o,h,l)}}}return h};var g=a("./GLError"),h=d.prototype;h.pointer=function(a,b,c,d){var e=this._gl,f=this._locations[this._index];e.vertexAttribPointer(f,this._dimension,a||e.FLOAT,!!b,c||0,d||0),e.enableVertexAttribArray(f)},h.set=function(a,b,c,d){return this._constFunc(this._locations[this._index],a,b,c,d)},Object.defineProperty(h,"location",{get:function(){return this._locations[this._index]},set:function(a){return a!==this._locations[this._index]&&(this._locations[this._index]=0|a,this._wrapper.program=null),0|a}})},{"./GLError":303}],305:[function(a,b,c){"use strict";function d(a){return new Function("y","return function(){return y}")(a)}function e(a,b){for(var c=new Array(a),d=0;d<a;++d)c[d]=b;return c}var f=a("./reflect"),g=a("./GLError");b.exports=function(a,b,c,h){function i(a,b,c){switch(c){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+b+"],obj"+a+")";case"float":return"gl.uniform1f(locations["+b+"],obj"+a+")";default:var d=c.indexOf("vec");if(!(0<=d&&d<=1&&c.length===4+d)){if(0===c.indexOf("mat")&&4===c.length){var e=c.charCodeAt(c.length-1)-48;if(e<2||e>4)throw new g("","Invalid uniform dimension type for matrix "+name+": "+c);return"gl.uniformMatrix"+e+"fv(locations["+b+"],false,obj"+a+")"}
throw new g("","Unknown uniform data type for "+name+": "+c)}var e=c.charCodeAt(c.length-1)-48;if(e<2||e>4)throw new g("","Invalid data type");switch(c.charAt(0)){case"b":case"i":return"gl.uniform"+e+"iv(locations["+b+"],obj"+a+")";case"v":return"gl.uniform"+e+"fv(locations["+b+"],obj"+a+")";default:throw new g("","Unrecognized data type for vector "+name+": "+c)}}}function j(b){for(var d=["return function updateProperty(obj){"],e=function a(b,c){if("object"!=typeof c)return[[b,c]];var d=[];for(var e in c){var f=c[e],g=b;parseInt(e)+""===e?g+="["+e+"]":g+="."+e,"object"==typeof f?d.push.apply(d,a(g,f)):d.push([g,f])}return d}("",b),f=0;f<e.length;++f){var g=e[f],j=g[0],k=g[1];h[k]&&d.push(i(j,k,c[k].type))}return d.push("return obj}"),new Function("gl","locations",d.join("\n"))(a,h)}function k(f,i,k){if("object"==typeof k){var m=l(k);Object.defineProperty(f,i,{get:d(m),set:j(k),enumerable:!0,configurable:!1})}else h[k]?Object.defineProperty(f,i,{get:(n=k,new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+n+"])}")(a,b,h)),set:j(k),enumerable:!0,configurable:!1}):f[i]=function(a){switch(a){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var b=a.indexOf("vec");if(0<=b&&b<=1&&a.length===4+b){var c=a.charCodeAt(a.length-1)-48;if(c<2||c>4)throw new g("","Invalid data type");return"b"===a.charAt(0)?e(c,!1):e(c,0)}if(0===a.indexOf("mat")&&4===a.length){var c=a.charCodeAt(a.length-1)-48;if(c<2||c>4)throw new g("","Invalid uniform dimension type for matrix "+name+": "+a);return e(c*c,0)}throw new g("","Unknown uniform data type for "+name+": "+a)}}(c[k].type);var n}function l(a){var b;if(Array.isArray(a)){b=new Array(a.length);for(var c=0;c<a.length;++c)k(b,c,a[c])}else for(var d in b={},a)k(b,d,a[d]);return b}var m=f(c,!0);return{get:d(l(m)),set:j(m),enumerable:!0,configurable:!0}}},{"./GLError":303,"./reflect":306}],306:[function(a,b,c){"use strict";b.exports=function(a,b){for(var c={},d=0;d<a.length;++d)for(var e=a[d].name,f=e.split("."),g=c,h=0;h<f.length;++h){var i=f[h].split("[");if(i.length>1){i[0]in g||(g[i[0]]=[]),g=g[i[0]];for(var j=1;j<i.length;++j){var k=parseInt(i[j]);j<i.length-1||h<f.length-1?(k in g||(j<i.length-1?g[k]=[]:g[k]={}),g=g[k]):g[k]=b?d:a[d].type}}else h<f.length-1?(i[0]in g||(g[i[0]]={}),g=g[i[0]]):g[i[0]]=b?d:a[d].type}return c}},{}],307:[function(a,b,c){"use strict";function d(a,b){if(!f){var c=Object.keys(e);f={};for(var d=0;d<c.length;++d){var g=c[d];f[a[g]]=e[g]}}return f[b]}c.uniforms=function(a,b){for(var c=a.getProgramParameter(b,a.ACTIVE_UNIFORMS),e=[],f=0;f<c;++f){var g=a.getActiveUniform(b,f);if(g){var h=d(a,g.type);if(g.size>1)for(var i=0;i<g.size;++i)e.push({name:g.name.replace("[0]","["+i+"]"),type:h});else e.push({name:g.name,type:h})}}return e},c.attributes=function(a,b){for(var c=a.getProgramParameter(b,a.ACTIVE_ATTRIBUTES),e=[],f=0;f<c;++f){var g=a.getActiveAttrib(b,f);g&&e.push({name:g.name,type:d(a,g.type)})}return e};var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},f=null},{}],308:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g){this.id=a,this.src=b,this.type=c,this.shader=d,this.count=f,this.programs=[],this.cache=g}function e(a){this.gl=a,this.shaders=[{},{}],this.programs={}}function f(a){var b=i.get(a);return b||(b=new e(a),i.set(a,b)),b}c.shader=function(a,b,c){return f(a).getShaderReference(b,c)},c.program=function(a,b,c,d,e){return f(a).getProgram(b,c,d,e)};var g=a("./GLError"),h=a("gl-format-compiler-error"),i=new("undefined"==typeof WeakMap?a("weakmap-shim"):WeakMap),j=0;d.prototype.dispose=function(){if(0==--this.count){for(var a=this.cache,b=a.gl,c=this.programs,d=0,e=c.length;d<e;++d){var f=a.programs[c[d]];f&&(delete a.programs[d],b.deleteProgram(f))}b.deleteShader(this.shader),delete a.shaders[this.type===b.FRAGMENT_SHADER|0][this.src]}};var k=e.prototype;k.getShaderReference=function(a,b){var c=this.gl,e=this.shaders[a===c.FRAGMENT_SHADER|0],f=e[b];if(f&&c.isShader(f.shader))f.count+=1;else{var i=function(a,b,c){var d=a.createShader(b);if(a.shaderSource(d,c),a.compileShader(d),!a.getShaderParameter(d,a.COMPILE_STATUS)){var e=a.getShaderInfoLog(d);try{var f=h(e,c,b)}catch(a){throw console.warn("Failed to format compiler error: "+a),new g(e,"Error compiling shader:\n"+e)}throw new g(e,f.short,f.long)}return d}(c,a,b);f=e[b]=new d(j++,b,a,i,[],1,this)}return f},k.getProgram=function(a,b,c,d){var e=[a.id,b.id,c.join(":"),d.join(":")].join("@"),f=this.programs[e];return f&&this.gl.isProgram(f)||(this.programs[e]=f=function(a,b,c,d,e){var f=a.createProgram();a.attachShader(f,b),a.attachShader(f,c);for(var h=0;h<d.length;++h)a.bindAttribLocation(f,e[h],d[h]);if(a.linkProgram(f),!a.getProgramParameter(f,a.LINK_STATUS)){var i=a.getProgramInfoLog(f);throw new g(i,"Error linking program: "+i)}return f}(this.gl,a.shader,b.shader,c,d),a.programs.push(e),b.programs.push(e)),f}},{"./GLError":303,"gl-format-compiler-error":251,"weakmap-shim":556}],309:[function(a,b,c){"use strict";function d(a){this.plot=a,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}b.exports=function(a,b){var c=new d(a);return c.update(b),a.addOverlay(c),c};var e=d.prototype;e.update=function(a){a=a||{},this.enable=(a.enable||[!0,!0,!1,!1]).slice(),this.width=(a.width||[1,1,1,1]).slice(),this.color=(a.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(a){return a.slice()}),this.center=(a.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},e.draw=function(){var a=this.enable,b=this.width,c=this.color,d=this.center,e=this.plot,f=e.line,g=e.dataBox,h=e.viewBox;if(f.bind(),g[0]<=d[0]&&d[0]<=g[2]&&g[1]<=d[1]&&d[1]<=g[3]){var i=h[0]+(d[0]-g[0])/(g[2]-g[0])*(h[2]-h[0]),j=h[1]+(d[1]-g[1])/(g[3]-g[1])*(h[3]-h[1]);a[0]&&f.drawLine(i,j,h[0],j,b[0],c[0]),a[1]&&f.drawLine(i,j,i,h[1],b[1],c[1]),a[2]&&f.drawLine(i,j,h[2],j,b[2],c[2]),a[3]&&f.drawLine(i,j,i,h[3],b[3],c[3])}},e.dispose=function(){this.plot.removeOverlay(this)}},{}],310:[function(a,b,c){"use strict";var d=a("glslify"),e=a("gl-shader"),f=d(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]),g=d(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);b.exports=function(a){return e(a,f,g,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":302,glslify:410}],311:[function(a,b,c){"use strict";function d(a,b,c,d){this.gl=a,this.buffer=b,this.vao=c,this.shader=d,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var e=a("gl-buffer"),f=a("gl-vao"),g=a("./shaders/index");b.exports=function(a,b){function c(a,b,c,d,e,f){var g=[a,b,c,0,0,0,1];g[d+3]=1,g[d]=e,h.push.apply(h,g),g[6]=-1,h.push.apply(h,g),g[d]=f,h.push.apply(h,g),h.push.apply(h,g),g[6]=1,h.push.apply(h,g),g[d]=e,h.push.apply(h,g)}var h=[];c(0,0,0,0,0,1),c(0,0,0,1,0,1),c(0,0,0,2,0,1),c(1,0,0,1,-1,1),c(1,0,0,2,-1,1),c(0,1,0,0,-1,1),c(0,1,0,2,-1,1),c(0,0,1,0,-1,1),c(0,0,1,1,-1,1);var i=e(a,h),j=f(a,[{type:a.FLOAT,buffer:i,size:3,offset:0,stride:28},{type:a.FLOAT,buffer:i,size:3,offset:12,stride:28},{type:a.FLOAT,buffer:i,size:1,offset:24,stride:28}]),k=g(a);k.attributes.position.location=0,k.attributes.color.location=1,k.attributes.weight.location=2;var l=new d(a,i,j,k);return l.update(b),l};var h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=d.prototype,j=[0,0,0],k=[0,0,0],l=[0,0];i.isTransparent=function(){return!1},i.drawTransparent=function(a){},i.draw=function(a){var b=this.gl,c=this.vao,d=this.shader;c.bind(),d.bind();var e,f=a.model||h,g=a.view||h,i=a.projection||h;this.axes&&(e=this.axes.lastCubeProps.axis);for(var m=j,n=k,o=0;o<3;++o)e&&e[o]<0?(m[o]=this.bounds[0][o],n[o]=this.bounds[1][o]):(m[o]=this.bounds[1][o],n[o]=this.bounds[0][o]);for(l[0]=b.drawingBufferWidth,l[1]=b.drawingBufferHeight,d.uniforms.model=f,d.uniforms.view=g,d.uniforms.projection=i,d.uniforms.coordinates=[this.position,m,n],d.uniforms.colors=this.colors,d.uniforms.screenShape=l,o=0;o<3;++o)d.uniforms.lineWidth=this.lineWidth[o]*this.pixelRatio,this.enabled[o]&&(c.draw(b.TRIANGLES,6,6*o),this.drawSides[o]&&c.draw(b.TRIANGLES,12,18+12*o));c.unbind()},i.update=function(a){a&&("bounds"in a&&(this.bounds=a.bounds),"position"in a&&(this.position=a.position),"lineWidth"in a&&(this.lineWidth=a.lineWidth),"colors"in a&&(this.colors=a.colors),"enabled"in a&&(this.enabled=a.enabled),"drawSides"in a&&(this.drawSides=a.drawSides))},i.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":310,"gl-buffer":242,"gl-vao":328}],312:[function(a,b,c){var d=a("glslify"),e=d(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\nuniform float vectorScale;\nuniform float tubeScale;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * tubePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal,0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(tubePosition, 1.0);\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),f=d(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),g=d(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),h=d(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);c.meshShader={vertex:e,fragment:f,attributes:[{name:"position",type:"vec4"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},c.pickShader={vertex:g,fragment:h,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:410}],313:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w,x,y){this.gl=a,this.cells=[],this.positions=[],this.intensity=[],this.texture=b,this.dirty=!0,this.triShader=c,this.pickShader=d,this.trianglePositions=e,this.triangleVectors=f,this.triangleColors=h,this.triangleNormals=j,this.triangleUVs=i,this.triangleIds=g,this.triangleVAO=k,this.triangleCount=0,this.lineWidth=1,this.edgePositions=l,this.edgeColors=n,this.edgeUVs=o,this.edgeIds=m,this.edgeVAO=p,this.edgeCount=0,this.pointPositions=q,this.pointColors=s,this.pointUVs=u,this.pointSizes=v,this.pointIds=r,this.pointVAO=w,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=x,this.contourVAO=y,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!1,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.tubeScale=1,this._model=t,this._view=t,this._projection=t,this._resolution=[1,1],this.pixelRatio=1}function e(a){var b=f(a,s.vertex,s.fragment,null,s.attributes);return b.attributes.position.location=0,b.attributes.id.location=1,b.attributes.vector.location=5,b}var f=a("gl-shader"),g=a("gl-buffer"),h=a("gl-vao"),i=a("gl-texture2d"),j=a("normals"),k=a("gl-mat4/multiply"),l=a("gl-mat4/invert"),m=a("ndarray"),n=a("colormap"),o=a("simplicial-complex-contour"),p=a("typedarray-pool"),q=a("./shaders"),r=q.meshShader,s=q.pickShader,t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=d.prototype;u.isOpaque=function(){return this.opacity>=1},u.isTransparent=function(){return this.opacity<1},u.pickSlots=1,u.setPickBase=function(a){this.pickId=a},u.highlight=function(a){if(a&&this.contourEnable){for(var b=o(this.cells,this.intensity,a.intensity),c=b.cells,d=b.vertexIds,e=b.vertexWeights,f=c.length,g=p.mallocFloat32(6*f),h=0,i=0;i<f;++i)for(var j=c[i],k=0;k<2;++k){var l=j[0];2===j.length&&(l=j[k]);for(var m=d[l][0],n=d[l][1],q=e[l],r=1-q,s=this.positions[m],t=this.positions[n],u=0;u<3;++u)g[h++]=q*s[u]+r*t[u]}this.contourCount=h/3|0,this.contourPositions.update(g.subarray(0,h)),p.free(g)}else this.contourCount=0},u.update=function(a){a=a||{};var b=this.gl;this.dirty=!0,"contourEnable"in a&&(this.contourEnable=a.contourEnable),"contourColor"in a&&(this.contourColor=a.contourColor),"lineWidth"in a&&(this.lineWidth=a.lineWidth),"lightPosition"in a&&(this.lightPosition=a.lightPosition),"opacity"in a&&(this.opacity=a.opacity),"ambient"in a&&(this.ambientLight=a.ambient),"diffuse"in a&&(this.diffuseLight=a.diffuse),"specular"in a&&(this.specularLight=a.specular),"roughness"in a&&(this.roughness=a.roughness),"fresnel"in a&&(this.fresnel=a.fresnel),a.texture?(this.texture.dispose(),this.texture=i(b,a.texture)):a.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=b.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=b.LINEAR,this.texture.setPixels(function(a){for(var b=n({colormap:a,nshades:256,format:"rgba"}),c=new Uint8Array(1024),d=0;d<256;++d){for(var e=b[d],f=0;f<3;++f)c[4*d+f]=e[f];c[4*d+3]=255*e[3]}return m(c,[256,256,4],[4,0,1])}(a.colormap)),this.texture.generateMipmap());var c=a.cells,d=a.positions,e=a.vectors;if(d&&c&&e){void 0!==a.tubeScale&&(this.tubeScale=a.tubeScale);var f=[],g=[],h=[],k=[],l=[],o=[],p=[],q=[],r=[],s=[],t=[],u=[],v=[],w=[],x=[];this.cells=c,this.positions=d,this.vectors=e;var y=a.vertexNormals,z=a.cellNormals,A=void 0===a.vertexNormalsEpsilon?1e-6:a.vertexNormalsEpsilon,B=void 0===a.faceNormalsEpsilon?1e-6:a.faceNormalsEpsilon;a.useFacetNormals&&!z&&(z=j.faceNormals(c,d,B)),z||y||(y=j.vertexNormals(c,d,A));var C=a.vertexColors,D=a.cellColors,E=a.meshColor||[1,1,1,1],F=a.vertexUVs,G=a.vertexIntensity,H=a.cellUVs,I=a.cellIntensity,J=1/0,K=-1/0;if(!F&&!H)if(G)if(a.vertexIntensityBounds)J=+a.vertexIntensityBounds[0],K=+a.vertexIntensityBounds[1];else for(var L=0;L<G.length;++L){var M=G[L];J=Math.min(J,M),K=Math.max(K,M)}else if(I)for(L=0;L<I.length;++L)M=I[L],J=Math.min(J,M),K=Math.max(K,M);else for(L=0;L<d.length;++L)M=d[L][2],J=Math.min(J,M),K=Math.max(K,M);this.intensity=G||(I?function(a,b,c){for(var d=new Array(b),e=0;e<b;++e)d[e]=0;var f=a.length;for(e=0;e<f;++e)for(var g=a[e],h=0;h<g.length;++h)d[g[h]]=c[e];return d}(c,d.length,I):function(a){for(var b=a.length,c=new Array(b),d=0;d<b;++d)c[d]=a[d][2];return c}(d));var N=a.pointSizes,O=a.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],L=0;L<d.length;++L)for(var P=d[L],Q=0;Q<3;++Q)!isNaN(P[Q])&&isFinite(P[Q])&&(this.bounds[0][Q]=Math.min(this.bounds[0][Q],P[Q]),this.bounds[1][Q]=Math.max(this.bounds[1][Q],P[Q]));var R=0,S=0,T=0;a:for(L=0;L<c.length;++L){var U=c[L];switch(U.length){case 1:for(P=d[W=U[0]],Q=0;Q<3;++Q)if(isNaN(P[Q])||!isFinite(P[Q]))continue a;t.push(P[0],P[1],P[2],P[3]),3===(X=C?C[W]:D?D[L]:E).length?u.push(X[0],X[1],X[2],1):u.push(X[0],X[1],X[2],X[3]),Y=F?F[W]:G?[(G[W]-J)/(K-J),0]:H?H[L]:I?[(I[L]-J)/(K-J),0]:[(P[2]-J)/(K-J),0],v.push(Y[0],Y[1]),N?w.push(N[W]):w.push(O),x.push(L),T+=1;break;case 2:for(Q=0;Q<2;++Q){P=d[W=U[Q]];for(var V=0;V<3;++V)if(isNaN(P[V])||!isFinite(P[V]))continue a}for(Q=0;Q<2;++Q)P=d[W=U[Q]],p.push(P[0],P[1],P[2]),3===(X=C?C[W]:D?D[L]:E).length?q.push(X[0],X[1],X[2],1):q.push(X[0],X[1],X[2],X[3]),Y=F?F[W]:G?[(G[W]-J)/(K-J),0]:H?H[L]:I?[(I[L]-J)/(K-J),0]:[(P[2]-J)/(K-J),0],r.push(Y[0],Y[1]),s.push(L);S+=1;break;case 3:for(Q=0;Q<3;++Q)for(P=d[W=U[Q]],V=0;V<3;++V)if(isNaN(P[V])||!isFinite(P[V]))continue a;for(Q=0;Q<3;++Q){var W;P=d[W=U[2-Q]],f.push(P[0],P[1],P[2],P[3]);var X,Y,Z,$=e[W];g.push($[0],$[1],$[2],$[3]),3===(X=C?C[W]:D?D[L]:E).length?h.push(X[0],X[1],X[2],1):h.push(X[0],X[1],X[2],X[3]),Y=F?F[W]:G?[(G[W]-J)/(K-J),0]:H?H[L]:I?[(I[L]-J)/(K-J),0]:[(P[2]-J)/(K-J),0],l.push(Y[0],Y[1]),Z=y?y[W]:z[L],k.push(Z[0],Z[1],Z[2]),o.push(L)}R+=1}}this.pointCount=T,this.edgeCount=S,this.triangleCount=R,this.pointPositions.update(t),this.pointColors.update(u),this.pointUVs.update(v),this.pointSizes.update(w),this.pointIds.update(new Uint32Array(x)),this.edgePositions.update(p),this.edgeColors.update(q),this.edgeUVs.update(r),this.edgeIds.update(new Uint32Array(s)),this.trianglePositions.update(f),this.triangleVectors.update(g),this.triangleColors.update(h),this.triangleUVs.update(l),this.triangleNormals.update(k),this.triangleIds.update(new Uint32Array(o))}},u.drawTransparent=u.draw=function(a){a=a||{};for(var b=this.gl,c=a.model||t,d=a.view||t,e=a.projection||t,f=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],g=0;g<3;++g)f[0][g]=Math.max(f[0][g],this.clipBounds[0][g]),f[1][g]=Math.min(f[1][g],this.clipBounds[1][g]);var h={model:c,view:d,projection:e,inverseModel:t.slice(),clipBounds:f,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,contourColor:this.contourColor,texture:0};h.inverseModel=l(h.inverseModel,h.model),b.disable(b.CULL_FACE),this.texture.bind(0);var i=new Array(16);for(k(i,h.view,h.model),k(i,h.projection,i),l(i,i),g=0;g<3;++g)h.eyePosition[g]=i[12+g]/i[15];var j=i[15];for(g=0;g<3;++g)j+=this.lightPosition[g]*i[4*g+3];for(g=0;g<3;++g){for(var m=i[12+g],n=0;n<3;++n)m+=i[4*n+g]*this.lightPosition[n];h.lightPosition[g]=m/j}if(this.triangleCount>0){var o=this.triShader;o.bind(),o.uniforms=h,this.triangleVAO.bind(),b.drawArrays(b.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},u.drawPick=function(a){a=a||{};for(var b=this.gl,c=a.model||t,d=a.view||t,e=a.projection||t,f=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],g=0;g<3;++g)f[0][g]=Math.max(f[0][g],this.clipBounds[0][g]),f[1][g]=Math.min(f[1][g],this.clipBounds[1][g]);this._model=[].slice.call(c),this._view=[].slice.call(d),this._projection=[].slice.call(e),this._resolution=[b.drawingBufferWidth,b.drawingBufferHeight];var h={model:c,view:d,projection:e,clipBounds:f,tubeScale:this.tubeScale,pickId:this.pickId/255},i=this.pickShader;i.bind(),i.uniforms=h,this.triangleCount>0&&(this.triangleVAO.bind(),b.drawArrays(b.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),b.lineWidth(this.lineWidth*this.pixelRatio),b.drawArrays(b.LINES,0,2*this.edgeCount),this.edgeVAO.unbind())},u.pick=function(a){if(!a)return null;if(a.id!==this.pickId)return null;var b=a.value[0]+256*a.value[1]+65536*a.value[2],c=this.cells[b],d=this.positions[c[1]].slice(0,3);return{index:b,position:d,intensity:this.intensity[c[1]],velocity:this.vectors[c[1]].slice(0,3),divergence:this.vectors[c[1]][3],dataCoordinate:d}},u.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose()},b.exports=function(a,b){1===arguments.length&&(a=(b=a).gl);var c=b.triShader||function(a){var b=f(a,r.vertex,r.fragment,null,r.attributes);return b.attributes.position.location=0,b.attributes.color.location=2,b.attributes.uv.location=3,b.attributes.vector.location=5,b}(a),j=e(a),k=i(a,m(new Uint8Array([255,255,255,255]),[1,1,4]));k.generateMipmap(),k.minFilter=a.LINEAR_MIPMAP_LINEAR,k.magFilter=a.LINEAR;var l=g(a),n=g(a),o=g(a),p=g(a),q=g(a),s=g(a),t=h(a,[{buffer:l,type:a.FLOAT,size:4},{buffer:s,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:o,type:a.FLOAT,size:4},{buffer:p,type:a.FLOAT,size:2},{buffer:q,type:a.FLOAT,size:3},{buffer:n,type:a.FLOAT,size:4}]),u=g(a),v=g(a),w=g(a),x=g(a),y=h(a,[{buffer:u,type:a.FLOAT,size:3},{buffer:x,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:v,type:a.FLOAT,size:4},{buffer:w,type:a.FLOAT,size:2}]),z=g(a),A=g(a),B=g(a),C=g(a),D=g(a),E=h(a,[{buffer:z,type:a.FLOAT,size:3},{buffer:D,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:A,type:a.FLOAT,size:4},{buffer:B,type:a.FLOAT,size:2},{buffer:C,type:a.FLOAT,size:1}]),F=g(a),G=new d(a,k,c,j,l,n,s,o,p,q,t,u,x,v,w,y,z,D,A,B,C,E,F,h(a,[{buffer:F,type:a.FLOAT,size:3}]));return G.update(b),G}},{"./shaders":312,colormap:127,"gl-buffer":242,"gl-mat4/invert":266,"gl-mat4/multiply":268,"gl-shader":302,"gl-texture2d":323,"gl-vao":328,ndarray:451,normals:454,"simplicial-complex-contour":519,"typedarray-pool":546}],314:[function(a,b,c){"use strict";var d=a("gl-vec3"),e=a("gl-vec4"),f=function(a,b,c,f){for(var g=0,h=0;h<a.length;h++)for(var i=a[h].velocities,j=0;j<i.length;j++){var k=d.length(i[j]);k>g&&(g=k)}var l=a.map(function(a){return function(a,b,c,f){var g,h,i,j=a.points,k=a.velocities,l=a.divergences;d.set(d.create(),0,1,0),d.create(),d.create(),d.create();for(var m=[],n=[],o=[],p=[],q=[],r=[],s=0,t=0,u=e.create(),v=e.create(),w=0;w<j.length;w++){g=j[w],h=k[w],i=l[w],0===b&&(i=.05*c),t=d.length(h)/f,u=e.create(),d.copy(u,h),u[3]=i;for(var x=0;x<8;x++)q[x]=[g[0],g[1],g[2],x];if(p.length>0)for(x=0;x<8;x++){var y=(x+1)%8;m.push(p[x],q[x],q[y],q[y],p[y],p[x]),o.push(v,u,u,u,v,v),r.push(s,t,t,t,s,s),n.push([m.length-6,m.length-5,m.length-4],[m.length-3,m.length-2,m.length-1])}var z=p;p=q,q=z,z=v,v=u,u=z,z=s,s=t,t=z}return{positions:m,cells:n,vectors:o,vertexIntensity:r}}(a,c,f,g)}),m=[],n=[],o=[],p=[];for(h=0;h<l.length;h++){var q=l[h],r=m.length;for(m=m.concat(q.positions),o=o.concat(q.vectors),p=p.concat(q.vertexIntensity),j=0;j<q.cells.length;j++){var s=q.cells[j],t=[];n.push(t);for(var u=0;u<s.length;u++)t.push(s[u]+r)}}return{positions:m,cells:n,vectors:o,vertexIntensity:p,colormap:b}},g=function(a,b){var c=d.create(),e=1e-4;d.add(c,a,[e,0,0]);var f=this.getVelocity(c);d.subtract(f,f,b),d.scale(f,f,1e4),d.add(c,a,[0,e,0]);var g=this.getVelocity(c);d.subtract(g,g,b),d.scale(g,g,1e4),d.add(c,a,[0,0,e]);var h=this.getVelocity(c);return d.subtract(h,h,b),d.scale(h,h,1e4),d.add(c,f,g),d.add(c,c,h),c},h=function(a){return m(a,this.vectors,this.meshgrid,this.clampBorders)},i=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d===b)return c;if(d>b)return c-1}return c},j=d.create(),k=d.create(),l=function(a,b,c){return a<b?b:a>c?c:a},m=function(a,b,c,e){var f=a[0],g=a[1],h=a[2],m=c[0].length,n=c[1].length,o=c[2].length,p=i(c[0],f),q=i(c[1],g),r=i(c[2],h),s=p+1,t=q+1,u=r+1;if(c[0][p]===f&&(s=p),c[1][q]===g&&(t=q),c[2][r]===h&&(u=r),e&&(p=l(p,0,m-1),s=l(s,0,m-1),q=l(q,0,n-1),t=l(t,0,n-1),r=l(r,0,o-1),u=l(u,0,o-1)),p<0||q<0||r<0||s>=m||t>=n||u>=o)return d.create();var v=(f-c[0][p])/(c[0][s]-c[0][p]),w=(g-c[1][q])/(c[1][t]-c[1][q]),x=(h-c[2][r])/(c[2][u]-c[2][r]);(v<0||v>1||isNaN(v))&&(v=0),(w<0||w>1||isNaN(w))&&(w=0),(x<0||x>1||isNaN(x))&&(x=0);var y=r*m*n,z=u*m*n,A=q*m,B=t*m,C=p,D=s,E=b[A+y+C],F=b[A+y+D],G=b[B+y+C],H=b[B+y+D],I=b[A+z+C],J=b[A+z+D],K=b[B+z+C],L=b[B+z+D],M=d.create();return d.lerp(M,E,F,v),d.lerp(j,G,H,v),d.lerp(M,M,j,w),d.lerp(j,I,J,v),d.lerp(k,K,L,v),d.lerp(j,j,k,w),d.lerp(M,M,j,x),M},n=function(a){var b=1/0;a.sort(function(a,b){return a-b});for(var c=1;c<a.length;c++){var d=Math.abs(a[c]-a[c-1]);d<b&&(b=d)}return b};b.exports=function(a,b){var c=a.startingPositions,e=a.maxLength||1e3,i=a.tubeSize||1,j=a.absoluteTubeSize;a.getDivergence||(a.getDivergence=g),a.getVelocity||(a.getVelocity=h),
void 0===a.clampBorders&&(a.clampBorders=!0);var k=[],l=b[0][0],m=b[0][1],o=b[0][2],p=b[1][0],q=b[1][1],r=b[1][2],s=10*d.distance(b[0],b[1])/e,t=s*s,u=1,v=0;d.create(),c.length>=2&&(u=function(a){for(var b=[],c=[],d=[],e={},f={},g={},h=0;h<a.length;h++){var i=a[h],j=i[0],k=i[1],l=i[2];e[j]||(b.push(j),e[j]=!0),f[k]||(c.push(k),f[k]=!0),g[l]||(d.push(l),g[l]=!0)}var m=n(b),o=n(c),p=n(d),q=Math.min(m,o,p);return isFinite(q)?q:1}(c));for(var w=0;w<c.length;w++){var x=d.create();d.copy(x,c[w]);var y=[x],z=[],A=a.getVelocity(x),B=x;z.push(A);var C=[],D=a.getDivergence(x,A);(H=d.length(D))>v&&!isNaN(H)&&isFinite(H)&&(v=H),C.push(H),k.push({points:y,velocities:z,divergences:C});for(var E=0;E<100*e&&y.length<e&&function(a,b){var c=b[0],d=b[1],e=b[2];return c>=l&&c<=p&&d>=m&&d<=q&&e>=o&&e<=r}(0,x);){E++;var F=d.clone(A),G=d.squaredLength(F);if(0===G)break;G>t&&d.scale(F,F,s/Math.sqrt(G)),d.add(F,F,x),A=a.getVelocity(F),d.squaredDistance(B,F)-t>-1e-4*t&&(y.push(F),B=F,z.push(A),D=a.getDivergence(F,A),(H=d.length(D))>v&&!isNaN(H)&&isFinite(H)&&(v=H),C.push(H)),x=F}}for(w=0;w<C.length;w++){var H=C[w];!isNaN(H)&&isFinite(H)||(C[w]=v)}var I=f(k,a.colormap,v,u);return j?I.tubeScale=j:(0===v&&(v=1),I.tubeScale=.5*i*u/v),I},b.exports.createTubeMesh=a("./lib/tubemesh")},{"./lib/tubemesh":313,"gl-vec3":347,"gl-vec4":383}],315:[function(a,b,c){var d=a("gl-shader"),e=a("glslify"),f=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]),g=e(["precision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color  in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]),h=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]),i=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);c.createShader=function(a){var b=d(a,f,g,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return b.attributes.uv.location=0,b.attributes.f.location=1,b.attributes.normal.location=2,b},c.createPickShader=function(a){var b=d(a,f,i,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return b.attributes.uv.location=0,b.attributes.f.location=1,b.attributes.normal.location=2,b},c.createContourShader=function(a){var b=d(a,h,g,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return b.attributes.uv.location=0,b.attributes.f.location=1,b},c.createPickContourShader=function(a){var b=d(a,h,i,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return b.attributes.uv.location=0,b.attributes.f.location=1,b}},{"gl-shader":302,glslify:410}],316:[function(a,b,c){arguments[4][112][0].apply(c,arguments)},{dup:112}],317:[function(a,b,c){"use strict";function d(a,b,c,d,e){this.position=a,this.index=b,this.uv=c,this.level=d,this.dataCoordinate=e}function e(a,b,c,e,f,g,h,i,j,k,l,m,n,p,q){this.gl=a,this.shape=b,this.bounds=c,this.objectOffset=q,this.intensityBounds=[],this._shader=e,this._pickShader=f,this._coordinateBuffer=g,this._vao=h,this._colorMap=i,this._contourShader=j,this._contourPickShader=k,this._contourBuffer=l,this._contourVAO=m,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new d([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=n,this._dynamicVAO=p,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[s(o.mallocFloat(1024),[0,0]),s(o.mallocFloat(1024),[0,0]),s(o.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}function f(a,b){var c,d,e,f=b.axes&&b.axes.lastCubeProps.axis||J,g=b.showSurface,h=b.showContour;for(c=0;c<3;++c)for(g=g||b.surfaceProject[c],d=0;d<3;++d)h=h||b.contourProject[c][d];for(c=0;c<3;++c){var i=K.projections[c];for(d=0;d<16;++d)i[d]=0;for(d=0;d<4;++d)i[5*d]=1;i[5*c]=0,i[12+c]=b.axesBounds[+(f[c]>0)][c],u(i,a.model,i);var j=K.clipBounds[c];for(e=0;e<2;++e)for(d=0;d<3;++d)j[e][d]=a.clipBounds[e][d];j[0][c]=-1e8,j[1][c]=1e8}return K.showSurface=g,K.showContour=h,K}function g(a,b){a=a||{};var c=this.gl;c.disable(c.CULL_FACE),this._colorMap.bind(0);var d=L;d.model=a.model||E,d.view=a.view||E,d.projection=a.projection||E,d.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],d.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],d.objectOffset=this.objectOffset,d.contourColor=this.contourColor[0],d.inverseModel=v(d.inverseModel,d.model);for(var e=0;e<2;++e)for(var g=d.clipBounds[e],h=0;h<3;++h)g[h]=Math.min(Math.max(this.clipBounds[e][h],-1e8),1e8);d.kambient=this.ambientLight,d.kdiffuse=this.diffuseLight,d.kspecular=this.specularLight,d.roughness=this.roughness,d.fresnel=this.fresnel,d.opacity=this.opacity,d.height=0,d.permutation=N,d.vertexColor=this.vertexColor;var i=M;for(u(i,d.view,d.model),u(i,d.projection,i),v(i,i),e=0;e<3;++e)d.eyePosition[e]=i[12+e]/i[15];var j=i[15];for(e=0;e<3;++e)j+=this.lightPosition[e]*i[4*e+3];for(e=0;e<3;++e){var k=i[12+e];for(h=0;h<3;++h)k+=i[4*h+e]*this.lightPosition[h];d.lightPosition[e]=k/j}var l=f(d,this);if(l.showSurface&&b===this.opacity<1){for(this._shader.bind(),this._shader.uniforms=d,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(c.TRIANGLES,this._vertexCount),e=0;e<3;++e)this.surfaceProject[e]&&this.vertexCount&&(this._shader.uniforms.model=l.projections[e],this._shader.uniforms.clipBounds=l.clipBounds[e],this._vao.draw(c.TRIANGLES,this._vertexCount));this._vao.unbind()}if(l.showContour&&!b){var m=this._contourShader;d.kambient=1,d.kdiffuse=0,d.kspecular=0,d.opacity=1,m.bind(),m.uniforms=d;var n=this._contourVAO;for(n.bind(),e=0;e<3;++e)for(m.uniforms.permutation=G[e],c.lineWidth(this.contourWidth[e]*this.pixelRatio),h=0;h<this.contourLevels[e].length;++h)h===this.highlightLevel[e]?(m.uniforms.contourColor=this.highlightColor[e],m.uniforms.contourTint=this.highlightTint[e]):0!==h&&h-1!==this.highlightLevel[e]||(m.uniforms.contourColor=this.contourColor[e],m.uniforms.contourTint=this.contourTint[e]),this._contourCounts[e][h]&&(m.uniforms.height=this.contourLevels[e][h],n.draw(c.LINES,this._contourCounts[e][h],this._contourOffsets[e][h]));for(e=0;e<3;++e)for(m.uniforms.model=l.projections[e],m.uniforms.clipBounds=l.clipBounds[e],h=0;h<3;++h)if(this.contourProject[e][h]){m.uniforms.permutation=G[h],c.lineWidth(this.contourWidth[h]*this.pixelRatio);for(var o=0;o<this.contourLevels[h].length;++o)o===this.highlightLevel[h]?(m.uniforms.contourColor=this.highlightColor[h],m.uniforms.contourTint=this.highlightTint[h]):0!==o&&o-1!==this.highlightLevel[h]||(m.uniforms.contourColor=this.contourColor[h],m.uniforms.contourTint=this.contourTint[h]),this._contourCounts[h][o]&&(m.uniforms.height=this.contourLevels[h][o],n.draw(c.LINES,this._contourCounts[h][o],this._contourOffsets[h][o]))}for(n.unbind(),(n=this._dynamicVAO).bind(),e=0;e<3;++e)if(0!==this._dynamicCounts[e])for(m.uniforms.model=d.model,m.uniforms.clipBounds=d.clipBounds,m.uniforms.permutation=G[e],c.lineWidth(this.dynamicWidth[e]*this.pixelRatio),m.uniforms.contourColor=this.dynamicColor[e],m.uniforms.contourTint=this.dynamicTint[e],m.uniforms.height=this.dynamicLevel[e],n.draw(c.LINES,this._dynamicCounts[e],this._dynamicOffsets[e]),h=0;h<3;++h)this.contourProject[h][e]&&(m.uniforms.model=l.projections[h],m.uniforms.clipBounds=l.clipBounds[h],n.draw(c.LINES,this._dynamicCounts[e],this._dynamicOffsets[e]));n.unbind()}}function h(a,b){return Array.isArray(a)?[b(a[0]),b(a[1]),b(a[2])]:[b(a),b(a),b(a)]}function i(a){return Array.isArray(a)?3===a.length?[a[0],a[1],a[2],1]:[a[0],a[1],a[2],a[3]]:[0,0,0,1]}function j(a){if(Array.isArray(a)){if(Array.isArray(a))return[i(a[0]),i(a[1]),i(a[2])];var b=i(a);return[b.slice(),b.slice(),b.slice()]}}b.exports=function(a){var b=a.gl,c=z(b),d=B(b),f=A(b),g=C(b),h=l(b),i=m(b,[{buffer:h,size:4,stride:D,offset:0},{buffer:h,size:3,stride:D,offset:16},{buffer:h,size:3,stride:D,offset:28}]),j=l(b),k=m(b,[{buffer:j,size:4,stride:20,offset:0},{buffer:j,size:1,stride:20,offset:16}]),o=l(b),p=m(b,[{buffer:o,size:2,type:b.FLOAT}]),q=n(b,1,H,b.RGBA,b.UNSIGNED_BYTE);q.minFilter=b.LINEAR,q.magFilter=b.LINEAR;var r=new e(b,[0,0],[[0,0,0],[0,0,0]],c,d,h,i,q,f,g,j,k,o,p,[0,0,0]),s={levels:[[],[],[]]};for(var t in a)s[t]=a[t];return s.colormap=s.colormap||"jet",r.update(s),r};var k=a("bit-twiddle"),l=a("gl-buffer"),m=a("gl-vao"),n=a("gl-texture2d"),o=a("typedarray-pool"),p=a("colormap"),q=a("ndarray-ops"),r=a("ndarray-pack"),s=a("ndarray"),t=a("surface-nets"),u=a("gl-mat4/multiply"),v=a("gl-mat4/invert"),w=a("binary-search-bounds"),x=a("ndarray-gradient"),y=a("./lib/shaders"),z=y.createShader,A=y.createContourShader,B=y.createPickShader,C=y.createPickContourShader,D=40,E=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],F=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],G=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];!function(){for(var a=0;a<3;++a){var b=G[a],c=(a+2)%3;b[(a+1)%3+0]=1,b[c+3]=1,b[a+6]=1}}();var H=256,I=e.prototype;I.isTransparent=function(){return this.opacity<1},I.isOpaque=function(){if(this.opacity>=1)return!0;for(var a=0;a<3;++a)if(this._contourCounts[a].length>0||this._dynamicCounts[a]>0)return!0;return!1},I.pickSlots=1,I.setPickBase=function(a){this.pickId=a};var J=[0,0,0],K={showSurface:!1,showContour:!1,projections:[E.slice(),E.slice(),E.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]},L={model:E,view:E,projection:E,inverseModel:E.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},M=E.slice(),N=[1,0,0,0,1,0,0,0,1];I.draw=function(a){return g.call(this,a,!1)},I.drawTransparent=function(a){return g.call(this,a,!0)};var O={model:E,view:E,projection:E,inverseModel:E,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};I.drawPick=function(a){a=a||{};var b=this.gl;b.disable(b.CULL_FACE);var c=O;c.model=a.model||E,c.view=a.view||E,c.projection=a.projection||E,c.shape=this._field[2].shape,c.pickId=this.pickId/255,c.lowerBound=this.bounds[0],c.upperBound=this.bounds[1],c.objectOffset=this.objectOffset,c.permutation=N;for(var d=0;d<2;++d)for(var e=c.clipBounds[d],g=0;g<3;++g)e[g]=Math.min(Math.max(this.clipBounds[d][g],-1e8),1e8);var h=f(c,this);if(h.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=c,this._vao.bind(),this._vao.draw(b.TRIANGLES,this._vertexCount),d=0;d<3;++d)this.surfaceProject[d]&&(this._pickShader.uniforms.model=h.projections[d],this._pickShader.uniforms.clipBounds=h.clipBounds[d],this._vao.draw(b.TRIANGLES,this._vertexCount));this._vao.unbind()}if(h.showContour){var i=this._contourPickShader;i.bind(),i.uniforms=c;var j=this._contourVAO;for(j.bind(),g=0;g<3;++g)for(b.lineWidth(this.contourWidth[g]*this.pixelRatio),i.uniforms.permutation=G[g],d=0;d<this.contourLevels[g].length;++d)this._contourCounts[g][d]&&(i.uniforms.height=this.contourLevels[g][d],j.draw(b.LINES,this._contourCounts[g][d],this._contourOffsets[g][d]));for(d=0;d<3;++d)for(i.uniforms.model=h.projections[d],i.uniforms.clipBounds=h.clipBounds[d],g=0;g<3;++g)if(this.contourProject[d][g]){i.uniforms.permutation=G[g],b.lineWidth(this.contourWidth[g]*this.pixelRatio);for(var k=0;k<this.contourLevels[g].length;++k)this._contourCounts[g][k]&&(i.uniforms.height=this.contourLevels[g][k],j.draw(b.LINES,this._contourCounts[g][k],this._contourOffsets[g][k]))}j.unbind()}},I.pick=function(a){if(!a)return null;if(a.id!==this.pickId)return null;var b=this._field[2].shape,c=this._pickResult,d=b[0]*(a.value[0]+(a.value[2]>>4)/16)/255,e=Math.floor(d),f=d-e,g=b[1]*(a.value[1]+(15&a.value[2])/16)/255,h=Math.floor(g),i=g-h;e+=1,h+=1;var j=c.position;j[0]=j[1]=j[2]=0;for(var k=0;k<2;++k)for(var l=k?f:1-f,m=0;m<2;++m)for(var n=e+k,o=h+m,p=l*(m?i:1-i),q=0;q<3;++q)j[q]+=this._field[q].get(n,o)*p;for(var r=this._pickResult.level,s=0;s<3;++s)if(r[s]=w.le(this.contourLevels[s],j[s]),r[s]<0)this.contourLevels[s].length>0&&(r[s]=0);else if(r[s]<this.contourLevels[s].length-1){var t=this.contourLevels[s][r[s]],u=this.contourLevels[s][r[s]+1];Math.abs(t-j[s])>Math.abs(u-j[s])&&(r[s]+=1)}for(c.index[0]=f<.5?e:e+1,c.index[1]=i<.5?h:h+1,c.uv[0]=d/b[0],c.uv[1]=g/b[1],q=0;q<3;++q)c.dataCoordinate[q]=this._field[q].get(c.index[0],c.index[1]);return c},I.padField=function(a,b){var c=b.shape.slice(),d=a.shape.slice();q.assign(a.lo(1,1).hi(c[0],c[1]),b),q.assign(a.lo(1).hi(c[0],1),b.hi(c[0],1)),q.assign(a.lo(1,d[1]-1).hi(c[0],1),b.lo(0,c[1]-1).hi(c[0],1)),q.assign(a.lo(0,1).hi(1,c[1]),b.hi(1)),q.assign(a.lo(d[0]-1,1).hi(1,c[1]),b.lo(c[0]-1)),a.set(0,0,b.get(0,0)),a.set(0,d[1]-1,b.get(0,c[1]-1)),a.set(d[0]-1,0,b.get(c[0]-1,0)),a.set(d[0]-1,d[1]-1,b.get(c[0]-1,c[1]-1))},I.update=function(a){a=a||{},this.objectOffset=a.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in a&&(this.contourWidth=h(a.contourWidth,Number)),"showContour"in a&&(this.showContour=h(a.showContour,Boolean)),"showSurface"in a&&(this.showSurface=!!a.showSurface),"contourTint"in a&&(this.contourTint=h(a.contourTint,Boolean)),"contourColor"in a&&(this.contourColor=j(a.contourColor)),"contourProject"in a&&(this.contourProject=h(a.contourProject,function(a){return h(a,Boolean)})),"surfaceProject"in a&&(this.surfaceProject=a.surfaceProject),"dynamicColor"in a&&(this.dynamicColor=j(a.dynamicColor)),"dynamicTint"in a&&(this.dynamicTint=h(a.dynamicTint,Number)),"dynamicWidth"in a&&(this.dynamicWidth=h(a.dynamicWidth,Number)),"opacity"in a&&(this.opacity=a.opacity),"colorBounds"in a&&(this.colorBounds=a.colorBounds),"vertexColor"in a&&(this.vertexColor=a.vertexColor?1:0);var b=a.field||a.coords&&a.coords[2]||null,c=!1;if(b||(b=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in a||"coords"in a){var d=(b.shape[0]+2)*(b.shape[1]+2);d>this._field[2].data.length&&(o.freeFloat(this._field[2].data),this._field[2].data=o.mallocFloat(k.nextPow2(d))),this._field[2]=s(this._field[2].data,[b.shape[0]+2,b.shape[1]+2]),this.padField(this._field[2],b),this.shape=b.shape.slice();for(var e=this.shape,f=0;f<2;++f)this._field[2].size>this._field[f].data.length&&(o.freeFloat(this._field[f].data),this._field[f].data=o.mallocFloat(this._field[2].size)),this._field[f]=s(this._field[f].data,[e[0]+2,e[1]+2]);if(a.coords){var g=a.coords;if(!Array.isArray(g)||3!==g.length)throw new Error("gl-surface: invalid coordinates for x/y");for(f=0;f<2;++f){var i=g[f];for(v=0;v<2;++v)if(i.shape[v]!==e[v])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[f],i)}}else if(a.ticks){var l=a.ticks;if(!Array.isArray(l)||2!==l.length)throw new Error("gl-surface: invalid ticks");for(f=0;f<2;++f){var m=l[f];if((Array.isArray(m)||m.length)&&(m=s(m)),m.shape[0]!==e[f])throw new Error("gl-surface: invalid tick length");var n=s(m.data,e);n.stride[f]=m.stride[0],n.stride[1^f]=0,this.padField(this._field[f],n)}}else{for(f=0;f<2;++f){var u=[0,0];u[f]=1,this._field[f]=s(this._field[f].data,[e[0]+2,e[1]+2],u,0)}this._field[0].set(0,0,0);for(var v=0;v<e[0];++v)this._field[0].set(v+1,0,v);for(this._field[0].set(e[0]+1,0,e[0]-1),this._field[1].set(0,0,0),v=0;v<e[1];++v)this._field[1].set(0,v+1,v);this._field[1].set(0,e[1]+1,e[1]-1)}var w=this._field,y=s(o.mallocFloat(3*w[2].size*2),[3,e[0]+2,e[1]+2,2]);for(f=0;f<3;++f)x(y.pick(f),w[f],"mirror");var z=s(o.mallocFloat(3*w[2].size),[e[0]+2,e[1]+2,3]);for(f=0;f<e[0]+2;++f)for(v=0;v<e[1]+2;++v){var A=y.get(0,f,v,0),B=y.get(0,f,v,1),C=y.get(1,f,v,0),D=y.get(1,f,v,1),E=y.get(2,f,v,0),G=y.get(2,f,v,1),I=C*G-D*E,J=E*B-G*A,K=A*D-B*C,L=Math.sqrt(I*I+J*J+K*K);L<1e-8?(L=Math.max(Math.abs(I),Math.abs(J),Math.abs(K)))<1e-8?(K=1,J=I=0,L=1):L=1/L:L=1/Math.sqrt(L),z.set(f,v,0,I*L),z.set(f,v,1,J*L),z.set(f,v,2,K*L)}o.free(y.data);var M=[1/0,1/0,1/0],N=[-1/0,-1/0,-1/0],O=1/0,P=-1/0,Q=(e[0]-1)*(e[1]-1)*6,R=o.mallocFloat(k.nextPow2(10*Q)),S=0,T=0;for(f=0;f<e[0]-1;++f)a:for(v=0;v<e[1]-1;++v){for(var U=0;U<2;++U)for(var V=0;V<2;++V)for(var W=0;W<3;++W){var X=this._field[W].get(1+f+U,1+v+V);if(isNaN(X)||!isFinite(X))continue a}for(W=0;W<6;++W){var Y=f+F[W][0],Z=v+F[W][1],$=this._field[0].get(Y+1,Z+1),_=this._field[1].get(Y+1,Z+1);X=this._field[2].get(Y+1,Z+1),I=z.get(Y+1,Z+1,0),J=z.get(Y+1,Z+1,1),K=z.get(Y+1,Z+1,2),a.intensity&&(aa=a.intensity.get(Y,Z));var aa=a.intensity?a.intensity.get(Y,Z):X+this.objectOffset[2];R[S++]=Y,R[S++]=Z,R[S++]=$,R[S++]=_,R[S++]=X,R[S++]=0,R[S++]=aa,R[S++]=I,R[S++]=J,R[S++]=K,M[0]=Math.min(M[0],$+this.objectOffset[0]),M[1]=Math.min(M[1],_+this.objectOffset[1]),M[2]=Math.min(M[2],X+this.objectOffset[2]),O=Math.min(O,aa),N[0]=Math.max(N[0],$+this.objectOffset[0]),N[1]=Math.max(N[1],_+this.objectOffset[1]),N[2]=Math.max(N[2],X+this.objectOffset[2]),P=Math.max(P,aa),T+=1}}for(a.intensityBounds&&(O=+a.intensityBounds[0],P=+a.intensityBounds[1]),f=6;f<S;f+=10)R[f]=(R[f]-O)/(P-O);this._vertexCount=T,this._coordinateBuffer.update(R.subarray(0,S)),o.freeFloat(R),o.free(z.data),this.bounds=[M,N],this.intensity=a.intensity||this._field[2],this.intensityBounds[0]===O&&this.intensityBounds[1]===P||(c=!0),this.intensityBounds=[O,P]}if("levels"in a){var ba=a.levels;for(ba=Array.isArray(ba[0])?ba.slice():[[],[],ba],f=0;f<3;++f)ba[f]=ba[f].slice(),ba[f].sort(function(a,b){return a-b});for(f=0;f<3;++f)for(v=0;v<ba[f].length;++v)ba[f][v]-=this.objectOffset[f];a:for(f=0;f<3;++f){if(ba[f].length!==this.contourLevels[f].length){c=!0;break}for(v=0;v<ba[f].length;++v)if(ba[f][v]!==this.contourLevels[f][v]){c=!0;break a}}this.contourLevels=ba}if(c){w=this._field,e=this.shape;for(var ca=[],da=0;da<3;++da){var ea=this.contourLevels[da],fa=[],ga=[],ha=[0,0,0];for(f=0;f<ea.length;++f){var ia=t(this._field[da],ea[f]);fa.push(ca.length/5|0),T=0;a:for(v=0;v<ia.cells.length;++v){var ja=ia.cells[v];for(W=0;W<2;++W){var ka=ia.positions[ja[W]],la=ka[0],ma=0|Math.floor(la),na=la-ma,oa=ka[1],pa=0|Math.floor(oa),qa=oa-pa,ra=!1;b:for(var sa=0;sa<3;++sa){ha[sa]=0;var ta=(da+sa+1)%3;for(U=0;U<2;++U){var ua=U?na:1-na;for(Y=0|Math.min(Math.max(ma+U,0),e[0]),V=0;V<2;++V){var va=V?qa:1-qa;if(Z=0|Math.min(Math.max(pa+V,0),e[1]),X=sa<2?this._field[ta].get(Y,Z):(this.intensity.get(Y,Z)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(X)||isNaN(X)){ra=!0;break b}var wa=ua*va;ha[sa]+=wa*X}}}if(ra){if(W>0){for(var xa=0;xa<5;++xa)ca.pop();T-=1}continue a}ca.push(ha[0],ha[1],ka[0],ka[1],ha[2]),T+=1}}ga.push(T)}this._contourOffsets[da]=fa,this._contourCounts[da]=ga}var ya=o.mallocFloat(ca.length);for(f=0;f<ca.length;++f)ya[f]=ca[f];this._contourBuffer.update(ya),o.freeFloat(ya)}a.colormap&&this._colorMap.setPixels(function(a){var b=r([p({colormap:a,nshades:H,format:"rgba"}).map(function(a){return[a[0],a[1],a[2],255*a[3]]})]);return q.divseq(b,255),b}(a.colormap))},I.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var a=0;a<3;++a)o.freeFloat(this._field[a].data)},I.highlight=function(a){var b,c;if(!a)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(b=0;b<3;++b)this.enableHighlight[b]?this.highlightLevel[b]=a.level[b]:this.highlightLevel[b]=-1;for(c=this.snapToData?a.dataCoordinate:a.position,b=0;b<3;++b)c[b]-=this.objectOffset[b];if(this.enableDynamic[0]&&c[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&c[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&c[2]!==this.dynamicLevel[2]){for(var d=0,e=this.shape,f=o.mallocFloat(12*e[0]*e[1]),g=0;g<3;++g)if(this.enableDynamic[g]){this.dynamicLevel[g]=c[g];var h=(g+1)%3,i=(g+2)%3,j=this._field[g],k=this._field[h],l=this._field[i],m=t(j,c[g]),n=m.cells,p=m.positions;for(this._dynamicOffsets[g]=d,b=0;b<n.length;++b)for(var q=n[b],r=0;r<2;++r){var s=p[q[r]],u=+s[0],v=0|u,w=0|Math.min(v+1,e[0]),x=u-v,y=1-x,z=+s[1],A=0|z,B=0|Math.min(A+1,e[1]),C=z-A,D=1-C,E=y*D,F=y*C,G=x*D,H=x*C,I=E*k.get(v,A)+F*k.get(v,B)+G*k.get(w,A)+H*k.get(w,B),J=E*l.get(v,A)+F*l.get(v,B)+G*l.get(w,A)+H*l.get(w,B);if(isNaN(I)||isNaN(J)){r&&(d-=1);break}f[2*d+0]=I,f[2*d+1]=J,d+=1}this._dynamicCounts[g]=d-this._dynamicOffsets[g]}else this.dynamicLevel[g]=NaN,this._dynamicCounts[g]=0;this._dynamicBuffer.update(f.subarray(0,2*d)),o.freeFloat(f)}}},{"./lib/shaders":315,"binary-search-bounds":316,"bit-twiddle":93,colormap:127,"gl-buffer":242,"gl-mat4/invert":266,"gl-mat4/multiply":268,"gl-texture2d":323,"gl-vao":328,ndarray:451,"ndarray-gradient":442,"ndarray-ops":445,"ndarray-pack":446,"surface-nets":532,"typedarray-pool":546}],318:[function(a,b,c){"use strict";var d=a("css-font"),e=a("pick-by-alias"),f=a("regl"),g=a("gl-util/context"),h=a("es6-weak-map"),i=a("color-normalize"),j=a("font-atlas"),k=a("typedarray-pool"),l=a("parse-rect"),m=a("is-plain-obj"),n=a("parse-unit"),o=a("to-px"),p=a("detect-kerning"),q=a("object-assign"),r=a("font-measure"),s=a("flatten-vertex-data"),t=a("bit-twiddle").nextPow2,u=new h,v=!1;if(document.body){var w=document.body.appendChild(document.createElement("div"));w.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(w).fontStretch&&(v=!0),document.body.removeChild(w)}var x=function(a){!function(a){return"function"==typeof a&&a._gl&&a.prop&&a.texture&&a.buffer}(a)?this.gl=g(a):(a={regl:a},this.gl=a.regl._gl),this.shader=u.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=a.regl||f({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),u.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(m(a)?a:{})};x.prototype.createShader=function(){var a=this.regl;return{regl:a,draw:a({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:a.prop("count"),offset:a.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:a.this("sizeBuffer")},width:{offset:0,stride:8,buffer:a.this("sizeBuffer")},char:a.this("charBuffer"),position:a.this("position")},uniforms:{atlasSize:function(a,b){return[b.atlas.width,b.atlas.height]},atlasDim:function(a,b){return[b.atlas.cols,b.atlas.rows]},atlas:function(a,b){return b.atlas.texture},charStep:function(a,b){return b.atlas.step},em:function(a,b){return b.atlas.em},color:a.prop("color"),opacity:a.prop("opacity"),viewport:a.this("viewportArray"),scale:a.this("scale"),align:a.prop("align"),baseline:a.prop("baseline"),translate:a.this("translate"),positionOffset:a.prop("positionOffset")},primitive:"points",viewport:a.this("viewport"),vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute float width, charOffset, char;\n\t\t\tattribute vec2 position;\n\t\t\tuniform float fontSize, charStep, em, align, baseline;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform vec4 color;\n\t\t\tuniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvoid main () {\n\t\t\t\t"+(x.normalViewport?"":"vec2 positionOffset = vec2(positionOffset.x,- positionOffset.y);")+"\n\n\t\t\t\tvec2 offset = floor(em * (vec2(align + charOffset, baseline)\n\t\t\t\t\t+ positionOffset))\n\t\t\t\t\t/ (viewport.zw * scale.xy);\n\n\t\t\t\tvec2 position = (position + translate) * scale;\n\t\t\t\tposition += offset * scale;\n\n\t\t\t\t"+(x.normalViewport?"position.y = 1. - position.y;":"")+"\n\n\t\t\t\tcharCoord = position * viewport.zw + viewport.xy;\n\n\t\t\t\tgl_Position = vec4(position * 2. - 1., 0, 1);\n\n\t\t\t\tgl_PointSize = charStep;\n\n\t\t\t\tcharId.x = mod(char, atlasDim.x);\n\t\t\t\tcharId.y = floor(char / atlasDim.x);\n\n\t\t\t\tcharWidth = width * em;\n\n\t\t\t\tfontColor = color / 255.;\n\t\t\t}",frag:"\n\t\t\tprecision highp float;\n\t\t\tuniform sampler2D atlas;\n\t\t\tuniform float fontSize, charStep, opacity;\n\t\t\tuniform vec2 atlasSize;\n\t\t\tuniform vec4 viewport;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\n\t\t\tfloat lightness(vec4 color) {\n\t\t\t\treturn color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n\t\t\t}\n\n\t\t\tvoid main () {\n\t\t\t\tvec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n\t\t\t\tfloat halfCharStep = floor(charStep * .5 + .5);\n\n\t\t\t\t// invert y and shift by 1px (FF expecially needs that)\n\t\t\t\tuv.y = charStep - uv.y;\n\n\t\t\t\t// ignore points outside of character bounding box\n\t\t\t\tfloat halfCharWidth = ceil(charWidth * .5);\n\t\t\t\tif (floor(uv.x) > halfCharStep + halfCharWidth ||\n\t\t\t\t\tfloor(uv.x) < halfCharStep - halfCharWidth) return;\n\n\t\t\t\tuv += charId * charStep;\n\t\t\t\tuv = uv / atlasSize;\n\n\t\t\t\tvec4 color = fontColor;\n\t\t\t\tvec4 mask = texture2D(atlas, uv);\n\n\t\t\t\tfloat maskY = lightness(mask);\n\t\t\t\t// float colorY = lightness(color);\n\t\t\t\tcolor.a *= maskY;\n\t\t\t\tcolor.a *= opacity;\n\n\t\t\t\t// color.a += .1;\n\n\t\t\t\t// antialiasing, see yiq color space y-channel formula\n\t\t\t\t// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n\t\t\t\tgl_FragColor = color;\n\t\t\t}"}),atlas:{}}},x.prototype.update=function(a){var b=this
;if("string"==typeof a)a={text:a};else if(!a)return;null!=(a=e(a,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity&&(Array.isArray(a.opacity)?this.opacity=a.opacity.map(function(a){return parseFloat(a)}):this.opacity=parseFloat(a.opacity)),null!=a.viewport&&(this.viewport=l(a.viewport),x.normalViewport&&(this.viewport.y=this.canvas.height-this.viewport.y-this.viewport.height),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null==this.viewport&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null!=a.kerning&&(this.kerning=a.kerning),null!=a.offset&&("number"==typeof a.offset&&(a.offset=[a.offset,0]),this.positionOffset=s(a.offset)),a.direction&&(this.direction=a.direction),a.range&&(this.range=a.range,this.scale=[1/(a.range[2]-a.range[0]),1/(a.range[3]-a.range[1])],this.translate=[-a.range[0],-a.range[1]]),a.scale&&(this.scale=a.scale),a.translate&&(this.translate=a.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||a.font||(a.font=x.baseFontSize+"px sans-serif");var c,f=!1,g=!1;if(a.font&&(Array.isArray(a.font)?a.font:[a.font]).forEach(function(a,c){if("string"==typeof a)try{a=d.parse(a)}catch(b){a=d.parse(x.baseFontSize+"px "+a)}else a=d.parse(d.stringify(a));var e=d.stringify({size:x.baseFontSize,family:a.family,stretch:v?a.stretch:void 0,variant:a.variant,weight:a.weight,style:a.style}),h=n(a.size),i=Math.round(h[0]*o(h[1]));if(i!==b.fontSize[c]&&(g=!0,b.fontSize[c]=i),!(b.font[c]&&e==b.font[c].baseString||(f=!0,b.font[c]=x.fonts[e],b.font[c]))){var j=a.family.join(", "),k=[a.style];a.style!=a.variant&&k.push(a.variant),a.variant!=a.weight&&k.push(a.weight),v&&a.weight!=a.stretch&&k.push(a.stretch),b.font[c]={baseString:e,family:j,weight:a.weight,stretch:a.stretch,style:a.style,variant:a.variant,width:{},kerning:{},metrics:r(j,{origin:"top",fontSize:x.baseFontSize,fontStyle:k.join(" ")})},x.fonts[e]=b.font[c]}}),(f||g)&&this.font.forEach(function(c,e){var f=d.stringify({size:b.fontSize[e],family:c.family,stretch:v?c.stretch:void 0,variant:c.variant,weight:c.weight,style:c.style});if(b.fontAtlas[e]=b.shader.atlas[f],!b.fontAtlas[e]){var g=c.metrics;b.shader.atlas[f]=b.fontAtlas[e]={fontString:f,step:2*Math.ceil(b.fontSize[e]*g.bottom*.5),em:b.fontSize[e],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:b.regl.texture()}}null==a.text&&(a.text=b.text)}),"string"==typeof a.text&&a.position&&a.position.length>2){for(var h=Array(.5*a.position.length),m=0;m<h.length;m++)h[m]=a.text;a.text=h}if(null!=a.text||f){if(this.textOffsets=[0],Array.isArray(a.text)){this.count=a.text[0].length,this.counts=[this.count];for(var u=1;u<a.text.length;u++)this.textOffsets[u]=this.textOffsets[u-1]+a.text[u-1].length,this.count+=a.text[u].length,this.counts.push(a.text[u].length);this.text=a.text.join("")}else this.text=a.text,this.count=this.text.length,this.counts=[this.count];c=[],this.font.forEach(function(a,d){x.atlasContext.font=a.baseString;for(var e=b.fontAtlas[d],f=0;f<b.text.length;f++){var g=b.text.charAt(f);if(null==e.ids[g]&&(e.ids[g]=e.chars.length,e.chars.push(g),c.push(g)),null==a.width[g]&&(a.width[g]=x.atlasContext.measureText(g).width/x.baseFontSize,b.kerning)){var h=[];for(var i in a.width)h.push(i+g,g+i);q(a.kerning,p(a.family,{pairs:h}))}}})}if(a.position)if(a.position.length>2){for(var w=!a.position[0].length,y=k.mallocFloat(2*this.count),z=0,A=0;z<this.counts.length;z++){var B=this.counts[z];if(w)for(var C=0;C<B;C++)y[A++]=a.position[2*z],y[A++]=a.position[2*z+1];else for(var D=0;D<B;D++)y[A++]=a.position[z][0],y[A++]=a.position[z][1]}this.position.call?this.position({type:"float",data:y}):this.position=this.regl.buffer({type:"float",data:y}),k.freeFloat(y)}else this.position.destroy&&this.position.destroy(),this.position={constant:a.position};if(a.text||f){var E=k.mallocUint8(this.count),F=k.mallocFloat(2*this.count);this.textWidth=[];for(var G=0,H=0;G<this.counts.length;G++){for(var I=this.counts[G],J=this.font[G]||this.font[0],K=this.fontAtlas[G]||this.fontAtlas[0],L=0;L<I;L++){var M=this.text.charAt(H),N=this.text.charAt(H-1);if(E[H]=K.ids[M],F[2*H]=J.width[M],L){var O=F[2*H-2],P=F[2*H],Q=F[2*H-1]+.5*O+.5*P;if(this.kerning){var R=J.kerning[N+M];R&&(Q+=.001*R)}F[2*H+1]=Q}else F[2*H+1]=.5*F[2*H];H++}this.textWidth.push(F.length?.5*F[2*H-2]+F[2*H-1]:0)}a.align||(a.align=this.align),this.charBuffer({data:E,type:"uint8",usage:"stream"}),this.sizeBuffer({data:F,type:"float",usage:"stream"}),k.freeUint8(E),k.freeFloat(F),c.length&&this.font.forEach(function(a,c){var d=b.fontAtlas[c],e=d.step,f=Math.floor(x.maxAtlasSize/e),g=Math.min(f,d.chars.length),h=Math.ceil(d.chars.length/g),i=t(g*e),k=t(h*e);d.width=i,d.height=k,d.rows=h,d.cols=g,d.em&&d.texture({data:j({canvas:x.atlasCanvas,font:d.fontString,chars:d.chars,shape:[i,k],step:[e,e]})})})}if(a.align&&(this.align=a.align,this.alignOffset=this.textWidth.map(function(a,c){var d=Array.isArray(b.align)?b.align.length>1?b.align[c]:b.align[0]:b.align;if("number"==typeof d)return d;switch(d){case"right":case"end":return-a;case"center":case"centre":case"middle":return.5*-a}return 0})),null==this.baseline&&null==a.baseline&&(a.baseline=0),null!=a.baseline&&(this.baseline=a.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(a,c){var d=(b.font[c]||b.font[0]).metrics,e=0;return e+=.5*d.bottom,e+="number"==typeof a?a-d.baseline:-d[a],x.normalViewport||(e*=-1),e})),null!=a.color)if(a.color||(a.color="transparent"),"string"!=typeof a.color&&isNaN(a.color)){var S;if("number"==typeof a.color[0]&&a.color.length>this.counts.length){var T=a.color.length;S=k.mallocUint8(T);for(var U=(a.color.subarray||a.color.slice).bind(a.color),V=0;V<T;V+=4)S.set(i(U(V,V+4),"uint8"),V)}else{var W=a.color.length;S=k.mallocUint8(4*W);for(var X=0;X<W;X++)S.set(i(a.color[X]||0,"uint8"),4*X)}this.color=S}else this.color=i(a.color,"uint8");if(a.position||a.text||a.color||a.baseline||a.align||a.font||a.offset||a.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var Y=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(Y);for(var Z=0;Z<this.batch.length;Z++)this.batch[Z]={count:this.counts.length>1?this.counts[Z]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[Z]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*Z,4*Z+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[Z]:this.opacity,baseline:null!=this.baselineOffset[Z]?this.baselineOffset[Z]:this.baselineOffset[0],align:this.align?null!=this.alignOffset[Z]?this.alignOffset[Z]:this.alignOffset[0]:0,atlas:this.fontAtlas[Z]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*Z,2*Z+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]},x.prototype.destroy=function(){},x.prototype.kerning=!0,x.prototype.position={constant:new Float32Array(2)},x.prototype.translate=null,x.prototype.scale=null,x.prototype.font=null,x.prototype.text="",x.prototype.positionOffset=[0,0],x.prototype.opacity=1,x.prototype.color=new Uint8Array([0,0,0,255]),x.prototype.alignOffset=[0,0],x.normalViewport=!1,x.maxAtlasSize=1024,x.atlasCanvas=document.createElement("canvas"),x.atlasContext=x.atlasCanvas.getContext("2d",{alpha:!1}),x.baseFontSize=64,x.fonts={},b.exports=x},{"bit-twiddle":93,"color-normalize":121,"css-font":140,"detect-kerning":167,"es6-weak-map":319,"flatten-vertex-data":228,"font-atlas":229,"font-measure":230,"gl-util/context":324,"is-plain-obj":423,"object-assign":455,"parse-rect":460,"parse-unit":462,"pick-by-alias":466,regl:503,"to-px":540,"typedarray-pool":546}],319:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?WeakMap:a("./polyfill")},{"./is-implemented":320,"./polyfill":322}],320:[function(a,b,c){"use strict";b.exports=function(){var a,b;if("function"!=typeof WeakMap)return!1;try{a=new WeakMap([[b={},"one"],[{},"two"],[{},"three"]])}catch(a){return!1}return"[object WeakMap]"===String(a)&&"function"==typeof a.set&&a.set({},1)===a&&"function"==typeof a.delete&&"function"==typeof a.has&&"one"===a.get(b)}},{}],321:[function(a,b,c){"use strict";b.exports="function"==typeof WeakMap&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)},{}],322:[function(a,b,c){"use strict";var d,e=a("es5-ext/object/is-value"),f=a("es5-ext/object/set-prototype-of"),g=a("es5-ext/object/valid-object"),h=a("es5-ext/object/valid-value"),i=a("es5-ext/string/random-uniq"),j=a("d"),k=a("es6-iterator/get"),l=a("es6-iterator/for-of"),m=a("es6-symbol").toStringTag,n=a("./is-native-implemented"),o=Array.isArray,p=Object.defineProperty,q=Object.prototype.hasOwnProperty,r=Object.getPrototypeOf;b.exports=d=function(){var a,b=arguments[0];if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");return a=n&&f&&WeakMap!==d?f(new WeakMap,r(this)):this,e(b)&&(o(b)||(b=k(b))),p(a,"__weakMapData__",j("c","$weakMap$"+i())),b?(l(b,function(b){h(b),a.set(b[0],b[1])}),a):a},n&&(f&&f(d,WeakMap),d.prototype=Object.create(WeakMap.prototype,{constructor:j(d)})),Object.defineProperties(d.prototype,{delete:j(function(a){return!!q.call(g(a),this.__weakMapData__)&&(delete a[this.__weakMapData__],!0)}),get:j(function(a){if(q.call(g(a),this.__weakMapData__))return a[this.__weakMapData__]}),has:j(function(a){return q.call(g(a),this.__weakMapData__)}),set:j(function(a,b){return p(g(a),this.__weakMapData__,j("c",b)),this}),toString:j(function(){return"[object WeakMap]"})}),p(d.prototype,m,j("c","WeakMap"))},{"./is-native-implemented":321,d:152,"es5-ext/object/is-value":195,"es5-ext/object/set-prototype-of":201,"es5-ext/object/valid-object":205,"es5-ext/object/valid-value":206,"es5-ext/string/random-uniq":211,"es6-iterator/for-of":213,"es6-iterator/get":214,"es6-symbol":220}],323:[function(a,b,c){"use strict";function d(a){return"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&a instanceof ImageData}function e(a,b,c){var d=a.gl,e=d.getParameter(d.MAX_TEXTURE_SIZE);if(b<0||b>e||c<0||c>e)throw new Error("gl-texture2d: Invalid texture size");return a._shape=[b,c],a.bind(),d.texImage2D(d.TEXTURE_2D,0,a.format,b,c,0,a.format,a.type,null),a._mipLevels=[0],a}function f(a,b,c,d,e,f){this.gl=a,this.handle=b,this.format=e,this.type=f,this._shape=[c,d],this._mipLevels=[0],this._magFilter=a.NEAREST,this._minFilter=a.NEAREST,this._wrapS=a.CLAMP_TO_EDGE,this._wrapT=a.CLAMP_TO_EDGE,this._anisoSamples=1;var g=this,h=[this._wrapS,this._wrapT];Object.defineProperties(h,[{get:function(){return g._wrapS},set:function(a){return g.wrapS=a}},{get:function(){return g._wrapT},set:function(a){return g.wrapT=a}}]),this._wrapVector=h;var i=[this._shape[0],this._shape[1]];Object.defineProperties(i,[{get:function(){return g._shape[0]},set:function(a){return g.width=a}},{get:function(){return g._shape[1]},set:function(a){return g.height=a}}]),this._shapeVector=i}function g(a,b){return 3===a.length?1===b[2]&&b[1]===a[0]*a[2]&&b[0]===a[2]:1===b[0]&&b[1]===a[0]}function h(a){var b=a.createTexture();return a.bindTexture(a.TEXTURE_2D,b),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),b}function i(a,b,c,d,e){var g=a.getParameter(a.MAX_TEXTURE_SIZE);if(b<0||b>g||c<0||c>g)throw new Error("gl-texture2d: Invalid texture shape");if(e===a.FLOAT&&!a.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var i=h(a);return a.texImage2D(a.TEXTURE_2D,0,d,b,c,0,d,e,null),new f(a,i,b,c,d,e)}var j=a("ndarray"),k=a("ndarray-ops"),l=a("typedarray-pool");b.exports=function(a){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(m||function(a){m=[a.LINEAR,a.NEAREST_MIPMAP_LINEAR,a.LINEAR_MIPMAP_NEAREST,a.LINEAR_MIPMAP_NEAREST],n=[a.NEAREST,a.LINEAR,a.NEAREST_MIPMAP_NEAREST,a.NEAREST_MIPMAP_LINEAR,a.LINEAR_MIPMAP_NEAREST,a.LINEAR_MIPMAP_LINEAR],o=[a.REPEAT,a.CLAMP_TO_EDGE,a.MIRRORED_REPEAT]}(a),"number"==typeof arguments[1])return i(a,arguments[1],arguments[2],arguments[3]||a.RGBA,arguments[4]||a.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return i(a,0|arguments[1][0],0|arguments[1][1],arguments[2]||a.RGBA,arguments[3]||a.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var b=arguments[1],c=d(b)?b:b.raw;if(c)return function(a,b,c,d,e,g){var i=h(a);return a.texImage2D(a.TEXTURE_2D,0,e,e,g,b),new f(a,i,c,d,e,g)}(a,c,0|b.width,0|b.height,arguments[2]||a.RGBA,arguments[3]||a.UNSIGNED_BYTE);if(b.shape&&b.data&&b.stride)return function(a,b){var c=b.dtype,d=b.shape.slice(),e=a.getParameter(a.MAX_TEXTURE_SIZE);if(d[0]<0||d[0]>e||d[1]<0||d[1]>e)throw new Error("gl-texture2d: Invalid texture size");var i=g(d,b.stride.slice()),m=0;"float32"===c?m=a.FLOAT:"float64"===c?(m=a.FLOAT,i=!1,c="float32"):"uint8"===c?m=a.UNSIGNED_BYTE:(m=a.UNSIGNED_BYTE,i=!1,c="uint8");var n,o,q=0;if(2===d.length)q=a.LUMINANCE,d=[d[0],d[1],1],b=j(b.data,d,[b.stride[0],b.stride[1],1],b.offset);else{if(3!==d.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===d[2])q=a.ALPHA;else if(2===d[2])q=a.LUMINANCE_ALPHA;else if(3===d[2])q=a.RGB;else{if(4!==d[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");q=a.RGBA}}m!==a.FLOAT||a.getExtension("OES_texture_float")||(m=a.UNSIGNED_BYTE,i=!1);var r=b.size;if(i)n=0===b.offset&&b.data.length===r?b.data:b.data.subarray(b.offset,b.offset+r);else{var s=[d[2],d[2]*d[0],1];o=l.malloc(r,c);var t=j(o,d,s,0);"float32"!==c&&"float64"!==c||m!==a.UNSIGNED_BYTE?k.assign(t,b):p(t,b),n=o.subarray(0,r)}var u=h(a);return a.texImage2D(a.TEXTURE_2D,0,q,d[0],d[1],0,q,m,n),i||l.free(o),new f(a,u,d[0],d[1],q,m)}(a,b)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var m=null,n=null,o=null,p=function(a,b){k.muls(a,b,255)},q=f.prototype;Object.defineProperties(q,{minFilter:{get:function(){return this._minFilter},set:function(a){this.bind();var b=this.gl;if(this.type===b.FLOAT&&m.indexOf(a)>=0&&(b.getExtension("OES_texture_float_linear")||(a=b.NEAREST)),n.indexOf(a)<0)throw new Error("gl-texture2d: Unknown filter mode "+a);return b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a),this._minFilter=a}},magFilter:{get:function(){return this._magFilter},set:function(a){this.bind();var b=this.gl;if(this.type===b.FLOAT&&m.indexOf(a)>=0&&(b.getExtension("OES_texture_float_linear")||(a=b.NEAREST)),n.indexOf(a)<0)throw new Error("gl-texture2d: Unknown filter mode "+a);return b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a),this._magFilter=a}},mipSamples:{get:function(){return this._anisoSamples},set:function(a){var b=this._anisoSamples;if(this._anisoSamples=0|Math.max(a,1),b!==this._anisoSamples){var c=this.gl.getExtension("EXT_texture_filter_anisotropic");c&&this.gl.texParameterf(this.gl.TEXTURE_2D,c.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(a){if(this.bind(),o.indexOf(a)<0)throw new Error("gl-texture2d: Unknown wrap mode "+a);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,a),this._wrapS=a}},wrapT:{get:function(){return this._wrapT},set:function(a){if(this.bind(),o.indexOf(a)<0)throw new Error("gl-texture2d: Unknown wrap mode "+a);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,a),this._wrapT=a}},wrap:{get:function(){return this._wrapVector},set:function(a){if(Array.isArray(a)||(a=[a,a]),2!==a.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var b=0;b<2;++b)if(o.indexOf(a[b])<0)throw new Error("gl-texture2d: Unknown wrap mode "+a);this._wrapS=a[0],this._wrapT=a[1];var c=this.gl;return this.bind(),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,this._wrapS),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,this._wrapT),a}},shape:{get:function(){return this._shapeVector},set:function(a){if(Array.isArray(a)){if(2!==a.length)throw new Error("gl-texture2d: Invalid texture shape")}else a=[0|a,0|a];return e(this,0|a[0],0|a[1]),[0|a[0],0|a[1]]}},width:{get:function(){return this._shape[0]},set:function(a){return e(this,a|=0,this._shape[1]),a}},height:{get:function(){return this._shape[1]},set:function(a){return a|=0,e(this,this._shape[0],a),a}}}),q.bind=function(a){var b=this.gl;return void 0!==a&&b.activeTexture(b.TEXTURE0+(0|a)),b.bindTexture(b.TEXTURE_2D,this.handle),void 0!==a?0|a:b.getParameter(b.ACTIVE_TEXTURE)-b.TEXTURE0},q.dispose=function(){this.gl.deleteTexture(this.handle)},q.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var a=Math.min(this._shape[0],this._shape[1]),b=0;a>0;++b,a>>>=1)this._mipLevels.indexOf(b)<0&&this._mipLevels.push(b)},q.setPixels=function(a,b,c,e){var f=this.gl;this.bind(),Array.isArray(b)?(e=c,c=0|b[1],b=0|b[0]):(b=b||0,c=c||0),e=e||0;var h=d(a)?a:a.raw;if(h)this._mipLevels.indexOf(e)<0?(f.texImage2D(f.TEXTURE_2D,0,this.format,this.format,this.type,h),this._mipLevels.push(e)):f.texSubImage2D(f.TEXTURE_2D,e,b,c,this.format,this.type,h);else{if(!(a.shape&&a.stride&&a.data))throw new Error("gl-texture2d: Unsupported data type");if(a.shape.length<2||b+a.shape[1]>this._shape[1]>>>e||c+a.shape[0]>this._shape[0]>>>e||b<0||c<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");!function(a,b,c,d,e,f,h,i){var m=i.dtype,n=i.shape.slice();if(n.length<2||n.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var o=0,q=0,r=g(n,i.stride.slice());if("float32"===m?o=a.FLOAT:"float64"===m?(o=a.FLOAT,r=!1,m="float32"):"uint8"===m?o=a.UNSIGNED_BYTE:(o=a.UNSIGNED_BYTE,r=!1,m="uint8"),2===n.length)q=a.LUMINANCE,n=[n[0],n[1],1],i=j(i.data,n,[i.stride[0],i.stride[1],1],i.offset);else{if(3!==n.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===n[2])q=a.ALPHA;else if(2===n[2])q=a.LUMINANCE_ALPHA;else if(3===n[2])q=a.RGB;else{if(4!==n[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");q=a.RGBA}n[2]}if(q!==a.LUMINANCE&&q!==a.ALPHA||e!==a.LUMINANCE&&e!==a.ALPHA||(q=e),q!==e)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var s=i.size,t=h.indexOf(d)<0;if(t&&h.push(d),o===f&&r)0===i.offset&&i.data.length===s?t?a.texImage2D(a.TEXTURE_2D,d,e,n[0],n[1],0,e,f,i.data):a.texSubImage2D(a.TEXTURE_2D,d,b,c,n[0],n[1],e,f,i.data):t?a.texImage2D(a.TEXTURE_2D,d,e,n[0],n[1],0,e,f,i.data.subarray(i.offset,i.offset+s)):a.texSubImage2D(a.TEXTURE_2D,d,b,c,n[0],n[1],e,f,i.data.subarray(i.offset,i.offset+s));else{var u;u=f===a.FLOAT?l.mallocFloat32(s):l.mallocUint8(s);var v=j(u,n,[n[2],n[2]*n[0],1]);o===a.FLOAT&&f===a.UNSIGNED_BYTE?p(v,i):k.assign(v,i),t?a.texImage2D(a.TEXTURE_2D,d,e,n[0],n[1],0,e,f,u.subarray(0,s)):a.texSubImage2D(a.TEXTURE_2D,d,b,c,n[0],n[1],e,f,u.subarray(0,s)),f===a.FLOAT?l.freeFloat32(u):l.freeUint8(u)}}(f,b,c,e,this.format,this.type,this._mipLevels,a)}}},{ndarray:451,"ndarray-ops":445,"typedarray-pool":546}],324:[function(a,b,c){(function(c){"use strict";function d(a){if(a.container)if(a.container==document.body)document.body.style.width||(a.canvas.width=a.width||a.pixelRatio*c.innerWidth),document.body.style.height||(a.canvas.height=a.height||a.pixelRatio*c.innerHeight);else{var b=a.container.getBoundingClientRect();a.canvas.width=a.width||b.right-b.left,a.canvas.height=a.height||b.bottom-b.top}}function e(a){return"function"==typeof a.getContext&&"width"in a&&"height"in a}function f(){var a=document.createElement("canvas");return a.style.position="absolute",a.style.top=0,a.style.left=0,a}var g=a("pick-by-alias");b.exports=function(a){var b;if(a?"string"==typeof a&&(a={container:a}):a={},a=e(a)?{container:a}:"string"==typeof(b=a).nodeName&&"function"==typeof b.appendChild&&"function"==typeof b.getBoundingClientRect?{container:a}:function(a){return"function"==typeof a.drawArrays||"function"==typeof a.drawElements}(a)?{gl:a}:g(a,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),a.pixelRatio||(a.pixelRatio=c.pixelRatio||1),a.gl)return a.gl;if(a.canvas&&(a.container=a.canvas.parentNode),a.container){if("string"==typeof a.container){var h=document.querySelector(a.container);if(!h)throw Error("Element "+a.container+" is not found");a.container=h}e(a.container)?(a.canvas=a.container,a.container=a.canvas.parentNode):a.canvas||(a.canvas=f(),a.container.appendChild(a.canvas),d(a))}else if(!a.canvas){if("undefined"==typeof document)throw Error("Not DOM environment. Use headless-gl.");a.container=document.body||document.documentElement,a.canvas=f(),a.container.appendChild(a.canvas),d(a)}if(!a.gl)try{a.gl=a.canvas.getContext("webgl",a.attrs)}catch(b){try{a.gl=a.canvas.getContext("experimental-webgl",a.attrs)}catch(b){a.gl=a.canvas.getContext("webgl-experimental",a.attrs)}}return a.gl}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"pick-by-alias":466}],325:[function(a,b,c){"use strict";b.exports=function(a,b,c){b?b.bind():a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);var d=0|a.getParameter(a.MAX_VERTEX_ATTRIBS);if(c){if(c.length>d)throw new Error("gl-vao: Too many vertex attributes");for(var e=0;e<c.length;++e){var f=c[e];if(f.buffer){var g=f.buffer,h=f.size||4,i=f.type||a.FLOAT,j=!!f.normalized,k=f.stride||0,l=f.offset||0;g.bind(),a.enableVertexAttribArray(e),a.vertexAttribPointer(e,h,i,j,k,l)}else{if("number"==typeof f)a.vertexAttrib1f(e,f);else if(1===f.length)a.vertexAttrib1f(e,f[0]);else if(2===f.length)a.vertexAttrib2f(e,f[0],f[1]);else if(3===f.length)a.vertexAttrib3f(e,f[0],f[1],f[2]);else{if(4!==f.length)throw new Error("gl-vao: Invalid vertex attribute");a.vertexAttrib4f(e,f[0],f[1],f[2],f[3])}a.disableVertexAttribArray(e)}}for(;e<d;++e)a.disableVertexAttribArray(e)}else for(a.bindBuffer(a.ARRAY_BUFFER,null),e=0;e<d;++e)a.disableVertexAttribArray(e)}},{}],326:[function(a,b,c){"use strict";function d(a){this.gl=a,this._elements=null,this._attributes=null,this._elementsType=a.UNSIGNED_SHORT}var e=a("./do-bind.js");d.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},d.prototype.update=function(a,b,c){this._elements=b,this._attributes=a,this._elementsType=c||this.gl.UNSIGNED_SHORT},d.prototype.dispose=function(){},d.prototype.unbind=function(){},d.prototype.draw=function(a,b,c){c=c||0;var d=this.gl;this._elements?d.drawElements(a,b,this._elementsType,c):d.drawArrays(a,c,b)},b.exports=function(a){return new d(a)}},{"./do-bind.js":325}],327:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){this.location=a,this.dimension=b,this.a=c,this.b=d,this.c=e,this.d=f}function e(a,b,c){this.gl=a,this._ext=b,this.handle=c,this._attribs=[],this._useElements=!1,this._elementsType=a.UNSIGNED_SHORT}var f=a("./do-bind.js");d.prototype.bind=function(a){switch(this.dimension){case 1:a.vertexAttrib1f(this.location,this.a);break;case 2:a.vertexAttrib2f(this.location,this.a,this.b);break;case 3:a.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:a.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},e.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var a=0;a<this._attribs.length;++a)this._attribs[a].bind(this.gl)},e.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},e.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},e.prototype.update=function(a,b,c){if(this.bind(),f(this.gl,b,a),this.unbind(),this._attribs.length=0,a)for(var e=0;e<a.length;++e){var g=a[e];"number"==typeof g?this._attribs.push(new d(e,1,g)):Array.isArray(g)&&this._attribs.push(new d(e,g.length,g[0],g[1],g[2],g[3]))}this._useElements=!!b,this._elementsType=c||this.gl.UNSIGNED_SHORT},e.prototype.draw=function(a,b,c){c=c||0;var d=this.gl;this._useElements?d.drawElements(a,b,this._elementsType,c):d.drawArrays(a,c,b)},b.exports=function(a,b){return new e(a,b,b.createVertexArrayOES())}},{"./do-bind.js":325}],328:[function(a,b,c){"use strict";function d(a){this.bindVertexArrayOES=a.bindVertexArray.bind(a),this.createVertexArrayOES=a.createVertexArray.bind(a),this.deleteVertexArrayOES=a.deleteVertexArray.bind(a)}var e=a("./lib/vao-native.js"),f=a("./lib/vao-emulated.js");b.exports=function(a,b,c,g){var h,i=a.createVertexArray?new d(a):a.getExtension("OES_vertex_array_object");return(h=i?e(a,i):f(a)).update(b,c,g),h}},{"./lib/vao-emulated.js":326,"./lib/vao-native.js":327}],329:[function(a,b,c){b.exports=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a}},{}],330:[function(a,b,c){b.exports=function(a,b){var c=d(a[0],a[1],a[2]),g=d(b[0],b[1],b[2]);e(c,c),e(g,g);var h=f(c,g);return h>1?0:Math.acos(h)};var d=a("./fromValues"),e=a("./normalize"),f=a("./dot")},{"./dot":340,"./fromValues":346,"./normalize":357}],331:[function(a,b,c){b.exports=function(a,b){return a[0]=Math.ceil(b[0]),a[1]=Math.ceil(b[1]),a[2]=Math.ceil(b[2]),a}},{}],332:[function(a,b,c){b.exports=function(a){var b=new Float32Array(3);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b}},{}],333:[function(a,b,c){b.exports=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a}},{}],334:[function(a,b,c){b.exports=function(){var a=new Float32Array(3);return a[0]=0,a[1]=0,a[2]=0,a}},{}],335:[function(a,b,c){b.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2];return a[0]=e*i-f*h,a[1]=f*g-d*i,a[2]=d*h-e*g,a}},{}],336:[function(a,b,c){b.exports=a("./distance")},{"./distance":337}],337:[function(a,b,c){b.exports=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)}},{}],338:[function(a,b,c){b.exports=a("./divide")},{"./divide":339}],339:[function(a,b,c){b.exports=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],a}},{}],340:[function(a,b,c){b.exports=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}},{}],341:[function(a,b,c){b.exports=1e-6},{}],342:[function(a,b,c){b.exports=function(a,b){var c=a[0],e=a[1],f=a[2],g=b[0],h=b[1],i=b[2];return Math.abs(c-g)<=d*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(e-h)<=d*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(f-i)<=d*Math.max(1,Math.abs(f),Math.abs(i))};var d=a("./epsilon")},{"./epsilon":341}],343:[function(a,b,c){b.exports=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}},{}],344:[function(a,b,c){b.exports=function(a,b){return a[0]=Math.floor(b[0]),a[1]=Math.floor(b[1]),a[2]=Math.floor(b[2]),a}},{}],345:[function(a,b,c){b.exports=function(a,b,c,e,f,g){var h,i;for(b||(b=3),c||(c=0),i=e?Math.min(e*b+c,a.length):a.length,h=c;h<i;h+=b)d[0]=a[h],d[1]=a[h+1],d[2]=a[h+2],f(d,d,g),a[h]=d[0],a[h+1]=d[1],a[h+2]=d[2];return a};var d=a("./create")()},{"./create":334}],346:[function(a,b,c){b.exports=function(a,b,c){var d=new Float32Array(3);return d[0]=a,d[1]=b,d[2]=c,d}},{}],347:[function(a,b,c){b.exports={EPSILON:a("./epsilon"),create:a("./create"),clone:a("./clone"),angle:a("./angle"),fromValues:a("./fromValues"),copy:a("./copy"),set:a("./set"),equals:a("./equals"),exactEquals:a("./exactEquals"),add:a("./add"),subtract:a("./subtract"),sub:a("./sub"),multiply:a("./multiply"),mul:a("./mul"),divide:a("./divide"),div:a("./div"),min:a("./min"),max:a("./max"),floor:a("./floor"),ceil:a("./ceil"),round:a("./round"),scale:a("./scale"),scaleAndAdd:a("./scaleAndAdd"),distance:a("./distance"),dist:a("./dist"),squaredDistance:a("./squaredDistance"),sqrDist:a("./sqrDist"),length:a("./length"),len:a("./len"),squaredLength:a("./squaredLength"),sqrLen:a("./sqrLen"),negate:a("./negate"),inverse:a("./inverse"),normalize:a("./normalize"),dot:a("./dot"),cross:a("./cross"),lerp:a("./lerp"),random:a("./random"),transformMat4:a("./transformMat4"),transformMat3:a("./transformMat3"),transformQuat:a("./transformQuat"),rotateX:a("./rotateX"),rotateY:a("./rotateY"),rotateZ:a("./rotateZ"),forEach:a("./forEach")}},{"./add":329,"./angle":330,"./ceil":331,"./clone":332,"./copy":333,"./create":334,"./cross":335,"./dist":336,"./distance":337,"./div":338,"./divide":339,"./dot":340,"./epsilon":341,"./equals":342,"./exactEquals":343,"./floor":344,"./forEach":345,"./fromValues":346,"./inverse":348,"./len":349,"./length":350,"./lerp":351,"./max":352,"./min":353,"./mul":354,"./multiply":355,"./negate":356,"./normalize":357,"./random":358,"./rotateX":359,"./rotateY":360,"./rotateZ":361,"./round":362,"./scale":363,"./scaleAndAdd":364,"./set":365,"./sqrDist":366,"./sqrLen":367,"./squaredDistance":368,"./squaredLength":369,"./sub":370,"./subtract":371,"./transformMat3":372,"./transformMat4":373,"./transformQuat":374}],348:[function(a,b,c){b.exports=function(a,b){return a[0]=1/b[0],a[1]=1/b[1],a[2]=1/b[2],a}},{}],349:[function(a,b,c){b.exports=a("./length")},{"./length":350}],350:[function(a,b,c){b.exports=function(a){var b=a[0],c=a[1],d=a[2];return Math.sqrt(b*b+c*c+d*d)}},{}],351:[function(a,b,c){b.exports=function(a,b,c,d){var e=b[0],f=b[1],g=b[2];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=g+d*(c[2]-g),a}},{}],352:[function(a,b,c){b.exports=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a}},{}],353:[function(a,b,c){b.exports=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a}},{}],354:[function(a,b,c){b.exports=a("./multiply")},{"./multiply":355}],355:[function(a,b,c){b.exports=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a}},{}],356:[function(a,b,c){b.exports=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a}},{}],357:[function(a,b,c){b.exports=function(a,b){var c=b[0],d=b[1],e=b[2],f=c*c+d*d+e*e;return f>0&&(f=1/Math.sqrt(f),a[0]=b[0]*f,a[1]=b[1]*f,a[2]=b[2]*f),a}},{}],358:[function(a,b,c){b.exports=function(a,b){b=b||1;var c=2*Math.random()*Math.PI,d=2*Math.random()-1,e=Math.sqrt(1-d*d)*b;return a[0]=Math.cos(c)*e,a[1]=Math.sin(c)*e,a[2]=d*b,a}},{}],359:[function(a,b,c){b.exports=function(a,b,c,d){var e=c[1],f=c[2],g=b[1]-e,h=b[2]-f,i=Math.sin(d),j=Math.cos(d);return a[0]=b[0],a[1]=e+g*j-h*i,a[2]=f+g*i+h*j,a}},{}],360:[function(a,b,c){b.exports=function(a,b,c,d){var e=c[0],f=c[2],g=b[0]-e,h=b[2]-f,i=Math.sin(d),j=Math.cos(d);return a[0]=e+h*i+g*j,a[1]=b[1],a[2]=f+h*j-g*i,a}},{}],361:[function(a,b,c){b.exports=function(a,b,c,d){var e=c[0],f=c[1],g=b[0]-e,h=b[1]-f,i=Math.sin(d),j=Math.cos(d);return a[0]=e+g*j-h*i,a[1]=f+g*i+h*j,a[2]=b[2],a}},{}],362:[function(a,b,c){b.exports=function(a,b){
return a[0]=Math.round(b[0]),a[1]=Math.round(b[1]),a[2]=Math.round(b[2]),a}},{}],363:[function(a,b,c){b.exports=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a}},{}],364:[function(a,b,c){b.exports=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a}},{}],365:[function(a,b,c){b.exports=function(a,b,c,d){return a[0]=b,a[1]=c,a[2]=d,a}},{}],366:[function(a,b,c){b.exports=a("./squaredDistance")},{"./squaredDistance":368}],367:[function(a,b,c){b.exports=a("./squaredLength")},{"./squaredLength":369}],368:[function(a,b,c){b.exports=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e}},{}],369:[function(a,b,c){b.exports=function(a){var b=a[0],c=a[1],d=a[2];return b*b+c*c+d*d}},{}],370:[function(a,b,c){b.exports=a("./subtract")},{"./subtract":371}],371:[function(a,b,c){b.exports=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a}},{}],372:[function(a,b,c){b.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2];return a[0]=d*c[0]+e*c[3]+f*c[6],a[1]=d*c[1]+e*c[4]+f*c[7],a[2]=d*c[2]+e*c[5]+f*c[8],a}},{}],373:[function(a,b,c){b.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[3]*d+c[7]*e+c[11]*f+c[15];return g=g||1,a[0]=(c[0]*d+c[4]*e+c[8]*f+c[12])/g,a[1]=(c[1]*d+c[5]*e+c[9]*f+c[13])/g,a[2]=(c[2]*d+c[6]*e+c[10]*f+c[14])/g,a}},{}],374:[function(a,b,c){b.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2],j=c[3],k=j*d+h*f-i*e,l=j*e+i*d-g*f,m=j*f+g*e-h*d,n=-g*d-h*e-i*f;return a[0]=k*j+n*-g+l*-i-m*-h,a[1]=l*j+n*-h+m*-g-k*-i,a[2]=m*j+n*-i+k*-h-l*-g,a}},{}],375:[function(a,b,c){b.exports=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a[3]=b[3]+c[3],a}},{}],376:[function(a,b,c){b.exports=function(a){var b=new Float32Array(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b}},{}],377:[function(a,b,c){b.exports=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a}},{}],378:[function(a,b,c){b.exports=function(){var a=new Float32Array(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a}},{}],379:[function(a,b,c){b.exports=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return Math.sqrt(c*c+d*d+e*e+f*f)}},{}],380:[function(a,b,c){b.exports=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],a[3]=b[3]/c[3],a}},{}],381:[function(a,b,c){b.exports=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}},{}],382:[function(a,b,c){b.exports=function(a,b,c,d){var e=new Float32Array(4);return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e}},{}],383:[function(a,b,c){b.exports={create:a("./create"),clone:a("./clone"),fromValues:a("./fromValues"),copy:a("./copy"),set:a("./set"),add:a("./add"),subtract:a("./subtract"),multiply:a("./multiply"),divide:a("./divide"),min:a("./min"),max:a("./max"),scale:a("./scale"),scaleAndAdd:a("./scaleAndAdd"),distance:a("./distance"),squaredDistance:a("./squaredDistance"),length:a("./length"),squaredLength:a("./squaredLength"),negate:a("./negate"),inverse:a("./inverse"),normalize:a("./normalize"),dot:a("./dot"),lerp:a("./lerp"),random:a("./random"),transformMat4:a("./transformMat4"),transformQuat:a("./transformQuat")}},{"./add":375,"./clone":376,"./copy":377,"./create":378,"./distance":379,"./divide":380,"./dot":381,"./fromValues":382,"./inverse":384,"./length":385,"./lerp":386,"./max":387,"./min":388,"./multiply":389,"./negate":390,"./normalize":391,"./random":392,"./scale":393,"./scaleAndAdd":394,"./set":395,"./squaredDistance":396,"./squaredLength":397,"./subtract":398,"./transformMat4":399,"./transformQuat":400}],384:[function(a,b,c){b.exports=function(a,b){return a[0]=1/b[0],a[1]=1/b[1],a[2]=1/b[2],a[3]=1/b[3],a}},{}],385:[function(a,b,c){b.exports=function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return Math.sqrt(b*b+c*c+d*d+e*e)}},{}],386:[function(a,b,c){b.exports=function(a,b,c,d){var e=b[0],f=b[1],g=b[2],h=b[3];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=g+d*(c[2]-g),a[3]=h+d*(c[3]-h),a}},{}],387:[function(a,b,c){b.exports=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a[3]=Math.max(b[3],c[3]),a}},{}],388:[function(a,b,c){b.exports=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a[3]=Math.min(b[3],c[3]),a}},{}],389:[function(a,b,c){b.exports=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a[3]=b[3]*c[3],a}},{}],390:[function(a,b,c){b.exports=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=-b[3],a}},{}],391:[function(a,b,c){b.exports=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*c+d*d+e*e+f*f;return g>0&&(g=1/Math.sqrt(g),a[0]=c*g,a[1]=d*g,a[2]=e*g,a[3]=f*g),a}},{}],392:[function(a,b,c){var d=a("./normalize"),e=a("./scale");b.exports=function(a,b){return b=b||1,a[0]=Math.random(),a[1]=Math.random(),a[2]=Math.random(),a[3]=Math.random(),d(a,a),e(a,a,b),a}},{"./normalize":391,"./scale":393}],393:[function(a,b,c){b.exports=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a}},{}],394:[function(a,b,c){b.exports=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a[3]=b[3]+c[3]*d,a}},{}],395:[function(a,b,c){b.exports=function(a,b,c,d,e){return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a}},{}],396:[function(a,b,c){b.exports=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return c*c+d*d+e*e+f*f}},{}],397:[function(a,b,c){b.exports=function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return b*b+c*c+d*d+e*e}},{}],398:[function(a,b,c){b.exports=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a[3]=b[3]-c[3],a}},{}],399:[function(a,b,c){b.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3];return a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*g,a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*g,a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*g,a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*g,a}},{}],400:[function(a,b,c){b.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2],j=c[3],k=j*d+h*f-i*e,l=j*e+i*d-g*f,m=j*f+g*e-h*d,n=-g*d-h*e-i*f;return a[0]=k*j+n*-g+l*-i-m*-h,a[1]=l*j+n*-h+m*-g-k*-i,a[2]=m*j+n*-i+k*-h-l*-g,a[3]=b[3],a}},{}],401:[function(a,b,c){b.exports=function(a,b,c,f){return d[0]=f,d[1]=c,d[2]=b,d[3]=a,e[0]};var d=new Uint8Array(4),e=new Float32Array(d.buffer)},{}],402:[function(a,b,c){var d=a("glsl-tokenizer"),e=a("atob-lite");b.exports=function(a){for(var b=Array.isArray(a)?a:d(a),c=0;c<b.length;c++){var f=b[c];if("preprocessor"===f.type){var g=f.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(g&&g[2]){var h=g[1],i=g[2];return(h?e(i):i).trim()}}}}},{"atob-lite":73,"glsl-tokenizer":409}],403:[function(a,b,c){b.exports=function(a){function b(a){a.length&&N.push({type:w[L],data:a,position:Q,line:O,column:P})}function c(){return M=M.length?[]:M,"/"===H&&"*"===G?(Q=K+J-1,L=k,H=G,J+1):"/"===H&&"/"===G?(Q=K+J-1,L=l,H=G,J+1):"#"===G?(L=m,Q=K+J,J):/\s/.test(G)?(L=t,Q=K+J,J):(R=/\d/.test(G),S=/[^\w_]/.test(G),Q=K+J,L=R?o:S?n:j,J)}function x(){return/[^\s]/g.test(G)?(b(M.join("")),L=i,J):(M.push(G),H=G,J+1)}function y(){return"\r"!==G&&"\n"!==G||"\\"===H?(M.push(G),H=G,J+1):(b(M.join("")),L=i,J)}function z(){return"/"===G&&"*"===H?(M.push(G),b(M.join("")),L=i,J+1):(M.push(G),H=G,J+1)}function A(){if("."===H&&/\d/.test(G))return L=p,J;if("/"===H&&"*"===G)return L=k,J;if("/"===H&&"/"===G)return L=l,J;if("."===G&&M.length){for(;B(M););return L=p,J}if(";"===G||")"===G||"("===G){if(M.length)for(;B(M););return b(G),L=i,J+1}var a=2===M.length&&"="!==G;if(/[\w_\d\s]/.test(G)||a){for(;B(M););return L=i,J}return M.push(G),H=G,J+1}function B(a){for(var c,d,f=0;;){if(c=e.indexOf(a.slice(0,a.length+f).join("")),d=e[c],-1===c){if(f--+a.length>0)continue;d=a.slice(0,1).join("")}return b(d),Q+=d.length,(M=M.slice(d.length)).length}}function C(){return/[^a-fA-F0-9]/.test(G)?(b(M.join("")),L=i,J):(M.push(G),H=G,J+1)}function D(){return"."===G?(M.push(G),L=p,H=G,J+1):/[eE]/.test(G)?(M.push(G),L=p,H=G,J+1):"x"===G&&1===M.length&&"0"===M[0]?(L=v,M.push(G),H=G,J+1):/[^\d]/.test(G)?(b(M.join("")),L=i,J):(M.push(G),H=G,J+1)}function E(){return"f"===G&&(M.push(G),H=G,J+=1),/[eE]/.test(G)?(M.push(G),H=G,J+1):"-"===G&&/[eE]/.test(H)?(M.push(G),H=G,J+1):/[^\d]/.test(G)?(b(M.join("")),L=i,J):(M.push(G),H=G,J+1)}function F(){if(/[^\d\w_]/.test(G)){var a=M.join("");return L=V.indexOf(a)>-1?s:U.indexOf(a)>-1?r:q,b(M.join("")),L=i,J}return M.push(G),H=G,J+1}var G,H,I,J=0,K=0,L=i,M=[],N=[],O=1,P=0,Q=0,R=!1,S=!1,T="",U=f,V=d;return"300 es"===(a=a||{}).version&&(U=h,V=g),function(a){return N=[],null!==a?function(a){var b;for(J=0,I=(T+=a).length;G=T[J],J<I;){switch(b=J,L){case k:J=z();break;case l:case m:J=y();break;case n:J=A();break;case o:J=D();break;case v:J=C();break;case p:J=E();break;case j:J=F();break;case t:J=x();break;case i:J=c()}if(b!==J)switch(T[b]){case"\n":P=0,++O;break;default:++P}}return K+=J,T=T.slice(J),N}(a.replace?a.replace(/\r\n/g,"\n"):a):function(a){return M.length&&b(M.join("")),L=u,b("(eof)"),N}()}};var d=a("./lib/literals"),e=a("./lib/operators"),f=a("./lib/builtins"),g=a("./lib/literals-300es"),h=a("./lib/builtins-300es"),i=999,j=9999,k=0,l=1,m=2,n=3,o=4,p=5,q=6,r=7,s=8,t=9,u=10,v=11,w=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":405,"./lib/builtins-300es":404,"./lib/literals":407,"./lib/literals-300es":406,"./lib/operators":408}],404:[function(a,b,c){var d=a("./builtins");d=d.slice().filter(function(a){return!/^(gl\_|texture)/.test(a)}),b.exports=d.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":405}],405:[function(a,b,c){b.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],406:[function(a,b,c){var d=a("./literals");b.exports=d.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":407}],407:[function(a,b,c){b.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],408:[function(a,b,c){b.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],409:[function(a,b,c){var d=a("./index");b.exports=function(a,b){var c=d(b),e=[];return e=(e=e.concat(c(a))).concat(c(null))}},{"./index":403}],410:[function(a,b,c){b.exports=function(a){"string"==typeof a&&(a=[a]);for(var b=[].slice.call(arguments,1),c=[],d=0;d<a.length-1;d++)c.push(a[d],b[d]||"");return c.push(a[d]),c.join("")}},{}],411:[function(a,b,c){(function(c){"use strict";var d,e=a("is-browser");d="function"==typeof c.matchMedia?!c.matchMedia("(hover: none)").matches:e,b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"is-browser":418}],412:[function(a,b,c){"use strict";var d=a("is-browser");b.exports=d&&function(){var a=!1;try{var b=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("test",null,b),window.removeEventListener("test",null,b)}catch(b){a=!1}return a}()},{"is-browser":418}],413:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),(b+=g+l>=1?m/i:m*Math.pow(2,1-l))*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],414:[function(a,b,c){"use strict";function d(a,b,c){this.vertices=a,this.adjacent=b,this.boundary=c,this.lastVisited=-1}function e(a,b,c){this.vertices=a,this.cell=b,this.index=c}function f(a,b){return i(a.vertices,b.vertices)}function g(a,b,c){this.dimension=a,this.vertices=b,this.simplices=c,this.interior=c.filter(function(a){return!a.boundary}),this.tuple=new Array(a+1);for(var d=0;d<=a;++d)this.tuple[d]=this.vertices[d];var e=j[a];e||(e=j[a]=function(a){for(var b=["function orient(){var tuple=this.tuple;return test("],c=0;c<=a;++c)c>0&&b.push(","),b.push("tuple[",c,"]");b.push(")}return orient");var d=new Function("test",b.join("")),e=h[a+1];return e||(e=h),d(e)}(a)),this.orient=e}b.exports=function(a,b){var c=a.length;if(0===c)throw new Error("Must have at least d+1 points");var e=a[0].length;if(c<=e)throw new Error("Must input at least d+1 points");var f=a.slice(0,e+1),i=h.apply(void 0,f);if(0===i)throw new Error("Input not in general position");for(var j=new Array(e+1),k=0;k<=e;++k)j[k]=k;i<0&&(j[0]=1,j[1]=0);for(var l=new d(j,new Array(e+1),!1),m=l.adjacent,n=new Array(e+2),k=0;k<=e;++k){for(var o=j.slice(),p=0;p<=e;++p)p===k&&(o[p]=-1);var q=o[0];o[0]=o[1],o[1]=q;var r=new d(o,new Array(e+1),!0);m[k]=r,n[k]=r}n[e+1]=l;for(var k=0;k<=e;++k)for(var o=m[k].vertices,s=m[k].adjacent,p=0;p<=e;++p){var t=o[p];if(t<0)s[p]=l;else for(var u=0;u<=e;++u)m[u].vertices.indexOf(t)<0&&(s[p]=m[u])}for(var v=new g(e,f,n),w=!!b,k=e+1;k<c;++k)v.insert(a[k],w);return v.boundary()};var h=a("robust-orientation"),i=a("simplicial-complex").compareCells;d.prototype.flip=function(){var a=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=a;var b=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=b};var j=[],k=g.prototype;k.handleBoundaryDegeneracy=function(a,b){var c=this.dimension,d=this.vertices.length-1,e=this.tuple,f=this.vertices,g=[a];for(a.lastVisited=-d;g.length>0;){(a=g.pop()).vertices;for(var h=a.adjacent,i=0;i<=c;++i){var j=h[i];if(j.boundary&&!(j.lastVisited<=-d)){for(var k=j.vertices,l=0;l<=c;++l){var m=k[l];e[l]=m<0?b:f[m]}var n=this.orient();if(n>0)return j;j.lastVisited=-d,0===n&&g.push(j)}}}return null},k.walk=function(a,b){var c=this.vertices.length-1,d=this.dimension,e=this.vertices,f=this.tuple,g=b?this.interior.length*Math.random()|0:this.interior.length-1,h=this.interior[g];a:for(;!h.boundary;){for(var i=h.vertices,j=h.adjacent,k=0;k<=d;++k)f[k]=e[i[k]];for(h.lastVisited=c,k=0;k<=d;++k){var l=j[k];if(!(l.lastVisited>=c)){var m=f[k];f[k]=a;var n=this.orient();if(f[k]=m,n<0){h=l;continue a}l.boundary?l.lastVisited=-c:l.lastVisited=c}}return}return h},k.addPeaks=function(a,b){var c=this.vertices.length-1,g=this.dimension,h=this.vertices,i=this.tuple,j=this.interior,k=this.simplices,l=[b];b.lastVisited=c,b.vertices[b.vertices.indexOf(-1)]=c,b.boundary=!1,j.push(b);for(var m=[];l.length>0;){var n=(b=l.pop()).vertices,o=b.adjacent,p=n.indexOf(c);if(!(p<0))for(var q=0;q<=g;++q)if(q!==p){var r=o[q];if(r.boundary&&!(r.lastVisited>=c)){var s=r.vertices;if(r.lastVisited!==-c){for(var t=0,u=0;u<=g;++u)s[u]<0?(t=u,i[u]=a):i[u]=h[s[u]];if(this.orient()>0){s[t]=c,r.boundary=!1,j.push(r),l.push(r),r.lastVisited=c;continue}r.lastVisited=-c}var v=r.adjacent,w=n.slice(),x=o.slice(),y=new d(w,x,!0);k.push(y);var z=v.indexOf(b);if(!(z<0))for(v[z]=y,x[p]=r,w[q]=-1,x[q]=b,o[q]=y,y.flip(),u=0;u<=g;++u){var A=w[u];if(!(A<0||A===c)){for(var B=new Array(g-1),C=0,D=0;D<=g;++D){var E=w[D];E<0||D===u||(B[C++]=E)}m.push(new e(B,y,u))}}}}}for(m.sort(f),q=0;q+1<m.length;q+=2){var F=m[q],G=m[q+1],H=F.index,I=G.index;H<0||I<0||(F.cell.adjacent[F.index]=G.cell,G.cell.adjacent[G.index]=F.cell)}},k.insert=function(a,b){var c=this.vertices;c.push(a);var d=this.walk(a,b);if(d){for(var e=this.dimension,f=this.tuple,g=0;g<=e;++g){var h=d.vertices[g];f[g]=h<0?a:c[h]}var i=this.orient(f);i<0||(0!==i||(d=this.handleBoundaryDegeneracy(d,a)))&&this.addPeaks(a,d)}},k.boundary=function(){for(var a=this.dimension,b=[],c=this.simplices,d=c.length,e=0;e<d;++e){var f=c[e];if(f.boundary){for(var g=new Array(a),h=f.vertices,i=0,j=0,k=0;k<=a;++k)h[k]>=0?g[i++]=h[k]:j=1&k;if(j===(1&a)){var l=g[0];g[0]=g[1],g[1]=l}b.push(g)}}return b}},{"robust-orientation":511,"simplicial-complex":521}],415:[function(a,b,c){"use strict";function d(a,b,c,d,e){this.mid=a,this.left=b,this.right=c,this.leftPoints=d,this.rightPoints=e,this.count=(b?b.count:0)+(c?c.count:0)+d.length}function e(a,b){a.mid=b.mid,a.left=b.left,a.right=b.right,a.leftPoints=b.leftPoints,a.rightPoints=b.rightPoints,a.count=b.count}function f(a,b){var c=o(b);a.mid=c.mid,a.left=c.left,a.right=c.right,a.leftPoints=c.leftPoints,a.rightPoints=c.rightPoints,a.count=c.count}function g(a,b){var c=a.intervals([]);c.push(b),f(a,c)}function h(a,b){var c=a.intervals([]),d=c.indexOf(b);return d<0?r:(c.splice(d,1),f(a,c),s)}function i(a,b,c){for(var d=0;d<a.length&&a[d][0]<=b;++d){var e=c(a[d]);if(e)return e}}function j(a,b,c){for(var d=a.length-1;d>=0&&a[d][1]>=b;--d){var e=c(a[d]);if(e)return e}}function k(a,b){for(var c=0;c<a.length;++c){var d=b(a[c]);if(d)return d}}function l(a,b){return a-b}function m(a,b){return a[0]-b[0]||a[1]-b[1]}function n(a,b){return a[1]-b[1]||a[0]-b[0]}function o(a){if(0===a.length)return null;for(var b=[],c=0;c<a.length;++c)b.push(a[c][0],a[c][1]);b.sort(l);var e=b[b.length>>1],f=[],g=[],h=[];for(c=0;c<a.length;++c){var i=a[c];i[1]<e?f.push(i):e<i[0]?g.push(i):h.push(i)}var j=h,k=h.slice();return j.sort(m),k.sort(n),new d(e,o(f),o(g),j,k)}function p(a){this.root=a}var q=a("binary-search-bounds"),r=0,s=1;b.exports=function(a){return new p(a&&0!==a.length?o(a):null)};var t=d.prototype;t.intervals=function(a){return a.push.apply(a,this.leftPoints),this.left&&this.left.intervals(a),this.right&&this.right.intervals(a),a},t.insert=function(a){var b=this.count-this.leftPoints.length;if(this.count+=1,a[1]<this.mid)this.left?4*(this.left.count+1)>3*(b+1)?g(this,a):this.left.insert(a):this.left=o([a]);else if(a[0]>this.mid)this.right?4*(this.right.count+1)>3*(b+1)?g(this,a):this.right.insert(a):this.right=o([a]);else{var c=q.ge(this.leftPoints,a,m),d=q.ge(this.rightPoints,a,n);this.leftPoints.splice(c,0,a),this.rightPoints.splice(d,0,a)}},t.remove=function(a){var b=this.count-this.leftPoints;if(a[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(b-1)?h(this,a):2===(g=this.left.remove(a))?(this.left=null,this.count-=1,s):(g===s&&(this.count-=1),g):r;if(a[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(b-1)?h(this,a):2===(g=this.right.remove(a))?(this.right=null,this.count-=1,s):(g===s&&(this.count-=1),g):r;if(1===this.count)return this.leftPoints[0]===a?2:r;if(1===this.leftPoints.length&&this.leftPoints[0]===a){if(this.left&&this.right){for(var c=this,d=this.left;d.right;)c=d,d=d.right;if(c===this)d.right=this.right;else{var f=this.left,g=this.right;c.count-=d.count,c.right=d.left,d.left=f,d.right=g}e(this,d),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?e(this,this.left):e(this,this.right);return s}for(f=q.ge(this.leftPoints,a,m);f<this.leftPoints.length&&this.leftPoints[f][0]===a[0];++f)if(this.leftPoints[f]===a)for(this.count-=1,this.leftPoints.splice(f,1),g=q.ge(this.rightPoints,a,n);g<this.rightPoints.length&&this.rightPoints[g][1]===a[1];++g)if(this.rightPoints[g]===a)return this.rightPoints.splice(g,1),s;return r},t.queryPoint=function(a,b){if(a<this.mid)return this.left&&(c=this.left.queryPoint(a,b))?c:i(this.leftPoints,a,b);if(a>this.mid){var c;return this.right&&(c=this.right.queryPoint(a,b))?c:j(this.rightPoints,a,b)}return k(this.leftPoints,b)},t.queryInterval=function(a,b,c){var d;return a<this.mid&&this.left&&(d=this.left.queryInterval(a,b,c))?d:b>this.mid&&this.right&&(d=this.right.queryInterval(a,b,c))?d:b<this.mid?i(this.leftPoints,b,c):a>this.mid?j(this.rightPoints,a,c):k(this.leftPoints,c)};var u=p.prototype;u.insert=function(a){this.root?this.root.insert(a):this.root=new d(a[0],null,null,[a],[a])},u.remove=function(a){if(this.root){var b=this.root.remove(a);return 2===b&&(this.root=null),b!==r}return!1},u.queryPoint=function(a,b){if(this.root)return this.root.queryPoint(a,b)},u.queryInterval=function(a,b,c){if(a<=b&&this.root)return this.root.queryInterval(a,b,c)},Object.defineProperty(u,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(u,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":92}],416:[function(a,b,c){"use strict";b.exports=function(a,b){b=b||new Array(a.length);for(var c=0;c<a.length;++c)b[a[c]]=c;return b}},{}],417:[function(a,b,c){"use strict";b.exports=function(a){for(var b=new Array(a),c=0;c<a;++c)b[c]=c;return b}},{}],418:[function(a,b,c){b.exports=!0},{}],419:[function(a,b,c){function d(a){return!!a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}b.exports=function(a){return null!=a&&(d(a)||function(a){return"function"==typeof a.readFloatLE&&"function"==typeof a.slice&&d(a.slice(0,0))}(a)||!!a._isBuffer)}},{}],420:[function(a,b,c){"use strict";b.exports="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],421:[function(a,b,c){"use strict";function d(a){a||(a={});var b=a.ua;return b||"undefined"==typeof navigator||(b=navigator.userAgent),b&&b.headers&&"string"==typeof b.headers["user-agent"]&&(b=b.headers["user-agent"]),"string"==typeof b&&(a.tablet?f.test(b):e.test(b))}b.exports=d,b.exports.isMobile=d,b.exports.default=d;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,f=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i},{}],422:[function(a,b,c){"use strict";b.exports=function(a){var b=typeof a;return null!==a&&("object"===b||"function"===b)}},{}],423:[function(a,b,c){"use strict";var d=Object.prototype.toString;b.exports=function(a){var b;return"[object Object]"===d.call(a)&&(null===(b=Object.getPrototypeOf(a))||b===Object.getPrototypeOf({}))}},{}],424:[function(a,b,c){"use strict";b.exports=function(a){for(var b,c=a.length,d=0;d<c;d++)if(((b=a.charCodeAt(d))<9||b>13)&&32!==b&&133!==b&&160!==b&&5760!==b&&6158!==b&&(b<8192||b>8205)&&8232!==b&&8233!==b&&8239!==b&&8287!==b&&8288!==b&&12288!==b&&65279!==b)return!1;return!0}},{}],425:[function(a,b,c){"use strict";b.exports=function(a){return"string"==typeof a&&(a=a.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(a)&&/[\dz]$/i.test(a)&&a.length>4))}},{}],426:[function(a,b,c){b.exports=function(a,b,c){return a*(1-c)+b*c}},{}],427:[function(a,b,c){var d,e;d=this,e=function(){"use strict";function a(a,e){if(b)if(c){var f="var sharedChunk = {}; ("+b+")(sharedChunk); ("+c+")(sharedChunk);",g={};b(g),(d=e(g)).workerUrl=window.URL.createObjectURL(new Blob([f],{type:"text/javascript"}))}else c=e;else b=e}var b,c,d;return a(0,function(a){function b(a,b){return a(b={exports:{}},b.exports),b.exports}function c(a,b,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*b,this.by=3*(d-b)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=d,this.p2x=c,this.p2y=d}function d(a,b){this.x=a,this.y=b}function e(a,b){if(Array.isArray(a)){if(!Array.isArray(b)||a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(!e(a[c],b[c]))return!1;return!0}if("object"==typeof a&&null!==a&&null!==b){if("object"!=typeof b)return!1;if(Object.keys(a).length!==Object.keys(b).length)return!1;for(var d in a)if(!e(a[d],b[d]))return!1;return!0}return a===b}function f(a,b,c,d){var e=new Fd(a,b,c,d);return function(a){return e.solve(a)}}function g(a,b,c){return Math.min(c,Math.max(b,a))}function h(a,b,c){var d=c-b,e=((a-b)%d+d)%d+b;return e===b?c:e}function i(a){for(var b=[],c=arguments.length-1;c-- >0;)b[c]=arguments[c+1];for(var d=0,e=b;d<e.length;d+=1){var f=e[d];for(var g in f)a[g]=f[g]}return a}function j(){return Md++}function k(){return function a(b){return b?(b^16*Math.random()>>b/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function l(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function m(a,b){a.forEach(function(a){b[a]&&(b[a]=b[a].bind(b))})}function n(a,b){return-1!==a.indexOf(b,a.length-b.length)}function o(a,b,c){var d={};for(var e in a)d[e]=b.call(c||this,a[e],e,a);return d}function p(a,b,c){var d={};for(var e in a)b.call(c||this,a[e],e,a)&&(d[e]=a[e]);return d}function q(a){return Array.isArray(a)?a.map(q):"object"==typeof a&&a?o(a,q):a}function r(a){Nd[a]||("undefined"!=typeof console&&console.warn(a),Nd[a]=!0)}function s(a,b,c){return(c.y-a.y)*(b.x-a.x)>(b.y-a.y)*(c.x-a.x)}function t(a){for(var b=0,c=0,d=a.length,e=d-1,f=void 0,g=void 0;c<d;e=c++)f=a[c],b+=((g=a[e]).x-f.x)*(f.y+g.y);return b}function u(a){var b={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(a,c,d,e){var f=d||e;return b[c]=!f||f.toLowerCase(),""}),b["max-age"]){var c=parseInt(b["max-age"],10);isNaN(c)?delete b["max-age"]:b["max-age"]=c}return b}function v(a){try{var b=self[a];return b.setItem("_mapbox_test_",1),b.removeItem("_mapbox_test_"),!0}catch(a){return!1}}function w(a){var b=a.createTexture();a.bindTexture(a.TEXTURE_2D,b);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,Kd),a.isContextLost())return;Td.supported=!0}catch(a){}a.deleteTexture(b),Ud=!0}function x(a){return 0===a.indexOf("mapbox:")}function y(a){return Xd.test(a)}function z(a){var b=a.match(Yd);if(!b)throw new Error("Unable to parse URL object");return{protocol:b[1],authority:b[2],path:b[3]||"/",params:b[4]?b[4].split("&"):[]}}function A(a){var b=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+b}function B(a){if(!a)return null;var b,c=a.split(".");if(!c||3!==c.length)return null;try{return JSON.parse((b=c[1],decodeURIComponent(self.atob(b).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(a){return null}}function C(a){var b=a.indexOf("?");return b<0?a:a.slice(0,b)}function D(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function E(a,b){var c,d=new self.AbortController,e=new self.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,
headers:a.headers,referrer:ne(),signal:d.signal}),f=!1,g=!1,h=(c=e.url).indexOf("sku=")>0&&y(c);"json"===a.type&&e.headers.set("Accept","application/json");var i=function(c,d,f){if(!g){if(c&&"SecurityError"!==c.message&&r(c),d&&f)return j(d);var i=Date.now();self.fetch(e).then(function(c){if(c.ok){var d=h?c.clone():null;return j(c,d,i)}return b(new me(c.statusText,c.status,a.url))}).catch(function(a){20!==a.code&&b(new Error(a.message))})}},j=function(c,d,h){("arrayBuffer"===a.type?c.arrayBuffer():"json"===a.type?c.json():c.text()).then(function(a){g||(d&&h&&function(a,b,c){if(self.caches){var d={status:b.status,statusText:b.statusText,headers:new self.Headers};b.headers.forEach(function(a,b){return d.headers.set(b,a)});var e=u(b.headers.get("Cache-Control")||"");e["no-store"]||(e["max-age"]&&d.headers.set("Expires",new Date(c+1e3*e["max-age"]).toUTCString()),new Date(d.headers.get("Expires")).getTime()-c<he||function(a,b){if(void 0===$d)try{new Response(new ReadableStream),$d=!0}catch(a){$d=!1}$d?b(a.body):a.blob().then(b)}(b,function(b){var c=new self.Response(b,d);self.caches.open(ee).then(function(b){return b.put(C(a.url),c)}).catch(function(a){return r(a.message)})}))}}(e,d,h),f=!0,b(null,a,c.headers.get("Cache-Control"),c.headers.get("Expires")))}).catch(function(a){return b(new Error(a.message))})};return h?function(a,b){if(!self.caches)return b(null);var c=C(a.url);self.caches.open(ee).then(function(a){a.match(c).then(function(d){var e=function(a){if(!a)return!1;var b=new Date(a.headers.get("Expires")),c=u(a.headers.get("Cache-Control")||"");return b>Date.now()&&!c["no-cache"]}(d);a.delete(c),e&&a.put(c,d.clone()),b(null,d,e)}).catch(b)}).catch(b)}(e,i):i(null,null),{cancel:function(){g=!0,f||d.abort()}}}function F(a,b,c){c[a]&&-1!==c[a].indexOf(b)||(c[a]=c[a]||[],c[a].push(b))}function G(a,b,c){if(c&&c[a]){var d=c[a].indexOf(b);-1!==d&&c[a].splice(d,1)}}function H(a){var b=a.key,c=a.value;return c?[new we(b,c,"constants have been deprecated as of v8")]:[]}function I(a){for(var b=[],c=arguments.length-1;c-- >0;)b[c]=arguments[c+1];for(var d=0,e=b;d<e.length;d+=1){var f=e[d];for(var g in f)a[g]=f[g]}return a}function J(a){return a instanceof Number||a instanceof String||a instanceof Boolean}function K(a){return J(a)?a.valueOf():a}function L(a){if(Array.isArray(a))return a.map(L);if(a instanceof Object&&!J(a)){var b={};for(var c in a)b[c]=L(a[c]);return b}return K(a)}function M(a,b){return{kind:"array",itemType:a,N:b}}function N(a){if("array"===a.kind){var b=N(a.itemType);return"number"==typeof a.N?"array<"+b+", "+a.N+">":"value"===a.itemType.kind?"array":"array<"+b+">"}return a.kind}function O(a,b){if("error"===b.kind)return null;if("array"===a.kind){if("array"===b.kind&&(0===b.N&&"value"===b.itemType.kind||!O(a.itemType,b.itemType))&&("number"!=typeof a.N||a.N===b.N))return null}else{if(a.kind===b.kind)return null;if("value"===a.kind)for(var c=0,d=Ie;c<d.length;c+=1)if(!O(d[c],b))return null}return"Expected "+N(a)+" but found "+N(b)+" instead."}function P(a,b,c,d){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof b&&b>=0&&b<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===d||"number"==typeof d&&d>=0&&d<=1?null:"Invalid rgba value ["+[a,b,c,d].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof d?[a,b,c,d]:[a,b,c]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Q(a){if(null===a)return ze;if("string"==typeof a)return Be;if("boolean"==typeof a)return Ce;if("number"==typeof a)return Ae;if(a instanceof Ke)return De;if(a instanceof Le)return Ge;if(a instanceof Ne)return He;if(Array.isArray(a)){for(var b,c=a.length,d=0,e=a;d<e.length;d+=1){var f=Q(e[d]);if(b){if(b===f)continue;b=Fe;break}b=f}return M(b||Fe,c)}return Ee}function R(a){var b=typeof a;return null===a?"":"string"===b||"number"===b||"boolean"===b?String(a):a instanceof Ke||a instanceof Ne?a.toString():JSON.stringify(a)}function S(a){if(a instanceof Xe){if("get"===a.name&&1===a.args.length)return!1;if("feature-state"===a.name)return!1;if("has"===a.name&&1===a.args.length)return!1;if("properties"===a.name||"geometry-type"===a.name||"id"===a.name)return!1;if(/^filter-/.test(a.name))return!1}var b=!0;return a.eachChild(function(a){b&&!S(a)&&(b=!1)}),b}function T(a){if(a instanceof Xe&&"feature-state"===a.name)return!1;var b=!0;return a.eachChild(function(a){b&&!T(a)&&(b=!1)}),b}function U(a,b){if(a instanceof Xe&&b.indexOf(a.name)>=0)return!1;var c=!0;return a.eachChild(function(a){c&&!U(a,b)&&(c=!1)}),c}function V(a,b){for(var c,d,e=a.length-1,f=0,g=e,h=0;f<=g;)if(c=a[h=Math.floor((f+g)/2)],d=a[h+1],c<=b){if(h===e||b<d)return h;f=h+1}else{if(!(c>b))throw new Pe("Input is not a number.");g=h-1}return 0}function W(a,b,c){return a*(1-c)+b*c}function X(a){return a>hf?Math.pow(a,1/3):a/gf+ef}function Y(a){return a>ff?a*a*a:gf*(a-ef)}function Z(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function $(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function _(a){var b=$(a.r),c=$(a.g),d=$(a.b),e=X((.4124564*b+.3575761*c+.1804375*d)/bf),f=X((.2126729*b+.7151522*c+.072175*d)/cf);return{l:116*f-16,a:500*(e-f),b:200*(f-X((.0193339*b+.119192*c+.9503041*d)/df)),alpha:a.a}}function aa(a){var b=(a.l+16)/116,c=isNaN(a.a)?b:b+a.a/500,d=isNaN(a.b)?b:b-a.b/200;return b=cf*Y(b),c=bf*Y(c),d=df*Y(d),new Ke(Z(3.2404542*c-1.5371385*b-.4985314*d),Z(-.969266*c+1.8760108*b+.041556*d),Z(.0556434*c-.2040259*b+1.0572252*d),a.alpha)}function ba(a,b,c,d){var e=d-c,f=a-c;return 0===e?0:1===b?f/e:(Math.pow(b,f)-1)/(Math.pow(b,e)-1)}function ca(a,b){return"=="===a||"!="===a?"boolean"===b.kind||"string"===b.kind||"number"===b.kind||"null"===b.kind||"value"===b.kind:"string"===b.kind||"number"===b.kind||"value"===b.kind}function da(a,b,c,d){return 0===d.compare(b,c)}function ea(a,b,c){var d="=="!==a&&"!="!==a;return function(){function e(a,b,c){this.type=Ce,this.lhs=a,this.rhs=b,this.collator=c,this.hasUntypedArgument="value"===a.type.kind||"value"===b.type.kind}return e.parse=function(a,b){if(3!==a.length&&4!==a.length)return b.error("Expected two or three arguments.");var c=a[0],f=b.parse(a[1],1,Fe);if(!f)return null;if(!ca(c,f.type))return b.concat(1).error('"'+c+"\" comparisons are not supported for type '"+N(f.type)+"'.");var g=b.parse(a[2],2,Fe);if(!g)return null;if(!ca(c,g.type))return b.concat(2).error('"'+c+"\" comparisons are not supported for type '"+N(g.type)+"'.");if(f.type.kind!==g.type.kind&&"value"!==f.type.kind&&"value"!==g.type.kind)return b.error("Cannot compare types '"+N(f.type)+"' and '"+N(g.type)+"'.");d&&("value"===f.type.kind&&"value"!==g.type.kind?f=new Re(g.type,[f]):"value"!==f.type.kind&&"value"===g.type.kind&&(g=new Re(f.type,[g])));var h=null;if(4===a.length){if("string"!==f.type.kind&&"string"!==g.type.kind&&"value"!==f.type.kind&&"value"!==g.type.kind)return b.error("Cannot use collator to compare non-string types.");if(!(h=b.parse(a[3],3,Ge)))return null}return new e(f,g,h)},e.prototype.evaluate=function(e){var f=this.lhs.evaluate(e),g=this.rhs.evaluate(e);if(d&&this.hasUntypedArgument){var h=Q(f),i=Q(g);if(h.kind!==i.kind||"string"!==h.kind&&"number"!==h.kind)throw new Pe('Expected arguments for "'+a+'" to be (string, string) or (number, number), but found ('+h.kind+", "+i.kind+") instead.")}if(this.collator&&!d&&this.hasUntypedArgument){var j=Q(f),k=Q(g);if("string"!==j.kind||"string"!==k.kind)return b(e,f,g)}return this.collator?c(e,f,g,this.collator.evaluate(e)):b(e,f,g)},e.prototype.eachChild=function(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)},e.prototype.possibleOutputs=function(){return[!0,!1]},e.prototype.serialize=function(){var b=[a];return this.eachChild(function(a){b.push(a.serialize())}),b},e}()}function fa(a,b){var c=b[0],d=b[1],e=b[2],f=b[3];c=c.evaluate(a),d=d.evaluate(a),e=e.evaluate(a);var g=f?f.evaluate(a):1,h=P(c,d,e,g);if(h)throw new Pe(h);return new Ke(c/255*g,d/255*g,e/255*g,g)}function ga(a,b){return a in b}function ha(a,b){var c=b[a];return void 0===c?null:c}function ia(a){return{type:a}}function ja(a){return{result:"success",value:a}}function ka(a){return{result:"error",value:a}}function la(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]}function ma(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function na(a){return!!a.expression&&a.expression.interpolated}function oa(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function pa(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function qa(a){return a}function ra(a,b,c){return void 0!==a?a:void 0!==b?b:void 0!==c?c:void 0}function sa(a,b,c,d,e){return ra(typeof c===e?d[c]:void 0,a.default,b.default)}function ta(a,b,c){if("number"!==oa(c))return ra(a.default,b.default);var d=a.stops.length;if(1===d)return a.stops[0][1];if(c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[d-1][0])return a.stops[d-1][1];var e=V(a.stops.map(function(a){return a[0]}),c);return a.stops[e][1]}function ua(a,b,c){var d=void 0!==a.base?a.base:1;if("number"!==oa(c))return ra(a.default,b.default);var e=a.stops.length;if(1===e)return a.stops[0][1];if(c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[e-1][0])return a.stops[e-1][1];var f=V(a.stops.map(function(a){return a[0]}),c),g=function(a,b,c,d){var e=d-c,f=a-c;return 0===e?0:1===b?f/e:(Math.pow(b,f)-1)/(Math.pow(b,e)-1)}(c,d,a.stops[f][0],a.stops[f+1][0]),h=a.stops[f][1],i=a.stops[f+1][1],j=af[b.type]||qa;if(a.colorSpace&&"rgb"!==a.colorSpace){var k=nf[a.colorSpace];j=function(a,b){return k.reverse(k.interpolate(k.forward(a),k.forward(b),g))}}return"function"==typeof h.evaluate?{evaluate:function(){for(var a=[],b=arguments.length;b--;)a[b]=arguments[b];var c=h.evaluate.apply(void 0,a),d=i.evaluate.apply(void 0,a);if(void 0!==c&&void 0!==d)return j(c,d,g)}}:j(h,i,g)}function va(a,b,c){return"color"===b.type?c=Ke.parse(c):"formatted"===b.type?c=Ne.fromString(c.toString()):oa(c)===b.type||"enum"===b.type&&b.values[c]||(c=void 0),ra(c,a.default,b.default)}function wa(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in Cf}function xa(a,b){var c=new $e(Cf,[],b?function(a){var b={color:De,string:Be,number:Ae,enum:Be,boolean:Ce,formatted:He};return"array"===a.type?M(b[a.value]||Fe,a.length):b[a.type]}(b):void 0),d=c.parse(a,void 0,void 0,void 0,b&&"string"===b.type?{typeAnnotation:"coerce"}:void 0);return d?ja(new Df(d,b)):ka(c.errors)}function ya(a,b){if("error"===(a=xa(a,b)).result)return a;var c=a.value.expression,d=S(c);if(!d&&!la(b))return ka([new xe("","data expressions not supported")]);var e=U(c,["zoom"]);if(!e&&!ma(b))return ka([new xe("","zoom expressions not supported")]);var f=function a(b){var c=null;if(b instanceof qf)c=a(b.result);else if(b instanceof pf)for(var d=0,e=b.args;d<e.length;d+=1){var f=e[d];if(c=a(f))break}else(b instanceof _e||b instanceof of)&&b.input instanceof Xe&&"zoom"===b.input.name&&(c=b);return c instanceof xe?c:(b.eachChild(function(b){var d=a(b);d instanceof xe?c=d:!c&&d?c=new xe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&d&&c!==d&&(c=new xe("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),c)}(c);if(!f&&!e)return ka([new xe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(f instanceof xe)return ka([f]);if(f instanceof of&&!na(b))return ka([new xe("",'"interpolate" expressions cannot be used with this property')]);if(!f)return ja(new Ef(d?"constant":"source",a.value));var g=f instanceof of?f.interpolation:void 0;return ja(new Ff(d?"camera":"composite",a.value,f.labels,g))}function za(a){var b=a.key,c=a.value,d=a.valueSpec||{},e=a.objectElementValidators||{},f=a.style,g=a.styleSpec,h=[],i=oa(c);if("object"!==i)return[new we(b,c,"object expected, "+i+" found")];for(var j in c){var k=j.split(".")[0],l=d[k]||d["*"],m=void 0;if(e[k])m=e[k];else if(d[k])m=Va;else if(e["*"])m=e["*"];else{if(!d["*"]){h.push(new we(b,c[j],'unknown property "'+j+'"'));continue}m=Va}h=h.concat(m({key:(b?b+".":b)+j,value:c[j],valueSpec:l,style:f,styleSpec:g,object:c,objectKey:j},c))}for(var n in d)e[n]||d[n].required&&void 0===d[n].default&&void 0===c[n]&&h.push(new we(b,c,'missing required property "'+n+'"'));return h}function Aa(a){var b=a.value,c=a.valueSpec,d=a.style,e=a.styleSpec,f=a.key,g=a.arrayElementValidator||Va;if("array"!==oa(b))return[new we(f,b,"array expected, "+oa(b)+" found")];if(c.length&&b.length!==c.length)return[new we(f,b,"array length "+c.length+" expected, length "+b.length+" found")];if(c["min-length"]&&b.length<c["min-length"])return[new we(f,b,"array length at least "+c["min-length"]+" expected, length "+b.length+" found")];var h={type:c.value,values:c.values};e.$version<7&&(h.function=c.function),"object"===oa(c.value)&&(h=c.value);for(var i=[],j=0;j<b.length;j++)i=i.concat(g({array:b,arrayIndex:j,value:b[j],valueSpec:h,style:d,styleSpec:e,key:f+"["+j+"]"}));return i}function Ba(a){var b=a.key,c=a.value,d=a.valueSpec,e=oa(c);return"number"!==e?[new we(b,c,"number expected, "+e+" found")]:"minimum"in d&&c<d.minimum?[new we(b,c,c+" is less than the minimum value "+d.minimum)]:"maximum"in d&&c>d.maximum?[new we(b,c,c+" is greater than the maximum value "+d.maximum)]:[]}function Ca(a){function b(a){var b=[],d=a.value,h=a.key;if("array"!==oa(d))return[new we(h,d,"array expected, "+oa(d)+" found")];if(2!==d.length)return[new we(h,d,"array length 2 expected, length "+d.length+" found")];if(l){if("object"!==oa(d[0]))return[new we(h,d,"object expected, "+oa(d[0])+" found")];if(void 0===d[0].zoom)return[new we(h,d,"object stop key must have zoom")];if(void 0===d[0].value)return[new we(h,d,"object stop key must have value")];if(f&&f>K(d[0].zoom))return[new we(h,d[0].zoom,"stop zoom values must appear in ascending order")];K(d[0].zoom)!==f&&(f=K(d[0].zoom),e=void 0,i={}),b=b.concat(za({key:h+"[0]",value:d[0],valueSpec:{zoom:{}},style:a.style,styleSpec:a.styleSpec,objectElementValidators:{zoom:Ba,value:c}}))}else b=b.concat(c({key:h+"[0]",value:d[0],valueSpec:{},style:a.style,styleSpec:a.styleSpec},d));return wa(L(d[1]))?b.concat([new we(h+"[1]",d[1],"expressions are not allowed in function stops.")]):b.concat(Va({key:h+"[1]",value:d[1],valueSpec:g,style:a.style,styleSpec:a.styleSpec}))}function c(a,b){var c=oa(a.value),f=K(a.value),j=null!==a.value?a.value:b;if(d){if(c!==d)return[new we(a.key,j,c+" stop domain type must match previous stop domain type "+d)]}else d=c;if("number"!==c&&"string"!==c&&"boolean"!==c)return[new we(a.key,j,"stop domain value must be a number, string, or boolean")];if("number"!==c&&"categorical"!==h){var k="number expected, "+c+" found";return la(g)&&void 0===h&&(k+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new we(a.key,j,k)]}return"categorical"!==h||"number"!==c||isFinite(f)&&Math.floor(f)===f?"categorical"!==h&&"number"===c&&void 0!==e&&f<e?[new we(a.key,j,"stop domain values must appear in ascending order")]:(e=f,"categorical"===h&&f in i?[new we(a.key,j,"stop domain values must be unique")]:(i[f]=!0,[])):[new we(a.key,j,"integer expected, found "+f)]}var d,e,f,g=a.valueSpec,h=K(a.value.type),i={},j="categorical"!==h&&void 0===a.value.property,k=!j,l="array"===oa(a.value.stops)&&"array"===oa(a.value.stops[0])&&"object"===oa(a.value.stops[0][0]),m=za({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(a){if("identity"===h)return[new we(a.key,a.value,'identity function may not have a "stops" property')];var c=[],d=a.value;return c=c.concat(Aa({key:a.key,value:d,valueSpec:a.valueSpec,style:a.style,styleSpec:a.styleSpec,arrayElementValidator:b})),"array"===oa(d)&&0===d.length&&c.push(new we(a.key,d,"array must have at least one stop")),c},default:function(a){return Va({key:a.key,value:a.value,valueSpec:g,style:a.style,styleSpec:a.styleSpec})}}});return"identity"===h&&j&&m.push(new we(a.key,a.value,'missing required property "property"')),"identity"===h||a.value.stops||m.push(new we(a.key,a.value,'missing required property "stops"')),"exponential"===h&&a.valueSpec.expression&&!na(a.valueSpec)&&m.push(new we(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(k&&!la(a.valueSpec)?m.push(new we(a.key,a.value,"property functions not supported")):j&&!ma(a.valueSpec)&&m.push(new we(a.key,a.value,"zoom functions not supported"))),"categorical"!==h&&!l||void 0!==a.value.property||m.push(new we(a.key,a.value,'"property" property is required')),m}function Da(a){var b=("property"===a.expressionContext?ya:xa)(L(a.value),a.valueSpec);if("error"===b.result)return b.value.map(function(b){return new we(""+a.key+b.key,a.value,b.message)});var c=b.value.expression||b.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&-1!==c.possibleOutputs().indexOf(void 0))return[new we(a.key,a.value,'Invalid data expression for "'+a.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===a.expressionContext&&"layout"===a.propertyType&&!T(c))return[new we(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext&&!T(c))return[new we(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!U(c,["zoom","feature-state"]))return[new we(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!S(c))return[new we(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ea(a){var b=a.key,c=a.value,d=a.valueSpec,e=[];return Array.isArray(d.values)?-1===d.values.indexOf(K(c))&&e.push(new we(b,c,"expected one of ["+d.values.join(", ")+"], "+JSON.stringify(c)+" found")):-1===Object.keys(d.values).indexOf(K(c))&&e.push(new we(b,c,"expected one of ["+Object.keys(d.values).join(", ")+"], "+JSON.stringify(c)+" found")),e}function Fa(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(var b=0,c=a.slice(1);b<c.length;b+=1){var d=c[b];if(!Fa(d)&&"boolean"!=typeof d)return!1}return!0;default:return!0}}function Ga(a){if(null==a)return function(){return!0};Fa(a)||(a=Ia(a));var b=xa(a,Hf);if("error"===b.result)throw new Error(b.value.map(function(a){return a.key+": "+a.message}).join(", "));return function(a,c){return b.value.evaluate(a,c)}}function Ha(a,b){return a<b?-1:a>b?1:0}function Ia(a){if(!a)return!0;var b,c=a[0];return a.length<=1?"any"!==c:"=="===c?Ja(a[1],a[2],"=="):"!="===c?Ma(Ja(a[1],a[2],"==")):"<"===c||">"===c||"<="===c||">="===c?Ja(a[1],a[2],c):"any"===c?(b=a.slice(1),["any"].concat(b.map(Ia))):"all"===c?["all"].concat(a.slice(1).map(Ia)):"none"===c?["all"].concat(a.slice(1).map(Ia).map(Ma)):"in"===c?Ka(a[1],a.slice(2)):"!in"===c?Ma(Ka(a[1],a.slice(2))):"has"===c?La(a[1]):"!has"!==c||Ma(La(a[1]))}function Ja(a,b,c){switch(a){case"$type":return["filter-type-"+c,b];case"$id":return["filter-id-"+c,b];default:return["filter-"+c,a,b]}}function Ka(a,b){if(0===b.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",b]];case"$id":return["filter-id-in",["literal",b]];default:return b.length>200&&!b.some(function(a){return typeof a!=typeof b[0]})?["filter-in-large",a,["literal",b.sort(Ha)]]:["filter-in-small",a,["literal",b]]}}function La(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Ma(a){return["!",a]}function Na(a){return Fa(L(a.value))?Da(I({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function a(b){var c=b.value,d=b.key;if("array"!==oa(c))return[new we(d,c,"array expected, "+oa(c)+" found")];var e,f=b.styleSpec,g=[];if(c.length<1)return[new we(d,c,"filter array must have at least 1 element")];switch(g=g.concat(Ea({key:d+"[0]",value:c[0],valueSpec:f.filter_operator,style:b.style,styleSpec:b.styleSpec})),K(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&"$type"===K(c[1])&&g.push(new we(d,c,'"$type" cannot be use with operator "'+c[0]+'"'));case"==":case"!=":3!==c.length&&g.push(new we(d,c,'filter array for operator "'+c[0]+'" must have 3 elements'));case"in":case"!in":c.length>=2&&"string"!==(e=oa(c[1]))&&g.push(new we(d+"[1]",c[1],"string expected, "+e+" found"));for(var h=2;h<c.length;h++)e=oa(c[h]),"$type"===K(c[1])?g=g.concat(Ea({key:d+"["+h+"]",value:c[h],valueSpec:f.geometry_type,style:b.style,styleSpec:b.styleSpec})):"string"!==e&&"number"!==e&&"boolean"!==e&&g.push(new we(d+"["+h+"]",c[h],"string, number, or boolean expected, "+e+" found"));break;case"any":case"all":case"none":for(var i=1;i<c.length;i++)g=g.concat(a({key:d+"["+i+"]",value:c[i],style:b.style,styleSpec:b.styleSpec}));break;case"has":case"!has":e=oa(c[1]),2!==c.length?g.push(new we(d,c,'filter array for "'+c[0]+'" operator must have 2 elements')):"string"!==e&&g.push(new we(d+"[1]",c[1],"string expected, "+e+" found"))}return g}(a)}function Oa(a,b){var c=a.key,d=a.style,e=a.styleSpec,f=a.value,g=a.objectKey,h=e[b+"_"+a.layerType];if(!h)return[];var i=g.match(/^(.*)-transition$/);if("paint"===b&&i&&h[i[1]]&&h[i[1]].transition)return Va({key:c,value:f,valueSpec:e.transition,style:d,styleSpec:e});var j,k=a.valueSpec||h[g];if(!k)return[new we(c,f,'unknown property "'+g+'"')];if("string"===oa(f)&&la(k)&&!k.tokens&&(j=/^{([^}]+)}$/.exec(f)))return[new we(c,f,'"'+g+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(j[1])+" }`.")];var l=[];return"symbol"===a.layerType&&("text-field"===g&&d&&!d.glyphs&&l.push(new we(c,f,'use of "text-field" requires a style "glyphs" property')),"text-font"===g&&pa(L(f))&&"identity"===K(f.type)&&l.push(new we(c,f,'"text-font" does not support identity functions'))),l.concat(Va({key:a.key,value:f,valueSpec:k,style:d,styleSpec:e,expressionContext:"property",propertyType:b,propertyKey:g}))}function Pa(a){return Oa(a,"paint")}function Qa(a){return Oa(a,"layout")}function Ra(a){var b=[],c=a.value,d=a.key,e=a.style,f=a.styleSpec;c.type||c.ref||b.push(new we(d,c,'either "type" or "ref" is required'));var g,h=K(c.type),i=K(c.ref);if(c.id)for(var j=K(c.id),k=0;k<a.arrayIndex;k++){var l=e.layers[k];K(l.id)===j&&b.push(new we(d,c.id,'duplicate layer id "'+c.id+'", previously used at line '+l.id.__line__))}if("ref"in c)["type","source","source-layer","filter","layout"].forEach(function(a){a in c&&b.push(new we(d,c[a],'"'+a+'" is prohibited for ref layers'))}),e.layers.forEach(function(a){K(a.id)===i&&(g=a)}),g?g.ref?b.push(new we(d,c.ref,"ref cannot reference another ref layer")):h=K(g.type):b.push(new we(d,c.ref,'ref layer "'+i+'" not found'));else if("background"!==h)if(c.source){var m=e.sources&&e.sources[c.source],n=m&&K(m.type);m?"vector"===n&&"raster"===h?b.push(new we(d,c.source,'layer "'+c.id+'" requires a raster source')):"raster"===n&&"raster"!==h?b.push(new we(d,c.source,'layer "'+c.id+'" requires a vector source')):"vector"!==n||c["source-layer"]?"raster-dem"===n&&"hillshade"!==h?b.push(new we(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==h||!c.paint||!c.paint["line-gradient"]||"geojson"===n&&m.lineMetrics||b.push(new we(d,c,'layer "'+c.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):b.push(new we(d,c,'layer "'+c.id+'" must specify a "source-layer"')):b.push(new we(d,c.source,'source "'+c.source+'" not found'))}else b.push(new we(d,c,'missing required property "source"'));return b=b.concat(za({key:d,value:c,valueSpec:f.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Va({key:d+".type",value:c.type,valueSpec:f.layer.type,style:a.style,styleSpec:a.styleSpec,object:c,objectKey:"type"})},filter:Na,layout:function(a){return za({layer:c,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return Qa(I({layerType:h},a))}}})},paint:function(a){return za({layer:c,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return Pa(I({layerType:h},a))}}})}}}))}function Sa(a){var b=a.value,c=a.key,d=a.styleSpec,e=a.style;if(!b.type)return[new we(c,b,'"type" is required')];var f,g=K(b.type);switch(g){case"vector":case"raster":case"raster-dem":return za({key:c,value:b,valueSpec:d["source_"+g.replace("-","_")],style:a.style,styleSpec:d});case"geojson":if(f=za({key:c,value:b,valueSpec:d.source_geojson,style:e,styleSpec:d}),b.cluster)for(var h in b.clusterProperties){var i=b.clusterProperties[h],j=i[0],k=i[1],l="string"==typeof j?[j,["accumulated"],["get",h]]:j;f.push.apply(f,Da({key:c+"."+h+".map",value:k,expressionContext:"cluster-map"})),f.push.apply(f,Da({key:c+"."+h+".reduce",value:l,expressionContext:"cluster-reduce"}))}return f;case"video":return za({key:c,value:b,valueSpec:d.source_video,style:e,styleSpec:d});case"image":return za({key:c,value:b,valueSpec:d.source_image,style:e,styleSpec:d});case"canvas":return[new we(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ea({key:c+".type",value:b.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:e,styleSpec:d})}}function Ta(a){var b=a.value,c=a.styleSpec,d=c.light,e=a.style,f=[],g=oa(b);if(void 0===b)return f;if("object"!==g)return f.concat([new we("light",b,"object expected, "+g+" found")]);for(var h in b){var i=h.match(/^(.*)-transition$/);f=i&&d[i[1]]&&d[i[1]].transition?f.concat(Va({key:h,value:b[h],valueSpec:c.transition,style:e,styleSpec:c})):d[h]?f.concat(Va({key:h,value:b[h],valueSpec:d[h],style:e,styleSpec:c})):f.concat([new we(h,b[h],'unknown property "'+h+'"')])}return f}function Ua(a){var b=a.value,c=a.key,d=oa(b);return"string"!==d?[new we(c,b,"string expected, "+d+" found")]:[]}function Va(a){var b=a.value,c=a.valueSpec,d=a.styleSpec;return c.expression&&pa(K(b))?Ca(a):c.expression&&wa(L(b))?Da(a):c.type&&If[c.type]?If[c.type](a):za(I({},a,{valueSpec:c.type?d[c.type]:c}))}function Wa(a){var b=a.value,c=a.key,d=Ua(a);return d.length?d:(-1===b.indexOf("{fontstack}")&&d.push(new we(c,b,'"glyphs" url must include a "{fontstack}" token')),-1===b.indexOf("{range}")&&d.push(new we(c,b,'"glyphs" url must include a "{range}" token')),d)}function Xa(a,b){b=b||ve;var c=[];return c=c.concat(Va({key:"",value:a,valueSpec:b.$root,styleSpec:b,style:a,objectElementValidators:{glyphs:Wa,"*":function(){return[]}}})),a.constants&&(c=c.concat(H({key:"constants",value:a.constants,style:a,styleSpec:b}))),Ya(c)}function Ya(a){return[].concat(a).sort(function(a,b){return a.line-b.line})}function Za(a){return function(){for(var b=[],c=arguments.length;c--;)b[c]=arguments[c];return Ya(a.apply(this,b))}}function $a(a,b){var c=!1;if(b&&b.length)for(var d=0,e=b;d<e.length;d+=1){var f=e[d];a.fire(new te(new Error(f.message))),c=!0}return c}function _a(a,b,c){var d=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var e=new Int32Array(this.arrayBuffer);a=e[0],b=e[1],c=e[2],this.d=b+2*c;for(var f=0;f<this.d*this.d;f++){var g=e[Of+f],h=e[Of+f+1];d.push(g===h?null:e.subarray(g,h))}var i=e[Of+d.length],j=e[Of+d.length+1];this.keys=e.subarray(i,j),this.bboxes=e.subarray(j),this.insert=this._insertReadonly}else{this.d=b+2*c;for(var k=0;k<this.d*this.d;k++)d.push([]);this.keys=[],this.bboxes=[]}this.n=b,this.extent=a,this.padding=c,this.scale=b/a,this.uid=0;var l=c/b*a;this.min=-l,this.max=a+l}function ab(a,b,c){void 0===c&&(c={}),Object.defineProperty(b,"_classRegistryKey",{value:a,writeable:!1}),Qf[a]={klass:b,omit:c.omit||[],shallow:c.shallow||[]}}function bb(a,b){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(a instanceof ArrayBuffer)return b&&b.push(a),a;if(ArrayBuffer.isView(a)){var c=a;return b&&b.push(c.buffer),c}if(a instanceof Pf)return b&&b.push(a.data.buffer),a;if(Array.isArray(a)){for(var d=[],e=0,f=a;e<f.length;e+=1){var g=f[e];d.push(bb(g,b))}return d}if("object"==typeof a){var h=a.constructor,i=h._classRegistryKey;if(!i)throw new Error("can't serialize object of unregistered class");var j=h.serialize?h.serialize(a,b):{};if(!h.serialize){for(var k in a)if(a.hasOwnProperty(k)&&!(Qf[i].omit.indexOf(k)>=0)){var l=a[k];j[k]=Qf[i].shallow.indexOf(k)>=0?l:bb(l,b)}a instanceof Error&&(j.message=a.message)}if(j.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==i&&(j.$name=i),j}throw new Error("can't serialize object of type "+typeof a)}function cb(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof ArrayBuffer||ArrayBuffer.isView(a)||a instanceof Pf)return a;if(Array.isArray(a))return a.map(cb);if("object"==typeof a){var b=a.$name||"Object",c=Qf[b].klass;if(!c)throw new Error("can't deserialize unregistered class "+b);if(c.deserialize)return c.deserialize(a);for(var d=Object.create(c.prototype),e=0,f=Object.keys(a);e<f.length;e+=1){var g=f[e];if("$name"!==g){var h=a[g];d[g]=Qf[b].shallow.indexOf(g)>=0?h:cb(h)}}return d}throw new Error("can't deserialize object of type "+typeof a)}function db(a){for(var b=0,c=a;b<c.length;b+=1)if(fb(c[b].charCodeAt(0)))return!0;return!1}function eb(a){return!(Uf.Arabic(a)||Uf["Arabic Supplement"](a)||Uf["Arabic Extended-A"](a)||Uf["Arabic Presentation Forms-A"](a)||Uf["Arabic Presentation Forms-B"](a))}function fb(a){return!(746!==a&&747!==a&&(a<4352||!(Uf["Bopomofo Extended"](a)||Uf.Bopomofo(a)||Uf["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Uf["CJK Compatibility Ideographs"](a)||Uf["CJK Compatibility"](a)||Uf["CJK Radicals Supplement"](a)||Uf["CJK Strokes"](a)||!(!Uf["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Uf["CJK Unified Ideographs Extension A"](a)||Uf["CJK Unified Ideographs"](a)||Uf["Enclosed CJK Letters and Months"](a)||Uf["Hangul Compatibility Jamo"](a)||Uf["Hangul Jamo Extended-A"](a)||Uf["Hangul Jamo Extended-B"](a)||Uf["Hangul Jamo"](a)||Uf["Hangul Syllables"](a)||Uf.Hiragana(a)||Uf["Ideographic Description Characters"](a)||Uf.Kanbun(a)||Uf["Kangxi Radicals"](a)||Uf["Katakana Phonetic Extensions"](a)||Uf.Katakana(a)&&12540!==a||!(!Uf["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!Uf["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Uf["Unified Canadian Aboriginal Syllabics"](a)||Uf["Unified Canadian Aboriginal Syllabics Extended"](a)||Uf["Vertical Forms"](a)||Uf["Yijing Hexagram Symbols"](a)||Uf["Yi Syllables"](a)||Uf["Yi Radicals"](a))))}function gb(a){return!(fb(a)||function(a){
return!!(Uf["Latin-1 Supplement"](a)&&(167===a||169===a||174===a||177===a||188===a||189===a||190===a||215===a||247===a)||Uf["General Punctuation"](a)&&(8214===a||8224===a||8225===a||8240===a||8241===a||8251===a||8252===a||8258===a||8263===a||8264===a||8265===a||8273===a)||Uf["Letterlike Symbols"](a)||Uf["Number Forms"](a)||Uf["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||9003===a||a>=9085&&a<=9114||a>=9150&&a<=9165||9167===a||a>=9169&&a<=9179||a>=9186&&a<=9215)||Uf["Control Pictures"](a)&&9251!==a||Uf["Optical Character Recognition"](a)||Uf["Enclosed Alphanumerics"](a)||Uf["Geometric Shapes"](a)||Uf["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||Uf["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Uf["CJK Symbols and Punctuation"](a)||Uf.Katakana(a)||Uf["Private Use Area"](a)||Uf["CJK Compatibility Forms"](a)||Uf["Small Form Variants"](a)||Uf["Halfwidth and Fullwidth Forms"](a)||8734===a||8756===a||8757===a||a>=9984&&a<=10087||a>=10102&&a<=10131||65532===a||65533===a)}(a))}function hb(a,b){return!(!b&&(a>=1424&&a<=2303||Uf["Arabic Presentation Forms-A"](a)||Uf["Arabic Presentation Forms-B"](a))||a>=2304&&a<=3583||a>=3840&&a<=4255||Uf.Khmer(a))}function ib(a,b){void 0===b&&(b=1);var c=0,d=0;return{members:a.map(function(a){var e,f=(e=a.type,og[e].BYTES_PER_ELEMENT),g=c=jb(c,Math.max(b,f)),h=a.components||1;return d=Math.max(d,f),c+=f*h,{name:a.name,type:a.type,components:h,offset:g}}),size:jb(c,Math.max(d,b)),alignment:b}}function jb(a,b){return Math.ceil(a/b)*b}function kb(a,b){return 256*(a=g(Math.floor(a),0,255))+g(Math.floor(b),0,255)}function lb(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function mb(a){return[kb(255*a.r,255*a.g),kb(255*a.b,255*a.a)]}function nb(a,b){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[a]||[a.replace(b+"-","").replace(/-/g,"_")]}function ob(a,b,c){var d={color:{source:Kg,composite:Lg},number:{source:Eg,composite:Kg}},e=function(a){return{"line-pattern":{source:vg,composite:vg},"fill-pattern":{source:vg,composite:vg},"fill-extrusion-pattern":{source:vg,composite:vg}}[a]}(a);return e&&e[c]||d[b][c]}function pb(a){for(var b=ph/a.extent,c=a.loadGeometry(),d=0;d<c.length;d++)for(var e=c[d],f=0;f<e.length;f++){var h=e[f];h.x=Math.round(h.x*b),h.y=Math.round(h.y*b),(h.x<qh.min||h.x>qh.max||h.y<qh.min||h.y>qh.max)&&(r("Geometry exceeds allowed extent, reduce your vector tile buffer size"),h.x=g(h.x,qh.min,qh.max),h.y=g(h.y,qh.min,qh.max))}return c}function qb(a,b,c,d,e){a.emplaceBack(2*b+(d+1)/2,2*c+(e+1)/2)}function rb(a,b){for(var c=0;c<a.length;c++)if(Ab(b,a[c]))return!0;for(var d=0;d<b.length;d++)if(Ab(a,b[d]))return!0;return!!vb(a,b)}function sb(a,b,c){return!!Ab(a,b)||!!xb(b,a,c)}function tb(a,b){if(1===a.length)return zb(b,a[0]);for(var c=0;c<b.length;c++)for(var d=b[c],e=0;e<d.length;e++)if(Ab(a,d[e]))return!0;for(var f=0;f<a.length;f++)if(zb(b,a[f]))return!0;for(var g=0;g<b.length;g++)if(vb(a,b[g]))return!0;return!1}function ub(a,b,c){if(a.length>1){if(vb(a,b))return!0;for(var d=0;d<b.length;d++)if(xb(b[d],a,c))return!0}for(var e=0;e<a.length;e++)if(xb(a[e],b,c))return!0;return!1}function vb(a,b){if(0===a.length||0===b.length)return!1;for(var c=0;c<a.length-1;c++)for(var d=a[c],e=a[c+1],f=0;f<b.length-1;f++)if(wb(d,e,b[f],b[f+1]))return!0;return!1}function wb(a,b,c,d){return s(a,c,d)!==s(b,c,d)&&s(a,b,c)!==s(a,b,d)}function xb(a,b,c){var d=c*c;if(1===b.length)return a.distSqr(b[0])<d;for(var e=1;e<b.length;e++)if(yb(a,b[e-1],b[e])<d)return!0;return!1}function yb(a,b,c){var d=b.distSqr(c);if(0===d)return a.distSqr(b);var e=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/d;return e<0?a.distSqr(b):e>1?a.distSqr(c):a.distSqr(c.sub(b)._mult(e)._add(b))}function zb(a,b){for(var c,d,e,f=!1,g=0;g<a.length;g++)for(var h=0,i=(c=a[g]).length-1;h<c.length;i=h++)d=c[h],e=c[i],d.y>b.y!=e.y>b.y&&b.x<(e.x-d.x)*(b.y-d.y)/(e.y-d.y)+d.x&&(f=!f);return f}function Ab(a,b){for(var c=!1,d=0,e=a.length-1;d<a.length;e=d++){var f=a[d],g=a[e];f.y>b.y!=g.y>b.y&&b.x<(g.x-f.x)*(b.y-f.y)/(g.y-f.y)+f.x&&(c=!c)}return c}function Bb(a,b,c){var d=c[0],e=c[2];if(a.x<d.x&&b.x<d.x||a.x>e.x&&b.x>e.x||a.y<d.y&&b.y<d.y||a.y>e.y&&b.y>e.y)return!1;var f=s(a,b,c[0]);return f!==s(a,b,c[1])||f!==s(a,b,c[2])||f!==s(a,b,c[3])}function Cb(a,b,c){var d=b.paint.get(a).value;return"constant"===d.kind?d.value:c.programConfigurations.get(b.id).binders[a].maxValue}function Db(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Eb(a,b,c,d,e){if(!b[0]&&!b[1])return a;var f=Gd.convert(b)._mult(e);"viewport"===c&&f._rotate(-d);for(var g=[],h=0;h<a.length;h++){var i=a[h];g.push(i.sub(f))}return g}function Fb(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3];return a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*g,a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*g,a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*g,a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*g,a}function Gb(a,b){var c=Fb([],[a.x,a.y,0,1],b);return new Gd(c[0]/c[3],c[1]/c[3])}function Hb(a,b,c,d){var e=b.width,f=b.height;if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==e*f*c)throw new RangeError("mismatched image size")}else d=new Uint8Array(e*f*c);return a.width=e,a.height=f,a.data=d,a}function Ib(a,b,c){var d=b.width,e=b.height;if(d!==a.width||e!==a.height){var f=Hb({},{width:d,height:e},c);Jb(a,f,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,d),height:Math.min(a.height,e)},c),a.width=d,a.height=e,a.data=f.data}}function Jb(a,b,c,d,e,f){if(0===e.width||0===e.height)return b;if(e.width>a.width||e.height>a.height||c.x>a.width-e.width||c.y>a.height-e.height)throw new RangeError("out of range source coordinates for image copy");if(e.width>b.width||e.height>b.height||d.x>b.width-e.width||d.y>b.height-e.height)throw new RangeError("out of range destination coordinates for image copy");for(var g=a.data,h=b.data,i=0;i<e.height;i++)for(var j=((c.y+i)*a.width+c.x)*f,k=((d.y+i)*b.width+d.x)*f,l=0;l<e.width*f;l++)h[k+l]=g[j+l];return b}function Kb(a,b){for(var c=new Uint8Array(1024),d={},e=0,f=0;e<256;e++,f+=4){d[b]=e/255;var g=a.evaluate(d);c[f+0]=Math.floor(255*g.r/g.a),c[f+1]=Math.floor(255*g.g/g.a),c[f+2]=Math.floor(255*g.b/g.a),c[f+3]=Math.floor(255*g.a)}return new zh({width:256,height:1},c)}function Lb(a,b,c){c=c||2;var d,e,f,g,h,i,j,k=b&&b.length,l=k?b[0]*c:a.length,m=Mb(a,0,l,c,!0),n=[];if(!m||m.next===m.prev)return n;if(k&&(m=function(a,b,c,d){var e,f,g,h=[];for(e=0,f=b.length;e<f;e++)(g=Mb(a,b[e]*d,e<f-1?b[e+1]*d:a.length,d,!1))===g.next&&(g.steiner=!0),h.push(Xb(g));for(h.sort(Tb),e=0;e<h.length;e++)Ub(h[e],c),c=Nb(c,c.next);return c}(a,b,m,c)),a.length>80*c){d=f=a[0],e=g=a[1];for(var o=c;o<l;o+=c)(h=a[o])<d&&(d=h),(i=a[o+1])<e&&(e=i),h>f&&(f=h),i>g&&(g=i);j=0!==(j=Math.max(f-d,g-e))?1/j:0}return Ob(m,n,c,d,e,j),n}function Mb(a,b,c,d,e){var f,g;if(e===ic(a,b,c,d)>0)for(f=b;f<c;f+=d)g=fc(f,a[f],a[f+1],g);else for(f=c-d;f>=b;f-=d)g=fc(f,a[f],a[f+1],g);return g&&_b(g,g.next)&&(gc(g),g=g.next),g}function Nb(a,b){if(!a)return a;b||(b=a);var c,d=a;do{if(c=!1,d.steiner||!_b(d,d.next)&&0!==$b(d.prev,d,d.next))d=d.next;else{if(gc(d),(d=b=d.prev)===d.next)break;c=!0}}while(c||d!==b);return b}function Ob(a,b,c,d,e,f,g){if(a){!g&&f&&function(a,b,c,d){var e=a;do{null===e.z&&(e.z=Wb(e.x,e.y,b,c,d)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next}while(e!==a);e.prevZ.nextZ=null,e.prevZ=null,function(a){var b,c,d,e,f,g,h,i,j=1;do{for(c=a,a=null,f=null,g=0;c;){for(g++,d=c,h=0,b=0;b<j&&(h++,d=d.nextZ);b++);for(i=j;h>0||i>0&&d;)0!==h&&(0===i||!d||c.z<=d.z)?(e=c,c=c.nextZ,h--):(e=d,d=d.nextZ,i--),f?f.nextZ=e:a=e,e.prevZ=f,f=e;c=d}f.nextZ=null,j*=2}while(g>1)}(e)}(a,d,e,f);for(var h,i,j=a;a.prev!==a.next;)if(h=a.prev,i=a.next,f?Qb(a,d,e,f):Pb(a))b.push(h.i/c),b.push(a.i/c),b.push(i.i/c),gc(a),a=i.next,j=i.next;else if((a=i)===j){g?1===g?Ob(a=Rb(Nb(a),b,c),b,c,d,e,f,2):2===g&&Sb(a,b,c,d,e,f):Ob(Nb(a),b,c,d,e,f,1);break}}}function Pb(a){var b=a.prev,c=a,d=a.next;if($b(b,c,d)>=0)return!1;for(var e=a.next.next;e!==a.prev;){if(Yb(b.x,b.y,c.x,c.y,d.x,d.y,e.x,e.y)&&$b(e.prev,e,e.next)>=0)return!1;e=e.next}return!0}function Qb(a,b,c,d){var e=a.prev,f=a,g=a.next;if($b(e,f,g)>=0)return!1;for(var h=e.x<f.x?e.x<g.x?e.x:g.x:f.x<g.x?f.x:g.x,i=e.y<f.y?e.y<g.y?e.y:g.y:f.y<g.y?f.y:g.y,j=e.x>f.x?e.x>g.x?e.x:g.x:f.x>g.x?f.x:g.x,k=e.y>f.y?e.y>g.y?e.y:g.y:f.y>g.y?f.y:g.y,l=Wb(h,i,b,c,d),m=Wb(j,k,b,c,d),n=a.prevZ,o=a.nextZ;n&&n.z>=l&&o&&o.z<=m;){if(n!==a.prev&&n!==a.next&&Yb(e.x,e.y,f.x,f.y,g.x,g.y,n.x,n.y)&&$b(n.prev,n,n.next)>=0)return!1;if(n=n.prevZ,o!==a.prev&&o!==a.next&&Yb(e.x,e.y,f.x,f.y,g.x,g.y,o.x,o.y)&&$b(o.prev,o,o.next)>=0)return!1;o=o.nextZ}for(;n&&n.z>=l;){if(n!==a.prev&&n!==a.next&&Yb(e.x,e.y,f.x,f.y,g.x,g.y,n.x,n.y)&&$b(n.prev,n,n.next)>=0)return!1;n=n.prevZ}for(;o&&o.z<=m;){if(o!==a.prev&&o!==a.next&&Yb(e.x,e.y,f.x,f.y,g.x,g.y,o.x,o.y)&&$b(o.prev,o,o.next)>=0)return!1;o=o.nextZ}return!0}function Rb(a,b,c){var d=a;do{var e=d.prev,f=d.next.next;!_b(e,f)&&ac(e,d,d.next,f)&&dc(e,f)&&dc(f,e)&&(b.push(e.i/c),b.push(d.i/c),b.push(f.i/c),gc(d),gc(d.next),d=a=f),d=d.next}while(d!==a);return Nb(d)}function Sb(a,b,c,d,e,f){var g=a;do{for(var h=g.next.next;h!==g.prev;){if(g.i!==h.i&&Zb(g,h)){var i=ec(g,h);return g=Nb(g,g.next),i=Nb(i,i.next),Ob(g,b,c,d,e,f),void Ob(i,b,c,d,e,f)}h=h.next}g=g.next}while(g!==a)}function Tb(a,b){return a.x-b.x}function Ub(a,b){if(b=function(a,b){var c,d=b,e=a.x,f=a.y,g=-1/0;do{if(f<=d.y&&f>=d.next.y&&d.next.y!==d.y){var h=d.x+(f-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(h<=e&&h>g){if(g=h,h===e){if(f===d.y)return d;if(f===d.next.y)return d.next}c=d.x<d.next.x?d:d.next}}d=d.next}while(d!==b);if(!c)return null;if(e===g)return c;var i,j=c,k=c.x,l=c.y,m=1/0;d=c;do{e>=d.x&&d.x>=k&&e!==d.x&&Yb(f<l?e:g,f,k,l,f<l?g:e,f,d.x,d.y)&&(i=Math.abs(f-d.y)/(e-d.x),dc(d,a)&&(i<m||i===m&&(d.x>c.x||d.x===c.x&&Vb(c,d)))&&(c=d,m=i)),d=d.next}while(d!==j);return c}(a,b)){var c=ec(b,a);Nb(c,c.next)}}function Vb(a,b){return $b(a.prev,a,b.prev)<0&&$b(b.next,a,a.next)<0}function Wb(a,b,c,d,e){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-c)*e)|a<<8))|a<<4))|a<<2))|a<<1))|(b=1431655765&((b=858993459&((b=252645135&((b=16711935&((b=32767*(b-d)*e)|b<<8))|b<<4))|b<<2))|b<<1))<<1}function Xb(a){var b=a,c=a;do{(b.x<c.x||b.x===c.x&&b.y<c.y)&&(c=b),b=b.next}while(b!==a);return c}function Yb(a,b,c,d,e,f,g,h){return(e-g)*(b-h)-(a-g)*(f-h)>=0&&(a-g)*(d-h)-(c-g)*(b-h)>=0&&(c-g)*(f-h)-(e-g)*(d-h)>=0}function Zb(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!function(a,b){var c=a;do{if(c.i!==a.i&&c.next.i!==a.i&&c.i!==b.i&&c.next.i!==b.i&&ac(c,c.next,a,b))return!0;c=c.next}while(c!==a);return!1}(a,b)&&(dc(a,b)&&dc(b,a)&&function(a,b){var c=a,d=!1,e=(a.x+b.x)/2,f=(a.y+b.y)/2;do{c.y>f!=c.next.y>f&&c.next.y!==c.y&&e<(c.next.x-c.x)*(f-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next}while(c!==a);return d}(a,b)&&($b(a.prev,a,b.prev)||$b(a,b.prev,b))||_b(a,b)&&$b(a.prev,a,a.next)>0&&$b(b.prev,b,b.next)>0)}function $b(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function _b(a,b){return a.x===b.x&&a.y===b.y}function ac(a,b,c,d){var e=cc($b(a,b,c)),f=cc($b(a,b,d)),g=cc($b(c,d,a)),h=cc($b(c,d,b));return e!==f&&g!==h||!(0!==e||!bc(a,c,b))||!(0!==f||!bc(a,d,b))||!(0!==g||!bc(c,a,d))||!(0!==h||!bc(c,b,d))}function bc(a,b,c){return b.x<=Math.max(a.x,c.x)&&b.x>=Math.min(a.x,c.x)&&b.y<=Math.max(a.y,c.y)&&b.y>=Math.min(a.y,c.y)}function cc(a){return a>0?1:a<0?-1:0}function dc(a,b){return $b(a.prev,a,a.next)<0?$b(a,b,a.next)>=0&&$b(a,a.prev,b)>=0:$b(a,b,a.prev)<0||$b(a,a.next,b)<0}function ec(a,b){var c=new hc(a.i,a.x,a.y),d=new hc(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,c.next=e,e.prev=c,d.next=c,c.prev=d,f.next=d,d.prev=f,d}function fc(a,b,c,d){var e=new hc(a,b,c);return d?(e.next=d.next,e.prev=d,d.next.prev=e,d.next=e):(e.prev=e,e.next=e),e}function gc(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function hc(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ic(a,b,c,d){for(var e=0,f=b,g=c-d;f<c;f+=d)e+=(a[g]-a[f])*(a[f+1]+a[g+1]),g=f;return e}function jc(a,b,c,d,e){!function a(b,c,d,e,f){for(;e>d;){if(e-d>600){var g=e-d+1,h=c-d+1,i=Math.log(g),j=.5*Math.exp(2*i/3),k=.5*Math.sqrt(i*j*(g-j)/g)*(h-g/2<0?-1:1);a(b,c,Math.max(d,Math.floor(c-h*j/g+k)),Math.min(e,Math.floor(c+(g-h)*j/g+k)),f)}var l=b[c],m=d,n=e;for(kc(b,d,c),f(b[e],l)>0&&kc(b,d,e);m<n;){for(kc(b,m,n),m++,n--;f(b[m],l)<0;)m++;for(;f(b[n],l)>0;)n--}0===f(b[d],l)?kc(b,d,n):kc(b,++n,e),n<=c&&(d=n+1),c<=n&&(e=n-1)}}(a,b,c||0,d||a.length-1,e||lc)}function kc(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function lc(a,b){return a<b?-1:a>b?1:0}function mc(a,b){var c=a.length;if(c<=1)return[a];for(var d,e,f=[],g=0;g<c;g++){var h=t(a[g]);0!==h&&(a[g].area=Math.abs(h),void 0===e&&(e=h<0),e===h<0?(d&&f.push(d),d=[a[g]]):d.push(a[g]))}if(d&&f.push(d),b>1)for(var i=0;i<f.length;i++)f[i].length<=b||(jc(f[i],b,1,f[i].length-1,nc),f[i]=f[i].slice(0,b));return f}function nc(a,b){return b.area-a.area}function oc(a,b,c){for(var d=c.patternDependencies,e=!1,f=0,g=b;f<g.length;f+=1){var h=g[f].paint.get(a+"-pattern");h.isConstant()||(e=!0);var i=h.constantOr(null);i&&(e=!0,d[i.to]=!0,d[i.from]=!0)}return e}function pc(a,b,c,d,e){for(var f=e.patternDependencies,g=0,h=b;g<h.length;g+=1){var i=h[g],j=i.paint.get(a+"-pattern").value;if("constant"!==j.kind){var k=j.evaluate({zoom:d-1},c,{}),l=j.evaluate({zoom:d},c,{}),m=j.evaluate({zoom:d+1},c,{});f[k]=!0,f[l]=!0,f[m]=!0,c.patterns[i.id]={min:k,mid:l,max:m}}}return c}function qc(a,b,c,d,e){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=e,a.readFields(rc,this,b)}function rc(a,b,c){1==a?b.id=c.readVarint():2==a?function(a,b){for(var c=a.readVarint()+a.pos;a.pos<c;){var d=b._keys[a.readVarint()],e=b._values[a.readVarint()];b.properties[d]=e}}(c,b):3==a?b.type=c.readVarint():4==a&&(b._geometry=c.pos)}function sc(a){for(var b,c,d=0,e=0,f=a.length,g=f-1;e<f;g=e++)b=a[e],d+=((c=a[g]).x-b.x)*(b.y+c.y);return d}function tc(a,b){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(uc,this,b),this.length=this._features.length}function uc(a,b,c){15===a?b.version=c.readVarint():1===a?b.name=c.readString():5===a?b.extent=c.readVarint():2===a?b._features.push(c.pos):3===a?b._keys.push(c.readString()):4===a&&b._values.push(function(a){for(var b=null,c=a.readVarint()+a.pos;a.pos<c;){var d=a.readVarint()>>3;b=1===d?a.readString():2===d?a.readFloat():3===d?a.readDouble():4===d?a.readVarint64():5===d?a.readVarint():6===d?a.readSVarint():7===d?a.readBoolean():null}return b}(c))}function vc(a,b,c){if(3===a){var d=new Nh(c,c.readVarint()+c.pos);d.length&&(b[d.name]=d)}}function wc(a,b,c,d,e,f,g,h){a.emplaceBack(b,c,2*Math.floor(d*Qh)+g,e*Qh*2,f*Qh*2,Math.round(h))}function xc(a,b){return a.x===b.x&&(a.x<0||a.x>ph)||a.y===b.y&&(a.y<0||a.y>ph)}function yc(a){return a.every(function(a){return a.x<0})||a.every(function(a){return a.x>ph})||a.every(function(a){return a.y<0})||a.every(function(a){return a.y>ph})}function zc(a,b){return a.x*b.x+a.y*b.y}function Ac(a,b){if(1===a.length){var c=b[0],d=b[1],e=b[3],f=a[0],g=d.sub(c),h=e.sub(c),i=f.sub(c),j=zc(g,g),k=zc(g,h),l=zc(h,h),m=zc(i,g),n=zc(i,h),o=j*l-k*k,p=(l*m-k*n)/o,q=(j*n-k*m)/o,r=1-p-q;return c.z*r+d.z*p+e.z*q}for(var s=1/0,t=0,u=b;t<u.length;t+=1){var v=u[t];s=Math.min(s,v.z)}return s}function Bc(a,b){return b>0?b+2*a:a}function Cc(a,b,c){return a.sections.forEach(function(a){a.text=function(a,b,c){var d=b.layout.get("text-transform").evaluate(c,{});return"uppercase"===d?a=a.toLocaleUpperCase():"lowercase"===d&&(a=a.toLocaleLowerCase()),Zf.applyArabicShaping&&(a=Zf.applyArabicShaping(a)),a}(a.text,b,c)}),a}function Dc(a,b,c,d,e,f,g,h,i,j,k){var l,m=ji.fromFeature(a,c);j===ii.vertical&&m.verticalizePunctuation();var n=Zf.processBidirectionalText,o=Zf.processStyledBidirectionalText;if(n&&1===m.sections.length){l=[];for(var p=0,q=n(m.toString(),Hc(m,h,d,b));p<q.length;p+=1){var r=q[p],s=new ji;s.text=r,s.sections=m.sections;for(var t=0;t<r.length;t++)s.sectionIndex.push(0);l.push(s)}}else if(o){l=[];for(var u=0,v=o(m.text,m.sectionIndex,Hc(m,h,d,b));u<v.length;u+=1){var w=v[u],x=new ji;x.text=w[0],x.sectionIndex=w[1],x.sections=m.sections,l.push(x)}}else l=function(a,b){for(var c=[],d=a.text,e=0,f=0,g=b;f<g.length;f+=1){var h=g[f];c.push(a.substring(e,h)),e=h}return e<d.length&&c.push(a.substring(e,d.length)),c}(m,Hc(m,h,d,b));var y=[],z={positionedGlyphs:y,text:m.toString(),top:i[1],bottom:i[1],left:i[0],right:i[0],writingMode:j,lineCount:l.length,yOffset:-17};return function(a,b,c,d,e,f,g,h,i){for(var j=0,k=a.yOffset,l=0,m=a.positionedGlyphs,n="right"===f?1:"left"===f?0:.5,o=0,p=c;o<p.length;o+=1){var q=p[o];q.trim();var r=q.getMaxScale();if(q.length()){for(var s=m.length,t=0;t<q.length();t++){var u=q.getSection(t),v=q.getSectionIndex(t),w=q.getCharCode(t),x=24*(r-u.scale),y=b[u.fontStack],z=y&&y[w];z&&(g===ii.horizontal||!i&&!fb(w)||i&&(ki[w]||(B=w,Uf.Arabic(B)||Uf["Arabic Supplement"](B)||Uf["Arabic Extended-A"](B)||Uf["Arabic Presentation Forms-A"](B)||Uf["Arabic Presentation Forms-B"](B)))?(m.push({glyph:w,x:j,y:k+x,vertical:!1,scale:u.scale,fontStack:u.fontStack,sectionIndex:v}),j+=z.metrics.advance*u.scale+h):(m.push({glyph:w,x:j,y:k+x,vertical:!0,scale:u.scale,fontStack:u.fontStack,sectionIndex:v}),j+=hi*u.scale+h))}if(m.length!==s){var A=j-h;l=Math.max(A,l),Jc(m,b,s,m.length-1,n)}j=0,k+=d*r}else k+=d}var B,C=Ic(e),D=C.horizontalAlign,E=C.verticalAlign;!function(a,b,c,d,e,f,g){for(var h=(b-c)*e,i=(-d*g+.5)*f,j=0;j<a.length;j++)a[j].x+=h,a[j].y+=i}(m,n,D,E,l,d,c.length);var F=k-a.yOffset;a.top+=-E*F,a.bottom=a.top+F,a.left+=-D*l,a.right=a.left+l}(z,b,l,e,f,g,j,h,k),!!y.length&&z}function Ec(a,b,c,d){var e=Math.pow(a-b,2);return d?a<b?e/2:2*e:e+Math.abs(c)*c}function Fc(a,b,c){var d=0;return 10===a&&(d-=1e4),c&&(d+=150),40!==a&&65288!==a||(d+=50),41!==b&&65289!==b||(d+=50),d}function Gc(a,b,c,d,e,f){for(var g=null,h=Ec(b,c,e,f),i=0,j=d;i<j.length;i+=1){var k=j[i],l=Ec(b-k.x,c,e,f)+k.badness;l<=h&&(g=k,h=l)}return{index:a,x:b,priorBreak:g,badness:h}}function Hc(a,b,c,d){if(!c)return[];if(!a)return[];for(var e,f=[],g=function(a,b,c,d){for(var e=0,f=0;f<a.length();f++){var g=a.getSection(f),h=d[g.fontStack],i=h&&h[a.getCharCode(f)];i&&(e+=i.metrics.advance*g.scale+b)}return e/Math.max(1,Math.ceil(e/c))}(a,b,c,d),h=a.text.indexOf("")>=0,i=0,j=0;j<a.length();j++){var k=a.getSection(j),l=a.getCharCode(j),m=d[k.fontStack],n=m&&m[l];if(n&&!ki[l]&&(i+=n.metrics.advance*k.scale+b),j<a.length()-1){var o=!((e=l)<11904||!(Uf["Bopomofo Extended"](e)||Uf.Bopomofo(e)||Uf["CJK Compatibility Forms"](e)||Uf["CJK Compatibility Ideographs"](e)||Uf["CJK Compatibility"](e)||Uf["CJK Radicals Supplement"](e)||Uf["CJK Strokes"](e)||Uf["CJK Symbols and Punctuation"](e)||Uf["CJK Unified Ideographs Extension A"](e)||Uf["CJK Unified Ideographs"](e)||Uf["Enclosed CJK Letters and Months"](e)||Uf["Halfwidth and Fullwidth Forms"](e)||Uf.Hiragana(e)||Uf["Ideographic Description Characters"](e)||Uf["Kangxi Radicals"](e)||Uf["Katakana Phonetic Extensions"](e)||Uf.Katakana(e)||Uf["Vertical Forms"](e)||Uf["Yi Radicals"](e)||Uf["Yi Syllables"](e)));(li[l]||o)&&f.push(Gc(j+1,i,g,f,Fc(l,a.getCharCode(j+1),o&&h),!1))}}return function a(b){return b?a(b.priorBreak).concat(b.index):[]}(Gc(a.length(),i,g,f,0,!0))}function Ic(a){var b=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":b=1;break;case"left":case"top-left":case"bottom-left":b=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:b,verticalAlign:c}}function Jc(a,b,c,d,e){if(e){var f=a[d],g=b[f.fontStack],h=g&&g[f.glyph];if(h)for(var i=h.metrics.advance*f.scale,j=(a[d].x+i)*e,k=c;k<=d;k++)a[k].x-=j}}function Kc(a,b){var c=b.expression;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new $f(a+1))};if("source"===c.kind)return{kind:"source"};for(var d=c.zoomStops,e=c.interpolationType,f=0;f<d.length&&d[f]<=a;)f++;for(var g=f=Math.max(0,f-1);g<d.length&&d[g]<a+1;)g++;g=Math.min(d.length-1,g);var h=d[f],i=d[g];return"composite"===c.kind?{kind:"composite",minZoom:h,maxZoom:i,interpolationType:e}:{kind:"camera",minZoom:h,maxZoom:i,minSize:c.evaluate(new $f(h)),maxSize:c.evaluate(new $f(i)),interpolationType:e}}function Lc(a,b,c){var d=b.uSize,e=b.uSizeT,f=c.lowerSize,g=c.upperSize;return"source"===a.kind?f/ni:"composite"===a.kind?W(f/ni,g/ni,e):d}function Mc(a,b){var c=0,d=0;if("constant"===a.kind)d=a.layoutSize;else if("source"!==a.kind){var e=a.interpolationType,f=a.minZoom,h=a.maxZoom,i=e?g(of.interpolationFactor(e,b,f,h),0,1):0;"camera"===a.kind?d=W(a.minSize,a.maxSize,i):c=i}return{uSizeT:c,uSize:d}}function Nc(a,b,c,d,e,f,g,h){a.emplaceBack(b,c,Math.round(32*d),Math.round(32*e),f,g,h?h[0]:0,h?h[1]:0)}function Oc(a,b,c){a.emplaceBack(b.x,b.y,c),a.emplaceBack(b.x,b.y,c),a.emplaceBack(b.x,b.y,c),a.emplaceBack(b.x,b.y,c)}function Pc(a){for(var b=0,c=0,d=0,e=a;d<e.length;d+=1){var f=e[d];b+=f.w*f.h,c=Math.max(c,f.w)}a.sort(function(a,b){return b.h-a.h});for(var g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(b/.95)),c),h:1/0}],h=0,i=0,j=0,k=a;j<k.length;j+=1)for(var l=k[j],m=g.length-1;m>=0;m--){var n=g[m];if(!(l.w>n.w||l.h>n.h)){if(l.x=n.x,l.y=n.y,i=Math.max(i,l.y+l.h),h=Math.max(h,l.x+l.w),l.w===n.w&&l.h===n.h){var o=g.pop();m<g.length&&(g[m]=o)}else l.h===n.h?(n.x+=l.w,n.w-=l.w):l.w===n.w?(n.y+=l.h,n.h-=l.h):(g.push({x:n.x+l.w,y:n.y,w:n.w-l.w,h:l.h}),n.y+=l.h,n.h-=l.h);break}}return{w:h,h:i,fill:b/(h*i)||0}}function Qc(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}function Rc(a){return a.type===Qc.Bytes?a.readVarint()+a.pos:a.pos+1}function Sc(a,b,c){return c?4294967296*b+(a>>>0):4294967296*(b>>>0)+(a>>>0)}function Tc(a,b,c){var d=b<=16383?1:b<=2097151?2:b<=268435455?3:Math.floor(Math.log(b)/(7*Math.LN2));c.realloc(d);for(var e=c.pos-1;e>=a;e--)c.buf[e+d]=c.buf[e]}function Uc(a,b){for(var c=0;c<a.length;c++)b.writeVarint(a[c])}function Vc(a,b){for(var c=0;c<a.length;c++)b.writeSVarint(a[c])}function Wc(a,b){for(var c=0;c<a.length;c++)b.writeFloat(a[c])}function Xc(a,b){for(var c=0;c<a.length;c++)b.writeDouble(a[c])}function Yc(a,b){for(var c=0;c<a.length;c++)b.writeBoolean(a[c])}function Zc(a,b){for(var c=0;c<a.length;c++)b.writeFixed32(a[c])}function $c(a,b){for(var c=0;c<a.length;c++)b.writeSFixed32(a[c])}function _c(a,b){for(var c=0;c<a.length;c++)b.writeFixed64(a[c])}function ad(a,b){for(var c=0;c<a.length;c++)b.writeSFixed64(a[c])}function bd(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+16777216*a[b+3]}function cd(a,b,c){a[c]=b,a[c+1]=b>>>8,a[c+2]=b>>>16,a[c+3]=b>>>24}function dd(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+(a[b+3]<<24)}function ed(a,b,c){1===a&&c.readMessage(fd,b)}function fd(a,b,c){if(3===a){var d=c.readMessage(gd,{}),e=d.id,f=d.bitmap,g=d.width,h=d.height,i=d.left,j=d.top,k=d.advance;b.push({id:e,bitmap:new yh({width:g+2*Pi,height:h+2*Pi},f),metrics:{width:g,height:h,left:i,top:j,advance:k}})}}function gd(a,b,c){1===a?b.id=c.readVarint():2===a?b.bitmap=c.readBytes():3===a?b.width=c.readVarint():4===a?b.height=c.readVarint():5===a?b.left=c.readSVarint():6===a?b.top=c.readSVarint():7===a&&(b.advance=c.readVarint())}function hd(a,b,c){var d=2*Math.PI*6378137/256/Math.pow(2,c);return[a*d-2*Math.PI*6378137/2,b*d-2*Math.PI*6378137/2]}function id(a){return Vi*Math.cos(a*Math.PI/180)}function jd(a){return(180+a)/360}function kd(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function ld(a,b){return a/id(b)}function md(a){var b=180-360*a;return 360/Math.PI*Math.atan(Math.exp(b*Math.PI/180))-90}function nd(a,b,c,d){(a*=2)<0&&(a=-1*a-1);var e=1<<b;return 32*(e*e*a+e*d+c)+b}function od(a){for(var b=1/0,c=1/0,d=-1/0,e=-1/0,f=0,g=a;f<g.length;f+=1){var h=g[f];b=Math.min(b,h.x),c=Math.min(c,h.y),d=Math.max(d,h.x),e=Math.max(e,h.y)}return{minX:b,minY:c,maxX:d,maxY:e}}function pd(a,b){return b-a}function qd(a,b,c,d,e){if(void 0===b.segment)return!0;for(var f=b,g=b.segment+1,h=0;h>-c/2;){if(--g<0)return!1;h-=a[g].dist(f),f=a[g]}h+=a[g].dist(a[g+1]),g++;for(var i=[],j=0;h<c/2;){var k=a[g-1],l=a[g],m=a[g+1];if(!m)return!1;var n=k.angleTo(l)-l.angleTo(m);for(n=Math.abs((n+3*Math.PI)%(2*Math.PI)-Math.PI),i.push({distance:h,angleDelta:n}),j+=n;h-i[0].distance>d;)j-=i.shift().angleDelta;if(j>e)return!1;g++,h+=l.dist(m)}return!0}function rd(a){for(var b=0,c=0;c<a.length-1;c++)b+=a[c].dist(a[c+1]);return b}function sd(a,b,c){return a?.6*b*c:0}function td(a,b){return Math.max(a?a.right-a.left:0,b?b.right-b.left:0)}function ud(a,b,c,d,e,f){for(var g=sd(c,e,f),h=td(c,d)*f,i=0,j=rd(a)/2,k=0;k<a.length-1;k++){var l=a[k],m=a[k+1],n=l.dist(m);if(i+n>j){var o=(j-i)/n,p=W(l.x,m.x,o),q=W(l.y,m.y,o),r=new mi(p,q,m.angleTo(l),k);return r._round(),!g||qd(a,r,h,g,b)?r:void 0}i+=n}}function vd(a,b,c,d,e,f,g,h,i){var j=sd(d,f,g),k=td(d,e),l=k*g,m=0===a[0].x||a[0].x===i||0===a[0].y||a[0].y===i;return b-l<b/4&&(b=l+b/4),function a(b,c,d,e,f,g,h,i,j){for(var k=g/2,l=rd(b),m=0,n=c-d,o=[],p=0;p<b.length-1;p++){for(var q=b[p],r=b[p+1],s=q.dist(r),t=r.angleTo(q);n+d<m+s;){var u=((n+=d)-m)/s,v=W(q.x,r.x,u),w=W(q.y,r.y,u);if(v>=0&&v<j&&w>=0&&w<j&&n-k>=0&&n+k<=l){var x=new mi(v,w,t,p);x._round(),e&&!qd(b,x,g,e,f)||o.push(x)}}m+=s}return i||o.length||h||(o=a(b,m/2,d,e,f,g,h,!0,j)),o}(a,m?b/2*h%b:(k/2+2*f)*g*h%b,b,j,c,l,m,!1,i)}function wd(a,b){return a<b?-1:a>b?1:0}function xd(a,b,c){void 0===b&&(b=1),void 0===c&&(c=!1);for(var d=1/0,e=1/0,f=-1/0,g=-1/0,h=a[0],i=0;i<h.length;i++){var j=h[i];(!i||j.x<d)&&(d=j.x),(!i||j.y<e)&&(e=j.y),(!i||j.x>f)&&(f=j.x),(!i||j.y>g)&&(g=j.y)}var k=f-d,l=g-e,m=Math.min(k,l),n=m/2,o=new hj([],yd);if(0===m)return new Gd(d,e);for(var p=d;p<f;p+=m)for(var q=e;q<g;q+=m)o.push(new zd(p+n,q+n,n,a));for(var r=function(a){for(var b=0,c=0,d=0,e=a[0],f=0,g=e.length,h=g-1;f<g;h=f++){var i=e[f],j=e[h],k=i.x*j.y-j.x*i.y;c+=(i.x+j.x)*k,d+=(i.y+j.y)*k,b+=3*k}return new zd(c/b,d/b,0,a)}(a),s=o.length;o.length;){var t=o.pop();(t.d>r.d||!r.d)&&(r=t,c&&console.log("found best %d after %d probes",Math.round(1e4*t.d)/1e4,s)),t.max-r.d<=b||(n=t.h/2,o.push(new zd(t.p.x-n,t.p.y-n,n,a)),o.push(new zd(t.p.x+n,t.p.y-n,n,a)),o.push(new zd(t.p.x-n,t.p.y+n,n,a)),o.push(new zd(t.p.x+n,t.p.y+n,n,a)),s+=4)}return c&&(console.log("num probes: "+s),console.log("best distance: "+r.d)),r.p}function yd(a,b){return b.max-a.max}function zd(a,b,c,d){this.p=new Gd(a,b),this.h=c,this.d=function(a,b){for(var c=!1,d=1/0,e=0;e<b.length;e++)for(var f=b[e],g=0,h=f.length,i=h-1;g<h;i=g++){var j=f[g],k=f[i];j.y>a.y!=k.y>a.y&&a.x<(k.x-j.x)*(a.y-j.y)/(k.y-j.y)+j.x&&(c=!c),d=Math.min(d,yb(a,j,k))}return(c?1:-1)*Math.sqrt(d)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}function Ad(a,b){var c=0,d=0,e=b/Math.sqrt(2);switch(a){case"top-right":case"top-left":d=e-nj;break;case"bottom-right":case"bottom-left":d=-e+nj;break;case"bottom":d=-b+nj;break;case"top":d=b-nj}switch(a){case"top-right":case"bottom-right":c=-e;break;case"top-left":case"bottom-left":c=e;break;case"left":c=b;break;case"right":c=-b}return[c,d]}function Bd(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Cd(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=function(a,b,c,d,e,f,g,h){for(var i=d.layout.get("text-rotate").evaluate(f,{})*Math.PI/180,j=b.positionedGlyphs,k=[],l=0;l<j.length;l++){var m=j[l],n=g[m.fontStack],o=n&&n[m.glyph];if(o){var p=o.rect;if(p){var q=Qi+1,r=o.metrics.advance*m.scale/2,s=e?[m.x+r,m.y]:[0,0],t=e?[0,0]:[m.x+r+c[0],m.y+c[1]],u=(e||h)&&m.vertical,v=[0,0];u&&(v=t,t=[0,0]);var w=(o.metrics.left-q)*m.scale-r+t[0],x=(-o.metrics.top-q)*m.scale+t[1],y=w+p.w*m.scale,z=x+p.h*m.scale,A=new Gd(w,x),B=new Gd(y,x),C=new Gd(w,z),D=new Gd(y,z);if(u){var E=new Gd(-r,r-b.yOffset),F=-Math.PI/2,G=hi/2-r,H=new Gd(5-b.yOffset-G,0),I=new(Function.prototype.bind.apply(Gd,[null].concat(v)));A._rotateAround(F,E)._add(H)._add(I),B._rotateAround(F,E)._add(H)._add(I),C._rotateAround(F,E)._add(H)._add(I),D._rotateAround(F,E)._add(H)._add(I)}if(i){var J=Math.sin(i),K=Math.cos(i),L=[K,-J,J,K];A._matMult(L),B._matMult(L),C._matMult(L),D._matMult(L)}k.push({tl:A,tr:B,bl:C,br:D,tex:p,writingMode:b.writingMode,glyphOffset:s,sectionIndex:m.sectionIndex})}}}return k}(0,c,g,d,e,f,l,a.allowVerticalPlacement),o=a.textSizeData,p=null;"source"===o.kind?(p=[ni*d.layout.get("text-size").evaluate(f,{})])[0]>oj&&r(a.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'):"composite"===o.kind&&((p=[ni*m.compositeTextSizes[0].evaluate(f,{}),ni*m.compositeTextSizes[1].evaluate(f,{})])[0]>oj||p[1]>oj)&&r(a.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'),a.addSymbols(a.text,n,p,g,e,f,i,b,h.lineStartIndex,h.lineLength);for(var q=0,s=j;q<s.length;q+=1)k[s[q]]=a.text.placedSymbolArray.length-1;return 4*n.length}function Dd(a){for(var b in a)return a[b];return null}function Ed(a,b,c,d){var e=a.compareText;if(b in e){for(var f=e[b],g=f.length-1;g>=0;g--)if(d.dist(f[g])<c)return!0}else e[b]=[];return e[b].push(d),!1}var Fd=c;c.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},c.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},c.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},c.prototype.solveCurveX=function(a,b){var c,d,e,f,g;for(void 0===b&&(b=1e-6),e=a,g=0;g<8;g++){if(f=this.sampleCurveX(e)-a,Math.abs(f)<b)return e;var h=this.sampleCurveDerivativeX(e);if(Math.abs(h)<1e-6)break;e-=f/h}if((e=a)<(c=0))return c;if(e>(d=1))return d;for(;c<d;){if(f=this.sampleCurveX(e),Math.abs(f-a)<b)return e;a>f?c=e:d=e,e=.5*(d-c)+c}return e},c.prototype.solve=function(a,b){return this.sampleCurveY(this.solveCurveX(a,b))};var Gd=d;d.prototype={clone:function(){return new d(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,b){return this.clone()._rotateAround(a,b)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var b=a.x-this.x,c=a.y-this.y;return b*b+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,b){return Math.atan2(this.x*b-this.y*a,this.x*a+this.y*b)},_matMult:function(a){var b=a[0]*this.x+a[1]*this.y,c=a[2]*this.x+a[3]*this.y;return this.x=b,this.y=c,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},
_rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=b*this.x-c*this.y,e=c*this.x+b*this.y;return this.x=d,this.y=e,this},_rotateAround:function(a,b){var c=Math.cos(a),d=Math.sin(a),e=b.x+c*(this.x-b.x)-d*(this.y-b.y),f=b.y+d*(this.x-b.x)+c*(this.y-b.y);return this.x=e,this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(a){return a instanceof d?a:Array.isArray(a)?new d(a[0],a[1]):a};var Hd,Id,Jd,Kd,Ld=f(.25,.1,.25,1),Md=1,Nd={},Od=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),Pd=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,Qd=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,Rd={now:Od,frame:function(a){var b=Pd(a);return{cancel:function(){return Qd(b)}}},getImageData:function(a){var b=self.document.createElement("canvas"),c=b.getContext("2d");if(!c)throw new Error("failed to create canvas 2d context");return b.width=a.width,b.height=a.height,c.drawImage(a,0,0,a.width,a.height),c.getImageData(0,0,a.width,a.height)},resolveURL:function(a){return Hd||(Hd=self.document.createElement("a")),Hd.href=a,Hd.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==Id&&(Id=self.matchMedia("(prefers-reduced-motion: reduce)")),Id.matches)}},Sd={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Td={supported:!1,testSupport:function(a){!Ud&&Kd&&(Vd?w(a):Jd=a)}},Ud=!1,Vd=!1;self.document&&((Kd=self.document.createElement("img")).onload=function(){Jd&&w(Jd),Jd=null,Vd=!0},Kd.onerror=function(){Ud=!0,Jd=null},Kd.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Wd=function(a,b){this._transformRequestFn=a,this._customAccessToken=b,this._createSkuToken()};Wd.prototype._createSkuToken=function(){var a=function(){for(var a="",b=0;b<10;b++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1","01",a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt},Wd.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Wd.prototype.transformRequest=function(a,b){return this._transformRequestFn&&this._transformRequestFn(a,b)||{url:a}},Wd.prototype.normalizeStyleURL=function(a,b){if(!x(a))return a;var c=z(a);return c.path="/styles/v1"+c.path,this._makeAPIURL(c,this._customAccessToken||b)},Wd.prototype.normalizeGlyphsURL=function(a,b){if(!x(a))return a;var c=z(a);return c.path="/fonts/v1"+c.path,this._makeAPIURL(c,this._customAccessToken||b)},Wd.prototype.normalizeSourceURL=function(a,b){if(!x(a))return a;var c=z(a);return c.path="/v4/"+c.authority+".json",c.params.push("secure"),this._makeAPIURL(c,this._customAccessToken||b)},Wd.prototype.normalizeSpriteURL=function(a,b,c,d){var e=z(a);return x(a)?(e.path="/styles/v1"+e.path+"/sprite"+b+c,this._makeAPIURL(e,this._customAccessToken||d)):(e.path+=""+b+c,A(e))},Wd.prototype.normalizeTileURL=function(a,b,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),!b||!x(b))return a;var d=z(a),e=Rd.devicePixelRatio>=2||512===c?"@2x":"",f=Td.supported?".webp":"$1";return d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+e+f),d.path=d.path.replace(/^.+\/v4\//,"/"),d.path="/v4"+d.path,Sd.REQUIRE_ACCESS_TOKEN&&(Sd.ACCESS_TOKEN||this._customAccessToken)&&this._skuToken&&d.params.push("sku="+this._skuToken),this._makeAPIURL(d,this._customAccessToken)},Wd.prototype.canonicalizeTileURL=function(a){var b=z(a);if(!b.path.match(/(^\/v4\/)/)||!b.path.match(/\.[\w]+$/))return a;var c="mapbox://tiles/";c+=b.path.replace("/v4/","");var d=b.params.filter(function(a){return!a.match(/^access_token=/)});return d.length&&(c+="?"+d.join("&")),c},Wd.prototype.canonicalizeTileset=function(a,b){if(!x(b))return a.tiles||[];for(var c=[],d=0,e=a.tiles;d<e.length;d+=1){var f=e[d],g=this.canonicalizeTileURL(f);c.push(g)}return c},Wd.prototype._makeAPIURL=function(a,b){var c="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",d=z(Sd.API_URL);if(a.protocol=d.protocol,a.authority=d.authority,"/"!==d.path&&(a.path=""+d.path+a.path),!Sd.REQUIRE_ACCESS_TOKEN)return A(a);if(!(b=b||Sd.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+c);if("s"===b[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+c);return a.params=a.params.filter(function(a){return-1===a.indexOf("access_token")}),a.params.push("access_token="+b),A(a)};var Xd=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i,Yd=/^(\w+):\/\/([^\/?]*)(\/[^?]+)?\??(.+)?/,Zd=function(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Zd.prototype.getStorageKey=function(a){var b,c=B(Sd.ACCESS_TOKEN),d="";return c&&c.u?(b=c.u,d=self.btoa(encodeURIComponent(b).replace(/%([0-9A-F]{2})/g,function(a,b){return String.fromCharCode(Number("0x"+b))}))):d=Sd.ACCESS_TOKEN||"",a?"mapbox.eventData."+a+":"+d:"mapbox.eventData:"+d},Zd.prototype.fetchEventData=function(){var a=v("localStorage"),b=this.getStorageKey(),c=this.getStorageKey("uuid");if(a)try{var d=self.localStorage.getItem(b);d&&(this.eventData=JSON.parse(d));var e=self.localStorage.getItem(c);e&&(this.anonId=e)}catch(a){r("Unable to read from LocalStorage")}},Zd.prototype.saveEventData=function(){var a=v("localStorage"),b=this.getStorageKey(),c=this.getStorageKey("uuid");if(a)try{self.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(b,JSON.stringify(this.eventData))}catch(a){r("Unable to write to LocalStorage")}},Zd.prototype.processRequests=function(a){},Zd.prototype.postEvent=function(a,b,c,d){var e=this;if(Sd.EVENTS_URL){var f=z(Sd.EVENTS_URL);f.params.push("access_token="+(d||Sd.ACCESS_TOKEN||""));var g={event:this.type,created:new Date(a).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.3.2",skuId:"01",userId:this.anonId},h=b?i(g,b):g,j={url:A(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([h])};this.pendingRequest=qe(j,function(a){e.pendingRequest=null,c(a),e.saveEventData(),e.processRequests(d)})}},Zd.prototype.queueRequest=function(a,b){this.queue.push(a),this.processRequests(b)};var $d,_d=function(a){function b(){a.call(this,"map.load"),this.success={},this.skuToken=""}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.postMapLoadEvent=function(a,b,c,d){this.skuToken=c,(Sd.EVENTS_URL&&d||Sd.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(a){return x(a)||y(a)}))&&this.queueRequest({id:b,timestamp:Date.now()},d)},b.prototype.processRequests=function(a){var b=this;if(!this.pendingRequest&&0!==this.queue.length){var c=this.queue.shift(),d=c.id,e=c.timestamp;d&&this.success[d]||(this.anonId||this.fetchEventData(),l(this.anonId)||(this.anonId=k()),this.postEvent(e,{skuToken:this.skuToken},function(a){a||d&&(b.success[d]=!0)},a))}},b}(Zd),ae=new(function(a){function b(b){a.call(this,"appUserTurnstile"),this._customAccessToken=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.postTurnstileEvent=function(a,b){Sd.EVENTS_URL&&Sd.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(a){return x(a)||y(a)})&&this.queueRequest(Date.now(),b)},b.prototype.processRequests=function(a){var b=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var c=B(Sd.ACCESS_TOKEN),d=c?c.u:Sd.ACCESS_TOKEN,e=d!==this.eventData.tokenU;l(this.anonId)||(this.anonId=k(),e=!0);var f=this.queue.shift();if(this.eventData.lastSuccess){var g=new Date(this.eventData.lastSuccess),h=new Date(f),i=(f-this.eventData.lastSuccess)/864e5;e=e||i>=1||i<-1||g.getDate()!==h.getDate()}else e=!0;if(!e)return this.processRequests();this.postEvent(f,{"enabled.telemetry":!1},function(a){a||(b.eventData.lastSuccess=f,b.eventData.tokenU=d)},a)}},b}(Zd)),be=ae.postTurnstileEvent.bind(ae),ce=new _d,de=ce.postMapLoadEvent.bind(ce),ee="mapbox-tiles",fe=500,ge=50,he=42e4,ie=1/0,je={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(je);var ke,le,me=function(a){function b(b,c,d){401===c&&y(d)&&(b+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),a.call(this,b),this.status=c,this.url=d,this.name=this.constructor.name,this.message=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},b}(Error),ne=D()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href},oe=function(a,b){if(c=a.url,!(/^file:/.test(c)||/^file:/.test(ne())&&!/^\w+:/.test(c))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return E(a,b);if(D()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,b)}var c;return function(a,b){var c=new self.XMLHttpRequest;for(var d in c.open(a.method||"GET",a.url,!0),"arrayBuffer"===a.type&&(c.responseType="arraybuffer"),a.headers)c.setRequestHeader(d,a.headers[d]);return"json"===a.type&&(c.responseType="text",c.setRequestHeader("Accept","application/json")),c.withCredentials="include"===a.credentials,c.onerror=function(){b(new Error(c.statusText))},c.onload=function(){if((c.status>=200&&c.status<300||0===c.status)&&null!==c.response){var d=c.response;if("json"===a.type)try{d=JSON.parse(c.response)}catch(a){return b(a)}b(null,d,c.getResponseHeader("Cache-Control"),c.getResponseHeader("Expires"))}else b(new me(c.statusText,c.status,a.url))},c.send(a.body),{cancel:function(){return c.abort()}}}(a,b)},pe=function(a,b){return oe(i(a,{type:"arrayBuffer"}),b)},qe=function(a,b){return oe(i(a,{method:"POST"}),b)};ke=[],le=0;var re=function(a,b){if(le>=Sd.MAX_PARALLEL_IMAGE_REQUESTS){var c={requestParameters:a,callback:b,cancelled:!1,cancel:function(){this.cancelled=!0}};return ke.push(c),c}le++;var d=!1,e=function(){if(!d)for(d=!0,le--;ke.length&&le<Sd.MAX_PARALLEL_IMAGE_REQUESTS;){var a=ke.shift(),b=a.requestParameters,c=a.callback;a.cancelled||(a.cancel=re(b,c).cancel)}},f=pe(a,function(a,c,d,f){if(e(),a)b(a);else if(c){var g=new self.Image,h=self.URL||self.webkitURL;g.onload=function(){b(null,g),h.revokeObjectURL(g.src)},g.onerror=function(){return b(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var i=new self.Blob([new Uint8Array(c)],{type:"image/png"});g.cacheControl=d,g.expires=f,g.src=c.byteLength?h.createObjectURL(i):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}});return{cancel:function(){f.cancel(),e()}}},se=function(a,b){void 0===b&&(b={}),i(this,b),this.type=a},te=function(a){function b(b,c){void 0===c&&(c={}),a.call(this,"error",i({error:b},c))}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(se),ue=function(){};ue.prototype.on=function(a,b){return this._listeners=this._listeners||{},F(a,b,this._listeners),this},ue.prototype.off=function(a,b){return G(a,b,this._listeners),G(a,b,this._oneTimeListeners),this},ue.prototype.once=function(a,b){return this._oneTimeListeners=this._oneTimeListeners||{},F(a,b,this._oneTimeListeners),this},ue.prototype.fire=function(a,b){"string"==typeof a&&(a=new se(a,b||{}));var c=a.type;if(this.listens(c)){a.target=this;for(var d=0,e=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];d<e.length;d+=1)e[d].call(this,a);for(var f=0,g=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];f<g.length;f+=1){var h=g[f];G(c,h,this._oneTimeListeners),h.call(this,a)}var j=this._eventedParent;j&&(i(a,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),j.fire(a))}else a instanceof te&&console.error(a.error);return this},ue.prototype.listens=function(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)},ue.prototype.setEventedParent=function(a,b){return this._eventedParent=a,this._eventedParentData=b,this};var ve={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"string",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"},{"!":"text-variable-anchor"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},
"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}},we=function(a,b,c,d){this.message=(a?a+": ":"")+c,d&&(this.identifier=d),null!=b&&b.__line__&&(this.line=b.__line__)},xe=function(a){function b(b,c){a.call(this,c),this.message=c,this.key=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(Error),ye=function(a,b){void 0===b&&(b=[]),this.parent=a,this.bindings={};for(var c=0,d=b;c<d.length;c+=1){var e=d[c],f=e[0],g=e[1];this.bindings[f]=g}};ye.prototype.concat=function(a){return new ye(this,a)},ye.prototype.get=function(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(a+" not found in scope.")},ye.prototype.has=function(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)};var ze={kind:"null"},Ae={kind:"number"},Be={kind:"string"},Ce={kind:"boolean"},De={kind:"color"},Ee={kind:"object"},Fe={kind:"value"},Ge={kind:"collator"},He={kind:"formatted"},Ie=[ze,Ae,Be,Ce,De,He,Ee,M(Fe)],Je=b(function(a,b){function c(a){return(a=Math.round(a))<0?0:a>255?255:a}function d(a){return a<0?0:a>1?1:a}function e(a){return c("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function f(a){return d("%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))}function g(a,b,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?a+(b-a)*c*6:2*c<1?b:3*c<2?a+(b-a)*(2/3-c)*6:a}var h={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{b.parseCSSColor=function(a){var b,d=a.replace(/ /g,"").toLowerCase();if(d in h)return h[d].slice();if("#"===d[0])return 4===d.length?(b=parseInt(d.substr(1),16))>=0&&b<=4095?[(3840&b)>>4|(3840&b)>>8,240&b|(240&b)>>4,15&b|(15&b)<<4,1]:null:7===d.length&&(b=parseInt(d.substr(1),16))>=0&&b<=16777215?[(16711680&b)>>16,(65280&b)>>8,255&b,1]:null;var i=d.indexOf("("),j=d.indexOf(")");if(-1!==i&&j+1===d.length){var k=d.substr(0,i),l=d.substr(i+1,j-(i+1)).split(","),m=1;switch(k){case"rgba":if(4!==l.length)return null;m=f(l.pop());case"rgb":return 3!==l.length?null:[e(l[0]),e(l[1]),e(l[2]),m];case"hsla":if(4!==l.length)return null;m=f(l.pop());case"hsl":if(3!==l.length)return null;var n=(parseFloat(l[0])%360+360)%360/360,o=f(l[1]),p=f(l[2]),q=p<=.5?p*(o+1):p+o-p*o,r=2*p-q;return[c(255*g(r,q,n+1/3)),c(255*g(r,q,n)),c(255*g(r,q,n-1/3)),m];default:return null}}return null}}catch(a){}}).parseCSSColor,Ke=function(a,b,c,d){void 0===d&&(d=1),this.r=a,this.g=b,this.b=c,this.a=d};Ke.parse=function(a){if(a){if(a instanceof Ke)return a;if("string"==typeof a){var b=Je(a);if(b)return new Ke(b[0]/255*b[3],b[1]/255*b[3],b[2]/255*b[3],b[3])}}},Ke.prototype.toString=function(){var a=this.toArray(),b=a[0],c=a[1],d=a[2],e=a[3];return"rgba("+Math.round(b)+","+Math.round(c)+","+Math.round(d)+","+e+")"},Ke.prototype.toArray=function(){var a=this.r,b=this.g,c=this.b,d=this.a;return 0===d?[0,0,0,0]:[255*a/d,255*b/d,255*c/d,d]},Ke.black=new Ke(0,0,0,1),Ke.white=new Ke(1,1,1,1),Ke.transparent=new Ke(0,0,0,0),Ke.red=new Ke(1,0,0,1);var Le=function(a,b,c){this.sensitivity=a?b?"variant":"case":b?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Le.prototype.compare=function(a,b){return this.collator.compare(a,b)},Le.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Me=function(a,b,c,d){this.text=a,this.scale=b,this.fontStack=c,this.textColor=d},Ne=function(a){this.sections=a};Ne.fromString=function(a){return new Ne([new Me(a,null,null,null)])},Ne.prototype.toString=function(){return this.sections.map(function(a){return a.text}).join("")},Ne.prototype.serialize=function(){for(var a=["format"],b=0,c=this.sections;b<c.length;b+=1){var d=c[b];a.push(d.text);var e={};d.fontStack&&(e["text-font"]=["literal",d.fontStack.split(",")]),d.scale&&(e["font-scale"]=d.scale),d.textColor&&(e["text-color"]=["rgba"].concat(d.textColor.toArray())),a.push(e)}return a};var Oe=function(a,b){this.type=a,this.value=b};Oe.parse=function(a,b){if(2!==a.length)return b.error("'literal' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(!function a(b){if(null===b)return!0;if("string"==typeof b)return!0;if("boolean"==typeof b)return!0;if("number"==typeof b)return!0;if(b instanceof Ke)return!0;if(b instanceof Le)return!0;if(b instanceof Ne)return!0;if(Array.isArray(b)){for(var c=0,d=b;c<d.length;c+=1)if(!a(d[c]))return!1;return!0}if("object"==typeof b){for(var e in b)if(!a(b[e]))return!1;return!0}return!1}(a[1]))return b.error("invalid value");var c=a[1],d=Q(c),e=b.expectedType;return"array"!==d.kind||0!==d.N||!e||"array"!==e.kind||"number"==typeof e.N&&0!==e.N||(d=e),new Oe(d,c)},Oe.prototype.evaluate=function(){return this.value},Oe.prototype.eachChild=function(){},Oe.prototype.possibleOutputs=function(){return[this.value]},Oe.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Ke?["rgba"].concat(this.value.toArray()):this.value instanceof Ne?this.value.serialize():this.value};var Pe=function(a){this.name="ExpressionEvaluationError",this.message=a};Pe.prototype.toJSON=function(){return this.message};var Qe={string:Be,number:Ae,boolean:Ce,object:Ee},Re=function(a,b){this.type=a,this.args=b};Re.parse=function(a,b){if(a.length<2)return b.error("Expected at least one argument.");var c,d=1,e=a[0];if("array"===e){var f,g;if(a.length>2){var h=a[1];if("string"!=typeof h||!(h in Qe)||"object"===h)return b.error('The item type argument of "array" must be one of string, number, boolean',1);f=Qe[h],d++}else f=Fe;if(a.length>3){if(null!==a[2]&&("number"!=typeof a[2]||a[2]<0||a[2]!==Math.floor(a[2])))return b.error('The length argument to "array" must be a positive integer literal',2);g=a[2],d++}c=M(f,g)}else c=Qe[e];for(var i=[];d<a.length;d++){var j=b.parse(a[d],d,Fe);if(!j)return null;i.push(j)}return new Re(c,i)},Re.prototype.evaluate=function(a){for(var b=0;b<this.args.length;b++){var c=this.args[b].evaluate(a);if(!O(this.type,Q(c)))return c;if(b===this.args.length-1)throw new Pe("Expected value to be of type "+N(this.type)+", but found "+N(Q(c))+" instead.")}return null},Re.prototype.eachChild=function(a){this.args.forEach(a)},Re.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.args.map(function(a){return a.possibleOutputs()}))},Re.prototype.serialize=function(){var a=this.type,b=[a.kind];if("array"===a.kind){var c=a.itemType;if("string"===c.kind||"number"===c.kind||"boolean"===c.kind){b.push(c.kind);var d=a.N;("number"==typeof d||this.args.length>1)&&b.push(d)}}return b.concat(this.args.map(function(a){return a.serialize()}))};var Se=function(a){this.type=He,this.sections=a};Se.parse=function(a,b){if(a.length<3)return b.error("Expected at least two arguments.");if((a.length-1)%2!=0)return b.error("Expected an even number of arguments.");for(var c=[],d=1;d<a.length-1;d+=2){var e=b.parse(a[d],1,Fe);if(!e)return null;var f=e.type.kind;if("string"!==f&&"value"!==f&&"null"!==f)return b.error("Formatted text type must be 'string', 'value', or 'null'.");var g=a[d+1];if("object"!=typeof g||Array.isArray(g))return b.error("Format options argument must be an object.");var h=null;if(g["font-scale"]&&!(h=b.parse(g["font-scale"],1,Ae)))return null;var i=null;if(g["text-font"]&&!(i=b.parse(g["text-font"],1,M(Be))))return null;var j=null;if(g["text-color"]&&!(j=b.parse(g["text-color"],1,De)))return null;c.push({text:e,scale:h,font:i,textColor:j})}return new Se(c)},Se.prototype.evaluate=function(a){return new Ne(this.sections.map(function(b){return new Me(R(b.text.evaluate(a)),b.scale?b.scale.evaluate(a):null,b.font?b.font.evaluate(a).join(","):null,b.textColor?b.textColor.evaluate(a):null)}))},Se.prototype.eachChild=function(a){for(var b=0,c=this.sections;b<c.length;b+=1){var d=c[b];a(d.text),d.scale&&a(d.scale),d.font&&a(d.font),d.textColor&&a(d.textColor)}},Se.prototype.possibleOutputs=function(){return[void 0]},Se.prototype.serialize=function(){for(var a=["format"],b=0,c=this.sections;b<c.length;b+=1){var d=c[b];a.push(d.text.serialize());var e={};d.scale&&(e["font-scale"]=d.scale.serialize()),d.font&&(e["text-font"]=d.font.serialize()),d.textColor&&(e["text-color"]=d.textColor.serialize()),a.push(e)}return a};var Te={"to-boolean":Ce,"to-color":De,"to-number":Ae,"to-string":Be},Ue=function(a,b){this.type=a,this.args=b};Ue.parse=function(a,b){if(a.length<2)return b.error("Expected at least one argument.");var c=a[0];if(("to-boolean"===c||"to-string"===c)&&2!==a.length)return b.error("Expected one argument.");for(var d=Te[c],e=[],f=1;f<a.length;f++){var g=b.parse(a[f],f,Fe);if(!g)return null;e.push(g)}return new Ue(d,e)},Ue.prototype.evaluate=function(a){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(a));if("color"===this.type.kind){for(var b,c,d=0,e=this.args;d<e.length;d+=1){if(c=null,(b=e[d].evaluate(a))instanceof Ke)return b;if("string"==typeof b){var f=a.parseColor(b);if(f)return f}else if(Array.isArray(b)&&!(c=b.length<3||b.length>4?"Invalid rbga value "+JSON.stringify(b)+": expected an array containing either three or four numeric values.":P(b[0],b[1],b[2],b[3])))return new Ke(b[0]/255,b[1]/255,b[2]/255,b[3])}throw new Pe(c||"Could not parse color from value '"+("string"==typeof b?b:String(JSON.stringify(b)))+"'")}if("number"===this.type.kind){for(var g=null,h=0,i=this.args;h<i.length;h+=1){if(null===(g=i[h].evaluate(a)))return 0;var j=Number(g);if(!isNaN(j))return j}throw new Pe("Could not convert "+JSON.stringify(g)+" to number.")}return"formatted"===this.type.kind?Ne.fromString(R(this.args[0].evaluate(a))):R(this.args[0].evaluate(a))},Ue.prototype.eachChild=function(a){this.args.forEach(a)},Ue.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.args.map(function(a){return a.possibleOutputs()}))},Ue.prototype.serialize=function(){if("formatted"===this.type.kind)return new Se([{text:this.args[0],scale:null,font:null,textColor:null}]).serialize();var a=["to-"+this.type.kind];return this.eachChild(function(b){a.push(b.serialize())}),a};var Ve=["Unknown","Point","LineString","Polygon"],We=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={}};We.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},We.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Ve[this.feature.type]:this.feature.type:null},We.prototype.properties=function(){return this.feature&&this.feature.properties||{}},We.prototype.parseColor=function(a){var b=this._parseColorCache[a];return b||(b=this._parseColorCache[a]=Ke.parse(a)),b};var Xe=function(a,b,c,d){this.name=a,this.type=b,this._evaluate=c,this.args=d};Xe.prototype.evaluate=function(a){return this._evaluate(a,this.args)},Xe.prototype.eachChild=function(a){this.args.forEach(a)},Xe.prototype.possibleOutputs=function(){return[void 0]},Xe.prototype.serialize=function(){return[this.name].concat(this.args.map(function(a){return a.serialize()}))},Xe.parse=function(a,b){var c,d=a[0],e=Xe.definitions[d];if(!e)return b.error('Unknown expression "'+d+'". If you wanted a literal array, use ["literal", [...]].',0);for(var f=Array.isArray(e)?e[0]:e.type,g=Array.isArray(e)?[[e[1],e[2]]]:e.overloads,h=g.filter(function(b){var c=b[0];return!Array.isArray(c)||c.length===a.length-1}),i=null,j=0,k=h;j<k.length;j+=1){var l=k[j],m=l[0],n=l[1];i=new $e(b.registry,b.path,null,b.scope);for(var o=[],p=!1,q=1;q<a.length;q++){var r=a[q],s=Array.isArray(m)?m[q-1]:m.type,t=i.parse(r,1+o.length,s);if(!t){p=!0;break}o.push(t)}if(!p)if(Array.isArray(m)&&m.length!==o.length)i.error("Expected "+m.length+" arguments, but found "+o.length+" instead.");else{for(var u=0;u<o.length;u++){var v=Array.isArray(m)?m[u]:m.type,w=o[u];i.concat(u+1).checkSubtype(v,w.type)}if(0===i.errors.length)return new Xe(d,f,n,o)}}if(1===h.length)(c=b.errors).push.apply(c,i.errors);else{for(var x=(h.length?h:g).map(function(a){var b;return b=a[0],Array.isArray(b)?"("+b.map(N).join(", ")+")":"("+N(b.type)+"...)"}).join(" | "),y=[],z=1;z<a.length;z++){var A=b.parse(a[z],1+y.length);if(!A)return null;y.push(N(A.type))}b.error("Expected arguments of type "+x+", but found ("+y.join(", ")+") instead.")}return null},Xe.register=function(a,b){for(var c in Xe.definitions=b,b)a[c]=Xe};var Ye=function(a,b,c){this.type=Ge,this.locale=c,this.caseSensitive=a,this.diacriticSensitive=b};Ye.parse=function(a,b){if(2!==a.length)return b.error("Expected one argument.");var c=a[1];if("object"!=typeof c||Array.isArray(c))return b.error("Collator options argument must be an object.");var d=b.parse(void 0!==c["case-sensitive"]&&c["case-sensitive"],1,Ce);if(!d)return null;var e=b.parse(void 0!==c["diacritic-sensitive"]&&c["diacritic-sensitive"],1,Ce);if(!e)return null;var f=null;return c.locale&&!(f=b.parse(c.locale,1,Be))?null:new Ye(d,e,f)},Ye.prototype.evaluate=function(a){return new Le(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)},Ye.prototype.eachChild=function(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)},Ye.prototype.possibleOutputs=function(){return[void 0]},Ye.prototype.serialize=function(){var a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]};var Ze=function(a,b){this.type=b.type,this.name=a,this.boundExpression=b};Ze.parse=function(a,b){if(2!==a.length||"string"!=typeof a[1])return b.error("'var' expression requires exactly one string literal argument.");var c=a[1];return b.scope.has(c)?new Ze(c,b.scope.get(c)):b.error('Unknown variable "'+c+'". Make sure "'+c+'" has been bound in an enclosing "let" expression before using it.',1)},Ze.prototype.evaluate=function(a){return this.boundExpression.evaluate(a)},Ze.prototype.eachChild=function(){},Ze.prototype.possibleOutputs=function(){return[void 0]},Ze.prototype.serialize=function(){return["var",this.name]};var $e=function(a,b,c,d,e){void 0===b&&(b=[]),void 0===d&&(d=new ye),void 0===e&&(e=[]),this.registry=a,this.path=b,this.key=b.map(function(a){return"["+a+"]"}).join(""),this.scope=d,this.errors=e,this.expectedType=c};$e.prototype.parse=function(a,b,c,d,e){return void 0===e&&(e={}),b?this.concat(b,c,d)._parse(a,e):this._parse(a,e)},$e.prototype._parse=function(a,b){function c(a,b,c){return"assert"===c?new Re(b,[a]):"coerce"===c?new Ue(b,[a]):a}if(null!==a&&"string"!=typeof a&&"boolean"!=typeof a&&"number"!=typeof a||(a=["literal",a]),Array.isArray(a)){if(0===a.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var d=a[0];if("string"!=typeof d)return this.error("Expression name must be a string, but found "+typeof d+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var e=this.registry[d];if(e){var f=e.parse(a,this);if(!f)return null;if(this.expectedType){var g=this.expectedType,h=f.type;if("string"!==g.kind&&"number"!==g.kind&&"boolean"!==g.kind&&"object"!==g.kind&&"array"!==g.kind||"value"!==h.kind)if("color"!==g.kind&&"formatted"!==g.kind||"value"!==h.kind&&"string"!==h.kind){if(this.checkSubtype(g,h))return null}else f=c(f,g,b.typeAnnotation||"coerce");else f=c(f,g,b.typeAnnotation||"assert")}if(!(f instanceof Oe)&&function a(b){if(b instanceof Ze)return a(b.boundExpression);if(b instanceof Xe&&"error"===b.name)return!1;if(b instanceof Ye)return!1;var c=b instanceof Ue||b instanceof Re,d=!0;return b.eachChild(function(b){d=c?d&&a(b):d&&b instanceof Oe}),!!d&&S(b)&&U(b,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(f)){var i=new We;try{f=new Oe(f.type,f.evaluate(i))}catch(a){return this.error(a.message),null}}return f}return this.error('Unknown expression "'+d+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===a?this.error("'undefined' value invalid. Use null instead."):"object"==typeof a?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof a+" instead.")},$e.prototype.concat=function(a,b,c){var d="number"==typeof a?this.path.concat(a):this.path,e=c?this.scope.concat(c):this.scope;return new $e(this.registry,d,b||null,e,this.errors)},$e.prototype.error=function(a){for(var b=[],c=arguments.length-1;c-- >0;)b[c]=arguments[c+1];var d=""+this.key+b.map(function(a){return"["+a+"]"}).join("");this.errors.push(new xe(d,a))},$e.prototype.checkSubtype=function(a,b){var c=O(a,b);return c&&this.error(c),c};var _e=function(a,b,c){
this.type=a,this.input=b,this.labels=[],this.outputs=[];for(var d=0,e=c;d<e.length;d+=1){var f=e[d],g=f[0],h=f[1];this.labels.push(g),this.outputs.push(h)}};_e.parse=function(a,b){if(a.length-1<4)return b.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return b.error("Expected an even number of arguments.");var c=b.parse(a[1],1,Ae);if(!c)return null;var d=[],e=null;b.expectedType&&"value"!==b.expectedType.kind&&(e=b.expectedType);for(var f=1;f<a.length;f+=2){var g=1===f?-1/0:a[f],h=a[f+1],i=f,j=f+1;if("number"!=typeof g)return b.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(d.length&&d[d.length-1][0]>=g)return b.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',i);var k=b.parse(h,j,e);if(!k)return null;e=e||k.type,d.push([g,k])}return new _e(e,c,d)},_e.prototype.evaluate=function(a){var b=this.labels,c=this.outputs;if(1===b.length)return c[0].evaluate(a);var d=this.input.evaluate(a);if(d<=b[0])return c[0].evaluate(a);var e=b.length;return d>=b[e-1]?c[e-1].evaluate(a):c[V(b,d)].evaluate(a)},_e.prototype.eachChild=function(a){a(this.input);for(var b=0,c=this.outputs;b<c.length;b+=1)a(c[b])},_e.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.outputs.map(function(a){return a.possibleOutputs()}))},_e.prototype.serialize=function(){for(var a=["step",this.input.serialize()],b=0;b<this.labels.length;b++)b>0&&a.push(this.labels[b]),a.push(this.outputs[b].serialize());return a};var af=Object.freeze({number:W,color:function(a,b,c){return new Ke(W(a.r,b.r,c),W(a.g,b.g,c),W(a.b,b.b,c),W(a.a,b.a,c))},array:function(a,b,c){return a.map(function(a,d){return W(a,b[d],c)})}}),bf=.95047,cf=1,df=1.08883,ef=4/29,ff=6/29,gf=3*ff*ff,hf=ff*ff*ff,jf=Math.PI/180,kf=180/Math.PI,lf={forward:_,reverse:aa,interpolate:function(a,b,c){return{l:W(a.l,b.l,c),a:W(a.a,b.a,c),b:W(a.b,b.b,c),alpha:W(a.alpha,b.alpha,c)}}},mf={forward:function(a){var b=_(a),c=b.l,d=b.a,e=b.b,f=Math.atan2(e,d)*kf;return{h:f<0?f+360:f,c:Math.sqrt(d*d+e*e),l:c,alpha:a.a}},reverse:function(a){var b=a.h*jf,c=a.c;return aa({l:a.l,a:Math.cos(b)*c,b:Math.sin(b)*c,alpha:a.alpha})},interpolate:function(a,b,c){return{h:function(a,b,c){var d=b-a;return a+c*(d>180||d<-180?d-360*Math.round(d/360):d)}(a.h,b.h,c),c:W(a.c,b.c,c),l:W(a.l,b.l,c),alpha:W(a.alpha,b.alpha,c)}}},nf=Object.freeze({lab:lf,hcl:mf}),of=function(a,b,c,d,e){this.type=a,this.operator=b,this.interpolation=c,this.input=d,this.labels=[],this.outputs=[];for(var f=0,g=e;f<g.length;f+=1){var h=g[f],i=h[0],j=h[1];this.labels.push(i),this.outputs.push(j)}};of.interpolationFactor=function(a,b,c,d){var e=0;if("exponential"===a.name)e=ba(b,a.base,c,d);else if("linear"===a.name)e=ba(b,1,c,d);else if("cubic-bezier"===a.name){var f=a.controlPoints;e=new Fd(f[0],f[1],f[2],f[3]).solve(ba(b,1,c,d))}return e},of.parse=function(a,b){var c=a[0],d=a[1],e=a[2],f=a.slice(3);if(!Array.isArray(d)||0===d.length)return b.error("Expected an interpolation type expression.",1);if("linear"===d[0])d={name:"linear"};else if("exponential"===d[0]){var g=d[1];if("number"!=typeof g)return b.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:g}}else{if("cubic-bezier"!==d[0])return b.error("Unknown interpolation type "+String(d[0]),1,0);var h=d.slice(1);if(4!==h.length||h.some(function(a){return"number"!=typeof a||a<0||a>1}))return b.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:h}}if(a.length-1<4)return b.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return b.error("Expected an even number of arguments.");if(!(e=b.parse(e,2,Ae)))return null;var i=[],j=null;"interpolate-hcl"===c||"interpolate-lab"===c?j=De:b.expectedType&&"value"!==b.expectedType.kind&&(j=b.expectedType);for(var k=0;k<f.length;k+=2){var l=f[k],m=f[k+1],n=k+3,o=k+4;if("number"!=typeof l)return b.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(i.length&&i[i.length-1][0]>=l)return b.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);var p=b.parse(m,o,j);if(!p)return null;j=j||p.type,i.push([l,p])}return"number"===j.kind||"color"===j.kind||"array"===j.kind&&"number"===j.itemType.kind&&"number"==typeof j.N?new of(j,c,d,e,i):b.error("Type "+N(j)+" is not interpolatable.")},of.prototype.evaluate=function(a){var b=this.labels,c=this.outputs;if(1===b.length)return c[0].evaluate(a);var d=this.input.evaluate(a);if(d<=b[0])return c[0].evaluate(a);var e=b.length;if(d>=b[e-1])return c[e-1].evaluate(a);var f=V(b,d),g=b[f],h=b[f+1],i=of.interpolationFactor(this.interpolation,d,g,h),j=c[f].evaluate(a),k=c[f+1].evaluate(a);return"interpolate"===this.operator?af[this.type.kind.toLowerCase()](j,k,i):"interpolate-hcl"===this.operator?mf.reverse(mf.interpolate(mf.forward(j),mf.forward(k),i)):lf.reverse(lf.interpolate(lf.forward(j),lf.forward(k),i))},of.prototype.eachChild=function(a){a(this.input);for(var b=0,c=this.outputs;b<c.length;b+=1)a(c[b])},of.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.outputs.map(function(a){return a.possibleOutputs()}))},of.prototype.serialize=function(){var a;a="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var b=[this.operator,a,this.input.serialize()],c=0;c<this.labels.length;c++)b.push(this.labels[c],this.outputs[c].serialize());return b};var pf=function(a,b){this.type=a,this.args=b};pf.parse=function(a,b){if(a.length<2)return b.error("Expectected at least one argument.");var c=null,d=b.expectedType;d&&"value"!==d.kind&&(c=d);for(var e=[],f=0,g=a.slice(1);f<g.length;f+=1){var h=g[f],i=b.parse(h,1+e.length,c,void 0,{typeAnnotation:"omit"});if(!i)return null;c=c||i.type,e.push(i)}var j=d&&e.some(function(a){return O(d,a.type)});return new pf(j?Fe:c,e)},pf.prototype.evaluate=function(a){for(var b=null,c=0,d=this.args;c<d.length&&null===(b=d[c].evaluate(a));c+=1);return b},pf.prototype.eachChild=function(a){this.args.forEach(a)},pf.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.args.map(function(a){return a.possibleOutputs()}))},pf.prototype.serialize=function(){var a=["coalesce"];return this.eachChild(function(b){a.push(b.serialize())}),a};var qf=function(a,b){this.type=b.type,this.bindings=[].concat(a),this.result=b};qf.prototype.evaluate=function(a){return this.result.evaluate(a)},qf.prototype.eachChild=function(a){for(var b=0,c=this.bindings;b<c.length;b+=1)a(c[b][1]);a(this.result)},qf.parse=function(a,b){if(a.length<4)return b.error("Expected at least 3 arguments, but found "+(a.length-1)+" instead.");for(var c=[],d=1;d<a.length-1;d+=2){var e=a[d];if("string"!=typeof e)return b.error("Expected string, but found "+typeof e+" instead.",d);if(/[^a-zA-Z0-9_]/.test(e))return b.error("Variable names must contain only alphanumeric characters or '_'.",d);var f=b.parse(a[d+1],d+1);if(!f)return null;c.push([e,f])}var g=b.parse(a[a.length-1],a.length-1,b.expectedType,c);return g?new qf(c,g):null},qf.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},qf.prototype.serialize=function(){for(var a=["let"],b=0,c=this.bindings;b<c.length;b+=1){var d=c[b],e=d[0],f=d[1];a.push(e,f.serialize())}return a.push(this.result.serialize()),a};var rf=function(a,b,c){this.type=a,this.index=b,this.input=c};rf.parse=function(a,b){if(3!==a.length)return b.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var c=b.parse(a[1],1,Ae),d=b.parse(a[2],2,M(b.expectedType||Fe));if(!c||!d)return null;var e=d.type;return new rf(e.itemType,c,d)},rf.prototype.evaluate=function(a){var b=this.index.evaluate(a),c=this.input.evaluate(a);if(b<0)throw new Pe("Array index out of bounds: "+b+" < 0.");if(b>=c.length)throw new Pe("Array index out of bounds: "+b+" > "+(c.length-1)+".");if(b!==Math.floor(b))throw new Pe("Array index must be an integer, but found "+b+" instead.");return c[b]},rf.prototype.eachChild=function(a){a(this.index),a(this.input)},rf.prototype.possibleOutputs=function(){return[void 0]},rf.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var sf=function(a,b,c,d,e,f){this.inputType=a,this.type=b,this.input=c,this.cases=d,this.outputs=e,this.otherwise=f};sf.parse=function(a,b){if(a.length<5)return b.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if(a.length%2!=1)return b.error("Expected an even number of arguments.");var c,d;b.expectedType&&"value"!==b.expectedType.kind&&(d=b.expectedType);for(var e={},f=[],g=2;g<a.length-1;g+=2){var h=a[g],i=a[g+1];Array.isArray(h)||(h=[h]);var j=b.concat(g);if(0===h.length)return j.error("Expected at least one branch label.");for(var k=0,l=h;k<l.length;k+=1){var m=l[k];if("number"!=typeof m&&"string"!=typeof m)return j.error("Branch labels must be numbers or strings.");if("number"==typeof m&&Math.abs(m)>Number.MAX_SAFE_INTEGER)return j.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof m&&Math.floor(m)!==m)return j.error("Numeric branch labels must be integer values.");if(c){if(j.checkSubtype(c,Q(m)))return null}else c=Q(m);if(void 0!==e[String(m)])return j.error("Branch labels must be unique.");e[String(m)]=f.length}var n=b.parse(i,g,d);if(!n)return null;d=d||n.type,f.push(n)}var o=b.parse(a[1],1,Fe);if(!o)return null;var p=b.parse(a[a.length-1],a.length-1,d);return p?"value"!==o.type.kind&&b.concat(1).checkSubtype(c,o.type)?null:new sf(c,d,o,e,f,p):null},sf.prototype.evaluate=function(a){var b=this.input.evaluate(a);return(Q(b)===this.inputType&&this.outputs[this.cases[b]]||this.otherwise).evaluate(a)},sf.prototype.eachChild=function(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)},sf.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.outputs.map(function(a){return a.possibleOutputs()})).concat(this.otherwise.possibleOutputs())},sf.prototype.serialize=function(){for(var a=this,b=["match",this.input.serialize()],c=[],d={},e=0,f=Object.keys(this.cases).sort();e<f.length;e+=1){var g=f[e];void 0===(l=d[this.cases[g]])?(d[this.cases[g]]=c.length,c.push([this.cases[g],[g]])):c[l][1].push(g)}for(var h=function(b){return"number"===a.inputType.kind?Number(b):b},i=0,j=c;i<j.length;i+=1){var k=j[i],l=k[0],m=k[1];1===m.length?b.push(h(m[0])):b.push(m.map(h)),b.push(this.outputs[outputIndex$1].serialize())}return b.push(this.otherwise.serialize()),b};var tf=function(a,b,c){this.type=a,this.branches=b,this.otherwise=c};tf.parse=function(a,b){if(a.length<4)return b.error("Expected at least 3 arguments, but found only "+(a.length-1)+".");if(a.length%2!=0)return b.error("Expected an odd number of arguments.");var c;b.expectedType&&"value"!==b.expectedType.kind&&(c=b.expectedType);for(var d=[],e=1;e<a.length-1;e+=2){var f=b.parse(a[e],e,Ce);if(!f)return null;var g=b.parse(a[e+1],e+1,c);if(!g)return null;d.push([f,g]),c=c||g.type}var h=b.parse(a[a.length-1],a.length-1,c);return h?new tf(c,d,h):null},tf.prototype.evaluate=function(a){for(var b=0,c=this.branches;b<c.length;b+=1){var d=c[b],e=d[0],f=d[1];if(e.evaluate(a))return f.evaluate(a)}return this.otherwise.evaluate(a)},tf.prototype.eachChild=function(a){for(var b=0,c=this.branches;b<c.length;b+=1){var d=c[b],e=d[0],f=d[1];a(e),a(f)}a(this.otherwise)},tf.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.branches.map(function(a){return a[0],a[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs())},tf.prototype.serialize=function(){var a=["case"];return this.eachChild(function(b){a.push(b.serialize())}),a};var uf=ea("==",function(a,b,c){return b===c},da),vf=ea("!=",function(a,b,c){return b!==c},function(a,b,c,d){return!da(0,b,c,d)}),wf=ea("<",function(a,b,c){return b<c},function(a,b,c,d){return d.compare(b,c)<0}),xf=ea(">",function(a,b,c){return b>c},function(a,b,c,d){return d.compare(b,c)>0}),yf=ea("<=",function(a,b,c){return b<=c},function(a,b,c,d){return d.compare(b,c)<=0}),zf=ea(">=",function(a,b,c){return b>=c},function(a,b,c,d){return d.compare(b,c)>=0}),Af=function(a,b,c,d,e){this.type=Be,this.number=a,this.locale=b,this.currency=c,this.minFractionDigits=d,this.maxFractionDigits=e};Af.parse=function(a,b){if(3!==a.length)return b.error("Expected two arguments.");var c=b.parse(a[1],1,Ae);if(!c)return null;var d=a[2];if("object"!=typeof d||Array.isArray(d))return b.error("NumberFormat options argument must be an object.");var e=null;if(d.locale&&!(e=b.parse(d.locale,1,Be)))return null;var f=null;if(d.currency&&!(f=b.parse(d.currency,1,Be)))return null;var g=null;if(d["min-fraction-digits"]&&!(g=b.parse(d["min-fraction-digits"],1,Ae)))return null;var h=null;return d["max-fraction-digits"]&&!(h=b.parse(d["max-fraction-digits"],1,Ae))?null:new Af(c,e,f,g,h)},Af.prototype.evaluate=function(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))},Af.prototype.eachChild=function(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)},Af.prototype.possibleOutputs=function(){return[void 0]},Af.prototype.serialize=function(){var a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]};var Bf=function(a){this.type=Ae,this.input=a};Bf.parse=function(a,b){if(2!==a.length)return b.error("Expected 1 argument, but found "+(a.length-1)+" instead.");var c=b.parse(a[1],1);return c?"array"!==c.type.kind&&"string"!==c.type.kind&&"value"!==c.type.kind?b.error("Expected argument of type string or array, but found "+N(c.type)+" instead."):new Bf(c):null},Bf.prototype.evaluate=function(a){var b=this.input.evaluate(a);if("string"==typeof b)return b.length;if(Array.isArray(b))return b.length;throw new Pe("Expected value to be of type string or array, but found "+N(Q(b))+" instead.")},Bf.prototype.eachChild=function(a){a(this.input)},Bf.prototype.possibleOutputs=function(){return[void 0]},Bf.prototype.serialize=function(){var a=["length"];return this.eachChild(function(b){a.push(b.serialize())}),a};var Cf={"==":uf,"!=":vf,">":xf,"<":wf,">=":zf,"<=":yf,array:Re,at:rf,boolean:Re,case:tf,coalesce:pf,collator:Ye,format:Se,interpolate:of,"interpolate-hcl":of,"interpolate-lab":of,length:Bf,let:qf,literal:Oe,match:sf,number:Re,"number-format":Af,object:Re,step:_e,string:Re,"to-boolean":Ue,"to-color":Ue,"to-number":Ue,"to-string":Ue,var:Ze};Xe.register(Cf,{error:[{kind:"error"},[Be],function(a,b){var c=b[0];throw new Pe(c.evaluate(a))}],typeof:[Be,[Fe],function(a,b){return N(Q(b[0].evaluate(a)))}],"to-rgba":[M(Ae,4),[De],function(a,b){return b[0].evaluate(a).toArray()}],rgb:[De,[Ae,Ae,Ae],fa],rgba:[De,[Ae,Ae,Ae,Ae],fa],has:{type:Ce,overloads:[[[Be],function(a,b){return ga(b[0].evaluate(a),a.properties())}],[[Be,Ee],function(a,b){var c=b[0],d=b[1];return ga(c.evaluate(a),d.evaluate(a))}]]},get:{type:Fe,overloads:[[[Be],function(a,b){return ha(b[0].evaluate(a),a.properties())}],[[Be,Ee],function(a,b){var c=b[0],d=b[1];return ha(c.evaluate(a),d.evaluate(a))}]]},"feature-state":[Fe,[Be],function(a,b){return ha(b[0].evaluate(a),a.featureState||{})}],properties:[Ee,[],function(a){return a.properties()}],"geometry-type":[Be,[],function(a){return a.geometryType()}],id:[Fe,[],function(a){return a.id()}],zoom:[Ae,[],function(a){return a.globals.zoom}],"heatmap-density":[Ae,[],function(a){return a.globals.heatmapDensity||0}],"line-progress":[Ae,[],function(a){return a.globals.lineProgress||0}],accumulated:[Fe,[],function(a){return void 0===a.globals.accumulated?null:a.globals.accumulated}],"+":[Ae,ia(Ae),function(a,b){for(var c=0,d=0,e=b;d<e.length;d+=1)c+=e[d].evaluate(a);return c}],"*":[Ae,ia(Ae),function(a,b){for(var c=1,d=0,e=b;d<e.length;d+=1)c*=e[d].evaluate(a);return c}],"-":{type:Ae,overloads:[[[Ae,Ae],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)-d.evaluate(a)}],[[Ae],function(a,b){return-b[0].evaluate(a)}]]},"/":[Ae,[Ae,Ae],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)/d.evaluate(a)}],"%":[Ae,[Ae,Ae],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)%d.evaluate(a)}],ln2:[Ae,[],function(){return Math.LN2}],pi:[Ae,[],function(){return Math.PI}],e:[Ae,[],function(){return Math.E}],"^":[Ae,[Ae,Ae],function(a,b){var c=b[0],d=b[1];return Math.pow(c.evaluate(a),d.evaluate(a))}],sqrt:[Ae,[Ae],function(a,b){var c=b[0];return Math.sqrt(c.evaluate(a))}],log10:[Ae,[Ae],function(a,b){var c=b[0];return Math.log(c.evaluate(a))/Math.LN10}],ln:[Ae,[Ae],function(a,b){var c=b[0];return Math.log(c.evaluate(a))}],log2:[Ae,[Ae],function(a,b){var c=b[0];return Math.log(c.evaluate(a))/Math.LN2}],sin:[Ae,[Ae],function(a,b){var c=b[0];return Math.sin(c.evaluate(a))}],cos:[Ae,[Ae],function(a,b){var c=b[0];return Math.cos(c.evaluate(a))}],tan:[Ae,[Ae],function(a,b){var c=b[0];return Math.tan(c.evaluate(a))}],asin:[Ae,[Ae],function(a,b){var c=b[0];return Math.asin(c.evaluate(a))}],acos:[Ae,[Ae],function(a,b){var c=b[0];return Math.acos(c.evaluate(a))}],atan:[Ae,[Ae],function(a,b){var c=b[0];return Math.atan(c.evaluate(a))}],min:[Ae,ia(Ae),function(a,b){return Math.min.apply(Math,b.map(function(b){return b.evaluate(a)}))}],max:[Ae,ia(Ae),function(a,b){return Math.max.apply(Math,b.map(function(b){return b.evaluate(a)}))}],abs:[Ae,[Ae],function(a,b){var c=b[0];return Math.abs(c.evaluate(a))}],round:[Ae,[Ae],function(a,b){var c=b[0].evaluate(a);return c<0?-Math.round(-c):Math.round(c)}],floor:[Ae,[Ae],function(a,b){var c=b[0];return Math.floor(c.evaluate(a))}],ceil:[Ae,[Ae],function(a,b){var c=b[0];return Math.ceil(c.evaluate(a))}],"filter-==":[Ce,[Be,Fe],function(a,b){var c=b[0],d=b[1];return a.properties()[c.value]===d.value}],"filter-id-==":[Ce,[Fe],function(a,b){var c=b[0];return a.id()===c.value}],"filter-type-==":[Ce,[Be],function(a,b){var c=b[0];return a.geometryType()===c.value}],"filter-<":[Ce,[Be,Fe],function(a,b){var c=b[0],d=b[1],e=a.properties()[c.value],f=d.value;return typeof e==typeof f&&e<f}],"filter-id-<":[Ce,[Fe],function(a,b){var c=b[0],d=a.id(),e=c.value;return typeof d==typeof e&&d<e}],"filter->":[Ce,[Be,Fe],function(a,b){var c=b[0],d=b[1],e=a.properties()[c.value],f=d.value;return typeof e==typeof f&&e>f}],"filter-id->":[Ce,[Fe],function(a,b){var c=b[0],d=a.id(),e=c.value;return typeof d==typeof e&&d>e}],"filter-<=":[Ce,[Be,Fe],function(a,b){var c=b[0],d=b[1],e=a.properties()[c.value],f=d.value;return typeof e==typeof f&&e<=f}],"filter-id-<=":[Ce,[Fe],function(a,b){var c=b[0],d=a.id(),e=c.value;return typeof d==typeof e&&d<=e}],"filter->=":[Ce,[Be,Fe],function(a,b){var c=b[0],d=b[1],e=a.properties()[c.value],f=d.value;return typeof e==typeof f&&e>=f}],"filter-id->=":[Ce,[Fe],function(a,b){var c=b[0],d=a.id(),e=c.value;return typeof d==typeof e&&d>=e}],"filter-has":[Ce,[Fe],function(a,b){return b[0].value in a.properties()}],"filter-has-id":[Ce,[],function(a){return null!==a.id()}],"filter-type-in":[Ce,[M(Be)],function(a,b){return b[0].value.indexOf(a.geometryType())>=0}],"filter-id-in":[Ce,[M(Fe)],function(a,b){return b[0].value.indexOf(a.id())>=0}],"filter-in-small":[Ce,[Be,M(Fe)],function(a,b){var c=b[0];return b[1].value.indexOf(a.properties()[c.value])>=0}],"filter-in-large":[Ce,[Be,M(Fe)],function(a,b){var c=b[0],d=b[1];return function(a,b,c,d){for(;c<=d;){var e=c+d>>1;if(b[e]===a)return!0;b[e]>a?d=e-1:c=e+1}return!1}(a.properties()[c.value],d.value,0,d.value.length-1)}],all:{type:Ce,overloads:[[[Ce,Ce],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)&&d.evaluate(a)}],[ia(Ce),function(a,b){for(var c=0,d=b;c<d.length;c+=1)if(!d[c].evaluate(a))return!1;return!0}]]},any:{type:Ce,overloads:[[[Ce,Ce],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)||d.evaluate(a)}],[ia(Ce),function(a,b){for(var c=0,d=b;c<d.length;c+=1)if(d[c].evaluate(a))return!0;return!1}]]},"!":[Ce,[Ce],function(a,b){return!b[0].evaluate(a)}],"is-supported-script":[Ce,[Be],function(a,b){var c=b[0],d=a.globals&&a.globals.isSupportedScript;return!d||d(c.evaluate(a))}],upcase:[Be,[Be],function(a,b){return b[0].evaluate(a).toUpperCase()}],downcase:[Be,[Be],function(a,b){return b[0].evaluate(a).toLowerCase()}],concat:[Be,ia(Fe),function(a,b){return b.map(function(b){return R(b.evaluate(a))}).join("")}],"resolved-locale":[Be,[Ge],function(a,b){return b[0].evaluate(a).resolvedLocale()}]});var Df=function(a,b){this.expression=a,this._warningHistory={},this._evaluator=new We,this._defaultValue=b?function(a){return"color"===a.type&&pa(a.default)?new Ke(0,0,0,0):"color"===a.type?Ke.parse(a.default)||null:void 0===a.default?null:a.default}(b):null,this._enumValues=b&&"enum"===b.type?b.values:null};Df.prototype.evaluateWithoutErrorHandling=function(a,b,c,d){return this._evaluator.globals=a,this._evaluator.feature=b,this._evaluator.featureState=c,this._evaluator.formattedSection=d,this.expression.evaluate(this._evaluator)},Df.prototype.evaluate=function(a,b,c,d){this._evaluator.globals=a,this._evaluator.feature=b||null,this._evaluator.featureState=c||null,this._evaluator.formattedSection=d||null;try{var e=this.expression.evaluate(this._evaluator);if(null==e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new Pe("Expected value to be one of "+Object.keys(this._enumValues).map(function(a){return JSON.stringify(a)}).join(", ")+", but found "+JSON.stringify(e)+" instead.");return e}catch(a){return this._warningHistory[a.message]||(this._warningHistory[a.message]=!0,"undefined"!=typeof console&&console.warn(a.message)),this._defaultValue}};var Ef=function(a,b){this.kind=a,this._styleExpression=b,this.isStateDependent="constant"!==a&&!T(b.expression)};Ef.prototype.evaluateWithoutErrorHandling=function(a,b,c,d){return this._styleExpression.evaluateWithoutErrorHandling(a,b,c,d)},Ef.prototype.evaluate=function(a,b,c,d){return this._styleExpression.evaluate(a,b,c,d)};var Ff=function(a,b,c,d){this.kind=a,this.zoomStops=c,this._styleExpression=b,this.isStateDependent="camera"!==a&&!T(b.expression),this.interpolationType=d};Ff.prototype.evaluateWithoutErrorHandling=function(a,b,c,d){return this._styleExpression.evaluateWithoutErrorHandling(a,b,c,d)},Ff.prototype.evaluate=function(a,b,c,d){return this._styleExpression.evaluate(a,b,c,d)},Ff.prototype.interpolationFactor=function(a,b,c){return this.interpolationType?of.interpolationFactor(this.interpolationType,a,b,c):0};var Gf=function(a,b){this._parameters=a,this._specification=b,I(this,function a(b,c){var d,e,f,g="color"===c.type,h=b.stops&&"object"==typeof b.stops[0][0],i=h||void 0!==b.property,j=h||!i,k=b.type||(na(c)?"exponential":"interval");if(g&&((b=I({},b)).stops&&(b.stops=b.stops.map(function(a){return[a[0],Ke.parse(a[1])]})),b.default?b.default=Ke.parse(b.default):b.default=Ke.parse(c.default)),b.colorSpace&&"rgb"!==b.colorSpace&&!nf[b.colorSpace])throw new Error("Unknown color space: "+b.colorSpace);if("exponential"===k)d=ua;else if("interval"===k)d=ta;else if("categorical"===k){d=sa,e=Object.create(null);for(var l=0,m=b.stops;l<m.length;l+=1){var n=m[l];e[n[0]]=n[1]}f=typeof b.stops[0][0]}else{if("identity"!==k)throw new Error('Unknown function type "'+k+'"');d=va}if(h){for(var o={},p=[],q=0;q<b.stops.length;q++){var r=b.stops[q],s=r[0].zoom;void 0===o[s]&&(o[s]={zoom:s,type:b.type,property:b.property,default:b.default,stops:[]},p.push(s)),o[s].stops.push([r[0].value,r[1]])}for(var t=[],u=0,v=p;u<v.length;u+=1){var w=v[u];t.push([o[w].zoom,a(o[w],c)])}var x={name:"linear"};return{kind:"composite",interpolationType:x,interpolationFactor:of.interpolationFactor.bind(void 0,x),zoomStops:t.map(function(a){return a[0]}),evaluate:function(a,d){var e=a.zoom;return ua({stops:t,base:b.base},c,e).evaluate(e,d)}}}if(j){var y="exponential"===k?{name:"exponential",base:void 0!==b.base?b.base:1}:null;return{kind:"camera",interpolationType:y,interpolationFactor:of.interpolationFactor.bind(void 0,y),zoomStops:b.stops.map(function(a){return a[0]}),evaluate:function(a){var g=a.zoom;return d(b,c,g,e,f)}}}return{kind:"source",evaluate:function(a,g){var h=g&&g.properties?g.properties[b.property]:void 0;return void 0===h?ra(b.default,c.default):d(b,c,h,e,f)}}}(this._parameters,this._specification))};Gf.deserialize=function(a){return new Gf(a._parameters,a._specification)},Gf.serialize=function(a){return{_parameters:a._parameters,_specification:a._specification}};var Hf={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},If={"*":function(){return[]},array:Aa,boolean:function(a){var b=a.value,c=a.key,d=oa(b);return"boolean"!==d?[new we(c,b,"boolean expected, "+d+" found")]:[]},number:Ba,color:function(a){var b=a.key,c=a.value,d=oa(c);return"string"!==d?[new we(b,c,"color expected, "+d+" found")]:null===Je(c)?[new we(b,c,'color expected, "'+c+'" found')]:[]},constants:H,enum:Ea,filter:Na,function:Ca,layer:Ra,object:za,source:Sa,light:Ta,string:Ua,formatted:function(a){return 0===Ua(a).length?[]:Da(a)}};Xa.source=Za(Sa),Xa.light=Za(Ta),Xa.layer=Za(Ra),Xa.filter=Za(Na),Xa.paintProperty=Za(Pa),Xa.layoutProperty=Za(Qa);var Jf=Xa,Kf=Jf.light,Lf=Jf.paintProperty,Mf=Jf.layoutProperty,Nf=_a,Of=3;_a.prototype.insert=function(a,b,c,d,e){this._forEachCell(b,c,d,e,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(b),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(e)},_a.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},_a.prototype._insertCell=function(a,b,c,d,e,f){this.cells[e].push(f)},_a.prototype.query=function(a,b,c,d,e){var f=this.min,g=this.max;if(a<=f&&b<=f&&g<=c&&g<=d&&!e)return Array.prototype.slice.call(this.keys);var h=[];return this._forEachCell(a,b,c,d,this._queryCell,h,{},e),h},_a.prototype._queryCell=function(a,b,c,d,e,f,g,h){var i=this.cells[e];if(null!==i)for(var j=this.keys,k=this.bboxes,l=0;l<i.length;l++){var m=i[l];if(void 0===g[m]){var n=4*m;(h?h(k[n+0],k[n+1],k[n+2],k[n+3]):a<=k[n+2]&&b<=k[n+3]&&c>=k[n+0]&&d>=k[n+1])?(g[m]=!0,f.push(j[m])):g[m]=!1}}},_a.prototype._forEachCell=function(a,b,c,d,e,f,g,h){for(var i=this._convertToCellCoord(a),j=this._convertToCellCoord(b),k=this._convertToCellCoord(c),l=this._convertToCellCoord(d),m=i;m<=k;m++)for(var n=j;n<=l;n++){var o=this.d*n+m;if((!h||h(this._convertFromCellCoord(m),this._convertFromCellCoord(n),this._convertFromCellCoord(m+1),this._convertFromCellCoord(n+1)))&&e.call(this,a,b,c,d,o,f,g,h))return}},_a.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},_a.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},_a.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,b=Of+this.cells.length+1+1,c=0,d=0;d<this.cells.length;d++)c+=this.cells[d].length;var e=new Int32Array(b+c+this.keys.length+this.bboxes.length);e[0]=this.extent,e[1]=this.n,e[2]=this.padding;for(var f=b,g=0;g<a.length;g++){var h=a[g];e[Of+g]=f,e.set(h,f),f+=h.length}return e[Of+a.length]=f,e.set(this.keys,f),f+=this.keys.length,e[Of+a.length+1]=f,e.set(this.bboxes,f),f+=this.bboxes.length,e.buffer};var Pf=self.ImageData,Qf={};for(var Rf in ab("Object",Object),Nf.serialize=function(a,b){var c=a.toArrayBuffer();return b&&b.push(c),{buffer:c}},Nf.deserialize=function(a){return new Nf(a.buffer)},ab("Grid",Nf),ab("Color",Ke),ab("Error",Error),ab("StylePropertyFunction",Gf),ab("StyleExpression",Df,{omit:["_evaluator"]}),ab("ZoomDependentExpression",Ff),ab("ZoomConstantExpression",Ef),ab("CompoundExpression",Xe,{omit:["_evaluate"]}),Cf)Cf[Rf]._classRegistryKey||ab("Expression_"+Rf,Cf[Rf]);var Sf=function(){this.first=!0};Sf.prototype.update=function(a,b){var c=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=b):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=b),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=c,!0))};var Tf,Uf={"Latin-1 Supplement":function(a){return a>=128&&a<=255},Arabic:function(a){return a>=1536&&a<=1791},"Arabic Supplement":function(a){return a>=1872&&a<=1919},"Arabic Extended-A":function(a){return a>=2208&&a<=2303},"Hangul Jamo":function(a){return a>=4352&&a<=4607},"Unified Canadian Aboriginal Syllabics":function(a){return a>=5120&&a<=5759},Khmer:function(a){return a>=6016&&a<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(a){return a>=6320&&a<=6399},"General Punctuation":function(a){return a>=8192&&a<=8303},"Letterlike Symbols":function(a){return a>=8448&&a<=8527},"Number Forms":function(a){return a>=8528&&a<=8591},"Miscellaneous Technical":function(a){return a>=8960&&a<=9215},"Control Pictures":function(a){return a>=9216&&a<=9279},"Optical Character Recognition":function(a){return a>=9280&&a<=9311},"Enclosed Alphanumerics":function(a){return a>=9312&&a<=9471},"Geometric Shapes":function(a){return a>=9632&&a<=9727},"Miscellaneous Symbols":function(a){return a>=9728&&a<=9983},"Miscellaneous Symbols and Arrows":function(a){return a>=11008&&a<=11263},"CJK Radicals Supplement":function(a){return a>=11904&&a<=12031},"Kangxi Radicals":function(a){return a>=12032&&a<=12255},"Ideographic Description Characters":function(a){return a>=12272&&a<=12287},"CJK Symbols and Punctuation":function(a){return a>=12288&&a<=12351},Hiragana:function(a){return a>=12352&&a<=12447},Katakana:function(a){return a>=12448&&a<=12543},Bopomofo:function(a){return a>=12544&&a<=12591},"Hangul Compatibility Jamo":function(a){return a>=12592&&a<=12687},Kanbun:function(a){return a>=12688&&a<=12703},"Bopomofo Extended":function(a){return a>=12704&&a<=12735},"CJK Strokes":function(a){return a>=12736&&a<=12783},"Katakana Phonetic Extensions":function(a){return a>=12784&&a<=12799},"Enclosed CJK Letters and Months":function(a){return a>=12800&&a<=13055},"CJK Compatibility":function(a){return a>=13056&&a<=13311},"CJK Unified Ideographs Extension A":function(a){return a>=13312&&a<=19903},"Yijing Hexagram Symbols":function(a){return a>=19904&&a<=19967},"CJK Unified Ideographs":function(a){return a>=19968&&a<=40959},"Yi Syllables":function(a){return a>=40960&&a<=42127},"Yi Radicals":function(a){return a>=42128&&a<=42191},"Hangul Jamo Extended-A":function(a){return a>=43360&&a<=43391},"Hangul Syllables":function(a){return a>=44032&&a<=55215},"Hangul Jamo Extended-B":function(a){return a>=55216&&a<=55295},"Private Use Area":function(a){return a>=57344&&a<=63743},"CJK Compatibility Ideographs":function(a){return a>=63744&&a<=64255},"Arabic Presentation Forms-A":function(a){return a>=64336&&a<=65023},"Vertical Forms":function(a){return a>=65040&&a<=65055},"CJK Compatibility Forms":function(a){return a>=65072&&a<=65103},"Small Form Variants":function(a){return a>=65104&&a<=65135},"Arabic Presentation Forms-B":function(a){return a>=65136&&a<=65279},"Halfwidth and Fullwidth Forms":function(a){return a>=65280&&a<=65519}},Vf=!1,Wf=null,Xf=!1,Yf=new ue,Zf={applyArabicShaping:null,
processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Xf||null!=Zf.applyArabicShaping}},$f=function(a,b){this.zoom=a,b?(this.now=b.now,this.fadeDuration=b.fadeDuration,this.zoomHistory=b.zoomHistory,this.transition=b.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Sf,this.transition={})};$f.prototype.isSupportedScript=function(a){return function(a,b){for(var c=0,d=a;c<d.length;c+=1)if(!hb(d[c].charCodeAt(0),b))return!1;return!0}(a,Zf.isLoaded())},$f.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},$f.prototype.getCrossfadeParameters=function(){var a=this.zoom,b=a-Math.floor(a),c=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:b+(1-b)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*b}};var _f=function(a,b){this.property=a,this.value=b,this.expression=function(a,b){if(pa(a))return new Gf(a,b);if(wa(a)){var c=ya(a,b);if("error"===c.result)throw new Error(c.value.map(function(a){return a.key+": "+a.message}).join(", "));return c.value}var d=a;return"string"==typeof a&&"color"===b.type&&(d=Ke.parse(a)),{kind:"constant",evaluate:function(){return d}}}(void 0===b?a.specification.default:b,a.specification)};_f.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},_f.prototype.possiblyEvaluate=function(a){return this.property.possiblyEvaluate(this,a)};var ag=function(a){this.property=a,this.value=new _f(a,void 0)};ag.prototype.transitioned=function(a,b){return new cg(this.property,this.value,b,i({},a.transition,this.transition),a.now)},ag.prototype.untransitioned=function(){return new cg(this.property,this.value,null,{},0)};var bg=function(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)};bg.prototype.getValue=function(a){return q(this._values[a].value.value)},bg.prototype.setValue=function(a,b){this._values.hasOwnProperty(a)||(this._values[a]=new ag(this._values[a].property)),this._values[a].value=new _f(this._values[a].property,null===b?void 0:q(b))},bg.prototype.getTransition=function(a){return q(this._values[a].transition)},bg.prototype.setTransition=function(a,b){this._values.hasOwnProperty(a)||(this._values[a]=new ag(this._values[a].property)),this._values[a].transition=q(b)||void 0},bg.prototype.serialize=function(){for(var a={},b=0,c=Object.keys(this._values);b<c.length;b+=1){var d=c[b],e=this.getValue(d);void 0!==e&&(a[d]=e);var f=this.getTransition(d);void 0!==f&&(a[d+"-transition"]=f)}return a},bg.prototype.transitioned=function(a,b){for(var c=new dg(this._properties),d=0,e=Object.keys(this._values);d<e.length;d+=1){var f=e[d];c._values[f]=this._values[f].transitioned(a,b._values[f])}return c},bg.prototype.untransitioned=function(){for(var a=new dg(this._properties),b=0,c=Object.keys(this._values);b<c.length;b+=1){var d=c[b];a._values[d]=this._values[d].untransitioned()}return a};var cg=function(a,b,c,d,e){this.property=a,this.value=b,this.begin=e+d.delay||0,this.end=this.begin+d.duration||0,a.specification.transition&&(d.delay||d.duration)&&(this.prior=c)};cg.prototype.possiblyEvaluate=function(a){var b=a.now||0,c=this.value.possiblyEvaluate(a),d=this.prior;if(d){if(b>this.end)return this.prior=null,c;if(this.value.isDataDriven())return this.prior=null,c;if(b<this.begin)return d.possiblyEvaluate(a);var e=(b-this.begin)/(this.end-this.begin);return this.property.interpolate(d.possiblyEvaluate(a),c,function(a){if(e<=0)return 0;if(e>=1)return 1;var b=e*e,c=b*e;return 4*(e<.5?c:3*(e-b)+c-.75)}())}return c};var dg=function(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)};dg.prototype.possiblyEvaluate=function(a){for(var b=new gg(this._properties),c=0,d=Object.keys(this._values);c<d.length;c+=1){var e=d[c];b._values[e]=this._values[e].possiblyEvaluate(a)}return b},dg.prototype.hasTransition=function(){for(var a=0,b=Object.keys(this._values);a<b.length;a+=1){var c=b[a];if(this._values[c].prior)return!0}return!1};var eg=function(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)};eg.prototype.getValue=function(a){return q(this._values[a].value)},eg.prototype.setValue=function(a,b){this._values[a]=new _f(this._values[a].property,null===b?void 0:q(b))},eg.prototype.serialize=function(){for(var a={},b=0,c=Object.keys(this._values);b<c.length;b+=1){var d=c[b],e=this.getValue(d);void 0!==e&&(a[d]=e)}return a},eg.prototype.possiblyEvaluate=function(a){for(var b=new gg(this._properties),c=0,d=Object.keys(this._values);c<d.length;c+=1){var e=d[c];b._values[e]=this._values[e].possiblyEvaluate(a)}return b};var fg=function(a,b,c){this.property=a,this.value=b,this.parameters=c};fg.prototype.isConstant=function(){return"constant"===this.value.kind},fg.prototype.constantOr=function(a){return"constant"===this.value.kind?this.value.value:a},fg.prototype.evaluate=function(a,b){return this.property.evaluate(this.value,this.parameters,a,b)};var gg=function(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)};gg.prototype.get=function(a){return this._values[a]};var hg=function(a){this.specification=a};hg.prototype.possiblyEvaluate=function(a,b){return a.expression.evaluate(b)},hg.prototype.interpolate=function(a,b,c){var d=af[this.specification.type];return d?d(a,b,c):a};var ig=function(a,b){this.specification=a,this.overrides=b};ig.prototype.possiblyEvaluate=function(a,b){return"constant"===a.expression.kind||"camera"===a.expression.kind?new fg(this,{kind:"constant",value:a.expression.evaluate(b)},b):new fg(this,a.expression,b)},ig.prototype.interpolate=function(a,b,c){if("constant"!==a.value.kind||"constant"!==b.value.kind)return a;if(void 0===a.value.value||void 0===b.value.value)return new fg(this,{kind:"constant",value:void 0},a.parameters);var d=af[this.specification.type];return d?new fg(this,{kind:"constant",value:d(a.value.value,b.value.value,c)},a.parameters):a},ig.prototype.evaluate=function(a,b,c,d){return"constant"===a.kind?a.value:a.evaluate(b,c,d)};var jg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.possiblyEvaluate=function(a,b){if(void 0===a.value)return new fg(this,{kind:"constant",value:void 0},b);if("constant"===a.expression.kind){var c=a.expression.evaluate(b),d=this._calculate(c,c,c,b);return new fg(this,{kind:"constant",value:d},b)}if("camera"===a.expression.kind){var e=this._calculate(a.expression.evaluate({zoom:b.zoom-1}),a.expression.evaluate({zoom:b.zoom}),a.expression.evaluate({zoom:b.zoom+1}),b);return new fg(this,{kind:"constant",value:e},b)}return new fg(this,a.expression,b)},b.prototype.evaluate=function(a,b,c,d){if("source"===a.kind){var e=a.evaluate(b,c,d);return this._calculate(e,e,e,b)}return"composite"===a.kind?this._calculate(a.evaluate({zoom:Math.floor(b.zoom)-1},c,d),a.evaluate({zoom:Math.floor(b.zoom)},c,d),a.evaluate({zoom:Math.floor(b.zoom)+1},c,d),b):a.value},b.prototype._calculate=function(a,b,c,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:a,to:b}:{from:c,to:b}},b.prototype.interpolate=function(a){return a},b}(ig),kg=function(a){this.specification=a};kg.prototype.possiblyEvaluate=function(a,b){if(void 0!==a.value){if("constant"===a.expression.kind){var c=a.expression.evaluate(b);return this._calculate(c,c,c,b)}return this._calculate(a.expression.evaluate(new $f(Math.floor(b.zoom-1),b)),a.expression.evaluate(new $f(Math.floor(b.zoom),b)),a.expression.evaluate(new $f(Math.floor(b.zoom+1),b)),b)}},kg.prototype._calculate=function(a,b,c,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:a,to:b}:{from:c,to:b}},kg.prototype.interpolate=function(a){return a};var lg=function(a){this.specification=a};lg.prototype.possiblyEvaluate=function(a,b){return!!a.expression.evaluate(b)},lg.prototype.interpolate=function(){return!1};var mg=function(a){for(var b in this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],a){var c=a[b];c.specification.overridable&&this.overridableProperties.push(b);var d=this.defaultPropertyValues[b]=new _f(c,void 0),e=this.defaultTransitionablePropertyValues[b]=new ag(c);this.defaultTransitioningPropertyValues[b]=e.untransitioned(),this.defaultPossiblyEvaluatedValues[b]=d.possiblyEvaluate({})}};ab("DataDrivenProperty",ig),ab("DataConstantProperty",hg),ab("CrossFadedDataDrivenProperty",jg),ab("CrossFadedProperty",kg),ab("ColorRampProperty",lg);var ng=function(a){function b(b,c){if(a.call(this),this.id=b.id,this.type=b.type,this._featureFilter=function(){return!0},"custom"!==b.type&&(b=b,this.metadata=b.metadata,this.minzoom=b.minzoom,this.maxzoom=b.maxzoom,"background"!==b.type&&(this.source=b.source,this.sourceLayer=b["source-layer"],this.filter=b.filter),c.layout&&(this._unevaluatedLayout=new eg(c.layout)),c.paint)){for(var d in this._transitionablePaint=new bg(c.paint),b.paint)this.setPaintProperty(d,b.paint[d],{validate:!1});for(var e in b.layout)this.setLayoutProperty(e,b.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},b.prototype.getLayoutProperty=function(a){return"visibility"===a?this.visibility:this._unevaluatedLayout.getValue(a)},b.prototype.setLayoutProperty=function(a,b,c){if(void 0===c&&(c={}),null!=b){var d="layers."+this.id+".layout."+a;if(this._validate(Mf,d,a,b,c))return}"visibility"!==a?this._unevaluatedLayout.setValue(a,b):this.visibility=b},b.prototype.getPaintProperty=function(a){return n(a,"-transition")?this._transitionablePaint.getTransition(a.slice(0,-"-transition".length)):this._transitionablePaint.getValue(a)},b.prototype.setPaintProperty=function(a,b,c){if(void 0===c&&(c={}),null!=b){var d="layers."+this.id+".paint."+a;if(this._validate(Lf,d,a,b,c))return!1}if(n(a,"-transition"))return this._transitionablePaint.setTransition(a.slice(0,-"-transition".length),b||void 0),!1;var e=this._transitionablePaint._values[a],f="cross-faded-data-driven"===e.property.specification["property-type"],g=e.value.isDataDriven(),h=e.value;this._transitionablePaint.setValue(a,b),this._handleSpecialPaintPropertyUpdate(a);var i=this._transitionablePaint._values[a].value;return i.isDataDriven()||g||f||this._handleOverridablePaintPropertyUpdate(a,h,i)},b.prototype._handleSpecialPaintPropertyUpdate=function(a){},b.prototype._handleOverridablePaintPropertyUpdate=function(a,b,c){return!1},b.prototype.isHidden=function(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||"none"===this.visibility},b.prototype.updateTransitions=function(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)},b.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},b.prototype.recalculate=function(a){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a)),this.paint=this._transitioningPaint.possiblyEvaluate(a)},b.prototype.serialize=function(){var a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),p(a,function(a,b){return!(void 0===a||"layout"===b&&!Object.keys(a).length||"paint"===b&&!Object.keys(a).length)})},b.prototype._validate=function(a,b,c,d,e){return void 0===e&&(e={}),(!e||!1!==e.validate)&&$a(this,a.call(Jf,{key:b,layerType:this.type,objectKey:c,value:d,styleSpec:ve,style:{glyphs:!0,sprite:!0}}))},b.prototype.is3D=function(){return!1},b.prototype.isTileClipped=function(){return!1},b.prototype.hasOffscreenPass=function(){return!1},b.prototype.resize=function(){},b.prototype.isStateDependent=function(){for(var a in this.paint._values){var b=this.paint.get(a);if(b instanceof fg&&la(b.property.specification)&&("source"===b.value.kind||"composite"===b.value.kind)&&b.value.isStateDependent)return!0}return!1},b}(ue),og={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},pg=function(a,b){this._structArray=a,this._pos1=b*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},qg=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};qg.serialize=function(a,b){return a._trim(),b&&(a.isTransferred=!0,b.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}},qg.deserialize=function(a){var b=Object.create(this.prototype);return b.arrayBuffer=a.arrayBuffer,b.length=a.length,b.capacity=a.arrayBuffer.byteLength/b.bytesPerElement,b._refreshViews(),b},qg.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},qg.prototype.clear=function(){this.length=0},qg.prototype.resize=function(a){this.reserve(a),this.length=a},qg.prototype.reserve=function(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var b=this.uint8;this._refreshViews(),b&&this.uint8.set(b)}},qg.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var rg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b){var c=this.length;return this.resize(c+1),this.emplace(c,a,b)},b.prototype.emplace=function(a,b,c){var d=2*a;return this.int16[d+0]=b,this.int16[d+1]=c,a},b}(qg);rg.prototype.bytesPerElement=4,ab("StructArrayLayout2i4",rg);var sg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d){var e=this.length;return this.resize(e+1),this.emplace(e,a,b,c,d)},b.prototype.emplace=function(a,b,c,d,e){var f=4*a;return this.int16[f+0]=b,this.int16[f+1]=c,this.int16[f+2]=d,this.int16[f+3]=e,a},b}(qg);sg.prototype.bytesPerElement=8,ab("StructArrayLayout4i8",sg);var tg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f){var g=this.length;return this.resize(g+1),this.emplace(g,a,b,c,d,e,f)},b.prototype.emplace=function(a,b,c,d,e,f,g){var h=6*a;return this.int16[h+0]=b,this.int16[h+1]=c,this.int16[h+2]=d,this.int16[h+3]=e,this.int16[h+4]=f,this.int16[h+5]=g,a},b}(qg);tg.prototype.bytesPerElement=12,ab("StructArrayLayout2i4i12",tg);var ug=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f){var g=this.length;return this.resize(g+1),this.emplace(g,a,b,c,d,e,f)},b.prototype.emplace=function(a,b,c,d,e,f,g){var h=4*a,i=8*a;return this.int16[h+0]=b,this.int16[h+1]=c,this.uint8[i+4]=d,this.uint8[i+5]=e,this.uint8[i+6]=f,this.uint8[i+7]=g,a},b}(qg);ug.prototype.bytesPerElement=8,ab("StructArrayLayout2i4ub8",ug);var vg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h){var i=this.length;return this.resize(i+1),this.emplace(i,a,b,c,d,e,f,g,h)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,i){var j=8*a;return this.uint16[j+0]=b,this.uint16[j+1]=c,this.uint16[j+2]=d,this.uint16[j+3]=e,this.uint16[j+4]=f,this.uint16[j+5]=g,this.uint16[j+6]=h,this.uint16[j+7]=i,a},b}(qg);vg.prototype.bytesPerElement=16,ab("StructArrayLayout8ui16",vg);var wg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h){var i=this.length;return this.resize(i+1),this.emplace(i,a,b,c,d,e,f,g,h)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,i){var j=8*a;return this.int16[j+0]=b,this.int16[j+1]=c,this.int16[j+2]=d,this.int16[j+3]=e,this.uint16[j+4]=f,this.uint16[j+5]=g,this.uint16[j+6]=h,this.uint16[j+7]=i,a},b}(qg);wg.prototype.bytesPerElement=16,ab("StructArrayLayout4i4ui16",wg);var xg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=3*a;return this.float32[e+0]=b,this.float32[e+1]=c,this.float32[e+2]=d,a},b}(qg);xg.prototype.bytesPerElement=12,ab("StructArrayLayout3f12",xg);var yg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a){var b=this.length;return this.resize(b+1),this.emplace(b,a)},b.prototype.emplace=function(a,b){var c=1*a;return this.uint32[c+0]=b,a},b}(qg);yg.prototype.bytesPerElement=4,ab("StructArrayLayout1ul4",yg);var zg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h,i,j,k){var l=this.length;return this.resize(l+1),this.emplace(l,a,b,c,d,e,f,g,h,i,j,k)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=12*a,n=6*a;return this.int16[m+0]=b,this.int16[m+1]=c,this.int16[m+2]=d,this.int16[m+3]=e,this.int16[m+4]=f,this.int16[m+5]=g,this.uint32[n+3]=h,this.uint16[m+8]=i,this.uint16[m+9]=j,this.int16[m+10]=k,this.int16[m+11]=l,a},b}(qg);zg.prototype.bytesPerElement=24,ab("StructArrayLayout6i1ul2ui2i24",zg);var Ag=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f){var g=this.length;return this.resize(g+1),this.emplace(g,a,b,c,d,e,f)},b.prototype.emplace=function(a,b,c,d,e,f,g){var h=6*a;return this.int16[h+0]=b,this.int16[h+1]=c,this.int16[h+2]=d,this.int16[h+3]=e,this.int16[h+4]=f,this.int16[h+5]=g,a},b}(qg);Ag.prototype.bytesPerElement=12,ab("StructArrayLayout2i2i2i12",Ag);var Bg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d){var e=this.length;return this.resize(e+1),this.emplace(e,a,b,c,d)},b.prototype.emplace=function(a,b,c,d,e){var f=12*a,g=3*a;return this.uint8[f+0]=b,this.uint8[f+1]=c,this.float32[g+1]=d,this.float32[g+2]=e,a},b}(qg);Bg.prototype.bytesPerElement=12,ab("StructArrayLayout2ub2f12",Bg);var Cg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.length;return this.resize(q+1),this.emplace(q,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=22*a,s=11*a,t=44*a;return this.int16[r+0]=b,this.int16[r+1]=c,this.uint16[r+2]=d,this.uint16[r+3]=e,this.uint32[s+2]=f,this.uint32[s+3]=g,this.uint32[s+4]=h,this.uint16[r+10]=i,this.uint16[r+11]=j,this.uint16[r+12]=k,this.float32[s+7]=l,this.float32[s+8]=m,this.uint8[t+36]=n,this.uint8[t+37]=o,this.uint8[t+38]=p,this.uint32[s+10]=q,a},b}(qg);Cg.prototype.bytesPerElement=44,ab("StructArrayLayout2i2ui3ul3ui2f3ub1ul44",Cg);var Dg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=this.length;return this.resize(u+1),this.emplace(u,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=24*a,w=12*a;return this.int16[v+0]=b,this.int16[v+1]=c,this.int16[v+2]=d,this.int16[v+3]=e,this.int16[v+4]=f,this.int16[v+5]=g,this.uint16[v+6]=h,this.uint16[v+7]=i,this.uint16[v+8]=j,this.uint16[v+9]=k,this.uint16[v+10]=l,this.uint16[v+11]=m,this.uint16[v+12]=n,this.uint16[v+13]=o,this.uint16[v+14]=p,this.uint16[v+15]=q,this.uint16[v+16]=r,this.uint32[w+9]=s,this.float32[w+10]=t,this.float32[w+11]=u,a},b}(qg);Dg.prototype.bytesPerElement=48,ab("StructArrayLayout6i11ui1ul2f48",Dg);var Eg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a){var b=this.length;return this.resize(b+1),this.emplace(b,a)},b.prototype.emplace=function(a,b){var c=1*a;return this.float32[c+0]=b,a},b}(qg);Eg.prototype.bytesPerElement=4,ab("StructArrayLayout1f4",Eg);var Fg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=3*a;return this.int16[e+0]=b,this.int16[e+1]=c,this.int16[e+2]=d,a},b}(qg);Fg.prototype.bytesPerElement=6,ab("StructArrayLayout3i6",Fg);var Gg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=2*a,f=4*a;return this.uint32[e+0]=b,this.uint16[f+2]=c,this.uint16[f+3]=d,a},b}(qg);Gg.prototype.bytesPerElement=8,ab("StructArrayLayout1ul2ui8",Gg);var Hg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=3*a;return this.uint16[e+0]=b,this.uint16[e+1]=c,this.uint16[e+2]=d,a},b}(qg);Hg.prototype.bytesPerElement=6,ab("StructArrayLayout3ui6",Hg);var Ig=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b){var c=this.length;return this.resize(c+1),this.emplace(c,a,b)},b.prototype.emplace=function(a,b,c){var d=2*a;return this.uint16[d+0]=b,this.uint16[d+1]=c,a},b}(qg);Ig.prototype.bytesPerElement=4,ab("StructArrayLayout2ui4",Ig);var Jg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a){var b=this.length;return this.resize(b+1),this.emplace(b,a)},b.prototype.emplace=function(a,b){var c=1*a;return this.uint16[c+0]=b,a},b}(qg);Jg.prototype.bytesPerElement=2,ab("StructArrayLayout1ui2",Jg);var Kg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b){var c=this.length;return this.resize(c+1),this.emplace(c,a,b)},b.prototype.emplace=function(a,b,c){var d=2*a;return this.float32[d+0]=b,this.float32[d+1]=c,a},b}(qg);Kg.prototype.bytesPerElement=8,ab("StructArrayLayout2f8",Kg);var Lg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d){var e=this.length;return this.resize(e+1),this.emplace(e,a,b,c,d)},b.prototype.emplace=function(a,b,c,d,e){var f=4*a;return this.float32[f+0]=b,this.float32[f+1]=c,this.float32[f+2]=d,this.float32[f+3]=e,a},b}(qg);Lg.prototype.bytesPerElement=16,ab("StructArrayLayout4f16",Lg);var Mg=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return c.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorPointX.set=function(a){this._structArray.int16[this._pos2+0]=a},c.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},c.anchorPointY.set=function(a){this._structArray.int16[this._pos2+1]=a},c.x1.get=function(){return this._structArray.int16[this._pos2+2]},c.x1.set=function(a){this._structArray.int16[this._pos2+2]=a},c.y1.get=function(){return this._structArray.int16[this._pos2+3]},c.y1.set=function(a){this._structArray.int16[this._pos2+3]=a},c.x2.get=function(){return this._structArray.int16[this._pos2+4]},c.x2.set=function(a){this._structArray.int16[this._pos2+4]=a},c.y2.get=function(){return this._structArray.int16[this._pos2+5]},c.y2.set=function(a){this._structArray.int16[this._pos2+5]=a},c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.featureIndex.set=function(a){this._structArray.uint32[this._pos4+3]=a},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},c.sourceLayerIndex.set=function(a){this._structArray.uint16[this._pos2+8]=a},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.bucketIndex.set=function(a){this._structArray.uint16[this._pos2+9]=a},c.radius.get=function(){return this._structArray.int16[this._pos2+10]},c.radius.set=function(a){this._structArray.int16[this._pos2+10]=a},c.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},c.signedDistanceFromAnchor.set=function(a){this._structArray.int16[this._pos2+11]=a},c.anchorPoint.get=function(){return new Gd(this.anchorPointX,this.anchorPointY)},Object.defineProperties(b.prototype,c),b}(pg);Mg.prototype.size=24;var Ng=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new Mg(this,a)},b}(zg);ab("CollisionBoxArray",Ng);var Og=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorX.set=function(a){this._structArray.int16[this._pos2+0]=a},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.anchorY.set=function(a){this._structArray.int16[this._pos2+1]=a},c.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.glyphStartIndex.set=function(a){this._structArray.uint16[this._pos2+2]=a},c.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},c.numGlyphs.set=function(a){this._structArray.uint16[this._pos2+3]=a},c.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},c.vertexStartIndex.set=function(a){this._structArray.uint32[this._pos4+2]=a},c.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.lineStartIndex.set=function(a){this._structArray.uint32[this._pos4+3]=a},c.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},c.lineLength.set=function(a){this._structArray.uint32[this._pos4+4]=a},c.segment.get=function(){return this._structArray.uint16[this._pos2+10]},c.segment.set=function(a){this._structArray.uint16[this._pos2+10]=a},c.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},c.lowerSize.set=function(a){
this._structArray.uint16[this._pos2+11]=a},c.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},c.upperSize.set=function(a){this._structArray.uint16[this._pos2+12]=a},c.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},c.lineOffsetX.set=function(a){this._structArray.float32[this._pos4+7]=a},c.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},c.lineOffsetY.set=function(a){this._structArray.float32[this._pos4+8]=a},c.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},c.writingMode.set=function(a){this._structArray.uint8[this._pos1+36]=a},c.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},c.placedOrientation.set=function(a){this._structArray.uint8[this._pos1+37]=a},c.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},c.hidden.set=function(a){this._structArray.uint8[this._pos1+38]=a},c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},c.crossTileID.set=function(a){this._structArray.uint32[this._pos4+10]=a},Object.defineProperties(b.prototype,c),b}(pg);Og.prototype.size=44;var Pg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new Og(this,a)},b}(Cg);ab("PlacedSymbolArray",Pg);var Qg=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},radialTextOffset:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorX.set=function(a){this._structArray.int16[this._pos2+0]=a},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.anchorY.set=function(a){this._structArray.int16[this._pos2+1]=a},c.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},c.rightJustifiedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+2]=a},c.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},c.centerJustifiedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+3]=a},c.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},c.leftJustifiedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+4]=a},c.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},c.verticalPlacedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+5]=a},c.key.get=function(){return this._structArray.uint16[this._pos2+6]},c.key.set=function(a){this._structArray.uint16[this._pos2+6]=a},c.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+7]},c.textBoxStartIndex.set=function(a){this._structArray.uint16[this._pos2+7]=a},c.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+8]},c.textBoxEndIndex.set=function(a){this._structArray.uint16[this._pos2+8]=a},c.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.verticalTextBoxStartIndex.set=function(a){this._structArray.uint16[this._pos2+9]=a},c.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},c.verticalTextBoxEndIndex.set=function(a){this._structArray.uint16[this._pos2+10]=a},c.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},c.iconBoxStartIndex.set=function(a){this._structArray.uint16[this._pos2+11]=a},c.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},c.iconBoxEndIndex.set=function(a){this._structArray.uint16[this._pos2+12]=a},c.featureIndex.get=function(){return this._structArray.uint16[this._pos2+13]},c.featureIndex.set=function(a){this._structArray.uint16[this._pos2+13]=a},c.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+14]},c.numHorizontalGlyphVertices.set=function(a){this._structArray.uint16[this._pos2+14]=a},c.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+15]},c.numVerticalGlyphVertices.set=function(a){this._structArray.uint16[this._pos2+15]=a},c.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+16]},c.numIconVertices.set=function(a){this._structArray.uint16[this._pos2+16]=a},c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+9]},c.crossTileID.set=function(a){this._structArray.uint32[this._pos4+9]=a},c.textBoxScale.get=function(){return this._structArray.float32[this._pos4+10]},c.textBoxScale.set=function(a){this._structArray.float32[this._pos4+10]=a},c.radialTextOffset.get=function(){return this._structArray.float32[this._pos4+11]},c.radialTextOffset.set=function(a){this._structArray.float32[this._pos4+11]=a},Object.defineProperties(b.prototype,c),b}(pg);Qg.prototype.size=48;var Rg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new Qg(this,a)},b}(Dg);ab("SymbolInstanceArray",Rg);var Sg=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={offsetX:{configurable:!0}};return c.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},c.offsetX.set=function(a){this._structArray.float32[this._pos4+0]=a},Object.defineProperties(b.prototype,c),b}(pg);Sg.prototype.size=4;var Tg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getoffsetX=function(a){return this.float32[1*a+0]},b.prototype.get=function(a){return new Sg(this,a)},b}(Eg);ab("GlyphOffsetArray",Tg);var Ug=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return c.x.get=function(){return this._structArray.int16[this._pos2+0]},c.x.set=function(a){this._structArray.int16[this._pos2+0]=a},c.y.get=function(){return this._structArray.int16[this._pos2+1]},c.y.set=function(a){this._structArray.int16[this._pos2+1]=a},c.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},c.tileUnitDistanceFromAnchor.set=function(a){this._structArray.int16[this._pos2+2]=a},Object.defineProperties(b.prototype,c),b}(pg);Ug.prototype.size=6;var Vg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getx=function(a){return this.int16[3*a+0]},b.prototype.gety=function(a){return this.int16[3*a+1]},b.prototype.gettileUnitDistanceFromAnchor=function(a){return this.int16[3*a+2]},b.prototype.get=function(a){return new Ug(this,a)},b}(Fg);ab("SymbolLineVertexArray",Vg);var Wg=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},c.featureIndex.set=function(a){this._structArray.uint32[this._pos4+0]=a},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.sourceLayerIndex.set=function(a){this._structArray.uint16[this._pos2+2]=a},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},c.bucketIndex.set=function(a){this._structArray.uint16[this._pos2+3]=a},Object.defineProperties(b.prototype,c),b}(pg);Wg.prototype.size=8;var Xg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new Wg(this,a)},b}(Gg);ab("FeatureIndexArray",Xg);var Yg=ib([{name:"a_pos",components:2,type:"Int16"}],4).members,Zg=function(a){void 0===a&&(a=[]),this.segments=a};Zg.prototype.prepareSegment=function(a,b,c,d){var e=this.segments[this.segments.length-1];return a>Zg.MAX_VERTEX_ARRAY_LENGTH&&r("Max vertices per segment is "+Zg.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+a),(!e||e.vertexLength+a>Zg.MAX_VERTEX_ARRAY_LENGTH||e.sortKey!==d)&&(e={vertexOffset:b.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},void 0!==d&&(e.sortKey=d),this.segments.push(e)),e},Zg.prototype.get=function(){return this.segments},Zg.prototype.destroy=function(){for(var a=0,b=this.segments;a<b.length;a+=1){var c=b[a];for(var d in c.vaos)c.vaos[d].destroy()}},Zg.simpleSegment=function(a,b,c,d){return new Zg([{vertexOffset:a,primitiveOffset:b,vertexLength:c,primitiveLength:d,vaos:{},sortKey:0}])},Zg.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ab("SegmentVector",Zg);var $g=function(){this.ids=[],this.positions=[],this.indexed=!1};$g.prototype.add=function(a,b,c,d){this.ids.push(a),this.positions.push(b,c,d)},$g.prototype.getPositions=function(a){for(var b=0,c=this.ids.length-1;b<c;){var d=b+c>>1;this.ids[d]>=a?c=d:b=d+1}for(var e=[];this.ids[b]===a;){var f=this.positions[3*b],g=this.positions[3*b+1],h=this.positions[3*b+2];e.push({index:f,start:g,end:h}),b++}return e},$g.serialize=function(a,b){var c=new Float64Array(a.ids),d=new Uint32Array(a.positions);return function a(b,c,d,e){if(!(d>=e)){for(var f=b[d+e>>1],g=d-1,h=e+1;;){do{g++}while(b[g]<f);do{h--}while(b[h]>f);if(g>=h)break;lb(b,g,h),lb(c,3*g,3*h),lb(c,3*g+1,3*h+1),lb(c,3*g+2,3*h+2)}a(b,c,d,h),a(b,c,h+1,e)}}(c,d,0,c.length-1),b.push(c.buffer,d.buffer),{ids:c,positions:d}},$g.deserialize=function(a){var b=new $g;return b.ids=a.ids,b.positions=a.positions,b.indexed=!0,b},ab("FeaturePositionMap",$g);var _g=function(a,b){this.gl=a.gl,this.location=b},ah=function(a){function b(b,c){a.call(this,b,c),this.current=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))},b}(_g),bh=function(a){function b(b,c){a.call(this,b,c),this.current=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))},b}(_g),ch=function(a){function b(b,c){a.call(this,b,c),this.current=[0,0]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))},b}(_g),dh=function(a){function b(b,c){a.call(this,b,c),this.current=[0,0,0]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))},b}(_g),eh=function(a){function b(b,c){a.call(this,b,c),this.current=[0,0,0,0]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))},b}(_g),fh=function(a){function b(b,c){a.call(this,b,c),this.current=Ke.transparent}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))},b}(_g),gh=new Float32Array(16),hh=function(a){function b(b,c){a.call(this,b,c),this.current=gh}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(var b=1;b<16;b++)if(a[b]!==this.current[b]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}},b}(_g),ih=function(a,b,c){this.value=a,this.names=b,this.uniformNames=this.names.map(function(a){return"u_"+a}),this.type=c,this.maxValue=-1/0};ih.prototype.defines=function(){return this.names.map(function(a){return"#define HAS_UNIFORM_u_"+a})},ih.prototype.setConstantPatternPositions=function(){},ih.prototype.populatePaintArray=function(){},ih.prototype.updatePaintArray=function(){},ih.prototype.upload=function(){},ih.prototype.destroy=function(){},ih.prototype.setUniforms=function(a,b,c,d){b.set(d.constantOr(this.value))},ih.prototype.getBinding=function(a,b){return"color"===this.type?new fh(a,b):new bh(a,b)},ih.serialize=function(a){var b=a.value,c=a.names,d=a.type;return{value:bb(b),names:c,type:d}},ih.deserialize=function(a){var b=a.value,c=a.names,d=a.type;return new ih(cb(b),c,d)};var jh=function(a,b,c){this.value=a,this.names=b,this.uniformNames=this.names.map(function(a){return"u_"+a}),this.type=c,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}};jh.prototype.defines=function(){return this.names.map(function(a){return"#define HAS_UNIFORM_u_"+a})},jh.prototype.populatePaintArray=function(){},jh.prototype.updatePaintArray=function(){},jh.prototype.upload=function(){},jh.prototype.destroy=function(){},jh.prototype.setConstantPatternPositions=function(a,b){this.patternPositions.patternTo=a.tlbr,this.patternPositions.patternFrom=b.tlbr},jh.prototype.setUniforms=function(a,b,c,d,e){var f=this.patternPositions;"u_pattern_to"===e&&f.patternTo&&b.set(f.patternTo),"u_pattern_from"===e&&f.patternFrom&&b.set(f.patternFrom)},jh.prototype.getBinding=function(a,b){return new eh(a,b)};var kh=function(a,b,c,d){this.expression=a,this.names=b,this.type=c,this.uniformNames=this.names.map(function(a){return"a_"+a}),this.maxValue=-1/0,this.paintVertexAttributes=b.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===c?2:1,offset:0}}),this.paintVertexArray=new d};kh.prototype.defines=function(){return[]},kh.prototype.setConstantPatternPositions=function(){},kh.prototype.populatePaintArray=function(a,b,c,d){var e=this.paintVertexArray,f=e.length;e.reserve(a);var g=this.expression.evaluate(new $f(0),b,{},d);if("color"===this.type)for(var h=mb(g),i=f;i<a;i++)e.emplaceBack(h[0],h[1]);else{for(var j=f;j<a;j++)e.emplaceBack(g);this.maxValue=Math.max(this.maxValue,g)}},kh.prototype.updatePaintArray=function(a,b,c,d){var e=this.paintVertexArray,f=this.expression.evaluate({zoom:0},c,d);if("color"===this.type)for(var g=mb(f),h=a;h<b;h++)e.emplace(h,g[0],g[1]);else{for(var i=a;i<b;i++)e.emplace(i,f);this.maxValue=Math.max(this.maxValue,f)}},kh.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},kh.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},kh.prototype.setUniforms=function(a,b){b.set(0)},kh.prototype.getBinding=function(a,b){return new bh(a,b)};var lh=function(a,b,c,d,e,f){this.expression=a,this.names=b,this.uniformNames=this.names.map(function(a){return"u_"+a+"_t"}),this.type=c,this.useIntegerZoom=d,this.zoom=e,this.maxValue=-1/0;var g=f;this.paintVertexAttributes=b.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===c?4:2,offset:0}}),this.paintVertexArray=new g};lh.prototype.defines=function(){return[]},lh.prototype.setConstantPatternPositions=function(){},lh.prototype.populatePaintArray=function(a,b,c,d){var e=this.paintVertexArray,f=e.length;e.reserve(a);var g=this.expression.evaluate(new $f(this.zoom),b,{},d),h=this.expression.evaluate(new $f(this.zoom+1),b,{},d);if("color"===this.type)for(var i=mb(g),j=mb(h),k=f;k<a;k++)e.emplaceBack(i[0],i[1],j[0],j[1]);else{for(var l=f;l<a;l++)e.emplaceBack(g,h);this.maxValue=Math.max(this.maxValue,g,h)}},lh.prototype.updatePaintArray=function(a,b,c,d){var e=this.paintVertexArray,f=this.expression.evaluate({zoom:this.zoom},c,d),g=this.expression.evaluate({zoom:this.zoom+1},c,d);if("color"===this.type)for(var h=mb(f),i=mb(g),j=a;j<b;j++)e.emplace(j,h[0],h[1],i[0],i[1]);else{for(var k=a;k<b;k++)e.emplace(k,f,g);this.maxValue=Math.max(this.maxValue,f,g)}},lh.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},lh.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},lh.prototype.interpolationFactor=function(a){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(a),this.zoom,this.zoom+1):this.expression.interpolationFactor(a,this.zoom,this.zoom+1)},lh.prototype.setUniforms=function(a,b,c){b.set(this.interpolationFactor(c.zoom))},lh.prototype.getBinding=function(a,b){return new bh(a,b)};var mh=function(a,b,c,d,e,f,g){this.expression=a,this.names=b,this.type=c,this.uniformNames=this.names.map(function(a){return"u_"+a+"_t"}),this.useIntegerZoom=d,this.zoom=e,this.maxValue=-1/0,this.layerId=g,this.paintVertexAttributes=b.map(function(a){return{name:"a_"+a,type:"Uint16",components:4,offset:0}}),this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f};mh.prototype.defines=function(){return[]},mh.prototype.setConstantPatternPositions=function(){},mh.prototype.populatePaintArray=function(a,b,c){var d=this.zoomInPaintVertexArray,e=this.zoomOutPaintVertexArray,f=this.layerId,g=d.length;if(d.reserve(a),e.reserve(a),c&&b.patterns&&b.patterns[f]){var h=b.patterns[f],i=h.min,j=h.mid,k=h.max,l=c[i],m=c[j],n=c[k];if(!l||!m||!n)return;for(var o=g;o<a;o++)d.emplaceBack(m.tl[0],m.tl[1],m.br[0],m.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1]),e.emplaceBack(m.tl[0],m.tl[1],m.br[0],m.br[1],n.tl[0],n.tl[1],n.br[0],n.br[1])}},mh.prototype.updatePaintArray=function(a,b,c,d,e){var f=this.zoomInPaintVertexArray,g=this.zoomOutPaintVertexArray,h=this.layerId;if(e&&c.patterns&&c.patterns[h]){var i=c.patterns[h],j=i.min,k=i.mid,l=i.max,m=e[j],n=e[k],o=e[l];if(!m||!n||!o)return;for(var p=a;p<b;p++)f.emplace(p,n.tl[0],n.tl[1],n.br[0],n.br[1],m.tl[0],m.tl[1],m.br[0],m.br[1]),g.emplace(p,n.tl[0],n.tl[1],n.br[0],n.br[1],o.tl[0],o.tl[1],o.br[0],o.br[1])}},mh.prototype.upload=function(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},mh.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},mh.prototype.setUniforms=function(a,b){b.set(0)},mh.prototype.getBinding=function(a,b){return new bh(a,b)};var nh=function(){this.binders={},this.cacheKey="",this._buffers=[],this._featureMap=new $g,this._bufferOffset=0};nh.createDynamic=function(a,b,c){var d=new nh,e=[];for(var f in a.paint._values)if(c(f)){var g=a.paint.get(f);if(g instanceof fg&&la(g.property.specification)){var h=nb(f,a.type),i=g.property.specification.type,j=g.property.useIntegerZoom;if("cross-faded"===g.property.specification["property-type"]||"cross-faded-data-driven"===g.property.specification["property-type"])if("constant"===g.value.kind)d.binders[f]=new jh(g.value.value,h,i),e.push("/u_"+f);else{var k=ob(f,i,"source");d.binders[f]=new mh(g.value,h,i,j,b,k,a.id),e.push("/a_"+f)}else if("constant"===g.value.kind)d.binders[f]=new ih(g.value.value,h,i),e.push("/u_"+f);else if("source"===g.value.kind){var l=ob(f,i,"source");d.binders[f]=new kh(g.value,h,i,l),e.push("/a_"+f)}else{var m=ob(f,i,"composite");d.binders[f]=new lh(g.value,h,i,j,b,m),e.push("/z_"+f)}}}return d.cacheKey=e.sort().join(""),d},nh.prototype.populatePaintArrays=function(a,b,c,d,e){for(var f in this.binders)this.binders[f].populatePaintArray(a,b,d,e);void 0!==b.id&&this._featureMap.add(+b.id,c,this._bufferOffset,a),this._bufferOffset=a},nh.prototype.setConstantPatternPositions=function(a,b){for(var c in this.binders)this.binders[c].setConstantPatternPositions(a,b)},nh.prototype.updatePaintArrays=function(a,b,c,d){var e=!1;for(var f in a)for(var g=0,h=this._featureMap.getPositions(+f);g<h.length;g+=1){var i=h[g],j=b.feature(i.index);for(var k in this.binders){var l=this.binders[k];if(!(l instanceof ih||l instanceof jh)&&!0===l.expression.isStateDependent){var m=c.paint.get(k);l.expression=m.value,l.updatePaintArray(i.start,i.end,j,a[f],d),e=!0}}}return e},nh.prototype.defines=function(){var a=[];for(var b in this.binders)a.push.apply(a,this.binders[b].defines());return a},nh.prototype.getPaintVertexBuffers=function(){return this._buffers},nh.prototype.getUniforms=function(a,b){var c=[];for(var d in this.binders)for(var e=this.binders[d],f=0,g=e.uniformNames;f<g.length;f+=1){var h=g[f];if(b[h]){var i=e.getBinding(a,b[h]);c.push({name:h,property:d,binding:i})}}return c},nh.prototype.setUniforms=function(a,b,c,d){for(var e=0,f=b;e<f.length;e+=1){var g=f[e],h=g.name,i=g.property,j=g.binding;this.binders[i].setUniforms(a,j,d,c.get(i),h)}},nh.prototype.updatePatternPaintBuffers=function(a){var b=[];for(var c in this.binders){var d=this.binders[c];if(d instanceof mh){var e=2===a.fromScale?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;e&&b.push(e)}else(d instanceof kh||d instanceof lh)&&d.paintVertexBuffer&&b.push(d.paintVertexBuffer)}this._buffers=b},nh.prototype.upload=function(a){for(var b in this.binders)this.binders[b].upload(a);var c=[];for(var d in this.binders){var e=this.binders[d];(e instanceof kh||e instanceof lh)&&e.paintVertexBuffer&&c.push(e.paintVertexBuffer)}this._buffers=c},nh.prototype.destroy=function(){for(var a in this.binders)this.binders[a].destroy()};var oh=function(a,b,c,d){void 0===d&&(d=function(){return!0}),this.programConfigurations={};for(var e=0,f=b;e<f.length;e+=1){var g=f[e];this.programConfigurations[g.id]=nh.createDynamic(g,c,d),this.programConfigurations[g.id].layoutAttributes=a}this.needsUpload=!1};oh.prototype.populatePaintArrays=function(a,b,c,d,e){for(var f in this.programConfigurations)this.programConfigurations[f].populatePaintArrays(a,b,c,d,e);this.needsUpload=!0},oh.prototype.updatePaintArrays=function(a,b,c,d){for(var e=0,f=c;e<f.length;e+=1){var g=f[e];this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(a,b,g,d)||this.needsUpload}},oh.prototype.get=function(a){return this.programConfigurations[a]},oh.prototype.upload=function(a){if(this.needsUpload){for(var b in this.programConfigurations)this.programConfigurations[b].upload(a);this.needsUpload=!1}},oh.prototype.destroy=function(){for(var a in this.programConfigurations)this.programConfigurations[a].destroy()},ab("ConstantBinder",ih),ab("CrossFadedConstantBinder",jh),ab("SourceExpressionBinder",kh),ab("CrossFadedCompositeBinder",mh),ab("CompositeExpressionBinder",lh),ab("ProgramConfiguration",nh,{omit:["_buffers"]}),ab("ProgramConfigurationSet",oh);var ph=8192,qh={min:-1*Math.pow(2,14),max:Math.pow(2,14)-1},rh=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new rg,this.indexArray=new Hg,this.segments=new Zg,this.programConfigurations=new oh(Yg,a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};rh.prototype.populate=function(a,b){var c=this.layers[0],d=[],e=null;"circle"===c.type&&(e=c.layout.get("circle-sort-key"));for(var f=0,g=a;f<g.length;f+=1){var h=g[f],i=h.feature,j=h.index,k=h.sourceLayerIndex;if(this.layers[0]._featureFilter(new $f(this.zoom),i)){var l=pb(i),m=e?e.evaluate(i,{}):void 0,n={id:i.id,properties:i.properties,type:i.type,sourceLayerIndex:k,index:j,geometry:l,patterns:{},sortKey:m};d.push(n)}}e&&d.sort(function(a,b){return a.sortKey-b.sortKey});for(var o=0,p=d;o<p.length;o+=1){var q=p[o],r=q,s=r.geometry,t=r.index,u=r.sourceLayerIndex,v=a[t].feature;this.addFeature(q,s,t),b.featureIndex.insert(v,s,t,u,this.index)}},rh.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},rh.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},rh.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},rh.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Yg),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},rh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},rh.prototype.addFeature=function(a,b,c){for(var d=0,e=b;d<e.length;d+=1)for(var f=0,g=e[d];f<g.length;f+=1){var h=g[f],i=h.x,j=h.y;if(!(i<0||i>=ph||j<0||j>=ph)){var k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),l=k.vertexLength;qb(this.layoutVertexArray,i,j,-1,-1),qb(this.layoutVertexArray,i,j,1,-1),qb(this.layoutVertexArray,i,j,1,1),qb(this.layoutVertexArray,i,j,-1,1),this.indexArray.emplaceBack(l,l+1,l+2),this.indexArray.emplaceBack(l,l+3,l+2),k.vertexLength+=4,k.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,c,{})},ab("CircleBucket",rh,{omit:["layers"]});var sh,th=new mg({"circle-sort-key":new ig(ve.layout_circle["circle-sort-key"])}),uh={paint:new mg({"circle-radius":new ig(ve.paint_circle["circle-radius"]),"circle-color":new ig(ve.paint_circle["circle-color"]),"circle-blur":new ig(ve.paint_circle["circle-blur"]),"circle-opacity":new ig(ve.paint_circle["circle-opacity"]),"circle-translate":new hg(ve.paint_circle["circle-translate"]),"circle-translate-anchor":new hg(ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new hg(ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new hg(ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ig(ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ig(ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ig(ve.paint_circle["circle-stroke-opacity"])}),layout:th},vh="undefined"!=typeof Float32Array?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var a=arguments,b=0,c=arguments.length;c--;)b+=a[c]*a[c];return Math.sqrt(b)}),sh=new vh(3),vh!=Float32Array&&(sh[0]=0,sh[1]=0,sh[2]=0),function(){var a=new vh(4);vh!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0)}();var wh=function(a){function b(b){a.call(this,b,uh)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createBucket=function(a){return new rh(a)},b.prototype.queryRadius=function(a){var b=a;return Cb("circle-radius",this,b)+Cb("circle-stroke-width",this,b)+Db(this.paint.get("circle-translate"))},b.prototype.queryIntersectsFeature=function(a,b,c,d,e,f,g,h){for(var i=Eb(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,g),j=this.paint.get("circle-radius").evaluate(b,c)+this.paint.get("circle-stroke-width").evaluate(b,c),k="map"===this.paint.get("circle-pitch-alignment"),l=k?i:function(a,b){return i.map(function(a){return Gb(a,b)})}(0,h),m=k?j*g:j,n=0,o=d;n<o.length;n+=1)for(var p=0,q=o[n];p<q.length;p+=1){var r=q[p],s=k?r:Gb(r,h),t=m,u=Fb([],[r.x,r.y,0,1],h);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?t*=u[3]/f.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(t*=f.cameraToCenterDistance/u[3]),sb(l,s,t))return!0}return!1},b}(ng),xh=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(rh);ab("HeatmapBucket",xh,{omit:["layers"]});var yh=function(a,b){Hb(this,a,1,b)};yh.prototype.resize=function(a){Ib(this,a,1)},yh.prototype.clone=function(){return new yh({width:this.width,height:this.height},new Uint8Array(this.data))},yh.copy=function(a,b,c,d,e){Jb(a,b,c,d,e,1)};var zh=function(a,b){Hb(this,a,4,b)};zh.prototype.resize=function(a){Ib(this,a,4)},zh.prototype.replace=function(a,b){b?this.data.set(a):a instanceof Uint8ClampedArray?this.data=new Uint8Array(a.buffer):this.data=a},zh.prototype.clone=function(){return new zh({width:this.width,height:this.height},new Uint8Array(this.data))},zh.copy=function(a,b,c,d,e){Jb(a,b,c,d,e,4)},ab("AlphaImage",yh),ab("RGBAImage",zh);var Ah={paint:new mg({"heatmap-radius":new ig(ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ig(ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new hg(ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new lg(ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new hg(ve.paint_heatmap["heatmap-opacity"])})},Bh=function(a){function b(b){a.call(this,b,Ah),this._updateColorRamp()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createBucket=function(a){return new xh(a)},b.prototype._handleSpecialPaintPropertyUpdate=function(a){"heatmap-color"===a&&this._updateColorRamp()},b.prototype._updateColorRamp=function(){var a=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Kb(a,"heatmapDensity"),this.colorRampTexture=null},b.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},b.prototype.queryRadius=function(){return 0},b.prototype.queryIntersectsFeature=function(){return!1},b.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},b}(ng),Ch={paint:new mg({"hillshade-illumination-direction":new hg(ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new hg(ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new hg(ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new hg(ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new hg(ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new hg(ve.paint_hillshade["hillshade-accent-color"])})},Dh=function(a){function b(b){a.call(this,b,Ch)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},b}(ng),Eh=ib([{name:"a_pos",components:2,type:"Int16"}],4).members,Fh=Lb,Gh=Lb
;Lb.deviation=function(a,b,c,d){var e=b&&b.length,f=e?b[0]*c:a.length,g=Math.abs(ic(a,0,f,c));if(e)for(var h=0,i=b.length;h<i;h++){var j=b[h]*c,k=h<i-1?b[h+1]*c:a.length;g-=Math.abs(ic(a,j,k,c))}var l=0;for(h=0;h<d.length;h+=3){var m=d[h]*c,n=d[h+1]*c,o=d[h+2]*c;l+=Math.abs((a[m]-a[o])*(a[n+1]-a[m+1])-(a[m]-a[n])*(a[o+1]-a[m+1]))}return 0===g&&0===l?0:Math.abs((l-g)/g)},Lb.flatten=function(a){for(var b=a[0][0].length,c={vertices:[],holes:[],dimensions:b},d=0,e=0;e<a.length;e++){for(var f=0;f<a[e].length;f++)for(var g=0;g<b;g++)c.vertices.push(a[e][f][g]);e>0&&(d+=a[e-1].length,c.holes.push(d))}return c},Fh.default=Gh;var Hh=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new rg,this.indexArray=new Hg,this.indexArray2=new Ig,this.programConfigurations=new oh(Eh,a.layers,a.zoom),this.segments=new Zg,this.segments2=new Zg,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};Hh.prototype.populate=function(a,b){this.hasPattern=oc("fill",this.layers,b);for(var c=this.layers[0].layout.get("fill-sort-key"),d=[],e=0,f=a;e<f.length;e+=1){var g=f[e],h=g.feature,i=g.index,j=g.sourceLayerIndex;if(this.layers[0]._featureFilter(new $f(this.zoom),h)){var k=pb(h),l=c?c.evaluate(h,{}):void 0,m={id:h.id,properties:h.properties,type:h.type,sourceLayerIndex:j,index:i,geometry:k,patterns:{},sortKey:l};d.push(m)}}c&&d.sort(function(a,b){return a.sortKey-b.sortKey});for(var n=0,o=d;n<o.length;n+=1){var p=o[n],q=p,r=q.geometry,s=q.index,t=q.sourceLayerIndex;if(this.hasPattern){var u=pc("fill",this.layers,p,this.zoom,b);this.patternFeatures.push(u)}else this.addFeature(p,r,s,{});var v=a[s].feature;b.featureIndex.insert(v,r,s,t,this.index)}},Hh.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},Hh.prototype.addFeatures=function(a,b){for(var c=0,d=this.patternFeatures;c<d.length;c+=1){var e=d[c];this.addFeature(e,e.geometry,e.index,b)}},Hh.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Hh.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Hh.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Eh),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0},Hh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Hh.prototype.addFeature=function(a,b,c,d){for(var e=0,f=mc(b,500);e<f.length;e+=1){for(var g=f[e],h=0,i=0,j=g;i<j.length;i+=1)h+=j[i].length;for(var k=this.segments.prepareSegment(h,this.layoutVertexArray,this.indexArray),l=k.vertexLength,m=[],n=[],o=0,p=g;o<p.length;o+=1){var q=p[o];if(0!==q.length){q!==g[0]&&n.push(m.length/2);var r=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),s=r.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(s+q.length-1,s),m.push(q[0].x),m.push(q[0].y);for(var t=1;t<q.length;t++)this.layoutVertexArray.emplaceBack(q[t].x,q[t].y),this.indexArray2.emplaceBack(s+t-1,s+t),m.push(q[t].x),m.push(q[t].y);r.vertexLength+=q.length,r.primitiveLength+=q.length}}for(var u=Fh(m,n),v=0;v<u.length;v+=3)this.indexArray.emplaceBack(l+u[v],l+u[v+1],l+u[v+2]);k.vertexLength+=h,k.primitiveLength+=u.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,c,d)},ab("FillBucket",Hh,{omit:["layers","patternFeatures"]});var Ih=new mg({"fill-sort-key":new ig(ve.layout_fill["fill-sort-key"])}),Jh={paint:new mg({"fill-antialias":new hg(ve.paint_fill["fill-antialias"]),"fill-opacity":new ig(ve.paint_fill["fill-opacity"]),"fill-color":new ig(ve.paint_fill["fill-color"]),"fill-outline-color":new ig(ve.paint_fill["fill-outline-color"]),"fill-translate":new hg(ve.paint_fill["fill-translate"]),"fill-translate-anchor":new hg(ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new jg(ve.paint_fill["fill-pattern"])}),layout:Ih},Kh=function(a){function b(b){a.call(this,b,Jh)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.recalculate=function(b){a.prototype.recalculate.call(this,b);var c=this.paint._values["fill-outline-color"];"constant"===c.value.kind&&void 0===c.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},b.prototype.createBucket=function(a){return new Hh(a)},b.prototype.queryRadius=function(){return Db(this.paint.get("fill-translate"))},b.prototype.queryIntersectsFeature=function(a,b,c,d,e,f,g){return tb(Eb(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,g),d)},b.prototype.isTileClipped=function(){return!0},b}(ng),Lh=ib([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Mh=qc;qc.types=["Unknown","Point","LineString","Polygon"],qc.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var b,c=a.readVarint()+a.pos,d=1,e=0,f=0,g=0,h=[];a.pos<c;){if(e<=0){var i=a.readVarint();d=7&i,e=i>>3}if(e--,1===d||2===d)f+=a.readSVarint(),g+=a.readSVarint(),1===d&&(b&&h.push(b),b=[]),b.push(new Gd(f,g));else{if(7!==d)throw new Error("unknown command "+d);b&&b.push(b[0].clone())}}return b&&h.push(b),h},qc.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var b=a.readVarint()+a.pos,c=1,d=0,e=0,f=0,g=1/0,h=-1/0,i=1/0,j=-1/0;a.pos<b;){if(d<=0){var k=a.readVarint();c=7&k,d=k>>3}if(d--,1===c||2===c)(e+=a.readSVarint())<g&&(g=e),e>h&&(h=e),(f+=a.readSVarint())<i&&(i=f),f>j&&(j=f);else if(7!==c)throw new Error("unknown command "+c)}return[g,i,h,j]},qc.prototype.toGeoJSON=function(a,b,c){function d(a){for(var b=0;b<a.length;b++){var c=a[b],d=180-360*(c.y+i)/g;a[b]=[360*(c.x+h)/g-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}}var e,f,g=this.extent*Math.pow(2,c),h=this.extent*a,i=this.extent*b,j=this.loadGeometry(),k=qc.types[this.type];switch(this.type){case 1:var l=[];for(e=0;e<j.length;e++)l[e]=j[e][0];d(j=l);break;case 2:for(e=0;e<j.length;e++)d(j[e]);break;case 3:for(j=function(a){var b=a.length;if(b<=1)return[a];for(var c,d,e=[],f=0;f<b;f++){var g=sc(a[f]);0!==g&&(void 0===d&&(d=g<0),d===g<0?(c&&e.push(c),c=[a[f]]):c.push(a[f]))}return c&&e.push(c),e}(j),e=0;e<j.length;e++)for(f=0;f<j[e].length;f++)d(j[e][f])}1===j.length?j=j[0]:k="Multi"+k;var m={type:"Feature",geometry:{type:k,coordinates:j},properties:this.properties};return"id"in this&&(m.id=this.id),m};var Nh=tc;tc.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var b=this._pbf.readVarint()+this._pbf.pos;return new Mh(this._pbf,b,this.extent,this._keys,this._values)};var Oh={VectorTile:function(a,b){this.layers=a.readFields(vc,{},b)},VectorTileFeature:Mh,VectorTileLayer:Nh},Ph=Oh.VectorTileFeature.types,Qh=Math.pow(2,13),Rh=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new tg,this.indexArray=new Hg,this.programConfigurations=new oh(Lh,a.layers,a.zoom),this.segments=new Zg,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};Rh.prototype.populate=function(a,b){this.features=[],this.hasPattern=oc("fill-extrusion",this.layers,b);for(var c=0,d=a;c<d.length;c+=1){var e=d[c],f=e.feature,g=e.index,h=e.sourceLayerIndex;if(this.layers[0]._featureFilter(new $f(this.zoom),f)){var i=pb(f),j={sourceLayerIndex:h,index:g,geometry:i,properties:f.properties,type:f.type,patterns:{}};void 0!==f.id&&(j.id=f.id),this.hasPattern?this.features.push(pc("fill-extrusion",this.layers,j,this.zoom,b)):this.addFeature(j,i,g,{}),b.featureIndex.insert(f,i,g,h,this.index,!0)}}},Rh.prototype.addFeatures=function(a,b){for(var c=0,d=this.features;c<d.length;c+=1){var e=d[c],f=e.geometry;this.addFeature(e,f,e.index,b)}},Rh.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},Rh.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Rh.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Rh.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Lh),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},Rh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Rh.prototype.addFeature=function(a,b,c,d){for(var e=0,f=mc(b,500);e<f.length;e+=1){for(var g=f[e],h=0,i=0,j=g;i<j.length;i+=1)h+=j[i].length;for(var k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),l=0,m=g;l<m.length;l+=1){var n=m[l];if(0!==n.length&&!yc(n))for(var o=0,p=0;p<n.length;p++){var q=n[p];if(p>=1){var r=n[p-1];if(!xc(q,r)){k.vertexLength+4>Zg.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var s=q.sub(r)._perp()._unit(),t=r.dist(q);o+t>32768&&(o=0),wc(this.layoutVertexArray,q.x,q.y,s.x,s.y,0,0,o),wc(this.layoutVertexArray,q.x,q.y,s.x,s.y,0,1,o),o+=t,wc(this.layoutVertexArray,r.x,r.y,s.x,s.y,0,0,o),wc(this.layoutVertexArray,r.x,r.y,s.x,s.y,0,1,o);var u=k.vertexLength;this.indexArray.emplaceBack(u,u+2,u+1),this.indexArray.emplaceBack(u+1,u+2,u+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+h>Zg.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(h,this.layoutVertexArray,this.indexArray)),"Polygon"===Ph[a.type]){for(var v=[],w=[],x=k.vertexLength,y=0,z=g;y<z.length;y+=1){var A=z[y];if(0!==A.length){A!==g[0]&&w.push(v.length/2);for(var B=0;B<A.length;B++){var C=A[B];wc(this.layoutVertexArray,C.x,C.y,0,0,1,1,0),v.push(C.x),v.push(C.y)}}}for(var D=Fh(v,w),E=0;E<D.length;E+=3)this.indexArray.emplaceBack(x+D[E],x+D[E+2],x+D[E+1]);k.primitiveLength+=D.length/3,k.vertexLength+=h}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,c,d)},ab("FillExtrusionBucket",Rh,{omit:["layers","features"]});var Sh={paint:new mg({"fill-extrusion-opacity":new hg(ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ig(ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new hg(ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new hg(ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new jg(ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ig(ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ig(ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new hg(ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Th=function(a){function b(b){a.call(this,b,Sh)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createBucket=function(a){return new Rh(a)},b.prototype.queryRadius=function(){return Db(this.paint.get("fill-extrusion-translate"))},b.prototype.is3D=function(){return!0},b.prototype.queryIntersectsFeature=function(a,b,c,d,e,f,g,h){var i=Eb(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,g),j=this.paint.get("fill-extrusion-height").evaluate(b,c),k=this.paint.get("fill-extrusion-base").evaluate(b,c),l=function(a,b,c,d){for(var e=[],f=0,g=a;f<g.length;f+=1){var h=g[f],i=[h.x,h.y,0,1];Fb(i,i,b),e.push(new Gd(i[0]/i[3],i[1]/i[3]))}return e}(i,h),m=function(a,b,c,d){for(var e=[],f=[],g=d[8]*b,h=d[9]*b,i=d[10]*b,j=d[11]*b,k=d[8]*c,l=d[9]*c,m=d[10]*c,n=d[11]*c,o=0,p=a;o<p.length;o+=1){for(var q=[],r=[],s=0,t=p[o];s<t.length;s+=1){var u=t[s],v=u.x,w=u.y,x=d[0]*v+d[4]*w+d[12],y=d[1]*v+d[5]*w+d[13],z=d[2]*v+d[6]*w+d[14],A=d[3]*v+d[7]*w+d[15],B=z+i,C=A+j,D=x+k,E=y+l,F=z+m,G=A+n,H=new Gd((x+g)/C,(y+h)/C);H.z=B/C,q.push(H);var I=new Gd(D/G,E/G);I.z=F/G,r.push(I)}e.push(q),f.push(r)}return[e,f]}(d,k,j,h);return function(a,b,c){var d=1/0;tb(c,b)&&(d=Ac(c,b[0]));for(var e=0;e<b.length;e++)for(var f=b[e],g=a[e],h=0;h<f.length-1;h++){var i=f[h],j=f[h+1],k=g[h],l=[i,j,g[h+1],k,i];rb(c,l)&&(d=Math.min(d,Ac(c,l)))}return d!==1/0&&d}(m[0],m[1],l)},b}(ng),Uh=ib([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Vh=Oh.VectorTileFeature.types,Wh=Math.cos(Math.PI/180*37.5),Xh=Math.pow(2,14)/.5,Yh=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ug,this.indexArray=new Hg,this.programConfigurations=new oh(Uh,a.layers,a.zoom),this.segments=new Zg,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};Yh.prototype.populate=function(a,b){this.hasPattern=oc("line",this.layers,b);for(var c=this.layers[0].layout.get("line-sort-key"),d=[],e=0,f=a;e<f.length;e+=1){var g=f[e],h=g.feature,i=g.index,j=g.sourceLayerIndex;if(this.layers[0]._featureFilter(new $f(this.zoom),h)){var k=pb(h),l=c?c.evaluate(h,{}):void 0,m={id:h.id,properties:h.properties,type:h.type,sourceLayerIndex:j,index:i,geometry:k,patterns:{},sortKey:l};d.push(m)}}c&&d.sort(function(a,b){return a.sortKey-b.sortKey});for(var n=0,o=d;n<o.length;n+=1){var p=o[n],q=p,r=q.geometry,s=q.index,t=q.sourceLayerIndex;if(this.hasPattern){var u=pc("line",this.layers,p,this.zoom,b);this.patternFeatures.push(u)}else this.addFeature(p,r,s,{});var v=a[s].feature;b.featureIndex.insert(v,r,s,t,this.index)}},Yh.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},Yh.prototype.addFeatures=function(a,b){for(var c=0,d=this.patternFeatures;c<d.length;c+=1){var e=d[c];this.addFeature(e,e.geometry,e.index,b)}},Yh.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Yh.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Yh.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Uh),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},Yh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Yh.prototype.addFeature=function(a,b,c,d){for(var e=this.layers[0].layout,f=e.get("line-join").evaluate(a,{}),g=e.get("line-cap"),h=e.get("line-miter-limit"),i=e.get("line-round-limit"),j=0,k=b;j<k.length;j+=1){var l=k[j];this.addLine(l,a,f,g,h,i,c,d)}},Yh.prototype.addLine=function(a,b,c,d,e,f,g,h){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,b.properties&&b.properties.hasOwnProperty("mapbox_clip_start")&&b.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+b.properties.mapbox_clip_start,this.clipEnd=+b.properties.mapbox_clip_end;for(var i=0;i<a.length-1;i++)this.totalDistance+=a[i].dist(a[i+1])}for(var j="Polygon"===Vh[b.type],k=a.length;k>=2&&a[k-1].equals(a[k-2]);)k--;for(var l=0;l<k-1&&a[l].equals(a[l+1]);)l++;if(!(k<(j?3:2))){"bevel"===c&&(e=1.05);var m,n=ph/(512*this.overscaling)*15,o=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray),p=void 0,q=void 0,r=void 0,s=void 0;this.e1=this.e2=-1,j&&(m=a[k-2],s=a[l].sub(m)._unit()._perp());for(var t=l;t<k;t++)if(!(q=j&&t===k-1?a[l+1]:a[t+1])||!a[t].equals(q)){s&&(r=s),m&&(p=m),m=a[t],s=q?q.sub(m)._unit()._perp():r;var u=(r=r||s).add(s);0===u.x&&0===u.y||u._unit();var v=r.x*s.x+r.y*s.y,w=u.x*s.x+u.y*s.y,x=0!==w?1/w:1/0,y=2*Math.sqrt(2-2*w),z=w<Wh&&p&&q,A=r.x*s.y-r.y*s.x>0;if(z&&t>l){var B=m.dist(p);if(B>2*n){var C=m.sub(m.sub(p)._mult(n/B)._round());this.updateDistance(p,C),this.addCurrentVertex(C,r,0,0,o),p=C}}var D=p&&q,E=D?c:j?"butt":d;if(D&&"round"===E&&(x<f?E="miter":x<=2&&(E="fakeround")),"miter"===E&&x>e&&(E="bevel"),"bevel"===E&&(x>2&&(E="flipbevel"),x<e&&(E="miter")),p&&this.updateDistance(p,m),"miter"===E)u._mult(x),this.addCurrentVertex(m,u,0,0,o);else if("flipbevel"===E){if(x>100)u=s.mult(-1);else{var F=x*r.add(s).mag()/r.sub(s).mag();u._perp()._mult(F*(A?-1:1))}this.addCurrentVertex(m,u,0,0,o),this.addCurrentVertex(m,u.mult(-1),0,0,o)}else if("bevel"===E||"fakeround"===E){var G=-Math.sqrt(x*x-1),H=A?G:0,I=A?0:G;if(p&&this.addCurrentVertex(m,r,H,I,o),"fakeround"===E)for(var J=Math.round(180*y/Math.PI/20),K=1;K<J;K++){var L=K/J;if(.5!==L){var M=L-.5;L+=L*M*(L-1)*((1.0904+v*(v*(3.55645-1.43519*v)-3.2452))*M*M+(.848013+v*(.215638*v-1.06021)))}var N=s.sub(r)._mult(L)._add(r)._unit()._mult(A?-1:1);this.addHalfVertex(m,N.x,N.y,!1,A,0,o)}q&&this.addCurrentVertex(m,s,-H,-I,o)}else if("butt"===E)this.addCurrentVertex(m,u,0,0,o);else if("square"===E){var O=p?1:-1;this.addCurrentVertex(m,u,O,O,o)}else"round"===E&&(p&&(this.addCurrentVertex(m,r,0,0,o),this.addCurrentVertex(m,r,1,1,o,!0)),q&&(this.addCurrentVertex(m,s,-1,-1,o,!0),this.addCurrentVertex(m,s,0,0,o)));if(z&&t<k-1){var P=m.dist(q);if(P>2*n){var Q=m.add(q.sub(m)._mult(n/P)._round());this.updateDistance(m,Q),this.addCurrentVertex(Q,s,0,0,o),m=Q}}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,g,h)}},Yh.prototype.addCurrentVertex=function(a,b,c,d,e,f){void 0===f&&(f=!1);var g=b.x+b.y*c,h=b.y-b.x*c,i=-b.x+b.y*d,j=-b.y-b.x*d;this.addHalfVertex(a,g,h,f,!1,c,e),this.addHalfVertex(a,i,j,f,!0,-d,e),this.distance>Xh/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(a,b,c,d,e,f))},Yh.prototype.addHalfVertex=function(a,b,c,d,e,f,g){var h=a.x,i=a.y,j=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((h<<1)+(d?1:0),(i<<1)+(e?1:0),Math.round(63*b)+128,Math.round(63*c)+128,1+(0===f?0:f<0?-1:1)|(63&j)<<2,j>>6);var k=g.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),g.primitiveLength++),e?this.e2=k:this.e1=k},Yh.prototype.updateDistance=function(a,b){this.distance+=a.dist(b),this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Xh-1):this.distance},ab("LineBucket",Yh,{omit:["layers","patternFeatures"]});var Zh=new mg({"line-cap":new hg(ve.layout_line["line-cap"]),"line-join":new ig(ve.layout_line["line-join"]),"line-miter-limit":new hg(ve.layout_line["line-miter-limit"]),"line-round-limit":new hg(ve.layout_line["line-round-limit"]),"line-sort-key":new ig(ve.layout_line["line-sort-key"])}),$h={paint:new mg({"line-opacity":new ig(ve.paint_line["line-opacity"]),"line-color":new ig(ve.paint_line["line-color"]),"line-translate":new hg(ve.paint_line["line-translate"]),"line-translate-anchor":new hg(ve.paint_line["line-translate-anchor"]),"line-width":new ig(ve.paint_line["line-width"]),"line-gap-width":new ig(ve.paint_line["line-gap-width"]),"line-offset":new ig(ve.paint_line["line-offset"]),"line-blur":new ig(ve.paint_line["line-blur"]),"line-dasharray":new kg(ve.paint_line["line-dasharray"]),"line-pattern":new jg(ve.paint_line["line-pattern"]),"line-gradient":new lg(ve.paint_line["line-gradient"])}),layout:Zh},_h=new(function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.possiblyEvaluate=function(b,c){return c=new $f(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),a.prototype.possiblyEvaluate.call(this,b,c)},b.prototype.evaluate=function(b,c,d,e){return c=i({},c,{zoom:Math.floor(c.zoom)}),a.prototype.evaluate.call(this,b,c,d,e)},b}(ig))($h.paint.properties["line-width"].specification);_h.useIntegerZoom=!0;var ai=function(a){function b(b){a.call(this,b,$h)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._handleSpecialPaintPropertyUpdate=function(a){"line-gradient"===a&&this._updateGradient()},b.prototype._updateGradient=function(){var a=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Kb(a,"lineProgress"),this.gradientTexture=null},b.prototype.recalculate=function(b){a.prototype.recalculate.call(this,b),this.paint._values["line-floorwidth"]=_h.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,b)},b.prototype.createBucket=function(a){return new Yh(a)},b.prototype.queryRadius=function(a){var b=a,c=Bc(Cb("line-width",this,b),Cb("line-gap-width",this,b)),d=Cb("line-offset",this,b);return c/2+Math.abs(d)+Db(this.paint.get("line-translate"))},b.prototype.queryIntersectsFeature=function(a,b,c,d,e,f,g){var h=Eb(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,g),i=g/2*Bc(this.paint.get("line-width").evaluate(b,c),this.paint.get("line-gap-width").evaluate(b,c)),j=this.paint.get("line-offset").evaluate(b,c);return j&&(d=function(a,b){for(var c=[],d=new Gd(0,0),e=0;e<a.length;e++){for(var f=a[e],g=[],h=0;h<f.length;h++){var i=f[h-1],j=f[h],k=f[h+1],l=0===h?d:j.sub(i)._unit()._perp(),m=h===f.length-1?d:k.sub(j)._unit()._perp(),n=l._add(m)._unit(),o=n.x*m.x+n.y*m.y;n._mult(1/o),g.push(n._mult(b)._add(j))}c.push(g)}return c}(d,j*g)),function(a,b,c){for(var d=0;d<b.length;d++){var e=b[d];if(a.length>=3)for(var f=0;f<e.length;f++)if(Ab(a,e[f]))return!0;if(ub(a,e,c))return!0}return!1}(h,d,i)},b.prototype.isTileClipped=function(){return!0},b}(ng),bi=ib([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),ci=ib([{name:"a_projected_pos",components:3,type:"Float32"}],4),di=(ib([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ib([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),ei=(ib([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),ib([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),fi=ib([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);ib([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"}]),ib([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"radialTextOffset"}]),ib([{type:"Float32",name:"offsetX"}]),ib([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var gi={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},hi=24,ii={horizontal:1,vertical:2,horizontalOnly:3},ji=function(){this.text="",this.sectionIndex=[],this.sections=[]};ji.fromFeature=function(a,b){for(var c=new ji,d=0;d<a.sections.length;d++){var e=a.sections[d];c.sections.push({scale:e.scale||1,fontStack:e.fontStack||b}),c.text+=e.text;for(var f=0;f<e.text.length;f++)c.sectionIndex.push(d)}return c},ji.prototype.length=function(){return this.text.length},ji.prototype.getSection=function(a){return this.sections[this.sectionIndex[a]]},ji.prototype.getSectionIndex=function(a){return this.sectionIndex[a]},ji.prototype.getCharCode=function(a){return this.text.charCodeAt(a)},ji.prototype.verticalizePunctuation=function(){this.text=function(a){for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c+1)||null,e=a.charCodeAt(c-1)||null;d&&gb(d)&&!gi[a[c+1]]||e&&gb(e)&&!gi[a[c-1]]||!gi[a[c]]?b+=a[c]:b+=gi[a[c]]}return b}(this.text)},ji.prototype.trim=function(){for(var a=0,b=0;b<this.text.length&&ki[this.text.charCodeAt(b)];b++)a++;for(var c=this.text.length,d=this.text.length-1;d>=0&&d>=a&&ki[this.text.charCodeAt(d)];d--)c--;this.text=this.text.substring(a,c),this.sectionIndex=this.sectionIndex.slice(a,c)},ji.prototype.substring=function(a,b){var c=new ji;return c.text=this.text.substring(a,b),c.sectionIndex=this.sectionIndex.slice(a,b),c.sections=this.sections,c},ji.prototype.toString=function(){return this.text},ji.prototype.getMaxScale=function(){var a=this;return this.sectionIndex.reduce(function(b,c){return Math.max(b,a.sections[c].scale)},0)};var ki={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},li={};li[10]=!0,li[32]=!0,li[38]=!0,li[40]=!0,li[41]=!0,li[43]=!0,li[45]=!0,li[47]=!0,li[173]=!0,li[183]=!0,li[8203]=!0,li[8208]=!0,li[8211]=!0,li[8231]=!0;var mi=function(a){function b(b,c,d,e){a.call(this,b,c),this.angle=d,void 0!==e&&(this.segment=e)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){return new b(this.x,this.y,this.angle,this.segment)},b}(Gd);ab("Anchor",mi);var ni=256,oi=Object.freeze({getSizeData:Kc,evaluateSizeForFeature:Lc,evaluateSizeForZoom:Mc,SIZE_PACK_FACTOR:ni}),pi=Oh.VectorTileFeature.types,qi=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}],ri=function(a){this.layoutVertexArray=new wg,this.indexArray=new Hg,this.programConfigurations=a,this.segments=new Zg,this.dynamicLayoutVertexArray=new xg,this.opacityVertexArray=new yg,this.placedSymbolArray=new Pg};ri.prototype.upload=function(a,b,c,d){c&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,bi.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,b),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,ci.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,qi,!0),this.opacityVertexBuffer.itemSize=1),(c||d)&&this.programConfigurations.upload(a)},ri.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ab("SymbolBuffers",ri);var si=function(a,b,c){this.layoutVertexArray=new a,this.layoutAttributes=b,this.indexArray=new c,this.segments=new Zg,this.collisionVertexArray=new Bg};si.prototype.upload=function(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,di.members,!0)},si.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ab("CollisionBuffers",si);var ti=function(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasPaintOverrides=!1;var b=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Kc(this.zoom,b["text-size"]),this.iconSizeData=Kc(this.zoom,b["icon-size"]);var c=this.layers[0].layout,d=c.get("symbol-sort-key"),e=c.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==e&&void 0!==d.constantOr(1);var f="viewport-y"===e||"auto"===e&&!this.sortFeaturesByKey;this.sortFeaturesByY=f&&(c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement")),"point"===c.get("symbol-placement")&&(this.writingModes=c.get("text-writing-mode").map(function(a){return ii[a]})),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id}),this.sourceID=a.sourceID};ti.prototype.createArrays=function(){var a=this.layers[0].layout;this.hasPaintOverrides=xi.hasPaintOverrides(a),this.text=new ri(new oh(bi.members,this.layers,this.zoom,function(a){return/^text/.test(a)})),this.icon=new ri(new oh(bi.members,this.layers,this.zoom,function(a){return/^icon/.test(a)})),this.collisionBox=new si(Ag,ei.members,Ig),this.collisionCircle=new si(Ag,fi.members,Hg),this.glyphOffsetArray=new Tg,this.lineVertexArray=new Vg,this.symbolInstances=new Rg},ti.prototype.calculateGlyphDependencies=function(a,b,c,d,e){for(var f=0;f<a.length;f++)if(b[a.charCodeAt(f)]=!0,(c||d)&&e){var g=gi[a.charAt(f)];g&&(b[g.charCodeAt(0)]=!0)}},ti.prototype.populate=function(a,b){var c=this.layers[0],d=c.layout,e=d.get("text-font"),f=d.get("text-field"),g=d.get("icon-image"),h=("constant"!==f.value.kind||f.value.value.toString().length>0)&&("constant"!==e.value.kind||e.value.value.length>0),i="constant"!==g.value.kind||g.value.value&&g.value.value.length>0,j=d.get("symbol-sort-key");if(this.features=[],h||i){for(var k=b.iconDependencies,l=b.glyphDependencies,m=new $f(this.zoom),n=0,o=a;n<o.length;n+=1){var p=o[n],q=p.feature,r=p.index,s=p.sourceLayerIndex;if(c._featureFilter(m,q)){var t=void 0;if(h){var u=c.getValueAndResolveTokens("text-field",q);t=Cc(u instanceof Ne?u:Ne.fromString(u),c,q)}var v=void 0;if(i&&(v=c.getValueAndResolveTokens("icon-image",q)),t||v){var w=this.sortFeaturesByKey?j.evaluate(q,{}):void 0,x={text:t,icon:v,index:r,sourceLayerIndex:s,geometry:pb(q),properties:q.properties,type:pi[q.type],sortKey:w};if(void 0!==q.id&&(x.id=q.id),this.features.push(x),v&&(k[v]=!0),t){var y=e.evaluate(q,{}).join(","),z="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement")
;this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ii.vertical)>=0;for(var A=0,B=t.sections;A<B.length;A+=1){var C=B[A],D=db(t.toString()),E=C.fontStack||y,F=l[E]=l[E]||{};this.calculateGlyphDependencies(C.text,F,z,this.allowVerticalPlacement,D)}}}}}"line"===d.get("symbol-placement")&&(this.features=function(a){function b(b){h.push(a[b]),i++}function c(a,b,c){var d=g[a];return delete g[a],g[b]=d,h[d].geometry[0].pop(),h[d].geometry[0]=h[d].geometry[0].concat(c[0]),d}function d(a,b,c){var d=f[b];return delete f[b],f[a]=d,h[d].geometry[0].shift(),h[d].geometry[0]=c[0].concat(h[d].geometry[0]),d}function e(a,b,c){var d=c?b[0][b[0].length-1]:b[0][0];return a+":"+d.x+":"+d.y}for(var f={},g={},h=[],i=0,j=0;j<a.length;j++){var k=a[j],l=k.geometry,m=k.text?k.text.toString():null;if(m){var n=e(m,l),o=e(m,l,!0);if(n in g&&o in f&&g[n]!==f[o]){var p=d(n,o,l),q=c(n,o,h[p].geometry);delete f[n],delete g[o],g[e(m,h[q].geometry,!0)]=q,h[p].geometry=null}else n in g?c(n,o,l):o in f?d(n,o,l):(b(j),f[n]=i-1,g[o]=i-1)}else b(j)}return h.filter(function(a){return a.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(a,b){return a.sortKey-b.sortKey})}},ti.prototype.update=function(a,b,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,b,this.layers,c),this.icon.programConfigurations.updatePaintArrays(a,b,this.layers,c))},ti.prototype.isEmpty=function(){return 0===this.symbolInstances.length},ti.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ti.prototype.upload=function(a){this.uploaded||(this.collisionBox.upload(a),this.collisionCircle.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ti.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},ti.prototype.addToLineVertexArray=function(a,b){var c=this.lineVertexArray.length;if(void 0!==a.segment){for(var d=a.dist(b[a.segment+1]),e=a.dist(b[a.segment]),f={},g=a.segment+1;g<b.length;g++)f[g]={x:b[g].x,y:b[g].y,tileUnitDistanceFromAnchor:d},g<b.length-1&&(d+=b[g+1].dist(b[g]));for(var h=a.segment||0;h>=0;h--)f[h]={x:b[h].x,y:b[h].y,tileUnitDistanceFromAnchor:e},h>0&&(e+=b[h-1].dist(b[h]));for(var i=0;i<b.length;i++){var j=f[i];this.lineVertexArray.emplaceBack(j.x,j.y,j.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}},ti.prototype.addSymbols=function(a,b,c,d,e,f,g,h,i,j){var k=this,l=a.indexArray,m=a.layoutVertexArray,n=a.dynamicLayoutVertexArray,o=a.segments.prepareSegment(4*b.length,a.layoutVertexArray,a.indexArray,f.sortKey),p=this.glyphOffsetArray.length,q=o.vertexLength,r=this.allowVerticalPlacement&&g===ii.vertical?Math.PI/2:0,s=function(a){var b=a.tl,d=a.tr,e=a.bl,f=a.br,g=a.tex,i=o.vertexLength,j=a.glyphOffset[1];Nc(m,h.x,h.y,b.x,j+b.y,g.x,g.y,c),Nc(m,h.x,h.y,d.x,j+d.y,g.x+g.w,g.y,c),Nc(m,h.x,h.y,e.x,j+e.y,g.x,g.y+g.h,c),Nc(m,h.x,h.y,f.x,j+f.y,g.x+g.w,g.y+g.h,c),Oc(n,h,r),l.emplaceBack(i,i+1,i+2),l.emplaceBack(i+1,i+2,i+3),o.vertexLength+=4,o.primitiveLength+=2,k.glyphOffsetArray.emplaceBack(a.glyphOffset[0])};if(f.text&&f.text.sections){var t=f.text.sections;if(this.hasPaintOverrides){for(var u,v=function(b,c){void 0===u||u===b&&!c||a.programConfigurations.populatePaintArrays(a.layoutVertexArray.length,f,f.index,{},t[u]),u=b},w=0,x=b;w<x.length;w+=1){var y=x[w];v(y.sectionIndex,!1),s(y)}v(u,!0)}else{for(var z=0,A=b;z<A.length;z+=1)s(A[z]);a.programConfigurations.populatePaintArrays(a.layoutVertexArray.length,f,f.index,{},t[0])}}else{for(var B=0,C=b;B<C.length;B+=1)s(C[B]);a.programConfigurations.populatePaintArrays(a.layoutVertexArray.length,f,f.index,{})}a.placedSymbolArray.emplaceBack(h.x,h.y,p,this.glyphOffsetArray.length-p,q,i,j,h.segment,c?c[0]:0,c?c[1]:0,d[0],d[1],g,0,!1,0)},ti.prototype._addCollisionDebugVertex=function(a,b,c,d,e,f){return b.emplaceBack(0,0),a.emplaceBack(c.x,c.y,d,e,Math.round(f.x),Math.round(f.y))},ti.prototype.addCollisionDebugVertices=function(a,b,c,d,e,f,g,h){var i=e.segments.prepareSegment(4,e.layoutVertexArray,e.indexArray),j=i.vertexLength,k=e.layoutVertexArray,l=e.collisionVertexArray,m=g.anchorX,n=g.anchorY;if(this._addCollisionDebugVertex(k,l,f,m,n,new Gd(a,b)),this._addCollisionDebugVertex(k,l,f,m,n,new Gd(c,b)),this._addCollisionDebugVertex(k,l,f,m,n,new Gd(c,d)),this._addCollisionDebugVertex(k,l,f,m,n,new Gd(a,d)),i.vertexLength+=4,h){var o=e.indexArray;o.emplaceBack(j,j+1,j+2),o.emplaceBack(j,j+2,j+3),i.primitiveLength+=2}else{var p=e.indexArray;p.emplaceBack(j,j+1),p.emplaceBack(j+1,j+2),p.emplaceBack(j+2,j+3),p.emplaceBack(j+3,j),i.primitiveLength+=4}},ti.prototype.addDebugCollisionBoxes=function(a,b,c){for(var d=a;d<b;d++){var e=this.collisionBoxArray.get(d),f=e.x1,g=e.y1,h=e.x2,i=e.y2,j=e.radius>0;this.addCollisionDebugVertices(f,g,h,i,j?this.collisionCircle:this.collisionBox,e.anchorPoint,c,j)}},ti.prototype.generateCollisionDebugBuffers=function(){for(var a=0;a<this.symbolInstances.length;a++){var b=this.symbolInstances.get(a);this.addDebugCollisionBoxes(b.textBoxStartIndex,b.textBoxEndIndex,b),this.addDebugCollisionBoxes(b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this.addDebugCollisionBoxes(b.iconBoxStartIndex,b.iconBoxEndIndex,b)}},ti.prototype._deserializeCollisionBoxesForSymbol=function(a,b,c,d,e,f,g){for(var h={},i=b;i<c;i++){var j=a.get(i);if(0===j.radius){h.textBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},h.textFeatureIndex=j.featureIndex;break}h.textCircles||(h.textCircles=[],h.textFeatureIndex=j.featureIndex),h.textCircles.push(j.anchorPointX,j.anchorPointY,j.radius,j.signedDistanceFromAnchor,1)}for(var k=d;k<e;k++){var l=a.get(k);if(0===l.radius){h.verticalTextBox={x1:l.x1,y1:l.y1,x2:l.x2,y2:l.y2,anchorPointX:l.anchorPointX,anchorPointY:l.anchorPointY},h.verticalTextFeatureIndex=l.featureIndex;break}}for(var m=f;m<g;m++){var n=a.get(m);if(0===n.radius){h.iconBox={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,anchorPointX:n.anchorPointX,anchorPointY:n.anchorPointY},h.iconFeatureIndex=n.featureIndex;break}}return h},ti.prototype.deserializeCollisionBoxes=function(a){this.collisionArrays=[];for(var b=0;b<this.symbolInstances.length;b++){var c=this.symbolInstances.get(b);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex))}},ti.prototype.hasTextData=function(){return this.text.segments.get().length>0},ti.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ti.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},ti.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},ti.prototype.addIndicesForPlacedTextSymbol=function(a){for(var b=this.text.placedSymbolArray.get(a),c=b.vertexStartIndex+4*b.numGlyphs,d=b.vertexStartIndex;d<c;d+=4)this.text.indexArray.emplaceBack(d,d+1,d+2),this.text.indexArray.emplaceBack(d+1,d+2,d+3)},ti.prototype.getSortedSymbolIndexes=function(a){if(this.sortedAngle===a&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var b=Math.sin(a),c=Math.cos(a),d=[],e=[],f=[],g=0;g<this.symbolInstances.length;++g){f.push(g);var h=this.symbolInstances.get(g);d.push(0|Math.round(b*h.anchorX+c*h.anchorY)),e.push(h.featureIndex)}return f.sort(function(a,b){return d[a]-d[b]||e[b]-e[a]}),f},ti.prototype.sortFeatures=function(a){var b=this;if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var c=0,d=this.symbolInstanceIndexes;c<d.length;c+=1){var e=d[c],f=this.symbolInstances.get(e);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(a,c,d){a>=0&&d.indexOf(a)===c&&b.addIndicesForPlacedTextSymbol(a)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedTextSymbol(f.verticalPlacedTextSymbolIndex);var g=this.icon.placedSymbolArray.get(e);if(g.numGlyphs){var h=g.vertexStartIndex;this.icon.indexArray.emplaceBack(h,h+1,h+2),this.icon.indexArray.emplaceBack(h+1,h+2,h+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ab("SymbolBucket",ti,{omit:["layers","collisionBoxArray","features","compareText"]}),ti.MAX_GLYPHS=65535,ti.addDynamicAttributes=Oc;var ui=new mg({"symbol-placement":new hg(ve.layout_symbol["symbol-placement"]),"symbol-spacing":new hg(ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new hg(ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ig(ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new hg(ve.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new hg(ve.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new hg(ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new hg(ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new hg(ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new ig(ve.layout_symbol["icon-size"]),"icon-text-fit":new hg(ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new hg(ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new ig(ve.layout_symbol["icon-image"]),"icon-rotate":new ig(ve.layout_symbol["icon-rotate"]),"icon-padding":new hg(ve.layout_symbol["icon-padding"]),"icon-keep-upright":new hg(ve.layout_symbol["icon-keep-upright"]),"icon-offset":new ig(ve.layout_symbol["icon-offset"]),"icon-anchor":new ig(ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new hg(ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new hg(ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new hg(ve.layout_symbol["text-rotation-alignment"]),"text-field":new ig(ve.layout_symbol["text-field"]),"text-font":new ig(ve.layout_symbol["text-font"]),"text-size":new ig(ve.layout_symbol["text-size"]),"text-max-width":new ig(ve.layout_symbol["text-max-width"]),"text-line-height":new hg(ve.layout_symbol["text-line-height"]),"text-letter-spacing":new ig(ve.layout_symbol["text-letter-spacing"]),"text-justify":new ig(ve.layout_symbol["text-justify"]),"text-radial-offset":new ig(ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new hg(ve.layout_symbol["text-variable-anchor"]),"text-anchor":new ig(ve.layout_symbol["text-anchor"]),"text-max-angle":new hg(ve.layout_symbol["text-max-angle"]),"text-writing-mode":new hg(ve.layout_symbol["text-writing-mode"]),"text-rotate":new ig(ve.layout_symbol["text-rotate"]),"text-padding":new hg(ve.layout_symbol["text-padding"]),"text-keep-upright":new hg(ve.layout_symbol["text-keep-upright"]),"text-transform":new ig(ve.layout_symbol["text-transform"]),"text-offset":new ig(ve.layout_symbol["text-offset"]),"text-allow-overlap":new hg(ve.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new hg(ve.layout_symbol["text-ignore-placement"]),"text-optional":new hg(ve.layout_symbol["text-optional"])}),vi={paint:new mg({"icon-opacity":new ig(ve.paint_symbol["icon-opacity"]),"icon-color":new ig(ve.paint_symbol["icon-color"]),"icon-halo-color":new ig(ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new ig(ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ig(ve.paint_symbol["icon-halo-blur"]),"icon-translate":new hg(ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new hg(ve.paint_symbol["icon-translate-anchor"]),"text-opacity":new ig(ve.paint_symbol["text-opacity"]),"text-color":new ig(ve.paint_symbol["text-color"],{runtimeType:De,getOverride:function(a){return a.textColor},hasOverride:function(a){return!!a.textColor}}),"text-halo-color":new ig(ve.paint_symbol["text-halo-color"]),"text-halo-width":new ig(ve.paint_symbol["text-halo-width"]),"text-halo-blur":new ig(ve.paint_symbol["text-halo-blur"]),"text-translate":new hg(ve.paint_symbol["text-translate"]),"text-translate-anchor":new hg(ve.paint_symbol["text-translate-anchor"])}),layout:ui},wi=function(a){this.type=a.property.overrides?a.property.overrides.runtimeType:ze,this.defaultValue=a};wi.prototype.evaluate=function(a){if(a.formattedSection){var b=this.defaultValue.property.overrides;if(b&&b.hasOverride(a.formattedSection))return b.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default},wi.prototype.eachChild=function(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)},wi.prototype.possibleOutputs=function(){return[void 0]},wi.prototype.serialize=function(){return null},ab("FormatSectionOverride",wi,{omit:["defaultValue"]});var xi=function(a){function b(b){a.call(this,b,vi)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.recalculate=function(b){if(a.prototype.recalculate.call(this,b),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var c=this.layout.get("text-writing-mode");if(c){for(var d=[],e=0,f=c;e<f.length;e+=1){var g=f[e];d.indexOf(g)<0&&d.push(g)}this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},b.prototype.getValueAndResolveTokens=function(a,b){var c=this.layout.get(a).evaluate(b,{}),d=this._unevaluatedLayout._values[a];return d.isDataDriven()||wa(d.value)?c:function(a,b){return c.replace(/{([^{}]+)}/g,function(b,c){return c in a?String(a[c]):""})}(b.properties)},b.prototype.createBucket=function(a){return new ti(a)},b.prototype.queryRadius=function(){return 0},b.prototype.queryIntersectsFeature=function(){return!1},b.prototype._setPaintOverrides=function(){for(var a=0,c=vi.paint.overridableProperties;a<c.length;a+=1){var d=c[a];if(b.hasPaintOverride(this.layout,d)){var e,f=this.paint.get(d),g=new wi(f),h=new Df(g,f.property.specification);e="constant"===f.value.kind||"source"===f.value.kind?new Ef("source",h):new Ff("composite",h,f.value.zoomStops,f.value._interpolationType),this.paint._values[d]=new fg(f.property,e,f.parameters)}}},b.prototype._handleOverridablePaintPropertyUpdate=function(a,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven())&&b.hasPaintOverride(this.layout,a)},b.hasPaintOverride=function(a,b){var c=a.get("text-field"),d=vi.paint.properties[b],e=!1,f=function(a){for(var b=0,c=a;b<c.length;b+=1){var f=c[b];if(d.overrides&&d.overrides.hasOverride(f))return void(e=!0)}};if("constant"===c.value.kind&&c.value.value instanceof Ne)f(c.value.value.sections);else if("source"===c.value.kind){var g=function(a){if(!e)if(a instanceof Oe&&Q(a.value)===He){var b=a.value;f(b.sections)}else a instanceof Se?f(a.sections):a.eachChild(g)},h=c.value;h._styleExpression&&g(h._styleExpression.expression)}return e},b.hasPaintOverrides=function(a){for(var c=0,d=vi.paint.overridableProperties;c<d.length;c+=1){var e=d[c];if(b.hasPaintOverride(a,e))return!0}return!1},b}(ng),yi={paint:new mg({"background-color":new hg(ve.paint_background["background-color"]),"background-pattern":new kg(ve.paint_background["background-pattern"]),"background-opacity":new hg(ve.paint_background["background-opacity"])})},zi=function(a){function b(b){a.call(this,b,yi)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(ng),Ai={paint:new mg({"raster-opacity":new hg(ve.paint_raster["raster-opacity"]),"raster-hue-rotate":new hg(ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new hg(ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new hg(ve.paint_raster["raster-brightness-max"]),"raster-saturation":new hg(ve.paint_raster["raster-saturation"]),"raster-contrast":new hg(ve.paint_raster["raster-contrast"]),"raster-resampling":new hg(ve.paint_raster["raster-resampling"]),"raster-fade-duration":new hg(ve.paint_raster["raster-fade-duration"])})},Bi=function(a){function b(b){a.call(this,b,Ai)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(ng),Ci=function(a){function b(b){a.call(this,b,{}),this.implementation=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},b.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},b.prototype.recalculate=function(){},b.prototype.updateTransitions=function(){},b.prototype.hasTransition=function(){},b.prototype.serialize=function(){},b.prototype.onAdd=function(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},b.prototype.onRemove=function(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},b}(ng),Di={circle:wh,heatmap:Bh,hillshade:Dh,fill:Kh,"fill-extrusion":Th,line:ai,symbol:xi,background:zi,raster:Bi},Ei=function(a,b){var c=b.pixelRatio,d=b.version;this.paddedRect=a,this.pixelRatio=c,this.version=d},Fi={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Fi.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Fi.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Fi.tlbr.get=function(){return this.tl.concat(this.br)},Fi.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Ei.prototype,Fi);var Gi=function(a,b){var c={},d={};this.haveRenderCallbacks=[];var e=[];this.addImages(a,c,e),this.addImages(b,d,e);var f=Pc(e),g=f.w,h=f.h,i=new zh({width:g||1,height:h||1});for(var j in a){var k=a[j],l=c[j].paddedRect;zh.copy(k.data,i,{x:0,y:0},{x:l.x+1,y:l.y+1},k.data)}for(var m in b){var n=b[m],o=d[m].paddedRect,p=o.x+1,q=o.y+1,r=n.data.width,s=n.data.height;zh.copy(n.data,i,{x:0,y:0},{x:p,y:q},n.data),zh.copy(n.data,i,{x:0,y:s-1},{x:p,y:q-1},{width:r,height:1}),zh.copy(n.data,i,{x:0,y:0},{x:p,y:q+s},{width:r,height:1}),zh.copy(n.data,i,{x:r-1,y:0},{x:p-1,y:q},{width:1,height:s}),zh.copy(n.data,i,{x:0,y:0},{x:p+r,y:q},{width:1,height:s})}this.image=i,this.iconPositions=c,this.patternPositions=d};Gi.prototype.addImages=function(a,b,c){for(var d in a){var e=a[d],f={x:0,y:0,w:e.data.width+2,h:e.data.height+2};c.push(f),b[d]=new Ei(f,e),e.hasRenderCallback&&this.haveRenderCallbacks.push(d)}},Gi.prototype.patchUpdatedImages=function(a,b){for(var c in a.dispatchRenderCallbacks(this.haveRenderCallbacks),a.updatedImages)this.patchUpdatedImage(this.iconPositions[c],a.getImage(c),b),this.patchUpdatedImage(this.patternPositions[c],a.getImage(c),b)},Gi.prototype.patchUpdatedImage=function(a,b,c){if(a&&b&&a.version!==b.version){a.version=b.version;var d=a.tl,e=d[0],f=d[1];c.update(b.data,void 0,{x:e,y:f})}},ab("ImagePosition",Ei),ab("ImageAtlas",Gi);var Hi=self.HTMLImageElement,Ii=self.HTMLCanvasElement,Ji=self.HTMLVideoElement,Ki=self.ImageData,Li=function(a,b,c,d){this.context=a,this.format=c,this.texture=a.gl.createTexture(),this.update(b,d)};Li.prototype.update=function(a,b,c){var d=a.width,e=a.height,f=!(this.size&&this.size[0]===d&&this.size[1]===e||c),g=this.context,h=g.gl;if(this.useMipmap=Boolean(b&&b.useMipmap),h.bindTexture(h.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===h.RGBA&&(!b||!1!==b.premultiply)),f)this.size=[d,e],a instanceof Hi||a instanceof Ii||a instanceof Ji||a instanceof Ki?h.texImage2D(h.TEXTURE_2D,0,this.format,this.format,h.UNSIGNED_BYTE,a):h.texImage2D(h.TEXTURE_2D,0,this.format,d,e,0,this.format,h.UNSIGNED_BYTE,a.data);else{var i=c||{x:0,y:0},j=i.x,k=i.y;a instanceof Hi||a instanceof Ii||a instanceof Ji||a instanceof Ki?h.texSubImage2D(h.TEXTURE_2D,0,j,k,h.RGBA,h.UNSIGNED_BYTE,a):h.texSubImage2D(h.TEXTURE_2D,0,j,k,d,e,h.RGBA,h.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&h.generateMipmap(h.TEXTURE_2D)},Li.prototype.bind=function(a,b,c){var d=this.context.gl;d.bindTexture(d.TEXTURE_2D,this.texture),c!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=d.LINEAR),a!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,a),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,c||a),this.filter=a),b!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,b),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,b),this.wrap=b)},Li.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Li.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Mi=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},Ni=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),(b+=g+l>=1?m/i:m*Math.pow(2,1-l))*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p},Oi=Qc;Qc.Varint=0,Qc.Fixed64=1,Qc.Bytes=2,Qc.Fixed32=5,Qc.prototype={destroy:function(){this.buf=null},readFields:function(a,b,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),e=d>>3,f=this.pos;this.type=7&d,a(e,b,this),this.pos===f&&this.skip(d)}return b},readMessage:function(a,b){return this.readFields(a,b,this.readVarint()+this.pos)},readFixed32:function(){var a=bd(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=dd(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=bd(this.buf,this.pos)+4294967296*bd(this.buf,this.pos+4);return this.pos+=8,a},readSFixed64:function(){var a=bd(this.buf,this.pos)+4294967296*dd(this.buf,this.pos+4);return this.pos+=8,a},readFloat:function(){var a=Mi(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Mi(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var b,c,d=this.buf;return b=127&(c=d[this.pos++]),c<128?b:(b|=(127&(c=d[this.pos++]))<<7,c<128?b:(b|=(127&(c=d[this.pos++]))<<14,c<128?b:(b|=(127&(c=d[this.pos++]))<<21,c<128?b:function(a,b,c){var d,e,f=c.buf;if(d=(112&(e=f[c.pos++]))>>4,e<128)return Sc(a,d,b);if(d|=(127&(e=f[c.pos++]))<<3,e<128)return Sc(a,d,b);if(d|=(127&(e=f[c.pos++]))<<10,e<128)return Sc(a,d,b);if(d|=(127&(e=f[c.pos++]))<<17,e<128)return Sc(a,d,b);if(d|=(127&(e=f[c.pos++]))<<24,e<128)return Sc(a,d,b);if(d|=(1&(e=f[c.pos++]))<<31,e<128)return Sc(a,d,b);throw new Error("Expected varint not more than 10 bytes")}(b|=(15&(c=d[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,b=function(a,b,c){for(var d="",e=b;e<c;){var f,g,h,i=a[e],j=null,k=i>239?4:i>223?3:i>191?2:1;if(e+k>c)break;1===k?i<128&&(j=i):2===k?128==(192&(f=a[e+1]))&&(j=(31&i)<<6|63&f)<=127&&(j=null):3===k?(f=a[e+1],g=a[e+2],128==(192&f)&&128==(192&g)&&((j=(15&i)<<12|(63&f)<<6|63&g)<=2047||j>=55296&&j<=57343)&&(j=null)):4===k&&(f=a[e+1],g=a[e+2],h=a[e+3],128==(192&f)&&128==(192&g)&&128==(192&h)&&((j=(15&i)<<18|(63&f)<<12|(63&g)<<6|63&h)<=65535||j>=1114112)&&(j=null)),null===j?(j=65533,k=1):j>65535&&(j-=65536,d+=String.fromCharCode(j>>>10&1023|55296),j=56320|1023&j),d+=String.fromCharCode(j),e+=k}return d}(this.buf,this.pos,a);return this.pos=a,b},readBytes:function(){var a=this.readVarint()+this.pos,b=this.buf.subarray(this.pos,a);return this.pos=a,b},readPackedVarint:function(a,b){if(this.type!==Qc.Bytes)return a.push(this.readVarint(b));var c=Rc(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(b));return a},readPackedSVarint:function(a){if(this.type!==Qc.Bytes)return a.push(this.readSVarint());var b=Rc(this);for(a=a||[];this.pos<b;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Qc.Bytes)return a.push(this.readBoolean());var b=Rc(this);for(a=a||[];this.pos<b;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Qc.Bytes)return a.push(this.readFloat());var b=Rc(this);for(a=a||[];this.pos<b;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Qc.Bytes)return a.push(this.readDouble());var b=Rc(this);for(a=a||[];this.pos<b;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Qc.Bytes)return a.push(this.readFixed32());var b=Rc(this);for(a=a||[];this.pos<b;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Qc.Bytes)return a.push(this.readSFixed32());var b=Rc(this);for(a=a||[];this.pos<b;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Qc.Bytes)return a.push(this.readFixed64());var b=Rc(this);for(a=a||[];this.pos<b;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Qc.Bytes)return a.push(this.readSFixed64());var b=Rc(this);for(a=a||[];this.pos<b;)a.push(this.readSFixed64());return a},skip:function(a){var b=7&a;if(b===Qc.Varint)for(;this.buf[this.pos++]>127;);else if(b===Qc.Bytes)this.pos=this.readVarint()+this.pos;else if(b===Qc.Fixed32)this.pos+=4;else{if(b!==Qc.Fixed64)throw new Error("Unimplemented type: "+b);this.pos+=8}},writeTag:function(a,b){this.writeVarint(a<<3|b)},realloc:function(a){for(var b=this.length||16;b<this.pos+a;)b*=2;if(b!==this.length){var c=new Uint8Array(b);c.set(this.buf),this.buf=c,this.length=b}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),cd(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),cd(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),cd(this.buf,-1&a,this.pos),cd(this.buf,Math.floor(a*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),cd(this.buf,-1&a,this.pos),cd(this.buf,Math.floor(a*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(a,b){var c,d;if(a>=0?(c=a%4294967296|0,d=a/4294967296|0):(d=~(-a/4294967296),4294967295^(c=~(-a%4294967296))?c=c+1|0:(c=0,d=d+1|0)),a>=0x10000000000000000||a<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");b.realloc(10),function(a,b,c){c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos]=127&a}(c,0,b),function(a,b){var c=(7&a)<<4;b.buf[b.pos++]|=c|((a>>>=3)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a)))))}(d,b)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var b=this.pos;this.pos=function(a,b,c){for(var d,e,f=0;f<b.length;f++){if((d=b.charCodeAt(f))>55295&&d<57344){if(!e){d>56319||f+1===b.length?(a[c++]=239,a[c++]=191,a[c++]=189):e=d;continue}if(d<56320){a[c++]=239,a[c++]=191,a[c++]=189,e=d;continue}d=e-55296<<10|d-56320|65536,e=null}else e&&(a[c++]=239,a[c++]=191,a[c++]=189,e=null);d<128?a[c++]=d:(d<2048?a[c++]=d>>6|192:(d<65536?a[c++]=d>>12|224:(a[c++]=d>>18|240,a[c++]=d>>12&63|128),a[c++]=d>>6&63|128),a[c++]=63&d|128)}return c}(this.buf,a,this.pos);var c=this.pos-b;c>=128&&Tc(b,c,this),this.pos=b-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),Ni(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),Ni(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var b=a.length;this.writeVarint(b),this.realloc(b);for(var c=0;c<b;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,b){this.pos++;var c=this.pos;a(b,this);var d=this.pos-c;d>=128&&Tc(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,b,c){this.writeTag(a,Qc.Bytes),this.writeRawMessage(b,c)},writePackedVarint:function(a,b){b.length&&this.writeMessage(a,Uc,b)},writePackedSVarint:function(a,b){b.length&&this.writeMessage(a,Vc,b)},writePackedBoolean:function(a,b){b.length&&this.writeMessage(a,Yc,b)},writePackedFloat:function(a,b){b.length&&this.writeMessage(a,Wc,b)},writePackedDouble:function(a,b){b.length&&this.writeMessage(a,Xc,b)},writePackedFixed32:function(a,b){b.length&&this.writeMessage(a,Zc,b)},writePackedSFixed32:function(a,b){b.length&&this.writeMessage(a,$c,b)},writePackedFixed64:function(a,b){b.length&&this.writeMessage(a,_c,b)},writePackedSFixed64:function(a,b){b.length&&this.writeMessage(a,ad,b)},writeBytesField:function(a,b){this.writeTag(a,Qc.Bytes),this.writeBytes(b)},writeFixed32Field:function(a,b){this.writeTag(a,Qc.Fixed32),this.writeFixed32(b)},writeSFixed32Field:function(a,b){this.writeTag(a,Qc.Fixed32),this.writeSFixed32(b)},writeFixed64Field:function(a,b){this.writeTag(a,Qc.Fixed64),this.writeFixed64(b)},writeSFixed64Field:function(a,b){this.writeTag(a,Qc.Fixed64),this.writeSFixed64(b)},writeVarintField:function(a,b){this.writeTag(a,Qc.Varint),this.writeVarint(b)},writeSVarintField:function(a,b){this.writeTag(a,Qc.Varint),this.writeSVarint(b)},writeStringField:function(a,b){this.writeTag(a,Qc.Bytes),this.writeString(b)},writeFloatField:function(a,b){this.writeTag(a,Qc.Fixed32),this.writeFloat(b)},writeDoubleField:function(a,b){this.writeTag(a,Qc.Fixed64),this.writeDouble(b)},writeBooleanField:function(a,b){this.writeVarintField(a,Boolean(b))}};var Pi=3,Qi=Pi,Ri=function(a){var b=this;this._callback=a,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){b._triggered=!1,b._callback()})};Ri.prototype.trigger=function(){var a=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){a._triggered=!1,a._callback()},0))};var Si=function(a,b,c){this.target=a,this.parent=b,this.mapId=c,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},m(["receive","process"],this),this.invoker=new Ri(this.process),this.target.addEventListener("message",this.receive,!1)}
;Si.prototype.send=function(a,b,c,d){var e=this,f=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(this.callbacks[f]=c);var g=[];return this.target.postMessage({id:f,type:a,hasCallback:!!c,targetMapId:d,sourceMapId:this.mapId,data:bb(b,g)},g),{cancel:function(){c&&delete e.callbacks[f],e.target.postMessage({id:f,type:"<cancel>",targetMapId:d,sourceMapId:e.mapId})}}},Si.prototype.receive=function(a){var b=a.data,c=b.id;if(c&&(!b.targetMapId||this.mapId===b.targetMapId))if("<cancel>"===b.type){delete this.tasks[c];var d=this.cancelCallbacks[c];delete this.cancelCallbacks[c],d&&d()}else this.tasks[c]=b,this.taskQueue.push(c),this.invoker.trigger()},Si.prototype.process=function(){var a=this;if(this.taskQueue.length){var b=this.taskQueue.shift(),c=this.tasks[b];if(delete this.tasks[b],this.taskQueue.length&&this.invoker.trigger(),c)if("<response>"===c.type){var d=this.callbacks[b];delete this.callbacks[b],d&&(c.error?d(cb(c.error)):d(null,cb(c.data)))}else{var e=!1,f=c.hasCallback?function(c,d){e=!0,delete a.cancelCallbacks[b];var f=[];a.target.postMessage({id:b,type:"<response>",sourceMapId:a.mapId,error:c?bb(c):null,data:bb(d,f)},f)}:function(a){e=!0},g=null,h=cb(c.data);if(this.parent[c.type])g=this.parent[c.type](c.sourceMapId,h,f);else if(this.parent.getWorkerSource){var i=c.type.split(".");g=this.parent.getWorkerSource(c.sourceMapId,i[0],h.source)[i[1]](h,f)}else f(new Error("Could not find function "+c.type));!e&&g&&g.cancel&&(this.cancelCallbacks[b]=g.cancel)}}},Si.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var Ti=function(a,b){a&&(b?this.setSouthWest(a).setNorthEast(b):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))};Ti.prototype.setNorthEast=function(a){return this._ne=a instanceof Ui?new Ui(a.lng,a.lat):Ui.convert(a),this},Ti.prototype.setSouthWest=function(a){return this._sw=a instanceof Ui?new Ui(a.lng,a.lat):Ui.convert(a),this},Ti.prototype.extend=function(a){var b,c,d=this._sw,e=this._ne;if(a instanceof Ui)b=a,c=a;else{if(!(a instanceof Ti))return Array.isArray(a)?a.every(Array.isArray)?this.extend(Ti.convert(a)):this.extend(Ui.convert(a)):this;if(b=a._sw,c=a._ne,!b||!c)return this}return d||e?(d.lng=Math.min(b.lng,d.lng),d.lat=Math.min(b.lat,d.lat),e.lng=Math.max(c.lng,e.lng),e.lat=Math.max(c.lat,e.lat)):(this._sw=new Ui(b.lng,b.lat),this._ne=new Ui(c.lng,c.lat)),this},Ti.prototype.getCenter=function(){return new Ui((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ti.prototype.getSouthWest=function(){return this._sw},Ti.prototype.getNorthEast=function(){return this._ne},Ti.prototype.getNorthWest=function(){return new Ui(this.getWest(),this.getNorth())},Ti.prototype.getSouthEast=function(){return new Ui(this.getEast(),this.getSouth())},Ti.prototype.getWest=function(){return this._sw.lng},Ti.prototype.getSouth=function(){return this._sw.lat},Ti.prototype.getEast=function(){return this._ne.lng},Ti.prototype.getNorth=function(){return this._ne.lat},Ti.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ti.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ti.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ti.convert=function(a){return!a||a instanceof Ti?a:new Ti(a)};var Ui=function(a,b){if(isNaN(a)||isNaN(b))throw new Error("Invalid LngLat object: ("+a+", "+b+")");if(this.lng=+a,this.lat=+b,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ui.prototype.wrap=function(){return new Ui(h(this.lng,-180,180),this.lat)},Ui.prototype.toArray=function(){return[this.lng,this.lat]},Ui.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ui.prototype.toBounds=function(a){void 0===a&&(a=0);var b=360*a/40075017,c=b/Math.cos(Math.PI/180*this.lat);return new Ti(new Ui(this.lng-c,this.lat-b),new Ui(this.lng+c,this.lat+b))},Ui.convert=function(a){if(a instanceof Ui)return a;if(Array.isArray(a)&&(2===a.length||3===a.length))return new Ui(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&"object"==typeof a&&null!==a)return new Ui(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Vi=2*Math.PI*6378137,Wi=function(a,b,c){void 0===c&&(c=0),this.x=+a,this.y=+b,this.z=+c};Wi.fromLngLat=function(a,b){void 0===b&&(b=0);var c=Ui.convert(a);return new Wi(jd(c.lng),kd(c.lat),ld(b,c.lat))},Wi.prototype.toLngLat=function(){return new Ui(360*this.x-180,md(this.y))},Wi.prototype.toAltitude=function(){return this.z*id(md(this.y))},Wi.prototype.meterInMercatorCoordinateUnits=function(){return 1/Vi*(a=md(this.y),1/Math.cos(a*Math.PI/180));var a};var Xi=function(a,b,c){this.z=a,this.x=b,this.y=c,this.key=nd(0,a,b,c)};Xi.prototype.equals=function(a){return this.z===a.z&&this.x===a.x&&this.y===a.y},Xi.prototype.url=function(a,b){var c,d,e,f,g,h=(c=this.x,d=this.y,e=this.z,f=hd(256*c,256*(d=Math.pow(2,e)-d-1),e),g=hd(256*(c+1),256*(d+1),e),f[0]+","+f[1]+","+g[0]+","+g[1]),i=function(a,b,c){for(var d,e="",f=a;f>0;f--)e+=(b&(d=1<<f-1)?1:0)+(c&d?2:0);return e}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===b?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",i).replace("{bbox-epsg-3857}",h)},Xi.prototype.getTilePoint=function(a){var b=Math.pow(2,this.z);return new Gd((a.x*b-this.x)*ph,(a.y*b-this.y)*ph)};var Yi=function(a,b){this.wrap=a,this.canonical=b,this.key=nd(a,b.z,b.x,b.y)},Zi=function(a,b,c,d,e){this.overscaledZ=a,this.wrap=b,this.canonical=new Xi(c,+d,+e),this.key=nd(b,a,d,e)};Zi.prototype.equals=function(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)},Zi.prototype.scaledTo=function(a){var b=this.canonical.z-a;return a>this.canonical.z?new Zi(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Zi(a,this.wrap,a,this.canonical.x>>b,this.canonical.y>>b)},Zi.prototype.isChildOf=function(a){if(a.wrap!==this.wrap)return!1;var b=this.canonical.z-a.canonical.z;return 0===a.overscaledZ||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>b&&a.canonical.y===this.canonical.y>>b},Zi.prototype.children=function(a){if(this.overscaledZ>=a)return[new Zi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var b=this.canonical.z+1,c=2*this.canonical.x,d=2*this.canonical.y;return[new Zi(b,this.wrap,b,c,d),new Zi(b,this.wrap,b,c+1,d),new Zi(b,this.wrap,b,c,d+1),new Zi(b,this.wrap,b,c+1,d+1)]},Zi.prototype.isLessThan=function(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))},Zi.prototype.wrapped=function(){return new Zi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Zi.prototype.unwrapTo=function(a){return new Zi(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)},Zi.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Zi.prototype.toUnwrapped=function(){return new Yi(this.wrap,this.canonical)},Zi.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Zi.prototype.getTilePoint=function(a){return this.canonical.getTilePoint(new Wi(a.x-this.wrap,a.y))},ab("CanonicalTileID",Xi),ab("OverscaledTileID",Zi,{omit:["posMatrix"]});var $i=function(a,b,c){if(this.uid=a,b.height!==b.width)throw new RangeError("DEM tiles must be square");if(c&&"mapbox"!==c&&"terrarium"!==c)return r('"'+c+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');var d=this.dim=b.height;this.stride=this.dim+2,this.data=new Int32Array(this.stride*this.stride);for(var e=b.data,f="terrarium"===c?this._unpackTerrarium:this._unpackMapbox,g=0;g<d;g++)for(var h=0;h<d;h++){var i=4*(g*d+h);this.set(h,g,f(e[i],e[i+1],e[i+2]))}for(var j=0;j<d;j++)this.set(-1,j,this.get(0,j)),this.set(d,j,this.get(d-1,j)),this.set(j,-1,this.get(j,0)),this.set(j,d,this.get(j,d-1));this.set(-1,-1,this.get(0,0)),this.set(d,-1,this.get(d-1,0)),this.set(-1,d,this.get(0,d-1)),this.set(d,d,this.get(d-1,d-1))};$i.prototype.set=function(a,b,c){this.data[this._idx(a,b)]=c+65536},$i.prototype.get=function(a,b){return this.data[this._idx(a,b)]-65536},$i.prototype._idx=function(a,b){if(a<-1||a>=this.dim+1||b<-1||b>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(b+1)*this.stride+(a+1)},$i.prototype._unpackMapbox=function(a,b,c){return(256*a*256+256*b+c)/10-1e4},$i.prototype._unpackTerrarium=function(a,b,c){return 256*a+b+c/256-32768},$i.prototype.getPixels=function(){return new zh({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},$i.prototype.backfillBorder=function(a,b,c){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");var d=b*this.dim,e=b*this.dim+this.dim,f=c*this.dim,g=c*this.dim+this.dim;switch(b){case-1:d=e-1;break;case 1:e=d+1}switch(c){case-1:f=g-1;break;case 1:g=f+1}for(var h=-b*this.dim,i=-c*this.dim,j=f;j<g;j++)for(var k=d;k<e;k++)this.set(k,j,a.get(k+h,j+i))},ab("DEMData",$i);var _i=ib([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),aj=function(a){this._stringToNumber={},this._numberToString=[];for(var b=0;b<a.length;b++){var c=a[b];this._stringToNumber[c]=b,this._numberToString[b]=c}};aj.prototype.encode=function(a){return this._stringToNumber[a]},aj.prototype.decode=function(a){return this._numberToString[a]};var bj=function(a,b,c,d){this.type="Feature",this._vectorTileFeature=a,a._z=b,a._x=c,a._y=d,this.properties=a.properties,null!=a.id&&(this.id=a.id)},cj={geometry:{configurable:!0}};cj.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},cj.geometry.set=function(a){this._geometry=a},bj.prototype.toJSON=function(){var a={geometry:this.geometry};for(var b in this)"_geometry"!==b&&"_vectorTileFeature"!==b&&(a[b]=this[b]);return a},Object.defineProperties(bj.prototype,cj);var dj=function(){this.state={},this.stateChanges={},this.deletedStates={}};dj.prototype.updateState=function(a,b,c){var d=String(b);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][d]=this.stateChanges[a][d]||{},i(this.stateChanges[a][d],c),null===this.deletedStates[a])for(var e in this.deletedStates[a]={},this.state[a])e!==d&&(this.deletedStates[a][e]=null);else if(this.deletedStates[a]&&null===this.deletedStates[a][d])for(var f in this.deletedStates[a][d]={},this.state[a][d])c[f]||(this.deletedStates[a][d][f]=null);else for(var g in c)this.deletedStates[a]&&this.deletedStates[a][d]&&null===this.deletedStates[a][d][g]&&delete this.deletedStates[a][d][g]},dj.prototype.removeFeatureState=function(a,b,c){if(null!==this.deletedStates[a]){var d=String(b);if(this.deletedStates[a]=this.deletedStates[a]||{},c&&void 0!==b&&b>=0)null!==this.deletedStates[a][d]&&(this.deletedStates[a][d]=this.deletedStates[a][d]||{},this.deletedStates[a][d][c]=null);else if(void 0!==b&&b>=0)if(this.stateChanges[a]&&this.stateChanges[a][d])for(c in this.deletedStates[a][d]={},this.stateChanges[a][d])this.deletedStates[a][d][c]=null;else this.deletedStates[a][d]=null;else this.deletedStates[a]=null}},dj.prototype.getState=function(a,b){var c=String(b),d=this.state[a]||{},e=this.stateChanges[a]||{},f=i({},d[c],e[c]);if(null===this.deletedStates[a])return{};if(this.deletedStates[a]){var g=this.deletedStates[a][b];if(null===g)return{};for(var h in g)delete f[h]}return f},dj.prototype.initializeTileState=function(a,b){a.setFeatureState(this.state,b)},dj.prototype.coalesceChanges=function(a,b){var c={};for(var d in this.stateChanges){this.state[d]=this.state[d]||{};var e={};for(var f in this.stateChanges[d])this.state[d][f]||(this.state[d][f]={}),i(this.state[d][f],this.stateChanges[d][f]),e[f]=this.state[d][f];c[d]=e}for(var g in this.deletedStates){this.state[g]=this.state[g]||{};var h={};if(null===this.deletedStates[g])for(var j in this.state[g])h[j]={},this.state[g][j]={};else for(var k in this.deletedStates[g]){if(null===this.deletedStates[g][k])this.state[g][k]={};else for(var l=0,m=Object.keys(this.deletedStates[g][k]);l<m.length;l+=1){var n=m[l];delete this.state[g][k][n]}h[k]=this.state[g][k]}c[g]=c[g]||{},i(c[g],h)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(c).length)for(var o in a)a[o].setFeatureState(c,b)};var ej=function(a,b,c){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=b||new Nf(ph,16,0),this.grid3D=new Nf(ph,16,0),this.featureIndexArray=c||new Xg};ej.prototype.insert=function(a,b,c,d,e,f){var g=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,d,e);for(var h=f?this.grid3D:this.grid,i=0;i<b.length;i++){for(var j=b[i],k=[1/0,1/0,-1/0,-1/0],l=0;l<j.length;l++){var m=j[l];k[0]=Math.min(k[0],m.x),k[1]=Math.min(k[1],m.y),k[2]=Math.max(k[2],m.x),k[3]=Math.max(k[3],m.y)}k[0]<ph&&k[1]<ph&&k[2]>=0&&k[3]>=0&&h.insert(g,k[0],k[1],k[2],k[3])}},ej.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Oh.VectorTile(new Oi(this.rawTileData)).layers,this.sourceLayerCoder=new aj(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},ej.prototype.query=function(a,b,c){var d=this;this.loadVTLayers();for(var e=a.params||{},f=ph/a.tileSize/a.scale,g=Ga(e.filter),h=a.queryGeometry,i=a.queryPadding*f,j=od(h),k=this.grid.query(j.minX-i,j.minY-i,j.maxX+i,j.maxY+i),l=od(a.cameraQueryGeometry),m=0,n=this.grid3D.query(l.minX-i,l.minY-i,l.maxX+i,l.maxY+i,function(b,c,d,e){return function(a,b,c,d,e){for(var f=0,g=a;f<g.length;f+=1){var h=g[f];if(b<=h.x&&c<=h.y&&d>=h.x&&e>=h.y)return!0}var i=[new Gd(b,c),new Gd(b,e),new Gd(d,e),new Gd(d,c)];if(a.length>2)for(var j=0,k=i;j<k.length;j+=1)if(Ab(a,k[j]))return!0;for(var l=0;l<a.length-1;l++)if(Bb(a[l],a[l+1],i))return!0;return!1}(a.cameraQueryGeometry,b-i,c-i,d+i,e+i)});m<n.length;m+=1){var o=n[m];k.push(o)}k.sort(pd);for(var p,q={},r=0;r<k.length;r++)!function(i){var j=k[i];if(j!==p){p=j;var l=d.featureIndexArray.get(j),m=null;d.loadMatchingFeature(q,l.bucketIndex,l.sourceLayerIndex,l.featureIndex,g,e.layers,b,function(b,e){m||(m=pb(b));var g={};return b.id&&(g=c.getState(e.sourceLayer||"_geojsonTileLayer",b.id)),e.queryIntersectsFeature(h,b,g,m,d.z,a.transform,f,a.pixelPosMatrix)})}}(r);return q},ej.prototype.loadMatchingFeature=function(a,b,c,d,e,f,g,h){var i=this.bucketLayerIDs[b];if(!f||function(a,b){for(var c=0;c<a.length;c++)if(b.indexOf(a[c])>=0)return!0;return!1}(f,i)){var j=this.sourceLayerCoder.decode(c),k=this.vtLayers[j].feature(d);if(e(new $f(this.tileID.overscaledZ),k))for(var l=0;l<i.length;l++){var m=i[l];if(!(f&&f.indexOf(m)<0)){var n=g[m];if(n){var o=!h||h(k,n);if(o){var p=new bj(k,this.z,this.x,this.y);p.layer=n.serialize();var q=a[m];void 0===q&&(q=a[m]=[]),q.push({featureIndex:d,feature:p,intersectionZ:o})}}}}}},ej.prototype.lookupSymbolFeatures=function(a,b,c,d,e,f){var g={};this.loadVTLayers();for(var h=Ga(d),i=0,j=a;i<j.length;i+=1){var k=j[i];this.loadMatchingFeature(g,b,c,k,h,e,f)}return g},ej.prototype.hasLayer=function(a){for(var b=0,c=this.bucketLayerIDs;b<c.length;b+=1)for(var d=0,e=c[b];d<e.length;d+=1)if(a===e[d])return!0;return!1},ab("FeatureIndex",ej,{omit:["rawTileData","sourceLayerCoder"]});var fj=function(a,b){this.tileID=a,this.uid=j(),this.uses=0,this.tileSize=b,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.expiredRequestCount=0,this.state="loading"};fj.prototype.registerFadeDuration=function(a){var b=a+this.timeAdded;b<Rd.now()||this.fadeEndTime&&b<this.fadeEndTime||(this.fadeEndTime=b)},fj.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},fj.prototype.loadVectorData=function(a,b,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){for(var d in a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(a,b){var c={};if(!b)return c;for(var d=0,e=a;d<e.length;d+=1)!function(){var a=e[d],f=a.layerIds.map(function(a){return b.getLayer(a)}).filter(Boolean);if(0!==f.length){a.layers=f,a.stateDependentLayerIds&&(a.stateDependentLayers=a.stateDependentLayerIds.map(function(a){return f.filter(function(b){return b.id===a})[0]}));for(var g=0,h=f;g<h.length;g+=1){var i=h[g];c[i.id]=a}}}();return c}(a.buckets,b.style),this.hasSymbolBuckets=!1,this.buckets){var e=this.buckets[d];if(e instanceof ti){if(this.hasSymbolBuckets=!0,!c)break;e.justReloaded=!0}}for(var f in this.queryPadding=0,this.buckets){var g=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,b.style.getLayer(f).queryRadius(g))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new Ng},fj.prototype.unloadVectorData=function(){for(var a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},fj.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},fj.prototype.getBucket=function(a){return this.buckets[a.id]},fj.prototype.upload=function(a){for(var b in this.buckets){var c=this.buckets[b];c.uploadPending()&&c.upload(a)}var d=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Li(a,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Li(a,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)},fj.prototype.prepare=function(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)},fj.prototype.queryRenderedFeatures=function(a,b,c,d,e,f,g,h,i){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:c,cameraQueryGeometry:d,scale:e,tileSize:this.tileSize,pixelPosMatrix:i,transform:g,params:f,queryPadding:this.queryPadding*h},a,b):{}},fj.prototype.querySourceFeatures=function(a,b){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var c=this.latestFeatureIndex.loadVTLayers(),d=b?b.sourceLayer:"",e=c._geojsonTileLayer||c[d];if(e)for(var f=Ga(b&&b.filter),g=this.tileID.canonical,h=g.z,i=g.x,j=g.y,k={z:h,x:i,y:j},l=0;l<e.length;l++){var m=e.feature(l);if(f(new $f(this.tileID.overscaledZ),m)){var n=new bj(m,h,i,j);n.tile=k,a.push(n)}}}},fj.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},fj.prototype.setMask=function(a,b){if(!e(this.mask,a)&&(this.mask=a,this.clearMask(),!e(a,{0:!0}))){var c=new sg,d=new Hg;this.segments=new Zg,this.segments.prepareSegment(0,c,d);for(var f=Object.keys(a),g=0;g<f.length;g++){var h=a[+f[g]],i=ph>>h.z,j=new Gd(h.x*i,h.y*i),k=new Gd(j.x+i,j.y+i),l=this.segments.prepareSegment(4,c,d);c.emplaceBack(j.x,j.y,j.x,j.y),c.emplaceBack(k.x,j.y,k.x,j.y),c.emplaceBack(j.x,k.y,j.x,k.y),c.emplaceBack(k.x,k.y,k.x,k.y);var m=l.vertexLength;d.emplaceBack(m,m+1,m+2),d.emplaceBack(m+1,m+2,m+3),l.vertexLength+=4,l.primitiveLength+=2}this.maskedBoundsBuffer=b.createVertexBuffer(c,_i.members),this.maskedIndexBuffer=b.createIndexBuffer(d)}},fj.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},fj.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},fj.prototype.setExpiryData=function(a){var b=this.expirationTime;if(a.cacheControl){var c=u(a.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){var d=Date.now(),e=!1;if(this.expirationTime>d)e=!1;else if(b)if(this.expirationTime<b)e=!0;else{var f=this.expirationTime-b;f?this.expirationTime=d+Math.max(f,3e4):e=!0}else e=!0;e?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},fj.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},fj.prototype.setFeatureState=function(a,b){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(a).length){var c=this.latestFeatureIndex.loadVTLayers();for(var d in this.buckets){var e=this.buckets[d],f=e.layers[0].sourceLayer||"_geojsonTileLayer",g=c[f],h=a[f];g&&h&&0!==Object.keys(h).length&&(e.update(h,g,this.imageAtlas&&this.imageAtlas.patternPositions||{}),b&&b.style&&(this.queryPadding=Math.max(this.queryPadding,b.style.getLayer(d).queryRadius(e))))}}},fj.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},fj.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Rd.now()},fj.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},fj.prototype.setHoldDuration=function(a){this.symbolFadeHoldUntil=Rd.now()+a};var gj=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=g.top*h-i,n=g.bottom*h+i,o=g.left*h-i,p=g.right*h+i;if(this.boxStartIndex=a.length,j){var q=n-m,r=p-o;q>0&&(q=Math.max(10*h,q),this._addLineCollisionCircles(a,b,c,c.segment,r,q,d,e,f,k))}else{if(l){var s=new Gd(o,m),t=new Gd(p,m),u=new Gd(o,n),v=new Gd(p,n),w=l*Math.PI/180;s._rotate(w),t._rotate(w),u._rotate(w),v._rotate(w),o=Math.min(s.x,t.x,u.x,v.x),p=Math.max(s.x,t.x,u.x,v.x),m=Math.min(s.y,t.y,u.y,v.y),n=Math.max(s.y,t.y,u.y,v.y)}a.emplaceBack(c.x,c.y,o,m,p,n,d,e,f,0,0)}this.boxEndIndex=a.length};gj.prototype._addLineCollisionCircles=function(a,b,c,d,e,f,g,h,i,j){var k=f/2,l=Math.floor(e/k)||1,m=1+.4*Math.log(j)/Math.LN2,n=Math.floor(l*m/2),o=-f/2,p=c,q=d+1,r=o,s=-e/2,t=s-e/4;do{if(--q<0){if(r>s)return;q=0;break}r-=b[q].dist(p),p=b[q]}while(r>t);for(var u=b[q].dist(b[q+1]),v=-n;v<l+n;v++){var w=v*k,x=s+w;if(w<0&&(x+=w),w>e&&(x+=w-e),!(x<r)){for(;r+u<x;){if(r+=u,++q+1>=b.length)return;u=b[q].dist(b[q+1])}var y=x-r,z=b[q],A=b[q+1].sub(z)._unit()._mult(y)._add(z)._round(),B=Math.abs(x-o)<k?0:.8*(x-o);a.emplaceBack(A.x,A.y,-f/2,-f/2,f/2,f/2,g,h,i,f/2,B)}}};var hj=function(a,b){if(void 0===a&&(a=[]),void 0===b&&(b=wd),this.data=a,this.length=this.data.length,this.compare=b,this.length>0)for(var c=(this.length>>1)-1;c>=0;c--)this._down(c)};hj.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},hj.prototype.pop=function(){if(0!==this.length){var a=this.data[0],b=this.data.pop();return this.length--,this.length>0&&(this.data[0]=b,this._down(0)),a}},hj.prototype.peek=function(){return this.data[0]},hj.prototype._up=function(a){for(var b=this.data,c=this.compare,d=b[a];a>0;){var e=a-1>>1,f=b[e];if(c(d,f)>=0)break;b[a]=f,a=e}b[a]=d},hj.prototype._down=function(a){for(var b=this.data,c=this.compare,d=this.length>>1,e=b[a];a<d;){var f=1+(a<<1),g=b[f],h=f+1;if(h<this.length&&c(b[h],g)<0&&(f=h,g=b[h]),c(g,e)>=0)break;b[a]=g,a=f}b[a]=e};var ij=b(function(a){a.exports=function(a,b){var c,d,e,f,g,h,i,j;for(c=3&a.length,d=a.length-c,e=b,g=3432918353,h=461845907,j=0;j<d;)i=255&a.charCodeAt(j)|(255&a.charCodeAt(++j))<<8|(255&a.charCodeAt(++j))<<16|(255&a.charCodeAt(++j))<<24,++j,e=27492+(65535&(f=5*(65535&(e=(e^=i=(65535&(i=(i=(65535&i)*g+(((i>>>16)*g&65535)<<16)&4294967295)<<15|i>>>17))*h+(((i>>>16)*h&65535)<<16)&4294967295)<<13|e>>>19))+((5*(e>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(i=0,c){case 3:i^=(255&a.charCodeAt(j+2))<<16;case 2:i^=(255&a.charCodeAt(j+1))<<8;case 1:e^=i=(65535&(i=(i=(65535&(i^=255&a.charCodeAt(j)))*g+(((i>>>16)*g&65535)<<16)&4294967295)<<15|i>>>17))*h+(((i>>>16)*h&65535)<<16)&4294967295}return e^=a.length,e=2246822507*(65535&(e^=e>>>16))+((2246822507*(e>>>16)&65535)<<16)&4294967295,e=3266489909*(65535&(e^=e>>>13))+((3266489909*(e>>>16)&65535)<<16)&4294967295,(e^=e>>>16)>>>0}}),jj=b(function(a){a.exports=function(a,b){for(var c,d=a.length,e=b^d,f=0;d>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(f)|(255&a.charCodeAt(++f))<<8|(255&a.charCodeAt(++f))<<16|(255&a.charCodeAt(++f))<<24))+((1540483477*(c>>>16)&65535)<<16),e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++f;switch(d){case 3:e^=(255&a.charCodeAt(f+2))<<16;case 2:e^=(255&a.charCodeAt(f+1))<<8;case 1:e=1540483477*(65535&(e^=255&a.charCodeAt(f)))+((1540483477*(e>>>16)&65535)<<16)}return e=1540483477*(65535&(e^=e>>>13))+((1540483477*(e>>>16)&65535)<<16),(e^=e>>>15)>>>0}}),kj=ij,lj=ij,mj=jj;kj.murmur3=lj,kj.murmur2=mj;var nj=7,oj=65535;a.Actor=Si,a.AlphaImage=yh,a.CanonicalTileID=Xi,a.CollisionBoxArray=Ng,a.Color=Ke,a.DEMData=$i,a.DataConstantProperty=hg,a.DictionaryCoder=aj,a.EXTENT=ph,a.ErrorEvent=te,a.EvaluationParameters=$f,a.Event=se,a.Evented=ue,a.FeatureIndex=ej,a.FillBucket=Hh,a.FillExtrusionBucket=Rh,a.ImageAtlas=Gi,a.ImagePosition=Ei,a.LineBucket=Yh,a.LngLat=Ui,a.LngLatBounds=Ti,a.MercatorCoordinate=Wi,a.ONE_EM=hi,a.OverscaledTileID=Zi,a.Point=Gd,a.Point$1=Gd,a.ProgramConfiguration=nh,a.Properties=mg,a.Protobuf=Oi,a.RGBAImage=zh,a.RequestManager=Wd,a.ResourceType=je,a.SegmentVector=Zg,a.SourceFeatureState=dj,a.StructArrayLayout1ui2=Jg,a.StructArrayLayout2i4=rg,a.StructArrayLayout2ui4=Ig,a.StructArrayLayout3ui6=Hg,a.StructArrayLayout4i8=sg,a.SymbolBucket=ti,a.Texture=Li,a.Tile=fj,a.Transitionable=bg,a.Uniform1f=bh,a.Uniform1i=ah,a.Uniform2f=ch,a.Uniform3f=dh,a.Uniform4f=eh,a.UniformColor=fh,a.UniformMatrix4f=hh,a.UnwrappedTileID=Yi,a.ValidationError=we,a.WritingMode=ii,a.ZoomHistory=Sf,a.addDynamicAttributes=Oc,a.asyncAll=function(a,b,c){if(!a.length)return c(null,[]);var d=a.length,e=new Array(a.length),f=null;a.forEach(function(a,g){b(a,function(a,b){a&&(f=a),e[g]=b,0==--d&&c(f,e)})})},a.bezier=f,a.bindAll=m,a.browser=Rd,a.cacheEntryPossiblyAdded=function(a){++ie>ge&&(a.getActor().send("enforceCacheSizeLimit",fe),ie=0)},a.clamp=g,a.clearTileCache=function(a){var b=self.caches.delete(ee);a&&b.catch(a).then(function(){return a()})},a.clone=function(a){var b=new vh(16);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},a.clone$1=q,a.config=Sd,a.create=function(){var a=new vh(16);return vh!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},a.create$1=function(){var a=new vh(9);return vh!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a},a.create$2=function(){var a=new vh(4);return vh!=Float32Array&&(a[1]=0,a[2]=0),a[0]=1,a[3]=1,a},a.createCommonjsModule=b,a.createExpression=xa,a.createLayout=ib,a.createStyleLayer=function(a){return"custom"===a.type?new Ci(a):new Di[a.type](a)},a.deepEqual=e,a.ease=Ld,a.emitValidationErrors=$a,a.endsWith=n,a.enforceCacheSizeLimit=function(a){self.caches&&self.caches.open(ee).then(function(b){b.keys().then(function(c){for(var d=0;d<c.length-a;d++)b.delete(c[d])})})},a.evaluateRadialOffset=Ad,a.evaluateSizeForFeature=Lc,a.evaluateSizeForZoom=Mc,a.evented=Yf,a.extend=i,a.featureFilter=Ga,a.filterObject=p,a.fromRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=c,a[2]=0,a[3]=-c,a[4]=d,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},a.getAnchorAlignment=Ic,a.getAnchorJustification=Bd,a.getArrayBuffer=pe,a.getImage=re,a.getJSON=function(a,b){return oe(i(a,{type:"json"}),b)},a.getReferrer=ne,a.getVideo=function(a,b){var c,d,e=self.document.createElement("video");e.muted=!0,e.onloadstart=function(){b(null,e)};for(var f=0;f<a.length;f++){var g=self.document.createElement("source");c=a[f],d=void 0,(d=self.document.createElement("a")).href=c,(d.protocol!==self.document.location.protocol||d.host!==self.document.location.host)&&(e.crossOrigin="Anonymous"),g.src=a[f],e.appendChild(g)}return{cancel:function(){}}},a.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},a.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(h*D-i*C+j*B)*E,a[1]=(e*C-d*D-f*B)*E,a[2]=(p*x-q*w+r*v)*E,a[3]=(m*w-l*x-n*v)*E,a[4]=(i*A-g*D-j*z)*E,a[5]=(c*D-e*A+f*z)*E,a[6]=(q*u-o*x-r*t)*E,a[7]=(k*x-m*u+n*t)*E,a[8]=(g*C-h*A+j*y)*E,a[9]=(d*A-c*C-f*y)*E,a[10]=(o*w-p*u+r*s)*E,a[11]=(l*u-k*w-n*s)*E,a[12]=(h*z-g*B-i*y)*E,a[13]=(c*B-d*z+e*y)*E,a[14]=(p*t-o*v-q*s)*E,a[15]=(k*v-l*t+m*s)*E,a):null},a.isChar=Uf,a.isMapboxURL=x,a.keysDifference=function(a,b){var c=[];for(var d in a)d in b||c.push(d);return c},a.makeRequest=oe,a.mapObject=o,a.mercatorXfromLng=jd,a.mercatorYfromLat=kd,a.mercatorZfromAltitude=ld,a.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a},a.mvt=Oh,a.number=W,a.ortho=function(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a},a.parseGlyphPBF=function(a){return new Oi(a).readFields(ed,[])},a.pbf=Oi,a.performSymbolLayout=function(a,b,c,d,e,f){a.createArrays();var g=512*a.overscaling;a.tilePixelRatio=ph/g,a.compareText={},a.iconsNeedLinear=!1;var h=a.layers[0].layout,i=a.layers[0]._unevaluatedLayout._values,j={};if("composite"===a.textSizeData.kind){var k=a.textSizeData,l=k.minZoom,m=k.maxZoom;j.compositeTextSizes=[i["text-size"].possiblyEvaluate(new $f(l)),i["text-size"].possiblyEvaluate(new $f(m))]}if("composite"===a.iconSizeData.kind){var n=a.iconSizeData,o=n.minZoom,p=n.maxZoom;j.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new $f(o)),i["icon-size"].possiblyEvaluate(new $f(p))]}j.layoutTextSize=i["text-size"].possiblyEvaluate(new $f(a.zoom+1)),j.layoutIconSize=i["icon-size"].possiblyEvaluate(new $f(a.zoom+1)),j.textMaxSize=i["text-size"].possiblyEvaluate(new $f(18));for(var q=h.get("text-line-height")*hi,s="map"===h.get("text-rotation-alignment")&&"point"!==h.get("symbol-placement"),t=h.get("text-keep-upright"),u=0,v=a.features;u<v.length;u+=1)!function(){var f=v[u],g=h.get("text-font").evaluate(f,{}).join(","),i=c,k={horizontal:{},vertical:void 0},l=f.text,m=[0,0];if(l){var n=l.toString(),o=h.get("text-letter-spacing").evaluate(f,{})*hi,p=function(a){
for(var b=0,c=n;b<c.length;b+=1)if(!eb(c[b].charCodeAt(0)))return!1;return!0}()?o:0,w=h.get("text-anchor").evaluate(f,{}),x=h.get("text-variable-anchor"),y=h.get("text-radial-offset").evaluate(f,{});x||(m=y?Ad(w,y*hi):h.get("text-offset").evaluate(f,{}).map(function(a){return a*hi}));var z=s?"center":h.get("text-justify").evaluate(f,{}),A="point"===h.get("symbol-placement")?h.get("text-max-width").evaluate(f,{})*hi:0,B=function(){a.allowVerticalPlacement&&db(n)&&(k.vertical=Dc(l,b,g,A,q,w,"left",p,m,ii.vertical,!0))};if(!s&&x){for(var C="auto"===z?x.map(function(a){return Bd(a)}):[z],D=!1,E=0;E<C.length;E++){var F=C[E];if(!k.horizontal[F])if(D)k.horizontal[F]=k.horizontal[0];else{var G=Dc(l,b,g,A,q,"center",F,p,m,ii.horizontal,!1);G&&(k.horizontal[F]=G,D=1===G.lineCount)}}B()}else{"auto"===z&&(z=Bd(w));var H=Dc(l,b,g,A,q,w,z,p,m,ii.horizontal,!1);H&&(k.horizontal[z]=H),B(),db(n)&&s&&t&&(k.vertical=Dc(l,b,g,A,q,w,z,p,m,ii.vertical,!1))}}var I=void 0;if(f.icon){var J=d[f.icon];J&&(I=function(a,b,c){var d=Ic(c),e=d.horizontalAlign,f=d.verticalAlign,g=b[0],h=b[1],i=g-a.displaySize[0]*e,j=i+a.displaySize[0],k=h-a.displaySize[1]*f;return{image:a,top:k,bottom:k+a.displaySize[1],left:i,right:j}}(e[f.icon],h.get("icon-offset").evaluate(f,{}),h.get("icon-anchor").evaluate(f,{})),void 0===a.sdfIcons?a.sdfIcons=J.sdf:a.sdfIcons!==J.sdf&&r("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),J.pixelRatio!==a.pixelRatio?a.iconsNeedLinear=!0:0!==h.get("icon-rotate").constantOr(1)&&(a.iconsNeedLinear=!0))}(Object.keys(k.horizontal).length||I)&&function(a,b,c,d,e,f,g){var h=f.layoutTextSize.evaluate(b,{}),i=f.layoutIconSize.evaluate(b,{}),j=f.textMaxSize.evaluate(b,{});void 0===j&&(j=h);var k=a.layers[0].layout,l=k.get("icon-offset").evaluate(b,{}),m=Dd(c.horizontal),n=h/24,o=a.tilePixelRatio*n,p=a.tilePixelRatio*j/24,q=a.tilePixelRatio*i,s=a.tilePixelRatio*k.get("symbol-spacing"),t=k.get("text-padding")*a.tilePixelRatio,u=k.get("icon-padding")*a.tilePixelRatio,v=k.get("text-max-angle")/180*Math.PI,w="map"===k.get("text-rotation-alignment")&&"point"!==k.get("symbol-placement"),x="map"===k.get("icon-rotation-alignment")&&"point"!==k.get("symbol-placement"),y=k.get("symbol-placement"),z=s/2,A=function(h,i){i.x<0||i.x>=ph||i.y<0||i.y>=ph||function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,s,t,u,v){var w,x,y,z=a.addToLineVertexArray(b,c),A=0,B=0,C=0,D={},E=kj(""),F=(f.layout.get("text-radial-offset").evaluate(t,{})||0)*hi;if(a.allowVerticalPlacement&&d.vertical){var G=f.layout.get("text-rotate").evaluate(t,{})+90,H=d.vertical;y=new gj(g,c,b,h,i,j,H,k,l,m,a.overscaling,G)}for(var I in d.horizontal){var J=d.horizontal[I];if(!w){E=kj(J.text);var K=f.layout.get("text-rotate").evaluate(t,{});w=new gj(g,c,b,h,i,j,J,k,l,m,a.overscaling,K)}var L=1===J.lineCount;if(B+=Cd(a,b,J,f,m,t,n,z,d.vertical?ii.horizontal:ii.horizontalOnly,L?Object.keys(d.horizontal):[I],D,u,v),L)break}d.vertical&&(C+=Cd(a,b,d.vertical,f,m,t,n,z,ii.vertical,["vertical"],D,u,v));var M=w?w.boxStartIndex:a.collisionBoxArray.length,N=w?w.boxEndIndex:a.collisionBoxArray.length,O=y?y.boxStartIndex:a.collisionBoxArray.length,P=y?y.boxEndIndex:a.collisionBoxArray.length;if(e){var Q=function(a,b,c,d,e,f){var g,h,i,j,k=b.image,l=c.layout,m=b.top-1/k.pixelRatio,n=b.left-1/k.pixelRatio,o=b.bottom+1/k.pixelRatio,p=b.right+1/k.pixelRatio;if("none"!==l.get("icon-text-fit")&&e){var q=p-n,r=o-m,s=l.get("text-size").evaluate(f,{})/24,t=e.left*s,u=e.right*s,v=e.top*s,w=u-t,x=e.bottom*s-v,y=l.get("icon-text-fit-padding")[0],z=l.get("icon-text-fit-padding")[1],A=l.get("icon-text-fit-padding")[2],B=l.get("icon-text-fit-padding")[3],C="width"===l.get("icon-text-fit")?.5*(x-r):0,D="height"===l.get("icon-text-fit")?.5*(w-q):0,E="width"===l.get("icon-text-fit")||"both"===l.get("icon-text-fit")?w:q,F="height"===l.get("icon-text-fit")||"both"===l.get("icon-text-fit")?x:r;g=new Gd(t+D-B,v+C-y),h=new Gd(t+D+z+E,v+C-y),i=new Gd(t+D+z+E,v+C+A+F),j=new Gd(t+D-B,v+C+A+F)}else g=new Gd(n,m),h=new Gd(p,m),i=new Gd(p,o),j=new Gd(n,o);var G=c.layout.get("icon-rotate").evaluate(f,{})*Math.PI/180;if(G){var H=Math.sin(G),I=Math.cos(G),J=[I,-H,H,I];g._matMult(J),h._matMult(J),j._matMult(J),i._matMult(J)}return[{tl:g,tr:h,bl:j,br:i,tex:k.paddedRect,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0}]}(0,e,f,0,Dd(d.horizontal),t),R=f.layout.get("icon-rotate").evaluate(t,{});x=new gj(g,c,b,h,i,j,e,o,p,!1,a.overscaling,R),A=4*Q.length;var S=a.iconSizeData,T=null;"source"===S.kind?(T=[ni*f.layout.get("icon-size").evaluate(t,{})])[0]>oj&&r(a.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'):"composite"===S.kind&&((T=[ni*v.compositeIconSizes[0].evaluate(t,{}),ni*v.compositeIconSizes[1].evaluate(t,{})])[0]>oj||T[1]>oj)&&r(a.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'),a.addSymbols(a.icon,Q,T,s,q,t,!1,b,z.lineStartIndex,z.lineLength)}var U=x?x.boxStartIndex:a.collisionBoxArray.length,V=x?x.boxEndIndex:a.collisionBoxArray.length;a.glyphOffsetArray.length>=ti.MAX_GLYPHS&&r("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),a.symbolInstances.emplaceBack(b.x,b.y,D.right>=0?D.right:-1,D.center>=0?D.center:-1,D.left>=0?D.left:-1,D.vertical||-1,E,M,N,O,P,U,V,h,B,C,A,0,k,F)}(a,i,h,c,d,a.layers[0],a.collisionBoxArray,b.index,b.sourceLayerIndex,a.index,o,t,w,g,q,u,x,l,b,e,f)};if("line"===y)for(var B=0,C=function(a,b,c,d,e){for(var f=[],g=0;g<a.length;g++)for(var h=a[g],i=void 0,j=0;j<h.length-1;j++){var k=h[j],l=h[j+1];k.x<0&&l.x<0||(k.x<0?k=new Gd(0,k.y+(l.y-k.y)*((0-k.x)/(l.x-k.x)))._round():l.x<0&&(l=new Gd(0,k.y+(l.y-k.y)*((0-k.x)/(l.x-k.x)))._round()),k.y<0&&l.y<0||(k.y<0?k=new Gd(k.x+(l.x-k.x)*((0-k.y)/(l.y-k.y)),0)._round():l.y<0&&(l=new Gd(k.x+(l.x-k.x)*((0-k.y)/(l.y-k.y)),0)._round()),k.x>=d&&l.x>=d||(k.x>=d?k=new Gd(d,k.y+(l.y-k.y)*((d-k.x)/(l.x-k.x)))._round():l.x>=d&&(l=new Gd(d,k.y+(l.y-k.y)*((d-k.x)/(l.x-k.x)))._round()),k.y>=e&&l.y>=e||(k.y>=e?k=new Gd(k.x+(l.x-k.x)*((e-k.y)/(l.y-k.y)),e)._round():l.y>=e&&(l=new Gd(k.x+(l.x-k.x)*((e-k.y)/(l.y-k.y)),e)._round()),i&&k.equals(i[i.length-1])||(i=[k],f.push(i)),i.push(l)))))}return f}(b.geometry,0,0,ph,ph);B<C.length;B+=1)for(var D=C[B],E=0,F=vd(D,s,v,c.vertical||m,d,24,p,a.overscaling,ph);E<F.length;E+=1){var G=F[E];m&&Ed(a,m.text,z,G)||A(D,G)}else if("line-center"===y)for(var H=0,I=b.geometry;H<I.length;H+=1){var J=I[H];if(J.length>1){var K=ud(J,v,c.vertical||m,d,24,p);K&&A(J,K)}}else if("Polygon"===b.type)for(var L=0,M=mc(b.geometry,0);L<M.length;L+=1){var N=M[L],O=xd(N,16);A(N[0],new mi(O.x,O.y,0))}else if("LineString"===b.type)for(var P=0,Q=b.geometry;P<Q.length;P+=1){var R=Q[P];A(R,new mi(R[0].x,R[0].y,0))}else if("Point"===b.type)for(var S=0,T=b.geometry;S<T.length;S+=1)for(var U=0,V=T[S];U<V.length;U+=1){var W=V[U];A([W],new mi(W.x,W.y,0))}}(a,f,k,I,i,j,m)}();f&&a.generateCollisionDebugBuffers()},a.perspective=function(a,b,c,d,e){var f,g=1/Math.tan(b/2);return a[0]=g/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=g,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=e&&e!==1/0?(f=1/(d-e),a[10]=(e+d)*f,a[14]=2*e*d*f):(a[10]=-1,a[14]=-2*d),a},a.pick=function(a,b){for(var c={},d=0;d<b.length;d++){var e=b[d];e in a&&(c[e]=a[e])}return c},a.plugin=Zf,a.polygonIntersectsPolygon=rb,a.postMapLoadEvent=de,a.postTurnstileEvent=be,a.potpack=Pc,a.rasterBoundsAttributes=_i,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=ab,a.registerForPluginAvailability=function(a){return Wf?a({pluginURL:Wf,completionCallback:Tf}):Yf.once("pluginAvailable",a),a},a.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+f*h,a[1]=e*i+g*h,a[2]=d*-h+f*i,a[3]=e*-h+g*i,a},a.rotateX=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[4],g=b[5],h=b[6],i=b[7],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=f*e+j*d,a[5]=g*e+k*d,a[6]=h*e+l*d,a[7]=i*e+m*d,a[8]=j*e-f*d,a[9]=k*e-g*d,a[10]=l*e-h*d,a[11]=m*e-i*d,a},a.rotateZ=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e+j*d,a[1]=g*e+k*d,a[2]=h*e+l*d,a[3]=i*e+m*d,a[4]=j*e-f*d,a[5]=k*e-g*d,a[6]=l*e-h*d,a[7]=m*e-i*d,a},a.scale=function(a,b,c){var d=c[0],e=c[1],f=c[2];return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d,a[4]=b[4]*e,a[5]=b[5]*e,a[6]=b[6]*e,a[7]=b[7]*e,a[8]=b[8]*f,a[9]=b[9]*f,a[10]=b[10]*f,a[11]=b[11]*f,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},a.setCacheLimits=function(a,b){fe=a,ge=b},a.setRTLTextPlugin=function(a,b){if(Vf)throw new Error("setRTLTextPlugin cannot be called multiple times.");Vf=!0,Wf=Rd.resolveURL(a),Tf=function(a){a?(Vf=!1,Wf=null,b&&b(a)):Xf=!0},Yf.fire(new se("pluginAvailable",{pluginURL:Wf,completionCallback:Tf}))},a.sphericalToCartesian=function(a){var b=a[0],c=a[1],d=a[2];return c+=90,c*=Math.PI/180,d*=Math.PI/180,{x:b*Math.cos(c)*Math.sin(d),y:b*Math.sin(c)*Math.sin(d),z:b*Math.cos(d)}},a.styleSpec=ve,a.symbolSize=oi,a.transformMat3=function(a,b,c){var d=b[0],e=b[1],f=b[2];return a[0]=d*c[0]+e*c[3]+f*c[6],a[1]=d*c[1]+e*c[4]+f*c[7],a[2]=d*c[2]+e*c[5]+f*c[8],a},a.transformMat4=Fb,a.translate=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=c[0],q=c[1],r=c[2];return b===a?(a[12]=b[0]*p+b[4]*q+b[8]*r+b[12],a[13]=b[1]*p+b[5]*q+b[9]*r+b[13],a[14]=b[2]*p+b[6]*q+b[10]*r+b[14],a[15]=b[3]*p+b[7]*q+b[11]*r+b[15]):(d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=j,a[7]=k,a[8]=l,a[9]=m,a[10]=n,a[11]=o,a[12]=d*p+h*q+l*r+b[12],a[13]=e*p+i*q+m*r+b[13],a[14]=f*p+j*q+n*r+b[14],a[15]=g*p+k*q+o*r+b[15]),a},a.uniqueId=j,a.validateCustomStyleLayer=function(a){var b=[],c=a.id;return void 0===c&&b.push({message:"layers."+c+': missing required property "id"'}),void 0===a.render&&b.push({message:"layers."+c+': missing required method "render"'}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&b.push({message:"layers."+c+': property "renderingMode" must be either "2d" or "3d"'}),b},a.validateLight=Kf,a.validateStyle=Jf,a.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},a.vectorTile=Oh,a.version="1.3.2",a.warnOnce=r,a.webpSupported=Td,a.window=self,a.wrap=h}),a(0,function(a){function b(a){var c=typeof a;if("number"===c||"boolean"===c||"string"===c||null==a)return JSON.stringify(a);if(Array.isArray(a)){for(var d="[",e=0,f=a;e<f.length;e+=1)d+=b(f[e])+",";return d+"]"}for(var g=Object.keys(a).sort(),h="{",i=0;i<g.length;i++)h+=JSON.stringify(g[i])+":"+b(a[g[i]])+",";return h+"}"}function c(c){for(var d="",e=0,f=a.refProperties;e<f.length;e+=1)d+="/"+b(c[f[e]]);return d}function d(b,c){for(var d=new a.EvaluationParameters(c),e=0,f=b;e<f.length;e+=1)f[e].recalculate(d)}function e(b,c){var d=a.getArrayBuffer(b.request,function(b,d,e,f){b?c(b):d&&c(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(d)),rawData:d,cacheControl:e,expires:f})});return function(){d.cancel(),c()}}function f(a){var b=0;if(a&&a.length>0){b+=Math.abs(g(a[0]));for(var c=1;c<a.length;c++)b-=Math.abs(g(a[c]))}return b}function g(a){var b,c,d,e,f,g,i=0,j=a.length;if(j>2){for(g=0;g<j;g++)g===j-2?(d=j-2,e=j-1,f=0):g===j-1?(d=j-1,e=0,f=1):(d=g,e=g+1,f=g+2),b=a[d],c=a[e],i+=(h(a[f][0])-h(b[0]))*Math.sin(h(c[1]));i=i*oa.RADIUS*oa.RADIUS/2}return i}function h(a){return a*Math.PI/180}function i(a,b){return function(c){return a(c,b)}}function j(a,b){b=!!b,a[0]=k(a[0],b);for(var c=1;c<a.length;c++)a[c]=k(a[c],!b);return a}function k(a,b){return function(a){return pa.ring(a)>=0}(a)===b?a:a.reverse()}function l(a,b){this.options=b||{},this.features=a,this.length=a.length}function m(a,b){this.id="number"==typeof a.id?a.id:void 0,this.type=a.type,this.rawGeometry=1===a.type?[a.geometry]:a.geometry,this.properties=a.tags,this.extent=b||4096}function n(b){var c=new a.pbf;return function(a,b){for(var c in a.layers)b.writeMessage(3,o,a.layers[c])}(b,c),c.finish()}function o(a,b){var c;b.writeVarintField(15,a.version||1),b.writeStringField(1,a.name||""),b.writeVarintField(5,a.extent||4096);var d={keys:[],values:[],keycache:{},valuecache:{}};for(c=0;c<a.length;c++)d.feature=a.feature(c),b.writeMessage(2,p,d);var e=d.keys;for(c=0;c<e.length;c++)b.writeStringField(3,e[c]);var f=d.values;for(c=0;c<f.length;c++)b.writeMessage(4,u,f[c])}function p(a,b){var c=a.feature;void 0!==c.id&&b.writeVarintField(1,c.id),b.writeMessage(2,q,a),b.writeVarintField(3,c.type),b.writeMessage(4,t,c)}function q(a,b){var c=a.feature,d=a.keys,e=a.values,f=a.keycache,g=a.valuecache;for(var h in c.properties){var i=f[h];void 0===i&&(d.push(h),i=d.length-1,f[h]=i),b.writeVarint(i);var j=c.properties[h],k=typeof j;"string"!==k&&"boolean"!==k&&"number"!==k&&(j=JSON.stringify(j));var l=k+":"+j,m=g[l];void 0===m&&(e.push(j),m=e.length-1,g[l]=m),b.writeVarint(m)}}function r(a,b){return(b<<3)+(7&a)}function s(a){return a<<1^a>>31}function t(a,b){for(var c=a.loadGeometry(),d=a.type,e=0,f=0,g=c.length,h=0;h<g;h++){var i=c[h],j=1;1===d&&(j=i.length),b.writeVarint(r(1,j));for(var k=3===d?i.length-1:i.length,l=0;l<k;l++){1===l&&1!==d&&b.writeVarint(r(2,k-1));var m=i[l].x-e,n=i[l].y-f;b.writeVarint(s(m)),b.writeVarint(s(n)),e+=m,f+=n}3===d&&b.writeVarint(r(7,1))}}function u(a,b){var c=typeof a;"string"===c?b.writeStringField(1,a):"boolean"===c?b.writeBooleanField(7,a):"number"===c&&(a%1!=0?b.writeDoubleField(3,a):a<0?b.writeSVarintField(6,a):b.writeVarintField(5,a))}function v(a,b,c,d){w(a,c,d),w(b,2*c,2*d),w(b,2*c+1,2*d+1)}function w(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function x(a,b,c,d){var e=a-c,f=b-d;return e*e+f*f}function y(a,b,c,d,e){return{x:a,y:b,zoom:1/0,id:c,parentId:-1,numPoints:d,properties:e}}function z(a,b){var c=a.geometry.coordinates,d=c[0],e=c[1];return{x:C(d),y:D(e),zoom:1/0,index:b,parentId:-1}}function A(a){return{type:"Feature",id:a.id,properties:B(a),geometry:{type:"Point",coordinates:[360*(a.x-.5),(b=a.y,c=(180-360*b)*Math.PI/180,360*Math.atan(Math.exp(c))/Math.PI-90)]}};var b,c}function B(a){var b=a.numPoints,c=b>=1e4?Math.round(b/1e3)+"k":b>=1e3?Math.round(b/100)/10+"k":b;return E(E({},a.properties),{cluster:!0,cluster_id:a.id,point_count:b,point_count_abbreviated:c})}function C(a){return a/360+.5}function D(a){var b=Math.sin(a*Math.PI/180),c=.5-.25*Math.log((1+b)/(1-b))/Math.PI;return c<0?0:c>1?1:c}function E(a,b){for(var c in b)a[c]=b[c];return a}function F(a){return a.x}function G(a){return a.y}function H(a,b,c,d,e,f){var g=e-c,h=f-d;if(0!==g||0!==h){var i=((a-c)*g+(b-d)*h)/(g*g+h*h);i>1?(c=e,d=f):i>0&&(c+=g*i,d+=h*i)}return(g=a-c)*g+(h=b-d)*h}function I(a,b,c,d){var e={id:void 0===a?null:a,type:b,geometry:c,tags:d,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(a){var b=a.geometry,c=a.type;if("Point"===c||"MultiPoint"===c||"LineString"===c)J(a,b);else if("Polygon"===c||"MultiLineString"===c)for(var d=0;d<b.length;d++)J(a,b[d]);else if("MultiPolygon"===c)for(d=0;d<b.length;d++)for(var e=0;e<b[d].length;e++)J(a,b[d][e])}(e),e}function J(a,b){for(var c=0;c<b.length;c+=3)a.minX=Math.min(a.minX,b[c]),a.minY=Math.min(a.minY,b[c+1]),a.maxX=Math.max(a.maxX,b[c]),a.maxY=Math.max(a.maxY,b[c+1])}function K(a,b,c,d){if(b.geometry){var e=b.geometry.coordinates,f=b.geometry.type,g=Math.pow(c.tolerance/((1<<c.maxZoom)*c.extent),2),h=[],i=b.id;if(c.promoteId?i=b.properties[c.promoteId]:c.generateId&&(i=d||0),"Point"===f)L(e,h);else if("MultiPoint"===f)for(var j=0;j<e.length;j++)L(e[j],h);else if("LineString"===f)M(e,h,g,!1);else if("MultiLineString"===f){if(c.lineMetrics){for(j=0;j<e.length;j++)h=[],M(e[j],h,g,!1),a.push(I(i,"LineString",h,b.properties));return}N(e,h,g,!1)}else if("Polygon"===f)N(e,h,g,!0);else{if("MultiPolygon"!==f){if("GeometryCollection"===f){for(j=0;j<b.geometry.geometries.length;j++)K(a,{id:i,geometry:b.geometry.geometries[j],properties:b.properties},c,d);return}throw new Error("Input data is not a valid GeoJSON object.")}for(j=0;j<e.length;j++){var k=[];N(e[j],k,g,!0),h.push(k)}}a.push(I(i,f,h,b.properties))}}function L(a,b){b.push(O(a[0])),b.push(P(a[1])),b.push(0)}function M(a,b,c,d){for(var e,f,g=0,h=0;h<a.length;h++){var i=O(a[h][0]),j=P(a[h][1]);b.push(i),b.push(j),b.push(0),h>0&&(g+=d?(e*j-i*f)/2:Math.sqrt(Math.pow(i-e,2)+Math.pow(j-f,2))),e=i,f=j}var k=b.length-3;b[2]=1,function a(b,c,d,e){for(var f,g=e,h=d-c>>1,i=d-c,j=b[c],k=b[c+1],l=b[d],m=b[d+1],n=c+3;n<d;n+=3){var o=H(b[n],b[n+1],j,k,l,m);if(o>g)f=n,g=o;else if(o===g){var p=Math.abs(n-h);p<i&&(f=n,i=p)}}g>e&&(f-c>3&&a(b,c,f,e),b[f+2]=g,d-f>3&&a(b,f,d,e))}(b,0,k,c),b[k+2]=1,b.size=Math.abs(g),b.start=0,b.end=b.size}function N(a,b,c,d){for(var e=0;e<a.length;e++){var f=[];M(a[e],f,c,d),b.push(f)}}function O(a){return a/360+.5}function P(a){var b=Math.sin(a*Math.PI/180),c=.5-.25*Math.log((1+b)/(1-b))/Math.PI;return c<0?0:c>1?1:c}function Q(a,b,c,d,e,f,g,h){if(d/=b,f>=(c/=b)&&g<d)return a;if(g<c||f>=d)return null;for(var i=[],j=0;j<a.length;j++){var k=a[j],l=k.geometry,m=k.type,n=0===e?k.minX:k.minY,o=0===e?k.maxX:k.maxY;if(n>=c&&o<d)i.push(k);else if(!(o<c||n>=d)){var p=[];if("Point"===m||"MultiPoint"===m)R(l,p,c,d,e);else if("LineString"===m)S(l,p,c,d,e,!1,h.lineMetrics);else if("MultiLineString"===m)U(l,p,c,d,e,!1);else if("Polygon"===m)U(l,p,c,d,e,!0);else if("MultiPolygon"===m)for(var q=0;q<l.length;q++){var r=[];U(l[q],r,c,d,e,!0),r.length&&p.push(r)}if(p.length){if(h.lineMetrics&&"LineString"===m){for(q=0;q<p.length;q++)i.push(I(k.id,m,p[q],k.tags));continue}"LineString"!==m&&"MultiLineString"!==m||(1===p.length?(m="LineString",p=p[0]):m="MultiLineString"),"Point"!==m&&"MultiPoint"!==m||(m=3===p.length?"Point":"MultiPoint"),i.push(I(k.id,m,p,k.tags))}}}return i.length?i:null}function R(a,b,c,d,e){for(var f=0;f<a.length;f+=3){var g=a[f+e];g>=c&&g<=d&&(b.push(a[f]),b.push(a[f+1]),b.push(a[f+2]))}}function S(a,b,c,d,e,f,g){for(var h,i,j=T(a),k=0===e?W:X,l=a.start,m=0;m<a.length-3;m+=3){var n=a[m],o=a[m+1],p=a[m+2],q=a[m+3],r=a[m+4],s=0===e?n:o,t=0===e?q:r,u=!1;g&&(h=Math.sqrt(Math.pow(n-q,2)+Math.pow(o-r,2))),s<c?t>c&&(i=k(j,n,o,q,r,c),g&&(j.start=l+h*i)):s>d?t<d&&(i=k(j,n,o,q,r,d),g&&(j.start=l+h*i)):V(j,n,o,p),t<c&&s>=c&&(i=k(j,n,o,q,r,c),u=!0),t>d&&s<=d&&(i=k(j,n,o,q,r,d),u=!0),!f&&u&&(g&&(j.end=l+h*i),b.push(j),j=T(a)),g&&(l+=h)}var v=a.length-3;n=a[v],o=a[v+1],p=a[v+2],(s=0===e?n:o)>=c&&s<=d&&V(j,n,o,p),v=j.length-3,f&&v>=3&&(j[v]!==j[0]||j[v+1]!==j[1])&&V(j,j[0],j[1],j[2]),j.length&&b.push(j)}function T(a){var b=[];return b.size=a.size,b.start=a.start,b.end=a.end,b}function U(a,b,c,d,e,f){for(var g=0;g<a.length;g++)S(a[g],b,c,d,e,f,!1)}function V(a,b,c,d){a.push(b),a.push(c),a.push(d)}function W(a,b,c,d,e,f){var g=(f-b)/(d-b);return a.push(f),a.push(c+(e-c)*g),a.push(1),g}function X(a,b,c,d,e,f){var g=(f-c)/(e-c);return a.push(b+(d-b)*g),a.push(f),a.push(1),g}function Y(a,b){for(var c=[],d=0;d<a.length;d++){var e,f=a[d],g=f.type;if("Point"===g||"MultiPoint"===g||"LineString"===g)e=Z(f.geometry,b);else if("MultiLineString"===g||"Polygon"===g){e=[];for(var h=0;h<f.geometry.length;h++)e.push(Z(f.geometry[h],b))}else if("MultiPolygon"===g)for(e=[],h=0;h<f.geometry.length;h++){for(var i=[],j=0;j<f.geometry[h].length;j++)i.push(Z(f.geometry[h][j],b));e.push(i)}c.push(I(f.id,g,e,f.tags))}return c}function Z(a,b){var c=[];c.size=a.size,void 0!==a.start&&(c.start=a.start,c.end=a.end);for(var d=0;d<a.length;d+=3)c.push(a[d]+b,a[d+1],a[d+2]);return c}function $(a,b){if(a.transformed)return a;var c,d,e,f=1<<a.z,g=a.x,h=a.y;for(c=0;c<a.features.length;c++){var i=a.features[c],j=i.geometry,k=i.type;if(i.geometry=[],1===k)for(d=0;d<j.length;d+=2)i.geometry.push(_(j[d],j[d+1],b,f,g,h));else for(d=0;d<j.length;d++){var l=[];for(e=0;e<j[d].length;e+=2)l.push(_(j[d][e],j[d][e+1],b,f,g,h));i.geometry.push(l)}}return a.transformed=!0,a}function _(a,b,c,d,e,f){return[Math.round(c*(a*d-e)),Math.round(c*(b*d-f))]}function aa(a,b,c,d,e){for(var f=b===e.maxZoom?0:e.tolerance/((1<<b)*e.extent),g={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:c,y:d,z:b,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},h=0;h<a.length;h++){g.numFeatures++,ba(g,a[h],f,e);var i=a[h].minX,j=a[h].minY,k=a[h].maxX,l=a[h].maxY;i<g.minX&&(g.minX=i),j<g.minY&&(g.minY=j),k>g.maxX&&(g.maxX=k),l>g.maxY&&(g.maxY=l)}return g}function ba(a,b,c,d){var e=b.geometry,f=b.type,g=[];if("Point"===f||"MultiPoint"===f)for(var h=0;h<e.length;h+=3)g.push(e[h]),g.push(e[h+1]),a.numPoints++,a.numSimplified++;else if("LineString"===f)ca(g,e,a,c,!1,!1);else if("MultiLineString"===f||"Polygon"===f)for(h=0;h<e.length;h++)ca(g,e[h],a,c,"Polygon"===f,0===h);else if("MultiPolygon"===f)for(var i=0;i<e.length;i++){var j=e[i];for(h=0;h<j.length;h++)ca(g,j[h],a,c,!0,0===h)}if(g.length){var k=b.tags||null;if("LineString"===f&&d.lineMetrics){for(var l in k={},b.tags)k[l]=b.tags[l];k.mapbox_clip_start=e.start/e.size,k.mapbox_clip_end=e.end/e.size}var m={geometry:g,type:"Polygon"===f||"MultiPolygon"===f?3:"LineString"===f||"MultiLineString"===f?2:1,tags:k};null!==b.id&&(m.id=b.id),a.features.push(m)}}function ca(a,b,c,d,e,f){var g=d*d;if(d>0&&b.size<(e?g:d))c.numPoints+=b.length/3;else{for(var h=[],i=0;i<b.length;i+=3)(0===d||b[i+2]>g)&&(c.numSimplified++,h.push(b[i]),h.push(b[i+1])),c.numPoints++;e&&function(a,b){for(var c=0,d=0,e=a.length,f=e-2;d<e;f=d,d+=2)c+=(a[d]-a[f])*(a[d+1]+a[f+1]);if(c>0===b)for(d=0,e=a.length;d<e/2;d+=2){var g=a[d],h=a[d+1];a[d]=a[e-2-d],a[d+1]=a[e-1-d],a[e-2-d]=g,a[e-1-d]=h}}(h,f),a.push(h)}}function da(a,b){var c=(b=this.options=function(a,b){for(var c in b)a[c]=b[c];return a}(Object.create(this.options),b)).debug;if(c&&console.time("preprocess data"),b.maxZoom<0||b.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(b.promoteId&&b.generateId)throw new Error("promoteId and generateId cannot be used together.");var d=function(a,b){var c=[];if("FeatureCollection"===a.type)for(var d=0;d<a.features.length;d++)K(c,a.features[d],b,d);else"Feature"===a.type?K(c,a,b):K(c,{geometry:a},b);return c}(a,b);this.tiles={},this.tileCoords=[],c&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",b.indexMaxZoom,b.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(d=function(a,b){var c=b.buffer/b.extent,d=a,e=Q(a,1,-1-c,c,0,-1,2,b),f=Q(a,1,1-c,2+c,0,-1,2,b);return(e||f)&&(d=Q(a,1,-c,1+c,0,-1,2,b)||[],e&&(d=Y(e,1).concat(d)),f&&(d=d.concat(Y(f,-1)))),d}(d,b)).length&&this.splitTile(d,0,0,0),c&&(d.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ea(a,b,c){return 32*((1<<a)*c+b)+a}function fa(a,b){var c=a.tileID.canonical;if(!this._geoJSONIndex)return b(null,null);var d=this._geoJSONIndex.getTile(c.z,c.x,c.y);if(!d)return b(null,null);var e=new sa(d.features),f=va(e);0===f.byteOffset&&f.byteLength===f.buffer.byteLength||(f=new Uint8Array(f)),b(null,{vectorTile:e,rawData:f.buffer})}var ga=function(a){this.keyCache={},a&&this.replace(a)};ga.prototype.replace=function(a){this._layerConfigs={},this._layers={},this.update(a,[])},ga.prototype.update=function(b,d){for(var e=this,f=0,g=b;f<g.length;f+=1){var h=g[f];this._layerConfigs[h.id]=h;var i=this._layers[h.id]=a.createStyleLayer(h);i._featureFilter=a.featureFilter(i.filter),this.keyCache[h.id]&&delete this.keyCache[h.id]}for(var j=0,k=d;j<k.length;j+=1){var l=k[j];delete this.keyCache[l],delete this._layerConfigs[l],delete this._layers[l]}this.familiesBySource={};for(var m=0,n=function(a,b){for(var d={},e=0;e<a.length;e++){var f=b&&b[a[e].id]||c(a[e]);b&&(b[a[e].id]=f);var g=d[f];g||(g=d[f]=[]),g.push(a[e])}var h=[];for(var i in d)h.push(d[i]);return h}(a.values(this._layerConfigs),this.keyCache);m<n.length;m+=1){var o=n[m].map(function(a){return e._layers[a.id]}),p=o[0];if("none"!==p.visibility){var q=p.source||"",r=this.familiesBySource[q];r||(r=this.familiesBySource[q]={});var s=p.sourceLayer||"_geojsonTileLayer",t=r[s];t||(t=r[s]=[]),t.push(o)}}};var ha=function(b){var c={},d=[];for(var e in b){var f=b[e],g=c[e]={};for(var h in f){var i=f[+h];if(i&&0!==i.bitmap.width&&0!==i.bitmap.height){var j={x:0,y:0,w:i.bitmap.width+2,h:i.bitmap.height+2};d.push(j),g[h]={rect:j,metrics:i.metrics}}}}var k=a.potpack(d),l=k.w,m=k.h,n=new a.AlphaImage({width:l||1,height:m||1});for(var o in b){var p=b[o];for(var q in p){var r=p[+q];if(r&&0!==r.bitmap.width&&0!==r.bitmap.height){var s=c[o][q].rect;a.AlphaImage.copy(r.bitmap,n,{x:0,y:0},{x:s.x+1,y:s.y+1},r.bitmap)}}}this.image=n,this.positions=c};a.register("GlyphAtlas",ha);var ia=function(b){this.tileID=new a.OverscaledTileID(b.tileID.overscaledZ,b.tileID.wrap,b.tileID.canonical.z,b.tileID.canonical.x,b.tileID.canonical.y),this.uid=b.uid,this.zoom=b.zoom,this.pixelRatio=b.pixelRatio,this.tileSize=b.tileSize,this.source=b.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=b.showCollisionBoxes,this.collectResourceTiming=!!b.collectResourceTiming,this.returnDependencies=!!b.returnDependencies};ia.prototype.parse=function(b,c,e,f){function g(){if(k)return f(k);if(l&&m&&n){var b=new ha(l),c=new a.ImageAtlas(m,n);for(var e in o){var g=o[e];g instanceof a.SymbolBucket?(d(g.layers,this.zoom),a.performSymbolLayout(g,l,b.positions,m,c.iconPositions,this.showCollisionBoxes)):g.hasPattern&&(g instanceof a.LineBucket||g instanceof a.FillBucket||g instanceof a.FillExtrusionBucket)&&(d(g.layers,this.zoom),g.addFeatures(p,c.patternPositions))}this.status="done",f(null,{buckets:a.values(o).filter(function(a){return!a.isEmpty()}),featureIndex:j,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:b.image,imageAtlas:c,glyphMap:this.returnDependencies?l:null,iconMap:this.returnDependencies?m:null,glyphPositions:this.returnDependencies?b.positions:null})}}var h=this;this.status="parsing",this.data=b,this.collisionBoxArray=new a.CollisionBoxArray;var i=new a.DictionaryCoder(Object.keys(b.layers).sort()),j=new a.FeatureIndex(this.tileID);j.bucketLayerIDs=[];var k,l,m,n,o={},p={featureIndex:j,iconDependencies:{},patternDependencies:{},glyphDependencies:{}},q=c.familiesBySource[this.source];for(var r in q){var s=b.layers[r];if(s){1===s.version&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+r+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var t=i.encode(r),u=[],v=0;v<s.length;v++){var w=s.feature(v);u.push({feature:w,index:v,sourceLayerIndex:t})}for(var x=0,y=q[r];x<y.length;x+=1){var z=y[x],A=z[0];A.minzoom&&this.zoom<Math.floor(A.minzoom)||A.maxzoom&&this.zoom>=A.maxzoom||"none"!==A.visibility&&(d(z,this.zoom),(o[A.id]=A.createBucket({index:j.bucketLayerIDs.length,layers:z,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:t,sourceID:this.source})).populate(u,p),j.bucketLayerIDs.push(z.map(function(a){return a.id})))}}}var B=a.mapObject(p.glyphDependencies,function(a){return Object.keys(a).map(Number)});Object.keys(B).length?e.send("getGlyphs",{uid:this.uid,stacks:B},function(a,b){k||(k=a,l=b,g.call(h))}):l={};var C=Object.keys(p.iconDependencies);C.length?e.send("getImages",{icons:C},function(a,b){k||(k=a,m=b,g.call(h))}):m={};var D=Object.keys(p.patternDependencies);D.length?e.send("getImages",{icons:D},function(a,b){k||(k=a,n=b,g.call(h))}):n={},g.call(this)};var ja="undefined"!=typeof performance,ka={getEntriesByName:function(a){return!!(ja&&performance&&performance.getEntriesByName)&&performance.getEntriesByName(a)},mark:function(a){return!!(ja&&performance&&performance.mark)&&performance.mark(a)},measure:function(a,b,c){return!!(ja&&performance&&performance.measure)&&performance.measure(a,b,c)},clearMarks:function(a){return!!(ja&&performance&&performance.clearMarks)&&performance.clearMarks(a)},clearMeasures:function(a){return!!(ja&&performance&&performance.clearMeasures)&&performance.clearMeasures(a)}},la=function(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},ka.mark(this._marks.start)};la.prototype.finish=function(){ka.mark(this._marks.end);var a=ka.getEntriesByName(this._marks.measure);return 0===a.length&&(ka.measure(this._marks.measure,this._marks.start,this._marks.end),a=ka.getEntriesByName(this._marks.measure),ka.clearMarks(this._marks.start),ka.clearMarks(this._marks.end),ka.clearMeasures(this._marks.measure)),a},ka.Performance=la;var ma=function(a,b,c){this.actor=a,this.layerIndex=b,this.loadVectorData=c||e,this.loading={},this.loaded={}};ma.prototype.loadTile=function(b,c){var d=this,e=b.uid;this.loading||(this.loading={});var f=!!(b&&b.request&&b.request.collectResourceTiming)&&new ka.Performance(b.request),g=this.loading[e]=new ia(b);g.abort=this.loadVectorData(b,function(b,h){if(delete d.loading[e],b||!h)return g.status="done",d.loaded[e]=g,c(b);var i=h.rawData,j={};h.expires&&(j.expires=h.expires),h.cacheControl&&(j.cacheControl=h.cacheControl);var k={};if(f){var l=f.finish();l&&(k.resourceTiming=JSON.parse(JSON.stringify(l)))}g.vectorTile=h.vectorTile,g.parse(h.vectorTile,d.layerIndex,d.actor,function(b,d){if(b||!d)return c(b);c(null,a.extend({rawTileData:i.slice(0)},d,j,k))}),d.loaded=d.loaded||{},d.loaded[e]=g})},ma.prototype.reloadTile=function(a,b){var c=this.loaded,d=a.uid,e=this;if(c&&c[d]){var f=c[d];f.showCollisionBoxes=a.showCollisionBoxes;var g=function(a,c){var d=f.reloadCallback;d&&(delete f.reloadCallback,f.parse(f.vectorTile,e.layerIndex,e.actor,d)),b(a,c)};"parsing"===f.status?f.reloadCallback=g:"done"===f.status&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.actor,g):g())}},ma.prototype.abortTile=function(a,b){var c=this.loading,d=a.uid;c&&c[d]&&c[d].abort&&(c[d].abort(),delete c[d]),b()},ma.prototype.removeTile=function(a,b){var c=this.loaded,d=a.uid;c&&c[d]&&delete c[d],b()};var na=function(){this.loaded={}};na.prototype.loadTile=function(b,c){var d=b.uid,e=b.encoding,f=b.rawImageData,g=new a.DEMData(d,f,e);this.loaded=this.loaded||{},this.loaded[d]=g,c(null,g)},na.prototype.removeTile=function(a){var b=this.loaded,c=a.uid;b&&b[c]&&delete b[c]};var oa={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142},pa={geometry:function a(b){var c,d=0;switch(b.type){case"Polygon":return f(b.coordinates);case"MultiPolygon":for(c=0;c<b.coordinates.length;c++)d+=f(b.coordinates[c]);return d;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(c=0;c<b.geometries.length;c++)d+=a(b.geometries[c]);return d}},ring:g},qa=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,ra=function(b){this._feature=b,this.extent=a.EXTENT,this.type=b.type,this.properties=b.tags,"id"in b&&!isNaN(b.id)&&(this.id=parseInt(b.id,10))};ra.prototype.loadGeometry=function(){if(1===this._feature.type){for(var b=[],c=0,d=this._feature.geometry;c<d.length;c+=1){var e=d[c];b.push([new a.Point$1(e[0],e[1])])}return b}for(var f=[],g=0,h=this._feature.geometry;g<h.length;g+=1){for(var i=[],j=0,k=h[g];j<k.length;j+=1){var l=k[j];i.push(new a.Point$1(l[0],l[1]))}f.push(i)}return f},ra.prototype.toGeoJSON=function(a,b,c){return qa.call(this,a,b,c)};var sa=function(b){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=b.length,this._features=b};sa.prototype.feature=function(a){return new ra(this._features[a])};var ta=a.vectorTile.VectorTileFeature,ua=l;l.prototype.feature=function(a){return new m(this.features[a],this.options.extent)},m.prototype.loadGeometry=function(){var b=this.rawGeometry;this.geometry=[];for(var c=0;c<b.length;c++){for(var d=b[c],e=[],f=0;f<d.length;f++)e.push(new a.Point$1(d[f][0],d[f][1]));this.geometry.push(e)}return this.geometry},m.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var a=this.geometry,b=1/0,c=-1/0,d=1/0,e=-1/0,f=0;f<a.length;f++)for(var g=a[f],h=0;h<g.length;h++){var i=g[h];b=Math.min(b,i.x),
c=Math.max(c,i.x),d=Math.min(d,i.y),e=Math.max(e,i.y)}return[b,d,c,e]},m.prototype.toGeoJSON=ta.prototype.toGeoJSON;var va=n,wa=n,xa=ua;va.fromVectorTileJs=wa,va.fromGeojsonVt=function(a,b){b=b||{};var c={};for(var d in a)c[d]=new ua(a[d].features,b),c[d].name=d,c[d].version=b.version,c[d].extent=b.extent;return n({layers:c})},va.GeoJSONWrapper=xa;var ya=function(a){return a[0]},za=function(a){return a[1]},Aa=function(a,b,c,d,e){void 0===b&&(b=ya),void 0===c&&(c=za),void 0===d&&(d=64),void 0===e&&(e=Float64Array),this.nodeSize=d,this.points=a;for(var f=a.length<65536?Uint16Array:Uint32Array,g=this.ids=new f(a.length),h=this.coords=new e(2*a.length),i=0;i<a.length;i++)g[i]=i,h[2*i]=b(a[i]),h[2*i+1]=c(a[i]);!function a(b,c,d,e,f,g){if(!(f-e<=d)){var h=e+f>>1;!function a(b,c,d,e,f,g){for(;f>e;){if(f-e>600){var h=f-e+1,i=d-e+1,j=Math.log(h),k=.5*Math.exp(2*j/3),l=.5*Math.sqrt(j*k*(h-k)/h)*(i-h/2<0?-1:1);a(b,c,d,Math.max(e,Math.floor(d-i*k/h+l)),Math.min(f,Math.floor(d+(h-i)*k/h+l)),g)}var m=c[2*d+g],n=e,o=f;for(v(b,c,e,d),c[2*f+g]>m&&v(b,c,e,f);n<o;){for(v(b,c,n,o),n++,o--;c[2*n+g]<m;)n++;for(;c[2*o+g]>m;)o--}c[2*e+g]===m?v(b,c,e,o):v(b,c,++o,f),o<=d&&(e=o+1),d<=o&&(f=o-1)}}(b,c,h,e,f,g%2),a(b,c,d,e,h-1,g+1),a(b,c,d,h+1,f,g+1)}}(g,h,d,0,g.length-1,0)};Aa.prototype.range=function(a,b,c,d){return function(a,b,c,d,e,f,g){for(var h,i,j=[0,a.length-1,0],k=[];j.length;){var l=j.pop(),m=j.pop(),n=j.pop();if(m-n<=g)for(var o=n;o<=m;o++)h=b[2*o],i=b[2*o+1],h>=c&&h<=e&&i>=d&&i<=f&&k.push(a[o]);else{var p=Math.floor((n+m)/2);h=b[2*p],i=b[2*p+1],h>=c&&h<=e&&i>=d&&i<=f&&k.push(a[p]);var q=(l+1)%2;(0===l?c<=h:d<=i)&&(j.push(n),j.push(p-1),j.push(q)),(0===l?e>=h:f>=i)&&(j.push(p+1),j.push(m),j.push(q))}}return k}(this.ids,this.coords,a,b,c,d,this.nodeSize)},Aa.prototype.within=function(a,b,c){return function(a,b,c,d,e,f){for(var g=[0,a.length-1,0],h=[],i=e*e;g.length;){var j=g.pop(),k=g.pop(),l=g.pop();if(k-l<=f)for(var m=l;m<=k;m++)x(b[2*m],b[2*m+1],c,d)<=i&&h.push(a[m]);else{var n=Math.floor((l+k)/2),o=b[2*n],p=b[2*n+1];x(o,p,c,d)<=i&&h.push(a[n]);var q=(j+1)%2;(0===j?c-e<=o:d-e<=p)&&(g.push(l),g.push(n-1),g.push(q)),(0===j?c+e>=o:d+e>=p)&&(g.push(n+1),g.push(k),g.push(q))}}return h}(this.ids,this.coords,a,b,c,this.nodeSize)};var Ba={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,map:function(a){return a}},Ca=function(a){this.options=E(Object.create(Ba),a),this.trees=new Array(this.options.maxZoom+1)};Ca.prototype.load=function(a){var b=this.options,c=b.log,d=b.minZoom,e=b.maxZoom,f=b.nodeSize;c&&console.time("total time");var g="prepare "+a.length+" points";c&&console.time(g),this.points=a;for(var h=[],i=0;i<a.length;i++)a[i].geometry&&h.push(z(a[i],i));this.trees[e+1]=new Aa(h,F,G,f,Float32Array),c&&console.timeEnd(g);for(var j=e;j>=d;j--){var k=+Date.now();h=this._cluster(h,j),this.trees[j]=new Aa(h,F,G,f,Float32Array),c&&console.log("z%d: %d clusters in %dms",j,h.length,+Date.now()-k)}return c&&console.timeEnd("total time"),this},Ca.prototype.getClusters=function(a,b){var c=((a[0]+180)%360+360)%360-180,d=Math.max(-90,Math.min(90,a[1])),e=180===a[2]?180:((a[2]+180)%360+360)%360-180,f=Math.max(-90,Math.min(90,a[3]));if(a[2]-a[0]>=360)c=-180,e=180;else if(c>e){var g=this.getClusters([c,d,180,f],b),h=this.getClusters([-180,d,e,f],b);return g.concat(h)}for(var i=this.trees[this._limitZoom(b)],j=[],k=0,l=i.range(C(c),D(f),C(e),D(d));k<l.length;k+=1){var m=l[k],n=i.points[m];j.push(n.numPoints?A(n):this.points[n.index])}return j},Ca.prototype.getChildren=function(a){var b=a>>5,c=a%32,d="No cluster with the specified id.",e=this.trees[c];if(!e)throw new Error(d);var f=e.points[b];if(!f)throw new Error(d);for(var g=this.options.radius/(this.options.extent*Math.pow(2,c-1)),h=[],i=0,j=e.within(f.x,f.y,g);i<j.length;i+=1){var k=j[i],l=e.points[k];l.parentId===a&&h.push(l.numPoints?A(l):this.points[l.index])}if(0===h.length)throw new Error(d);return h},Ca.prototype.getLeaves=function(a,b,c){b=b||10,c=c||0;var d=[];return this._appendLeaves(d,a,b,c,0),d},Ca.prototype.getTile=function(a,b,c){var d=this.trees[this._limitZoom(a)],e=Math.pow(2,a),f=this.options,g=f.extent,h=f.radius/g,i=(c-h)/e,j=(c+1+h)/e,k={features:[]};return this._addTileFeatures(d.range((b-h)/e,i,(b+1+h)/e,j),d.points,b,c,e,k),0===b&&this._addTileFeatures(d.range(1-h/e,i,1,j),d.points,e,c,e,k),b===e-1&&this._addTileFeatures(d.range(0,i,h/e,j),d.points,-1,c,e,k),k.features.length?k:null},Ca.prototype.getClusterExpansionZoom=function(a){for(var b=a%32-1;b<=this.options.maxZoom;){var c=this.getChildren(a);if(b++,1!==c.length)break;a=c[0].properties.cluster_id}return b},Ca.prototype._appendLeaves=function(a,b,c,d,e){for(var f=0,g=this.getChildren(b);f<g.length;f+=1){var h=g[f],i=h.properties;if(i&&i.cluster?e+i.point_count<=d?e+=i.point_count:e=this._appendLeaves(a,i.cluster_id,c,d,e):e<d?e++:a.push(h),a.length===c)break}return e},Ca.prototype._addTileFeatures=function(a,b,c,d,e,f){for(var g=0,h=a;g<h.length;g+=1){var i=b[h[g]],j={type:1,geometry:[[Math.round(this.options.extent*(i.x*e-c)),Math.round(this.options.extent*(i.y*e-d))]],tags:i.numPoints?B(i):this.points[i.index].properties},k=i.numPoints?i.id:this.points[i.index].id;void 0!==k&&(j.id=k),f.features.push(j)}},Ca.prototype._limitZoom=function(a){return Math.max(this.options.minZoom,Math.min(a,this.options.maxZoom+1))},Ca.prototype._cluster=function(a,b){for(var c=[],d=this.options,e=d.radius,f=d.extent,g=d.reduce,h=e/(f*Math.pow(2,b)),i=0;i<a.length;i++){var j=a[i];if(!(j.zoom<=b)){j.zoom=b;for(var k=this.trees[b+1],l=k.within(j.x,j.y,h),m=j.numPoints||1,n=j.x*m,o=j.y*m,p=g&&m>1?this._map(j,!0):null,q=(i<<5)+(b+1),r=0,s=l;r<s.length;r+=1){var t=s[r],u=k.points[t];if(!(u.zoom<=b)){u.zoom=b;var v=u.numPoints||1;n+=u.x*v,o+=u.y*v,m+=v,u.parentId=q,g&&(p||(p=this._map(j,!0)),g(p,this._map(u)))}}1===m?c.push(j):(j.parentId=q,c.push(y(n/m,o/m,q,m,p)))}}return c},Ca.prototype._map=function(a,b){if(a.numPoints)return b?E({},a.properties):a.properties;var c=this.points[a.index].properties,d=this.options.map(c);return b&&d===c?E({},d):d},da.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},da.prototype.splitTile=function(a,b,c,d,e,f,g){for(var h=[a,b,c,d],i=this.options,j=i.debug;h.length;){d=h.pop(),c=h.pop(),b=h.pop(),a=h.pop();var k=1<<b,l=ea(b,c,d),m=this.tiles[l];if(!m&&(j>1&&console.time("creation"),m=this.tiles[l]=aa(a,b,c,d,i),this.tileCoords.push({z:b,x:c,y:d}),j)){j>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",b,c,d,m.numFeatures,m.numPoints,m.numSimplified),console.timeEnd("creation"));var n="z"+b;this.stats[n]=(this.stats[n]||0)+1,this.total++}if(m.source=a,e){if(b===i.maxZoom||b===e)continue;var o=1<<e-b;if(c!==Math.floor(f/o)||d!==Math.floor(g/o))continue}else if(b===i.indexMaxZoom||m.numPoints<=i.indexMaxPoints)continue;if(m.source=null,0!==a.length){j>1&&console.time("clipping");var p,q,r,s,t,u,v=.5*i.buffer/i.extent,w=.5-v,x=.5+v,y=1+v;p=q=r=s=null,t=Q(a,k,c-v,c+x,0,m.minX,m.maxX,i),u=Q(a,k,c+w,c+y,0,m.minX,m.maxX,i),a=null,t&&(p=Q(t,k,d-v,d+x,1,m.minY,m.maxY,i),q=Q(t,k,d+w,d+y,1,m.minY,m.maxY,i),t=null),u&&(r=Q(u,k,d-v,d+x,1,m.minY,m.maxY,i),s=Q(u,k,d+w,d+y,1,m.minY,m.maxY,i),u=null),j>1&&console.timeEnd("clipping"),h.push(p||[],b+1,2*c,2*d),h.push(q||[],b+1,2*c,2*d+1),h.push(r||[],b+1,2*c+1,2*d),h.push(s||[],b+1,2*c+1,2*d+1)}}},da.prototype.getTile=function(a,b,c){var d=this.options,e=d.extent,f=d.debug;if(a<0||a>24)return null;var g=1<<a,h=ea(a,b=(b%g+g)%g,c);if(this.tiles[h])return $(this.tiles[h],e);f>1&&console.log("drilling down to z%d-%d-%d",a,b,c);for(var i,j=a,k=b,l=c;!i&&j>0;)j--,k=Math.floor(k/2),l=Math.floor(l/2),i=this.tiles[ea(j,k,l)];return i&&i.source?(f>1&&console.log("found parent tile z%d-%d-%d",j,k,l),f>1&&console.time("drilling down"),this.splitTile(i.source,j,k,l,a,b,c),f>1&&console.timeEnd("drilling down"),this.tiles[h]?$(this.tiles[h],e):null):null};var Da=function(b){function c(a,c,d){b.call(this,a,c,fa),d&&(this.loadGeoJSON=d)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.loadData=function(a,b){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=b,this._pendingLoadDataParams=a,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},c.prototype._loadData=function(){var b=this;if(this._pendingCallback&&this._pendingLoadDataParams){var c=this._pendingCallback,d=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var e=!!(d&&d.request&&d.request.collectResourceTiming)&&new ka.Performance(d.request);this.loadGeoJSON(d,function(f,g){if(f||!g)return c(f);if("object"!=typeof g)return c(new Error("Input data given to '"+d.source+"' is not a valid GeoJSON object."));!function a(b,c){switch(b&&b.type||null){case"FeatureCollection":return b.features=b.features.map(i(a,c)),b;case"GeometryCollection":return b.geometries=b.geometries.map(i(a,c)),b;case"Feature":return b.geometry=a(b.geometry,c),b;case"Polygon":case"MultiPolygon":return function(a,b){return"Polygon"===a.type?a.coordinates=j(a.coordinates,b):"MultiPolygon"===a.type&&(a.coordinates=a.coordinates.map(i(j,b))),a}(b,c);default:return b}}(g,!0);try{b._geoJSONIndex=d.cluster?new Ca(function(b){var c=b.superclusterOptions,d=b.clusterProperties;if(!d||!c)return c;for(var e={},f={},g={accumulated:null,zoom:0},h={properties:null},i=Object.keys(d),j=0,k=i;j<k.length;j+=1){var l=k[j],m=d[l],n=m[0],o=m[1],p=a.createExpression(o),q=a.createExpression("string"==typeof n?[n,["accumulated"],["get",l]]:n);e[l]=p.value,f[l]=q.value}return c.map=function(a){h.properties=a;for(var b={},c=0,d=i;c<d.length;c+=1){var f=d[c];b[f]=e[f].evaluate(g,h)}return b},c.reduce=function(a,b){h.properties=b;for(var c=0,d=i;c<d.length;c+=1){var e=d[c];g.accumulated=a[e],a[e]=f[e].evaluate(g,h)}},c}(d)).load(g.features):new da(g,d.geojsonVtOptions)}catch(f){return c(f)}b.loaded={};var h={};if(e){var k=e.finish();k&&(h.resourceTiming={},h.resourceTiming[d.source]=JSON.parse(JSON.stringify(k)))}c(null,h)})}},c.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},c.prototype.reloadTile=function(a,c){var d=this.loaded,e=a.uid;return d&&d[e]?b.prototype.reloadTile.call(this,a,c):this.loadTile(a,c)},c.prototype.loadGeoJSON=function(b,c){if(b.request)a.getJSON(b.request,c);else{if("string"!=typeof b.data)return c(new Error("Input data given to '"+b.source+"' is not a valid GeoJSON object."));try{return c(null,JSON.parse(b.data))}catch(a){return c(new Error("Input data given to '"+b.source+"' is not a valid GeoJSON object."))}}},c.prototype.removeSource=function(a,b){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),b()},c.prototype.getClusterExpansionZoom=function(a,b){b(null,this._geoJSONIndex.getClusterExpansionZoom(a.clusterId))},c.prototype.getClusterChildren=function(a,b){b(null,this._geoJSONIndex.getChildren(a.clusterId))},c.prototype.getClusterLeaves=function(a,b){b(null,this._geoJSONIndex.getLeaves(a.clusterId,a.limit,a.offset))},c}(ma),Ea=function(b){var c=this;this.self=b,this.actor=new a.Actor(b,this),this.layerIndexes={},this.workerSourceTypes={vector:ma,geojson:Da},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(a,b){if(c.workerSourceTypes[a])throw new Error('Worker source with name "'+a+'" already registered.');c.workerSourceTypes[a]=b},this.self.registerRTLTextPlugin=function(b){if(a.plugin.isLoaded())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=b.applyArabicShaping,a.plugin.processBidirectionalText=b.processBidirectionalText,a.plugin.processStyledBidirectionalText=b.processStyledBidirectionalText}};return Ea.prototype.setReferrer=function(a,b){this.referrer=b},Ea.prototype.setLayers=function(a,b,c){this.getLayerIndex(a).replace(b),c()},Ea.prototype.updateLayers=function(a,b,c){this.getLayerIndex(a).update(b.layers,b.removedIds),c()},Ea.prototype.loadTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).loadTile(b,c)},Ea.prototype.loadDEMTile=function(a,b,c){this.getDEMWorkerSource(a,b.source).loadTile(b,c)},Ea.prototype.reloadTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).reloadTile(b,c)},Ea.prototype.abortTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).abortTile(b,c)},Ea.prototype.removeTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).removeTile(b,c)},Ea.prototype.removeDEMTile=function(a,b){this.getDEMWorkerSource(a,b.source).removeTile(b)},Ea.prototype.removeSource=function(a,b,c){if(this.workerSources[a]&&this.workerSources[a][b.type]&&this.workerSources[a][b.type][b.source]){var d=this.workerSources[a][b.type][b.source];delete this.workerSources[a][b.type][b.source],void 0!==d.removeSource?d.removeSource(b,c):c()}},Ea.prototype.loadWorkerSource=function(a,b,c){try{this.self.importScripts(b.url),c()}catch(a){c(a.toString())}},Ea.prototype.loadRTLTextPlugin=function(b,c,d){try{a.plugin.isLoaded()||(this.self.importScripts(c),d(a.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+c)))}catch(a){d(a.toString())}},Ea.prototype.getLayerIndex=function(a){var b=this.layerIndexes[a];return b||(b=this.layerIndexes[a]=new ga),b},Ea.prototype.getWorkerSource=function(a,b,c){var d=this;if(this.workerSources[a]||(this.workerSources[a]={}),this.workerSources[a][b]||(this.workerSources[a][b]={}),!this.workerSources[a][b][c]){var e={send:function(b,c,e){d.actor.send(b,c,e,a)}};this.workerSources[a][b][c]=new this.workerSourceTypes[b](e,this.getLayerIndex(a))}return this.workerSources[a][b][c]},Ea.prototype.getDEMWorkerSource=function(a,b){return this.demWorkerSources[a]||(this.demWorkerSources[a]={}),this.demWorkerSources[a][b]||(this.demWorkerSources[a][b]=new na),this.demWorkerSources[a][b]},Ea.prototype.enforceCacheSizeLimit=function(b,c){a.enforceCacheSizeLimit(c)},"undefined"!=typeof WorkerGlobalScope&&void 0!==a.window&&a.window instanceof WorkerGlobalScope&&(a.window.worker=new Ea(a.window)),Ea}),a(0,function(a){function b(a){if(!qa)return a[0];for(var b=0;b<a.length;b++)if(a[b]in qa)return a[b];return a[0]}function c(a){var b=a.userImage;return!!(b&&b.render&&b.render())&&(a.data.replace(new Uint8Array(b.data.buffer)),!0)}function d(a,b,c,d,e,f){this.fontSize=a||24,this.buffer=void 0===b?3:b,this.cutoff=d||.25,this.fontFamily=e||"sans-serif",this.fontWeight=f||"normal",this.radius=c||8;var g=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=g,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.d=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Int16Array(g),this.middle=Math.round(g/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function e(a,b,c,d,e,g,h){for(var i=0;i<b;i++){for(var j=0;j<c;j++)d[j]=a[j*b+i];for(f(d,e,g,h,c),j=0;j<c;j++)a[j*b+i]=e[j]}for(j=0;j<c;j++){for(i=0;i<b;i++)d[i]=a[j*b+i];for(f(d,e,g,h,b),i=0;i<b;i++)a[j*b+i]=Math.sqrt(e[i])}}function f(a,b,c,d,e){c[0]=0,d[0]=-za,d[1]=+za;for(var f=1,g=0;f<e;f++){for(var h=(a[f]+f*f-(a[c[g]]+c[g]*c[g]))/(2*f-2*c[g]);h<=d[g];)g--,h=(a[f]+f*f-(a[c[g]]+c[g]*c[g]))/(2*f-2*c[g]);c[++g]=f,d[g]=h,d[g+1]=+za}for(f=0,g=0;f<e;f++){for(;d[g+1]<f;)g++;b[f]=(f-c[g])*(f-c[g])+a[c[g]]}}function g(b,c,d){var e=function(e,f){if(e)return d(e);if(f){var g=a.pick(a.extend(f,b),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);f.vector_layers&&(g.vectorLayers=f.vector_layers,g.vectorLayerIds=g.vectorLayers.map(function(a){return a.id})),b.url&&(g.tiles=c.canonicalizeTileset(g,b.url)),d(null,g)}};return b.url?a.getJSON(c.transformRequest(c.normalizeSourceURL(b.url),a.ResourceType.Source),e):a.browser.frame(function(){return e(null,b)})}function h(b,c){var d=a.identity([]);return a.translate(d,d,[1,1,0]),a.scale(d,d,[.5*b.width,.5*b.height,1]),a.multiply(d,d,b.calculatePosMatrix(c.toUnwrapped()))}function i(a,b,c,d,e){var f=function(a,b,c){if(a)for(var d=0,e=a;d<e.length;d+=1){var f=b[e[d]];if(f&&f.source===c&&"fill-extrusion"===f.type)return!0}else for(var g in b){var h=b[g];if(h.source===c&&"fill-extrusion"===h.type)return!0}return!1}(d&&d.layers,b,a.id),g=e.maxPitchScaleFactor(),i=a.tilesIn(c,g,f);i.sort(j);for(var k=[],l=0,m=i;l<m.length;l+=1){var n=m[l];k.push({wrappedTileID:n.tileID.wrapped().key,queryResults:n.tile.queryRenderedFeatures(b,a._state,n.queryGeometry,n.cameraQueryGeometry,n.scale,d,e,g,h(a.transform,n.tileID))})}var o=function(a){for(var b={},c={},d=0,e=a;d<e.length;d+=1){var f=e[d],g=f.queryResults,h=f.wrappedTileID,i=c[h]=c[h]||{};for(var j in g)for(var k=g[j],l=i[j]=i[j]||{},m=b[j]=b[j]||[],n=0,o=k;n<o.length;n+=1){var p=o[n];l[p.featureIndex]||(l[p.featureIndex]=!0,m.push(p))}}return b}(k);for(var p in o)o[p].forEach(function(b){var c=b.feature,d=a.getFeatureState(c.layer["source-layer"],c.id);c.source=c.layer.source,c.layer["source-layer"]&&(c.sourceLayer=c.layer["source-layer"]),c.state=d});return o}function j(a,b){var c=a.tileID,d=b.tileID;return c.overscaledZ-d.overscaledZ||c.canonical.y-d.canonical.y||c.wrap-d.wrap||c.canonical.x-d.canonical.x}function k(a,b){return a%32-b%32||b-a}function l(a){return"raster"===a||"image"===a||"video"===a}function m(){return new a.window.Worker(Zd.workerUrl)}function n(b,c){var d={};for(var e in b)"ref"!==e&&(d[e]=b[e]);return a.refProperties.forEach(function(a){a in c&&(d[a]=c[a])}),d}function o(a){a=a.slice();for(var b=Object.create(null),c=0;c<a.length;c++)b[a[c].id]=a[c];for(var d=0;d<a.length;d++)"ref"in a[d]&&(a[d]=n(a[d],b[a[d].ref]));return a}function p(a,b,c){c.push({command:Lb.addSource,args:[a,b[a]]})}function q(a,b,c){b.push({command:Lb.removeSource,args:[a]}),c[a]=!0}function r(a,b,c,d){q(a,c,d),p(a,b,c)}function s(b,c,d){var e;for(e in b[d])if(b[d].hasOwnProperty(e)&&"data"!==e&&!a.deepEqual(b[d][e],c[d][e]))return!1;for(e in c[d])if(c[d].hasOwnProperty(e)&&"data"!==e&&!a.deepEqual(b[d][e],c[d][e]))return!1;return!0}function t(b,c,d,e,f,g){var h;for(h in c=c||{},b=b||{})b.hasOwnProperty(h)&&(a.deepEqual(b[h],c[h])||d.push({command:g,args:[e,h,c[h],f]}));for(h in c)c.hasOwnProperty(h)&&!b.hasOwnProperty(h)&&(a.deepEqual(b[h],c[h])||d.push({command:g,args:[e,h,c[h],f]}))}function u(a){return a.id}function v(a,b){return a[b.id]=b,a}function w(b,c,d,e,f){var g=a.create();return c?(a.scale(g,g,[1/f,1/f,1]),d||a.rotateZ(g,g,e.angle)):a.multiply(g,e.labelPlaneMatrix,b),g}function x(b,c,d,e,f){if(c){var g=a.clone(b);return a.scale(g,g,[f,f,1]),d||a.rotateZ(g,g,-e.angle),g}return e.glCoordMatrix}function y(b,c){var d=[b.x,b.y,0,1];H(d,d,c);var e=d[3];return{point:new a.Point(d[0]/e,d[1]/e),signedDistanceFromCamera:e}}function z(a,b){var c=a[0]/a[3],d=a[1]/a[3];return c>=-b[0]&&c<=b[0]&&d>=-b[1]&&d<=b[1]}function A(b,c,d,e,f,g,h,i){var j=e?b.textSizeData:b.iconSizeData,k=a.evaluateSizeForZoom(j,d.transform.zoom),l=[256/d.width*2+1,256/d.height*2+1],m=e?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;m.clear();for(var n=b.lineVertexArray,o=e?b.text.placedSymbolArray:b.icon.placedSymbolArray,p=d.transform.width/d.transform.height,q=!1,r=0;r<o.length;r++){var s=o.get(r);if(s.hidden||s.writingMode===a.WritingMode.vertical&&!q)G(s.numGlyphs,m);else{q=!1;var t=[s.anchorX,s.anchorY,0,1];if(a.transformMat4(t,t,c),z(t,l)){var u=.5+t[3]/d.transform.cameraToCenterDistance*.5,v=a.evaluateSizeForFeature(j,k,s),w=h?v*u:v/u,x=new a.Point(s.anchorX,s.anchorY),A=y(x,f).point,B={},C=D(s,w,!1,i,c,f,g,b.glyphOffsetArray,n,m,A,x,B,p);q=C.useVertical,(C.notEnoughRoom||q||C.needsFlipping&&D(s,w,!0,i,c,f,g,b.glyphOffsetArray,n,m,A,x,B,p).notEnoughRoom)&&G(s.numGlyphs,m)}else G(s.numGlyphs,m)}}e?b.text.dynamicLayoutVertexBuffer.updateData(m):b.icon.dynamicLayoutVertexBuffer.updateData(m)}function B(a,b,c,d,e,f,g,h,i,j,k,l){var m=h.glyphStartIndex+h.numGlyphs,n=h.lineStartIndex,o=h.lineStartIndex+h.lineLength,p=b.getoffsetX(h.glyphStartIndex),q=b.getoffsetX(m-1),r=F(a*p,c,d,e,f,g,h.segment,n,o,i,j,k,l);if(!r)return null;var s=F(a*q,c,d,e,f,g,h.segment,n,o,i,j,k,l);return s?{first:r,last:s}:null}function C(b,c,d,e){return b===a.WritingMode.horizontal&&Math.abs(d.y-c.y)>Math.abs(d.x-c.x)*e?{useVertical:!0}:(b===a.WritingMode.vertical?c.y<d.y:c.x>d.x)?{needsFlipping:!0}:null}function D(b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p,q=c/24,r=b.lineOffsetX*q,s=b.lineOffsetY*q;if(b.numGlyphs>1){var t=b.glyphStartIndex+b.numGlyphs,u=b.lineStartIndex,v=b.lineStartIndex+b.lineLength,w=B(q,i,r,s,d,l,m,b,j,g,n,!1);if(!w)return{notEnoughRoom:!0};var x=y(w.first.point,h).point,z=y(w.last.point,h).point;if(e&&!d){var A=C(b.writingMode,x,z,o);if(A)return A}p=[w.first];for(var D=b.glyphStartIndex+1;D<t-1;D++)p.push(F(q*i.getoffsetX(D),r,s,d,l,m,b.segment,u,v,j,g,n,!1));p.push(w.last)}else{if(e&&!d){var G=y(m,f).point,H=b.lineStartIndex+b.segment+1,I=new a.Point(j.getx(H),j.gety(H)),J=y(I,f),K=J.signedDistanceFromCamera>0?J.point:E(m,I,G,1,f),L=C(b.writingMode,G,K,o);if(L)return L}var M=F(q*i.getoffsetX(b.glyphStartIndex),r,s,d,l,m,b.segment,b.lineStartIndex,b.lineStartIndex+b.lineLength,j,g,n,!1);if(!M)return{notEnoughRoom:!0};p=[M]}for(var N=0,O=p;N<O.length;N+=1){var P=O[N];a.addDynamicAttributes(k,P.point,P.angle)}return{}}function E(a,b,c,d,e){var f=y(a.add(a.sub(b)._unit()),e).point,g=c.sub(f);return c.add(g._mult(d/g.mag()))}function F(b,c,d,e,f,g,h,i,j,k,l,m,n){var o=e?b-c:b+c,p=o>0?1:-1,q=0;e&&(p*=-1,q=Math.PI),p<0&&(q+=Math.PI);for(var r=p>0?i+h:i+h+1,s=r,t=f,u=f,v=0,w=0,x=Math.abs(o);v+w<=x;){if((r+=p)<i||r>=j)return null;if(u=t,void 0===(t=m[r])){var z=new a.Point(k.getx(r),k.gety(r)),A=y(z,l);if(A.signedDistanceFromCamera>0)t=m[r]=A.point;else{var B=r-p;t=E(0===v?g:new a.Point(k.getx(B),k.gety(B)),z,u,x-v+1,l)}}v+=w,w=u.dist(t)}var C=(x-v)/w,D=t.sub(u),F=D.mult(C)._add(u);return F._add(D._unit()._perp()._mult(d*p)),{point:F,angle:q+Math.atan2(t.y-u.y,t.x-u.x),tileDistance:n?{prevTileDistance:r-p===s?0:k.gettileUnitDistanceFromAnchor(r-p),lastSegmentViewportDistance:x-v}:null}}function G(a,b){for(var c=0;c<a;c++){var d=b.length;b.resize(d+4),b.float32.set(Nb,3*d)}}function H(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[4]*e+c[12],a[1]=c[1]*d+c[5]*e+c[13],a[3]=c[3]*d+c[7]*e+c[15],a}function I(a,b,c){a[b+4]=c?1:0}function J(b,c,d){return c*(a.EXTENT/(b.tileSize*Math.pow(2,d-b.tileID.overscaledZ)))}function K(b,c,d,e,f){var g=a.getAnchorAlignment(b),h=-(g.horizontalAlign-.5)*c,i=-(g.verticalAlign-.5)*d,j=a.evaluateRadialOffset(b,e);return new a.Point(h+j[0]*f,i+j[1]*f)}function L(a,b,c,d,e){a.emplaceBack(b?1:0,c?1:0,d||0,e||0),a.emplaceBack(b?1:0,c?1:0,d||0,e||0),a.emplaceBack(b?1:0,c?1:0,d||0,e||0),a.emplaceBack(b?1:0,c?1:0,d||0,e||0)}function M(a){if(0===a.opacity&&!a.placed)return 0;if(1===a.opacity&&a.placed)return 4294967295;var b=a.placed?1:0,c=Math.floor(127*a.opacity);return c*Vb+b*Wb+c*Xb+b*Yb+c*Zb+b*$b+c*_b+b}function N(a,b){var c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d={};return{fragmentSource:a=a.replace(c,function(a,b,c,e,f){return d[f]=!0,"define"===b?"\n#ifndef HAS_UNIFORM_u_"+f+"\nvarying "+c+" "+e+" "+f+";\n#else\nuniform "+c+" "+e+" u_"+f+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+f+"\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n"}),vertexSource:b=b.replace(c,function(a,b,c,e,f){var g="float"===e?"vec2":"vec4",h=f.match(/color/)?"color":g;return d[f]?"define"===b?"\n#ifndef HAS_UNIFORM_u_"+f+"\nuniform lowp float u_"+f+"_t;\nattribute "+c+" "+g+" a_"+f+";\nvarying "+c+" "+e+" "+f+";\n#else\nuniform "+c+" "+e+" u_"+f+";\n#endif\n":"vec4"===h?"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+f+" = a_"+f+";\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+f+" = unpack_mix_"+h+"(a_"+f+", u_"+f+"_t);\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n":"define"===b?"\n#ifndef HAS_UNIFORM_u_"+f+"\nuniform lowp float u_"+f+"_t;\nattribute "+c+" "+g+" a_"+f+";\n#else\nuniform "+c+" "+e+" u_"+f+";\n#endif\n":"vec4"===h?"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+c+" "+e+" "+f+" = a_"+f+";\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+c+" "+e+" "+f+" = unpack_mix_"+h+"(a_"+f+", u_"+f+"_t);\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n"})}}function O(b,c,d){var e=1/J(d,1,c.transform.tileZoom),f=Math.pow(2,d.tileID.overscaledZ),g=d.tileSize*Math.pow(2,c.transform.tileZoom)/f,h=g*(d.tileID.canonical.x+d.tileID.wrap*f),i=g*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[a.browser.devicePixelRatio,e,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[h>>16,i>>16],u_pixel_coord_lower:[65535&h,65535&i]}}function P(b,c){var d=Math.pow(2,c.canonical.z),e=c.canonical.y;return[new a.MercatorCoordinate(0,e/d).toLngLat().lat,new a.MercatorCoordinate(0,(e+1)/d).toLngLat().lat]}function Q(a,b){return 1/J(a,1,b.tileZoom)}function R(a,b,c){return a.translatePosMatrix(b.tileID.posMatrix,b,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function S(b,c){for(var d=b.sort(function(a,b){return a.tileID.isLessThan(b.tileID)?-1:b.tileID.isLessThan(a.tileID)?1:0}),e=0;e<d.length;e++){var f={},g=d[e],h=d.slice(e+1);T(g.tileID.wrapped(),g.tileID,h,new a.OverscaledTileID(0,g.tileID.wrap+1,0,0,0),f),g.setMask(f,c)}}function T(b,c,d,e,f){for(var g=0;g<d.length;g++){var h=d[g];if(e.isLessThan(h.tileID))break;if(c.key===h.tileID.key)return;if(h.tileID.isChildOf(c)){for(var i=c.children(1/0),j=0;j<i.length;j++)T(b,i[j],d.slice(g),e,f);return}}var k=c.overscaledZ-b.overscaledZ,l=new a.CanonicalTileID(k,c.canonical.x-(b.canonical.x<<k),c.canonical.y-(b.canonical.y<<k));f[l.key]=f[l.key]||l}function U(a,b,c,d,e){for(var f=a.context,g=f.gl,h=e?a.useProgram("collisionCircle"):a.useProgram("collisionBox"),i=0;i<d.length;i++){var j=d[i],k=b.getTile(j),l=k.getBucket(c);if(l){var m=e?l.collisionCircle:l.collisionBox;m&&h.draw(f,e?g.TRIANGLES:g.LINES,Cb.disabled,Db.disabled,a.colorModeForRenderPass(),Fb.disabled,Wc(j.posMatrix,a.transform,k),c.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,a.transform.zoom,null,null,m.collisionVertexBuffer)}}}function V(b,c,d,e,f,g){var h=a.getAnchorAlignment(b),i=-(h.horizontalAlign-.5)*c,j=-(h.verticalAlign-.5)*d,k=a.evaluateRadialOffset(b,e);return new a.Point((i/f+k[0])*g,(j/f+k[1])*g)}function W(b,c,d,e,f,g,h,i,j,k){var l=b.text.placedSymbolArray,m=b.text.dynamicLayoutVertexArray;m.clear();for(var n=0;n<l.length;n++){var o=l.get(n),p=b.allowVerticalPlacement&&!o.placedOrientation,q=o.hidden||!o.crossTileID||p?null:e[o.crossTileID];if(q){var r=new a.Point(o.anchorX,o.anchorY),s=y(r,d?i:h),t=.5+g.cameraToCenterDistance/s.signedDistanceFromCamera*.5,u=f.evaluateSizeForFeature(b.textSizeData,k,o)*t/a.ONE_EM;d&&(u*=b.tilePixelRatio/j);for(var v=q.width,w=q.height,x=q.radialOffset,z=q.textBoxScale,A=V(q.anchor,v,w,x,z,u),B=d?y(r.add(A),h).point:s.point.add(c?A.rotate(-g.angle):A),C=b.allowVerticalPlacement&&o.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,D=0;D<o.numGlyphs;D++)a.addDynamicAttributes(m,B,C)}else G(o.numGlyphs,m)}b.text.dynamicLayoutVertexBuffer.updateData(m)}function X(b){var c=b.text.placedSymbolArray,d=b.text.dynamicLayoutVertexArray;d.clear();for(var e=0;e<c.length;e++){var f=c.get(e);if(f.hidden||!f.placedOrientation)G(f.numGlyphs,d);else for(var g=new a.Point(f.anchorX,f.anchorY),h=b.allowVerticalPlacement&&f.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,i=0;i<f.numGlyphs;i++)a.addDynamicAttributes(d,g,h)}b.text.dynamicLayoutVertexBuffer.updateData(d)}function Y(b,c,d,e,f,g,h,i,j,k,l,m,n){for(var o,p,q=b.context,r=q.gl,s=b.transform,t="map"===i,u="map"===j,v=t&&"point"!==d.layout.get("symbol-placement"),y=t&&!u&&!v,z=void 0!==d.layout.get("symbol-sort-key").constantOr(1),B=b.depthModeForSublayer(0,Cb.ReadOnly),C=d.layout.get("text-variable-anchor"),D=[],E=0,F=e;E<F.length;E+=1){var G=F[E],H=c.getTile(G),I=H.getBucket(d);if(I){var K=f?I.text:I.icon;if(K&&K.segments.get().length){var L=K.programConfigurations.get(d.id),M=f||I.sdfIcons,N=f?I.textSizeData:I.iconSizeData;o||(o=b.useProgram(M?"symbolSDF":"symbolIcon",L),p=a.evaluateSizeForZoom(N,s.zoom)),q.activeTexture.set(r.TEXTURE0);var O=void 0,P=void 0,Q=void 0;if(f)P=H.glyphAtlasTexture,Q=r.LINEAR,O=H.glyphAtlasTexture.size;else{var R=1!==d.layout.get("icon-size").constantOr(0)||I.iconsNeedLinear,S=u||0!==s.pitch;P=H.imageAtlasTexture,Q=M||b.options.rotating||b.options.zooming||R||S?r.LINEAR:r.NEAREST,O=H.imageAtlasTexture.size}var T=J(H,1,b.transform.zoom),U=w(G.posMatrix,u,t,b.transform,T),V=x(G.posMatrix,u,t,b.transform,T);if(v)A(I,G.posMatrix,b,f,U,V,u,k);else if(f&&p&&C){var Y=Math.pow(2,s.zoom-H.tileID.overscaledZ);W(I,t,u,n,a.symbolSize,s,U,G.posMatrix,Y,p)}else f&&p&&I.allowVerticalPlacement&&X(I);var $=b.translatePosMatrix(G.posMatrix,H,g,h),_=v||f&&C?kd:U,aa=b.translatePosMatrix(V,H,g,h,!0),ba=M&&0!==d.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1),ca={program:o,buffers:K,uniformValues:M?gd(N.kind,p,y,u,b,$,_,aa,f,O,!0):fd(N.kind,p,y,u,b,$,_,aa,f,O),atlasTexture:P,atlasInterpolation:Q,isSDF:M,hasHalo:ba};if(z)for(var da=0,ea=K.segments.get();da<ea.length;da+=1){var fa=ea[da];D.push({segments:new a.SegmentVector([fa]),sortKey:fa.sortKey,state:ca})}else D.push({segments:K.segments,sortKey:0,state:ca})}}}z&&D.sort(function(a,b){return a.sortKey-b.sortKey});for(var ga=0,ha=D;ga<ha.length;ga+=1){var ia=ha[ga],ja=ia.state;if(ja.atlasTexture.bind(ja.atlasInterpolation,r.CLAMP_TO_EDGE),ja.isSDF){var ka=ja.uniformValues;ja.hasHalo&&(ka.u_is_halo=1,Z(ja.buffers,ia.segments,d,b,ja.program,B,l,m,ka)),ka.u_is_halo=0}Z(ja.buffers,ia.segments,d,b,ja.program,B,l,m,ja.uniformValues)}}function Z(a,b,c,d,e,f,g,h,i){var j=d.context,k=j.gl;e.draw(j,k.TRIANGLES,f,g,h,Fb.disabled,i,c.id,a.layoutVertexBuffer,a.indexBuffer,b,c.paint,d.transform.zoom,a.programConfigurations.get(c.id),a.dynamicLayoutVertexBuffer,a.opacityVertexBuffer)}function $(a,b,c,d,e,f,g){var h,i,j,k,l,m=a.context.gl,n=c.paint.get("fill-pattern"),o=n&&n.constantOr(1),p=c.getCrossfadeParameters();g?(i=o&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",h=m.LINES):(i=o?"fillPattern":"fill",h=m.TRIANGLES);for(var q=0,r=d;q<r.length;q+=1){var s=r[q],t=b.getTile(s);if(!o||t.patternsLoaded()){var u=t.getBucket(c);if(u){var v=u.programConfigurations.get(c.id),w=a.useProgram(i,v);o&&(a.context.activeTexture.set(m.TEXTURE0),t.imageAtlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),v.updatePatternPaintBuffers(p));var x=n.constantOr(null);if(x&&t.imageAtlas){var y=t.imageAtlas.patternPositions[x.to],z=t.imageAtlas.patternPositions[x.from];y&&z&&v.setConstantPatternPositions(y,z)}var A=a.translatePosMatrix(s.posMatrix,t,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(g){k=u.indexBuffer2,l=u.segments2;var B=[m.drawingBufferWidth,m.drawingBufferHeight];j="fillOutlinePattern"===i&&o?Tc(A,a,p,t,B):Sc(A,B)}else k=u.indexBuffer,l=u.segments,j=o?Rc(A,a,p,t):Qc(A);w.draw(a.context,h,e,a.stencilModeForClipping(s),f,Fb.disabled,j,c.id,u.layoutVertexBuffer,k,l,c.paint,a.transform.zoom,v)}}}}function _(a,b,c,d,e,f,g){for(var h=a.context,i=h.gl,j=c.paint.get("fill-extrusion-pattern"),k=j.constantOr(1),l=c.getCrossfadeParameters(),m=c.paint.get("fill-extrusion-opacity"),n=0,o=d;n<o.length;n+=1){var p=o[n],q=b.getTile(p),r=q.getBucket(c);if(r){var s=r.programConfigurations.get(c.id),t=a.useProgram(k?"fillExtrusionPattern":"fillExtrusion",s);k&&(a.context.activeTexture.set(i.TEXTURE0),q.imageAtlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE),s.updatePatternPaintBuffers(l));var u=j.constantOr(null);if(u&&q.imageAtlas){var v=q.imageAtlas.patternPositions[u.to],w=q.imageAtlas.patternPositions[u.from]
;v&&w&&s.setConstantPatternPositions(v,w)}var x=a.translatePosMatrix(p.posMatrix,q,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),y=c.paint.get("fill-extrusion-vertical-gradient"),z=k?Pc(x,a,y,m,p,l,q):Oc(x,a,y,m);t.draw(h,h.gl.TRIANGLES,e,f,g,Fb.backCCW,z,c.id,r.layoutVertexBuffer,r.indexBuffer,r.segments,c.paint,a.transform.zoom,s)}}}function aa(a,b,c,d,e,f){var g=a.context,h=g.gl,i=b.fbo;if(i){var j=a.useProgram("hillshade");g.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,i.colorAttachment.get());var k=$c(a,b,c);b.maskedBoundsBuffer&&b.maskedIndexBuffer&&b.segments?j.draw(g,h.TRIANGLES,d,e,f,Fb.disabled,k,c.id,b.maskedBoundsBuffer,b.maskedIndexBuffer,b.segments):j.draw(g,h.TRIANGLES,d,e,f,Fb.disabled,k,c.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}}function ba(b,c,d,e,f,g,h){var i=b.context,j=i.gl;if(c.dem&&c.dem.data){var k=c.dem.dim,l=c.dem.stride,m=c.dem.getPixels();if(i.activeTexture.set(j.TEXTURE1),i.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||b.getTileTexture(l),c.demTexture){var n=c.demTexture;n.update(m,{premultiply:!1}),n.bind(j.NEAREST,j.CLAMP_TO_EDGE)}else c.demTexture=new a.Texture(i,m,j.RGBA,{premultiply:!1}),c.demTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE);i.activeTexture.set(j.TEXTURE0);var o=c.fbo;if(!o){var p=new a.Texture(i,{width:k,height:k,data:null},j.RGBA);p.bind(j.LINEAR,j.CLAMP_TO_EDGE),(o=c.fbo=i.createFramebuffer(k,k)).colorAttachment.set(p.texture)}i.bindFramebuffer.set(o.framebuffer),i.viewport.set([0,0,k,k]),b.useProgram("hillshadePrepare").draw(i,j.TRIANGLES,f,g,h,Fb.disabled,_c(c,e),d.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function ca(b,c,d,e,f){var g=e.paint.get("raster-fade-duration");if(g>0){var h=a.browser.now(),i=(h-b.timeAdded)/g,j=c?(h-c.timeAdded)/g:-1,k=d.getSource(),l=f.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),m=!c||Math.abs(c.tileID.overscaledZ-l)>Math.abs(b.tileID.overscaledZ-l),n=m&&b.refreshedUponExpiration?1:a.clamp(m?i:1-j,0,1);return b.refreshedUponExpiration&&i>=1&&(b.refreshedUponExpiration=!1),c?{opacity:1,mix:1-n}:{opacity:n,mix:0}}return{opacity:1,mix:0}}function da(b,c,d){var e=b.context,f=e.gl,g=d.posMatrix,h=b.useProgram("debug"),i=Cb.disabled,j=Db.disabled,k=b.colorModeForRenderPass(),l="$debug";h.draw(e,f.LINE_STRIP,i,j,k,Fb.disabled,Xc(g,a.Color.red),l,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments);for(var m=c.getTileByID(d.key).latestRawTileData,n=m&&m.byteLength||0,o=Math.floor(n/1024),p=c.getTile(d).tileSize,q=512/Math.min(p,512),r=function(a,b,c,d){d=d||1;var e,f,g,h,i,j,k,l,m=[];for(e=0,f=a.length;e<f;e++)if(i=ld[a[e]]){for(l=null,g=0,h=i[1].length;g<h;g+=2)-1===i[1][g]&&-1===i[1][g+1]?l=null:(j=b+i[1][g]*d,k=c-i[1][g+1]*d,l&&m.push(l.x,l.y,j,k),l={x:j,y:k});b+=i[0]*d}return m}(d.toString()+" "+o+"kb",50,200*q,5*q),s=new a.StructArrayLayout2i4,t=new a.StructArrayLayout2ui4,u=0;u<r.length;u+=2)s.emplaceBack(r[u],r[u+1]),t.emplaceBack(u,u+1);for(var v=e.createVertexBuffer(s,lc.members),w=e.createIndexBuffer(t),x=a.SegmentVector.simpleSegment(0,0,s.length/2,s.length/2),y=a.EXTENT/(Math.pow(2,b.transform.zoom-d.overscaledZ)*p*q),z=[],A=-1;A<=1;A++)for(var B=-1;B<=1&&(0!==A||0!==B);B++)z.push([A,B]);for(var C=0;C<z.length;C++){var D=z[C];h.draw(e,f.LINES,i,j,k,Fb.disabled,Xc(a.translate([],g,[y*D[0],y*D[1],0]),a.Color.white),l,v,w,x)}h.draw(e,f.LINES,i,j,k,Fb.disabled,Xc(g,a.Color.black),l,v,w,x)}function ea(a,b){if(a.y>b.y){var c=a;a=b,b=c}return{x0:a.x,y0:a.y,x1:b.x,y1:b.y,dx:b.x-a.x,dy:b.y-a.y}}function fa(a,b,c,d,e){var f=Math.max(c,Math.floor(b.y0)),g=Math.min(d,Math.ceil(b.y1));if(a.x0===b.x0&&a.y0===b.y0?a.x0+b.dy/a.dy*a.dx<b.x1:a.x1-b.dy/a.dy*a.dx<b.x0){var h=a;a=b,b=h}for(var i=a.dx/a.dy,j=b.dx/b.dy,k=a.dx>0,l=b.dx<0,m=f;m<g;m++){var n=i*Math.max(0,Math.min(a.dy,m+k-a.y0))+a.x0,o=j*Math.max(0,Math.min(b.dy,m+l-b.y0))+b.x0;e(Math.floor(o),Math.ceil(n),m)}}function ga(a,b,c,d,e,f){var g,h=ea(a,b),i=ea(b,c),j=ea(c,a);h.dy>i.dy&&(g=h,h=i,i=g),h.dy>j.dy&&(g=h,h=j,j=g),i.dy>j.dy&&(g=i,i=j,j=g),h.dy&&fa(j,h,d,e,f),i.dy&&fa(j,i,d,e,f)}function ha(a){return a*(2-a)}function ia(a){a.parentNode&&a.parentNode.removeChild(a)}function ja(b,c,d){if(b=new a.LngLat(b.lng,b.lat),c){var e=new a.LngLat(b.lng-360,b.lat),f=new a.LngLat(b.lng+360,b.lat),g=d.locationPoint(b).distSqr(c);d.locationPoint(e).distSqr(c)<g?b=e:d.locationPoint(f).distSqr(c)<g&&(b=f)}for(;Math.abs(b.lng-d.center.lng)>180;){var h=d.locationPoint(b);if(h.x>=0&&h.y>=0&&h.x<=d.width&&h.y<=d.height)break;b.lng>d.center.lng?b.lng-=360:b.lng+=360}return b}function ka(a,b,c){var d=a.classList;for(var e in Qd)d.remove("mapboxgl-"+c+"-anchor-"+e);d.add("mapboxgl-"+c+"-anchor-"+b)}function la(a,b,c){var d,e,f,g,h,i,j=c&&c.maxWidth||100,k=a._container.clientHeight/2,l=(d=a.unproject([0,k]),e=a.unproject([j,k]),f=Math.PI/180,g=d.lat*f,h=e.lat*f,i=Math.sin(g)*Math.sin(h)+Math.cos(g)*Math.cos(h)*Math.cos((e.lng-d.lng)*f),6371e3*Math.acos(Math.min(i,1)));if(c&&"imperial"===c.unit){var m=3.2808*l;m>5280?ma(b,j,m/5280,"mi"):ma(b,j,m,"ft")}else c&&"nautical"===c.unit?ma(b,j,l/1852,"nm"):ma(b,j,l,"m")}function ma(a,b,c,d){var e,f,g,h=(e=c,(f=Math.pow(10,(""+Math.floor(e)).length-1))*(g=(g=e/f)>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(a){var b=Math.pow(10,Math.ceil(-Math.log(a)/Math.LN10));return Math.round(a*b)/b}(g))),i=h/c;"m"===d&&h>=1e3&&(h/=1e3,d="km"),a.style.width=b*i+"px",a.innerHTML=h+d}var na,oa=a.createCommonjsModule(function(a){function b(a){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var a,b,c=new Blob([""],{type:"text/javascript"}),d=URL.createObjectURL(c);try{b=new Worker(d),a=!0}catch(b){a=!1}return b&&b.terminate(),URL.revokeObjectURL(d),a}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&function(a){return void 0===c[a]&&(c[a]=function(a){var c=document.createElement("canvas"),d=Object.create(b.webGLContextAttributes);return d.failIfMajorPerformanceCaveat=a,c.probablySupportsContext?c.probablySupportsContext("webgl",d)||c.probablySupportsContext("experimental-webgl",d):c.supportsContext?c.supportsContext("webgl",d)||c.supportsContext("experimental-webgl",d):c.getContext("webgl",d)||c.getContext("experimental-webgl",d)}(a)),c[a]}(a&&a.failIfMajorPerformanceCaveat))}a.exports?a.exports=b:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=b);var c={};b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),pa={create:function(b,c,d){var e=a.window.document.createElement(b);return void 0!==c&&(e.className=c),d&&d.appendChild(e),e},createNS:function(b,c){return a.window.document.createElementNS(b,c)}},qa=a.window.document.documentElement.style,ra=b(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);pa.disableDrag=function(){qa&&ra&&(na=qa[ra],qa[ra]="none")},pa.enableDrag=function(){qa&&ra&&(qa[ra]=na)};var sa=b(["transform","WebkitTransform"]);pa.setTransform=function(a,b){a.style[sa]=b};var ta=!1;try{var ua=Object.defineProperty({},"passive",{get:function(){ta=!0}});a.window.addEventListener("test",ua,ua),a.window.removeEventListener("test",ua,ua)}catch(a){ta=!1}pa.addEventListener=function(a,b,c,d){void 0===d&&(d={}),"passive"in d&&ta?a.addEventListener(b,c,d):a.addEventListener(b,c,d.capture)},pa.removeEventListener=function(a,b,c,d){void 0===d&&(d={}),"passive"in d&&ta?a.removeEventListener(b,c,d):a.removeEventListener(b,c,d.capture)};var va=function(b){b.preventDefault(),b.stopPropagation(),a.window.removeEventListener("click",va,!0)};pa.suppressClick=function(){a.window.addEventListener("click",va,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",va,!0)},0)},pa.mousePos=function(b,c){var d=b.getBoundingClientRect(),e=a.window.TouchEvent&&c instanceof a.window.TouchEvent?c.touches[0]:c;return new a.Point(e.clientX-d.left-b.clientLeft,e.clientY-d.top-b.clientTop)},pa.touchPos=function(b,c){for(var d=b.getBoundingClientRect(),e=[],f="touchend"===c.type?c.changedTouches:c.touches,g=0;g<f.length;g++)e.push(new a.Point(f[g].clientX-d.left-b.clientLeft,f[g].clientY-d.top-b.clientTop));return e},pa.mouseButton=function(b){return void 0!==a.window.InstallTrigger&&2===b.button&&b.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:b.button},pa.remove=function(a){a.parentNode&&a.parentNode.removeChild(a)};var wa=function(b){function d(){b.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return b&&(d.__proto__=b),d.prototype=Object.create(b&&b.prototype),d.prototype.constructor=d,d.prototype.isLoaded=function(){return this.loaded},d.prototype.setLoaded=function(a){if(this.loaded!==a&&(this.loaded=a,a)){for(var b=0,c=this.requestors;b<c.length;b+=1){var d=c[b],e=d.ids,f=d.callback;this._notify(e,f)}this.requestors=[]}},d.prototype.getImage=function(a){return this.images[a]},d.prototype.addImage=function(a,b){this.images[a]=b},d.prototype.updateImage=function(a,b){var c=this.images[a];b.version=c.version+1,this.images[a]=b,this.updatedImages[a]=!0},d.prototype.removeImage=function(a){var b=this.images[a];delete this.images[a],delete this.patterns[a],b.userImage&&b.userImage.onRemove&&b.userImage.onRemove()},d.prototype.listImages=function(){return Object.keys(this.images)},d.prototype.getImages=function(a,b){var c=!0;if(!this.isLoaded())for(var d=0,e=a;d<e.length;d+=1){var f=e[d];this.images[f]||(c=!1)}this.isLoaded()||c?this._notify(a,b):this.requestors.push({ids:a,callback:b})},d.prototype._notify=function(b,c){for(var d={},e=0,f=b;e<f.length;e+=1){var g=f[e];this.images[g]||this.fire(new a.Event("styleimagemissing",{id:g}));var h=this.images[g];h?d[g]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,hasRenderCallback:Boolean(h.userImage&&h.userImage.render)}:a.warnOnce('Image "'+g+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}c(null,d)},d.prototype.getPixelSize=function(){var a=this.atlasImage;return{width:a.width,height:a.height}},d.prototype.getPattern=function(b){var c=this.patterns[b],d=this.getImage(b);if(!d)return null;if(c&&c.position.version===d.version)return c.position;if(c)c.position.version=d.version;else{var e={w:d.data.width+2,h:d.data.height+2,x:0,y:0},f=new a.ImagePosition(e,d);this.patterns[b]={bin:e,position:f}}return this._updatePatternAtlas(),this.patterns[b].position},d.prototype.bind=function(b){var c=b.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(b,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)},d.prototype._updatePatternAtlas=function(){var b=[];for(var c in this.patterns)b.push(this.patterns[c].bin);var d=a.potpack(b),e=d.w,f=d.h,g=this.atlasImage;for(var h in g.resize({width:e||1,height:f||1}),this.patterns){var i=this.patterns[h].bin,j=i.x+1,k=i.y+1,l=this.images[h].data,m=l.width,n=l.height;a.RGBAImage.copy(l,g,{x:0,y:0},{x:j,y:k},{width:m,height:n}),a.RGBAImage.copy(l,g,{x:0,y:n-1},{x:j,y:k-1},{width:m,height:1}),a.RGBAImage.copy(l,g,{x:0,y:0},{x:j,y:k+n},{width:m,height:1}),a.RGBAImage.copy(l,g,{x:m-1,y:0},{x:j-1,y:k},{width:1,height:n}),a.RGBAImage.copy(l,g,{x:0,y:0},{x:j+m,y:k},{width:1,height:n})}this.dirty=!0},d.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},d.prototype.dispatchRenderCallbacks=function(a){for(var b=0,d=a;b<d.length;b+=1){var e=d[b];if(!this.callbackDispatchedThisFrame[e]){this.callbackDispatchedThisFrame[e]=!0;var f=this.images[e];c(f)&&this.updateImage(e,f)}}},d}(a.Evented),xa=d,ya=d,za=1e20;d.prototype.draw=function(a){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(a,this.buffer,this.middle);for(var b=this.ctx.getImageData(0,0,this.size,this.size),c=new Uint8ClampedArray(this.size*this.size),d=0;d<this.size*this.size;d++){var f=b.data[4*d+3]/255;this.gridOuter[d]=1===f?0:0===f?za:Math.pow(Math.max(0,.5-f),2),this.gridInner[d]=1===f?za:0===f?0:Math.pow(Math.max(0,f-.5),2)}for(e(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),e(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),d=0;d<this.size*this.size;d++){var g=this.gridOuter[d]-this.gridInner[d];c[d]=Math.max(0,Math.min(255,Math.round(255-255*(g/this.radius+this.cutoff))))}return c},xa.default=ya;var Aa=function(a,b){this.requestManager=a,this.localIdeographFontFamily=b,this.entries={}};Aa.prototype.setURL=function(a){this.url=a},Aa.prototype.getGlyphs=function(b,c){var d=this,e=[];for(var f in b)for(var g=0,h=b[f];g<h.length;g+=1){var i=h[g];e.push({stack:f,id:i})}a.asyncAll(e,function(a,b){var c=a.stack,e=a.id,f=d.entries[c];f||(f=d.entries[c]={glyphs:{},requests:{}});var g=f.glyphs[e];if(void 0===g){if(g=d._tinySDF(f,c,e))return f.glyphs[e]=g,void b(null,{stack:c,id:e,glyph:g});var h=Math.floor(e/256);if(256*h>65535)b(new Error("glyphs > 65535 not supported"));else{var i=f.requests[h];i||(i=f.requests[h]=[],Aa.loadGlyphRange(c,h,d.url,d.requestManager,function(a,b){if(b)for(var c in b)d._doesCharSupportLocalGlyph(+c)||(f.glyphs[+c]=b[+c]);for(var e=0,g=i;e<g.length;e+=1)(0,g[e])(a,b);delete f.requests[h]})),i.push(function(a,d){a?b(a):d&&b(null,{stack:c,id:e,glyph:d[e]||null})})}}else b(null,{stack:c,id:e,glyph:g})},function(a,b){if(a)c(a);else if(b){for(var d={},e=0,f=b;e<f.length;e+=1){var g=f[e],h=g.stack,i=g.id,j=g.glyph;(d[h]||(d[h]={}))[i]=j&&{id:j.id,bitmap:j.bitmap.clone(),metrics:j.metrics}}c(null,d)}})},Aa.prototype._doesCharSupportLocalGlyph=function(b){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](b)||a.isChar["Hangul Syllables"](b)||a.isChar.Hiragana(b)||a.isChar.Katakana(b))},Aa.prototype._tinySDF=function(b,c,d){var e=this.localIdeographFontFamily;if(e&&this._doesCharSupportLocalGlyph(d)){var f=b.tinySDF;if(!f){var g="400";/bold/i.test(c)?g="900":/medium/i.test(c)?g="500":/light/i.test(c)&&(g="200"),f=b.tinySDF=new Aa.TinySDF(24,3,8,.25,e,g)}return{id:d,bitmap:new a.AlphaImage({width:30,height:30},f.draw(String.fromCharCode(d))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Aa.loadGlyphRange=function(b,c,d,e,f){var g=256*c,h=g+255,i=e.transformRequest(e.normalizeGlyphsURL(d).replace("{fontstack}",b).replace("{range}",g+"-"+h),a.ResourceType.Glyphs);a.getArrayBuffer(i,function(b,c){if(b)f(b);else if(c){for(var d={},e=0,g=a.parseGlyphPBF(c);e<g.length;e+=1){var h=g[e];d[h.id]=h}f(null,d)}})},Aa.TinySDF=xa;var Ba=function(){this.specification=a.styleSpec.light.position};Ba.prototype.possiblyEvaluate=function(b,c){return a.sphericalToCartesian(b.expression.evaluate(c))},Ba.prototype.interpolate=function(b,c,d){return{x:a.number(b.x,c.x,d),y:a.number(b.y,c.y,d),z:a.number(b.z,c.z,d)}};var Ca=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new Ba,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),Da=function(b){function c(c){b.call(this),this._transitionable=new a.Transitionable(Ca),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getLight=function(){return this._transitionable.serialize()},c.prototype.setLight=function(b,c){if(void 0===c&&(c={}),!this._validate(a.validateLight,b,c))for(var d in b){var e=b[d];a.endsWith(d,"-transition")?this._transitionable.setTransition(d.slice(0,-"-transition".length),e):this._transitionable.setValue(d,e)}},c.prototype.updateTransitions=function(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)},c.prototype.hasTransition=function(){return this._transitioning.hasTransition()},c.prototype.recalculate=function(a){this.properties=this._transitioning.possiblyEvaluate(a)},c.prototype._validate=function(b,c,d){return(!d||!1!==d.validate)&&a.emitValidationErrors(this,b.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},c}(a.Evented),Ea=function(a,b){this.width=a,this.height=b,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};Ea.prototype.getDash=function(a,b){var c=a.join(",")+String(b);return this.positions[c]||(this.positions[c]=this.addDash(a,b)),this.positions[c]},Ea.prototype.addDash=function(b,c){var d=c?7:0,e=2*d+1;if(this.nextRow+e>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var f=0,g=0;g<b.length;g++)f+=b[g];for(var h=this.width/f,i=h/2,j=b.length%2==1,k=-d;k<=d;k++)for(var l=this.nextRow+d+k,m=this.width*l,n=j?-b[b.length-1]:0,o=b[0],p=1,q=0;q<this.width;q++){for(;o<q/h;)n=o,o+=b[p],j&&p===b.length-1&&(o+=b[0]),p++;var r=Math.abs(q-n*h),s=Math.abs(q-o*h),t=Math.min(r,s),u=p%2==1,v=void 0;if(c){var w=d?k/d*(i+1):0;if(u){var x=i-Math.abs(w);v=Math.sqrt(t*t+x*x)}else v=i-Math.sqrt(t*t+w*w)}else v=(u?1:-1)*t;this.data[3+4*(m+q)]=Math.max(0,Math.min(255,v+128))}var y={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:f};return this.nextRow+=e,this.dirty=!0,y},Ea.prototype.bind=function(a){var b=a.gl;this.texture?(b.bindTexture(b.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,b.texSubImage2D(b.TEXTURE_2D,0,0,0,this.width,this.height,b.RGBA,b.UNSIGNED_BYTE,this.data))):(this.texture=b.createTexture(),b.bindTexture(b.TEXTURE_2D,this.texture),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,this.width,this.height,0,b.RGBA,b.UNSIGNED_BYTE,this.data))};var Fa=function b(c,d){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var e=this.workerPool.acquire(this.id),f=0;f<e.length;f++){var g=e[f],h=new b.Actor(g,d,this.id);h.name="Worker "+f,this.actors.push(h)}};Fa.prototype.broadcast=function(b,c,d){d=d||function(){},a.asyncAll(this.actors,function(a,d){a.send(b,c,d)},d)},Fa.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Fa.prototype.remove=function(){this.actors.forEach(function(a){a.remove()}),this.actors=[],this.workerPool.release(this.id)},Fa.Actor=a.Actor;var Ga=function(b,c,d){this.bounds=a.LngLatBounds.convert(this.validateBounds(b)),this.minzoom=c||0,this.maxzoom=d||24};Ga.prototype.validateBounds=function(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]},Ga.prototype.contains=function(b){var c=Math.pow(2,b.z),d=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*c),e=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*c),f=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*c),g=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*c);return b.x>=d&&b.x<f&&b.y>=e&&b.y<g};var Ha=function(b){function c(c,d,e,f){if(b.call(this),this.id=c,this.dispatcher=e,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(d,["url","scheme","tileSize"])),this._options=a.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=g(this._options,this.map._requestManager,function(c,d){b._tileJSONRequest=null,b._loaded=!0,c?b.fire(new a.ErrorEvent(c)):d&&(a.extend(b,d),d.bounds&&(b.tileBounds=new Ga(d.bounds,b.minzoom,b.maxzoom)),a.postTurnstileEvent(d.tiles,b.map._requestManager._customAccessToken),a.postMapLoadEvent(d.tiles,b.map._getMapId(),b.map._requestManager._skuToken,b.map._requestManager._customAccessToken),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},c.prototype.loaded=function(){return this._loaded},c.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},c.prototype.serialize=function(){return a.extend({},this._options)},c.prototype.loadTile=function(b,c){function d(d,e){return delete b.request,b.aborted?c(null):d&&404!==d.status?c(d):(e&&e.resourceTiming&&(b.resourceTiming=e.resourceTiming),this.map._refreshExpiredTiles&&e&&b.setExpiryData(e),b.loadVectorData(e,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(b.reloadCallback&&(this.loadTile(b,b.reloadCallback),b.reloadCallback=null)))}var e=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.url,null),f={request:this.map._requestManager.transformRequest(e,a.ResourceType.Tile),uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,tileSize:this.tileSize*b.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};f.request.collectResourceTiming=this._collectResourceTiming,b.actor&&"expired"!==b.state?"loading"===b.state?b.reloadCallback=c:b.request=b.actor.send("reloadTile",f,d.bind(this)):(b.actor=this.dispatcher.getActor(),b.request=b.actor.send("loadTile",f,d.bind(this)))},c.prototype.abortTile=function(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id},void 0)},c.prototype.unloadTile=function(a){a.unloadVectorData(),a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id},void 0)},c.prototype.hasTransition=function(){return!1},c}(a.Evented),Ia=function(b){function c(c,d,e,f){b.call(this),this.id=c,this.dispatcher=e,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},d),a.extend(this,a.pick(d,["url","scheme","tileSize"]))}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=g(this._options,this.map._requestManager,function(c,d){b._tileJSONRequest=null,b._loaded=!0,c?b.fire(new a.ErrorEvent(c)):d&&(a.extend(b,d),d.bounds&&(b.tileBounds=new Ga(d.bounds,b.minzoom,b.maxzoom)),a.postTurnstileEvent(d.tiles),a.postMapLoadEvent(d.tiles,b.map._getMapId(),b.map._requestManager._skuToken),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},c.prototype.loaded=function(){return this._loaded},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},c.prototype.serialize=function(){return a.extend({},this._options)},c.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},c.prototype.loadTile=function(b,c){var d=this,e=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);b.request=a.getImage(this.map._requestManager.transformRequest(e,a.ResourceType.Tile),function(e,f){if(delete b.request,b.aborted)b.state="unloaded",c(null);else if(e)b.state="errored",c(e);else if(f){d.map._refreshExpiredTiles&&b.setExpiryData(f),delete f.cacheControl,delete f.expires;var g=d.map.painter.context,h=g.gl;b.texture=d.map.painter.getTileTexture(f.width),b.texture?b.texture.update(f,{useMipmap:!0}):(b.texture=new a.Texture(g,f,h.RGBA,{useMipmap:!0}),b.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE,h.LINEAR_MIPMAP_NEAREST),g.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,g.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,g.extTextureFilterAnisotropicMax)),b.state="loaded",a.cacheEntryPossiblyAdded(d.dispatcher),c(null)}})},c.prototype.abortTile=function(a,b){a.request&&(a.request.cancel(),delete a.request),b()},c.prototype.unloadTile=function(a,b){a.texture&&this.map.painter.saveTileTexture(a.texture),b()},c.prototype.hasTransition=function(){return!1},c}(a.Evented),Ja=function(b){function c(c,d,e,f){b.call(this,c,d,e,f),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},c.prototype.loadTile=function(b,c){var d=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);b.request=a.getImage(this.map._requestManager.transformRequest(d,a.ResourceType.Tile),function(d,e){if(delete b.request,b.aborted)b.state="unloaded",c(null);else if(d)b.state="errored",c(d);else if(e){this.map._refreshExpiredTiles&&b.setExpiryData(e),delete e.cacheControl,delete e.expires;var f=a.browser.getImageData(e),g={uid:b.uid,coord:b.tileID,source:this.id,rawImageData:f,encoding:this.encoding};b.actor&&"expired"!==b.state||(b.actor=this.dispatcher.getActor(),b.actor.send("loadDEMTile",g,function(a,d){a&&(b.state="errored",c(a)),d&&(b.dem=d,b.needsHillshadePrepare=!0,b.state="loaded",c(null))}.bind(this)))}}.bind(this)),b.neighboringTiles=this._getNeighboringTiles(b.tileID)},c.prototype._getNeighboringTiles=function(b){var c=b.canonical,d=Math.pow(2,c.z),e=(c.x-1+d)%d,f=0===c.x?b.wrap-1:b.wrap,g=(c.x+1+d)%d,h=c.x+1===d?b.wrap+1:b.wrap,i={};return i[new a.OverscaledTileID(b.overscaledZ,f,c.z,e,c.y).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,h,c.z,g,c.y).key]={backfilled:!1},c.y>0&&(i[new a.OverscaledTileID(b.overscaledZ,f,c.z,e,c.y-1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,b.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,h,c.z,g,c.y-1).key]={backfilled:!1}),c.y+1<d&&(i[new a.OverscaledTileID(b.overscaledZ,f,c.z,e,c.y+1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,b.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,h,c.z,g,c.y+1).key]={backfilled:!1}),i},c.prototype.unloadTile=function(a){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.fbo&&(a.fbo.destroy(),delete a.fbo),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded",a.actor&&a.actor.send("removeDEMTile",{uid:a.uid,source:this.id})},c}(Ia),Ka=function(b){function c(c,d,e,f){b.call(this),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=e.getActor(),this.setEventedParent(f),this._data=d.data,this._options=a.extend({},d),this._collectResourceTiming=d.collectResourceTiming,this._resourceTiming=[],void 0!==d.maxzoom&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution);var g=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(void 0!==d.buffer?d.buffer:128)*g,tolerance:(void 0!==d.tolerance?d.tolerance:.375)*g,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:void 0!==d.clusterMaxZoom?Math.min(d.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:a.EXTENT,radius:(d.clusterRadius||50)*g,log:!1},clusterProperties:d.clusterProperties},d.workerOptions)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(c){if(c)b.fire(new a.ErrorEvent(c));else{var d={dataType:"source",sourceDataType:"metadata"};b._collectResourceTiming&&b._resourceTiming&&b._resourceTiming.length>0&&(d.resourceTiming=b._resourceTiming,b._resourceTiming=[]),b.fire(new a.Event("data",d))}})},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.setData=function(b){var c=this;return this._data=b,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(b){if(b)c.fire(new a.ErrorEvent(b));else{var d={dataType:"source",sourceDataType:"content"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(d.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new a.Event("data",d))}}),this},c.prototype.getClusterExpansionZoom=function(a,b){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},b),this},c.prototype.getClusterChildren=function(a,b){return this.actor.send("geojson.getClusterChildren",{clusterId:a,source:this.id},b),this},c.prototype.getClusterLeaves=function(a,b,c,d){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:b,offset:c},d),this},c.prototype._updateWorkerData=function(b){var c=this;this._loaded=!1;var d=a.extend({},this.workerOptions),e=this._data;"string"==typeof e?(d.request=this.map._requestManager.transformRequest(a.browser.resolveURL(e),a.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(e),this.actor.send(this.type+".loadData",d,function(a,e){c._removed||e&&e.abandoned||(c._loaded=!0,e&&e.resourceTiming&&e.resourceTiming[c.id]&&(c._resourceTiming=e.resourceTiming[c.id].slice(0)),c.actor.send(c.type+".coalesce",{source:d.source},null),b(a))})},c.prototype.loaded=function(){return this._loaded},c.prototype.loadTile=function(b,c){var d=this,e=b.actor?"reloadTile":"loadTile";b.actor=this.actor;var f={type:this.type,uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};b.request=this.actor.send(e,f,function(a,f){return delete b.request,b.unloadVectorData(),b.aborted?c(null):a?c(a):(b.loadVectorData(f,d.map.painter,"reloadTile"===e),c(null))})},c.prototype.abortTile=function(a){a.request&&(a.request.cancel(),delete a.request),a.aborted=!0},c.prototype.unloadTile=function(a){a.unloadVectorData(),this.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id})},c.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},c.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},c.prototype.hasTransition=function(){return!1},c}(a.Evented),La=function(b){function c(a,c,d,e){b.call(this),this.id=a,this.dispatcher=d,
this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(e),this.options=c}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(b,c){var d=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(e,f){d._loaded=!0,e?d.fire(new a.ErrorEvent(e)):f&&(d.image=f,b&&(d.coordinates=b),c&&c(),d._finishLoading())})},c.prototype.loaded=function(){return this._loaded},c.prototype.updateImage=function(a){var b=this;return this.image&&a.url?(this.options.url=a.url,this.load(a.coordinates,function(){b.texture=null}),this):this},c.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.setCoordinates=function(b){var c=this;this.coordinates=b;var d=b.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(b){for(var c=1/0,d=1/0,e=-1/0,f=-1/0,g=0,h=b;g<h.length;g+=1){var i=h[g];c=Math.min(c,i.x),d=Math.min(d,i.y),e=Math.max(e,i.x),f=Math.max(f,i.y)}var j=e-c,k=f-d,l=Math.max(j,k),m=Math.max(0,Math.floor(-Math.log(l)/Math.LN2)),n=Math.pow(2,m);return new a.CanonicalTileID(m,Math.floor((c+e)/2*n),Math.floor((d+f)/2*n))}(d),this.minzoom=this.maxzoom=this.tileID.z;var e=d.map(function(a){return c.tileID.getTilePoint(a)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(e[0].x,e[0].y,0,0),this._boundsArray.emplaceBack(e[1].x,e[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(e[3].x,e[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(e[2].x,e[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},c.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var b=this.map.painter.context,c=b.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,a.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(b,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var e=this.tiles[d];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}},c.prototype.loadTile=function(a,b){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},b(null)):(a.state="errored",b(null))},c.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},c.prototype.hasTransition=function(){return!1},c}(a.Evented),Ma=function(b){function c(a,c,d,e){b.call(this,a,c,d,e),this.roundZoom=!0,this.type="video",this.options=c}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this;this._loaded=!1;var c=this.options;this.urls=[];for(var d=0,e=c.urls;d<e.length;d+=1){var f=e[d];this.urls.push(this.map._requestManager.transformRequest(f,a.ResourceType.Source).url)}a.getVideo(this.urls,function(c,d){b._loaded=!0,c?b.fire(new a.ErrorEvent(c)):d&&(b.video=d,b.video.loop=!0,b.video.addEventListener("playing",function(){b.map.triggerRepaint()}),b.map&&b.video.play(),b._finishLoading())})},c.prototype.pause=function(){this.video&&this.video.pause()},c.prototype.play=function(){this.video&&this.video.play()},c.prototype.seek=function(b){if(this.video){var c=this.video.seekable;b<c.start(0)||b>c.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("Playback for this video can be set only between the "+c.start(0)+" and "+c.end(0)+"-second mark."))):this.video.currentTime=b}},c.prototype.getVideo=function(){return this.video},c.prototype.onAdd=function(a){this.map||(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},c.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var b=this.map.painter.context,c=b.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,a.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(b,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var e=this.tiles[d];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}},c.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},c.prototype.hasTransition=function(){return this.video&&!this.video.paused},c}(La),Na=function(b){function c(c,d,e,f){b.call(this,c,d,e,f),d.coordinates?Array.isArray(d.coordinates)&&4===d.coordinates.length&&!d.coordinates.some(function(a){return!Array.isArray(a)||2!==a.length||a.some(function(a){return"number"!=typeof a})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'missing required property "coordinates"'))),d.animate&&"boolean"!=typeof d.animate&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'optional "animate" property must be a boolean value'))),d.canvas?"string"==typeof d.canvas||d.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'missing required property "canvas"'))),this.options=d,this.animate=void 0===d.animate||d.animate}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},c.prototype.getCanvas=function(){return this.canvas},c.prototype.onAdd=function(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()},c.prototype.onRemove=function(){this.pause()},c.prototype.prepare=function(){var b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var c=this.map.painter.context,d=c.gl;for(var e in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,a.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(c,this.canvas,d.RGBA,{premultiply:!0}),this.tiles){var f=this.tiles[e];"loaded"!==f.state&&(f.state="loaded",f.texture=this.texture)}}},c.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},c.prototype.hasTransition=function(){return this._playing},c.prototype._hasInvalidDimensions=function(){for(var a=0,b=[this.canvas.width,this.canvas.height];a<b.length;a+=1){var c=b[a];if(isNaN(c)||c<=0)return!0}return!1},c}(La),Oa={vector:Ha,raster:Ia,"raster-dem":Ja,geojson:Ka,video:Ma,image:La,canvas:Na},Pa=function(b,c,d,e){var f=new Oa[c.type](b,c,d,e);if(f.id!==b)throw new Error("Expected Source id to be "+b+" instead of "+f.id);return a.bindAll(["load","abort","unload","serialize","prepare"],f),f},Qa=function(a,b){this.max=a,this.onRemove=b,this.reset()};Qa.prototype.reset=function(){for(var a in this.data)for(var b=0,c=this.data[a];b<c.length;b+=1){var d=c[b];d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value)}return this.data={},this.order=[],this},Qa.prototype.add=function(a,b,c){var d=this,e=a.wrapped().key;void 0===this.data[e]&&(this.data[e]=[]);var f={value:b,timeout:void 0};if(void 0!==c&&(f.timeout=setTimeout(function(){d.remove(a,f)},c)),this.data[e].push(f),this.order.push(e),this.order.length>this.max){var g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this},Qa.prototype.has=function(a){return a.wrapped().key in this.data},Qa.prototype.getAndRemove=function(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null},Qa.prototype._getAndRemoveByKey=function(a){var b=this.data[a].shift();return b.timeout&&clearTimeout(b.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),b.value},Qa.prototype.get=function(a){return this.has(a)?this.data[a.wrapped().key][0].value:null},Qa.prototype.remove=function(a,b){if(!this.has(a))return this;var c=a.wrapped().key,d=void 0===b?0:this.data[c].indexOf(b),e=this.data[c][d];return this.data[c].splice(d,1),e.timeout&&clearTimeout(e.timeout),0===this.data[c].length&&delete this.data[c],this.onRemove(e.value),this.order.splice(this.order.indexOf(c),1),this},Qa.prototype.setMaxSize=function(a){for(this.max=a;this.order.length>this.max;){var b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this};var Ra=function(a,b,c){this.context=a;var d=a.gl;this.buffer=d.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,b.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete b.arrayBuffer};Ra.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ra.prototype.updateData=function(a){var b=this.context.gl;this.context.unbindVAO(),this.bind(),b.bufferSubData(b.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)},Ra.prototype.destroy=function(){var a=this.context.gl;this.buffer&&(a.deleteBuffer(this.buffer),delete this.buffer)};var Sa={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Ta=function(a,b,c,d){this.length=b.length,this.attributes=c,this.itemSize=b.bytesPerElement,this.dynamicDraw=d,this.context=a;var e=a.gl;this.buffer=e.createBuffer(),a.bindVertexBuffer.set(this.buffer),e.bufferData(e.ARRAY_BUFFER,b.arrayBuffer,this.dynamicDraw?e.DYNAMIC_DRAW:e.STATIC_DRAW),this.dynamicDraw||delete b.arrayBuffer};Ta.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Ta.prototype.updateData=function(a){var b=this.context.gl;this.bind(),b.bufferSubData(b.ARRAY_BUFFER,0,a.arrayBuffer)},Ta.prototype.enableAttributes=function(a,b){for(var c=0;c<this.attributes.length;c++){var d=this.attributes[c],e=b.attributes[d.name];void 0!==e&&a.enableVertexAttribArray(e)}},Ta.prototype.setVertexAttribPointers=function(a,b,c){for(var d=0;d<this.attributes.length;d++){var e=this.attributes[d],f=b.attributes[e.name];void 0!==f&&a.vertexAttribPointer(f,e.components,a[Sa[e.type]],!1,this.itemSize,e.offset+this.itemSize*(c||0))}},Ta.prototype.destroy=function(){var a=this.context.gl;this.buffer&&(a.deleteBuffer(this.buffer),delete this.buffer)};var Ua=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Ua.prototype.get=function(){return this.current},Ua.prototype.set=function(a){},Ua.prototype.getDefault=function(){return this.default},Ua.prototype.setDefault=function(){this.set(this.default)};var Va=function(b){function c(){b.apply(this,arguments)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getDefault=function(){return a.Color.transparent},c.prototype.set=function(a){var b=this.current;(a.r!==b.r||a.g!==b.g||a.b!==b.b||a.a!==b.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},c}(Ua),Wa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 1},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)},b}(Ua),Xa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 0},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)},b}(Ua),Ya=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return[!0,!0,!0,!0]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[3]!==b[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},b}(Ua),Za=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!0},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)},b}(Ua),$a=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 255},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)},b}(Ua),_a=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},b.prototype.set=function(a){var b=this.current;(a.func!==b.func||a.ref!==b.ref||a.mask!==b.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)},b}(Ua),ab=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){var a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)},b}(Ua),bb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST),this.current=a,this.dirty=!1}},b}(Ua),cb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return[0,1]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)},b}(Ua),db=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST),this.current=a,this.dirty=!1}},b}(Ua),eb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.LESS},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)},b}(Ua),fb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.BLEND):b.disable(b.BLEND),this.current=a,this.dirty=!1}},b}(Ua),gb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){var a=this.gl;return[a.ONE,a.ZERO]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)},b}(Ua),hb=function(b){function c(){b.apply(this,arguments)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getDefault=function(){return a.Color.transparent},c.prototype.set=function(a){var b=this.current;(a.r!==b.r||a.g!==b.g||a.b!==b.b||a.a!==b.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},c}(Ua),ib=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.FUNC_ADD},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)},b}(Ua),jb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE),this.current=a,this.dirty=!1}},b}(Ua),kb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.BACK},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)},b}(Ua),lb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.CCW},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)},b}(Ua),mb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)},b}(Ua),nb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.TEXTURE0},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)},b}(Ua),ob=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){var a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[3]!==b[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},b}(Ua),pb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,a),this.current=a,this.dirty=!1}},b}(Ua),qb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindRenderbuffer(b.RENDERBUFFER,a),this.current=a,this.dirty=!1}},b}(Ua),rb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindTexture(b.TEXTURE_2D,a),this.current=a,this.dirty=!1}},b}(Ua),sb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}},b}(Ua),tb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){var b=this.gl;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1},b}(Ua),ub=function(a){function b(b){a.call(this,b),this.vao=b.extVertexArrayObject}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){this.vao&&(a!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(a),this.current=a,this.dirty=!1)},b}(Ua),vb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 4},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}},b}(Ua),wb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}},b}(Ua),xb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}},b}(Ua),yb=function(a){function b(b,c){a.call(this,b),this.context=b,this.parent=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b}(Ua),zb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setDirty=function(){this.dirty=!0},b.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var b=this.gl;b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}},b}(yb),Ab=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var b=this.gl;b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,a),this.current=a,this.dirty=!1}},b}(yb),Bb=function(a,b,c){this.context=a,this.width=b,this.height=c;var d=a.gl,e=this.framebuffer=d.createFramebuffer();this.colorAttachment=new zb(a,e),this.depthAttachment=new Ab(a,e)};Bb.prototype.destroy=function(){var a=this.context.gl,b=this.colorAttachment.get();b&&a.deleteTexture(b);var c=this.depthAttachment.get();c&&a.deleteRenderbuffer(c),a.deleteFramebuffer(this.framebuffer)};var Cb=function(a,b,c){this.func=a,this.mask=b,this.range=c};Cb.ReadOnly=!1,Cb.ReadWrite=!0,Cb.disabled=new Cb(519,Cb.ReadOnly,[0,1]);var Db=function(a,b,c,d,e,f){this.test=a,this.ref=b,this.mask=c,this.fail=d,this.depthFail=e,this.pass=f};Db.disabled=new Db({func:519,mask:0},0,0,7680,7680,7680);var Eb=function(a,b,c){this.blendFunction=a,this.blendColor=b,this.mask=c};Eb.disabled=new Eb(Eb.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),Eb.unblended=new Eb(Eb.Replace,a.Color.transparent,[!0,!0,!0,!0]),Eb.alphaBlended=new Eb([1,771],a.Color.transparent,[!0,!0,!0,!0]);var Fb=function(a,b,c){this.enable=a,this.mode=b,this.frontFace=c};Fb.disabled=new Fb(!1,1029,2305),Fb.backCCW=new Fb(!0,1029,2305);var Gb=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Va(this),this.clearDepth=new Wa(this),this.clearStencil=new Xa(this),this.colorMask=new Ya(this),this.depthMask=new Za(this),this.stencilMask=new $a(this),this.stencilFunc=new _a(this),this.stencilOp=new ab(this),this.stencilTest=new bb(this),this.depthRange=new cb(this),this.depthTest=new db(this),this.depthFunc=new eb(this),this.blend=new fb(this),this.blendFunc=new gb(this),this.blendColor=new hb(this),this.blendEquation=new ib(this),this.cullFace=new jb(this),this.cullFaceSide=new kb(this),this.frontFace=new lb(this),this.program=new mb(this),this.activeTexture=new nb(this),this.viewport=new ob(this),this.bindFramebuffer=new pb(this),this.bindRenderbuffer=new qb(this),this.bindTexture=new rb(this),this.bindVertexBuffer=new sb(this),this.bindElementBuffer=new tb(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ub(this),this.pixelStoreUnpack=new vb(this),this.pixelStoreUnpackPremultiplyAlpha=new wb(this),this.pixelStoreUnpackFlipY=new xb(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&a.getExtension("OES_texture_half_float_linear")};Gb.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Gb.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Gb.prototype.createIndexBuffer=function(a,b){return new Ra(this,a,b)},Gb.prototype.createVertexBuffer=function(a,b,c){return new Ta(this,a,b,c)},Gb.prototype.createRenderbuffer=function(a,b,c){var d=this.gl,e=d.createRenderbuffer();return this.bindRenderbuffer.set(e),d.renderbufferStorage(d.RENDERBUFFER,a,b,c),this.bindRenderbuffer.set(null),e},Gb.prototype.createFramebuffer=function(a,b){return new Bb(this,a,b)},Gb.prototype.clear=function(a){var b=a.color,c=a.depth,d=this.gl,e=0;b&&(e|=d.COLOR_BUFFER_BIT,this.clearColor.set(b),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(e|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),d.clear(e)},Gb.prototype.setCullFace=function(a){!1===a.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))},Gb.prototype.setDepthMode=function(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)},Gb.prototype.setStencilMode=function(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)},Gb.prototype.setColorMode=function(b){a.deepEqual(b.blendFunction,Eb.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(b.blendFunction),this.blendColor.set(b.blendColor)),this.colorMask.set(b.mask)},Gb.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Hb=function(b){function c(c,d,e){var f=this;b.call(this),this.id=c,this.dispatcher=e,this.on("data",function(a){"source"===a.dataType&&"metadata"===a.sourceDataType&&(f._sourceLoaded=!0),f._sourceLoaded&&!f._paused&&"source"===a.dataType&&"content"===a.sourceDataType&&(f.reload(),f.transform&&f.update(f.transform))}),this.on("error",function(){f._sourceErrored=!0}),this._source=Pa(c,d,e,this),this._tiles={},this._cache=new Qa(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._coveredTiles={},this._state=new a.SourceFeatureState}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.onAdd=function(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(a)},c.prototype.onRemove=function(a){this._source&&this._source.onRemove&&this._source.onRemove(a)},c.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var a in this._tiles){var b=this._tiles[a];if("loaded"!==b.state&&"errored"!==b.state)return!1}return!0},c.prototype.getSource=function(){return this._source},c.prototype.pause=function(){this._paused=!0},c.prototype.resume=function(){if(this._paused){var a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}},c.prototype._loadTile=function(a,b){return this._source.loadTile(a,b)},c.prototype._unloadTile=function(a){if(this._source.unloadTile)return this._source.unloadTile(a,function(){})},c.prototype._abortTile=function(a){if(this._source.abortTile)return this._source.abortTile(a,function(){})},c.prototype.serialize=function(){return this._source.serialize()},c.prototype.prepare=function(a){for(var b in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var c=this._tiles[b];c.upload(a),c.prepare(this.map.style.imageManager)}},c.prototype.getIds=function(){
return Object.keys(this._tiles).map(Number).sort(k)},c.prototype.getRenderableIds=function(b){var c=this,d=[];for(var e in this._tiles)this._isIdRenderable(+e,b)&&d.push(+e);return b?d.sort(function(b,d){var e=c._tiles[b].tileID,f=c._tiles[d].tileID,g=new a.Point(e.canonical.x,e.canonical.y)._rotate(c.transform.angle),h=new a.Point(f.canonical.x,f.canonical.y)._rotate(c.transform.angle);return e.overscaledZ-f.overscaledZ||h.y-g.y||h.x-g.x}):d.sort(k)},c.prototype.hasRenderableParent=function(a){var b=this.findLoadedParent(a,0);return!!b&&this._isIdRenderable(b.tileID.key)},c.prototype._isIdRenderable=function(a,b){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(b||!this._tiles[a].holdingForFade())},c.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var a in this._cache.reset(),this._tiles)"errored"!==this._tiles[a].state&&this._reloadTile(a,"reloading")},c.prototype._reloadTile=function(a,b){var c=this._tiles[a];c&&("loading"!==c.state&&(c.state=b),this._loadTile(c,this._tileLoaded.bind(this,c,a,b)))},c.prototype._tileLoaded=function(b,c,d,e){if(e)return b.state="errored",void(404!==e.status?this._source.fire(new a.ErrorEvent(e,{tile:b})):this.update(this.transform));b.timeAdded=a.browser.now(),"expired"===d&&(b.refreshedUponExpiration=!0),this._setTileReloadTimer(c,b),"raster-dem"===this.getSource().type&&b.dem&&this._backfillDEM(b),this._state.initializeTileState(b,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:b,coord:b.tileID}))},c.prototype._backfillDEM=function(a){function b(a,b){a.needsHillshadePrepare=!0;var c=b.tileID.canonical.x-a.tileID.canonical.x,d=b.tileID.canonical.y-a.tileID.canonical.y,e=Math.pow(2,a.tileID.canonical.z),f=b.tileID.key;0===c&&0===d||Math.abs(d)>1||(Math.abs(c)>1&&(1===Math.abs(c+e)?c+=e:1===Math.abs(c-e)&&(c-=e)),b.dem&&a.dem&&(a.dem.backfillBorder(b.dem,c,d),a.neighboringTiles&&a.neighboringTiles[f]&&(a.neighboringTiles[f].backfilled=!0)))}for(var c=this.getRenderableIds(),d=0;d<c.length;d++){var e=c[d];if(a.neighboringTiles&&a.neighboringTiles[e]){var f=this.getTileByID(e);b(a,f),b(f,a)}}},c.prototype.getTile=function(a){return this.getTileByID(a.key)},c.prototype.getTileByID=function(a){return this._tiles[a]},c.prototype.getZoom=function(a){return a.zoom+a.scaleZoom(a.tileSize/this._source.tileSize)},c.prototype._retainLoadedChildren=function(a,b,c,d){for(var e in this._tiles){var f=this._tiles[e];if(!(d[e]||!f.hasData()||f.tileID.overscaledZ<=b||f.tileID.overscaledZ>c)){for(var g=f.tileID;f&&f.tileID.overscaledZ>b+1;){var h=f.tileID.scaledTo(f.tileID.overscaledZ-1);(f=this._tiles[h.key])&&f.hasData()&&(g=h)}for(var i=g;i.overscaledZ>b;)if(a[(i=i.scaledTo(i.overscaledZ-1)).key]){d[g.key]=g;break}}}},c.prototype.findLoadedParent=function(a,b){for(var c=a.overscaledZ-1;c>=b;c--){var d=a.scaledTo(c);if(!d)return;var e=String(d.key),f=this._tiles[e];if(f&&f.hasData())return f;if(this._cache.has(d))return this._cache.get(d)}},c.prototype.updateCacheSize=function(a){var b=(Math.ceil(a.width/this._source.tileSize)+1)*(Math.ceil(a.height/this._source.tileSize)+1),c=Math.floor(5*b),d="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,c):c;this._cache.setMaxSize(d)},c.prototype.handleWrapJump=function(a){var b=(a-(void 0===this._prevLng?a:this._prevLng))/360,c=Math.round(b);if(this._prevLng=a,c){var d={};for(var e in this._tiles){var f=this._tiles[e];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+c),d[f.tileID.key]=f}for(var g in this._tiles=d,this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(var h in this._tiles){var i=this._tiles[h];this._setTileReloadTimer(h,i)}}},c.prototype.update=function(b){var d=this;if(this.transform=b,this._sourceLoaded&&!this._paused){var e;this.updateCacheSize(b),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?e=b.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(b){return new a.OverscaledTileID(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y)}):(e=b.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(e=e.filter(function(a){return d._source.hasTile(a)}))):e=[];var f=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(b)),g=Math.max(f-c.maxOverzooming,this._source.minzoom),h=Math.max(f+c.maxUnderzooming,this._source.minzoom),i=this._updateRetainedTiles(e,f);if(l(this._source.type)){for(var j={},k={},m=0,n=Object.keys(i);m<n.length;m+=1){var o=n[m],p=i[o],q=this._tiles[o];if(q&&!(q.fadeEndTime&&q.fadeEndTime<=a.browser.now())){var r=this.findLoadedParent(p,g);r&&(this._addTile(r.tileID),j[r.tileID.key]=r.tileID),k[o]=p}}for(var s in this._retainLoadedChildren(k,f,h,i),j)i[s]||(this._coveredTiles[s]=!0,i[s]=j[s])}for(var t in i)this._tiles[t].clearFadeHold();for(var u=0,v=a.keysDifference(this._tiles,i);u<v.length;u+=1){var w=v[u],x=this._tiles[w];x.hasSymbolBuckets&&!x.holdingForFade()?x.setHoldDuration(this.map._fadeDuration):x.hasSymbolBuckets&&!x.symbolFadeFinished()||this._removeTile(w)}}},c.prototype.releaseSymbolFadeTiles=function(){for(var a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)},c.prototype._updateRetainedTiles=function(a,b){for(var d={},e={},f=Math.max(b-c.maxOverzooming,this._source.minzoom),g=Math.max(b+c.maxUnderzooming,this._source.minzoom),h={},i=0,j=a;i<j.length;i+=1){var k=j[i],l=this._addTile(k);d[k.key]=k,l.hasData()||b<this._source.maxzoom&&(h[k.key]=k)}this._retainLoadedChildren(h,b,g,d);for(var m=0,n=a;m<n.length;m+=1){var o=n[m],p=this._tiles[o.key];if(!p.hasData()){if(b+1>this._source.maxzoom){var q=o.children(this._source.maxzoom)[0],r=this.getTile(q);if(r&&r.hasData()){d[q.key]=q;continue}}else{var s=o.children(this._source.maxzoom);if(d[s[0].key]&&d[s[1].key]&&d[s[2].key]&&d[s[3].key])continue}for(var t=p.wasRequested(),u=o.overscaledZ-1;u>=f;--u){var v=o.scaledTo(u);if(e[v.key])break;if(e[v.key]=!0,!(p=this.getTile(v))&&t&&(p=this._addTile(v)),p&&(d[v.key]=v,t=p.wasRequested(),p.hasData()))break}}}return d},c.prototype._addTile=function(b){var c=this._tiles[b.key];if(c)return c;(c=this._cache.getAndRemove(b))&&(this._setTileReloadTimer(b.key,c),c.tileID=b,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[b.key]&&(clearTimeout(this._cacheTimers[b.key]),delete this._cacheTimers[b.key],this._setTileReloadTimer(b.key,c)));var d=Boolean(c);return d||(c=new a.Tile(b,this._source.tileSize*b.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,b.key,c.state))),c?(c.uses++,this._tiles[b.key]=c,d||this._source.fire(new a.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null},c.prototype._setTileReloadTimer=function(a,b){var c=this;a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);var d=b.getExpiryTimeout();d&&(this._timers[a]=setTimeout(function(){c._reloadTile(a,"expired"),delete c._timers[a]},d))},c.prototype._removeTile=function(a){var b=this._tiles[a];b&&(b.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),b.uses>0||(b.hasData()&&"reloading"!==b.state?this._cache.add(b.tileID,b,b.getExpiryTimeout()):(b.aborted=!0,this._abortTile(b),this._unloadTile(b))))},c.prototype.clearTiles=function(){for(var a in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(a);this._cache.reset()},c.prototype.tilesIn=function(b,c,d){var e=this,f=[],g=this.transform;if(!g)return f;for(var h=d?g.getCameraQueryGeometry(b):b,i=b.map(function(a){return g.pointCoordinate(a)}),j=h.map(function(a){return g.pointCoordinate(a)}),k=this.getIds(),l=1/0,m=1/0,n=-1/0,o=-1/0,p=0,q=j;p<q.length;p+=1){var r=q[p];l=Math.min(l,r.x),m=Math.min(m,r.y),n=Math.max(n,r.x),o=Math.max(o,r.y)}for(var s=0;s<k.length;s++)!function(b){var d=e._tiles[k[b]];if(!d.holdingForFade()){var h=d.tileID,p=Math.pow(2,g.zoom-d.tileID.overscaledZ),q=c*d.queryPadding*a.EXTENT/d.tileSize/p,r=[h.getTilePoint(new a.MercatorCoordinate(l,m)),h.getTilePoint(new a.MercatorCoordinate(n,o))];if(r[0].x-q<a.EXTENT&&r[0].y-q<a.EXTENT&&r[1].x+q>=0&&r[1].y+q>=0){var s=i.map(function(a){return h.getTilePoint(a)}),t=j.map(function(a){return h.getTilePoint(a)});f.push({tile:d,tileID:h,queryGeometry:s,cameraQueryGeometry:t,scale:p})}}}(s);return f},c.prototype.getVisibleCoordinates=function(a){for(var b=this,c=this.getRenderableIds(a).map(function(a){return b._tiles[a].tileID}),d=0,e=c;d<e.length;d+=1){var f=e[d];f.posMatrix=this.transform.calculatePosMatrix(f.toUnwrapped())}return c},c.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(l(this._source.type))for(var b in this._tiles){var c=this._tiles[b];if(void 0!==c.fadeEndTime&&c.fadeEndTime>=a.browser.now())return!0}return!1},c.prototype.setFeatureState=function(a,b,c){a=a||"_geojsonTileLayer",this._state.updateState(a,b,c)},c.prototype.removeFeatureState=function(a,b,c){a=a||"_geojsonTileLayer",this._state.removeFeatureState(a,b,c)},c.prototype.getFeatureState=function(a,b){return a=a||"_geojsonTileLayer",this._state.getState(a,b)},c}(a.Evented);Hb.maxOverzooming=10,Hb.maxUnderzooming=3;var Ib=function(){this.active={}};Ib.prototype.acquire=function(a){if(!this.workers)for(this.workers=[];this.workers.length<Ib.workerCount;)this.workers.push(new m);return this.active[a]=!0,this.workers.slice()},Ib.prototype.release=function(a){delete this.active[a],0===Object.keys(this.active).length&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)};var Jb,Kb=Math.floor(a.browser.hardwareConcurrency/2);Ib.workerCount=Math.max(Math.min(Kb,6),1);var Lb={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"},Mb=function(a,b,c){var d=this.boxCells=[],e=this.circleCells=[];this.xCellCount=Math.ceil(a/c),this.yCellCount=Math.ceil(b/c);for(var f=0;f<this.xCellCount*this.yCellCount;f++)d.push([]),e.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=b,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/b,this.boxUid=0,this.circleUid=0};Mb.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Mb.prototype.insert=function(a,b,c,d,e){this._forEachCell(b,c,d,e,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(b),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(e)},Mb.prototype.insertCircle=function(a,b,c,d){this._forEachCell(b-d,c-d,b+d,c+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(b),this.circles.push(c),this.circles.push(d)},Mb.prototype._insertBoxCell=function(a,b,c,d,e,f){this.boxCells[e].push(f)},Mb.prototype._insertCircleCell=function(a,b,c,d,e,f){this.circleCells[e].push(f)},Mb.prototype._query=function(a,b,c,d,e,f){if(c<0||a>this.width||d<0||b>this.height)return!e&&[];var g=[];if(a<=0&&b<=0&&this.width<=c&&this.height<=d){if(e)return!0;for(var h=0;h<this.boxKeys.length;h++)g.push({key:this.boxKeys[h],x1:this.bboxes[4*h],y1:this.bboxes[4*h+1],x2:this.bboxes[4*h+2],y2:this.bboxes[4*h+3]});for(var i=0;i<this.circleKeys.length;i++){var j=this.circles[3*i],k=this.circles[3*i+1],l=this.circles[3*i+2];g.push({key:this.circleKeys[i],x1:j-l,y1:k-l,x2:j+l,y2:k+l})}return f?g.filter(f):g}var m={hitTest:e,seenUids:{box:{},circle:{}}};return this._forEachCell(a,b,c,d,this._queryCell,g,m,f),e?g.length>0:g},Mb.prototype._queryCircle=function(a,b,c,d,e){var f=a-c,g=a+c,h=b-c,i=b+c;if(g<0||f>this.width||i<0||h>this.height)return!d&&[];var j=[],k={hitTest:d,circle:{x:a,y:b,radius:c},seenUids:{box:{},circle:{}}};return this._forEachCell(f,h,g,i,this._queryCellCircle,j,k,e),d?j.length>0:j},Mb.prototype.query=function(a,b,c,d,e){return this._query(a,b,c,d,!1,e)},Mb.prototype.hitTest=function(a,b,c,d,e){return this._query(a,b,c,d,!0,e)},Mb.prototype.hitTestCircle=function(a,b,c,d){return this._queryCircle(a,b,c,!0,d)},Mb.prototype._queryCell=function(a,b,c,d,e,f,g,h){var i=g.seenUids,j=this.boxCells[e];if(null!==j)for(var k=this.bboxes,l=0,m=j;l<m.length;l+=1){var n=m[l];if(!i.box[n]){i.box[n]=!0;var o=4*n;if(a<=k[o+2]&&b<=k[o+3]&&c>=k[o+0]&&d>=k[o+1]&&(!h||h(this.boxKeys[n]))){if(g.hitTest)return f.push(!0),!0;f.push({key:this.boxKeys[n],x1:k[o],y1:k[o+1],x2:k[o+2],y2:k[o+3]})}}}var p=this.circleCells[e];if(null!==p)for(var q=this.circles,r=0,s=p;r<s.length;r+=1){var t=s[r];if(!i.circle[t]){i.circle[t]=!0;var u=3*t;if(this._circleAndRectCollide(q[u],q[u+1],q[u+2],a,b,c,d)&&(!h||h(this.circleKeys[t]))){if(g.hitTest)return f.push(!0),!0;var v=q[u],w=q[u+1],x=q[u+2];f.push({key:this.circleKeys[t],x1:v-x,y1:w-x,x2:v+x,y2:w+x})}}}},Mb.prototype._queryCellCircle=function(a,b,c,d,e,f,g,h){var i=g.circle,j=g.seenUids,k=this.boxCells[e];if(null!==k)for(var l=this.bboxes,m=0,n=k;m<n.length;m+=1){var o=n[m];if(!j.box[o]){j.box[o]=!0;var p=4*o;if(this._circleAndRectCollide(i.x,i.y,i.radius,l[p+0],l[p+1],l[p+2],l[p+3])&&(!h||h(this.boxKeys[o])))return f.push(!0),!0}}var q=this.circleCells[e];if(null!==q)for(var r=this.circles,s=0,t=q;s<t.length;s+=1){var u=t[s];if(!j.circle[u]){j.circle[u]=!0;var v=3*u;if(this._circlesCollide(r[v],r[v+1],r[v+2],i.x,i.y,i.radius)&&(!h||h(this.circleKeys[u])))return f.push(!0),!0}}},Mb.prototype._forEachCell=function(a,b,c,d,e,f,g,h){for(var i=this._convertToXCellCoord(a),j=this._convertToYCellCoord(b),k=this._convertToXCellCoord(c),l=this._convertToYCellCoord(d),m=i;m<=k;m++)for(var n=j;n<=l;n++){var o=this.xCellCount*n+m;if(e.call(this,a,b,c,d,o,f,g,h))return}},Mb.prototype._convertToXCellCoord=function(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))},Mb.prototype._convertToYCellCoord=function(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))},Mb.prototype._circlesCollide=function(a,b,c,d,e,f){var g=d-a,h=e-b,i=c+f;return i*i>g*g+h*h},Mb.prototype._circleAndRectCollide=function(a,b,c,d,e,f,g){var h=(f-d)/2,i=Math.abs(a-(d+h));if(i>h+c)return!1;var j=(g-e)/2,k=Math.abs(b-(e+j));if(k>j+c)return!1;if(i<=h||k<=j)return!0;var l=i-h,m=k-j;return l*l+m*m<=c*c};var Nb=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]),Ob=function(a,b,c){void 0===b&&(b=new Mb(a.width+200,a.height+200,25)),void 0===c&&(c=new Mb(a.width+200,a.height+200,25)),this.transform=a,this.grid=b,this.ignoredGrid=c,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};Ob.prototype.placeCollisionBox=function(a,b,c,d,e){var f=this.projectAndGetPerspectiveRatio(d,a.anchorPointX,a.anchorPointY),g=c*f.perspectiveRatio,h=a.x1*g+f.point.x,i=a.y1*g+f.point.y,j=a.x2*g+f.point.x,k=a.y2*g+f.point.y;return!this.isInsideGrid(h,i,j,k)||!b&&this.grid.hitTest(h,i,j,k,e)?{box:[],offscreen:!1}:{box:[h,i,j,k],offscreen:this.isOffscreen(h,i,j,k)}},Ob.prototype.approximateTileDistance=function(a,b,c,d,e){var f=e?1:d/this.pitchfactor,g=a.lastSegmentViewportDistance*c;return a.prevTileDistance+g+(f-1)*g*Math.abs(Math.sin(b))},Ob.prototype.placeCollisionCircles=function(b,c,d,e,f,g,h,i,j,k,l,m,n){var o=[],p=this.projectAnchor(j,f.anchorX,f.anchorY),q=i/24,r=f.lineOffsetX*i,s=f.lineOffsetY*i,t=new a.Point(f.anchorX,f.anchorY),u=B(q,h,r,s,!1,y(t,k).point,t,f,g,k,{},!0),v=!1,w=!1,x=!0,z=p.perspectiveRatio*e,A=1/(e*d),C=0,D=0;u&&(C=this.approximateTileDistance(u.first.tileDistance,u.first.angle,A,p.cameraDistance,m),D=this.approximateTileDistance(u.last.tileDistance,u.last.angle,A,p.cameraDistance,m));for(var E=0;E<b.length;E+=5){var F=b[E],G=b[E+1],H=b[E+2],J=b[E+3];if(!u||J<-C||J>D)I(b,E,!1);else{var K=this.projectPoint(j,F,G),L=H*z;if(o.length>0){var M=K.x-o[o.length-4],N=K.y-o[o.length-3];if(L*L*2>M*M+N*N&&E+8<b.length){var O=b[E+8];if(O>-C&&O<D){I(b,E,!1);continue}}}var P=E/5;o.push(K.x,K.y,L,P),I(b,E,!0);var Q=K.x-L,R=K.y-L,S=K.x+L,T=K.y+L;if(x=x&&this.isOffscreen(Q,R,S,T),w=w||this.isInsideGrid(Q,R,S,T),!c&&this.grid.hitTestCircle(K.x,K.y,L,n)){if(!l)return{circles:[],offscreen:!1};v=!0}}}return{circles:v||!w?[]:o,offscreen:x}},Ob.prototype.queryRenderedSymbols=function(b){if(0===b.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var c=[],d=1/0,e=1/0,f=-1/0,g=-1/0,h=0,i=b;h<i.length;h+=1){var j=i[h],k=new a.Point(j.x+100,j.y+100);d=Math.min(d,k.x),e=Math.min(e,k.y),f=Math.max(f,k.x),g=Math.max(g,k.y),c.push(k)}for(var l={},m={},n=0,o=this.grid.query(d,e,f,g).concat(this.ignoredGrid.query(d,e,f,g));n<o.length;n+=1){var p=o[n],q=p.key;if(void 0===l[q.bucketInstanceId]&&(l[q.bucketInstanceId]={}),!l[q.bucketInstanceId][q.featureIndex]){var r=[new a.Point(p.x1,p.y1),new a.Point(p.x2,p.y1),new a.Point(p.x2,p.y2),new a.Point(p.x1,p.y2)];a.polygonIntersectsPolygon(c,r)&&(l[q.bucketInstanceId][q.featureIndex]=!0,void 0===m[q.bucketInstanceId]&&(m[q.bucketInstanceId]=[]),m[q.bucketInstanceId].push(q.featureIndex))}}return m},Ob.prototype.insertCollisionBox=function(a,b,c,d,e){var f={bucketInstanceId:c,featureIndex:d,collisionGroupID:e};(b?this.ignoredGrid:this.grid).insert(f,a[0],a[1],a[2],a[3])},Ob.prototype.insertCollisionCircles=function(a,b,c,d,e){for(var f=b?this.ignoredGrid:this.grid,g={bucketInstanceId:c,featureIndex:d,collisionGroupID:e},h=0;h<a.length;h+=4)f.insertCircle(g,a[h],a[h+1],a[h+2])},Ob.prototype.projectAnchor=function(a,b,c){var d=[b,c,0,1];return H(d,d,a),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5,cameraDistance:d[3]}},Ob.prototype.projectPoint=function(b,c,d){var e=[c,d,0,1];return H(e,e,b),new a.Point((e[0]/e[3]+1)/2*this.transform.width+100,(-e[1]/e[3]+1)/2*this.transform.height+100)},Ob.prototype.projectAndGetPerspectiveRatio=function(b,c,d){var e=[c,d,0,1];return H(e,e,b),{point:new a.Point((e[0]/e[3]+1)/2*this.transform.width+100,(-e[1]/e[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/e[3]*.5}},Ob.prototype.isOffscreen=function(a,b,c,d){return c<100||a>=this.screenRightBoundary||d<100||b>this.screenBottomBoundary},Ob.prototype.isInsideGrid=function(a,b,c,d){return c>=0&&a<this.gridRightBoundary&&d>=0&&b<this.gridBottomBoundary};var Pb=function(a,b,c,d){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?b:-b))):d&&c?1:0,this.placed=c};Pb.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Qb=function(a,b,c,d,e){this.text=new Pb(a?a.text:null,b,c,e),this.icon=new Pb(a?a.icon:null,b,d,e)};Qb.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Rb=function(a,b,c){this.text=a,this.icon=b,this.skipFade=c},Sb=function(a,b,c,d,e){this.bucketInstanceId=a,this.featureIndex=b,this.sourceLayerIndex=c,this.bucketIndex=d,this.tileID=e},Tb=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};Tb.prototype.get=function(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){var b=++this.maxGroupID;this.collisionGroups[a]={ID:b,predicate:function(a){return a.collisionGroupID===b}}}return this.collisionGroups[a]};var Ub=function(a,b,c,d){this.transform=a.clone(),this.collisionIndex=new Ob(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=b,this.retainedQueryData={},this.collisionGroups=new Tb(c),this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}};Ub.prototype.placeLayerTile=function(b,c,d,e){var f=c.getBucket(b),g=c.latestFeatureIndex;if(f&&g&&b.id===f.layerIds[0]){var h=c.collisionBoxArray,i=f.layers[0].layout,j=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),k=c.tileSize/a.EXTENT,l=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),m=w(l,"map"===i.get("text-pitch-alignment"),"map"===i.get("text-rotation-alignment"),this.transform,J(c,1,this.transform.zoom)),n=w(l,"map"===i.get("icon-pitch-alignment"),"map"===i.get("icon-rotation-alignment"),this.transform,J(c,1,this.transform.zoom));this.retainedQueryData[f.bucketInstanceId]=new Sb(f.bucketInstanceId,g,f.sourceLayerIndex,f.index,c.tileID),this.placeLayerBucket(f,l,m,n,j,k,d,c.holdingForFade(),e,h)}},Ub.prototype.attemptAnchorPlacement=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q,r=K(b,d,e,f,g),s=this.collisionIndex.placeCollisionBox(function(b,c,d,e,f,g){var h=b.x1,i=b.x2,j=b.y1,k=b.y2,l=b.anchorPointX,m=b.anchorPointY,n=new a.Point(c,d);return e&&n._rotate(f?g:-g),{x1:h+n.x,y1:j+n.y,x2:i+n.x,y2:k+n.y,anchorPointX:l,anchorPointY:m}}(c,r.x,r.y,h,i,this.transform.angle),m,j,k,l.predicate);if(s.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[n.crossTileID]&&this.prevPlacement.placements[n.crossTileID]&&this.prevPlacement.placements[n.crossTileID].text&&(q=this.prevPlacement.variableOffsets[n.crossTileID].anchor),this.variableOffsets[n.crossTileID]={radialOffset:f,width:d,height:e,anchor:b,textBoxScale:g,prevAnchor:q},this.markUsedJustification(o,b,n,p),o.allowVerticalPlacement&&(this.markUsedOrientation(o,p,n),this.placedOrientations[n.crossTileID]=p),s},Ub.prototype.placeLayerBucket=function(b,c,d,e,f,g,h,i,j,k){var l=this,m=b.layers[0].layout,n=a.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),o=m.get("text-optional"),p=m.get("icon-optional"),q=m.get("text-allow-overlap"),r=m.get("icon-allow-overlap"),s=q&&(r||!b.hasIconData()||p),t=r&&(q||!b.hasTextData()||o),u=this.collisionGroups.get(b.sourceID),v="map"===m.get("text-rotation-alignment"),w="map"===m.get("text-pitch-alignment"),x="viewport-y"===m.get("symbol-z-order");!b.collisionArrays&&k&&b.deserializeCollisionBoxes(k);var y=function(e,k){if(!j[e.crossTileID])if(i)l.placements[e.crossTileID]=new Rb(!1,!1,!1);else{var r,x=!1,y=!1,z=!0,A={box:null,offscreen:null},B={box:null,offscreen:null},C=null,D=null,E=0,F=0,G=0;k.textFeatureIndex&&(E=k.textFeatureIndex),k.verticalTextFeatureIndex&&(F=k.verticalTextFeatureIndex);var H=k.textBox;if(H){var I=function(c){var d=a.WritingMode.horizontal;if(b.allowVerticalPlacement&&!c&&l.prevPlacement){var f=l.prevPlacement.placedOrientations[e.crossTileID];f&&(l.placedOrientations[e.crossTileID]=f,d=f,l.markUsedOrientation(b,d,e))}return d},J=function(c,d){if(b.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&k.verticalTextBox)for(var f=0,g=b.writingModes;f<g.length&&(g[f]===a.WritingMode.vertical?(A=d(),B=A):A=c(),!(A&&A.box&&A.box.length));f+=1);else A=c()};if(m.get("text-variable-anchor")){var K=m.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[e.crossTileID]){var L=l.prevPlacement.variableOffsets[e.crossTileID];K.indexOf(L.anchor)>0&&(K=K.filter(function(a){return a!==L.anchor})).unshift(L.anchor)}var M=function(a,d){for(var f=a.x2-a.x1,h=a.y2-a.y1,i=e.textBoxScale,j={box:[],offscreen:!1},k=q?2*K.length:K.length,m=0;m<k;++m){var n=K[m%K.length],o=m>=K.length;if((j=l.attemptAnchorPlacement(n,a,f,h,e.radialTextOffset,i,v,w,g,c,u,o,e,b,d))&&j.box&&j.box.length){x=!0;break}}return j};J(function(){return M(H,a.WritingMode.horizontal)},function(){var c=k.verticalTextBox,d=A&&A.box&&A.box.length;return b.allowVerticalPlacement&&!d&&e.numVerticalGlyphVertices>0&&c?M(c,a.WritingMode.vertical):{box:null,offscreen:null}}),A&&(x=A.box,z=A.offscreen);var N=I(A&&A.box);if(!x&&l.prevPlacement){var O=l.prevPlacement.variableOffsets[e.crossTileID];O&&(l.variableOffsets[e.crossTileID]=O,l.markUsedJustification(b,O.anchor,e,N))}}else{var P=function(a,d){var f=l.collisionIndex.placeCollisionBox(a,m.get("text-allow-overlap"),g,c,u.predicate);return f&&f.box&&f.box.length&&(l.markUsedOrientation(b,d,e),l.placedOrientations[e.crossTileID]=d),f};J(function(){return P(H,a.WritingMode.horizontal)},function(){var c=k.verticalTextBox;return b.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&c?P(c,a.WritingMode.vertical):{box:null,offscreen:null}}),I(A&&A.box&&A.box.length)}}x=(r=A)&&r.box&&r.box.length>0,z=r&&r.offscreen;var Q=k.textCircles;if(Q){var R=b.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),S=a.evaluateSizeForFeature(b.textSizeData,n,R);C=l.collisionIndex.placeCollisionCircles(Q,m.get("text-allow-overlap"),f,g,R,b.lineVertexArray,b.glyphOffsetArray,S,c,d,h,w,u.predicate),x=m.get("text-allow-overlap")||C.circles.length>0,z=z&&C.offscreen}k.iconFeatureIndex&&(G=k.iconFeatureIndex),k.iconBox&&(y=(D=l.collisionIndex.placeCollisionBox(k.iconBox,m.get("icon-allow-overlap"),g,c,u.predicate)).box.length>0,z=z&&D.offscreen);var T=o||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,U=p||0===e.numIconVertices;T||U?U?T||(y=y&&x):x=y&&x:y=x=y&&x,x&&r&&r.box&&(B&&B.box&&F?l.collisionIndex.insertCollisionBox(r.box,m.get("text-ignore-placement"),b.bucketInstanceId,F,u.ID):l.collisionIndex.insertCollisionBox(r.box,m.get("text-ignore-placement"),b.bucketInstanceId,E,u.ID)),y&&D&&l.collisionIndex.insertCollisionBox(D.box,m.get("icon-ignore-placement"),b.bucketInstanceId,G,u.ID),x&&C&&l.collisionIndex.insertCollisionCircles(C.circles,m.get("text-ignore-placement"),b.bucketInstanceId,E,u.ID),l.placements[e.crossTileID]=new Rb(x||s,y||t,z||b.justReloaded),j[e.crossTileID]=!0}};if(x)for(var z=b.getSortedSymbolIndexes(this.transform.angle),A=z.length-1;A>=0;--A){var B=z[A];y(b.symbolInstances.get(B),b.collisionArrays[B])}else for(var C=0;C<b.symbolInstances.length;++C)y(b.symbolInstances.get(C),b.collisionArrays[C]);b.justReloaded=!1},Ub.prototype.markUsedJustification=function(b,c,d,e){var f,g={left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex};f=e===a.WritingMode.vertical?d.verticalPlacedTextSymbolIndex:g[a.getAnchorJustification(c)];for(var h=0,i=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];h<i.length;h+=1){var j=i[h];j>=0&&(b.text.placedSymbolArray.get(j).crossTileID=f>=0&&j!==f?0:d.crossTileID)}},Ub.prototype.markUsedOrientation=function(b,c,d){for(var e=c===a.WritingMode.horizontal||c===a.WritingMode.horizontalOnly?c:0,f=c===a.WritingMode.vertical?c:0,g=0,h=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];g<h.length;g+=1){var i=h[g];b.text.placedSymbolArray.get(i).placedOrientation=e}d.verticalPlacedTextSymbolIndex&&(b.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=f)},Ub.prototype.commit=function(a){this.commitTime=a;var b=this.prevPlacement,c=!1,d=b&&0!==this.fadeDuration?(this.commitTime-b.commitTime)/this.fadeDuration:1,e=b?b.opacities:{},f=b?b.variableOffsets:{},g=b?b.placedOrientations:{};for(var h in this.placements){var i=this.placements[h],j=e[h];j?(this.opacities[h]=new Qb(j,d,i.text,i.icon),c=c||i.text!==j.text.placed||i.icon!==j.icon.placed):(this.opacities[h]=new Qb(null,d,i.text,i.icon,i.skipFade),c=c||i.text||i.icon)}for(var k in e){var l=e[k];if(!this.opacities[k]){var m=new Qb(l,d,!1,!1);m.isHidden()||(this.opacities[k]=m,c=c||l.text.placed||l.icon.placed)}}for(var n in f)this.variableOffsets[n]||!this.opacities[n]||this.opacities[n].isHidden()||(this.variableOffsets[n]=f[n]);for(var o in g)this.placedOrientations[o]||!this.opacities[o]||this.opacities[o].isHidden()||(this.placedOrientations[o]=g[o]);c?this.lastPlacementChangeTime=a:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=b?b.lastPlacementChangeTime:a)},Ub.prototype.updateLayerOpacities=function(a,b){for(var c={},d=0,e=b;d<e.length;d+=1){var f=e[d],g=f.getBucket(a);g&&f.latestFeatureIndex&&a.id===g.layerIds[0]&&this.updateBucketOpacities(g,c,f.collisionBoxArray)}},Ub.prototype.updateBucketOpacities=function(b,c,d){b.hasTextData()&&b.text.opacityVertexArray.clear(),b.hasIconData()&&b.icon.opacityVertexArray.clear(),b.hasCollisionBoxData()&&b.collisionBox.collisionVertexArray.clear(),b.hasCollisionCircleData()&&b.collisionCircle.collisionVertexArray.clear();var e=b.layers[0].layout,f=new Qb(null,0,!1,!1,!0),g=e.get("text-allow-overlap"),h=e.get("icon-allow-overlap"),i=e.get("text-variable-anchor"),j="map"===e.get("text-rotation-alignment"),k="map"===e.get("text-pitch-alignment"),l=new Qb(null,0,g&&(h||!b.hasIconData()||e.get("icon-optional")),h&&(g||!b.hasTextData()||e.get("text-optional")),!0);!b.collisionArrays&&d&&(b.hasCollisionBoxData()||b.hasCollisionCircleData())&&b.deserializeCollisionBoxes(d);for(var m=0;m<b.symbolInstances.length;m++){var n=b.symbolInstances.get(m),o=n.numHorizontalGlyphVertices,p=n.numVerticalGlyphVertices,q=n.crossTileID,r=c[q],s=this.opacities[q];r?s=f:s||(s=l,this.opacities[q]=s),c[q]=!0;var t=o>0||p>0,u=n.numIconVertices>0;if(t){for(var v=M(s.text),w=(o+p)/4,x=0;x<w;x++)b.text.opacityVertexArray.emplaceBack(v);var y=s.text.isHidden()?1:0,z=this.placedOrientations[n.crossTileID],A=z===a.WritingMode.horizontal||z===a.WritingMode.horizontalOnly?1:0,B=z===a.WritingMode.vertical?1:0;[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach(function(a){a>=0&&(b.text.placedSymbolArray.get(a).hidden=y||B)}),n.verticalPlacedTextSymbolIndex>=0&&(b.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).hidden=y||A);var C=this.variableOffsets[n.crossTileID];C&&this.markUsedJustification(b,C.anchor,n,z);var D=this.placedOrientations[n.crossTileID];D&&(this.markUsedJustification(b,"left",n,D),this.markUsedOrientation(b,D,n))}if(u){for(var E=M(s.icon),F=0;F<n.numIconVertices/4;F++)b.icon.opacityVertexArray.emplaceBack(E);b.icon.placedSymbolArray.get(m).hidden=s.icon.isHidden()}if(b.hasCollisionBoxData()||b.hasCollisionCircleData()){var G=b.collisionArrays[m];if(G){if(G.textBox){var H=new a.Point(0,0),I=!0;if(i){var J=this.variableOffsets[q];J?(H=K(J.anchor,J.width,J.height,J.radialOffset,J.textBoxScale),j&&H._rotate(k?this.transform.angle:-this.transform.angle)):I=!1}L(b.collisionBox.collisionVertexArray,s.text.placed,!I,H.x,H.y)}G.iconBox&&L(b.collisionBox.collisionVertexArray,s.icon.placed,!1);var N=G.textCircles;if(N&&b.hasCollisionCircleData())for(var O=0;O<N.length;O+=5){var P=r||0===N[O+4];L(b.collisionCircle.collisionVertexArray,s.text.placed,P)}}}}b.sortFeatures(this.transform.angle),this.retainedQueryData[b.bucketInstanceId]&&(this.retainedQueryData[b.bucketInstanceId].featureSortOrder=b.featureSortOrder),b.hasTextData()&&b.text.opacityVertexBuffer&&b.text.opacityVertexBuffer.updateData(b.text.opacityVertexArray),b.hasIconData()&&b.icon.opacityVertexBuffer&&b.icon.opacityVertexBuffer.updateData(b.icon.opacityVertexArray),b.hasCollisionBoxData()&&b.collisionBox.collisionVertexBuffer&&b.collisionBox.collisionVertexBuffer.updateData(b.collisionBox.collisionVertexArray),b.hasCollisionCircleData()&&b.collisionCircle.collisionVertexBuffer&&b.collisionCircle.collisionVertexBuffer.updateData(b.collisionCircle.collisionVertexArray)},Ub.prototype.symbolFadeChange=function(a){return 0===this.fadeDuration?1:(a-this.commitTime)/this.fadeDuration},Ub.prototype.hasTransitions=function(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration},Ub.prototype.stillRecent=function(a){return this.commitTime+this.fadeDuration>a},Ub.prototype.setStale=function(){this.stale=!0};var Vb=Math.pow(2,25),Wb=Math.pow(2,24),Xb=Math.pow(2,17),Yb=Math.pow(2,16),Zb=Math.pow(2,9),$b=Math.pow(2,8),_b=Math.pow(2,1),ac=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};ac.prototype.continuePlacement=function(a,b,c,d,e){for(;this._currentTileIndex<a.length;){var f=a[this._currentTileIndex];if(b.placeLayerTile(d,f,c,this._seenCrossTileIDs),
this._currentTileIndex++,e())return!0}};var bc=function(a,b,c,d,e,f,g){this.placement=new Ub(a,e,f,g),this._currentPlacementIndex=b.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=d,this._done=!1};bc.prototype.isDone=function(){return this._done},bc.prototype.continuePlacement=function(b,c,d){for(var e=this,f=a.browser.now(),g=function(){var b=a.browser.now()-f;return!e._forceFullPlacement&&b>2};this._currentPlacementIndex>=0;){var h=c[b[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if("symbol"===h.type&&(!h.minzoom||h.minzoom<=i)&&(!h.maxzoom||h.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new ac),this._inProgressLayer.continuePlacement(d[h.source],this.placement,this._showCollisionBoxes,h,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},bc.prototype.commit=function(a){return this.placement.commit(a),this.placement};var cc=512/a.EXTENT/2,dc=function(a,b,c){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(var d=0;d<b.length;d++){var e=b.get(d),f=e.key;this.indexedSymbolInstances[f]||(this.indexedSymbolInstances[f]=[]),this.indexedSymbolInstances[f].push({crossTileID:e.crossTileID,coord:this.getScaledCoordinates(e,a)})}};dc.prototype.getScaledCoordinates=function(b,c){var d=c.canonical.z-this.tileID.canonical.z,e=cc/Math.pow(2,d);return{x:Math.floor((c.canonical.x*a.EXTENT+b.anchorX)*e),y:Math.floor((c.canonical.y*a.EXTENT+b.anchorY)*e)}},dc.prototype.findMatches=function(a,b,c){for(var d=this.tileID.canonical.z<b.canonical.z?1:Math.pow(2,this.tileID.canonical.z-b.canonical.z),e=0;e<a.length;e++){var f=a.get(e);if(!f.crossTileID){var g=this.indexedSymbolInstances[f.key];if(g)for(var h=this.getScaledCoordinates(f,b),i=0,j=g;i<j.length;i+=1){var k=j[i];if(Math.abs(k.coord.x-h.x)<=d&&Math.abs(k.coord.y-h.y)<=d&&!c[k.crossTileID]){c[k.crossTileID]=!0,f.crossTileID=k.crossTileID;break}}}}};var ec=function(){this.maxCrossTileID=0};ec.prototype.generate=function(){return++this.maxCrossTileID};var fc=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};fc.prototype.handleWrapJump=function(a){var b=Math.round((a-this.lng)/360);if(0!==b)for(var c in this.indexes){var d=this.indexes[c],e={};for(var f in d){var g=d[f];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+b),e[g.tileID.key]=g}this.indexes[c]=e}this.lng=a},fc.prototype.addBucket=function(a,b,c){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===b.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(var d=0;d<b.symbolInstances.length;d++)b.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});var e=this.usedCrossTileIDs[a.overscaledZ];for(var f in this.indexes){var g=this.indexes[f];if(Number(f)>a.overscaledZ)for(var h in g){var i=g[h];i.tileID.isChildOf(a)&&i.findMatches(b.symbolInstances,a,e)}else{var j=g[a.scaledTo(Number(f)).key];j&&j.findMatches(b.symbolInstances,a,e)}}for(var k=0;k<b.symbolInstances.length;k++){var l=b.symbolInstances.get(k);l.crossTileID||(l.crossTileID=c.generate(),e[l.crossTileID]=!0)}return void 0===this.indexes[a.overscaledZ]&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new dc(a,b.symbolInstances,b.bucketInstanceId),!0},fc.prototype.removeBucketCrossTileIDs=function(a,b){for(var c in b.indexedSymbolInstances)for(var d=0,e=b.indexedSymbolInstances[c];d<e.length;d+=1){var f=e[d];delete this.usedCrossTileIDs[a][f.crossTileID]}},fc.prototype.removeStaleBuckets=function(a){var b=!1;for(var c in this.indexes){var d=this.indexes[c];for(var e in d)a[d[e].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,d[e]),delete d[e],b=!0)}return b};var gc=function(){this.layerIndexes={},this.crossTileIDs=new ec,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};gc.prototype.addLayer=function(a,b,c){var d=this.layerIndexes[a.id];void 0===d&&(d=this.layerIndexes[a.id]=new fc);var e=!1,f={};d.handleWrapJump(c);for(var g=0,h=b;g<h.length;g+=1){var i=h[g],j=i.getBucket(a);j&&a.id===j.layerIds[0]&&(j.bucketInstanceId||(j.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(i.tileID,j,this.crossTileIDs)&&(e=!0),f[j.bucketInstanceId]=!0)}return d.removeStaleBuckets(f)&&(e=!0),e},gc.prototype.pruneUnusedLayers=function(a){var b={};for(var c in a.forEach(function(a){b[a]=!0}),this.layerIndexes)b[c]||delete this.layerIndexes[c]};var hc=function(b,c){return a.emitValidationErrors(b,c&&c.filter(function(a){return"source.canvas"!==a.identifier}))},ic=a.pick(Lb,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),jc=a.pick(Lb,["setCenter","setZoom","setBearing","setPitch"]),kc=function(b){function c(d,e){var f=this;void 0===e&&(e={}),b.call(this),this.map=d,this.dispatcher=new Fa((Jb||(Jb=new Ib),Jb),this),this.imageManager=new wa,this.imageManager.setEventedParent(this),this.glyphManager=new Aa(d._requestManager,e.localIdeographFontFamily),this.lineAtlas=new Ea(256,512),this.crossTileSymbolIndex=new gc,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var g=this;this._rtlTextPluginCallback=c.registerForPluginAvailability(function(a){for(var b in g.dispatcher.broadcast("loadRTLTextPlugin",a.pluginURL,a.completionCallback),g.sourceCaches)g.sourceCaches[b].reload()}),this.on("data",function(a){if("source"===a.dataType&&"metadata"===a.sourceDataType){var b=f.sourceCaches[a.sourceId];if(b){var c=b.getSource();if(c&&c.vectorLayerIds)for(var d in f._layers){var e=f._layers[d];e.source===c.id&&f._validateLayer(e)}}}})}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.loadURL=function(b,c){var d=this;void 0===c&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var e="boolean"==typeof c.validate?c.validate:!a.isMapboxURL(b);b=this.map._requestManager.normalizeStyleURL(b,c.accessToken);var f=this.map._requestManager.transformRequest(b,a.ResourceType.Style);this._request=a.getJSON(f,function(b,c){d._request=null,b?d.fire(new a.ErrorEvent(b)):c&&d._load(c,e)})},c.prototype.loadJSON=function(b,c){var d=this;void 0===c&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){d._request=null,d._load(b,!1!==c.validate)})},c.prototype._load=function(b,c){var d=this;if(!c||!hc(this,a.validateStyle(b))){for(var e in this._loaded=!0,this.stylesheet=b,b.sources)this.addSource(e,b.sources[e],{validate:!1});b.sprite?this._spriteRequest=function(b,c,d){function e(){if(h)d(h);else if(f&&g){var b=a.browser.getImageData(g),c={};for(var e in f){var i=f[e],j=i.width,k=i.height,l=i.x,m=i.y,n=i.sdf,o=i.pixelRatio,p=new a.RGBAImage({width:j,height:k});a.RGBAImage.copy(b,p,{x:l,y:m},{x:0,y:0},{width:j,height:k}),c[e]={data:p,pixelRatio:o,sdf:n}}d(null,c)}}var f,g,h,i=a.browser.devicePixelRatio>1?"@2x":"",j=a.getJSON(c.transformRequest(c.normalizeSpriteURL(b,i,".json"),a.ResourceType.SpriteJSON),function(a,b){j=null,h||(h=a,f=b,e())}),k=a.getImage(c.transformRequest(c.normalizeSpriteURL(b,i,".png"),a.ResourceType.SpriteImage),function(a,b){k=null,h||(h=a,g=b,e())});return{cancel:function(){j&&(j.cancel(),j=null),k&&(k.cancel(),k=null)}}}(b.sprite,this.map._requestManager,function(b,c){if(d._spriteRequest=null,b)d.fire(new a.ErrorEvent(b));else if(c)for(var e in c)d.imageManager.addImage(e,c[e]);d.imageManager.setLoaded(!0),d.fire(new a.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs);var f=o(this.stylesheet.layers);this._order=f.map(function(a){return a.id}),this._layers={};for(var g=0,h=f;g<h.length;g+=1){var i=h[g];(i=a.createStyleLayer(i)).setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=i}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Da(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},c.prototype._validateLayer=function(b){var c=this.sourceCaches[b.source];if(c){var d=b.sourceLayer;if(d){var e=c.getSource();("geojson"===e.type||e.vectorLayerIds&&-1===e.vectorLayerIds.indexOf(d))&&this.fire(new a.ErrorEvent(new Error('Source layer "'+d+'" does not exist on source "'+e.id+'" as specified by style layer "'+b.id+'"')))}}},c.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()},c.prototype._serializeLayers=function(a){for(var b=[],c=0,d=a;c<d.length;c+=1){var e=d[c],f=this._layers[e];"custom"!==f.type&&b.push(f.serialize())}return b},c.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(var b in this._layers)if(this._layers[b].hasTransition())return!0;return!1},c.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},c.prototype.update=function(b){if(this._loaded){var c=this._changed;if(this._changed){var d=Object.keys(this._updatedLayers),e=Object.keys(this._removedLayers);for(var f in(d.length||e.length)&&this._updateWorkerLayers(d,e),this._updatedSources){var g=this._updatedSources[f];"reload"===g?this._reloadSource(f):"clear"===g&&this._clearSource(f)}for(var h in this._updatedPaintProps)this._layers[h].updateTransitions(b);this.light.updateTransitions(b),this._resetUpdates()}for(var i in this.sourceCaches)this.sourceCaches[i].used=!1;for(var j=0,k=this._order;j<k.length;j+=1){var l=k[j],m=this._layers[l];m.recalculate(b),!m.isHidden(b.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}this.light.recalculate(b),this.z=b.zoom,c&&this.fire(new a.Event("data",{dataType:"style"}))}},c.prototype._updateWorkerLayers=function(a,b){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:b})},c.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},c.prototype.setState=function(b){var c=this;if(this._checkLoaded(),hc(this,a.validateStyle(b)))return!1;(b=a.clone$1(b)).layers=o(b.layers);var d=function(b,c){if(!b)return[{command:Lb.setStyle,args:[c]}];var d=[];try{if(!a.deepEqual(b.version,c.version))return[{command:Lb.setStyle,args:[c]}];a.deepEqual(b.center,c.center)||d.push({command:Lb.setCenter,args:[c.center]}),a.deepEqual(b.zoom,c.zoom)||d.push({command:Lb.setZoom,args:[c.zoom]}),a.deepEqual(b.bearing,c.bearing)||d.push({command:Lb.setBearing,args:[c.bearing]}),a.deepEqual(b.pitch,c.pitch)||d.push({command:Lb.setPitch,args:[c.pitch]}),a.deepEqual(b.sprite,c.sprite)||d.push({command:Lb.setSprite,args:[c.sprite]}),a.deepEqual(b.glyphs,c.glyphs)||d.push({command:Lb.setGlyphs,args:[c.glyphs]}),a.deepEqual(b.transition,c.transition)||d.push({command:Lb.setTransition,args:[c.transition]}),a.deepEqual(b.light,c.light)||d.push({command:Lb.setLight,args:[c.light]});var e={},f=[];!function(b,c,d,e){var f;for(f in c=c||{},b=b||{})b.hasOwnProperty(f)&&(c.hasOwnProperty(f)||q(f,d,e));for(f in c)c.hasOwnProperty(f)&&(b.hasOwnProperty(f)?a.deepEqual(b[f],c[f])||("geojson"===b[f].type&&"geojson"===c[f].type&&s(b,c,f)?d.push({command:Lb.setGeoJSONSourceData,args:[f,c[f].data]}):r(f,c,d,e)):p(f,c,d))}(b.sources,c.sources,f,e);var g=[];b.layers&&b.layers.forEach(function(a){e[a.source]?d.push({command:Lb.removeLayer,args:[a.id]}):g.push(a)}),d=d.concat(f),function(b,c,d){c=c||[];var e,f,g,h,i,j,k,l=(b=b||[]).map(u),m=c.map(u),n=b.reduce(v,{}),o=c.reduce(v,{}),p=l.slice(),q=Object.create(null);for(e=0,f=0;e<l.length;e++)g=l[e],o.hasOwnProperty(g)?f++:(d.push({command:Lb.removeLayer,args:[g]}),p.splice(p.indexOf(g,f),1));for(e=0,f=0;e<m.length;e++)g=m[m.length-1-e],p[p.length-1-e]!==g&&(n.hasOwnProperty(g)?(d.push({command:Lb.removeLayer,args:[g]}),p.splice(p.lastIndexOf(g,p.length-f),1)):f++,j=p[p.length-e],d.push({command:Lb.addLayer,args:[o[g],j]}),p.splice(p.length-e,0,g),q[g]=!0);for(e=0;e<m.length;e++)if(h=n[g=m[e]],i=o[g],!q[g]&&!a.deepEqual(h,i))if(a.deepEqual(h.source,i.source)&&a.deepEqual(h["source-layer"],i["source-layer"])&&a.deepEqual(h.type,i.type)){for(k in t(h.layout,i.layout,d,g,null,Lb.setLayoutProperty),t(h.paint,i.paint,d,g,null,Lb.setPaintProperty),a.deepEqual(h.filter,i.filter)||d.push({command:Lb.setFilter,args:[g,i.filter]}),a.deepEqual(h.minzoom,i.minzoom)&&a.deepEqual(h.maxzoom,i.maxzoom)||d.push({command:Lb.setLayerZoomRange,args:[g,i.minzoom,i.maxzoom]}),h)h.hasOwnProperty(k)&&"layout"!==k&&"paint"!==k&&"filter"!==k&&"metadata"!==k&&"minzoom"!==k&&"maxzoom"!==k&&(0===k.indexOf("paint.")?t(h[k],i[k],d,g,k.slice(6),Lb.setPaintProperty):a.deepEqual(h[k],i[k])||d.push({command:Lb.setLayerProperty,args:[g,k,i[k]]}));for(k in i)i.hasOwnProperty(k)&&!h.hasOwnProperty(k)&&"layout"!==k&&"paint"!==k&&"filter"!==k&&"metadata"!==k&&"minzoom"!==k&&"maxzoom"!==k&&(0===k.indexOf("paint.")?t(h[k],i[k],d,g,k.slice(6),Lb.setPaintProperty):a.deepEqual(h[k],i[k])||d.push({command:Lb.setLayerProperty,args:[g,k,i[k]]}))}else d.push({command:Lb.removeLayer,args:[g]}),j=p[p.lastIndexOf(g)+1],d.push({command:Lb.addLayer,args:[i,j]})}(g,c.layers,d)}catch(a){console.warn("Unable to compute style diff:",a),d=[{command:Lb.setStyle,args:[c]}]}return d}(this.serialize(),b).filter(function(a){return!(a.command in jc)});if(0===d.length)return!1;var e=d.filter(function(a){return!(a.command in ic)});if(e.length>0)throw new Error("Unimplemented: "+e.map(function(a){return a.command}).join(", ")+".");return d.forEach(function(a){"setTransition"!==a.command&&c[a.command].apply(c,a.args)}),this.stylesheet=b,!0},c.prototype.addImage=function(b,c){if(this.getImage(b))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(b,c),this.fire(new a.Event("data",{dataType:"style"}))},c.prototype.updateImage=function(a,b){this.imageManager.updateImage(a,b)},c.prototype.getImage=function(a){return this.imageManager.getImage(a)},c.prototype.removeImage=function(b){if(!this.getImage(b))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(b),this.fire(new a.Event("data",{dataType:"style"}))},c.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},c.prototype.addSource=function(b,c,d){var e=this;if(void 0===d&&(d={}),this._checkLoaded(),void 0!==this.sourceCaches[b])throw new Error("There is already a source with this ID");if(!c.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(c).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateStyle.source,"sources."+b,c,null,d))){this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);var f=this.sourceCaches[b]=new Hb(b,c,this.dispatcher);f.style=this,f.setEventedParent(this,function(){return{isSourceLoaded:e.loaded(),source:f.serialize(),sourceId:b}}),f.onAdd(this.map),this._changed=!0}},c.prototype.removeSource=function(b){if(this._checkLoaded(),void 0===this.sourceCaches[b])throw new Error("There is no source with this ID");for(var c in this._layers)if(this._layers[c].source===b)return this.fire(new a.ErrorEvent(new Error('Source "'+b+'" cannot be removed while layer "'+c+'" is using it.')));var d=this.sourceCaches[b];delete this.sourceCaches[b],delete this._updatedSources[b],d.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b})),d.setEventedParent(null),d.clearTiles(),d.onRemove&&d.onRemove(this.map),this._changed=!0},c.prototype.setGeoJSONSourceData=function(a,b){this._checkLoaded(),this.sourceCaches[a].getSource().setData(b),this._changed=!0},c.prototype.getSource=function(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()},c.prototype.addLayer=function(b,c,d){void 0===d&&(d={}),this._checkLoaded();var e=b.id;if(this.getLayer(e))this.fire(new a.ErrorEvent(new Error('Layer with id "'+e+'" already exists on this map')));else{var f;if("custom"===b.type){if(hc(this,a.validateCustomStyleLayer(b)))return;f=a.createStyleLayer(b)}else{if("object"==typeof b.source&&(this.addSource(e,b.source),b=a.clone$1(b),b=a.extend(b,{source:e})),this._validate(a.validateStyle.layer,"layers."+e,b,{arrayIndex:-1},d))return;f=a.createStyleLayer(b),this._validateLayer(f),f.setEventedParent(this,{layer:{id:e}})}var g=c?this._order.indexOf(c):this._order.length;if(c&&-1===g)this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.')));else{if(this._order.splice(g,0,e),this._layerOrderChanged=!0,this._layers[e]=f,this._removedLayers[e]&&f.source&&"custom"!==f.type){var h=this._removedLayers[e];delete this._removedLayers[e],h.type!==f.type?this._updatedSources[f.source]="clear":(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause())}this._updateLayer(f),f.onAdd&&f.onAdd(this.map)}}},c.prototype.moveLayer=function(b,c){if(this._checkLoaded(),this._changed=!0,this._layers[b]){if(b!==c){var d=this._order.indexOf(b);this._order.splice(d,1);var e=c?this._order.indexOf(c):this._order.length;c&&-1===e?this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.'))):(this._order.splice(e,0,b),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be moved.")))},c.prototype.removeLayer=function(b){this._checkLoaded();var c=this._layers[b];if(c){c.setEventedParent(null);var d=this._order.indexOf(b);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[b]=c,delete this._layers[b],delete this._updatedLayers[b],delete this._updatedPaintProps[b],c.onRemove&&c.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be removed.")))},c.prototype.getLayer=function(a){return this._layers[a]},c.prototype.setLayerZoomRange=function(b,c,d){this._checkLoaded();var e=this.getLayer(b);e?e.minzoom===c&&e.maxzoom===d||(null!=c&&(e.minzoom=c),null!=d&&(e.maxzoom=d),this._updateLayer(e)):this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot have zoom extent.")))},c.prototype.setFilter=function(b,c,d){void 0===d&&(d={}),this._checkLoaded();var e=this.getLayer(b);if(e){if(!a.deepEqual(e.filter,c))return null==c?(e.filter=void 0,void this._updateLayer(e)):void(this._validate(a.validateStyle.filter,"layers."+e.id+".filter",c,null,d)||(e.filter=a.clone$1(c),this._updateLayer(e)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be filtered.")))},c.prototype.getFilter=function(b){return a.clone$1(this.getLayer(b).filter)},c.prototype.setLayoutProperty=function(b,c,d,e){void 0===e&&(e={}),this._checkLoaded();var f=this.getLayer(b);f?a.deepEqual(f.getLayoutProperty(c),d)||(f.setLayoutProperty(c,d,e),this._updateLayer(f)):this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be styled.")))},c.prototype.getLayoutProperty=function(b,c){var d=this.getLayer(b);if(d)return d.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style.")))},c.prototype.setPaintProperty=function(b,c,d,e){void 0===e&&(e={}),this._checkLoaded();var f=this.getLayer(b);f?a.deepEqual(f.getPaintProperty(c),d)||(f.setPaintProperty(c,d,e)&&this._updateLayer(f),this._changed=!0,this._updatedPaintProps[b]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be styled.")))},c.prototype.getPaintProperty=function(a,b){return this.getLayer(a).getPaintProperty(b)},c.prototype.setFeatureState=function(b,c){this._checkLoaded();var d=b.source,e=b.sourceLayer,f=this.sourceCaches[d],g=parseInt(b.id,10);if(void 0!==f){var h=f.getSource().type;"geojson"===h&&e?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==h||e?isNaN(g)||g<0?this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided and non-negative."))):f.setFeatureState(e,g,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},c.prototype.removeFeatureState=function(b,c){this._checkLoaded();var d=b.source,e=this.sourceCaches[d];if(void 0!==e){var f=e.getSource().type,g="vector"===f?b.sourceLayer:void 0,h=parseInt(b.id,10);"vector"!==f||g?void 0!==b.id&&isNaN(h)||h<0?this.fire(new a.ErrorEvent(new Error("The feature id parameter must be non-negative."))):c&&"string"!=typeof b.id&&"number"!=typeof b.id?this.fire(new a.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):e.removeFeatureState(g,h,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},c.prototype.getFeatureState=function(b){this._checkLoaded();var c=b.source,d=b.sourceLayer,e=this.sourceCaches[c],f=parseInt(b.id,10);if(void 0!==e)if("vector"!==e.getSource().type||d){if(!(isNaN(f)||f<0))return e.getFeatureState(d,f);this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided and non-negative.")))}else this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));else this.fire(new a.ErrorEvent(new Error("The source '"+c+"' does not exist in the map's style.")))},c.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},c.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(a){return a.serialize()}),layers:this._serializeLayers(this._order)},function(a){return void 0!==a})},c.prototype._updateLayer=function(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._changed=!0},c.prototype._flattenAndSortRenderedFeatures=function(a){for(var b=this,c=function(a){return"fill-extrusion"===b._layers[a].type},d={},e=[],f=this._order.length-1;f>=0;f--){var g=this._order[f];if(c(g)){d[g]=f;for(var h=0,i=a;h<i.length;h+=1){var j=i[h][g];if(j)for(var k=0,l=j;k<l.length;k+=1){var m=l[k];e.push(m)}}}}e.sort(function(a,b){return b.intersectionZ-a.intersectionZ});for(var n=[],o=this._order.length-1;o>=0;o--){var p=this._order[o];if(c(p))for(var q=e.length-1;q>=0;q--){var r=e[q].feature;if(d[r.layer.id]<o)break;n.push(r),e.pop()}else for(var s=0,t=a;s<t.length;s+=1){var u=t[s][p];if(u)for(var v=0,w=u;v<w.length;v+=1){var x=w[v];n.push(x.feature)}}}return n},c.prototype.queryRenderedFeatures=function(b,c,d){c&&c.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);var e={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var f=0,g=c.layers;f<g.length;f+=1){var h=g[f],k=this._layers[h];if(!k)return this.fire(new a.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be queried for features."))),[];e[k.source]=!0}}var l=[];for(var m in this.sourceCaches)c.layers&&!e[m]||l.push(i(this.sourceCaches[m],this._layers,b,c,d));return this.placement&&l.push(function(a,b,c,d,e,f){for(var g={},h=e.queryRenderedSymbols(c),i=[],k=0,l=Object.keys(h).map(Number);k<l.length;k+=1){var m=l[k];i.push(f[m])}i.sort(j);for(var n=0,o=i;n<o.length;n+=1)!function(){var b=o[n],c=b.featureIndex.lookupSymbolFeatures(h[b.bucketInstanceId],b.bucketIndex,b.sourceLayerIndex,d.filter,d.layers,a);for(var e in c){var f=g[e]=g[e]||[],i=c[e];i.sort(function(a,c){var d=b.featureSortOrder;if(d){var e=d.indexOf(a.featureIndex);return d.indexOf(c.featureIndex)-e}return c.featureIndex-a.featureIndex});for(var j=0,k=i;j<k.length;j+=1){var l=k[j];f.push(l)}}}();for(var p in g)!function(c){g[c].forEach(function(d){var e=d.feature,f=a[c],g=b[f.source].getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=g})}(p);return g}(this._layers,this.sourceCaches,b,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(l)},c.prototype.querySourceFeatures=function(b,c){c&&c.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);var d=this.sourceCaches[b];return d?function(a,b){for(var c=a.getRenderableIds().map(function(b){return a.getTileByID(b)}),d=[],e={},f=0;f<c.length;f++){var g=c[f],h=g.tileID.canonical.key;e[h]||(e[h]=!0,g.querySourceFeatures(d,b))}return d}(d,c):[]},c.prototype.addSourceType=function(a,b,d){return c.getSourceType(a)?d(new Error('A source type called "'+a+'" already exists.')):(c.setSourceType(a,b),b.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:b.workerSourceURL},d):d(null,null))},c.prototype.getLight=function(){return this.light.getLight()},c.prototype.setLight=function(b,c){void 0===c&&(c={}),this._checkLoaded();var d=this.light.getLight(),e=!1;for(var f in b)if(!a.deepEqual(b[f],d[f])){e=!0;break}if(e){var g={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(b,c),this.light.updateTransitions(g)}},c.prototype._validate=function(b,c,d,e,f){return void 0===f&&(f={}),(!f||!1!==f.validate)&&hc(this,b.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:d,styleSpec:a.styleSpec},e)))},c.prototype._remove=function(){for(var b in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[b].clearTiles();this.dispatcher.remove()},c.prototype._clearSource=function(a){this.sourceCaches[a].clearTiles()},c.prototype._reloadSource=function(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()},c.prototype._updateSources=function(a){for(var b in this.sourceCaches)this.sourceCaches[b].update(a)},c.prototype._generateCollisionBoxes=function(){for(var a in this.sourceCaches)this._reloadSource(a)},c.prototype._updatePlacement=function(b,c,d,e){for(var f=!1,g=!1,h={},i=0,j=this._order;i<j.length;i+=1){var k=j[i],l=this._layers[k];if("symbol"===l.type){if(!h[l.source]){var m=this.sourceCaches[l.source];h[l.source]=m.getRenderableIds(!0).map(function(a){return m.getTileByID(a)}).sort(function(a,b){return b.tileID.overscaledZ-a.tileID.overscaledZ||(a.tileID.isLessThan(b.tileID)?-1:1)})}var n=this.crossTileSymbolIndex.addLayer(l,h[l.source],b.center.lng);f=f||n}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var o=this._layerOrderChanged||0===d;if((o||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now()))&&(this.pauseablePlacement=new bc(b,this._order,o,c,d,e,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,h),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),g=!0),f&&this.pauseablePlacement.placement.setStale()),g||f)for(var p=0,q=this._order;p<q.length;p+=1){var r=q[p],s=this._layers[r];"symbol"===s.type&&this.placement.updateLayerOpacities(s,h[s.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},c.prototype._releaseSymbolFadeTiles=function(){for(var a in this.sourceCaches)this.sourceCaches[a].releaseSymbolFadeTiles()},c.prototype.getImages=function(a,b,c){this.imageManager.getImages(b.icons,c)},c.prototype.getGlyphs=function(a,b,c){this.glyphManager.getGlyphs(b.stacks,c)},c.prototype.getResource=function(b,c,d){return a.makeRequest(c,d)},c}(a.Evented);kc.getSourceType=function(a){return Oa[a]},kc.setSourceType=function(a,b){Oa[a]=b},kc.registerForPluginAvailability=a.registerForPluginAvailability;var lc=a.createLayout([{name:"a_pos",type:"Int16",components:2
}]),mc=N("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),nc=N("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),oc=N("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),pc=N("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),qc=N("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),rc=N("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),sc=N("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),tc=N("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),uc=N("uniform float u_overscale_factor;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {float alpha=0.5;vec4 color=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {color=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {color*=.2;}float extrude_scale_length=length(v_extrude_scale);float extrude_length=length(v_extrude)*extrude_scale_length;float stroke_width=15.0*extrude_scale_length/u_overscale_factor;float radius=v_radius*extrude_scale_length;float distance_to_edge=abs(extrude_length-radius);float opacity_t=smoothstep(-stroke_width,0.0,-distance_to_edge);gl_FragColor=opacity_t*color;}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);highp float padding_factor=1.2;gl_Position.xy+=a_extrude*u_extrude_scale*padding_factor*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;v_radius=abs(a_extrude.y);v_extrude=a_extrude*padding_factor;v_extrude_scale=u_extrude_scale*u_camera_to_center_distance*collision_perspective_ratio;}"),vc=N("uniform highp vec4 u_color;void main() {gl_FragColor=u_color;}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),wc=N("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),xc=N("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),yc=N("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),zc=N("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Ac=N("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Bc=N("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec4 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Cc=N("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;return (data.r+data.g*256.0+data.b*256.0*256.0)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Dc=N("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ec=N("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Fc=N("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Gc=N("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec4 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x,1.0);float x_b=mod(v_linesofar/pattern_size_b.x,1.0);float y_a=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_a.y+2.0)/2.0)/pattern_size_a.y);float y_b=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_b.y+2.0)/2.0)/pattern_size_b.y);vec2 pos_a=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,vec2(x_a,y_a));vec2 pos_b=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,vec2(x_b,y_b));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);}"),Hc=N("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),Ic=N("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Jc=N("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Kc=N("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=vec2(tex.x,tex.y);v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Lc=Object.freeze({
prelude:mc,background:nc,backgroundPattern:oc,circle:pc,clippingMask:qc,heatmap:rc,heatmapTexture:sc,collisionBox:tc,collisionCircle:uc,debug:vc,fill:wc,fillOutline:xc,fillOutlinePattern:yc,fillPattern:zc,fillExtrusion:Ac,fillExtrusionPattern:Bc,hillshadePrepare:Cc,hillshade:Dc,line:Ec,lineGradient:Fc,linePattern:Gc,lineSDF:Hc,raster:Ic,symbolIcon:Jc,symbolSDF:Kc}),Mc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Mc.prototype.bind=function(a,b,c,d,e,f,g,h){this.context=a;for(var i=this.boundPaintVertexBuffers.length!==d.length,j=0;!i&&j<d.length;j++)this.boundPaintVertexBuffers[j]!==d[j]&&(i=!0);var k=!this.vao||this.boundProgram!==b||this.boundLayoutVertexBuffer!==c||i||this.boundIndexBuffer!==e||this.boundVertexOffset!==f||this.boundDynamicVertexBuffer!==g||this.boundDynamicVertexBuffer2!==h;!a.extVertexArrayObject||k?this.freshBind(b,c,d,e,f,g,h):(a.bindVertexArrayOES.set(this.vao),g&&g.bind(),e&&e.dynamicDraw&&e.bind(),h&&h.bind())},Mc.prototype.freshBind=function(a,b,c,d,e,f,g){var h,i=a.numAttributes,j=this.context,k=j.gl;if(j.extVertexArrayObject)this.vao&&this.destroy(),this.vao=j.extVertexArrayObject.createVertexArrayOES(),j.bindVertexArrayOES.set(this.vao),h=0,this.boundProgram=a,this.boundLayoutVertexBuffer=b,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=d,this.boundVertexOffset=e,this.boundDynamicVertexBuffer=f,this.boundDynamicVertexBuffer2=g;else{h=j.currentNumAttributes||0;for(var l=i;l<h;l++)k.disableVertexAttribArray(l)}b.enableAttributes(k,a);for(var m=0,n=c;m<n.length;m+=1)n[m].enableAttributes(k,a);f&&f.enableAttributes(k,a),g&&g.enableAttributes(k,a),b.bind(),b.setVertexAttribPointers(k,a,e);for(var o=0,p=c;o<p.length;o+=1){var q=p[o];q.bind(),q.setVertexAttribPointers(k,a,e)}f&&(f.bind(),f.setVertexAttribPointers(k,a,e)),d&&d.bind(),g&&(g.bind(),g.setVertexAttribPointers(k,a,e)),j.currentNumAttributes=i},Mc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Nc=function(a,b,c,d,e){var f=a.gl;this.program=f.createProgram();var g=c.defines();e&&g.push("#define OVERDRAW_INSPECTOR;");var h=g.concat(mc.fragmentSource,b.fragmentSource).join("\n"),i=g.concat(mc.vertexSource,b.vertexSource).join("\n"),j=f.createShader(f.FRAGMENT_SHADER);f.shaderSource(j,h),f.compileShader(j),f.attachShader(this.program,j);var k=f.createShader(f.VERTEX_SHADER);f.shaderSource(k,i),f.compileShader(k),f.attachShader(this.program,k);for(var l=c.layoutAttributes||[],m=0;m<l.length;m++)f.bindAttribLocation(this.program,m,l[m].name);f.linkProgram(this.program),this.numAttributes=f.getProgramParameter(this.program,f.ACTIVE_ATTRIBUTES),this.attributes={};for(var n={},o=0;o<this.numAttributes;o++){var p=f.getActiveAttrib(this.program,o);p&&(this.attributes[p.name]=f.getAttribLocation(this.program,p.name))}for(var q=f.getProgramParameter(this.program,f.ACTIVE_UNIFORMS),r=0;r<q;r++){var s=f.getActiveUniform(this.program,r);s&&(n[s.name]=f.getUniformLocation(this.program,s.name))}this.fixedUniforms=d(a,n),this.binderUniforms=c.getUniforms(a,n)};Nc.prototype.draw=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q,r=a.gl;for(var s in a.program.set(this.program),a.setDepthMode(c),a.setStencilMode(d),a.setColorMode(e),a.setCullFace(f),this.fixedUniforms)this.fixedUniforms[s].set(g[s]);n&&n.setUniforms(a,this.binderUniforms,l,{zoom:m});for(var t=(q={},q[r.LINES]=2,q[r.TRIANGLES]=3,q[r.LINE_STRIP]=1,q)[b],u=0,v=k.get();u<v.length;u+=1){var w=v[u],x=w.vaos||(w.vaos={});(x[h]||(x[h]=new Mc)).bind(a,this,i,n?n.getPaintVertexBuffers():[],j,w.vertexOffset,o,p),r.drawElements(b,w.primitiveLength*t,r.UNSIGNED_SHORT,w.primitiveOffset*t*2)}};var Oc=function(b,c,d,e){var f=c.style.light,g=f.properties.get("position"),h=[g.x,g.y,g.z],i=a.create$1();"viewport"===f.properties.get("anchor")&&a.fromRotation(i,-c.transform.angle),a.transformMat3(h,h,i);var j=f.properties.get("color");return{u_matrix:b,u_lightpos:h,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[j.r,j.g,j.b],u_vertical_gradient:+d,u_opacity:e}},Pc=function(b,c,d,e,f,g,h){return a.extend(Oc(b,c,d,e),O(g,c,h),{u_height_factor:-Math.pow(2,f.overscaledZ)/h.tileSize/8})},Qc=function(a){return{u_matrix:a}},Rc=function(b,c,d,e){return a.extend(Qc(b),O(d,c,e))},Sc=function(a,b){return{u_matrix:a,u_world:b}},Tc=function(b,c,d,e,f){return a.extend(Rc(b,c,d,e),{u_world:f})},Uc=function(b,c,d,e){var f,g,h=b.transform;if("map"===e.paint.get("circle-pitch-alignment")){var i=J(d,1,h.zoom);f=!0,g=[i,i]}else f=!1,g=h.pixelsToGLUnits;return{u_camera_to_center_distance:h.cameraToCenterDistance,u_scale_with_map:+("map"===e.paint.get("circle-pitch-scale")),u_matrix:b.translatePosMatrix(c.posMatrix,d,e.paint.get("circle-translate"),e.paint.get("circle-translate-anchor")),u_pitch_with_map:+f,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:g}},Vc=function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(b,c.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(b,c.u_extrude_scale),u_overscale_factor:new a.Uniform1f(b,c.u_overscale_factor)}},Wc=function(a,b,c){var d=J(c,1,b.zoom),e=Math.pow(2,b.zoom-c.tileID.overscaledZ),f=c.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:b.cameraToCenterDistance,u_pixels_to_tile_units:d,u_extrude_scale:[b.pixelsToGLUnits[0]/(d*e),b.pixelsToGLUnits[1]/(d*e)],u_overscale_factor:f}},Xc=function(a,b){return{u_matrix:a,u_color:b}},Yc=function(a){return{u_matrix:a}},Zc=function(a,b,c,d){return{u_matrix:a,u_extrude_scale:J(b,1,c),u_intensity:d}},$c=function(a,b,c){var d=c.paint.get("hillshade-shadow-color"),e=c.paint.get("hillshade-highlight-color"),f=c.paint.get("hillshade-accent-color"),g=c.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===c.paint.get("hillshade-illumination-anchor")&&(g-=a.transform.angle);var h=!a.options.moving;return{u_matrix:a.transform.calculatePosMatrix(b.tileID.toUnwrapped(),h),u_image:0,u_latrange:P(a,b.tileID),u_light:[c.paint.get("hillshade-exaggeration"),g],u_shadow:d,u_highlight:e,u_accent:f}},_c=function(b,c){var d=b.dem.stride,e=a.create();return a.ortho(e,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(e,e,[0,-a.EXTENT,0]),{u_matrix:e,u_image:1,u_dimension:[d,d],u_zoom:b.tileID.overscaledZ,u_maxzoom:c}},ad=function(b,c,d){var e=b.transform;return{u_matrix:R(b,c,d),u_ratio:1/J(c,1,e.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/e.pixelsToGLUnits[0],1/e.pixelsToGLUnits[1]]}},bd=function(b,c,d){return a.extend(ad(b,c,d),{u_image:0})},cd=function(b,c,d,e){var f=b.transform,g=Q(c,f);return{u_matrix:R(b,c,d),u_texsize:c.imageAtlasTexture.size,u_ratio:1/J(c,1,f.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[a.browser.devicePixelRatio,g,e.fromScale,e.toScale],u_fade:e.t,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},dd=function(b,c,d,e,f){var g=b.transform,h=b.lineAtlas,i=Q(c,g),j="round"===d.layout.get("line-cap"),k=h.getDash(e.from,j),l=h.getDash(e.to,j),m=k.width*f.fromScale,n=l.width*f.toScale;return a.extend(ad(b,c,d),{u_patternscale_a:[i/m,-k.height/2],u_patternscale_b:[i/n,-l.height/2],u_sdfgamma:h.width/(256*Math.min(m,n)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:l.y,u_mix:f.t})},ed=function(a,b,c,d,e){return{u_matrix:a,u_tl_parent:b,u_scale_parent:c,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*e.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:e.paint.get("raster-brightness-min"),u_brightness_high:e.paint.get("raster-brightness-max"),u_saturation_factor:(g=e.paint.get("raster-saturation"),g>0?1-1/(1.001-g):-g),u_contrast_factor:(f=e.paint.get("raster-contrast"),f>0?1/(1-f):1+f),u_spin_weights:function(a){a*=Math.PI/180;var b=Math.sin(a),c=Math.cos(a);return[(2*c+1)/3,(-Math.sqrt(3)*b-c+1)/3,(Math.sqrt(3)*b-c+1)/3]}(e.paint.get("raster-hue-rotate"))};var f,g},fd=function(a,b,c,d,e,f,g,h,i,j){var k=e.transform;return{u_is_size_zoom_constant:+("constant"===a||"source"===a),u_is_size_feature_constant:+("constant"===a||"camera"===a),u_size_t:b?b.uSizeT:0,u_size:b?b.uSize:0,u_camera_to_center_distance:k.cameraToCenterDistance,u_pitch:k.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:k.width/k.height,u_fade_change:e.options.fadeDuration?e.symbolFadeChange:1,u_matrix:f,u_label_plane_matrix:g,u_coord_matrix:h,u_is_text:+i,u_pitch_with_map:+d,u_texsize:j,u_texture:0}},gd=function(b,c,d,e,f,g,h,i,j,k,l){var m=f.transform;return a.extend(fd(b,c,d,e,f,g,h,i,j,k),{u_gamma_scale:e?Math.cos(m._pitch)*m.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+l})},hd=function(a,b,c){return{u_matrix:a,u_opacity:b,u_color:c}},id=function(b,c,d,e,f,g){return a.extend(function(a,b,c,d){var e=c.imageManager.getPattern(a.from),f=c.imageManager.getPattern(a.to),g=c.imageManager.getPixelSize(),h=g.width,i=g.height,j=Math.pow(2,d.tileID.overscaledZ),k=d.tileSize*Math.pow(2,c.transform.tileZoom)/j,l=k*(d.tileID.canonical.x+d.tileID.wrap*j),m=k*d.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:e.tl,u_pattern_br_a:e.br,u_pattern_tl_b:f.tl,u_pattern_br_b:f.br,u_texsize:[h,i],u_mix:b.t,u_pattern_size_a:e.displaySize,u_pattern_size_b:f.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/J(d,1,c.transform.tileZoom),u_pixel_coord_upper:[l>>16,m>>16],u_pixel_coord_lower:[65535&l,65535&m]}}(e,g,d,f),{u_matrix:b,u_opacity:c})},jd={fillExtrusion:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_lightpos:new a.Uniform3f(b,c.u_lightpos),u_lightintensity:new a.Uniform1f(b,c.u_lightintensity),u_lightcolor:new a.Uniform3f(b,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,c.u_vertical_gradient),u_opacity:new a.Uniform1f(b,c.u_opacity)}},fillExtrusionPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_lightpos:new a.Uniform3f(b,c.u_lightpos),u_lightintensity:new a.Uniform1f(b,c.u_lightintensity),u_lightcolor:new a.Uniform3f(b,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,c.u_vertical_gradient),u_height_factor:new a.Uniform1f(b,c.u_height_factor),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade),u_opacity:new a.Uniform1f(b,c.u_opacity)}},fill:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},fillPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},fillOutline:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world)}},fillOutlinePattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},circle:function(b,c){return{u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(b,c.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(b,c.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},collisionBox:Vc,collisionCircle:Vc,debug:function(b,c){return{u_color:new a.UniformColor(b,c.u_color),u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},clippingMask:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},heatmap:function(b,c){return{u_extrude_scale:new a.Uniform1f(b,c.u_extrude_scale),u_intensity:new a.Uniform1f(b,c.u_intensity),u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},heatmapTexture:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world),u_image:new a.Uniform1i(b,c.u_image),u_color_ramp:new a.Uniform1i(b,c.u_color_ramp),u_opacity:new a.Uniform1f(b,c.u_opacity)}},hillshade:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_latrange:new a.Uniform2f(b,c.u_latrange),u_light:new a.Uniform2f(b,c.u_light),u_shadow:new a.UniformColor(b,c.u_shadow),u_highlight:new a.UniformColor(b,c.u_highlight),u_accent:new a.UniformColor(b,c.u_accent)}},hillshadePrepare:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_dimension:new a.Uniform2f(b,c.u_dimension),u_zoom:new a.Uniform1f(b,c.u_zoom),u_maxzoom:new a.Uniform1f(b,c.u_maxzoom)}},line:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels)}},lineGradient:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels),u_image:new a.Uniform1i(b,c.u_image)}},linePattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_texsize:new a.Uniform2f(b,c.u_texsize),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_image:new a.Uniform1i(b,c.u_image),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},lineSDF:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(b,c.u_patternscale_a),u_patternscale_b:new a.Uniform2f(b,c.u_patternscale_b),u_sdfgamma:new a.Uniform1f(b,c.u_sdfgamma),u_image:new a.Uniform1i(b,c.u_image),u_tex_y_a:new a.Uniform1f(b,c.u_tex_y_a),u_tex_y_b:new a.Uniform1f(b,c.u_tex_y_b),u_mix:new a.Uniform1f(b,c.u_mix)}},raster:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_tl_parent:new a.Uniform2f(b,c.u_tl_parent),u_scale_parent:new a.Uniform1f(b,c.u_scale_parent),u_buffer_scale:new a.Uniform1f(b,c.u_buffer_scale),u_fade_t:new a.Uniform1f(b,c.u_fade_t),u_opacity:new a.Uniform1f(b,c.u_opacity),u_image0:new a.Uniform1i(b,c.u_image0),u_image1:new a.Uniform1i(b,c.u_image1),u_brightness_low:new a.Uniform1f(b,c.u_brightness_low),u_brightness_high:new a.Uniform1f(b,c.u_brightness_high),u_saturation_factor:new a.Uniform1f(b,c.u_saturation_factor),u_contrast_factor:new a.Uniform1f(b,c.u_contrast_factor),u_spin_weights:new a.Uniform3f(b,c.u_spin_weights)}},symbolIcon:function(b,c){return{u_is_size_zoom_constant:new a.Uniform1i(b,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,c.u_size_t),u_size:new a.Uniform1f(b,c.u_size),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,c.u_pitch),u_rotate_symbol:new a.Uniform1i(b,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,c.u_fade_change),u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,c.u_coord_matrix),u_is_text:new a.Uniform1f(b,c.u_is_text),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_texsize:new a.Uniform2f(b,c.u_texsize),u_texture:new a.Uniform1i(b,c.u_texture)}},symbolSDF:function(b,c){return{u_is_size_zoom_constant:new a.Uniform1i(b,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,c.u_size_t),u_size:new a.Uniform1f(b,c.u_size),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,c.u_pitch),u_rotate_symbol:new a.Uniform1i(b,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,c.u_fade_change),u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,c.u_coord_matrix),u_is_text:new a.Uniform1f(b,c.u_is_text),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_texsize:new a.Uniform2f(b,c.u_texsize),u_texture:new a.Uniform1i(b,c.u_texture),u_gamma_scale:new a.Uniform1f(b,c.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_is_halo:new a.Uniform1f(b,c.u_is_halo)}},background:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_opacity:new a.Uniform1f(b,c.u_opacity),u_color:new a.UniformColor(b,c.u_color)}},backgroundPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_opacity:new a.Uniform1f(b,c.u_opacity),u_image:new a.Uniform1i(b,c.u_image),u_pattern_tl_a:new a.Uniform2f(b,c.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(b,c.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(b,c.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(b,c.u_pattern_br_b),u_texsize:new a.Uniform2f(b,c.u_texsize),u_mix:new a.Uniform1f(b,c.u_mix),u_pattern_size_a:new a.Uniform2f(b,c.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(b,c.u_pattern_size_b),u_scale_a:new a.Uniform1f(b,c.u_scale_a),u_scale_b:new a.Uniform1f(b,c.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(b,c.u_tile_units_to_pixels)}}},kd=a.identity(new Float32Array(16)),ld={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},md={symbol:function(a,b,c,d,e){if("translucent"===a.renderPass){var f=Db.disabled,g=a.colorModeForRenderPass();0!==c.paint.get("icon-opacity").constantOr(1)&&Y(a,b,c,d,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),f,g,e),0!==c.paint.get("text-opacity").constantOr(1)&&Y(a,b,c,d,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),f,g,e),b.map.showCollisionBoxes&&function(a,b,c,d){U(a,b,c,d,!1),U(a,b,c,d,!0)}(a,b,c,d)}},circle:function(b,c,d,e){if("translucent"===b.renderPass){var f=d.paint.get("circle-opacity"),g=d.paint.get("circle-stroke-width"),h=d.paint.get("circle-stroke-opacity"),i=void 0!==d.layout.get("circle-sort-key").constantOr(1);if(0!==f.constantOr(1)||0!==g.constantOr(1)&&0!==h.constantOr(1)){for(var j=b.context,k=j.gl,l=b.depthModeForSublayer(0,Cb.ReadOnly),m=Db.disabled,n=b.colorModeForRenderPass(),o=[],p=0;p<e.length;p++){var q=e[p],r=c.getTile(q),s=r.getBucket(d);if(s){var t=s.programConfigurations.get(d.id),u={programConfiguration:t,program:b.useProgram("circle",t),layoutVertexBuffer:s.layoutVertexBuffer,indexBuffer:s.indexBuffer,uniformValues:Uc(b,q,r,d)};if(i)for(var v=0,w=s.segments.get();v<w.length;v+=1){var x=w[v];o.push({segments:new a.SegmentVector([x]),sortKey:x.sortKey,state:u})}else o.push({segments:s.segments,sortKey:0,state:u})}}i&&o.sort(function(a,b){return a.sortKey-b.sortKey});for(var y=0,z=o;y<z.length;y+=1){var A=z[y],B=A.state,C=B.programConfiguration,D=B.program,E=B.layoutVertexBuffer,F=B.indexBuffer,G=B.uniformValues,H=A.segments;D.draw(j,k.TRIANGLES,l,m,n,Fb.disabled,G,d.id,E,F,H,d.paint,b.transform.zoom,C)}}}},heatmap:function(b,c,d,e){if(0!==d.paint.get("heatmap-opacity"))if("offscreen"===b.renderPass){var f=b.context,g=f.gl,h=b.depthModeForSublayer(0,Cb.ReadOnly),i=Db.disabled,j=new Eb([g.ONE,g.ONE],a.Color.transparent,[!0,!0,!0,!0]);!function(a,b,c){var d=a.gl;a.activeTexture.set(d.TEXTURE1),a.viewport.set([0,0,b.width/4,b.height/4]);var e=c.heatmapFbo;if(e)d.bindTexture(d.TEXTURE_2D,e.colorAttachment.get()),a.bindFramebuffer.set(e.framebuffer);else{var f=d.createTexture();d.bindTexture(d.TEXTURE_2D,f),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),e=c.heatmapFbo=a.createFramebuffer(b.width/4,b.height/4),function a(b,c,d,e){var f=b.gl;f.texImage2D(f.TEXTURE_2D,0,f.RGBA,c.width/4,c.height/4,0,f.RGBA,b.extTextureHalfFloat?b.extTextureHalfFloat.HALF_FLOAT_OES:f.UNSIGNED_BYTE,null),e.colorAttachment.set(d),b.extTextureHalfFloat&&f.checkFramebufferStatus(f.FRAMEBUFFER)!==f.FRAMEBUFFER_COMPLETE&&(b.extTextureHalfFloat=null,e.colorAttachment.setDirty(),a(b,c,d,e))}(a,b,f,e)}}(f,b,d),f.clear({color:a.Color.transparent});for(var k=0;k<e.length;k++){var l=e[k];if(!c.hasRenderableParent(l)){var m=c.getTile(l),n=m.getBucket(d);if(n){var o=n.programConfigurations.get(d.id),p=b.useProgram("heatmap",o),q=b.transform.zoom;p.draw(f,g.TRIANGLES,h,i,j,Fb.disabled,Zc(l.posMatrix,m,q,d.paint.get("heatmap-intensity")),d.id,n.layoutVertexBuffer,n.indexBuffer,n.segments,d.paint,b.transform.zoom,o)}}}f.viewport.set([0,0,b.width,b.height])}else"translucent"===b.renderPass&&(b.context.setColorMode(b.colorModeForRenderPass()),function(b,c){var d=b.context,e=d.gl,f=c.heatmapFbo;if(f){d.activeTexture.set(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,f.colorAttachment.get()),d.activeTexture.set(e.TEXTURE1);var g=c.colorRampTexture;g||(g=c.colorRampTexture=new a.Texture(d,c.colorRamp,e.RGBA)),g.bind(e.LINEAR,e.CLAMP_TO_EDGE),b.useProgram("heatmapTexture").draw(d,e.TRIANGLES,Cb.disabled,Db.disabled,b.colorModeForRenderPass(),Fb.disabled,function(b,c,d,e){var f=a.create();a.ortho(f,0,b.width,b.height,0,0,1);var g=b.context.gl;return{u_matrix:f,u_world:[g.drawingBufferWidth,g.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:c.paint.get("heatmap-opacity")}}(b,c),c.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,c.paint,b.transform.zoom)}}(b,d))},line:function(b,c,d,e){if("translucent"===b.renderPass){var f=d.paint.get("line-opacity"),g=d.paint.get("line-width");if(0!==f.constantOr(1)&&0!==g.constantOr(1)){var h=b.depthModeForSublayer(0,Cb.ReadOnly),i=b.colorModeForRenderPass(),j=d.paint.get("line-dasharray"),k=d.paint.get("line-pattern"),l=k.constantOr(1),m=d.paint.get("line-gradient"),n=d.getCrossfadeParameters(),o=j?"lineSDF":l?"linePattern":m?"lineGradient":"line",p=b.context,q=p.gl,r=!0;if(m){p.activeTexture.set(q.TEXTURE0);var s=d.gradientTexture;if(!d.gradient)return;s||(s=d.gradientTexture=new a.Texture(p,d.gradient,q.RGBA)),s.bind(q.LINEAR,q.CLAMP_TO_EDGE)}for(var t=0,u=e;t<u.length;t+=1){var v=u[t],w=c.getTile(v);if(!l||w.patternsLoaded()){var x=w.getBucket(d);if(x){var y=x.programConfigurations.get(d.id),z=b.context.program.get(),A=b.useProgram(o,y),B=r||A.program!==z,C=k.constantOr(null);if(C&&w.imageAtlas){var D=w.imageAtlas.patternPositions[C.to],E=w.imageAtlas.patternPositions[C.from];D&&E&&y.setConstantPatternPositions(D,E)}var F=j?dd(b,w,d,j,n):l?cd(b,w,d,n):m?bd(b,w,d):ad(b,w,d);j&&(B||b.lineAtlas.dirty)?(p.activeTexture.set(q.TEXTURE0),b.lineAtlas.bind(p)):l&&(p.activeTexture.set(q.TEXTURE0),w.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),y.updatePatternPaintBuffers(n)),A.draw(p,q.TRIANGLES,h,b.stencilModeForClipping(v),i,Fb.disabled,F,d.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,d.paint,b.transform.zoom,y),r=!1}}}}}},fill:function(b,c,d,e){var f=d.paint.get("fill-color"),g=d.paint.get("fill-opacity");if(0!==g.constantOr(1)){var h=b.colorModeForRenderPass(),i=d.paint.get("fill-pattern"),j=b.opaquePassEnabledForLayer()&&!i.constantOr(1)&&1===f.constantOr(a.Color.transparent).a&&1===g.constantOr(0)?"opaque":"translucent";if(b.renderPass===j){$(b,c,d,e,b.depthModeForSublayer(1,"opaque"===b.renderPass?Cb.ReadWrite:Cb.ReadOnly),h,!1)}if("translucent"===b.renderPass&&d.paint.get("fill-antialias")){$(b,c,d,e,b.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,Cb.ReadOnly),h,!0)}}},"fill-extrusion":function(a,b,c,d){var e=c.paint.get("fill-extrusion-opacity");if(0!==e&&"translucent"===a.renderPass){var f=new Cb(a.context.gl.LEQUAL,Cb.ReadWrite,a.depthRangeFor3D);if(1!==e||c.paint.get("fill-extrusion-pattern").constantOr(1))_(a,b,c,d,f,Db.disabled,Eb.disabled),_(a,b,c,d,f,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var g=a.colorModeForRenderPass();_(a,b,c,d,f,Db.disabled,g)}}},hillshade:function(a,b,c,d){if("offscreen"===a.renderPass||"translucent"===a.renderPass){
for(var e=a.context,f=b.getSource().maxzoom,g=a.depthModeForSublayer(0,Cb.ReadOnly),h=Db.disabled,i=a.colorModeForRenderPass(),j=0,k=d;j<k.length;j+=1){var l=k[j],m=b.getTile(l);m.needsHillshadePrepare&&"offscreen"===a.renderPass?ba(a,m,c,f,g,h,i):"translucent"===a.renderPass&&aa(a,m,c,g,h,i)}e.viewport.set([0,0,a.width,a.height])}},raster:function(a,b,c,d){if("translucent"===a.renderPass&&0!==c.paint.get("raster-opacity"))for(var e=a.context,f=e.gl,g=b.getSource(),h=a.useProgram("raster"),i=Db.disabled,j=a.colorModeForRenderPass(),k=d.length&&d[0].overscaledZ,l=!a.options.moving,m=0,n=d;m<n.length;m+=1){var o=n[m],p=a.depthModeForSublayer(o.overscaledZ-k,1===c.paint.get("raster-opacity")?Cb.ReadWrite:Cb.ReadOnly,f.LESS),q=b.getTile(o),r=a.transform.calculatePosMatrix(o.toUnwrapped(),l);q.registerFadeDuration(c.paint.get("raster-fade-duration"));var s=b.findLoadedParent(o,0),t=ca(q,s,b,c,a.transform),u=void 0,v=void 0,w="nearest"===c.paint.get("raster-resampling")?f.NEAREST:f.LINEAR;e.activeTexture.set(f.TEXTURE0),q.texture.bind(w,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST),e.activeTexture.set(f.TEXTURE1),s?(s.texture.bind(w,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST),u=Math.pow(2,s.tileID.overscaledZ-q.tileID.overscaledZ),v=[q.tileID.canonical.x*u%1,q.tileID.canonical.y*u%1]):q.texture.bind(w,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST);var x=ed(r,v||[0,0],u||1,t,c);g instanceof La?h.draw(e,f.TRIANGLES,p,i,j,Fb.disabled,x,c.id,g.boundsBuffer,a.quadTriangleIndexBuffer,g.boundsSegments):q.maskedBoundsBuffer&&q.maskedIndexBuffer&&q.segments?h.draw(e,f.TRIANGLES,p,i,j,Fb.disabled,x,c.id,q.maskedBoundsBuffer,q.maskedIndexBuffer,q.segments,c.paint,a.transform.zoom):h.draw(e,f.TRIANGLES,p,i,j,Fb.disabled,x,c.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,b,c){var d=c.paint.get("background-color"),e=c.paint.get("background-opacity");if(0!==e){var f=a.context,g=f.gl,h=a.transform,i=h.tileSize,j=c.paint.get("background-pattern");if(!a.isPatternMissing(j)){var k=!j&&1===d.a&&1===e&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===k){var l=Db.disabled,m=a.depthModeForSublayer(0,"opaque"===k?Cb.ReadWrite:Cb.ReadOnly),n=a.colorModeForRenderPass(),o=a.useProgram(j?"backgroundPattern":"background"),p=h.coveringTiles({tileSize:i});j&&(f.activeTexture.set(g.TEXTURE0),a.imageManager.bind(a.context));for(var q=c.getCrossfadeParameters(),r=0,s=p;r<s.length;r+=1){var t=s[r],u=a.transform.calculatePosMatrix(t.toUnwrapped()),v=j?id(u,e,a,j,{tileID:t,tileSize:i},q):hd(u,e,d);o.draw(f,g.TRIANGLES,m,l,n,Fb.disabled,v,c.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,b,c){for(var d=0;d<c.length;d++)da(a,b,c[d])},custom:function(a,b,c){var d=a.context,e=c.implementation;if("offscreen"===a.renderPass){var f=e.prerender;f&&(a.setCustomLayerDefaults(),d.setColorMode(a.colorModeForRenderPass()),f.call(e,d.gl,a.transform.customLayerMatrix()),d.setDirty(),a.setBaseState())}else if("translucent"===a.renderPass){a.setCustomLayerDefaults(),d.setColorMode(a.colorModeForRenderPass()),d.setStencilMode(Db.disabled);var g="3d"===e.renderingMode?new Cb(a.context.gl.LEQUAL,Cb.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,Cb.ReadOnly);d.setDepthMode(g),e.render(d.gl,a.transform.customLayerMatrix()),d.setDirty(),a.setBaseState(),d.bindFramebuffer.set(null)}}},nd=function(b,c){this.context=new Gb(b),this.transform=c,this._tileTextures={},this.setup(),this.numSublayers=Hb.maxUnderzooming+Hb.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new a.ProgramConfiguration,this.crossTileSymbolIndex=new gc};nd.prototype.resize=function(b,c){var d=this.context.gl;if(this.width=b*a.browser.devicePixelRatio,this.height=c*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var e=0,f=this.style._order;e<f.length;e+=1){var g=f[e];this.style._layers[g].resize()}this.depthRbo&&(d.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},nd.prototype.setup=function(){var b=this.context,c=new a.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(a.EXTENT,0),c.emplaceBack(0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=b.createVertexBuffer(c,lc.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var d=new a.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(a.EXTENT,0),d.emplaceBack(0,a.EXTENT),d.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=b.createVertexBuffer(d,lc.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var e=new a.StructArrayLayout4i8;e.emplaceBack(0,0,0,0),e.emplaceBack(a.EXTENT,0,a.EXTENT,0),e.emplaceBack(0,a.EXTENT,0,a.EXTENT),e.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=b.createVertexBuffer(e,a.rasterBoundsAttributes.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var f=new a.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(1,0),f.emplaceBack(0,1),f.emplaceBack(1,1),this.viewportBuffer=b.createVertexBuffer(f,lc.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var g=new a.StructArrayLayout1ui2;g.emplaceBack(0),g.emplaceBack(1),g.emplaceBack(3),g.emplaceBack(2),g.emplaceBack(0),this.tileBorderIndexBuffer=b.createIndexBuffer(g);var h=new a.StructArrayLayout3ui6;h.emplaceBack(0,1,2),h.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=b.createIndexBuffer(h);var i=this.context.gl;this.stencilClearMode=new Db({func:i.ALWAYS,mask:0},0,255,i.ZERO,i.ZERO,i.ZERO)},nd.prototype.clearStencil=function(){var b=this.context,c=b.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var d=a.create();a.ortho(d,0,this.width,this.height,0,0,1),a.scale(d,d,[c.drawingBufferWidth,c.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(b,c.TRIANGLES,Cb.disabled,this.stencilClearMode,Eb.disabled,Fb.disabled,Yc(d),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},nd.prototype._renderTileClippingMasks=function(a,b){if(this.currentStencilSource!==a.source&&a.isTileClipped()&&b&&b.length){this.currentStencilSource=a.source;var c=this.context,d=c.gl;this.nextStencilID+b.length>256&&this.clearStencil(),c.setColorMode(Eb.disabled),c.setDepthMode(Cb.disabled);var e=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var f=0,g=b;f<g.length;f+=1){var h=g[f],i=this._tileClippingMaskIDs[h.key]=this.nextStencilID++;e.draw(c,d.TRIANGLES,Cb.disabled,new Db({func:d.ALWAYS,mask:0},i,255,d.KEEP,d.KEEP,d.REPLACE),Eb.disabled,Fb.disabled,Yc(h.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},nd.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var a=this.nextStencilID++,b=this.context.gl;return new Db({func:b.NOTEQUAL,mask:255},a,255,b.KEEP,b.KEEP,b.REPLACE)},nd.prototype.stencilModeForClipping=function(a){var b=this.context.gl;return new Db({func:b.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,b.KEEP,b.KEEP,b.REPLACE)},nd.prototype.colorModeForRenderPass=function(){var b=this.context.gl;return this._showOverdrawInspector?new Eb([b.CONSTANT_COLOR,b.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Eb.unblended:Eb.alphaBlended},nd.prototype.depthModeForSublayer=function(a,b,c){if(!this.opaquePassEnabledForLayer())return Cb.disabled;var d=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new Cb(c||this.context.gl.LEQUAL,b,[d,d])},nd.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},nd.prototype.render=function(b,c){this.style=b,this.options=c,this.lineAtlas=b.lineAtlas,this.imageManager=b.imageManager,this.glyphManager=b.glyphManager,this.symbolFadeChange=b.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var d=this.style._order,e=this.style.sourceCaches;for(var f in e){var g=e[f];g.used&&g.prepare(this.context)}var h={},i={},j={};for(var k in e){var l=e[k];h[k]=l.getVisibleCoordinates(),i[k]=h[k].slice().reverse(),j[k]=l.getVisibleCoordinates(!0).reverse()}for(var m in e){var n=e[m],o=n.getSource();if("raster"===o.type||"raster-dem"===o.type){for(var p=[],q=0,r=h[m];q<r.length;q+=1){var s=r[q];p.push(n.getTile(s))}S(p,this.context)}}this.opaquePassCutoff=1/0;for(var t=0;t<d.length;t++){var u=d[t];if(this.style._layers[u].is3D()){this.opaquePassCutoff=t;break}}this.renderPass="offscreen",this.depthRboNeedsClear=!0;for(var v=0,w=d;v<w.length;v+=1){var x=w[v],y=this.style._layers[x];if(y.hasOffscreenPass()&&!y.isHidden(this.transform.zoom)){var z=i[y.source];("custom"===y.type||z.length)&&this.renderLayer(this,e[y.source],y,z)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRangeFor3D=[0,1-(b._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){var A=this.style._layers[d[this.currentLayer]],B=e[A.source],C=h[A.source];this._renderTileClippingMasks(A,C),this.renderLayer(this,B,A,C)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){var D=this.style._layers[d[this.currentLayer]],E=e[D.source],F=("symbol"===D.type?j:i)[D.source];this._renderTileClippingMasks(D,h[D.source]),this.renderLayer(this,E,D,F)}if(this.options.showTileBoundaries)for(var G in e){md.debug(this,e[G],h[G]);break}this.context.setDefault()},nd.prototype.setupOffscreenDepthRenderbuffer=function(){var a=this.context;this.depthRbo||(this.depthRbo=a.createRenderbuffer(a.gl.DEPTH_COMPONENT16,this.width,this.height))},nd.prototype.renderLayer=function(a,b,c,d){c.isHidden(this.transform.zoom)||("background"===c.type||"custom"===c.type||d.length)&&(this.id=c.id,md[c.type](a,b,c,d,this.style.placement.variableOffsets))},nd.prototype.translatePosMatrix=function(b,c,d,e,f){if(!d[0]&&!d[1])return b;var g=f?"map"===e?this.transform.angle:0:"viewport"===e?-this.transform.angle:0;if(g){var h=Math.sin(g),i=Math.cos(g);d=[d[0]*i-d[1]*h,d[0]*h+d[1]*i]}var j=[f?d[0]:J(c,d[0],this.transform.zoom),f?d[1]:J(c,d[1],this.transform.zoom),0],k=new Float32Array(16);return a.translate(k,b,j),k},nd.prototype.saveTileTexture=function(a){var b=this._tileTextures[a.size[0]];b?b.push(a):this._tileTextures[a.size[0]]=[a]},nd.prototype.getTileTexture=function(a){var b=this._tileTextures[a];return b&&b.length>0?b.pop():null},nd.prototype.isPatternMissing=function(a){if(!a)return!1;var b=this.imageManager.getPattern(a.from),c=this.imageManager.getPattern(a.to);return!b||!c},nd.prototype.useProgram=function(a,b){void 0===b&&(b=this.emptyProgramConfiguration),this.cache=this.cache||{};var c=""+a+(b.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[c]||(this.cache[c]=new Nc(this.context,Lc[a],b,jd[a],this._showOverdrawInspector)),this.cache[c]},nd.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},nd.prototype.setBaseState=function(){var a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)};var od=function(b,c,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===d||d,this._minZoom=b||0,this._maxZoom=c||22,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},pd={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};od.prototype.clone=function(){var a=new od(this._minZoom,this._maxZoom,this._renderWorldCopies);return a.tileSize=this.tileSize,a.latRange=this.latRange,a.width=this.width,a.height=this.height,a._center=this._center,a.zoom=this.zoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._unmodified=this._unmodified,a._calcMatrices(),a},pd.minZoom.get=function(){return this._minZoom},pd.minZoom.set=function(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))},pd.maxZoom.get=function(){return this._maxZoom},pd.maxZoom.set=function(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))},pd.renderWorldCopies.get=function(){return this._renderWorldCopies},pd.renderWorldCopies.set=function(a){void 0===a?a=!0:null===a&&(a=!1),this._renderWorldCopies=a},pd.worldSize.get=function(){return this.tileSize*this.scale},pd.centerPoint.get=function(){return this.size._div(2)},pd.size.get=function(){return new a.Point(this.width,this.height)},pd.bearing.get=function(){return-this.angle/Math.PI*180},pd.bearing.set=function(b){var c=-a.wrap(b,-180,180)*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},pd.pitch.get=function(){return this._pitch/Math.PI*180},pd.pitch.set=function(b){var c=a.clamp(b,0,60)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())},pd.fov.get=function(){return this._fov/Math.PI*180},pd.fov.set=function(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())},pd.zoom.get=function(){return this._zoom},pd.zoom.set=function(a){var b=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==b&&(this._unmodified=!1,this._zoom=b,this.scale=this.zoomScale(b),this.tileZoom=Math.floor(b),this.zoomFraction=b-this.tileZoom,this._constrain(),this._calcMatrices())},pd.center.get=function(){return this._center},pd.center.set=function(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())},od.prototype.coveringZoomLevel=function(a){return(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize))},od.prototype.getVisibleUnwrappedCoordinates=function(b){var c=[new a.UnwrappedTileID(0,b)];if(this._renderWorldCopies)for(var d=this.pointCoordinate(new a.Point(0,0)),e=this.pointCoordinate(new a.Point(this.width,0)),f=this.pointCoordinate(new a.Point(this.width,this.height)),g=this.pointCoordinate(new a.Point(0,this.height)),h=Math.floor(Math.min(d.x,e.x,f.x,g.x)),i=Math.floor(Math.max(d.x,e.x,f.x,g.x)),j=h-1;j<=i+1;j++)0!==j&&c.push(new a.UnwrappedTileID(j,b));return c},od.prototype.coveringTiles=function(b){var c=this.coveringZoomLevel(b),d=c;if(void 0!==b.minzoom&&c<b.minzoom)return[];void 0!==b.maxzoom&&c>b.maxzoom&&(c=b.maxzoom);var e=a.MercatorCoordinate.fromLngLat(this.center),f=Math.pow(2,c),g=new a.Point(f*e.x-.5,f*e.y-.5);return function(b,c,d,e){function f(c,f,i){var j,k,l,m;if(i>=0&&i<=g)for(j=c;j<f;j++)k=Math.floor(j/g),l=(j%g+g)%g,0!==k&&!0!==e||(m=new a.OverscaledTileID(d,k,b,l,i),h[m.key]=m)}void 0===e&&(e=!0);var g=1<<b,h={},i=c.map(function(b){return new a.Point(b.x,b.y)._mult(g)});return ga(i[0],i[1],i[2],0,g,f),ga(i[2],i[3],i[0],0,g,f),Object.keys(h).map(function(a){return h[a]})}(c,[this.pointCoordinate(new a.Point(0,0)),this.pointCoordinate(new a.Point(this.width,0)),this.pointCoordinate(new a.Point(this.width,this.height)),this.pointCoordinate(new a.Point(0,this.height))],b.reparseOverscaled?d:c,this._renderWorldCopies).sort(function(a,b){return g.dist(a.canonical)-g.dist(b.canonical)})},od.prototype.resize=function(a,b){this.width=a,this.height=b,this.pixelsToGLUnits=[2/a,-2/b],this._constrain(),this._calcMatrices()},pd.unmodified.get=function(){return this._unmodified},od.prototype.zoomScale=function(a){return Math.pow(2,a)},od.prototype.scaleZoom=function(a){return Math.log(a)/Math.LN2},od.prototype.project=function(b){var c=a.clamp(b.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(b.lng)*this.worldSize,a.mercatorYfromLat(c)*this.worldSize)},od.prototype.unproject=function(b){return new a.MercatorCoordinate(b.x/this.worldSize,b.y/this.worldSize).toLngLat()},pd.point.get=function(){return this.project(this.center)},od.prototype.setLocationAtPoint=function(b,c){var d=this.pointCoordinate(c),e=this.pointCoordinate(this.centerPoint),f=this.locationCoordinate(b),g=new a.MercatorCoordinate(f.x-(d.x-e.x),f.y-(d.y-e.y));this.center=this.coordinateLocation(g),this._renderWorldCopies&&(this.center=this.center.wrap())},od.prototype.locationPoint=function(a){return this.coordinatePoint(this.locationCoordinate(a))},od.prototype.pointLocation=function(a){return this.coordinateLocation(this.pointCoordinate(a))},od.prototype.locationCoordinate=function(b){return a.MercatorCoordinate.fromLngLat(b)},od.prototype.coordinateLocation=function(a){return a.toLngLat()},od.prototype.pointCoordinate=function(b){var c=[b.x,b.y,0,1],d=[b.x,b.y,1,1];a.transformMat4(c,c,this.pixelMatrixInverse),a.transformMat4(d,d,this.pixelMatrixInverse);var e=c[3],f=d[3],g=c[0]/e,h=d[0]/f,i=c[1]/e,j=d[1]/f,k=c[2]/e,l=d[2]/f,m=k===l?0:(0-k)/(l-k);return new a.MercatorCoordinate(a.number(g,h,m)/this.worldSize,a.number(i,j,m)/this.worldSize)},od.prototype.coordinatePoint=function(b){var c=[b.x*this.worldSize,b.y*this.worldSize,0,1];return a.transformMat4(c,c,this.pixelMatrix),new a.Point(c[0]/c[3],c[1]/c[3])},od.prototype.getBounds=function(){return(new a.LngLatBounds).extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},od.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},od.prototype.setMaxBounds=function(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},od.prototype.calculatePosMatrix=function(b,c){void 0===c&&(c=!1);var d=b.key,e=c?this._alignedPosMatrixCache:this._posMatrixCache;if(e[d])return e[d];var f=b.canonical,g=this.worldSize/this.zoomScale(f.z),h=f.x+Math.pow(2,f.z)*b.wrap,i=a.identity(new Float64Array(16));return a.translate(i,i,[h*g,f.y*g,0]),a.scale(i,i,[g/a.EXTENT,g/a.EXTENT,1]),a.multiply(i,c?this.alignedProjMatrix:this.projMatrix,i),e[d]=new Float32Array(i),e[d]},od.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},od.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var b,c,d,e,f=-90,g=90,h=-180,i=180,j=this.size,k=this._unmodified;if(this.latRange){var l=this.latRange;f=a.mercatorYfromLat(l[1])*this.worldSize,b=(g=a.mercatorYfromLat(l[0])*this.worldSize)-f<j.y?j.y/(g-f):0}if(this.lngRange){var m=this.lngRange;h=a.mercatorXfromLng(m[0])*this.worldSize,c=(i=a.mercatorXfromLng(m[1])*this.worldSize)-h<j.x?j.x/(i-h):0}var n=this.point,o=Math.max(c||0,b||0);if(o)return this.center=this.unproject(new a.Point(c?(i+h)/2:n.x,b?(g+f)/2:n.y)),this.zoom+=this.scaleZoom(o),this._unmodified=k,void(this._constraining=!1);if(this.latRange){var p=n.y,q=j.y/2;p-q<f&&(e=f+q),p+q>g&&(e=g-q)}if(this.lngRange){var r=n.x,s=j.x/2;r-s<h&&(d=h+s),r+s>i&&(d=i-s)}void 0===d&&void 0===e||(this.center=this.unproject(new a.Point(void 0!==d?d:n.x,void 0!==e?e:n.y))),this._unmodified=k,this._constraining=!1}},od.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var b=this._fov/2,c=Math.PI/2+this._pitch,d=Math.sin(b)*this.cameraToCenterDistance/Math.sin(Math.PI-c-b),e=this.point,f=e.x,g=e.y,h=1.01*(Math.cos(Math.PI/2-this._pitch)*d+this.cameraToCenterDistance),i=this.height/50,j=new Float64Array(16);a.perspective(j,this._fov,this.width/this.height,i,h),a.scale(j,j,[1,-1,1]),a.translate(j,j,[0,0,-this.cameraToCenterDistance]),a.rotateX(j,j,this._pitch),a.rotateZ(j,j,this.angle),a.translate(j,j,[-f,-g,0]),this.mercatorMatrix=a.scale([],j,[this.worldSize,this.worldSize,this.worldSize]),a.scale(j,j,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=j;var k=this.width%2/2,l=this.height%2/2,m=Math.cos(this.angle),n=Math.sin(this.angle),o=f-Math.round(f)+m*k+n*l,p=g-Math.round(g)+m*l+n*k,q=new Float64Array(j);if(a.translate(q,q,[o>.5?o-1:o,p>.5?p-1:p,0]),this.alignedProjMatrix=q,j=a.create(),a.scale(j,j,[this.width/2,-this.height/2,1]),a.translate(j,j,[1,-1,0]),this.labelPlaneMatrix=j,j=a.create(),a.scale(j,j,[1,-1,1]),a.translate(j,j,[-1,-1,0]),a.scale(j,j,[2/this.width,2/this.height,1]),this.glCoordMatrix=j,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(j=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=j,this._posMatrixCache={},this._alignedPosMatrixCache={}}},od.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var b=this.pointCoordinate(new a.Point(0,0)),c=[b.x*this.worldSize,b.y*this.worldSize,0,1];return a.transformMat4(c,c,this.pixelMatrix)[3]/this.cameraToCenterDistance},od.prototype.getCameraPoint=function(){var b=this._pitch,c=Math.tan(b)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,c))},od.prototype.getCameraQueryGeometry=function(b){var c=this.getCameraPoint();if(1===b.length)return[b[0],c];for(var d=c.x,e=c.y,f=c.x,g=c.y,h=0,i=b;h<i.length;h+=1){var j=i[h];d=Math.min(d,j.x),e=Math.min(e,j.y),f=Math.max(f,j.x),g=Math.max(g,j.y)}return[new a.Point(d,e),new a.Point(f,e),new a.Point(f,g),new a.Point(d,g),new a.Point(d,e)]},Object.defineProperties(od.prototype,pd);var qd=function(){var b,c,d,e;a.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(b=this._updateHashUnthrottled.bind(this),c=!1,d=null,e=function(){d=null,c&&(b(),d=setTimeout(e,300),c=!1)},function(){return c=!0,d||e(),d})};qd.prototype.addTo=function(b){return this._map=b,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},qd.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},qd.prototype.getHashString=function(a){var b=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,d=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),e=Math.pow(10,d),f=Math.round(b.lng*e)/e,g=Math.round(b.lat*e)/e,h=this._map.getBearing(),i=this._map.getPitch(),j="";return j+=a?"#/"+f+"/"+g+"/"+c:"#"+c+"/"+g+"/"+f,(h||i)&&(j+="/"+Math.round(10*h)/10),i&&(j+="/"+Math.round(i)),j},qd.prototype._onHashChange=function(){var b=a.window.location.hash.replace("#","").split("/");return b.length>=3&&(this._map.jumpTo({center:[+b[2],+b[1]],zoom:+b[0],bearing:+(b[3]||0),pitch:+(b[4]||0)}),!0)},qd.prototype._updateHashUnthrottled=function(){var b=this.getHashString();try{a.window.history.replaceState(a.window.history.state,"",b)}catch(a){}};var rd=function(b){function c(c,d,e,f){void 0===f&&(f={});var g=pa.mousePos(d.getCanvasContainer(),e),h=d.unproject(g);b.call(this,c,a.extend({point:g,lngLat:h,originalEvent:e},f)),this._defaultPrevented=!1,this.target=d}b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c;var d={defaultPrevented:{configurable:!0}};return c.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(c.prototype,d),c}(a.Event),sd=function(b){function c(c,d,e){var f=pa.touchPos(d.getCanvasContainer(),e),g=f.map(function(a){return d.unproject(a)}),h=f.reduce(function(a,b,c,d){return a.add(b.div(d.length))},new a.Point(0,0)),i=d.unproject(h);b.call(this,c,{points:f,point:h,lngLats:g,lngLat:i,originalEvent:e}),this._defaultPrevented=!1}b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c;var d={defaultPrevented:{configurable:!0}};return c.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(c.prototype,d),c}(a.Event),td=function(a){function b(b,c,d){a.call(this,b,{originalEvent:d}),this._defaultPrevented=!1}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={defaultPrevented:{configurable:!0}};return b.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(b.prototype,c),b}(a.Event),ud=function(b){this._map=b,this._el=b.getCanvasContainer(),this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};ud.prototype.setZoomRate=function(a){this._defaultZoomRate=a},ud.prototype.setWheelZoomRate=function(a){this._wheelZoomRate=a},ud.prototype.isEnabled=function(){return!!this._enabled},ud.prototype.isActive=function(){return!!this._active},ud.prototype.isZooming=function(){return!!this._zooming},ud.prototype.enable=function(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=a&&"center"===a.around)},ud.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ud.prototype.onWheel=function(b){if(this.isEnabled()){var c=b.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*b.deltaY:b.deltaY,d=a.browser.now(),e=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,0!==c&&c%4.000244140625==0?this._type="wheel":0!==c&&Math.abs(c)<4?this._type="trackpad":e>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,b)):this._type||(this._type=Math.abs(e*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),b.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=b,this._delta-=c,this.isActive()||this._start(b)),b.preventDefault()}},ud.prototype._onTimeout=function(a){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(a)},ud.prototype._start=function(b){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0,this._map.fire(new a.Event("movestart",{originalEvent:b})),this._map.fire(new a.Event("zoomstart",{originalEvent:b}))),this._finishTimeout&&clearTimeout(this._finishTimeout);var c=pa.mousePos(this._el,b);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(c)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},ud.prototype._onScrollFrame=function(){var b=this;if(this._frameId=null,this.isActive()){var c=this._map.transform;if(0!==this._delta){var d="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,e=2/(1+Math.exp(-Math.abs(this._delta*d)));this._delta<0&&0!==e&&(e=1/e);var f="number"==typeof this._targetZoom?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(f*e))),"wheel"===this._type&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var g="number"==typeof this._targetZoom?this._targetZoom:c.zoom,h=this._startZoom,i=this._easing,j=!1;if("wheel"===this._type&&h&&i){var k=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),l=i(k);c.zoom=a.number(h,g,l),k<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):j=!0}else c.zoom=g,j=!0;c.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new a.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new a.Event("zoom",{originalEvent:this._lastWheelEvent})),j&&(this._active=!1,this._finishTimeout=setTimeout(function(){b._zooming=!1,b._map.fire(new a.Event("zoomend",{originalEvent:b._lastWheelEvent})),b._map.fire(new a.Event("moveend",{originalEvent:b._lastWheelEvent})),delete b._targetZoom},200))}},ud.prototype._smoothOutEasing=function(b){var c=a.ease;if(this._prevEase){var d=this._prevEase,e=(a.browser.now()-d.start)/d.duration,f=d.easing(e+.01)-d.easing(e),g=.27/Math.sqrt(f*f+1e-4)*.01,h=Math.sqrt(.0729-g*g);c=a.bezier(g,h,.25,1)}return this._prevEase={start:a.browser.now(),duration:b,easing:c},c};var vd=function(b,c){this._map=b,this._el=b.getCanvasContainer(),this._container=b.getContainer(),this._clickTolerance=c.clickTolerance||1,a.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};vd.prototype.isEnabled=function(){return!!this._enabled},vd.prototype.isActive=function(){return!!this._active},vd.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},vd.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},vd.prototype.onMouseDown=function(b){this.isEnabled()&&b.shiftKey&&0===b.button&&(a.window.document.addEventListener("mousemove",this._onMouseMove,!1),a.window.document.addEventListener("keydown",this._onKeyDown,!1),a.window.document.addEventListener("mouseup",this._onMouseUp,!1),pa.disableDrag(),this._startPos=this._lastPos=pa.mousePos(this._el,b),this._active=!0)},vd.prototype._onMouseMove=function(a){var b=pa.mousePos(this._el,a);if(!(this._lastPos.equals(b)||!this._box&&b.dist(this._startPos)<this._clickTolerance)){var c=this._startPos;this._lastPos=b,this._box||(this._box=pa.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));var d=Math.min(c.x,b.x),e=Math.max(c.x,b.x),f=Math.min(c.y,b.y),g=Math.max(c.y,b.y);pa.setTransform(this._box,"translate("+d+"px,"+f+"px)"),this._box.style.width=e-d+"px",this._box.style.height=g-f+"px"}},vd.prototype._onMouseUp=function(b){if(0===b.button){var c=this._startPos,d=pa.mousePos(this._el,b);this._finish(),pa.suppressClick(),c.x===d.x&&c.y===d.y?this._fireEvent("boxzoomcancel",b):this._map.fitScreenCoordinates(c,d,this._map.getBearing(),{linear:!0}).fire(new a.Event("boxzoomend",{originalEvent:b}))}},vd.prototype._onKeyDown=function(a){27===a.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",a))},vd.prototype._finish=function(){this._active=!1,a.window.document.removeEventListener("mousemove",this._onMouseMove,!1),a.window.document.removeEventListener("keydown",this._onKeyDown,!1),a.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(pa.remove(this._box),this._box=null),pa.enableDrag(),delete this._startPos,delete this._lastPos},vd.prototype._fireEvent=function(b,c){return this._map.fire(new a.Event(b,{originalEvent:c}))};var wd=a.bezier(0,0,.25,1),xd=function(b,c){this._map=b,this._el=c.element||b.getCanvasContainer(),this._state="disabled",this._button=c.button||"right",this._bearingSnap=c.bearingSnap||0,this._pitchWithRotate=!1!==c.pitchWithRotate,a.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};xd.prototype.isEnabled=function(){return"disabled"!==this._state},xd.prototype.isActive=function(){return"active"===this._state},xd.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},xd.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),
this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},xd.prototype.onMouseDown=function(b){if("enabled"===this._state){var c="touchstart"===b.type;if(c)this._startTime=Date.now();else if("right"===this._button){if(this._eventButton=pa.mouseButton(b),this._eventButton!==(b.ctrlKey?0:2))return}else{if(b.ctrlKey||0!==pa.mouseButton(b))return;this._eventButton=0}pa.disableDrag(),c?(a.window.document.addEventListener("touchmove",this._onMouseMove,{capture:!0}),a.window.document.addEventListener("touchend",this._onMouseUp)):(a.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),a.window.document.addEventListener("mouseup",this._onMouseUp)),a.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[a.browser.now(),this._map.getBearing()]],this._startPos=this._prevPos=this._lastPos=pa.mousePos(this._el,b),this._center=this._map.transform.centerPoint,b.preventDefault()}},xd.prototype._onMouseMove=function(a){var b=pa.mousePos(this._el,a);this._lastPos.equals(b)||(this._lastMoveEvent=a,this._lastPos=b,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",a),this._fireEvent("movestart",a),this._pitchWithRotate&&this._fireEvent("pitchstart",a)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},xd.prototype._onDragFrame=function(){this._frameId=null;var b=this._lastMoveEvent;if(b){var c=this._map.transform,d=this._prevPos,e=this._lastPos,f=.8*(d.x-e.x),g=-.5*(d.y-e.y),h=c.bearing-f,i=c.pitch-g,j=this._inertia,k=j[j.length-1];this._drainInertiaBuffer(),j.push([a.browser.now(),this._map._normalizeBearing(h,k[1])]),c.bearing=h,this._pitchWithRotate&&(this._fireEvent("pitch",b),c.pitch=i),this._fireEvent("rotate",b),this._fireEvent("move",b),delete this._lastMoveEvent,this._prevPos=this._lastPos}},xd.prototype._onMouseUp=function(a){if("touchend"===a.type&&this._startPos===this._lastPos&&Date.now()-this._startTime<300&&this._el.click(),pa.mouseButton(a)===this._eventButton)switch(this._state){case"active":this._state="enabled",pa.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(a);break;case"pending":this._state="enabled",this._unbind()}},xd.prototype._onBlur=function(a){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",a),this._pitchWithRotate&&this._fireEvent("pitchend",a),this._fireEvent("moveend",a);break;case"pending":this._state="enabled",this._unbind()}},xd.prototype._unbind=function(){a.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),a.window.document.removeEventListener("mouseup",this._onMouseUp),a.window.document.removeEventListener("touchmove",this._onMouseMove,{capture:!0}),a.window.document.removeEventListener("touchend",this._onMouseUp),a.window.removeEventListener("blur",this._onBlur),pa.enableDrag()},xd.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._prevPos,delete this._lastPos},xd.prototype._inertialRotate=function(a){var b=this;this._fireEvent("rotateend",a),this._drainInertiaBuffer();var c=this._map,d=c.getBearing(),e=this._inertia,f=function(){Math.abs(d)<b._bearingSnap?c.resetNorth({noMoveStart:!0},{originalEvent:a}):b._fireEvent("moveend",a),b._pitchWithRotate&&b._fireEvent("pitchend",a)};if(e.length<2)f();else{var g=e[0],h=e[e.length-1],i=e[e.length-2],j=c._normalizeBearing(d,i[1]),k=h[1]-g[1],l=k<0?-1:1,m=(h[0]-g[0])/1e3;if(0!==k&&0!==m){var n=Math.abs(k*(.25/m));n>180&&(n=180);var o=n/180;j+=l*n*(o/2),Math.abs(c._normalizeBearing(j,0))<this._bearingSnap&&(j=c._normalizeBearing(0,j)),c.rotateTo(j,{duration:1e3*o,easing:wd,noMoveStart:!0},{originalEvent:a})}else f()}},xd.prototype._fireEvent=function(b,c){return this._map.fire(new a.Event(b,c?{originalEvent:c}:{}))},xd.prototype._drainInertiaBuffer=function(){for(var b=this._inertia,c=a.browser.now();b.length>0&&c-b[0][0]>160;)b.shift()};var yd=a.bezier(0,0,.3,1),zd=function(b,c){this._map=b,this._el=b.getCanvasContainer(),this._state="disabled",this._clickTolerance=c.clickTolerance||1,a.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};zd.prototype.isEnabled=function(){return"disabled"!==this._state},zd.prototype.isActive=function(){return"active"===this._state},zd.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},zd.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},zd.prototype.onMouseDown=function(b){"enabled"===this._state&&(b.ctrlKey||0!==pa.mouseButton(b)||(pa.addEventListener(a.window.document,"mousemove",this._onMove,{capture:!0}),pa.addEventListener(a.window.document,"mouseup",this._onMouseUp),this._start(b)))},zd.prototype.onTouchStart=function(b){"enabled"===this._state&&(b.touches.length>1||(pa.addEventListener(a.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),pa.addEventListener(a.window.document,"touchend",this._onTouchEnd),this._start(b)))},zd.prototype._start=function(b){a.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._prevPos=this._lastPos=pa.mousePos(this._el,b),this._inertia=[[a.browser.now(),this._startPos]]},zd.prototype._onMove=function(b){b.preventDefault();var c=pa.mousePos(this._el,b);this._lastPos.equals(c)||"pending"===this._state&&c.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=b,this._lastPos=c,this._drainInertiaBuffer(),this._inertia.push([a.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",b),this._fireEvent("movestart",b)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},zd.prototype._onDragFrame=function(){this._frameId=null;var a=this._lastMoveEvent;if(a){var b=this._map.transform;b.setLocationAtPoint(b.pointLocation(this._prevPos),this._lastPos),this._fireEvent("drag",a),this._fireEvent("move",a),this._prevPos=this._lastPos,delete this._lastMoveEvent}},zd.prototype._onMouseUp=function(a){if(0===pa.mouseButton(a))switch(this._state){case"active":this._state="enabled",pa.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(a);break;case"pending":this._state="enabled",this._unbind()}},zd.prototype._onTouchEnd=function(a){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(a);break;case"pending":this._state="enabled",this._unbind()}},zd.prototype._onBlur=function(a){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",a),this._fireEvent("moveend",a);break;case"pending":this._state="enabled",this._unbind()}},zd.prototype._unbind=function(){pa.removeEventListener(a.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),pa.removeEventListener(a.window.document,"touchend",this._onTouchEnd),pa.removeEventListener(a.window.document,"mousemove",this._onMove,{capture:!0}),pa.removeEventListener(a.window.document,"mouseup",this._onMouseUp),pa.removeEventListener(a.window,"blur",this._onBlur)},zd.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._prevPos,delete this._mouseDownPos,delete this._lastPos},zd.prototype._inertialPan=function(a){this._fireEvent("dragend",a),this._drainInertiaBuffer();var b=this._inertia;if(b.length<2)this._fireEvent("moveend",a);else{var c=b[b.length-1],d=b[0],e=c[1].sub(d[1]),f=(c[0]-d[0])/1e3;if(0===f||c[1].equals(d[1]))this._fireEvent("moveend",a);else{var g=e.mult(.3/f),h=g.mag();h>1400&&(h=1400,g._unit()._mult(h));var i=h/750,j=g.mult(-i/2);this._map.panBy(j,{duration:1e3*i,easing:yd,noMoveStart:!0},{originalEvent:a})}}},zd.prototype._fireEvent=function(b,c){return this._map.fire(new a.Event(b,c?{originalEvent:c}:{}))},zd.prototype._drainInertiaBuffer=function(){for(var b=this._inertia,c=a.browser.now();b.length>0&&c-b[0][0]>160;)b.shift()};var Ad=function(b){this._map=b,this._el=b.getCanvasContainer(),a.bindAll(["_onKeyDown"],this)};Ad.prototype.isEnabled=function(){return!!this._enabled},Ad.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},Ad.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},Ad.prototype._onKeyDown=function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var b=0,c=0,d=0,e=0,f=0;switch(a.keyCode){case 61:case 107:case 171:case 187:b=1;break;case 189:case 109:case 173:b=-1;break;case 37:a.shiftKey?c=-1:(a.preventDefault(),e=-1);break;case 39:a.shiftKey?c=1:(a.preventDefault(),e=1);break;case 38:a.shiftKey?d=1:(a.preventDefault(),f=-1);break;case 40:a.shiftKey?d=-1:(f=1,a.preventDefault());break;default:return}var g=this._map,h=g.getZoom(),i={duration:300,delayEndEvents:500,easing:ha,zoom:b?Math.round(h)+b*(a.shiftKey?2:1):h,bearing:g.getBearing()+15*c,pitch:g.getPitch()+10*d,offset:[100*-e,100*-f],center:g.getCenter()};g.easeTo(i,{originalEvent:a})}};var Bd=function(b){this._map=b,a.bindAll(["_onDblClick","_onZoomEnd"],this)};Bd.prototype.isEnabled=function(){return!!this._enabled},Bd.prototype.isActive=function(){return!!this._active},Bd.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Bd.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Bd.prototype.onTouchStart=function(a){var b=this;if(this.isEnabled()&&!(a.points.length>1))if(this._tapped){var c=a.points[0],d=this._tappedPoint;if(d&&d.dist(c)<=30){a.originalEvent.preventDefault();var e=function(){b._tapped&&b._zoom(a),b._map.off("touchcancel",f),b._resetTapped()},f=function(){b._map.off("touchend",e),b._resetTapped()};this._map.once("touchend",e),this._map.once("touchcancel",f)}else this._resetTapped()}else this._tappedPoint=a.points[0],this._tapped=setTimeout(function(){b._tapped=null,b._tappedPoint=null},300)},Bd.prototype._resetTapped=function(){clearTimeout(this._tapped),this._tapped=null,this._tappedPoint=null},Bd.prototype.onDblClick=function(a){this.isEnabled()&&(a.originalEvent.preventDefault(),this._zoom(a))},Bd.prototype._zoom=function(a){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(a.originalEvent.shiftKey?-1:1),{around:a.lngLat},a)},Bd.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var Cd=a.bezier(0,0,.15,1),Dd=function(b){this._map=b,this._el=b.getCanvasContainer(),a.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};Dd.prototype.isEnabled=function(){return!!this._enabled},Dd.prototype.enable=function(a){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around)},Dd.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},Dd.prototype.disableRotation=function(){this._rotationDisabled=!0},Dd.prototype.enableRotation=function(){this._rotationDisabled=!1},Dd.prototype.onStart=function(b){if(this.isEnabled()&&2===b.touches.length){var c=pa.mousePos(this._el,b.touches[0]),d=pa.mousePos(this._el,b.touches[1]),e=c.add(d).div(2);this._startVec=c.sub(d),this._startAround=this._map.transform.pointLocation(e),this._gestureIntent=void 0,this._inertia=[],pa.addEventListener(a.window.document,"touchmove",this._onMove,{passive:!1}),pa.addEventListener(a.window.document,"touchend",this._onEnd)}},Dd.prototype._getTouchEventData=function(a){var b=pa.mousePos(this._el,a.touches[0]),c=pa.mousePos(this._el,a.touches[1]),d=b.sub(c);return{vec:d,center:b.add(c).div(2),scale:d.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*d.angleWith(this._startVec)/Math.PI}},Dd.prototype._onMove=function(b){if(2===b.touches.length){var c=this._getTouchEventData(b),d=c.vec,e=c.scale,f=c.bearing;if(!this._gestureIntent){var g=this._rotationDisabled&&1!==e||Math.abs(1-e)>.15;Math.abs(f)>10?this._gestureIntent="rotate":g&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new a.Event(this._gestureIntent+"start",{originalEvent:b})),this._map.fire(new a.Event("movestart",{originalEvent:b})),this._startVec=d)}this._lastTouchEvent=b,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),b.preventDefault()}},Dd.prototype._onTouchFrame=function(){this._frameId=null;var b=this._gestureIntent;if(b){var c=this._map.transform;this._startScale||(this._startScale=c.scale,this._startBearing=c.bearing);var d=this._getTouchEventData(this._lastTouchEvent),e=d.center,f=d.bearing,g=d.scale,h=c.pointLocation(e),i=c.locationPoint(h);"rotate"===b&&(c.bearing=this._startBearing+f),c.zoom=c.scaleZoom(this._startScale*g),c.setLocationAtPoint(this._startAround,i),this._map.fire(new a.Event(b,{originalEvent:this._lastTouchEvent})),this._map.fire(new a.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([a.browser.now(),g,e])}},Dd.prototype._onEnd=function(b){pa.removeEventListener(a.window.document,"touchmove",this._onMove,{passive:!1}),pa.removeEventListener(a.window.document,"touchend",this._onEnd);var c=this._gestureIntent,d=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,c){this._map.fire(new a.Event(c+"end",{originalEvent:b})),this._drainInertiaBuffer();var e=this._inertia,f=this._map;if(e.length<2)f.snapToNorth({},{originalEvent:b});else{var g=e[e.length-1],h=e[0],i=f.transform.scaleZoom(d*g[1]),j=f.transform.scaleZoom(d*h[1]),k=i-j,l=(g[0]-h[0])/1e3,m=g[2];if(0!==l&&i!==j){var n=.15*k/l;Math.abs(n)>2.5&&(n=n>0?2.5:-2.5);var o=1e3*Math.abs(n/(12*.15)),p=i+n*o/2e3;p<0&&(p=0),f.easeTo({zoom:p,duration:o,easing:Cd,around:this._aroundCenter?f.getCenter():f.unproject(m),noMoveStart:!0},{originalEvent:b})}else f.snapToNorth({},{originalEvent:b})}}},Dd.prototype._drainInertiaBuffer=function(){for(var b=this._inertia,c=a.browser.now();b.length>2&&c-b[0][0]>160;)b.shift()};var Ed={scrollZoom:ud,boxZoom:vd,dragRotate:xd,dragPan:zd,keyboard:Ad,doubleClickZoom:Bd,touchZoomRotate:Dd},Fd=function(b){function c(c,d){b.call(this),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=d.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},c.prototype.setCenter=function(a,b){return this.jumpTo({center:a},b)},c.prototype.panBy=function(b,c,d){return b=a.Point.convert(b).mult(-1),this.panTo(this.transform.center,a.extend({offset:b},c),d)},c.prototype.panTo=function(b,c,d){return this.easeTo(a.extend({center:b},c),d)},c.prototype.getZoom=function(){return this.transform.zoom},c.prototype.setZoom=function(a,b){return this.jumpTo({zoom:a},b),this},c.prototype.zoomTo=function(b,c,d){return this.easeTo(a.extend({zoom:b},c),d)},c.prototype.zoomIn=function(a,b){return this.zoomTo(this.getZoom()+1,a,b),this},c.prototype.zoomOut=function(a,b){return this.zoomTo(this.getZoom()-1,a,b),this},c.prototype.getBearing=function(){return this.transform.bearing},c.prototype.setBearing=function(a,b){return this.jumpTo({bearing:a},b),this},c.prototype.rotateTo=function(b,c,d){return this.easeTo(a.extend({bearing:b},c),d)},c.prototype.resetNorth=function(b,c){return this.rotateTo(0,a.extend({duration:1e3},b),c),this},c.prototype.resetNorthPitch=function(b,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},b),c),this},c.prototype.snapToNorth=function(a,b){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,b):this},c.prototype.getPitch=function(){return this.transform.pitch},c.prototype.setPitch=function(a,b){return this.jumpTo({pitch:a},b),this},c.prototype.cameraForBounds=function(b,c){return b=a.LngLatBounds.convert(b),this._cameraForBoxAndBearing(b.getNorthWest(),b.getSouthEast(),0,c)},c.prototype._cameraForBoxAndBearing=function(b,c,d,e){if("number"==typeof(e=a.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding){var f=e.padding;e.padding={top:f,bottom:f,right:f,left:f}}if(a.deepEqual(Object.keys(e.padding).sort(function(a,b){return a<b?-1:a>b?1:0}),["bottom","left","right","top"])){var g=this.transform,h=g.project(a.LngLat.convert(b)),i=g.project(a.LngLat.convert(c)),j=h.rotate(-d*Math.PI/180),k=i.rotate(-d*Math.PI/180),l=new a.Point(Math.max(j.x,k.x),Math.max(j.y,k.y)),m=new a.Point(Math.min(j.x,k.x),Math.min(j.y,k.y)),n=l.sub(m),o=(g.width-e.padding.left-e.padding.right)/n.x,p=(g.height-e.padding.top-e.padding.bottom)/n.y;if(!(p<0||o<0)){var q=Math.min(g.scaleZoom(g.scale*Math.min(o,p)),e.maxZoom),r=a.Point.convert(e.offset),s=(e.padding.left-e.padding.right)/2,t=(e.padding.top-e.padding.bottom)/2,u=new a.Point(r.x+s,r.y+t).mult(g.scale/g.zoomScale(q));return{center:g.unproject(h.add(i).div(2).sub(u)),zoom:q,bearing:d}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else a.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},c.prototype.fitBounds=function(a,b,c){return this._fitInternal(this.cameraForBounds(a,b),b,c)},c.prototype.fitScreenCoordinates=function(b,c,d,e,f){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(b)),this.transform.pointLocation(a.Point.convert(c)),d,e),e,f)},c.prototype._fitInternal=function(b,c,d){return b?(c=a.extend(b,c)).linear?this.easeTo(c,d):this.flyTo(c,d):this},c.prototype.jumpTo=function(b,c){this.stop();var d=this.transform,e=!1,f=!1,g=!1;return"zoom"in b&&d.zoom!==+b.zoom&&(e=!0,d.zoom=+b.zoom),void 0!==b.center&&(d.center=a.LngLat.convert(b.center)),"bearing"in b&&d.bearing!==+b.bearing&&(f=!0,d.bearing=+b.bearing),"pitch"in b&&d.pitch!==+b.pitch&&(g=!0,d.pitch=+b.pitch),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),e&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),f&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),g&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))},c.prototype.easeTo=function(b,c){var d=this;this.stop(),(!1===(b=a.extend({offset:[0,0],duration:500,easing:a.ease},b)).animate||a.browser.prefersReducedMotion)&&(b.duration=0);var e=this.transform,f=this.getZoom(),g=this.getBearing(),h=this.getPitch(),i="zoom"in b?+b.zoom:f,j="bearing"in b?this._normalizeBearing(b.bearing,g):g,k="pitch"in b?+b.pitch:h,l=e.centerPoint.add(a.Point.convert(b.offset)),m=e.pointLocation(l),n=a.LngLat.convert(b.center||m);this._normalizeCenter(n);var o,p,q=e.project(m),r=e.project(n).sub(q),s=e.zoomScale(i-f);return b.around&&(o=a.LngLat.convert(b.around),p=e.locationPoint(o)),this._zooming=i!==f,this._rotating=g!==j,this._pitching=k!==h,this._prepareEase(c,b.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(b){if(d._zooming&&(e.zoom=a.number(f,i,b)),d._rotating&&(e.bearing=a.number(g,j,b)),d._pitching&&(e.pitch=a.number(h,k,b)),o)e.setLocationAtPoint(o,p);else{var m=e.zoomScale(e.zoom-f),n=i>f?Math.min(2,s):Math.max(.5,s),t=Math.pow(n,1-b),u=e.unproject(q.add(r.mult(b*t)).mult(m));e.setLocationAtPoint(e.renderWorldCopies?u.wrap():u,l)}d._fireMoveEvents(c)},function(){b.delayEndEvents?d._easeEndTimeoutID=setTimeout(function(){return d._afterEase(c)},b.delayEndEvents):d._afterEase(c)},b),this},c.prototype._prepareEase=function(b,c){this._moving=!0,c||this.fire(new a.Event("movestart",b)),this._zooming&&this.fire(new a.Event("zoomstart",b)),this._rotating&&this.fire(new a.Event("rotatestart",b)),this._pitching&&this.fire(new a.Event("pitchstart",b))},c.prototype._fireMoveEvents=function(b){this.fire(new a.Event("move",b)),this._zooming&&this.fire(new a.Event("zoom",b)),this._rotating&&this.fire(new a.Event("rotate",b)),this._pitching&&this.fire(new a.Event("pitch",b))},c.prototype._afterEase=function(b){var c=this._zooming,d=this._rotating,e=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,c&&this.fire(new a.Event("zoomend",b)),d&&this.fire(new a.Event("rotateend",b)),e&&this.fire(new a.Event("pitchend",b)),this.fire(new a.Event("moveend",b))},c.prototype.flyTo=function(b,c){function d(a){var b=(x*x-w*w+(a?-1:1)*B*B*y*y)/(2*(a?x:w)*B*y);return Math.log(Math.sqrt(b*b+1)-b)}function e(a){return(Math.exp(a)-Math.exp(-a))/2}function f(a){return(Math.exp(a)+Math.exp(-a))/2}var g=this;if(a.browser.prefersReducedMotion){var h=a.pick(b,["center","zoom","bearing","pitch","around"]);return this.jumpTo(h,c)}this.stop(),b=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},b);var i=this.transform,j=this.getZoom(),k=this.getBearing(),l=this.getPitch(),m="zoom"in b?a.clamp(+b.zoom,i.minZoom,i.maxZoom):j,n="bearing"in b?this._normalizeBearing(b.bearing,k):k,o="pitch"in b?+b.pitch:l,p=i.zoomScale(m-j),q=i.centerPoint.add(a.Point.convert(b.offset)),r=i.pointLocation(q),s=a.LngLat.convert(b.center||r);this._normalizeCenter(s);var t=i.project(r),u=i.project(s).sub(t),v=b.curve,w=Math.max(i.width,i.height),x=w/p,y=u.mag();if("minZoom"in b){var z=a.clamp(Math.min(b.minZoom,j,m),i.minZoom,i.maxZoom),A=w/i.zoomScale(z-j);v=Math.sqrt(A/y*2)}var B=v*v,C=d(0),D=function(a){return f(C)/f(C+v*a)},E=function(a){return w*((f(C)*(e(b=C+v*a)/f(b))-e(C))/B)/y;var b},F=(d(1)-C)/v;if(Math.abs(y)<1e-6||!isFinite(F)){if(Math.abs(w-x)<1e-6)return this.easeTo(b,c);var G=x<w?-1:1;F=Math.abs(Math.log(x/w))/v,E=function(){return 0},D=function(a){return Math.exp(G*v*a)}}if("duration"in b)b.duration=+b.duration;else{var H="screenSpeed"in b?+b.screenSpeed/v:+b.speed;b.duration=1e3*F/H}return b.maxDuration&&b.duration>b.maxDuration&&(b.duration=0),this._zooming=!0,this._rotating=k!==n,this._pitching=o!==l,this._prepareEase(c,!1),this._ease(function(b){var d=b*F,e=1/D(d);i.zoom=1===b?m:j+i.scaleZoom(e),g._rotating&&(i.bearing=a.number(k,n,b)),g._pitching&&(i.pitch=a.number(l,o,b));var f=1===b?s:i.unproject(t.add(u.mult(E(d))).mult(e));i.setLocationAtPoint(i.renderWorldCopies?f.wrap():f,q),g._fireMoveEvents(c)},function(){return g._afterEase(c)},b),this},c.prototype.isEasing=function(){return!!this._easeFrameId},c.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var a=this._onEaseEnd;delete this._onEaseEnd,a.call(this)}return this},c.prototype._ease=function(b,c,d){!1===d.animate||0===d.duration?(b(1),c()):(this._easeStart=a.browser.now(),this._easeOptions=d,this._onEaseFrame=b,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},c.prototype._renderFrameCallback=function(){var b=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(b)),b<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},c.prototype._normalizeBearing=function(b,c){b=a.wrap(b,-180,180);var d=Math.abs(b-c);return Math.abs(b-360-c)<d&&(b-=360),Math.abs(b+360-c)<d&&(b+=360),b},c.prototype._normalizeCenter=function(a){var b=this.transform;if(b.renderWorldCopies&&!b.lngRange){var c=a.lng-b.center.lng;a.lng+=c>180?-360:c<-180?360:0}},c}(a.Evented),Gd=function(b){void 0===b&&(b={}),this.options=b,a.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Gd.prototype.getDefaultPosition=function(){return"bottom-right"},Gd.prototype.onAdd=function(a){var b=this.options&&this.options.compact;return this._map=a,this._container=pa.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=pa.create("div","mapboxgl-ctrl-attrib-inner",this._container),b&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===b&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Gd.prototype.onRemove=function(){pa.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},Gd.prototype._updateEditLink=function(){var b=this._editLink;b||(b=this._editLink=this._container.querySelector(".mapbox-improve-map"));var c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(b){var d=c.reduce(function(a,b,d){return b.value&&(a+=b.key+"="+b.value+(d<c.length-1?"&":"")),a},"?");b.href=a.config.FEEDBACK_URL+"/"+d+(this._map._hash?this._map._hash.getHashString(!0):""),b.rel="noopener nofollow"}},Gd.prototype._updateData=function(a){!a||"metadata"!==a.sourceDataType&&"style"!==a.dataType||(this._updateAttributions(),this._updateEditLink())},Gd.prototype._updateAttributions=function(){if(this._map.style){var a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(function(a){return"string"!=typeof a?"":a})):"string"==typeof this.options.customAttribution&&a.push(this.options.customAttribution)),this._map.style.stylesheet){var b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}var c=this._map.style.sourceCaches;for(var d in c){var e=c[d];if(e.used){var f=e.getSource();f.attribution&&a.indexOf(f.attribution)<0&&a.push(f.attribution)}}a.sort(function(a,b){return a.length-b.length});var g=(a=a.filter(function(b,c){for(var d=c+1;d<a.length;d++)if(a[d].indexOf(b)>=0)return!1;return!0})).join(" | ");g!==this._attribHTML&&(this._attribHTML=g,a.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Gd.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Hd=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};Hd.prototype.onAdd=function(a){this._map=a,this._container=pa.create("div","mapboxgl-ctrl");var b=pa.create("a","mapboxgl-ctrl-logo");return b.target="_blank",b.rel="noopener nofollow",b.href="https://www.mapbox.com/",b.setAttribute("aria-label","Mapbox logo"),b.setAttribute("rel","noopener nofollow"),this._container.appendChild(b),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Hd.prototype.onRemove=function(){pa.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Hd.prototype.getDefaultPosition=function(){return"bottom-left"},Hd.prototype._updateLogo=function(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Hd.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches;for(var b in a)if(a[b].getSource().mapbox_logo)return!0;return!1}},Hd.prototype._updateCompact=function(){var a=this._container.children;if(a.length){var b=a[0];this._map.getCanvasContainer().offsetWidth<250?b.classList.add("mapboxgl-compact"):b.classList.remove("mapboxgl-compact")}};var Id=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Id.prototype.add=function(a){var b=++this._id;return this._queue.push({callback:a,id:b,cancelled:!1}),b},Id.prototype.remove=function(a){for(var b=this._currentlyRunning,c=0,d=b?this._queue.concat(b):this._queue;c<d.length;c+=1){var e=d[c];if(e.id===a)return void(e.cancelled=!0)}},Id.prototype.run=function(){var a=this._currentlyRunning=this._queue;this._queue=[];for(var b=0,c=a;b<c.length;b+=1){var d=c[b];if(!d.cancelled&&(d.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Id.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Jd=a.window.HTMLImageElement,Kd=a.window.HTMLElement,Ld={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Md=function(b){function c(c){var d=this;if(null!=(c=a.extend({},Ld,c)).minZoom&&null!=c.maxZoom&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than minZoom");var e=new od(c.minZoom,c.maxZoom,c.renderWorldCopies);if(b.call(this,e,c),this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=c.preserveDrawingBuffer,this._antialias=c.antialias,this._trackResize=c.trackResize,this._bearingSnap=c.bearingSnap,this._refreshExpiredTiles=c.refreshExpiredTiles,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=c.collectResourceTiming,this._renderTaskQueue=new Id,this._controls=[],this._mapId=a.uniqueId(),this._requestManager=new a.RequestManager(c.transformRequest,c.accessToken),"string"==typeof c.container){if(this._container=a.window.document.getElementById(c.container),!this._container)throw new Error("Container '"+c.container+"' not found.")}else{if(!(c.container instanceof Kd))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return d._update(!1)}),this.on("moveend",function(){return d._update(!1)}),this.on("zoom",function(){return d._update(!0)}),void 0!==a.window&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1)),function(a,b){var c=a.getCanvasContainer(),d=null,e=!1,f=null;for(var g in Ed)a[g]=new Ed[g](a,b),b.interactive&&b[g]&&a[g].enable(b[g]);pa.addEventListener(c,"mouseout",function(b){a.fire(new rd("mouseout",a,b))}),pa.addEventListener(c,"mousedown",function(d){e=!0,f=pa.mousePos(c,d);var g=new rd("mousedown",a,d);a.fire(g),g.defaultPrevented||(b.interactive&&!a.doubleClickZoom.isActive()&&a.stop(),a.boxZoom.onMouseDown(d),a.boxZoom.isActive()||a.dragPan.isActive()||a.dragRotate.onMouseDown(d),a.boxZoom.isActive()||a.dragRotate.isActive()||a.dragPan.onMouseDown(d))}),pa.addEventListener(c,"mouseup",function(b){var c=a.dragRotate.isActive();d&&!c&&a.fire(new rd("contextmenu",a,d)),d=null,e=!1,a.fire(new rd("mouseup",a,b))}),
pa.addEventListener(c,"mousemove",function(b){if(!a.dragPan.isActive()&&!a.dragRotate.isActive()){for(var d=b.target;d&&d!==c;)d=d.parentNode;d===c&&a.fire(new rd("mousemove",a,b))}}),pa.addEventListener(c,"mouseover",function(b){for(var d=b.target;d&&d!==c;)d=d.parentNode;d===c&&a.fire(new rd("mouseover",a,b))}),pa.addEventListener(c,"touchstart",function(c){var d=new sd("touchstart",a,c);a.fire(d),d.defaultPrevented||(b.interactive&&a.stop(),a.boxZoom.isActive()||a.dragRotate.isActive()||a.dragPan.onTouchStart(c),a.touchZoomRotate.onStart(c),a.doubleClickZoom.onTouchStart(d))},{passive:!1}),pa.addEventListener(c,"touchmove",function(b){a.fire(new sd("touchmove",a,b))},{passive:!1}),pa.addEventListener(c,"touchend",function(b){a.fire(new sd("touchend",a,b))}),pa.addEventListener(c,"touchcancel",function(b){a.fire(new sd("touchcancel",a,b))}),pa.addEventListener(c,"click",function(d){var e=pa.mousePos(c,d);(!f||e.equals(f)||e.dist(f)<b.clickTolerance)&&a.fire(new rd("click",a,d))}),pa.addEventListener(c,"dblclick",function(b){var c=new rd("dblclick",a,b);a.fire(c),c.defaultPrevented||a.doubleClickZoom.onDblClick(c)}),pa.addEventListener(c,"contextmenu",function(b){var c=a.dragRotate.isActive();e||c?e&&(d=b):a.fire(new rd("contextmenu",a,b)),(a.dragRotate.isEnabled()||a.listens("contextmenu"))&&b.preventDefault()}),pa.addEventListener(c,"wheel",function(c){b.interactive&&a.stop();var d=new td("wheel",a,c);a.fire(d),d.defaultPrevented||a.scrollZoom.onWheel(c)},{passive:!1})}(this,c),this._hash=c.hash&&(new qd).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,a.extend({},c.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=c.localIdeographFontFamily,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new Gd({customAttribution:c.customAttribution})),this.addControl(new Hd,c.logoPosition),this.on("style.load",function(){d.transform.unmodified&&d.jumpTo(d.style.stylesheet)}),this.on("data",function(b){d._update("style"===b.dataType),d.fire(new a.Event(b.dataType+"data",b))}),this.on("dataloading",function(b){d.fire(new a.Event(b.dataType+"dataloading",b))})}b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c;var d={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return c.prototype._getMapId=function(){return this._mapId},c.prototype.addControl=function(b,c){if(void 0===c&&b.getDefaultPosition&&(c=b.getDefaultPosition()),void 0===c&&(c="top-right"),!b||!b.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var d=b.onAdd(this);this._controls.push(b);var e=this._controlPositions[c];return-1!==c.indexOf("bottom")?e.insertBefore(d,e.firstChild):e.appendChild(d),this},c.prototype.removeControl=function(b){if(!b||!b.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var c=this._controls.indexOf(b);return c>-1&&this._controls.splice(c,1),b.onRemove(this),this},c.prototype.resize=function(b){var c=this._containerDimensions(),d=c[0],e=c[1];return this._resizeCanvas(d,e),this.transform.resize(d,e),this.painter.resize(d,e),this.fire(new a.Event("movestart",b)).fire(new a.Event("move",b)).fire(new a.Event("resize",b)).fire(new a.Event("moveend",b)),this},c.prototype.getBounds=function(){return this.transform.getBounds()},c.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},c.prototype.setMaxBounds=function(b){return this.transform.setMaxBounds(a.LngLatBounds.convert(b)),this._update()},c.prototype.setMinZoom=function(a){if((a=null==a?0:a)>=0&&a<=this.transform.maxZoom)return this.transform.minZoom=a,this._update(),this.getZoom()<a&&this.setZoom(a),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},c.prototype.getMinZoom=function(){return this.transform.minZoom},c.prototype.setMaxZoom=function(a){if((a=null==a?22:a)>=this.transform.minZoom)return this.transform.maxZoom=a,this._update(),this.getZoom()>a&&this.setZoom(a),this;throw new Error("maxZoom must be greater than the current minZoom")},c.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},c.prototype.setRenderWorldCopies=function(a){return this.transform.renderWorldCopies=a,this._update()},c.prototype.getMaxZoom=function(){return this.transform.maxZoom},c.prototype.project=function(b){return this.transform.locationPoint(a.LngLat.convert(b))},c.prototype.unproject=function(b){return this.transform.pointLocation(a.Point.convert(b))},c.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},c.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isZooming()},c.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},c.prototype.on=function(a,c,d){var e=this;if(void 0===d)return b.prototype.on.call(this,a,c);var f=function(){var b;if("mouseenter"===a||"mouseover"===a){var f=!1;return{layer:c,listener:d,delegates:{mousemove:function(b){var g=e.getLayer(c)?e.queryRenderedFeatures(b.point,{layers:[c]}):[];g.length?f||(f=!0,d.call(e,new rd(a,e,b.originalEvent,{features:g}))):f=!1},mouseout:function(){f=!1}}}}if("mouseleave"===a||"mouseout"===a){var g=!1;return{layer:c,listener:d,delegates:{mousemove:function(b){(e.getLayer(c)?e.queryRenderedFeatures(b.point,{layers:[c]}):[]).length?g=!0:g&&(g=!1,d.call(e,new rd(a,e,b.originalEvent)))},mouseout:function(b){g&&(g=!1,d.call(e,new rd(a,e,b.originalEvent)))}}}}return{layer:c,listener:d,delegates:(b={},b[a]=function(a){var b=e.getLayer(c)?e.queryRenderedFeatures(a.point,{layers:[c]}):[];b.length&&(a.features=b,d.call(e,a),delete a.features)},b)}}();for(var g in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[a]=this._delegatedListeners[a]||[],this._delegatedListeners[a].push(f),f.delegates)this.on(g,f.delegates[g]);return this},c.prototype.off=function(a,c,d){if(void 0===d)return b.prototype.off.call(this,a,c);if(this._delegatedListeners&&this._delegatedListeners[a])for(var e=this._delegatedListeners[a],f=0;f<e.length;f++){var g=e[f];if(g.layer===c&&g.listener===d){for(var h in g.delegates)this.off(h,g.delegates[h]);return e.splice(f,1),this}}return this},c.prototype.queryRenderedFeatures=function(b,c){if(!this.style)return[];var d;if(void 0!==c||void 0===b||b instanceof a.Point||Array.isArray(b)||(c=b,b=void 0),c=c||{},(b=b||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||"number"==typeof b[0])d=[a.Point.convert(b)];else{var e=a.Point.convert(b[0]),f=a.Point.convert(b[1]);d=[e,new a.Point(f.x,e.y),f,new a.Point(e.x,f.y),e]}return this.style.queryRenderedFeatures(d,c,this.transform)},c.prototype.querySourceFeatures=function(a,b){return this.style.querySourceFeatures(a,b)},c.prototype.setStyle=function(b,c){return!1!==(c=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},c)).diff&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(b,c))},c.prototype._updateStyle=function(a,b){return this.style&&(this.style.setEventedParent(null),this.style._remove()),a?(this.style=new kc(this,b||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof a?this.style.loadURL(a):this.style.loadJSON(a),this):(delete this.style,this)},c.prototype._diffStyle=function(b,c){var d=this;if("string"==typeof b){var e=this._requestManager.normalizeStyleURL(b),f=this._requestManager.transformRequest(e,a.ResourceType.Style);a.getJSON(f,function(b,e){b?d.fire(new a.ErrorEvent(b)):e&&d._updateDiff(e,c)})}else"object"==typeof b&&this._updateDiff(b,c)},c.prototype._updateDiff=function(b,c){try{this.style.setState(b)&&this._update(!0)}catch(d){a.warnOnce("Unable to perform style diff: "+(d.message||d.error||d)+".  Rebuilding the style from scratch."),this._updateStyle(b,c)}},c.prototype.getStyle=function(){if(this.style)return this.style.serialize()},c.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},c.prototype.addSource=function(a,b){return this.style.addSource(a,b),this._update(!0)},c.prototype.isSourceLoaded=function(b){var c=this.style&&this.style.sourceCaches[b];if(void 0!==c)return c.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+b+"'")))},c.prototype.areTilesLoaded=function(){var a=this.style&&this.style.sourceCaches;for(var b in a){var c=a[b]._tiles;for(var d in c){var e=c[d];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0},c.prototype.addSourceType=function(a,b,c){return this.style.addSourceType(a,b,c)},c.prototype.removeSource=function(a){return this.style.removeSource(a),this._update(!0)},c.prototype.getSource=function(a){return this.style.getSource(a)},c.prototype.addImage=function(b,c,d){void 0===d&&(d={});var e=d.pixelRatio;void 0===e&&(e=1);var f=d.sdf;if(void 0===f&&(f=!1),c instanceof Jd){var g=a.browser.getImageData(c),h=g.width,i=g.height,j=g.data;this.style.addImage(b,{data:new a.RGBAImage({width:h,height:i},j),pixelRatio:e,sdf:f,version:0})}else{if(void 0===c.width||void 0===c.height)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var k=c.width,l=c.height,m=c.data,n=c;this.style.addImage(b,{data:new a.RGBAImage({width:k,height:l},new Uint8Array(m)),pixelRatio:e,sdf:f,version:0,userImage:n}),n.onAdd&&n.onAdd(this,b)}},c.prototype.updateImage=function(b,c){var d=this.style.getImage(b);if(!d)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var e=c instanceof Jd?a.browser.getImageData(c):c,f=e.width,g=e.height,h=e.data;if(void 0===f||void 0===g)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==d.data.width||g!==d.data.height)return this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var i=!(c instanceof Jd);d.data.replace(h,i),this.style.updateImage(b,d)},c.prototype.hasImage=function(b){return b?!!this.style.getImage(b):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},c.prototype.removeImage=function(a){this.style.removeImage(a)},c.prototype.loadImage=function(b,c){a.getImage(this._requestManager.transformRequest(b,a.ResourceType.Image),c)},c.prototype.listImages=function(){return this.style.listImages()},c.prototype.addLayer=function(a,b){return this.style.addLayer(a,b),this._update(!0)},c.prototype.moveLayer=function(a,b){return this.style.moveLayer(a,b),this._update(!0)},c.prototype.removeLayer=function(a){return this.style.removeLayer(a),this._update(!0)},c.prototype.getLayer=function(a){return this.style.getLayer(a)},c.prototype.setFilter=function(a,b,c){return void 0===c&&(c={}),this.style.setFilter(a,b,c),this._update(!0)},c.prototype.setLayerZoomRange=function(a,b,c){return this.style.setLayerZoomRange(a,b,c),this._update(!0)},c.prototype.getFilter=function(a){return this.style.getFilter(a)},c.prototype.setPaintProperty=function(a,b,c,d){return void 0===d&&(d={}),this.style.setPaintProperty(a,b,c,d),this._update(!0)},c.prototype.getPaintProperty=function(a,b){return this.style.getPaintProperty(a,b)},c.prototype.setLayoutProperty=function(a,b,c,d){return void 0===d&&(d={}),this.style.setLayoutProperty(a,b,c,d),this._update(!0)},c.prototype.getLayoutProperty=function(a,b){return this.style.getLayoutProperty(a,b)},c.prototype.setLight=function(a,b){return void 0===b&&(b={}),this.style.setLight(a,b),this._update(!0)},c.prototype.getLight=function(){return this.style.getLight()},c.prototype.setFeatureState=function(a,b){return this.style.setFeatureState(a,b),this._update()},c.prototype.removeFeatureState=function(a,b){return this.style.removeFeatureState(a,b),this._update()},c.prototype.getFeatureState=function(a){return this.style.getFeatureState(a)},c.prototype.getContainer=function(){return this._container},c.prototype.getCanvasContainer=function(){return this._canvasContainer},c.prototype.getCanvas=function(){return this._canvas},c.prototype._containerDimensions=function(){var a=0,b=0;return this._container&&(a=this._container.clientWidth||400,b=this._container.clientHeight||300),[a,b]},c.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},c.prototype._setupContainer=function(){var a=this._container;a.classList.add("mapboxgl-map"),(this._missingCSSCanary=pa.create("div","mapboxgl-canary",a)).style.visibility="hidden",this._detectMissingCSS();var b=this._canvasContainer=pa.create("div","mapboxgl-canvas-container",a);this._interactive&&b.classList.add("mapboxgl-interactive"),this._canvas=pa.create("canvas","mapboxgl-canvas",b),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var c=this._containerDimensions();this._resizeCanvas(c[0],c[1]);var d=this._controlContainer=pa.create("div","mapboxgl-control-container",a),e=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(a){e[a]=pa.create("div","mapboxgl-ctrl-"+a,d)})},c.prototype._resizeCanvas=function(b,c){var d=a.window.devicePixelRatio||1;this._canvas.width=d*b,this._canvas.height=d*c,this._canvas.style.width=b+"px",this._canvas.style.height=c+"px"},c.prototype._setupPainter=function(){var b=a.extend({},oa.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl",b)||this._canvas.getContext("experimental-webgl",b);c?(this.painter=new nd(c,this.transform),a.webpSupported.testSupport(c)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},c.prototype._contextLost=function(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:b}))},c.prototype._contextRestored=function(b){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:b}))},c.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},c.prototype._update=function(a){return this.style?(this._styleDirty=this._styleDirty||a,this._sourcesDirty=!0,this.triggerRepaint(),this):this},c.prototype._requestRenderFrame=function(a){return this._update(),this._renderTaskQueue.add(a)},c.prototype._cancelRenderFrame=function(a){this._renderTaskQueue.remove(a)},c.prototype._render=function(){this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run();var b=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var c=this.transform.zoom,d=a.browser.now();this.style.zoomHistory.update(c,d);var e=new a.EvaluationParameters(c,{now:d,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),f=e.crossFadingFactor();1===f&&f===this._crossFadingFactor||(b=!0,this._crossFadingFactor=f),this.style.update(e)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||b)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),this},c.prototype.remove=function(){this._hash&&this._hash.remove();for(var b=0,c=this._controls;b<c.length;b+=1)c[b].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.setStyle(null),void 0!==a.window&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),ia(this._canvasContainer),ia(this._controlContainer),ia(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new a.Event("remove"))},c.prototype.triggerRepaint=function(){var b=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(){b._frame=null,b._render()}))},c.prototype._onWindowOnline=function(){this._update()},c.prototype._onWindowResize=function(){this._trackResize&&this.resize()._update()},d.showTileBoundaries.get=function(){return!!this._showTileBoundaries},d.showTileBoundaries.set=function(a){this._showTileBoundaries!==a&&(this._showTileBoundaries=a,this._update())},d.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},d.showCollisionBoxes.set=function(a){this._showCollisionBoxes!==a&&(this._showCollisionBoxes=a,a?this.style._generateCollisionBoxes():this._update())},d.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},d.showOverdrawInspector.set=function(a){this._showOverdrawInspector!==a&&(this._showOverdrawInspector=a,this._update())},d.repaint.get=function(){return!!this._repaint},d.repaint.set=function(a){this._repaint!==a&&(this._repaint=a,this.triggerRepaint())},d.vertices.get=function(){return!!this._vertices},d.vertices.set=function(a){this._vertices=a,this._update()},c.prototype._setCacheLimits=function(b,c){a.setCacheLimits(b,c)},d.version.get=function(){return a.version},Object.defineProperties(c.prototype,d),c}(Fd),Nd={showCompass:!0,showZoom:!0,visualizePitch:!1},Od=function(b){var c=this;this.options=a.extend({},Nd,b),this._container=pa.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this.options.showZoom&&(a.bindAll(["_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom in",function(){return c._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom out",function(){return c._map.zoomOut()})),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset bearing to north",function(){c.options.visualizePitch?c._map.resetNorthPitch():c._map.resetNorth()}),this._compassArrow=pa.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};Od.prototype._updateZoomButtons=function(){var a=this._map.getZoom();a===this._map.getMaxZoom()?this._zoomInButton.classList.add("mapboxgl-ctrl-icon-disabled"):this._zoomInButton.classList.remove("mapboxgl-ctrl-icon-disabled"),a===this._map.getMinZoom()?this._zoomOutButton.classList.add("mapboxgl-ctrl-icon-disabled"):this._zoomOutButton.classList.remove("mapboxgl-ctrl-icon-disabled")},Od.prototype._rotateCompassArrow=function(){var a=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=a},Od.prototype.onAdd=function(a){return this._map=a,this.options.showZoom&&(this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new xd(a,{button:"left",element:this._compass}),pa.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),pa.addEventListener(this._compass,"touchstart",this._handler.onMouseDown,{passive:!1}),this._handler.enable()),this._container},Od.prototype.onRemove=function(){pa.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),pa.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),pa.removeEventListener(this._compass,"touchstart",this._handler.onMouseDown,{passive:!1}),this._handler.disable(),delete this._handler),delete this._map},Od.prototype._createButton=function(a,b,c){var d=pa.create("button",a,this._container);return d.type="button",d.title=b,d.setAttribute("aria-label",b),d.addEventListener("click",c),d};var Pd,Qd={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Rd=function(b){function c(c,d){if(b.call(this),(c instanceof a.window.HTMLElement||d)&&(c=a.extend({element:c},d)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._draggable=c&&c.draggable||!1,this._state="inactive",c&&c.element)this._element=c.element,this._offset=a.Point.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=pa.create("div");var e=pa.createNS("http://www.w3.org/2000/svg","svg");e.setAttributeNS(null,"display","block"),e.setAttributeNS(null,"height","41px"),e.setAttributeNS(null,"width","27px"),e.setAttributeNS(null,"viewBox","0 0 27 41");var f=pa.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"stroke","none"),f.setAttributeNS(null,"stroke-width","1"),f.setAttributeNS(null,"fill","none"),f.setAttributeNS(null,"fill-rule","evenodd");var g=pa.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"fill-rule","nonzero");var h=pa.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"transform","translate(3.0, 29.0)"),h.setAttributeNS(null,"fill","#000000");for(var i=0,j=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];i<j.length;i+=1){var k=j[i],l=pa.createNS("http://www.w3.org/2000/svg","ellipse");l.setAttributeNS(null,"opacity","0.04"),l.setAttributeNS(null,"cx","10.5"),l.setAttributeNS(null,"cy","5.80029008"),l.setAttributeNS(null,"rx",k.rx),l.setAttributeNS(null,"ry",k.ry),h.appendChild(l)}var m=pa.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"fill",this._color);var n=pa.createNS("http://www.w3.org/2000/svg","path");n.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),m.appendChild(n);var o=pa.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"opacity","0.25"),o.setAttributeNS(null,"fill","#000000");var p=pa.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),o.appendChild(p);var q=pa.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),q.setAttributeNS(null,"fill","#FFFFFF");var r=pa.createNS("http://www.w3.org/2000/svg","g");r.setAttributeNS(null,"transform","translate(8.0, 8.0)");var s=pa.createNS("http://www.w3.org/2000/svg","circle");s.setAttributeNS(null,"fill","#000000"),s.setAttributeNS(null,"opacity","0.25"),s.setAttributeNS(null,"cx","5.5"),s.setAttributeNS(null,"cy","5.5"),s.setAttributeNS(null,"r","5.4999962");var t=pa.createNS("http://www.w3.org/2000/svg","circle");t.setAttributeNS(null,"fill","#FFFFFF"),t.setAttributeNS(null,"cx","5.5"),t.setAttributeNS(null,"cy","5.5"),t.setAttributeNS(null,"r","5.4999962"),r.appendChild(s),r.appendChild(t),g.appendChild(h),g.appendChild(m),g.appendChild(o),g.appendChild(q),g.appendChild(r),e.appendChild(g),this._element.appendChild(e),this._offset=a.Point.convert(c&&c.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(a){a.preventDefault()}),ka(this._element,this._anchor,"marker"),this._popup=null}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.addTo=function(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},c.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),pa.remove(this._element),this._popup&&this._popup.remove(),this},c.prototype.getLngLat=function(){return this._lngLat},c.prototype.setLngLat=function(b){return this._lngLat=a.LngLat.convert(b),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},c.prototype.getElement=function(){return this._element},c.prototype.setPopup=function(a){if(this._popup&&(this._popup.remove(),this._popup=null),a){if(!("offset"in a.options)){var b=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(24.6+b)],"bottom-right":[-b,-1*(24.6+b)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},c.prototype._onMapClick=function(a){var b=a.originalEvent.target,c=this._element;this._popup&&(b===c||c.contains(b))&&this.togglePopup()},c.prototype.getPopup=function(){return this._popup},c.prototype.togglePopup=function(){var a=this._popup;return a?(a.isOpen()?a.remove():a.addTo(this._map),this):this},c.prototype._update=function(a){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=ja(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),a&&"moveend"!==a.type||(this._pos=this._pos.round()),pa.setTransform(this._element,Qd[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"))},c.prototype.getOffset=function(){return this._offset},c.prototype.setOffset=function(b){return this._offset=a.Point.convert(b),this._update(),this},c.prototype._onMove=function(b){this._pos=b.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))},c.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new a.Event("dragend")),this._state="inactive"},c.prototype._addDragHandler=function(a){this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},c.prototype.setDraggable=function(a){return this._draggable=!!a,this._map&&(a?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},c.prototype.isDraggable=function(){return this._draggable},c}(a.Evented),Sd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},Td=function(b){function c(c){b.call(this),this.options=a.extend({},Sd,c),a.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.onAdd=function(b){var c;return this._map=b,this._container=pa.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,void 0!==Pd?c(Pd):void 0!==a.window.navigator.permissions?a.window.navigator.permissions.query({name:"geolocation"}).then(function(a){Pd="denied"!==a.state,c(Pd)}):(Pd=!!a.window.navigator.geolocation,c(Pd)),this._container},c.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),pa.remove(this._container),this._map=void 0},c.prototype._onSuccess=function(b){if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}
this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(b),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(b),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",b)),this._finish()},c.prototype._updateCamera=function(b){var c=new a.LngLat(b.coords.longitude,b.coords.latitude),d=b.coords.accuracy,e=this._map.getBearing(),f=a.extend({bearing:e},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(d),f,{geolocateSource:!0})},c.prototype._updateMarker=function(a){a?this._userLocationDotMarker.setLngLat([a.coords.longitude,a.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},c.prototype._onError=function(b){if(this.options.trackUserLocation)if(1===b.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",b)),this._finish()},c.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},c.prototype._setupUI=function(b){var c=this;!1!==b?(this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this._geolocateButton=pa.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=pa.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Rd(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(b){b.geolocateSource||"ACTIVE_LOCK"!==c._watchState||(c._watchState="BACKGROUND",c._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),c._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),c.fire(new a.Event("trackuserlocationend")))})):a.warnOnce("Geolocation support is not available, the GeolocateControl will not be visible.")},c.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},c.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},c}(a.Evented),Ud={maxWidth:100,unit:"metric"},Vd=function(b){this.options=a.extend({},Ud,b),a.bindAll(["_onMove","setUnit"],this)};Vd.prototype.getDefaultPosition=function(){return"bottom-left"},Vd.prototype._onMove=function(){la(this._map,this._container,this.options)},Vd.prototype.onAdd=function(a){return this._map=a,this._container=pa.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",a.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Vd.prototype.onRemove=function(){pa.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Vd.prototype.setUnit=function(a){this.options.unit=a,la(this._map,this._container,this.options)};var Wd=function(b){this._fullscreen=!1,b&&b.container&&(b.container instanceof a.window.HTMLElement?this._container=b.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};Wd.prototype.onAdd=function(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=pa.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Wd.prototype.onRemove=function(){pa.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Wd.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},Wd.prototype._setupUI=function(){(this._fullscreenButton=pa.create("button",this._className+"-icon "+this._className+"-fullscreen",this._controlContainer)).type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Wd.prototype._updateTitle=function(){var a=this._isFullscreen()?"Exit fullscreen":"Enter fullscreen";this._fullscreenButton.setAttribute("aria-label",a),this._fullscreenButton.title=a},Wd.prototype._isFullscreen=function(){return this._fullscreen},Wd.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"),this._updateTitle())},Wd.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Xd={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Yd=function(b){function c(c){b.call(this),this.options=a.extend(Object.create(Xd),c),a.bindAll(["_update","_onClickClose","remove"],this)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.addTo=function(b){var c=this;return this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",function(a){c._update(a.point)}),this._map.on("mouseup",function(a){c._update(a.point)}),this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},c.prototype.isOpen=function(){return!!this._map},c.prototype.remove=function(){return this._content&&pa.remove(this._content),this._container&&(pa.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),this._map.off("remove",this.remove),this._map.off("mousemove"),delete this._map),this.fire(new a.Event("close")),this},c.prototype.getLngLat=function(){return this._lngLat},c.prototype.setLngLat=function(b){return this._lngLat=a.LngLat.convert(b),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove"),this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},c.prototype.trackPointer=function(){var a=this;return this._trackPointer=!0,this._pos=null,this._map&&(this._map.off("move",this._update),this._map.on("mousemove",function(b){a._update(b.point)}),this._map.on("drag",function(b){a._update(b.point)}),this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},c.prototype.getElement=function(){return this._container},c.prototype.setText=function(b){return this.setDOMContent(a.window.document.createTextNode(b))},c.prototype.setHTML=function(b){var c,d=a.window.document.createDocumentFragment(),e=a.window.document.createElement("body");for(e.innerHTML=b;c=e.firstChild;)d.appendChild(c);return this.setDOMContent(d)},c.prototype.getMaxWidth=function(){return this._container.style.maxWidth},c.prototype.setMaxWidth=function(a){return this.options.maxWidth=a,this._update(),this},c.prototype.setDOMContent=function(a){return this._createContent(),this._content.appendChild(a),this._update(),this},c.prototype._createContent=function(){this._content&&pa.remove(this._content),this._content=pa.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=pa.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},c.prototype._update=function(b){var c=this,d=this._lngLat||this._trackPointer;if(this._map&&d&&this._content&&(this._container||(this._container=pa.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=pa.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(a){return c._container.classList.add(a)})),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ja(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||b)){var e=this._pos=this._trackPointer&&b?b:this._map.project(this._lngLat),f=this.options.anchor,g=function b(c){if(c){if("number"==typeof c){var d=Math.round(Math.sqrt(.5*Math.pow(c,2)));return{center:new a.Point(0,0),top:new a.Point(0,c),"top-left":new a.Point(d,d),"top-right":new a.Point(-d,d),bottom:new a.Point(0,-c),"bottom-left":new a.Point(d,-d),"bottom-right":new a.Point(-d,-d),left:new a.Point(c,0),right:new a.Point(-c,0)}}if(c instanceof a.Point||Array.isArray(c)){var e=a.Point.convert(c);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:a.Point.convert(c.center||[0,0]),top:a.Point.convert(c.top||[0,0]),"top-left":a.Point.convert(c["top-left"]||[0,0]),"top-right":a.Point.convert(c["top-right"]||[0,0]),bottom:a.Point.convert(c.bottom||[0,0]),"bottom-left":a.Point.convert(c["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(c["bottom-right"]||[0,0]),left:a.Point.convert(c.left||[0,0]),right:a.Point.convert(c.right||[0,0])}}return b(new a.Point(0,0))}(this.options.offset);if(!f){var h,i=this._container.offsetWidth,j=this._container.offsetHeight;h=e.y+g.bottom.y<j?["top"]:e.y>this._map.transform.height-j?["bottom"]:[],e.x<i/2?h.push("left"):e.x>this._map.transform.width-i/2&&h.push("right"),f=0===h.length?"bottom":h.join("-")}var k=e.add(g[f]).round();pa.setTransform(this._container,Qd[f]+" translate("+k.x+"px,"+k.y+"px)"),ka(this._container,f,"popup")}},c.prototype._onClickClose=function(){this.remove()},c}(a.Evented),Zd={version:a.version,supported:oa,setRTLTextPlugin:a.setRTLTextPlugin,Map:Md,NavigationControl:Od,GeolocateControl:Td,AttributionControl:Gd,ScaleControl:Vd,FullscreenControl:Wd,Popup:Yd,Marker:Rd,Style:kc,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(b){a.config.ACCESS_TOKEN=b},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(b){a.config.API_URL=b},get workerCount(){return Ib.workerCount},set workerCount(a){Ib.workerCount=a},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(b){a.config.MAX_PARALLEL_IMAGE_REQUESTS=b},clearStorage:function(b){a.clearTileCache(b)},workerUrl:""};return Zd}),d},"object"==typeof c&&void 0!==b?b.exports=e():(d=d||self).mapboxgl=e()},{}],428:[function(a,b,c){"use strict";function d(a,b,c){for(var d=new Array(a),e=0;e<a;++e)d[e]=0,e===b&&(d[e]+=.5),e===c&&(d[e]+=.5);return d}function e(a,b){if(0===b||b===(1<<a+1)-1)return[];for(var c=[],e=[],g=0;g<=a;++g)if(b&1<<g){c.push(d(a,g-1,g-1)),e.push(null);for(var h=0;h<=a;++h)~b&1<<h&&(c.push(d(a,g-1,h-1)),e.push([g,h]))}var i=f(c),j=[];a:for(g=0;g<i.length;++g){var k=i[g],l=[];for(h=0;h<k.length;++h){if(!e[k[h]])continue a;l.push(e[k[h]].slice())}j.push(l)}return j}b.exports=function(a){for(var b=1<<a+1,c=new Array(b),d=0;d<b;++d)c[d]=e(a,d);return c};var f=a("convex-hull")},{"convex-hull":131}],429:[function(a,b,c){function d(a,b,c,d,e){a[0]=b[0]*d+c[0]*e,a[1]=b[1]*d+c[1]*e,a[2]=b[2]*d+c[2]*e}var e=a("./normalize"),f=a("gl-mat4/create"),g=a("gl-mat4/clone"),h=a("gl-mat4/determinant"),i=a("gl-mat4/invert"),j=a("gl-mat4/transpose"),k={length:a("gl-vec3/length"),normalize:a("gl-vec3/normalize"),dot:a("gl-vec3/dot"),cross:a("gl-vec3/cross")},l=f(),m=f(),n=[0,0,0,0],o=[[0,0,0],[0,0,0],[0,0,0]],p=[0,0,0];b.exports=function(a,b,c,f,q,r){if(b||(b=[0,0,0]),c||(c=[0,0,0]),f||(f=[0,0,0]),q||(q=[0,0,0,1]),r||(r=[0,0,0,1]),!e(l,a))return!1;if(g(m,l),m[3]=0,m[7]=0,m[11]=0,m[15]=1,Math.abs(h(m)<1e-8))return!1;var s,t,u,v,w,x,y,z=l[3],A=l[7],B=l[11],C=l[12],D=l[13],E=l[14],F=l[15];if(0!==z||0!==A||0!==B){if(n[0]=z,n[1]=A,n[2]=B,n[3]=F,!i(m,m))return!1;j(m,m),s=q,u=m,v=(t=n)[0],w=t[1],x=t[2],y=t[3],s[0]=u[0]*v+u[4]*w+u[8]*x+u[12]*y,s[1]=u[1]*v+u[5]*w+u[9]*x+u[13]*y,s[2]=u[2]*v+u[6]*w+u[10]*x+u[14]*y,s[3]=u[3]*v+u[7]*w+u[11]*x+u[15]*y}else q[0]=q[1]=q[2]=0,q[3]=1;if(b[0]=C,b[1]=D,b[2]=E,function(a,b){a[0][0]=b[0],a[0][1]=b[1],a[0][2]=b[2],a[1][0]=b[4],a[1][1]=b[5],a[1][2]=b[6],a[2][0]=b[8],a[2][1]=b[9],a[2][2]=b[10]}(o,l),c[0]=k.length(o[0]),k.normalize(o[0],o[0]),f[0]=k.dot(o[0],o[1]),d(o[1],o[1],o[0],1,-f[0]),c[1]=k.length(o[1]),k.normalize(o[1],o[1]),f[0]/=c[1],f[1]=k.dot(o[0],o[2]),d(o[2],o[2],o[0],1,-f[1]),f[2]=k.dot(o[1],o[2]),d(o[2],o[2],o[1],1,-f[2]),c[2]=k.length(o[2]),k.normalize(o[2],o[2]),f[1]/=c[2],f[2]/=c[2],k.cross(p,o[1],o[2]),k.dot(o[0],p)<0)for(var G=0;G<3;G++)c[G]*=-1,o[G][0]*=-1,o[G][1]*=-1,o[G][2]*=-1;return r[0]=.5*Math.sqrt(Math.max(1+o[0][0]-o[1][1]-o[2][2],0)),r[1]=.5*Math.sqrt(Math.max(1-o[0][0]+o[1][1]-o[2][2],0)),r[2]=.5*Math.sqrt(Math.max(1-o[0][0]-o[1][1]+o[2][2],0)),r[3]=.5*Math.sqrt(Math.max(1+o[0][0]+o[1][1]+o[2][2],0)),o[2][1]>o[1][2]&&(r[0]=-r[0]),o[0][2]>o[2][0]&&(r[1]=-r[1]),o[1][0]>o[0][1]&&(r[2]=-r[2]),!0}},{"./normalize":430,"gl-mat4/clone":260,"gl-mat4/create":261,"gl-mat4/determinant":262,"gl-mat4/invert":266,"gl-mat4/transpose":277,"gl-vec3/cross":335,"gl-vec3/dot":340,"gl-vec3/length":350,"gl-vec3/normalize":357}],430:[function(a,b,c){b.exports=function(a,b){var c=b[15];if(0===c)return!1;for(var d=1/c,e=0;e<16;e++)a[e]=b[e]*d;return!0}},{}],431:[function(a,b,c){function d(){return{translate:e(),scale:e(1),skew:e(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function e(a){return[a||0,a||0,a||0]}var f=a("gl-vec3/lerp"),g=a("mat4-recompose"),h=a("mat4-decompose"),i=a("gl-mat4/determinant"),j=a("quat-slerp"),k=d(),l=d(),m=d();b.exports=function(a,b,c,d){if(0===i(b)||0===i(c))return!1;var e=h(b,k.translate,k.scale,k.skew,k.perspective,k.quaternion),n=h(c,l.translate,l.scale,l.skew,l.perspective,l.quaternion);return!(!e||!n||(f(m.translate,k.translate,l.translate,d),f(m.skew,k.skew,l.skew,d),f(m.scale,k.scale,l.scale,d),f(m.perspective,k.perspective,l.perspective,d),j(m.quaternion,k.quaternion,l.quaternion,d),g(a,m.translate,m.scale,m.skew,m.perspective,m.quaternion),0))}},{"gl-mat4/determinant":262,"gl-vec3/lerp":351,"mat4-decompose":429,"mat4-recompose":432,"quat-slerp":484}],432:[function(a,b,c){var d={identity:a("gl-mat4/identity"),translate:a("gl-mat4/translate"),multiply:a("gl-mat4/multiply"),create:a("gl-mat4/create"),scale:a("gl-mat4/scale"),fromRotationTranslation:a("gl-mat4/fromRotationTranslation")},e=(d.create(),d.create());b.exports=function(a,b,c,f,g,h){return d.identity(a),d.fromRotationTranslation(a,h,b),a[3]=g[0],a[7]=g[1],a[11]=g[2],a[15]=g[3],d.identity(e),0!==f[2]&&(e[9]=f[2],d.multiply(a,a,e)),0!==f[1]&&(e[9]=0,e[8]=f[1],d.multiply(a,a,e)),0!==f[0]&&(e[8]=0,e[4]=f[0],d.multiply(a,a,e)),d.scale(a,a,c),a}},{"gl-mat4/create":261,"gl-mat4/fromRotationTranslation":264,"gl-mat4/identity":265,"gl-mat4/multiply":268,"gl-mat4/scale":275,"gl-mat4/translate":276}],433:[function(a,b,c){"use strict";b.exports=Math.log2||function(a){return Math.log(a)*Math.LOG2E}},{}],434:[function(a,b,c){"use strict";function d(a){this._components=a.slice(),this._time=[0],this.prevMatrix=a.slice(),this.nextMatrix=a.slice(),this.computedMatrix=a.slice(),this.computedInverse=a.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}var e=a("binary-search-bounds"),f=a("mat4-interpolate"),g=a("gl-mat4/invert"),h=a("gl-mat4/rotateX"),i=a("gl-mat4/rotateY"),j=a("gl-mat4/rotateZ"),k=a("gl-mat4/lookAt"),l=a("gl-mat4/translate"),m=(a("gl-mat4/scale"),a("gl-vec3/normalize")),n=[0,0,0];b.exports=function(a){return new d((a=a||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var o=d.prototype;o.recalcMatrix=function(a){var b=this._time,c=e.le(b,a),d=this.computedMatrix;if(!(c<0)){var h=this._components;if(c===b.length-1)for(var i=16*c,j=0;j<16;++j)d[j]=h[i++];else{var k=b[c+1]-b[c],l=(i=16*c,this.prevMatrix),n=!0;for(j=0;j<16;++j)l[j]=h[i++];var o=this.nextMatrix;for(j=0;j<16;++j)o[j]=h[i++],n=n&&l[j]===o[j];if(k<1e-6||n)for(j=0;j<16;++j)d[j]=l[j];else f(d,l,o,(a-b[c])/k)}var p=this.computedUp;p[0]=d[1],p[1]=d[5],p[2]=d[9],m(p,p);var q=this.computedInverse;g(q,d);var r=this.computedEye,s=q[15];r[0]=q[12]/s,r[1]=q[13]/s,r[2]=q[14]/s;var t=this.computedCenter,u=Math.exp(this.computedRadius[0]);for(j=0;j<3;++j)t[j]=r[j]-d[2+4*j]*u}},o.idle=function(a){if(!(a<this.lastT())){for(var b=this._components,c=b.length-16,d=0;d<16;++d)b.push(b[c++]);this._time.push(a)}},o.flush=function(a){var b=e.gt(this._time,a)-2;b<0||(this._time.splice(0,b),this._components.splice(0,16*b))},o.lastT=function(){return this._time[this._time.length-1]},o.lookAt=function(a,b,c,d){this.recalcMatrix(a),b=b||this.computedEye,c=c||n,d=d||this.computedUp,this.setMatrix(a,k(this.computedMatrix,b,c,d));for(var e=0,f=0;f<3;++f)e+=Math.pow(c[f]-b[f],2);e=Math.log(Math.sqrt(e)),this.computedRadius[0]=e},o.rotate=function(a,b,c,d){this.recalcMatrix(a);var e=this.computedInverse;b&&i(e,e,b),c&&h(e,e,c),d&&j(e,e,d),this.setMatrix(a,g(this.computedMatrix,e))};var p=[0,0,0];o.pan=function(a,b,c,d){p[0]=-(b||0),p[1]=-(c||0),p[2]=-(d||0),this.recalcMatrix(a);var e=this.computedInverse;l(e,e,p),this.setMatrix(a,g(e,e))},o.translate=function(a,b,c,d){p[0]=b||0,p[1]=c||0,p[2]=d||0,this.recalcMatrix(a);var e=this.computedMatrix;l(e,e,p),this.setMatrix(a,e)},o.setMatrix=function(a,b){if(!(a<this.lastT())){this._time.push(a);for(var c=0;c<16;++c)this._components.push(b[c])}},o.setDistance=function(a,b){this.computedRadius[0]=b},o.setDistanceLimits=function(a,b){var c=this._limits;c[0]=a,c[1]=b},o.getDistanceLimits=function(a){var b=this._limits;return a?(a[0]=b[0],a[1]=b[1],a):b}},{"binary-search-bounds":92,"gl-mat4/invert":266,"gl-mat4/lookAt":267,"gl-mat4/rotateX":272,"gl-mat4/rotateY":273,"gl-mat4/rotateZ":274,"gl-mat4/scale":275,"gl-mat4/translate":276,"gl-vec3/normalize":357,"mat4-interpolate":431}],435:[function(a,b,c){"use strict";b.exports=function(a){var b=a.length;if(b<3){for(var c=new Array(b),e=0;e<b;++e)c[e]=e;return 2===b&&a[0][0]===a[1][0]&&a[0][1]===a[1][1]?[0]:c}for(var f=new Array(b),e=0;e<b;++e)f[e]=e;f.sort(function(b,c){return a[b][0]-a[c][0]||a[b][1]-a[c][1]});for(var g=[f[0],f[1]],h=[f[0],f[1]],e=2;e<b;++e){for(var i=f[e],j=a[i],k=g.length;k>1&&d(a[g[k-2]],a[g[k-1]],j)<=0;)k-=1,g.pop();for(g.push(i),k=h.length;k>1&&d(a[h[k-2]],a[h[k-1]],j)>=0;)k-=1,h.pop();h.push(i)}for(var c=new Array(h.length+g.length-2),l=0,e=0,m=g.length;e<m;++e)c[l++]=g[e];for(var n=h.length-2;n>0;--n)c[l++]=h[n];return c};var d=a("robust-orientation")[3]},{"robust-orientation":511}],436:[function(a,b,c){"use strict";b.exports=function(a,b){function c(a){var b=!1;return"altKey"in a&&(b=b||a.altKey!==p.alt,p.alt=!!a.altKey),"shiftKey"in a&&(b=b||a.shiftKey!==p.shift,p.shift=!!a.shiftKey),"ctrlKey"in a&&(b=b||a.ctrlKey!==p.control,p.control=!!a.ctrlKey),"metaKey"in a&&(b=b||a.metaKey!==p.meta,p.meta=!!a.metaKey),b}function e(a,e){var f=d.x(e),g=d.y(e);"buttons"in e&&(a=0|e.buttons),(a!==m||f!==n||g!==o||c(e))&&(m=0|a,n=f||0,o=g||0,b&&b(m,n,o,p))}function f(a){e(0,a)}function g(){(m||n||o||p.shift||p.alt||p.meta||p.control)&&(n=o=0,m=0,p.shift=p.alt=p.control=p.meta=!1,b&&b(0,0,0,p))}function h(a){c(a)&&b&&b(m,n,o,p)}function i(a){0===d.buttons(a)?e(0,a):e(m,a)}function j(a){e(m|d.buttons(a),a)}function k(a){e(m&~d.buttons(a),a)}function l(){q||(q=!0,a.addEventListener("mousemove",i),a.addEventListener("mousedown",j),a.addEventListener("mouseup",k),a.addEventListener("mouseleave",f),a.addEventListener("mouseenter",f),a.addEventListener("mouseout",f),a.addEventListener("mouseover",f),a.addEventListener("blur",g),a.addEventListener("keyup",h),a.addEventListener("keydown",h),a.addEventListener("keypress",h),a!==window&&(window.addEventListener("blur",g),window.addEventListener("keyup",h),window.addEventListener("keydown",h),window.addEventListener("keypress",h)))}b||(b=a,a=window);var m=0,n=0,o=0,p={shift:!1,alt:!1,control:!1,meta:!1},q=!1;l();var r={element:a};return Object.defineProperties(r,{enabled:{get:function(){return q},set:function(b){b?l():q&&(q=!1,a.removeEventListener("mousemove",i),a.removeEventListener("mousedown",j),a.removeEventListener("mouseup",k),a.removeEventListener("mouseleave",f),a.removeEventListener("mouseenter",f),a.removeEventListener("mouseout",f),a.removeEventListener("mouseover",f),a.removeEventListener("blur",g),a.removeEventListener("keyup",h),a.removeEventListener("keydown",h),a.removeEventListener("keypress",h),a!==window&&(window.removeEventListener("blur",g),window.removeEventListener("keyup",h),window.removeEventListener("keydown",h),window.removeEventListener("keypress",h)))},enumerable:!0},buttons:{get:function(){return m},enumerable:!0},x:{get:function(){return n},enumerable:!0},y:{get:function(){return o},enumerable:!0},mods:{get:function(){return p},enumerable:!0}}),r};var d=a("mouse-event")},{"mouse-event":438}],437:[function(a,b,c){var d={left:0,top:0};b.exports=function(a,b,c){b=b||a.currentTarget||a.srcElement,Array.isArray(c)||(c=[0,0]);var e,f=a.clientX||0,g=a.clientY||0,h=(e=b,e===window||e===document||e===document.body?d:e.getBoundingClientRect());return c[0]=f-h.left,c[1]=g-h.top,c}},{}],438:[function(a,b,c){"use strict";function d(a){return a.target||a.srcElement||window}c.buttons=function(a){if("object"==typeof a){if("buttons"in a)return a.buttons;if("which"in a){if(2===(b=a.which))return 4;if(3===b)return 2;if(b>0)return 1<<b-1}else if("button"in a){var b;if(1===(b=a.button))return 4;if(2===b)return 2;if(b>=0)return 1<<b}}return 0},c.element=d,c.x=function(a){if("object"==typeof a){if("offsetX"in a)return a.offsetX;var b=d(a).getBoundingClientRect();return a.clientX-b.left}return 0},c.y=function(a){if("object"==typeof a){if("offsetY"in a)return a.offsetY;var b=d(a).getBoundingClientRect();return a.clientY-b.top}return 0}},{}],439:[function(a,b,c){"use strict";var d=a("to-px");b.exports=function(a,b,c){"function"==typeof a&&(c=!!b,b=a,a=window);var e=d("ex",a),f=function(a){c&&a.preventDefault();var d=a.deltaX||0,f=a.deltaY||0,g=a.deltaZ||0,h=a.deltaMode,i=1;switch(h){case 1:i=e;break;case 2:i=window.innerHeight}if(f*=i,g*=i,(d*=i)||f||g)return b(d,f,g,a)};return a.addEventListener("wheel",f),f}},{"to-px":540}],440:[function(a,b,c){"use strict";function d(a){return"a"+a}function e(a){return"d"+a}function f(a,b){return"c"+a+"_"+b}function g(a){return"s"+a}function h(a,b){return"t"+a+"_"+b}function i(a){return"o"+a}function j(a){return"x"+a}function k(a){return"p"+a}function l(a,b){return"d"+a+"_"+b}function m(a){return"i"+a}function n(a,b){return"u"+a+"_"+b}function o(a){return"b"+a}function p(a){return"y"+a}function q(a){return"e"+a}function r(a){return"v"+a}function s(a,b,c){for(var d=0,e=0;e<a;++e)b&1<<e&&(d|=1<<c[e]);return d}var t=a("typedarray-pool");b.exports=function(a){function b(a){throw new Error("ndarray-extract-contour: "+a)}"object"!=typeof a&&b("Must specify arguments");var c=a.order;Array.isArray(c)||b("Must specify order");var A=a.arrayArguments||1;A<1&&b("Must have at least one array argument");var B=a.scalarArguments||0;B<0&&b("Scalar arg count must be > 0"),"function"!=typeof a.vertex&&b("Must specify vertex creation function"),"function"!=typeof a.cell&&b("Must specify cell creation function"),"function"!=typeof a.phase&&b("Must specify phase function");for(var C=a.getters||[],D=new Array(A),E=0;E<A;++E)C.indexOf(E)>=0?D[E]=!0:D[E]=!1;return function(a,b,c,A,B,C){function D(a,b){J.push("for(",m(B[a]),"=",b,";",m(B[a]),"<",g(B[a]),";","++",m(B[a]),"){")}function E(a){for(var b=0;b<G;++b)J.push(k(b),"+=",n(b,B[a]),";");J.push("}")}function F(){for(var a=1;a<1<<H;++a)J.push(z,"=",q(a),";",q(a),"=",p(a),";",p(a),"=",z,";")}var G=C.length,H=B.length;if(H<2)throw new Error("ndarray-extract-contour: Dimension must be at least 2");for(var I="extractContour"+B.join("_"),J=[],K=[],L=[],M=0;M<G;++M)L.push(d(M));for(var M=0;M<A;++M)L.push(j(M));for(var M=0;M<H;++M)K.push(g(M)+"="+d(0)+".shape["+M+"]|0");for(var M=0;M<G;++M){K.push(e(M)+"="+d(M)+".data",i(M)+"="+d(M)+".offset|0");for(var N=0;N<H;++N)K.push(h(M,N)+"="+d(M)+".stride["+N+"]|0")}for(var M=0;M<G;++M){K.push(k(M)+"="+i(M)),K.push(f(M,0));for(var N=1;N<1<<H;++N){for(var O=[],P=0;P<H;++P)N&1<<P&&O.push("-"+h(M,P));K.push(l(M,N)+"=("+O.join("")+")|0"),K.push(f(M,N)+"=0")}}for(var M=0;M<G;++M)for(var N=0;N<H;++N){var Q=[h(M,B[N])];N>0&&Q.push(h(M,B[N-1])+"*"+g(B[N-1])),K.push(n(M,B[N])+"=("+Q.join("-")+")|0")}for(var M=0;M<H;++M)K.push(m(M)+"=0");K.push(w+"=0");for(var R=["2"],M=H-2;M>=0;--M)R.push(g(B[M]));K.push(x+"=("+R.join("*")+")|0",v+"=mallocUint32("+x+")",u+"=mallocUint32("+x+")",y+"=0"),K.push(o(0)+"=0");for(var N=1;N<1<<H;++N){for(var S=[],T=[],P=0;P<H;++P)N&1<<P&&(0===T.length?S.push("1"):S.unshift(T.join("*"))),T.push(g(B[P]));var U="";S[0].indexOf(g(B[H-2]))<0&&(U="-");var V=s(H,N,B);K.push(q(V)+"=(-"+S.join("-")+")|0",p(V)+"=("+U+S.join("-")+")|0",o(V)+"=0")}K.push(r(0)+"=0",z+"=0"),function a(b,c){if(b<0)return void function(a){for(var b=0;b<G;++b)C[b]?J.push(f(b,0),"=",e(b),".get(",k(b),");"):J.push(f(b,0),"=",e(b),"[",k(b),"];");for(var c=[],b=0;b<G;++b)c.push(f(b,0));for(var b=0;b<A;++b)c.push(j(b));J.push(o(0),"=",v,"[",y,"]=phase(",c.join(),");");for(var d=1;d<1<<H;++d)J.push(o(d),"=",v,"[",y,"+",q(d),"];");for(var g=[],d=1;d<1<<H;++d)g.push("("+o(0)+"!=="+o(d)+")");J.push("if(",g.join("||"),"){");for(var h=[],b=0;b<H;++b)h.push(m(b));for(var b=0;b<G;++b){h.push(f(b,0));for(var d=1;d<1<<H;++d)C[b]?J.push(f(b,d),"=",e(b),".get(",k(b),"+",l(b,d),");"):J.push(f(b,d),"=",e(b),"[",k(b),"+",l(b,d),"];"),h.push(f(b,d))}for(var b=0;b<1<<H;++b)h.push(o(b));for(var b=0;b<A;++b)h.push(j(b));J.push("vertex(",h.join(),");",r(0),"=",u,"[",y,"]=",w,"++;");for(var i=(1<<H)-1,n=o(i),d=0;d<H;++d)if(0==(a&~(1<<d))){for(var p=i^1<<d,s=o(p),t=[],x=p;x>0;x=x-1&p)t.push(u+"["+y+"+"+q(x)+"]");t.push(r(0));for(var x=0;x<G;++x)1&d?t.push(f(x,i),f(x,p)):t.push(f(x,p),f(x,i));1&d?t.push(n,s):t.push(s,n);for(var x=0;x<A;++x)t.push(j(x));J.push("if(",n,"!==",s,"){","face(",t.join(),")}")}J.push("}",y,"+=1;")}(c);!function(a){for(var b=a-1;b>=0;--b)D(b,0);for(var c=[],b=0;b<G;++b)C[b]?c.push(e(b)+".get("+k(b)+")"):c.push(e(b)+"["+k(b)+"]");for(var b=0;b<A;++b)c.push(j(b));J.push(v,"[",y,"++]=phase(",c.join(),");");for(var b=0;b<a;++b)E(b);for(var d=0;d<G;++d)J.push(k(d),"+=",n(d,B[a]),";")}(b),
J.push("if(",g(B[b]),">0){",m(B[b]),"=1;"),a(b-1,c|1<<B[b]);for(var d=0;d<G;++d)J.push(k(d),"+=",n(d,B[b]),";");b===H-1&&(J.push(y,"=0;"),F()),D(b,2),a(b-1,c),b===H-1&&(J.push("if(",m(B[H-1]),"&1){",y,"=0;}"),F()),E(b),J.push("}")}(H-1,0),J.push("freeUint32(",u,");freeUint32(",v,");");var W=["'use strict';","function ",I,"(",L.join(),"){","var ",K.join(),";",J.join(""),"}","return ",I].join("");return new Function("vertex","face","phase","mallocUint32","freeUint32",W)(a,b,c,t.mallocUint32,t.freeUint32)}(a.vertex,a.cell,a.phase,B,c,D)};var u="V",v="P",w="N",x="Q",y="X",z="T"},{"typedarray-pool":546}],441:[function(a,b,c){"use strict";var d=a("cwise/lib/wrapper")({args:["index","array","scalar"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{_inline_1_arg1_=_inline_1_arg2_.apply(void 0,_inline_1_arg0_)}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"cwise",blockSize:64});b.exports=function(a,b){return d(a,b),a}},{"cwise/lib/wrapper":150}],442:[function(a,b,c){"use strict";function d(a){if(a in g)return g[a];for(var b=[],c=0;c<a;++c)b.push("out",c,"s=0.5*(inp",c,"l-inp",c,"r);");var d=["array"],h=["junk"];for(c=0;c<a;++c){d.push("array"),h.push("out"+c+"s");var j=e(a);j[c]=-1,d.push({array:0,offset:j.slice()}),j[c]=1,d.push({array:0,offset:j.slice()}),h.push("inp"+c+"l","inp"+c+"r")}return g[a]=f({args:d,pre:i,post:i,body:{body:b.join(""),args:h.map(function(a){return{name:a,lvalue:0===a.indexOf("out"),rvalue:0===a.indexOf("inp"),count:"junk"!==a|0}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+a})}b.exports=function(a,b,c){if(Array.isArray(c)){if(c.length!==b.dimension)throw new Error("ndarray-gradient: invalid boundary conditions")}else c=e(b.dimension,"string"==typeof c?c:"clamp");if(a.dimension!==b.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(a.shape[b.dimension]!==b.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var f=0;f<b.dimension;++f)if(a.shape[f]!==b.shape[f])throw new Error("ndarray-gradient: shape mismatch");return 0===b.size?a:b.dimension<=0?(a.set(0),a):function(a){var b=a.join();if(q=h[b])return q;for(var c=a.length,e=["function gradient(dst,src){var s=src.shape.slice();"],f=0;f<1<<c;++f){for(var i=[],l=0;l<c;++l)f&1<<l&&i.push(l+1);for(var m=0;m<1<<i.length;++m){for(var n=i.slice(),l=0;l<i.length;++l)m&1<<l&&(n[l]=-n[l]);!function(b){for(var d=c-b.length,f=[],g=[],h=[],i=0;i<c;++i)b.indexOf(i+1)>=0?h.push("0"):b.indexOf(-(i+1))>=0?h.push("s["+i+"]-1"):(h.push("-1"),f.push("1"),g.push("s["+i+"]-2"));var j=".lo("+f.join()+").hi("+g.join()+")";if(0===f.length&&(j=""),d>0){e.push("if(1");for(var i=0;i<c;++i)b.indexOf(i+1)>=0||b.indexOf(-(i+1))>=0||e.push("&&s[",i,"]>2");e.push("){grad",d,"(src.pick(",h.join(),")",j);for(var i=0;i<c;++i)b.indexOf(i+1)>=0||b.indexOf(-(i+1))>=0||e.push(",dst.pick(",h.join(),",",i,")",j);e.push(");")}for(var i=0;i<b.length;++i){var k=Math.abs(b[i])-1,l="dst.pick("+h.join()+","+k+")"+j;switch(a[k]){case"clamp":var m=h.slice(),n=h.slice();b[i]<0?m[k]="s["+k+"]-2":n[k]="1",0===d?e.push("if(s[",k,"]>1){dst.set(",h.join(),",",k,",0.5*(src.get(",m.join(),")-src.get(",n.join(),")))}else{dst.set(",h.join(),",",k,",0)};"):e.push("if(s[",k,"]>1){diff(",l,",src.pick(",m.join(),")",j,",src.pick(",n.join(),")",j,");}else{zero(",l,");};");break;case"mirror":0===d?e.push("dst.set(",h.join(),",",k,",0);"):e.push("zero(",l,");");break;case"wrap":var o=h.slice(),p=h.slice();b[i]<0?(o[k]="s["+k+"]-2",p[k]="0"):(o[k]="s["+k+"]-1",p[k]="1"),0===d?e.push("if(s[",k,"]>2){dst.set(",h.join(),",",k,",0.5*(src.get(",o.join(),")-src.get(",p.join(),")))}else{dst.set(",h.join(),",",k,",0)};"):e.push("if(s[",k,"]>2){diff(",l,",src.pick(",o.join(),")",j,",src.pick(",p.join(),")",j,");}else{zero(",l,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}d>0&&e.push("};")}(n)}}e.push("return dst;};return gradient");for(var o=["diff","zero"],p=[j,k],f=1;f<=c;++f)o.push("grad"+f),p.push(d(f));o.push(e.join(""));var q=Function.apply(void 0,o).apply(void 0,p);return g[b]=q,q}(c)(a,b)};var e=a("dup"),f=a("cwise-compiler"),g={},h={},i={body:"",args:[],thisVars:[],localVars:[]},j=f({args:["array","array","array"],pre:i,post:i,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),k=f({args:["array"],pre:i,post:i,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"})},{"cwise-compiler":147,dup:171}],443:[function(a,b,c){"use strict";var d=a("ndarray-warp"),e=a("gl-matrix-invert");b.exports=function(a,b,c){var f=b.dimension,g=e([],c);return d(a,b,function(a,b){for(var c=0;c<f;++c){a[c]=g[(f+1)*f+c];for(var d=0;d<f;++d)a[c]+=g[(f+1)*d+c]*b[d]}var e=g[(f+1)*(f+1)-1];for(d=0;d<f;++d)e+=g[(f+1)*d+f]*b[d];var h=1/e;for(c=0;c<f;++c)a[c]*=h;return a}),a}},{"gl-matrix-invert":278,"ndarray-warp":450}],444:[function(a,b,c){"use strict";function d(a,b){var c=Math.floor(b),d=b-c,e=0<=c&&c<a.shape[0],f=0<=c+1&&c+1<a.shape[0];return(1-d)*(e?+a.get(c):0)+d*(f?+a.get(c+1):0)}function e(a,b,c){var d=Math.floor(b),e=b-d,f=0<=d&&d<a.shape[0],g=0<=d+1&&d+1<a.shape[0],h=Math.floor(c),i=c-h,j=0<=h&&h<a.shape[1],k=0<=h+1&&h+1<a.shape[1],l=f&&j?a.get(d,h):0,m=f&&k?a.get(d,h+1):0;return(1-i)*((1-e)*l+e*(g&&j?a.get(d+1,h):0))+i*((1-e)*m+e*(g&&k?a.get(d+1,h+1):0))}function f(a,b,c,d){var e=Math.floor(b),f=b-e,g=0<=e&&e<a.shape[0],h=0<=e+1&&e+1<a.shape[0],i=Math.floor(c),j=c-i,k=0<=i&&i<a.shape[1],l=0<=i+1&&i+1<a.shape[1],m=Math.floor(d),n=d-m,o=0<=m&&m<a.shape[2],p=0<=m+1&&m+1<a.shape[2],q=g&&k&&o?a.get(e,i,m):0,r=g&&l&&o?a.get(e,i+1,m):0,s=h&&k&&o?a.get(e+1,i,m):0,t=h&&l&&o?a.get(e+1,i+1,m):0,u=g&&k&&p?a.get(e,i,m+1):0,v=g&&l&&p?a.get(e,i+1,m+1):0;return(1-n)*((1-j)*((1-f)*q+f*s)+j*((1-f)*r+f*t))+n*((1-j)*((1-f)*u+f*(h&&k&&p?a.get(e+1,i,m+1):0))+j*((1-f)*v+f*(h&&l&&p?a.get(e+1,i+1,m+1):0)))}b.exports=function(a,b,c,g){switch(a.shape.length){case 0:return 0;case 1:return d(a,b);case 2:return e(a,b,c);case 3:return f(a,b,c,g);default:return function(a){var b,c,d=0|a.shape.length,e=new Array(d),f=new Array(d),g=new Array(d),h=new Array(d);for(b=0;b<d;++b)c=+arguments[b+1],e[b]=Math.floor(c),f[b]=c-e[b],g[b]=0<=e[b]&&e[b]<a.shape[b],h[b]=0<=e[b]+1&&e[b]+1<a.shape[b];var i,j,k,l=0;a:for(b=0;b<1<<d;++b){for(j=1,k=a.offset,i=0;i<d;++i)if(b&1<<i){if(!h[i])continue a;j*=f[i],k+=a.stride[i]*(e[i]+1)}else{if(!g[i])continue a;j*=1-f[i],k+=a.stride[i]*e[i]}l+=j*a.data[k]}return l}.apply(void 0,arguments)}},b.exports.d1=d,b.exports.d2=e,b.exports.d3=f},{}],445:[function(a,b,c){"use strict";function d(a){if(!a)return g;for(var b=0;b<a.args.length;++b){var c=a.args[b];a.args[b]=0===b?{name:c,lvalue:!0,rvalue:!!a.rvalue,count:a.count||1}:{name:c,lvalue:!1,rvalue:!0,count:1}}return a.thisVars||(a.thisVars=[]),a.localVars||(a.localVars=[]),a}function e(a){for(var b=[],c=0;c<a.args.length;++c)b.push("a"+c);return new Function("P",["return function ",a.funcName,"_ndarrayops(",b.join(","),") {P(",b.join(","),");return a0}"].join(""))(function(a){return f({args:a.args,pre:d(a.pre),body:d(a.body),post:d(a.proc),funcName:a.funcName})}(a))}var f=a("cwise-compiler"),g={body:"",args:[],thisVars:[],localVars:[]},h={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var a in h){var b=h[a];c[a]=e({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+b+"c"},funcName:a}),c[a+"eq"]=e({args:["array","array"],body:{args:["a","b"],body:"a"+b+"=b"},rvalue:!0,funcName:a+"eq"}),c[a+"s"]=e({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+b+"s"},funcName:a+"s"}),c[a+"seq"]=e({args:["array","scalar"],body:{args:["a","s"],body:"a"+b+"=s"},rvalue:!0,funcName:a+"seq"})}}();var i={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var a in i){var b=i[a];c[a]=e({args:["array","array"],body:{args:["a","b"],body:"a="+b+"b"},funcName:a}),c[a+"eq"]=e({args:["array"],body:{args:["a"],body:"a="+b+"a"},rvalue:!0,count:2,funcName:a+"eq"})}}();var j={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var a in j){var b=j[a];c[a]=e({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+b+"c"},funcName:a}),c[a+"s"]=e({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+b+"s"},funcName:a+"s"}),c[a+"eq"]=e({args:["array","array"],body:{args:["a","b"],body:"a=a"+b+"b"},rvalue:!0,count:2,funcName:a+"eq"}),c[a+"seq"]=e({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+b+"s"},rvalue:!0,count:2,funcName:a+"seq"})}}();var k=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var a=0;a<k.length;++a){var b=k[a];c[b]=e({args:["array","array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:b}),c[b+"eq"]=e({args:["array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:b+"eq"})}}();var l=["max","min","atan2","pow"];!function(){for(var a=0;a<l.length;++a){var b=l[a];c[b]=e({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:b}),c[b+"s"]=e({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:b+"s"}),c[b+"eq"]=e({args:["array","array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:b+"eq"}),c[b+"seq"]=e({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:b+"seq"})}}();var m=["atan2","pow"];!function(){for(var a=0;a<m.length;++a){var b=m[a];c[b+"op"]=e({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:b+"op"}),c[b+"ops"]=e({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:b+"ops"}),c[b+"opeq"]=e({args:["array","array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:b+"opeq"}),c[b+"opseq"]=e({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:b+"opseq"})}}(),c.any=f({args:["array"],pre:g,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),c.all=f({args:["array"],pre:g,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),c.sum=f({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),c.prod=f({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),c.norm2squared=f({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),c.norm2=f({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),c.norminf=f({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),c.norm1=f({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),c.sup=f({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),c.inf=f({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),c.argmin=f({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),c.argmax=f({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),c.random=e({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),c.assign=e({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),c.assigns=e({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),c.equals=f({args:["array","array"],pre:g,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":147}],446:[function(a,b,c){"use strict";var d=a("ndarray"),e=a("./doConvert.js");b.exports=function(a,b){for(var c=[],f=a,g=1;Array.isArray(f);)c.push(f.length),g*=f.length,f=f[0];return 0===c.length?d():(b||(b=d(new Float64Array(g),c)),e(b,a),b)}},{"./doConvert.js":447,ndarray:451}],447:[function(a,b,c){b.exports=a("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":147}],448:[function(a,b,c){"use strict";function d(a){switch(a){case"uint8":return[f.mallocUint8,f.freeUint8];case"uint16":return[f.mallocUint16,f.freeUint16];case"uint32":return[f.mallocUint32,f.freeUint32];case"int8":return[f.mallocInt8,f.freeInt8];case"int16":return[f.mallocInt16,f.freeInt16];case"int32":return[f.mallocInt32,f.freeInt32];case"float32":return[f.mallocFloat,f.freeFloat];case"float64":return[f.mallocDouble,f.freeDouble];default:return null}}function e(a){for(var b=[],c=0;c<a;++c)b.push("s"+c);for(c=0;c<a;++c)b.push("n"+c);for(c=1;c<a;++c)b.push("d"+c);for(c=1;c<a;++c)b.push("e"+c);for(c=1;c<a;++c)b.push("f"+c);return b}var f=a("typedarray-pool"),g=32;b.exports=function(a,b){var c=["'use strict'"],f=["ndarraySortWrapper",a.join("d"),b].join("");c.push(["function ",f,"(",["array"].join(","),"){"].join(""));for(var h=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"],i=0;i<a.length;++i)h.push(["s",i,"=stride[",i,"]|0,n",i,"=shape[",i,"]|0"].join(""));var j=new Array(a.length),k=[];for(i=0;i<a.length;++i)0!==(n=a[i])&&(0===k.length?j[n]="1":j[n]=k.join("*"),k.push("n"+n));var l=-1,m=-1;for(i=0;i<a.length;++i){var n,o=a[i];0!==o&&(l>0?h.push(["d",o,"=s",o,"-d",l,"*n",l].join("")):h.push(["d",o,"=s",o].join("")),l=o),0!=(n=a.length-1-i)&&(m>0?h.push(["e",n,"=s",n,"-e",m,"*n",m,",f",n,"=",j[n],"-f",m,"*n",m].join("")):h.push(["e",n,"=s",n,",f",n,"=",j[n]].join("")),m=n)}c.push("var "+h.join(","));var p=["0","n0-1","data","offset"].concat(e(a.length));c.push(["if(n0<=",g,"){","insertionSort(",p.join(","),")}else{","quickSort(",p.join(","),")}"].join("")),c.push("}return "+f);var q=new Function("insertionSort","quickSort",c.join("\n")),r=function(a,b){function c(a){return"generic"===b?["data.get(",a,")"].join(""):["data[",a,"]"].join("")}function f(a,c){return"generic"===b?["data.set(",a,",",c,")"].join(""):["data[",a,"]=",c].join("")}var g=["'use strict'"],h=["ndarrayInsertionSort",a.join("d"),b].join(""),i=["left","right","data","offset"].concat(e(a.length)),j=d(b),k=["i,j,cptr,ptr=left*s0+offset"];if(a.length>1){for(var l=[],m=1;m<a.length;++m)k.push("i"+m),l.push("n"+m);j?k.push("scratch=malloc("+l.join("*")+")"):k.push("scratch=new Array("+l.join("*")+")"),k.push("dptr","sptr","a","b")}else k.push("scratch");if(g.push(["function ",h,"(",i.join(","),"){var ",k.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr"),a.length>1){for(g.push("dptr=0;sptr=ptr"),m=a.length-1;m>=0;--m)0!==(n=a[m])&&g.push(["for(i",n,"=0;i",n,"<n",n,";++i",n,"){"].join(""));for(g.push("scratch[dptr++]=",c("sptr")),m=0;m<a.length;++m)0!==(n=a[m])&&g.push("sptr+=d"+n,"}");for(g.push("__g:while(j--\x3eleft){","dptr=0","sptr=cptr-s0"),m=1;m<a.length;++m)1===m&&g.push("__l:"),g.push(["for(i",m,"=0;i",m,"<n",m,";++i",m,"){"].join(""));for(g.push(["a=",c("sptr"),"\nb=scratch[dptr]\nif(a<b){break __g}\nif(a>b){break __l}"].join("")),m=a.length-1;m>=1;--m)g.push("sptr+=e"+m,"dptr+=f"+m,"}");for(g.push("dptr=cptr;sptr=cptr-s0"),m=a.length-1;m>=0;--m)0!==(n=a[m])&&g.push(["for(i",n,"=0;i",n,"<n",n,";++i",n,"){"].join(""));for(g.push(f("dptr",c("sptr"))),m=0;m<a.length;++m)0!==(n=a[m])&&g.push(["dptr+=d",n,";sptr+=d",n].join(""),"}");for(g.push("cptr-=s0\n}"),g.push("dptr=cptr;sptr=0"),m=a.length-1;m>=0;--m)0!==(n=a[m])&&g.push(["for(i",n,"=0;i",n,"<n",n,";++i",n,"){"].join(""));for(g.push(f("dptr","scratch[sptr++]")),m=0;m<a.length;++m){var n;0!==(n=a[m])&&g.push("dptr+=d"+n,"}")}}else g.push("scratch="+c("ptr"),"while((j--\x3eleft)&&("+c("cptr-s0")+">scratch)){",f("cptr",c("cptr-s0")),"cptr-=s0","}",f("cptr","scratch"));return g.push("}"),a.length>1&&j&&g.push("free(scratch)"),g.push("} return "+h),j?new Function("malloc","free",g.join("\n"))(j[0],j[1]):new Function(g.join("\n"))()}(a,b);return q(r,function(a,b,c){function f(a){return["(offset+",a,"*s0)"].join("")}function h(a){return"generic"===b?["data.get(",a,")"].join(""):["data[",a,"]"].join("")}function i(a,c){return"generic"===b?["data.set(",a,",",c,")"].join(""):["data[",a,"]=",c].join("")}function j(b,c,d){if(1===b.length)v.push("ptr0="+f(b[0]));else for(var e=0;e<b.length;++e)v.push(["b_ptr",e,"=s0*",b[e]].join(""));for(c&&v.push("pivot_ptr=0"),v.push("ptr_shift=offset"),e=a.length-1;e>=0;--e)0!==(g=a[e])&&v.push(["for(i",g,"=0;i",g,"<n",g,";++i",g,"){"].join(""));if(b.length>1)for(e=0;e<b.length;++e)v.push(["ptr",e,"=b_ptr",e,"+ptr_shift"].join(""));for(v.push(d),c&&v.push("++pivot_ptr"),e=0;e<a.length;++e){var g;0!==(g=a[e])&&(b.length>1?v.push("ptr_shift+=d"+g):v.push("ptr0+=d"+g),v.push("}"))}}function k(b,c,d,e){if(1===c.length)v.push("ptr0="+f(c[0]));else{for(var g=0;g<c.length;++g)v.push(["b_ptr",g,"=s0*",c[g]].join(""));v.push("ptr_shift=offset")}for(d&&v.push("pivot_ptr=0"),b&&v.push(b+":"),g=1;g<a.length;++g)v.push(["for(i",g,"=0;i",g,"<n",g,";++i",g,"){"].join(""));if(c.length>1)for(g=0;g<c.length;++g)v.push(["ptr",g,"=b_ptr",g,"+ptr_shift"].join(""));for(v.push(e),g=a.length-1;g>=1;--g)d&&v.push("pivot_ptr+=f"+g),c.length>1?v.push("ptr_shift+=e"+g):v.push("ptr0+=e"+g),v.push("}")}function l(){a.length>1&&y&&v.push("free(pivot1)","free(pivot2)")}function m(b,c){var d="el"+b,e="el"+c;if(a.length>1){var g="__l"+ ++z;k(g,[d,e],!1,["comp=",h("ptr0"),"-",h("ptr1"),"\n","if(comp>0){tmp0=",d,";",d,"=",e,";",e,"=tmp0;break ",g,"}\n","if(comp<0){break ",g,"}"].join(""))}else v.push(["if(",h(f(d)),">",h(f(e)),"){tmp0=",d,";",d,"=",e,";",e,"=tmp0}"].join(""))}function n(b,c){a.length>1?j([b,c],!1,i("ptr0",h("ptr1"))):v.push(i(f(b),h(f(c))))}function o(b,c,d){if(a.length>1){var e="__l"+ ++z;k(e,[c],!0,[b,"=",h("ptr0"),"-pivot",d,"[pivot_ptr]\n","if(",b,"!==0){break ",e,"}"].join(""))}else v.push([b,"=",h(f(c)),"-pivot",d].join(""))}function p(b,c){a.length>1?j([b,c],!1,["tmp=",h("ptr0"),"\n",i("ptr0",h("ptr1")),"\n",i("ptr1","tmp")].join("")):v.push(["ptr0=",f(b),"\n","ptr1=",f(c),"\n","tmp=",h("ptr0"),"\n",i("ptr0",h("ptr1")),"\n",i("ptr1","tmp")].join(""))}function q(b,c,d){a.length>1?(j([b,c,d],!1,["tmp=",h("ptr0"),"\n",i("ptr0",h("ptr1")),"\n",i("ptr1",h("ptr2")),"\n",i("ptr2","tmp")].join("")),v.push("++"+c,"--"+d)):v.push(["ptr0=",f(b),"\n","ptr1=",f(c),"\n","ptr2=",f(d),"\n","++",c,"\n","--",d,"\n","tmp=",h("ptr0"),"\n",i("ptr0",h("ptr1")),"\n",i("ptr1",h("ptr2")),"\n",i("ptr2","tmp")].join(""))}function r(a,b){p(a,b),v.push("--"+b)}function s(b,c,d){a.length>1?j([b,c],!0,[i("ptr0",h("ptr1")),"\n",i("ptr1",["pivot",d,"[pivot_ptr]"].join(""))].join("")):v.push(i(f(b),h(f(c))),i(f(c),"pivot"+d))}function t(b,c){v.push(["if((",c,"-",b,")<=",g,"){\n","insertionSort(",b,",",c,",data,offset,",e(a.length).join(","),")\n","}else{\n",w,"(",b,",",c,",data,offset,",e(a.length).join(","),")\n","}"].join(""))}function u(b,c,d){a.length>1?(v.push(["__l",++z,":while(true){"].join("")),j([b],!0,["if(",h("ptr0"),"!==pivot",c,"[pivot_ptr]){break __l",z,"}"].join("")),v.push(d,"}")):v.push(["while(",h(f(b)),"===pivot",c,"){",d,"}"].join(""))}var v=["'use strict'"],w=["ndarrayQuickSort",a.join("d"),b].join(""),x=["left","right","data","offset"].concat(e(a.length)),y=d(b),z=0;v.push(["function ",w,"(",x.join(","),"){"].join(""));var A=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(a.length>1){for(var B=[],C=1;C<a.length;++C)B.push("n"+C),A.push("i"+C);for(C=0;C<8;++C)A.push("b_ptr"+C);A.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+B.join("*")),y?A.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)"):A.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}else A.push("pivot1","pivot2");return v.push("var "+A.join(",")),m(1,2),m(4,5),m(1,3),m(2,3),m(1,4),m(3,4),m(2,5),m(2,3),m(4,5),a.length>1?j(["el1","el2","el3","el4","el5","index1","index3","index5"],!0,["pivot1[pivot_ptr]=",h("ptr1"),"\n","pivot2[pivot_ptr]=",h("ptr3"),"\n","pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])\n","x=",h("ptr0"),"\n","y=",h("ptr2"),"\n","z=",h("ptr4"),"\n",i("ptr5","x"),"\n",i("ptr6","y"),"\n",i("ptr7","z")].join("")):v.push(["pivot1=",h(f("el2")),"\n","pivot2=",h(f("el4")),"\n","pivots_are_equal=pivot1===pivot2\n","x=",h(f("el1")),"\n","y=",h(f("el3")),"\n","z=",h(f("el5")),"\n",i(f("index1"),"x"),"\n",i(f("index3"),"y"),"\n",i(f("index5"),"z")].join("")),n("index2","left"),n("index4","right"),v.push("if(pivots_are_equal){"),v.push("for(k=less;k<=great;++k){"),o("comp","k",1),v.push("if(comp===0){continue}"),v.push("if(comp<0){"),v.push("if(k!==less){"),p("k","less"),v.push("}"),v.push("++less"),v.push("}else{"),v.push("while(true){"),o("comp","great",1),v.push("if(comp>0){"),v.push("great--"),v.push("}else if(comp<0){"),q("k","less","great"),v.push("break"),v.push("}else{"),r("k","great"),v.push("break"),v.push("}"),v.push("}"),v.push("}"),v.push("}"),v.push("}else{"),v.push("for(k=less;k<=great;++k){"),o("comp_pivot1","k",1),v.push("if(comp_pivot1<0){"),v.push("if(k!==less){"),p("k","less"),v.push("}"),v.push("++less"),v.push("}else{"),o("comp_pivot2","k",2),v.push("if(comp_pivot2>0){"),v.push("while(true){"),o("comp","great",2),v.push("if(comp>0){"),v.push("if(--great<k){break}"),v.push("continue"),v.push("}else{"),o("comp","great",1),v.push("if(comp<0){"),q("k","less","great"),v.push("}else{"),r("k","great"),v.push("}"),v.push("break"),v.push("}"),v.push("}"),v.push("}"),v.push("}"),v.push("}"),v.push("}"),s("left","(less-1)",1),s("right","(great+1)",2),t("left","(less-2)"),t("(great+2)","right"),v.push("if(pivots_are_equal){"),l(),v.push("return"),v.push("}"),v.push("if(less<index1&&great>index5){"),u("less",1,"++less"),u("great",2,"--great"),v.push("for(k=less;k<=great;++k){"),o("comp_pivot1","k",1),v.push("if(comp_pivot1===0){"),v.push("if(k!==less){"),p("k","less"),v.push("}"),v.push("++less"),v.push("}else{"),o("comp_pivot2","k",2),v.push("if(comp_pivot2===0){"),v.push("while(true){"),o("comp","great",2),v.push("if(comp===0){"),v.push("if(--great<k){break}"),v.push("continue"),v.push("}else{"),o("comp","great",1),v.push("if(comp<0){"),q("k","less","great"),v.push("}else{"),r("k","great"),v.push("}"),v.push("break"),v.push("}"),v.push("}"),v.push("}"),v.push("}"),v.push("}"),v.push("}"),l(),t("less","great"),v.push("}return "+w),a.length>1&&y?new Function("insertionSort","malloc","free",v.join("\n"))(c,y[0],y[1]):new Function("insertionSort",v.join("\n"))(c)}(a,b,r))}},{"typedarray-pool":546}],449:[function(a,b,c){"use strict";var d=a("./lib/compile_sort.js"),e={};b.exports=function(a){var b=a.order,c=a.dtype,f=[b,c].join(":"),g=e[f];return g||(e[f]=g=d(b,c)),g(a),a}},{"./lib/compile_sort.js":448}],450:[function(a,b,c){"use strict";var d=a("ndarray-linear-interpolate"),e=a("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=new Array(_inline_3_arg4_)}",args:[{name:"_inline_3_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg2_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg3_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_4_arg2_(this_warped,_inline_4_arg0_),_inline_4_arg1_=_inline_4_arg3_.apply(void 0,this_warped)}",args:[{name:"_inline_4_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_4_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg4_",lvalue:!1,rvalue:!1,count:0}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warpND",blockSize:64}),f=a("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_7_arg2_(this_warped,_inline_7_arg0_),_inline_7_arg1_=_inline_7_arg3_(_inline_7_arg4_,this_warped[0])}",args:[{name:"_inline_7_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_7_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp1D",blockSize:64}),g=a("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_10_arg2_(this_warped,_inline_10_arg0_),_inline_10_arg1_=_inline_10_arg3_(_inline_10_arg4_,this_warped[0],this_warped[1])}",args:[{name:"_inline_10_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_10_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp2D",blockSize:64}),h=a("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_13_arg2_(this_warped,_inline_13_arg0_),_inline_13_arg1_=_inline_13_arg3_(_inline_13_arg4_,this_warped[0],this_warped[1],this_warped[2])}",args:[{name:"_inline_13_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_13_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp3D",blockSize:64});b.exports=function(a,b,c){switch(b.shape.length){case 1:f(a,c,d.d1,b);break;case 2:g(a,c,d.d2,b);break;case 3:h(a,c,d.d3,b);break;default:e(a,c,d.bind(void 0,b),b.shape.length)}return a}},{"cwise/lib/wrapper":150,"ndarray-linear-interpolate":444}],451:[function(a,b,c){function d(a,b){return a[0]-b[0]}function e(){var a,b=this.stride,c=new Array(b.length);for(a=0;a<c.length;++a)c[a]=[Math.abs(b[a]),a];c.sort(d);var e=new Array(c.length);for(a=0;a<e.length;++a)e[a]=c[a][1];return e}function f(a,b){var c=["View",b,"d",a].join("");b<0&&(c="View_Nil"+a);var d="generic"===a;if(-1===b){
var f="function "+c+"(a){this.data=a;};var proto="+c+".prototype;proto.dtype='"+a+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+c+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+c+"(a){return new "+c+"(a);}";return new Function(f)()}if(0===b)return f="function "+c+"(a,d) {this.data = a;this.offset = d};var proto="+c+".prototype;proto.dtype='"+a+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+c+"_copy() {return new "+c+"(this.data,this.offset)};proto.pick=function "+c+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+c+"_get(){return "+(d?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+c+"_set(v){return "+(d?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+c+"(a,b,c,d){return new "+c+"(a,d)}",new Function("TrivialArray",f)(j[a][0]);f=["'use strict'"];var h=g(b),i=h.map(function(a){return"i"+a}),k="this.offset+"+h.map(function(a){return"this.stride["+a+"]*i"+a}).join("+"),l=h.map(function(a){return"b"+a}).join(","),m=h.map(function(a){return"c"+a}).join(",");f.push("function "+c+"(a,"+l+","+m+",d){this.data=a","this.shape=["+l+"]","this.stride=["+m+"]","this.offset=d|0}","var proto="+c+".prototype","proto.dtype='"+a+"'","proto.dimension="+b),f.push("Object.defineProperty(proto,'size',{get:function "+c+"_size(){return "+h.map(function(a){return"this.shape["+a+"]"}).join("*"),"}})"),1===b?f.push("proto.order=[0]"):(f.push("Object.defineProperty(proto,'order',{get:"),b<4?(f.push("function "+c+"_order(){"),2===b?f.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===b&&f.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):f.push("ORDER})")),f.push("proto.set=function "+c+"_set("+i.join(",")+",v){"),d?f.push("return this.data.set("+k+",v)}"):f.push("return this.data["+k+"]=v}"),f.push("proto.get=function "+c+"_get("+i.join(",")+"){"),d?f.push("return this.data.get("+k+")}"):f.push("return this.data["+k+"]}"),f.push("proto.index=function "+c+"_index(",i.join(),"){return "+k+"}"),f.push("proto.hi=function "+c+"_hi("+i.join(",")+"){return new "+c+"(this.data,"+h.map(function(a){return["(typeof i",a,"!=='number'||i",a,"<0)?this.shape[",a,"]:i",a,"|0"].join("")}).join(",")+","+h.map(function(a){return"this.stride["+a+"]"}).join(",")+",this.offset)}");var n=h.map(function(a){return"a"+a+"=this.shape["+a+"]"}),o=h.map(function(a){return"c"+a+"=this.stride["+a+"]"});f.push("proto.lo=function "+c+"_lo("+i.join(",")+"){var b=this.offset,d=0,"+n.join(",")+","+o.join(","));for(var p=0;p<b;++p)f.push("if(typeof i"+p+"==='number'&&i"+p+">=0){d=i"+p+"|0;b+=c"+p+"*d;a"+p+"-=d}");for(f.push("return new "+c+"(this.data,"+h.map(function(a){return"a"+a}).join(",")+","+h.map(function(a){return"c"+a}).join(",")+",b)}"),f.push("proto.step=function "+c+"_step("+i.join(",")+"){var "+h.map(function(a){return"a"+a+"=this.shape["+a+"]"}).join(",")+","+h.map(function(a){return"b"+a+"=this.stride["+a+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil"),p=0;p<b;++p)f.push("if(typeof i"+p+"==='number'){d=i"+p+"|0;if(d<0){c+=b"+p+"*(a"+p+"-1);a"+p+"=ceil(-a"+p+"/d)}else{a"+p+"=ceil(a"+p+"/d)}b"+p+"*=d}");f.push("return new "+c+"(this.data,"+h.map(function(a){return"a"+a}).join(",")+","+h.map(function(a){return"b"+a}).join(",")+",c)}");var q=new Array(b),r=new Array(b);for(p=0;p<b;++p)q[p]="a[i"+p+"]",r[p]="b[i"+p+"]";for(f.push("proto.transpose=function "+c+"_transpose("+i+"){"+i.map(function(a,b){return a+"=("+a+"===undefined?"+b+":"+a+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+c+"(this.data,"+q.join(",")+","+r.join(",")+",this.offset)}"),f.push("proto.pick=function "+c+"_pick("+i+"){var a=[],b=[],c=this.offset"),p=0;p<b;++p)f.push("if(typeof i"+p+"==='number'&&i"+p+">=0){c=(c+this.stride["+p+"]*i"+p+")|0}else{a.push(this.shape["+p+"]);b.push(this.stride["+p+"])}");return f.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),f.push("return function construct_"+c+"(data,shape,stride,offset){return new "+c+"(data,"+h.map(function(a){return"shape["+a+"]"}).join(",")+","+h.map(function(a){return"stride["+a+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",f.join("\n"))(j[a],e)}var g=a("iota-array"),h=a("is-buffer"),i="undefined"!=typeof Float64Array,j={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};b.exports=function(a,b,c,d){if(void 0===a)return(0,j.array[0])([]);"number"==typeof a&&(a=[a]),void 0===b&&(b=[a.length]);var e=b.length;if(void 0===c){c=new Array(e);for(var g=e-1,k=1;g>=0;--g)c[g]=k,k*=b[g]}if(void 0===d)for(d=0,g=0;g<e;++g)c[g]<0&&(d-=(b[g]-1)*c[g]);for(var l=function(a){if(h(a))return"buffer";if(i)switch(Object.prototype.toString.call(a)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(a)?"array":"generic"}(a),m=j[l];m.length<=e+1;)m.push(f(l,m.length-1));return(0,m[e+1])(a,b,c,d)}},{"iota-array":417,"is-buffer":419}],452:[function(a,b,c){"use strict";var d=a("double-bits"),e=Math.pow(2,-1074),f=-1>>>0;b.exports=function(a,b){if(isNaN(a)||isNaN(b))return NaN;if(a===b)return a;if(0===a)return b<0?-e:e;var c=d.hi(a),g=d.lo(a);return b>a==a>0?g===f?(c+=1,g=0):g+=1:0===g?(g=f,c-=1):g-=1,d.pack(g,c)}},{"double-bits":168}],453:[function(a,b,c){function d(a,b,c,d){return["C",a,b,c,d,c,d]}function e(a,b,c,d,e,f){return["C",a/3+2/3*c,b/3+2/3*d,e/3+2/3*c,f/3+2/3*d,e,f]}function f(a,b,c,d,e,h,k,l,m,n){if(n)x=n[0],y=n[1],v=n[2],w=n[3];else{var o=g(a,b,-e);a=o.x,b=o.y;var p=(a-(l=(o=g(l,m,-e)).x))/2,q=(b-(m=o.y))/2,r=p*p/(c*c)+q*q/(d*d);r>1&&(c*=r=Math.sqrt(r),d*=r);var s=c*c,t=d*d,u=(h==k?-1:1)*Math.sqrt(Math.abs((s*t-s*q*q-t*p*p)/(s*q*q+t*p*p)));u==1/0&&(u=1);var v=u*c*q/d+(a+l)/2,w=u*-d*p/c+(b+m)/2,x=Math.asin(((b-w)/d).toFixed(9)),y=Math.asin(((m-w)/d).toFixed(9));(x=a<v?i-x:x)<0&&(x=2*i+x),(y=l<v?i-y:y)<0&&(y=2*i+y),k&&x>y&&(x-=2*i),!k&&y>x&&(y-=2*i)}if(Math.abs(y-x)>j){var z=y,A=l,B=m;y=x+j*(k&&y>x?1:-1);var C=f(l=v+c*Math.cos(y),m=w+d*Math.sin(y),c,d,e,0,k,A,B,[y,z,v,w])}var D=Math.tan((y-x)/4),E=4/3*c*D,F=4/3*d*D,G=[2*a-(a+E*Math.sin(x)),2*b-(b-F*Math.cos(x)),l+E*Math.sin(y),m-F*Math.cos(y),l,m];if(n)return G;C&&(G=G.concat(C));for(var H=0;H<G.length;){var I=g(G[H],G[H+1],e);G[H++]=I.x,G[H++]=I.y}return G}function g(a,b,c){return{x:a*Math.cos(c)-b*Math.sin(c),y:a*Math.sin(c)+b*Math.cos(c)}}function h(a){return a*(i/180)}var i=Math.PI,j=h(120);b.exports=function(a){for(var b,c=[],g=0,i=0,j=0,k=0,l=null,m=null,n=0,o=0,p=0,q=a.length;p<q;p++){var r=a[p],s=r[0];switch(s){case"M":j=r[1],k=r[2];break;case"A":(r=f(n,o,r[1],r[2],h(r[3]),r[4],r[5],r[6],r[7])).unshift("C"),r.length>7&&(c.push(r.splice(0,7)),r.unshift("C"));break;case"S":var t=n,u=o;"C"!=b&&"S"!=b||(t+=t-g,u+=u-i),r=["C",t,u,r[1],r[2],r[3],r[4]];break;case"T":"Q"==b||"T"==b?(l=2*n-l,m=2*o-m):(l=n,m=o),r=e(n,o,l,m,r[1],r[2]);break;case"Q":l=r[1],m=r[2],r=e(n,o,r[1],r[2],r[3],r[4]);break;case"L":r=d(n,o,r[1],r[2]);break;case"H":r=d(n,o,r[1],o);break;case"V":r=d(n,o,n,r[1]);break;case"Z":r=d(n,o,j,k)}b=s,n=r[r.length-2],o=r[r.length-1],r.length>4?(g=r[r.length-4],i=r[r.length-3]):(g=n,i=o),c.push(r)}return c}},{}],454:[function(a,b,c){c.vertexNormals=function(a,b,c){for(var d=b.length,e=new Array(d),f=void 0===c?1e-6:c,g=0;g<d;++g)e[g]=[0,0,0];for(g=0;g<a.length;++g)for(var h=a[g],i=0,j=h[h.length-1],k=h[0],l=0;l<h.length;++l){i=j,j=k,k=h[(l+1)%h.length];for(var m=b[i],n=b[j],o=b[k],p=new Array(3),q=0,r=new Array(3),s=0,t=0;t<3;++t)p[t]=m[t]-n[t],q+=p[t]*p[t],r[t]=o[t]-n[t],s+=r[t]*r[t];if(q*s>f){var u=e[j],v=1/Math.sqrt(q*s);for(t=0;t<3;++t){var w=(t+1)%3,x=(t+2)%3;u[t]+=v*(r[w]*p[x]-r[x]*p[w])}}}for(g=0;g<d;++g){u=e[g];var y=0;for(t=0;t<3;++t)y+=u[t]*u[t];if(y>f)for(v=1/Math.sqrt(y),t=0;t<3;++t)u[t]*=v;else for(t=0;t<3;++t)u[t]=0}return e},c.faceNormals=function(a,b,c){for(var d=a.length,e=new Array(d),f=void 0===c?1e-6:c,g=0;g<d;++g){for(var h=a[g],i=new Array(3),j=0;j<3;++j)i[j]=b[h[j]];var k=new Array(3),l=new Array(3);for(j=0;j<3;++j)k[j]=i[1][j]-i[0][j],l[j]=i[2][j]-i[0][j];var m=new Array(3),n=0;for(j=0;j<3;++j){var o=(j+1)%3,p=(j+2)%3;m[j]=k[o]*l[p]-k[p]*l[o],n+=m[j]*m[j]}for(n=n>f?1/Math.sqrt(n):0,j=0;j<3;++j)m[j]*=n;e[g]=m}return e}},{}],455:[function(a,b,c){"use strict";var d=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;b.exports=function(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de","5"===Object.getOwnPropertyNames(a)[0])return!1;for(var b={},c=0;c<10;c++)b["_"+String.fromCharCode(c)]=c;if("0123456789"!==Object.getOwnPropertyNames(b).map(function(a){return b[a]}).join(""))return!1;var d={};return"abcdefghijklmnopqrst".split("").forEach(function(a){d[a]=a}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},d)).join("")}catch(a){return!1}}()?Object.assign:function(a,b){for(var c,g,h=function(a){if(null==a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}(a),i=1;i<arguments.length;i++){for(var j in c=Object(arguments[i]))e.call(c,j)&&(h[j]=c[j]);if(d){g=d(c);for(var k=0;k<g.length;k++)f.call(c,g[k])&&(h[g[k]]=c[g[k]])}}return h}},{}],456:[function(a,b,c){"use strict";b.exports=function(a,b,c,d,e,f,g,h,i,j){var k=b+f+j;if(l>0){var l=Math.sqrt(k+1);a[0]=.5*(g-i)/l,a[1]=.5*(h-d)/l,a[2]=.5*(c-f)/l,a[3]=.5*l}else{var m=Math.max(b,f,j),l=Math.sqrt(2*m-k+1);b>=m?(a[0]=.5*l,a[1]=.5*(e+c)/l,a[2]=.5*(h+d)/l,a[3]=.5*(g-i)/l):f>=m?(a[0]=.5*(c+e)/l,a[1]=.5*l,a[2]=.5*(i+g)/l,a[3]=.5*(h-d)/l):(a[0]=.5*(d+h)/l,a[1]=.5*(g+i)/l,a[2]=.5*l,a[3]=.5*(c-e)/l)}return a}},{}],457:[function(a,b,c){"use strict";function d(a,b,c){return Math.sqrt(Math.pow(a,2)+Math.pow(b,2)+Math.pow(c,2))}function e(a,b,c,d){return Math.sqrt(Math.pow(a,2)+Math.pow(b,2)+Math.pow(c,2)+Math.pow(d,2))}function f(a,b){var c=b[0],d=b[1],f=b[2],g=b[3],h=e(c,d,f,g);h>1e-6?(a[0]=c/h,a[1]=d/h,a[2]=f/h,a[3]=g/h):(a[0]=a[1]=a[2]=0,a[3]=1)}function g(a,b,c){this.radius=h([c]),this.center=h(b),this.rotation=h(a),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}b.exports=function(a){var b=(a=a||{}).center||[0,0,0],c=a.rotation||[0,0,0,1],d=a.radius||1;b=[].slice.call(b,0,3),f(c=[].slice.call(c,0,4),c);var e=new g(c,b,Math.log(d));return e.setDistanceLimits(a.zoomMin,a.zoomMax),("eye"in a||"up"in a)&&e.lookAt(0,a.eye,a.center,a.up),e};var h=a("filtered-vector"),i=a("gl-mat4/lookAt"),j=a("gl-mat4/fromQuat"),k=a("gl-mat4/invert"),l=a("./lib/quatFromFrame"),m=g.prototype;m.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},m.recalcMatrix=function(a){this.radius.curve(a),this.center.curve(a),this.rotation.curve(a);var b=this.computedRotation;f(b,b);var c=this.computedMatrix;j(c,b);var d=this.computedCenter,e=this.computedEye,g=this.computedUp,h=Math.exp(this.computedRadius[0]);e[0]=d[0]+h*c[2],e[1]=d[1]+h*c[6],e[2]=d[2]+h*c[10],g[0]=c[1],g[1]=c[5],g[2]=c[9];for(var i=0;i<3;++i){for(var k=0,l=0;l<3;++l)k+=c[i+4*l]*e[l];c[12+i]=-k}},m.getMatrix=function(a,b){this.recalcMatrix(a);var c=this.computedMatrix;if(b){for(var d=0;d<16;++d)b[d]=c[d];return b}return c},m.idle=function(a){this.center.idle(a),this.radius.idle(a),this.rotation.idle(a)},m.flush=function(a){this.center.flush(a),this.radius.flush(a),this.rotation.flush(a)},m.pan=function(a,b,c,e){b=b||0,c=c||0,e=e||0,this.recalcMatrix(a);var f=this.computedMatrix,g=f[1],h=f[5],i=f[9],j=d(g,h,i);g/=j,h/=j,i/=j;var k=f[0],l=f[4],m=f[8],n=k*g+l*h+m*i,o=d(k-=g*n,l-=h*n,m-=i*n);k/=o,l/=o,m/=o;var p=f[2],q=f[6],r=f[10],s=p*g+q*h+r*i,t=p*k+q*l+r*m,u=d(p-=s*g+t*k,q-=s*h+t*l,r-=s*i+t*m);p/=u,q/=u,r/=u;var v=k*b+g*c,w=l*b+h*c,x=m*b+i*c;this.center.move(a,v,w,x);var y=Math.exp(this.computedRadius[0]);y=Math.max(1e-4,y+e),this.radius.set(a,Math.log(y))},m.rotate=function(a,b,c,f){this.recalcMatrix(a),b=b||0,c=c||0;var g=this.computedMatrix,h=g[0],i=g[4],j=g[8],k=g[1],l=g[5],m=g[9],n=g[2],o=g[6],p=g[10],q=b*h+c*k,r=b*i+c*l,s=b*j+c*m,t=-(o*s-p*r),u=-(p*q-n*s),v=-(n*r-o*q),w=Math.sqrt(Math.max(0,1-Math.pow(t,2)-Math.pow(u,2)-Math.pow(v,2))),x=e(t,u,v,w);x>1e-6?(t/=x,u/=x,v/=x,w/=x):(t=u=v=0,w=1);var y=this.computedRotation,z=y[0],A=y[1],B=y[2],C=y[3],D=z*w+C*t+A*v-B*u,E=A*w+C*u+B*t-z*v,F=B*w+C*v+z*u-A*t,G=C*w-z*t-A*u-B*v;if(f){t=n,u=o,v=p;var H=Math.sin(f)/d(t,u,v);t*=H,u*=H,v*=H,G=G*(w=Math.cos(b))-(D=D*w+G*t+E*v-F*u)*t-(E=E*w+G*u+F*t-D*v)*u-(F=F*w+G*v+D*u-E*t)*v}var I=e(D,E,F,G);I>1e-6?(D/=I,E/=I,F/=I,G/=I):(D=E=F=0,G=1),this.rotation.set(a,D,E,F,G)},m.lookAt=function(a,b,c,d){this.recalcMatrix(a),c=c||this.computedCenter,b=b||this.computedEye,d=d||this.computedUp;var e=this.computedMatrix;i(e,b,c,d);var g=this.computedRotation;l(g,e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10]),f(g,g),this.rotation.set(a,g[0],g[1],g[2],g[3]);for(var h=0,j=0;j<3;++j)h+=Math.pow(c[j]-b[j],2);this.radius.set(a,.5*Math.log(Math.max(h,1e-6))),this.center.set(a,c[0],c[1],c[2])},m.translate=function(a,b,c,d){this.center.move(a,b||0,c||0,d||0)},m.setMatrix=function(a,b){var c=this.computedRotation;l(c,b[0],b[1],b[2],b[4],b[5],b[6],b[8],b[9],b[10]),f(c,c),this.rotation.set(a,c[0],c[1],c[2],c[3]);var d=this.computedMatrix;k(d,b);var e=d[15];if(Math.abs(e)>1e-6){var g=d[12]/e,h=d[13]/e,i=d[14]/e;this.recalcMatrix(a);var j=Math.exp(this.computedRadius[0]);this.center.set(a,g-d[2]*j,h-d[6]*j,i-d[10]*j),this.radius.idle(a)}else this.center.idle(a),this.radius.idle(a)},m.setDistance=function(a,b){b>0&&this.radius.set(a,Math.log(b))},m.setDistanceLimits=function(a,b){a=a>0?Math.log(a):-1/0,b=b>0?Math.log(b):1/0,b=Math.max(b,a),this.radius.bounds[0][0]=a,this.radius.bounds[1][0]=b},m.getDistanceLimits=function(a){var b=this.radius.bounds;return a?(a[0]=Math.exp(b[0][0]),a[1]=Math.exp(b[1][0]),a):[Math.exp(b[0][0]),Math.exp(b[1][0])]},m.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},m.fromJSON=function(a){var b=this.lastT(),c=a.center;c&&this.center.set(b,c[0],c[1],c[2]);var d=a.rotation;d&&this.rotation.set(b,d[0],d[1],d[2],d[3]);var e=a.distance;e&&e>0&&this.radius.set(b,Math.log(e)),this.setDistanceLimits(a.zoomMin,a.zoomMax)}},{"./lib/quatFromFrame":456,"filtered-vector":227,"gl-mat4/fromQuat":263,"gl-mat4/invert":266,"gl-mat4/lookAt":267}],458:[function(a,b,c){"use strict";var d=a("repeat-string");b.exports=function(a,b,c){return d(c=void 0!==c?c+"":" ",b)+a}},{"repeat-string":504}],459:[function(a,b,c){"use strict";function d(a,b){if("string"!=typeof a)return[a];var c=[a];"string"==typeof b||Array.isArray(b)?b={brackets:b}:b||(b={});var d=b.brackets?Array.isArray(b.brackets)?b.brackets:[b.brackets]:["{}","[]","()"],e=b.escape||"___",f=!!b.flat;d.forEach(function(a){function b(b,d,g){var h=c.push(b.slice(a[0].length,-a[1].length))-1;return f.push(h),e+h+e}var d=new RegExp(["\\",a[0],"[^\\",a[0],"\\",a[1],"]*\\",a[1]].join("")),f=[];c.forEach(function(a,e){for(var f,g=0;a!=f;)if(f=a,a=a.replace(d,b),g++>1e4)throw Error("References have circular dependency. Please, check them.");c[e]=a}),f=f.reverse(),c=c.map(function(b){return f.forEach(function(c){b=b.replace(new RegExp("(\\"+e+c+"\\"+e+")","g"),a[0]+"$1"+a[1])}),b})});var g=new RegExp("\\"+e+"([0-9]+)\\"+e);return f?c:function a(b,c,d){for(var e,f=[],h=0;e=g.exec(b);){if(h++>1e4)throw Error("Circular references in parenthesis");f.push(b.slice(0,e.index)),f.push(a(c[e[1]],c)),b=b.slice(e.index+e[0].length)}return f.push(b),f}(c[0],c)}function e(a,b){function c(b,c){if(null==a[c])throw Error("Reference "+c+"is undefined");return a[c]}if(b&&b.flat){var d,e=b&&b.escape||"___",f=a[0];if(!f)return"";for(var g=new RegExp("\\"+e+"([0-9]+)\\"+e),h=0;f!=d;){if(h++>1e4)throw Error("Circular references in "+a);d=f,f=f.replace(g,c)}return f}return a.reduce(function a(b,c){return Array.isArray(c)&&(c=c.reduce(a,"")),b+c},"")}function f(a,b){return Array.isArray(a)?e(a,b):d(a,b)}f.parse=d,f.stringify=e,b.exports=f},{}],460:[function(a,b,c){"use strict";var d=a("pick-by-alias");b.exports=function(a){var b;return arguments.length>1&&(a=arguments),"string"==typeof a?a=a.split(/\s/).map(parseFloat):"number"==typeof a&&(a=[a]),a.length&&"number"==typeof a[0]?b=1===a.length?{width:a[0],height:a[0],x:0,y:0}:2===a.length?{width:a[0],height:a[1],x:0,y:0}:{x:a[0],y:a[1],width:a[2]-a[0]||0,height:a[3]-a[1]||0}:a&&(a=d(a,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),b={x:a.left||0,y:a.top||0},null==a.width?a.right?b.width=a.right-b.x:b.width=0:b.width=a.width,null==a.height?a.bottom?b.height=a.bottom-b.y:b.height=0:b.height=a.height),b}},{"pick-by-alias":466}],461:[function(a,b,c){b.exports=function(a){var b=[];return a.replace(e,function(a,c,e){var g=c.toLowerCase();for(e=function(a){var b=a.match(f);return b?b.map(Number):[]}(e),"m"==g&&e.length>2&&(b.push([c].concat(e.splice(0,2))),g="l",c="m"==c?"l":"L");;){if(e.length==d[g])return e.unshift(c),b.push(e);if(e.length<d[g])throw new Error("malformed path data");b.push([c].concat(e.splice(0,d[g])))}}),b};var d={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/gi,f=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],462:[function(a,b,c){b.exports=function(a,b){b||(b=[0,""]),a=String(a);var c=parseFloat(a,10);return b[0]=c,b[1]=a.match(/[\d.\-\+]*\s*(.*)/)[1]||"",b}},{}],463:[function(a,b,c){(function(a){(function(){var c,d,e,f,g,h;"undefined"!=typeof performance&&null!==performance&&performance.now?b.exports=function(){return performance.now()}:void 0!==a&&null!==a&&a.hrtime?(b.exports=function(){return(c()-g)/1e6},d=a.hrtime,f=(c=function(){var a;return 1e9*(a=d())[0]+a[1]})(),h=1e9*a.uptime(),g=f-h):Date.now?(b.exports=function(){return Date.now()-e},e=Date.now()):(b.exports=function(){return(new Date).getTime()-e},e=(new Date).getTime())}).call(this)}).call(this,a("_process"))},{_process:483}],464:[function(a,b,c){"use strict";b.exports=function(a){var b=a.length;if(b<d){for(var c=1,f=0;f<b;++f)for(var g=0;g<f;++g)if(a[f]<a[g])c=-c;else if(a[f]===a[g])return 0;return c}for(var h=e.mallocUint8(b),f=0;f<b;++f)h[f]=0;for(var c=1,f=0;f<b;++f)if(!h[f]){var i=1;h[f]=1;for(var g=a[f];g!==f;g=a[g]){if(h[g])return e.freeUint8(h),0;i+=1,h[g]=1}1&i||(c=-c)}return e.freeUint8(h),c};var d=32,e=a("typedarray-pool")},{"typedarray-pool":546}],465:[function(a,b,c){"use strict";var d=a("typedarray-pool"),e=a("invert-permutation");c.rank=function(a){var b=a.length;switch(b){case 0:case 1:return 0;case 2:return a[1]}var c,f,g,h=d.mallocUint32(b),i=d.mallocUint32(b),j=0;for(e(a,i),g=0;g<b;++g)h[g]=a[g];for(g=b-1;g>0;--g)f=i[g],c=h[g],h[g]=h[f],h[f]=c,i[g]=i[c],i[c]=f,j=(j+c)*g;return d.freeUint32(i),d.freeUint32(h),j},c.unrank=function(a,b,c){switch(a){case 0:return c||[];case 1:return c?(c[0]=0,c):[0];case 2:return c?(b?(c[0]=0,c[1]=1):(c[0]=1,c[1]=0),c):b?[0,1]:[1,0]}var d,e,f,g=1;for((c=c||new Array(a))[0]=0,f=1;f<a;++f)c[f]=f,g=g*f|0;for(f=a-1;f>0;--f)b=b-(d=b/g|0)*g|0,g=g/f|0,e=0|c[f],c[f]=0|c[d],c[d]=0|e;return c}},{"invert-permutation":416,"typedarray-pool":546}],466:[function(a,b,c){"use strict";function d(a){return e[a]?e[a]:("string"==typeof a&&(a=e[a]=a.split(/\s*,\s*|\s+/)),a)}b.exports=function(a,b,c){var e,f,g={};if("string"==typeof b&&(b=d(b)),Array.isArray(b)){var h={};for(f=0;f<b.length;f++)h[b[f]]=!0;b=h}for(e in b)b[e]=d(b[e]);var i={};for(e in b){var j=b[e];if(Array.isArray(j))for(f=0;f<j.length;f++){var k=j[f];if(c&&(i[k]=!0),k in a){if(g[e]=a[k],c)for(var l=f;l<j.length;l++)i[j[l]]=!0;break}}else e in a&&(b[e]&&(g[e]=a[e]),c&&(i[e]=!0))}if(c)for(e in a)i[e]||(g[e]=a[e]);return g};var e={}},{}],467:[function(a,b,c){"use strict";b.exports=function(a,b){function c(a,b){var c=h[b][a[b]];c.splice(c.indexOf(a),1)}function e(a,e,f){for(var g,i,j,k=0;k<2;++k)if(h[k][e].length>0){g=h[k][e][0],j=k;break}i=g[1^j];for(var l=0;l<2;++l)for(var m=h[l][e],n=0;n<m.length;++n){var o=m[n],p=o[1^l],q=d(b[a],b[e],b[i],b[p]);q>0&&(g=o,i=p,j=l)}return f?i:(g&&c(g,j),i)}for(var f=0|b.length,g=a.length,h=[new Array(f),new Array(f)],i=0;i<f;++i)h[0][i]=[],h[1][i]=[];for(var i=0;i<g;++i){var j=a[i];h[0][j[0]].push(j),h[1][j[1]].push(j)}for(var k=[],i=0;i<f;++i)h[0][i].length+h[1][i].length===0&&k.push([i]);for(var i=0;i<f;++i)for(var l=0;l<2;++l){for(var m=[];h[l][i].length>0;){h[0][i].length;var n=function(a,f){var g=h[f][a][0],i=[a];c(g,f);for(var j=g[1^f];;){for(;j!==a;)i.push(j),j=e(i[i.length-2],j,!1);if(h[0][a].length+h[1][a].length===0)break;var k=i[i.length-1],l=a,m=i[1],n=e(k,l,!0);if(d(b[k],b[l],b[m],b[n])<0)break;i.push(a),j=e(k,l)}return i}(i,l);!function(a,b){return b[1]===b[b.length-1]}(m,n)?(m.length>0&&k.push(m),m=n):m.push.apply(m,n)}m.length>0&&k.push(m)}return k};var d=a("compare-angle")},{"compare-angle":128}],468:[function(a,b,c){"use strict";b.exports=function(a,b){for(var c=d(a,b.length),e=new Array(b.length),f=new Array(b.length),g=[],h=0;h<b.length;++h){var i=c[h].length;f[h]=i,e[h]=!0,i<=1&&g.push(h)}for(;g.length>0;){var j=g.pop();e[j]=!1;for(var k=c[j],h=0;h<k.length;++h){var l=k[h];0==--f[l]&&g.push(l)}}for(var m=new Array(b.length),n=[],h=0;h<b.length;++h)if(e[h]){var j=n.length;m[h]=j,n.push(b[h])}else m[h]=-1;for(var o=[],h=0;h<a.length;++h){var p=a[h];e[p[0]]&&e[p[1]]&&o.push([m[p[0]],m[p[1]]])}return[o,n]};var d=a("edges-to-adjacency-list")},{"edges-to-adjacency-list":172}],469:[function(a,b,c){"use strict";function d(a,b){for(var c=new Array(a),d=0;d<a;++d)c[d]=b;return c}b.exports=function(a,b){function c(a){for(var b=a.length,c=0;c<b;++c)if(!G[a[c]])return!1;return!0}var l=k(a,b);a=l[0];for(var m=(b=l[1]).length,n=(a.length,e(a,b.length)),o=0;o<m;++o)if(n[o].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");for(var p=f(a,b),q=(p=p.filter(function(a){for(var c=a.length,d=[0],e=0;e<c;++e){var f=b[a[e]],g=b[a[(e+1)%c]],j=h(-f[0],f[1]),k=h(-f[0],g[1]),l=h(g[0],f[1]),m=h(g[0],g[1]);d=i(d,i(i(j,k),i(l,m)))}return d[d.length-1]>0})).length,r=new Array(q),s=new Array(q),o=0;o<q;++o){r[o]=o;var t=new Array(q),u=p[o].map(function(a){return b[a]}),v=g([u]),w=0;a:for(var x=0;x<q;++x)if(t[x]=0,o!==x){for(var y=p[x],z=y.length,A=0;A<z;++A){var B=v(b[y[A]]);if(0!==B){B<0&&(t[x]=1,w+=1);continue a}}t[x]=1,w+=1}s[o]=[w,o,t]}s.sort(function(a,b){return b[0]-a[0]});for(var o=0;o<q;++o)for(var t=s[o],C=t[1],D=t[2],x=0;x<q;++x)D[x]&&(r[x]=C);for(var E=function(a){for(var b=new Array(a),c=0;c<a;++c)b[c]=[];return b}(q),o=0;o<q;++o)E[o].push(r[o]),E[r[o]].push(o);for(var F={},G=d(m,!1),o=0;o<q;++o)for(var y=p[o],z=y.length,x=0;x<z;++x){var H=y[x],I=y[(x+1)%z],J=Math.min(H,I)+":"+Math.max(H,I);if(J in F){var K=F[J];E[K].push(o),E[o].push(K),G[H]=G[I]=!0}else F[J]=o}for(var L=[],M=d(q,-1),o=0;o<q;++o)r[o]!==o||c(p[o])?M[o]=-1:(L.push(o),M[o]=0);for(var l=[];L.length>0;){var N=L.pop(),O=E[N];j(O,function(a,b){return a-b});var P,Q=O.length,R=M[N];if(0===R){var y=p[N];P=[y]}for(var o=0;o<Q;++o){var S=O[o];if(!(M[S]>=0)&&(M[S]=1^R,L.push(S),0===R)){var y=p[S];c(y)||(y.reverse(),P.push(y))}}0===R&&l.push(P)}return l};var e=a("edges-to-adjacency-list"),f=a("planar-dual"),g=a("point-in-big-polygon"),h=a("two-product"),i=a("robust-sum"),j=a("uniq"),k=a("./lib/trim-leaves")},{"./lib/trim-leaves":468,"edges-to-adjacency-list":172,"planar-dual":467,"point-in-big-polygon":473,"robust-sum":516,"two-product":544,uniq:548}],470:[function(a,b,c){"use strict";b.exports=a("./quad")},{"./quad":472}],471:[function(a,b,c){arguments[4][112][0].apply(c,arguments)},{dup:112}],472:[function(a,b,c){"use strict";function d(a,b){for(var c=b[0],d=b[1],e=1/(b[2]-c),g=1/(b[3]-d),h=new Array(a.length),i=0,j=a.length/2;i<j;i++)h[2*i]=f((a[2*i]-c)*e,0,1),h[2*i+1]=f((a[2*i+1]-d)*g,0,1);return h}var e=a("binary-search-bounds"),f=a("clamp"),g=a("parse-rect"),h=a("array-bounds"),i=a("pick-by-alias"),j=a("defined"),k=a("flatten-vertex-data"),l=a("is-obj"),m=a("dtype"),n=a("math-log2");b.exports=function(a,b){function c(a,b,c){for(var d=1,e=.5,f=.5,g=.5,h=0;h<c;h++)d<<=2,d+=a<e?b<f?0:1:b<f?2:3,g*=.5,e+=a<e?-g:g,f+=b<f?-g:g;return d}b||(b={}),a=k(a,"float64"),b=i(b,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var f=j(b.maxDepth,255),o=j(b.bounds,h(a,2));o[0]===o[2]&&o[2]++,o[1]===o[3]&&o[3]++;var p,q=d(a,o),r=a.length>>>1;b.dtype||(b.dtype="array"),"string"==typeof b.dtype?p=new(m(b.dtype))(r):b.dtype&&(p=b.dtype,Array.isArray(p)&&(p.length=r));for(var s=0;s<r;++s)p[s]=s;var t=[],u=[],v=[],w=[];!function a(b,c,d,e,g,h){if(!e.length)return null;var i=t[g]||(t[g]=[]),j=v[g]||(v[g]=[]),k=u[g]||(u[g]=[]),l=i.length;if(++g>f){for(var m=0;m<e.length;m++)i.push(e[m]),j.push(h),k.push(null,null,null,null);return l}if(i.push(e[0]),j.push(h),e.length<=1)return k.push(null,null,null,null),l;for(var n=.5*d,o=b+n,p=c+n,r=[],s=[],w=[],x=[],y=1,z=e.length;y<z;y++){var A=e[y],B=q[2*A],C=q[2*A+1];B<o?C<p?r.push(A):s.push(A):C<p?w.push(A):x.push(A)}return h<<=2,k.push(a(b,c,n,r,g,h),a(b,p,n,s,g,h+1),a(o,c,n,w,g,h+2),a(o,p,n,x,g,h+3)),l}(0,0,1,p,0,1);for(var x=0,y=0;y<t.length;y++){var z=t[y];if(p.set)p.set(z,x);else for(var A=0,B=z.length;A<B;A++)p[A+x]=z[A];var C=x+t[y].length;w[y]=[x,C],x=C}return p.range=function(){for(var b,f=[],h=arguments.length;h--;)f[h]=arguments[h];if(l(f[f.length-1])){var k=f.pop();f.length||null==k.x&&null==k.l&&null==k.left||(f=[k],b={}),b=i(k,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else b={};f.length||(f=o);var m=g.apply(void 0,f),p=[Math.min(m.x,m.x+m.width),Math.min(m.y,m.y+m.height),Math.max(m.x,m.x+m.width),Math.max(m.y,m.y+m.height)],q=p[0],r=p[1],s=p[2],x=p[3],y=d([q,r,s,x],o),z=y[0],A=y[1],B=y[2],C=y[3],D=j(b.level,t.length);if(null!=b.d){var E;"number"==typeof b.d?E=[b.d,b.d]:b.d.length&&(E=b.d),D=Math.min(Math.max(Math.ceil(-n(Math.abs(E[0])/(o[2]-o[0]))),Math.ceil(-n(Math.abs(E[1])/(o[3]-o[1])))),D)}if(D=Math.min(D,t.length),b.lod)return function(a,b,d,f,g){for(var h=[],i=0;i<g;i++){var j=v[i],k=w[i][0],l=c(a,b,i),m=c(d,f,i),n=e.ge(j,l),o=e.gt(j,m,n,j.length-1);h[i]=[n+k,o+k]}return h}(z,A,B,C,D);var F=[];return function b(c,d,e,f,g,h){if(null!==g&&null!==h){var i=c+e,j=d+e;if(!(z>i||A>j||B<c||C<d||f>=D||g===h)){var k=t[f];void 0===h&&(h=k.length);for(var l=g;l<h;l++){var m=k[l],n=a[2*m],o=a[2*m+1];n>=q&&n<=s&&o>=r&&o<=x&&F.push(m)}var p=u[f],v=p[4*g+0],w=p[4*g+1],y=p[4*g+2],E=p[4*g+3],G=function(a,b){for(var c=null,d=0;null===c;)if(c=a[4*b+d],++d>a.length)return null;return c}(p,g+1),H=.5*e,I=f+1;b(c,d,H,I,v,w||y||E||G),b(c,d+H,H,I,w,y||E||G),b(c+H,d,H,I,y,E||G),b(c+H,d+H,H,I,E,G)}}}(0,0,1,0,0,1),F},p}},{"array-bounds":66,"binary-search-bounds":471,clamp:116,defined:165,dtype:170,"flatten-vertex-data":228,"is-obj":422,"math-log2":433,"parse-rect":460,"pick-by-alias":466}],473:[function(a,b,c){function d(){return!0}function e(a){for(var b={},c=0;c<a.length;++c){var e=a[c],f=e[0][0],g=e[0][1],h=e[1][1],j=[Math.min(g,h),Math.max(g,h)];f in b?b[f].push(j):b[f]=[j]}var k={},l=Object.keys(b);for(c=0;c<l.length;++c){var m=b[l[c]];k[l[c]]=i(m)}return function(a){return function(b,c){var e=a[b];return!!e&&!!e.queryPoint(c,d)}}(k)}function f(a){return 1}b.exports=function(a){for(var b=a.length,c=[],d=[],i=0;i<b;++i)for(var k=a[i],l=k.length,m=l-1,n=0;n<l;m=n++){var o=k[m],p=k[n];o[0]===p[0]?d.push([o,p]):c.push([o,p])}if(0===c.length)return 0===d.length?f:(q=e(d),function(a){return q(a[0],a[1])?0:1});var q,r=h(c),s=function(a,b){return function(c){var d=j.le(b,c[0]);if(d<0)return 1;var e=a[d];if(!e){if(!(d>0&&b[d]===c[0]))return 1;e=a[d-1]}for(var f=1;e;){var h=e.key,i=g(c,h[0],h[1]);if(h[0][0]<h[1][0])if(i<0)e=e.left;else{if(!(i>0))return 0;f=-1,e=e.right}else if(i>0)e=e.left;else{if(!(i<0))return 0;f=1,e=e.right}}return f}}(r.slabs,r.coordinates);return 0===d.length?s:function(a,b){return function(c){return a(c[0],c[1])?0:b(c)}}(e(d),s)};var g=a("robust-orientation")[3],h=a("slab-decomposition"),i=a("interval-tree-1d"),j=a("binary-search-bounds")},{"binary-search-bounds":92,"interval-tree-1d":415,"robust-orientation":511,"slab-decomposition":527}],474:[function(a,b,c){function d(a,b,c){var d=e.segments(a),f=e.segments(b),g=c(e.combine(d,f));return e.polygon(g)}var e,f=a("./lib/build-log"),g=a("./lib/epsilon"),h=a("./lib/intersecter"),i=a("./lib/segment-chainer"),j=a("./lib/segment-selector"),k=a("./lib/geojson"),l=!1,m=g();e={buildLog:function(a){return!0===a?l=f():!1===a&&(l=!1),!1!==l&&l.list},epsilon:function(a){return m.epsilon(a)},segments:function(a){var b=h(!0,m,l);return a.regions.forEach(b.addRegion),{segments:b.calculate(a.inverted),inverted:a.inverted}},combine:function(a,b){return{combined:h(!1,m,l).calculate(a.segments,a.inverted,b.segments,b.inverted),inverted1:a.inverted,inverted2:b.inverted}},selectUnion:function(a){return{segments:j.union(a.combined,l),inverted:a.inverted1||a.inverted2}},selectIntersect:function(a){return{segments:j.intersect(a.combined,l),inverted:a.inverted1&&a.inverted2}},selectDifference:function(a){return{segments:j.difference(a.combined,l),inverted:a.inverted1&&!a.inverted2}},selectDifferenceRev:function(a){return{segments:j.differenceRev(a.combined,l),inverted:!a.inverted1&&a.inverted2}},selectXor:function(a){return{segments:j.xor(a.combined,l),inverted:a.inverted1!==a.inverted2}},polygon:function(a){return{regions:i(a.segments,m,l),inverted:a.inverted}},polygonFromGeoJSON:function(a){return k.toPolygon(e,a)},polygonToGeoJSON:function(a){return k.fromPolygon(e,m,a)},union:function(a,b){return d(a,b,e.selectUnion)},intersect:function(a,b){return d(a,b,e.selectIntersect)},difference:function(a,b){return d(a,b,e.selectDifference)},differenceRev:function(a,b){return d(a,b,e.selectDifferenceRev)},xor:function(a,b){return d(a,b,e.selectXor)}},"object"==typeof window&&(window.PolyBool=e),b.exports=e},{"./lib/build-log":475,"./lib/epsilon":476,"./lib/geojson":477,"./lib/intersecter":478,"./lib/segment-chainer":480,"./lib/segment-selector":481}],475:[function(a,b,c){b.exports=function(){function a(a,c){return b.list.push({type:a,data:c?JSON.parse(JSON.stringify(c)):void 0}),b}var b,c=0,d=!1;return b={list:[],segmentId:function(){return c++},checkIntersection:function(b,c){return a("check",{seg1:b,seg2:c})},segmentChop:function(b,c){return a("div_seg",{seg:b,pt:c}),a("chop",{seg:b,pt:c})},statusRemove:function(b){return a("pop_seg",{seg:b})},segmentUpdate:function(b){return a("seg_update",{seg:b})},segmentNew:function(b,c){return a("new_seg",{seg:b,primary:c})},segmentRemove:function(b){return a("rem_seg",{seg:b})},tempStatus:function(b,c,d){return a("temp_status",{seg:b,above:c,below:d})},rewind:function(b){return a("rewind",{seg:b})},status:function(b,c,d){return a("status",{seg:b,above:c,below:d})},vert:function(c){return c===d?b:(d=c,a("vert",{x:c}))},log:function(b){
return"string"!=typeof b&&(b=JSON.stringify(b,!1,"  ")),a("log",{txt:b})},reset:function(){return a("reset")},selected:function(b){return a("selected",{segs:b})},chainStart:function(b){return a("chain_start",{seg:b})},chainRemoveHead:function(b,c){return a("chain_rem_head",{index:b,pt:c})},chainRemoveTail:function(b,c){return a("chain_rem_tail",{index:b,pt:c})},chainNew:function(b,c){return a("chain_new",{pt1:b,pt2:c})},chainMatch:function(b){return a("chain_match",{index:b})},chainClose:function(b){return a("chain_close",{index:b})},chainAddHead:function(b,c){return a("chain_add_head",{index:b,pt:c})},chainAddTail:function(b,c){return a("chain_add_tail",{index:b,pt:c})},chainConnect:function(b,c){return a("chain_con",{index1:b,index2:c})},chainReverse:function(b){return a("chain_rev",{index:b})},chainJoin:function(b,c){return a("chain_join",{index1:b,index2:c})},done:function(){return a("done")}}}},{}],476:[function(a,b,c){b.exports=function(a){"number"!=typeof a&&(a=1e-10);var b={epsilon:function(b){return"number"==typeof b&&(a=b),a},pointAboveOrOnLine:function(b,c,d){var e=c[0],f=c[1],g=d[0],h=d[1],i=b[0];return(g-e)*(b[1]-f)-(h-f)*(i-e)>=-a},pointBetween:function(b,c,d){var e=b[1]-c[1],f=d[0]-c[0],g=b[0]-c[0],h=d[1]-c[1],i=g*f+e*h;return!(i<a||i-(f*f+h*h)>-a)},pointsSameX:function(b,c){return Math.abs(b[0]-c[0])<a},pointsSameY:function(b,c){return Math.abs(b[1]-c[1])<a},pointsSame:function(a,c){return b.pointsSameX(a,c)&&b.pointsSameY(a,c)},pointsCompare:function(a,c){return b.pointsSameX(a,c)?b.pointsSameY(a,c)?0:a[1]<c[1]?-1:1:a[0]<c[0]?-1:1},pointsCollinear:function(b,c,d){var e=b[0]-c[0],f=b[1]-c[1],g=c[0]-d[0],h=c[1]-d[1];return Math.abs(e*h-g*f)<a},linesIntersect:function(b,c,d,e){var f=c[0]-b[0],g=c[1]-b[1],h=e[0]-d[0],i=e[1]-d[1],j=f*i-g*h;if(Math.abs(j)<a)return!1;var k=b[0]-d[0],l=b[1]-d[1],m=(h*l-i*k)/j,n=(f*l-g*k)/j,o={alongA:0,alongB:0,pt:[b[0]+m*f,b[1]+m*g]};return o.alongA=m<=-a?-2:m<a?-1:m-1<=-a?0:m-1<a?1:2,o.alongB=n<=-a?-2:n<a?-1:n-1<=-a?0:n-1<a?1:2,o},pointInsideRegion:function(b,c){for(var d=b[0],e=b[1],f=c[c.length-1][0],g=c[c.length-1][1],h=!1,i=0;i<c.length;i++){var j=c[i][0],k=c[i][1];k-e>a!=g-e>a&&(f-j)*(e-k)/(g-k)+j-d>a&&(h=!h),f=j,g=k}return h}};return b}},{}],477:[function(a,b,c){var d={toPolygon:function(a,b){function c(b){function c(b){var c=b.slice(0,b.length-1);return a.segments({inverted:!1,regions:[c]})}if(b.length<=0)return a.segments({inverted:!1,regions:[]});for(var d=c(b[0]),e=1;e<b.length;e++)d=a.selectDifference(a.combine(d,c(b[e])));return d}if("Polygon"===b.type)return a.polygon(c(b.coordinates));if("MultiPolygon"===b.type){for(var d=a.segments({inverted:!1,regions:[]}),e=0;e<b.coordinates.length;e++)d=a.selectUnion(a.combine(d,c(b.coordinates[e])));return a.polygon(d)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(a,b,c){function d(a,c){return b.pointInsideRegion([.5*(a[0][0]+a[1][0]),.5*(a[0][1]+a[1][1])],c)}function e(a){return{region:a,children:[]}}function f(a,b){for(var c=0;c<a.children.length;c++)if(d(b,(h=a.children[c]).region))return void f(h,b);var g=e(b);for(c=0;c<a.children.length;c++){var h;d((h=a.children[c]).region,b)&&(g.children.push(h),a.children.splice(c,1),c--)}a.children.push(g)}function g(a,b){for(var c=0,d=a[a.length-1][0],e=a[a.length-1][1],f=[],g=0;g<a.length;g++){var h=a[g][0],i=a[g][1];f.push([h,i]),c+=i*d-h*e,d=h,e=i}return c<0!==b&&f.reverse(),f.push([f[0][0],f[0][1]]),f}function h(a){var b=[g(a.region,!1)];m.push(b);for(var c=0;c<a.children.length;c++)b.push(i(a.children[c]))}function i(a){for(var b=0;b<a.children.length;b++)h(a.children[b]);return g(a.region,!0)}c=a.polygon(a.segments(c));for(var j=e(null),k=0;k<c.regions.length;k++){var l=c.regions[k];l.length<3||f(j,l)}var m=[];for(k=0;k<j.children.length;k++)h(j.children[k]);return m.length<=0?{type:"Polygon",coordinates:[]}:1==m.length?{type:"Polygon",coordinates:m[0]}:{type:"MultiPolygon",coordinates:m}}};b.exports=d},{}],478:[function(a,b,c){var d=a("./linked-list");b.exports=function(a,b,c){function e(a,b,d){return{id:c?c.segmentId():-1,start:a,end:b,myFill:{above:d.myFill.above,below:d.myFill.below},otherFill:null}}function f(a,c){j.insertBefore(a,function(d){return function(a,c,d,e,f,g){var h=b.pointsCompare(c,f);return 0!==h?h:b.pointsSame(d,g)?0:a!==e?a?1:-1:b.pointAboveOrOnLine(d,e?f:g,e?g:f)?1:-1}(a.isStart,a.pt,c,d.isStart,d.pt,d.other.pt)<0})}function g(a,b){var c=function(a,b){var c=d.node({isStart:!0,pt:a.start,seg:a,primary:b,other:null,status:null});return f(c,a.end),c}(a,b);return function(a,b,c){var e=d.node({isStart:!1,pt:b.end,seg:b,primary:c,other:a,status:null});a.other=e,f(e,a.pt)}(c,a,b),c}function h(a,b){var d=e(b,a.seg.end,a.seg);return function(a,b){c&&c.segmentChop(a.seg,b),a.other.remove(),a.seg.end=b,a.other.pt=b,f(a.other,a.pt)}(a,b),g(d,a.primary)}function i(e,f){function g(a,d){var e=a.seg,f=d.seg,g=e.start,i=e.end,j=f.start,k=f.end;c&&c.checkIntersection(e,f);var l=b.linesIntersect(g,i,j,k);if(!1===l){if(!b.pointsCollinear(g,i,j))return!1;if(b.pointsSame(g,k)||b.pointsSame(i,j))return!1;var m=b.pointsSame(g,j),n=b.pointsSame(i,k);if(m&&n)return d;var o=!m&&b.pointBetween(g,j,k),p=!n&&b.pointBetween(i,j,k);if(m)return p?h(d,i):h(a,k),d;o&&(n||(p?h(d,i):h(a,k)),h(d,g))}else 0===l.alongA&&(-1===l.alongB?h(a,j):0===l.alongB?h(a,l.pt):1===l.alongB&&h(a,k)),0===l.alongB&&(-1===l.alongA?h(d,g):0===l.alongA?h(d,l.pt):1===l.alongA&&h(d,i));return!1}for(var i=d.create(),k=[];!j.isEmpty();){var l=j.getHead();if(c&&c.vert(l.pt[0]),l.isStart){c&&c.segmentNew(l.seg,l.primary);var m=function(a){return i.findTransition(function(c){var d,e,f,g,h,i;return d=a,e=c.ev,f=d.seg.start,g=d.seg.end,h=e.seg.start,i=e.seg.end,(b.pointsCollinear(f,h,i)?b.pointsCollinear(g,h,i)?1:b.pointAboveOrOnLine(g,h,i)?1:-1:b.pointAboveOrOnLine(f,h,i)?1:-1)>0})}(l),n=m.before?m.before.ev:null,o=m.after?m.after.ev:null;c&&c.tempStatus(l.seg,!!n&&n.seg,!!o&&o.seg);var p,q,r=function(){if(n){var a=g(l,n);if(a)return a}return!!o&&g(l,o)}();if(r&&(a?(q=null===l.seg.myFill.below||l.seg.myFill.above!==l.seg.myFill.below)&&(r.seg.myFill.above=!r.seg.myFill.above):r.seg.otherFill=l.seg.myFill,c&&c.segmentUpdate(r.seg),l.other.remove(),l.remove()),j.getHead()!==l){c&&c.rewind(l.seg);continue}a?(q=null===l.seg.myFill.below||l.seg.myFill.above!==l.seg.myFill.below,l.seg.myFill.below=o?o.seg.myFill.above:e,l.seg.myFill.above=q?!l.seg.myFill.below:l.seg.myFill.below):null===l.seg.otherFill&&(p=o?l.primary===o.primary?o.seg.otherFill.above:o.seg.myFill.above:l.primary?f:e,l.seg.otherFill={above:p,below:p}),c&&c.status(l.seg,!!n&&n.seg,!!o&&o.seg),l.other.status=m.insert(d.node({ev:l}))}else{var s=l.status;if(null===s)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(i.exists(s.prev)&&i.exists(s.next)&&g(s.prev.ev,s.next.ev),c&&c.statusRemove(s.ev.seg),s.remove(),!l.primary){var t=l.seg.myFill;l.seg.myFill=l.seg.otherFill,l.seg.otherFill=t}k.push(l.seg)}j.getHead().remove()}return c&&c.done(),k}var j=d.create();return a?{addRegion:function(a){for(var d,e,f,h=a[a.length-1],i=0;i<a.length;i++){d=h,h=a[i];var j=b.pointsCompare(d,h);0!==j&&g((e=j<0?d:h,f=j<0?h:d,{id:c?c.segmentId():-1,start:e,end:f,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(a){return i(a,!1)}}:{calculate:function(a,b,c,d){return a.forEach(function(a){g(e(a.start,a.end,a),!0)}),c.forEach(function(a){g(e(a.start,a.end,a),!1)}),i(b,d)}}}},{"./linked-list":479}],479:[function(a,b,c){b.exports={create:function(){var a={root:{root:!0,next:null},exists:function(b){return null!==b&&b!==a.root},isEmpty:function(){return null===a.root.next},getHead:function(){return a.root.next},insertBefore:function(b,c){for(var d=a.root,e=a.root.next;null!==e;){if(c(e))return b.prev=e.prev,b.next=e,e.prev.next=b,void(e.prev=b);d=e,e=e.next}d.next=b,b.prev=d,b.next=null},findTransition:function(b){for(var c=a.root,d=a.root.next;null!==d&&!b(d);)c=d,d=d.next;return{before:c===a.root?null:c,after:d,insert:function(a){return a.prev=c,a.next=d,c.next=a,null!==d&&(d.prev=a),a}}}};return a},node:function(a){return a.prev=null,a.next=null,a.remove=function(){a.prev.next=a.next,a.next&&(a.next.prev=a.prev),a.prev=null,a.next=null},a}}},{}],480:[function(a,b,c){b.exports=function(a,b,c){var d=[],e=[];return a.forEach(function(a){function f(a,b,c){return m.index=a,m.matches_head=b,m.matches_pt1=c,m===k?(m=l,!1):(m=null,!0)}function g(a){c&&c.chainReverse(a),d[a].reverse()}function h(a,e){var f=d[a],g=d[e],h=f[f.length-1],i=f[f.length-2],j=g[0],k=g[1];b.pointsCollinear(i,h,j)&&(c&&c.chainRemoveTail(a,h),f.pop(),h=i),b.pointsCollinear(h,j,k)&&(c&&c.chainRemoveHead(e,j),g.shift()),c&&c.chainJoin(a,e),d[a]=f.concat(g),d.splice(e,1)}var i=a.start,j=a.end;if(b.pointsSame(i,j))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{c&&c.chainStart(a);for(var k={index:0,matches_head:!1,matches_pt1:!1},l={index:0,matches_head:!1,matches_pt1:!1},m=k,n=0;n<d.length;n++){var o=(t=d[n])[0],p=(t[1],t[t.length-1]);if(t[t.length-2],b.pointsSame(o,i)){if(f(n,!0,!0))break}else if(b.pointsSame(o,j)){if(f(n,!0,!1))break}else if(b.pointsSame(p,i)){if(f(n,!1,!0))break}else if(b.pointsSame(p,j)&&f(n,!1,!1))break}if(m===k)return d.push([i,j]),void(c&&c.chainNew(i,j));if(m===l){c&&c.chainMatch(k.index);var q=k.index,r=k.matches_pt1?j:i,s=k.matches_head,t=d[q],u=s?t[0]:t[t.length-1],v=s?t[1]:t[t.length-2],w=s?t[t.length-1]:t[0],x=s?t[t.length-2]:t[1];return b.pointsCollinear(v,u,r)&&(s?(c&&c.chainRemoveHead(k.index,r),t.shift()):(c&&c.chainRemoveTail(k.index,r),t.pop()),u=v),b.pointsSame(w,r)?(d.splice(q,1),b.pointsCollinear(x,w,u)&&(s?(c&&c.chainRemoveTail(k.index,u),t.pop()):(c&&c.chainRemoveHead(k.index,u),t.shift())),c&&c.chainClose(k.index),void e.push(t)):void(s?(c&&c.chainAddHead(k.index,r),t.unshift(r)):(c&&c.chainAddTail(k.index,r),t.push(r)))}var y=k.index,z=l.index;c&&c.chainConnect(y,z);var A=d[y].length<d[z].length;k.matches_head?l.matches_head?A?(g(y),h(y,z)):(g(z),h(z,y)):h(z,y):l.matches_head?h(y,z):A?(g(y),h(z,y)):(g(z),h(y,z))}}),e}},{}],481:[function(a,b,c){function d(a,b,c){var d=[];return a.forEach(function(a){var e=(a.myFill.above?8:0)+(a.myFill.below?4:0)+(a.otherFill&&a.otherFill.above?2:0)+(a.otherFill&&a.otherFill.below?1:0);0!==b[e]&&d.push({id:c?c.segmentId():-1,start:a.start,end:a.end,myFill:{above:1===b[e],below:2===b[e]},otherFill:null})}),c&&c.selected(d),d}var e={union:function(a,b){return d(a,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],b)},intersect:function(a,b){return d(a,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],b)},difference:function(a,b){return d(a,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],b)},differenceRev:function(a,b){return d(a,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],b)},xor:function(a,b){return d(a,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],b)}};b.exports=e},{}],482:[function(a,b,c){"use strict";var d=new Float64Array(4),e=new Float64Array(4),f=new Float64Array(4);b.exports=function(a,b,c,g,h){d.length<g.length&&(d=new Float64Array(g.length),e=new Float64Array(g.length),f=new Float64Array(g.length));for(var i=0;i<g.length;++i)d[i]=a[i]-g[i],e[i]=b[i]-a[i],f[i]=c[i]-a[i];var j=0,k=0,l=0,m=0,n=0,o=0;for(i=0;i<g.length;++i){var p=e[i],q=f[i],r=d[i];j+=p*p,k+=p*q,l+=q*q,m+=r*p,n+=r*q,o+=r*r}var s,t,u,v,w,x=Math.abs(j*l-k*k),y=k*n-l*m,z=k*m-j*n;if(y+z<=x)if(y<0)z<0&&m<0?(z=0,-m>=j?(y=1,s=j+2*m+o):s=m*(y=-m/j)+o):(y=0,n>=0?(z=0,s=o):-n>=l?(z=1,s=l+2*n+o):s=n*(z=-n/l)+o);else if(z<0)z=0,m>=0?(y=0,s=o):-m>=j?(y=1,s=j+2*m+o):s=m*(y=-m/j)+o;else{var A=1/x;s=(y*=A)*(j*y+k*(z*=A)+2*m)+z*(k*y+l*z+2*n)+o}else y<0?(u=l+n)>(t=k+m)?(v=u-t)>=(w=j-2*k+l)?(y=1,z=0,s=j+2*m+o):s=(y=v/w)*(j*y+k*(z=1-y)+2*m)+z*(k*y+l*z+2*n)+o:(y=0,u<=0?(z=1,s=l+2*n+o):n>=0?(z=0,s=o):s=n*(z=-n/l)+o):z<0?(u=j+m)>(t=k+n)?(v=u-t)>=(w=j-2*k+l)?(z=1,y=0,s=l+2*n+o):s=(y=1-(z=v/w))*(j*y+k*z+2*m)+z*(k*y+l*z+2*n)+o:(z=0,u<=0?(y=1,s=j+2*m+o):m>=0?(y=0,s=o):s=m*(y=-m/j)+o):(v=l+n-k-m)<=0?(y=0,z=1,s=l+2*n+o):v>=(w=j-2*k+l)?(y=1,z=0,s=j+2*m+o):s=(y=v/w)*(j*y+k*(z=1-y)+2*m)+z*(k*y+l*z+2*n)+o;var B=1-y-z;for(i=0;i<g.length;++i)h[i]=B*a[i]+y*b[i]+z*c[i];return s<0?0:s}},{}],483:[function(a,b,c){function d(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(a){if(k===setTimeout)return setTimeout(a,0);if((k===d||!k)&&setTimeout)return k=setTimeout,setTimeout(a,0);try{return k(a,0)}catch(b){try{return k.call(null,a,0)}catch(b){return k.call(this,a,0)}}}function g(){p&&n&&(p=!1,n.length?o=n.concat(o):q=-1,o.length&&h())}function h(){if(!p){var a=f(g);p=!0;for(var b=o.length;b;){for(n=o,o=[];++q<b;)n&&n[q].run();q=-1,b=o.length}n=null,p=!1,function(a){if(l===clearTimeout)return clearTimeout(a);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(a);try{l(a)}catch(b){try{return l.call(null,a)}catch(b){return l.call(this,a)}}}(a)}}function i(a,b){this.fun=a,this.array=b}function j(){}var k,l,m=b.exports={};!function(){try{k="function"==typeof setTimeout?setTimeout:d}catch(a){k=d}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(a){l=e}}();var n,o=[],p=!1,q=-1;m.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];o.push(new i(a,b)),1!==o.length||p||f(h)},i.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=j,m.addListener=j,m.once=j,m.off=j,m.removeListener=j,m.removeAllListeners=j,m.emit=j,m.prependListener=j,m.prependOnceListener=j,m.listeners=function(a){return[]},m.binding=function(a){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(a){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},{}],484:[function(a,b,c){b.exports=a("gl-quat/slerp")},{"gl-quat/slerp":294}],485:[function(a,b,c){(function(c){for(var d=a("performance-now"),e="undefined"==typeof window?c:window,f=["moz","webkit"],g="AnimationFrame",h=e["request"+g],i=e["cancel"+g]||e["cancelRequest"+g],j=0;!h&&j<f.length;j++)h=e[f[j]+"Request"+g],i=e[f[j]+"Cancel"+g]||e[f[j]+"CancelRequest"+g];if(!h||!i){var k=0,l=0,m=[];h=function(a){if(0===m.length){var b=d(),c=Math.max(0,1e3/60-(b-k));k=c+b,setTimeout(function(){var a=m.slice(0);m.length=0;for(var b=0;b<a.length;b++)if(!a[b].cancelled)try{a[b].callback(k)}catch(a){setTimeout(function(){throw a},0)}},Math.round(c))}return m.push({handle:++l,callback:a,cancelled:!1}),l},i=function(a){for(var b=0;b<m.length;b++)m[b].handle===a&&(m[b].cancelled=!0)}}b.exports=function(a){return h.call(e,a)},b.exports.cancel=function(){i.apply(e,arguments)},b.exports.polyfill=function(a){a||(a=e),a.requestAnimationFrame=h,a.cancelAnimationFrame=i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"performance-now":463}],486:[function(a,b,c){"use strict";var d=a("big-rat/add");b.exports=function(a,b){for(var c=a.length,e=new Array(c),f=0;f<c;++f)e[f]=d(a[f],b[f]);return e}},{"big-rat/add":76}],487:[function(a,b,c){"use strict";b.exports=function(a){for(var b=new Array(a.length),c=0;c<a.length;++c)b[c]=d(a[c]);return b};var d=a("big-rat")},{"big-rat":79}],488:[function(a,b,c){"use strict";var d=a("big-rat"),e=a("big-rat/mul");b.exports=function(a,b){for(var c=d(b),f=a.length,g=new Array(f),h=0;h<f;++h)g[h]=e(a[h],c);return g}},{"big-rat":79,"big-rat/mul":88}],489:[function(a,b,c){"use strict";var d=a("big-rat/sub");b.exports=function(a,b){for(var c=a.length,e=new Array(c),f=0;f<c;++f)e[f]=d(a[f],b[f]);return e}},{"big-rat/sub":90}],490:[function(a,b,c){"use strict";var d=a("compare-cell"),e=a("compare-oriented-cell"),f=a("cell-orientation");b.exports=function(a){a.sort(e);for(var b=a.length,c=0,g=0;g<b;++g){var h=a[g],i=f(h);if(0!==i){if(c>0){var j=a[c-1];if(0===d(h,j)&&f(j)!==i){c-=1;continue}}a[c++]=h}}return a.length=c,a}},{"cell-orientation":113,"compare-cell":129,"compare-oriented-cell":130}],491:[function(a,b,c){"use strict";var d=a("array-bounds"),e=a("color-normalize"),f=a("update-diff"),g=a("pick-by-alias"),h=a("object-assign"),i=a("flatten-vertex-data"),j=a("to-float32"),k=j.float32,l=j.fract32;b.exports=function(a,b){function c(a){a?o(a):null===a&&p(),j()}function j(b){if("number"==typeof b)return n(b);b&&!Array.isArray(b)&&(b=[b]),a._refresh(),y.forEach(function(a,c){a&&(b&&(b[c]?a.draw=!0:a.draw=!1),a.draw?n(c):a.draw=!0)})}function n(a){"number"==typeof a&&(a=y[a]),null!=a&&a&&a.count&&a.color&&a.opacity&&a.positions&&a.positions.length>1&&(a.scaleRatio=[a.scale[0]*a.viewport.width,a.scale[1]*a.viewport.height],q(a),a.after&&a.after(a))}function o(a){if(a){null!=a.length?"number"==typeof a[0]&&(a=[{positions:a}]):Array.isArray(a)||(a=[a]);var b=0,j=0;if(c.groups=y=a.map(function(a,c){var k=y[c];return a?("function"==typeof a?a={after:a}:"number"==typeof a[0]&&(a={positions:a}),a=g(a,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),k||(y[c]=k={id:c,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},a=h({},x,a)),f(k,a,[{lineWidth:function(a){return.5*+a},capSize:function(a){return.5*+a},opacity:parseFloat,errors:function(a){return a=i(a),j+=a.length,a},positions:function(a,c){return a=i(a,"float64"),c.count=Math.floor(a.length/2),c.bounds=d(a,2),c.offset=b,b+=c.count,a}},{color:function(a,b){var c=b.count;if(a||(a="transparent"),!Array.isArray(a)||"number"==typeof a[0]){var d=a;a=Array(c);for(var f=0;f<c;f++)a[f]=d}if(a.length<c)throw Error("Not enough colors");for(var g=new Uint8Array(4*c),h=0;h<c;h++){var i=e(a[h],"uint8");g.set(i,4*h)}return g},range:function(a,b,c){var d=b.bounds;return a||(a=d),b.scale=[1/(a[2]-a[0]),1/(a[3]-a[1])],b.translate=[-a[0],-a[1]],b.scaleFract=l(b.scale),b.translateFract=l(b.translate),a},viewport:function(a){var b;return Array.isArray(a)?b={x:a[0],y:a[1],width:a[2]-a[0],height:a[3]-a[1]}:a?(b={x:a.x||a.left||0,y:a.y||a.top||0},a.right?b.width=a.right-b.x:b.width=a.w||a.width||0,a.bottom?b.height=a.bottom-b.y:b.height=a.h||a.height||0):b={x:0,y:0,width:w.drawingBufferWidth,height:w.drawingBufferHeight},b}}]),k):k}),b||j){var m=y.reduce(function(a,b,c){return a+(b?b.count:0)},0),n=new Float64Array(2*m),o=new Uint8Array(4*m),p=new Float32Array(4*m);y.forEach(function(a,b){if(a){var c=a.positions,d=a.count,e=a.offset,f=a.color,g=a.errors;d&&(o.set(f,4*e),p.set(g,4*e),n.set(c,2*e))}}),r(k(n)),s(l(n)),t(o),u(p)}}}function p(){r.destroy(),s.destroy(),t.destroy(),u.destroy(),v.destroy()}if("function"==typeof a?(b||(b={}),b.regl=a):b=a,b.length&&(b.positions=b),!(a=b.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var q,r,s,t,u,v,w=a._gl,x={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},y=[];return t=a.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),r=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),s=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),u=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),v=a.buffer({usage:"static",type:"float",data:m}),o(b),q=a({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:a.prop("range"),lineWidth:a.prop("lineWidth"),capSize:a.prop("capSize"),opacity:a.prop("opacity"),scale:a.prop("scale"),translate:a.prop("translate"),scaleFract:a.prop("scaleFract"),translateFract:a.prop("translateFract"),viewport:function(a,b){return[b.viewport.x,b.viewport.y,a.viewportWidth,a.viewportHeight]}},attributes:{color:{buffer:t,offset:function(a,b){return 4*b.offset},divisor:1},position:{buffer:r,offset:function(a,b){return 8*b.offset},divisor:1},positionFract:{buffer:s,offset:function(a,b){return 8*b.offset},divisor:1},error:{buffer:u,offset:function(a,b){return 16*b.offset},divisor:1},direction:{buffer:v,stride:24,offset:0},lineOffset:{buffer:v,stride:24,offset:8},capOffset:{buffer:v,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:a.prop("viewport")},viewport:a.prop("viewport"),stencil:!1,instances:a.prop("count"),count:m.length}),h(c,{update:o,draw:j,destroy:p,regl:a,gl:w,canvas:w.canvas,groups:y}),c};var m=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":66,"color-normalize":121,"flatten-vertex-data":228,"object-assign":455,"pick-by-alias":466,"to-float32":539,"update-diff":550}],492:[function(a,b,c){"use strict";function d(a,b){if(!(this instanceof d))return new d(a,b);if("function"==typeof a?(b||(b={}),b.regl=a):b=a,b.length&&(b.positions=b),!(a=b.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=a._gl,this.regl=a,this.passes=[],this.shaders=d.shaders.has(a)?d.shaders.get(a):d.shaders.set(a,d.createShaders(a)).get(a),this.update(b)}var e=a("color-normalize"),f=a("array-bounds"),g=a("object-assign"),h=a("glslify"),i=a("pick-by-alias"),j=a("flatten-vertex-data"),k=a("earcut"),l=a("array-normalize"),m=a("to-float32"),n=m.float32,o=m.fract32,p=a("es6-weak-map"),q=a("parse-rect");b.exports=d,d.dashMult=2,d.maxPatternLength=256,d.precisionThreshold=3e6,d.maxPoints=1e4,d.maxLines=2048,d.shaders=new p,d.createShaders=function(a){var b,c=a.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),d={primitive:"triangle strip",instances:a.prop("count"),count:4,offset:0,uniforms:{miterMode:function(a,b){return"round"===b.join?2:1},miterLimit:a.prop("miterLimit"),scale:a.prop("scale"),scaleFract:a.prop("scaleFract"),translateFract:a.prop("translateFract"),translate:a.prop("translate"),thickness:a.prop("thickness"),dashPattern:a.prop("dashTexture"),opacity:a.prop("opacity"),pixelRatio:a.context("pixelRatio"),id:a.prop("id"),dashSize:a.prop("dashLength"),viewport:function(a,b){return[b.viewport.x,b.viewport.y,a.viewportWidth,a.viewportHeight]},depth:a.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(a,b){return!b.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:a.prop("viewport")},viewport:a.prop("viewport")},e=a(g({vert:h(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scale * viewport.zw);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:h(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\n\nuniform float dashSize, pixelRatio, thickness, opacity, id;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:c,divisor:0,stride:8,offset:0},lineTop:{buffer:c,divisor:0,stride:8,offset:4},aCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:a.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:a.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:a.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},d));try{b=a(g({cull:{enable:!0,face:"back"},
vert:h(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t// collapsed/unidirectional segment cases\n\t// FIXME: there should be more elegant solution\n\tvec2 prevTanDiff = abs(prevTangent - currTangent);\n\tvec2 nextTanDiff = abs(nextTangent - currTangent);\n\tif (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n\tvec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n\tvec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:h(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\nuniform float dashSize, pixelRatio, thickness, opacity, id, miterMode;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:c,divisor:0,stride:8,offset:0},lineTop:{buffer:c,divisor:0,stride:8,offset:4},aColor:{buffer:a.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:a.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},d))}catch(a){b=e}return{fill:a({primitive:"triangle",elements:function(a,b){return b.triangles},offset:0,vert:h(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n}\n"]),frag:h(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n}\n"]),uniforms:{scale:a.prop("scale"),color:a.prop("fill"),scaleFract:a.prop("scaleFract"),translateFract:a.prop("translateFract"),translate:a.prop("translate"),opacity:a.prop("opacity"),pixelRatio:a.context("pixelRatio"),id:a.prop("id"),viewport:function(a,b){return[b.viewport.x,b.viewport.y,a.viewportWidth,a.viewportHeight]}},attributes:{position:{buffer:a.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:a.prop("positionFractBuffer"),stride:8,offset:8}},blend:d.blend,depth:{enable:!1},scissor:d.scissor,stencil:d.stencil,viewport:d.viewport}),rect:e,miter:b}},d.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},d.prototype.render=function(){for(var a,b=[],c=arguments.length;c--;)b[c]=arguments[c];b.length&&(a=this).update.apply(a,b),this.draw()},d.prototype.draw=function(){for(var a=this,b=[],c=arguments.length;c--;)b[c]=arguments[c];return(b.length?b:this.passes).forEach(function(b,c){var e;if(b&&Array.isArray(b))return(e=a).draw.apply(e,b);"number"==typeof b&&(b=a.passes[b]),b&&b.count>1&&b.opacity&&(a.regl._refresh(),b.fill&&b.triangles&&b.triangles.length>2&&a.shaders.fill(b),b.thickness&&(b.scale[0]*b.viewport.width>d.precisionThreshold||b.scale[1]*b.viewport.height>d.precisionThreshold?a.shaders.rect(b):"rect"===b.join||!b.join&&(b.thickness<=2||b.count>=d.maxPoints)?a.shaders.rect(b):a.shaders.miter(b)))}),this},d.prototype.update=function(a){var b=this;if(a){null!=a.length?"number"==typeof a[0]&&(a=[{positions:a}]):Array.isArray(a)||(a=[a]);var c=this.regl,h=this.gl;if(a.forEach(function(a,m){var p=b.passes[m];if(void 0!==a)if(null!==a){if("number"==typeof a[0]&&(a={positions:a}),a=i(a,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow"}),p||(b.passes[m]=p={id:m,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:c.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:c.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:c.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:c.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},a=g({},d.defaults,a)),null!=a.thickness&&(p.thickness=parseFloat(a.thickness)),null!=a.opacity&&(p.opacity=parseFloat(a.opacity)),null!=a.miterLimit&&(p.miterLimit=parseFloat(a.miterLimit)),null!=a.overlay&&(p.overlay=!!a.overlay,m<d.maxLines&&(p.depth=2*(d.maxLines-1-m%d.maxLines)/d.maxLines-1)),null!=a.join&&(p.join=a.join),null!=a.hole&&(p.hole=a.hole),null!=a.fill&&(p.fill=a.fill?e(a.fill,"uint8"):null),null!=a.viewport&&(p.viewport=q(a.viewport)),p.viewport||(p.viewport=q([h.drawingBufferWidth,h.drawingBufferHeight])),null!=a.close&&(p.close=a.close),null===a.positions&&(a.positions=[]),a.positions){var r,s;if(a.positions.x&&a.positions.y){var t=a.positions.x,u=a.positions.y;s=p.count=Math.max(t.length,u.length),r=new Float64Array(2*s);for(var v=0;v<s;v++)r[2*v]=t[v],r[2*v+1]=u[v]}else r=j(a.positions,"float64"),s=p.count=Math.floor(r.length/2);var w=p.bounds=f(r,2);if(p.fill){for(var x=[],y={},z=0,A=0,B=0,C=p.count;A<C;A++){var D=r[2*A],E=r[2*A+1];isNaN(D)||isNaN(E)||null==D||null==E?(D=r[2*z],E=r[2*z+1],y[A]=z):z=A,x[B++]=D,x[B++]=E}for(var F=k(x,p.hole||[]),G=0,H=F.length;G<H;G++)null!=y[F[G]]&&(F[G]=y[F[G]]);p.triangles=F}var I=new Float64Array(r);l(I,2,w);var J=new Float64Array(2*s+6);p.close?r[0]===r[2*s-2]&&r[1]===r[2*s-1]?(J[0]=I[2*s-4],J[1]=I[2*s-3]):(J[0]=I[2*s-2],J[1]=I[2*s-1]):(J[0]=I[0],J[1]=I[1]),J.set(I,2),p.close?r[0]===r[2*s-2]&&r[1]===r[2*s-1]?(J[2*s+2]=I[2],J[2*s+3]=I[3],p.count-=1):(J[2*s+2]=I[0],J[2*s+3]=I[1],J[2*s+4]=I[2],J[2*s+5]=I[3]):(J[2*s+2]=I[2*s-2],J[2*s+3]=I[2*s-1],J[2*s+4]=I[2*s-2],J[2*s+5]=I[2*s-1]),p.positionBuffer(n(J)),p.positionFractBuffer(o(J))}if(a.range?p.range=a.range:p.range||(p.range=p.bounds),(a.range||a.positions)&&p.count){var K=p.bounds,L=K[2]-K[0],M=K[3]-K[1],N=p.range[2]-p.range[0],O=p.range[3]-p.range[1];p.scale=[L/N,M/O],p.translate=[-p.range[0]/N+K[0]/N||0,-p.range[1]/O+K[1]/O||0],p.scaleFract=o(p.scale),p.translateFract=o(p.translate)}if(a.dashes){var P,Q=0;if(!a.dashes||a.dashes.length<2)Q=1,P=new Uint8Array([255,255,255,255,255,255,255,255]);else{Q=0;for(var R=0;R<a.dashes.length;++R)Q+=a.dashes[R];P=new Uint8Array(Q*d.dashMult);for(var S=0,T=255,U=0;U<2;U++)for(var V=0;V<a.dashes.length;++V){for(var W=0,X=a.dashes[V]*d.dashMult*.5;W<X;++W)P[S++]=T;T^=255}}p.dashLength=Q,p.dashTexture({channels:1,data:P,width:P.length,height:1,mag:"linear",min:"linear"},0,0)}if(a.color){var Y=p.count,Z=a.color;Z||(Z="transparent");var $=new Uint8Array(4*Y+4);if(Array.isArray(Z)&&"number"!=typeof Z[0]){for(var _=0;_<Y;_++){var aa=e(Z[_],"uint8");$.set(aa,4*_)}$.set(e(Z[0],"uint8"),4*Y)}else for(var ba=e(Z,"uint8"),ca=0;ca<Y+1;ca++)$.set(ba,4*ca);p.colorBuffer({usage:"dynamic",type:"uint8",data:$})}}else b.passes[m]=null}),a.length<this.passes.length){for(var m=a.length;m<this.passes.length;m++){var p=b.passes[m];p&&(p.colorBuffer.destroy(),p.positionBuffer.destroy(),p.dashTexture.destroy())}this.passes.length=a.length}for(var r=[],s=0;s<this.passes.length;s++)null!==b.passes[s]&&r.push(b.passes[s]);return this.passes=r,this}},d.prototype.destroy=function(){return this.passes.forEach(function(a){a.colorBuffer.destroy(),a.positionBuffer.destroy(),a.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":66,"array-normalize":67,"color-normalize":121,earcut:493,"es6-weak-map":494,"flatten-vertex-data":228,glslify:410,"object-assign":455,"parse-rect":460,"pick-by-alias":466,"to-float32":539}],493:[function(a,b,c){"use strict";function d(a,b,c){c=c||2;var d,h,i,j,k,n,p,q=b&&b.length,r=q?b[0]*c:a.length,s=e(a,0,r,c,!0),t=[];if(!s||s.next===s.prev)return t;if(q&&(s=function(a,b,c,d){var g,h,i,j,k,n=[];for(g=0,h=b.length;g<h;g++)i=b[g]*d,j=g<h-1?b[g+1]*d:a.length,(k=e(a,i,j,d,!1))===k.next&&(k.steiner=!0),n.push(o(k));for(n.sort(l),g=0;g<n.length;g++)m(n[g],c),c=f(c,c.next);return c}(a,b,s,c)),a.length>80*c){d=i=a[0],h=j=a[1];for(var u=c;u<r;u+=c)(k=a[u])<d&&(d=k),(n=a[u+1])<h&&(h=n),k>i&&(i=k),n>j&&(j=n);p=0!==(p=Math.max(i-d,j-h))?1/p:0}return g(s,t,c,d,h,p),t}function e(a,b,c,d,e){var f,g;if(e===z(a,b,c,d)>0)for(f=b;f<c;f+=d)g=w(f,a[f],a[f+1],g);else for(f=c-d;f>=b;f-=d)g=w(f,a[f],a[f+1],g);return g&&s(g,g.next)&&(x(g),g=g.next),g}function f(a,b){if(!a)return a;b||(b=a);var c,d=a;do{if(c=!1,d.steiner||!s(d,d.next)&&0!==r(d.prev,d,d.next))d=d.next;else{if(x(d),(d=b=d.prev)===d.next)break;c=!0}}while(c||d!==b);return b}function g(a,b,c,d,e,l,m){if(a){!m&&l&&function(a,b,c,d){var e=a;do{null===e.z&&(e.z=n(e.x,e.y,b,c,d)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next}while(e!==a);e.prevZ.nextZ=null,e.prevZ=null,function(a){var b,c,d,e,f,g,h,i,j=1;do{for(c=a,a=null,f=null,g=0;c;){for(g++,d=c,h=0,b=0;b<j&&(h++,d=d.nextZ);b++);for(i=j;h>0||i>0&&d;)0!==h&&(0===i||!d||c.z<=d.z)?(e=c,c=c.nextZ,h--):(e=d,d=d.nextZ,i--),f?f.nextZ=e:a=e,e.prevZ=f,f=e;c=d}f.nextZ=null,j*=2}while(g>1)}(e)}(a,d,e,l);for(var o,p,q=a;a.prev!==a.next;)if(o=a.prev,p=a.next,l?i(a,d,e,l):h(a))b.push(o.i/c),b.push(a.i/c),b.push(p.i/c),x(a),a=p.next,q=p.next;else if((a=p)===q){m?1===m?g(a=j(a,b,c),b,c,d,e,l,2):2===m&&k(a,b,c,d,e,l):g(f(a),b,c,d,e,l,1);break}}}function h(a){var b=a.prev,c=a,d=a.next;if(r(b,c,d)>=0)return!1;for(var e=a.next.next;e!==a.prev;){if(p(b.x,b.y,c.x,c.y,d.x,d.y,e.x,e.y)&&r(e.prev,e,e.next)>=0)return!1;e=e.next}return!0}function i(a,b,c,d){var e=a.prev,f=a,g=a.next;if(r(e,f,g)>=0)return!1;for(var h=e.x<f.x?e.x<g.x?e.x:g.x:f.x<g.x?f.x:g.x,i=e.y<f.y?e.y<g.y?e.y:g.y:f.y<g.y?f.y:g.y,j=e.x>f.x?e.x>g.x?e.x:g.x:f.x>g.x?f.x:g.x,k=e.y>f.y?e.y>g.y?e.y:g.y:f.y>g.y?f.y:g.y,l=n(h,i,b,c,d),m=n(j,k,b,c,d),o=a.prevZ,q=a.nextZ;o&&o.z>=l&&q&&q.z<=m;){if(o!==a.prev&&o!==a.next&&p(e.x,e.y,f.x,f.y,g.x,g.y,o.x,o.y)&&r(o.prev,o,o.next)>=0)return!1;if(o=o.prevZ,q!==a.prev&&q!==a.next&&p(e.x,e.y,f.x,f.y,g.x,g.y,q.x,q.y)&&r(q.prev,q,q.next)>=0)return!1;q=q.nextZ}for(;o&&o.z>=l;){if(o!==a.prev&&o!==a.next&&p(e.x,e.y,f.x,f.y,g.x,g.y,o.x,o.y)&&r(o.prev,o,o.next)>=0)return!1;o=o.prevZ}for(;q&&q.z<=m;){if(q!==a.prev&&q!==a.next&&p(e.x,e.y,f.x,f.y,g.x,g.y,q.x,q.y)&&r(q.prev,q,q.next)>=0)return!1;q=q.nextZ}return!0}function j(a,b,c){var d=a;do{var e=d.prev,f=d.next.next;!s(e,f)&&t(e,d,d.next,f)&&u(e,f)&&u(f,e)&&(b.push(e.i/c),b.push(d.i/c),b.push(f.i/c),x(d),x(d.next),d=a=f),d=d.next}while(d!==a);return d}function k(a,b,c,d,e,h){var i=a;do{for(var j=i.next.next;j!==i.prev;){if(i.i!==j.i&&q(i,j)){var k=v(i,j);return i=f(i,i.next),k=f(k,k.next),g(i,b,c,d,e,h),void g(k,b,c,d,e,h)}j=j.next}i=i.next}while(i!==a)}function l(a,b){return a.x-b.x}function m(a,b){if(b=function(a,b){var c,d=b,e=a.x,f=a.y,g=-1/0;do{if(f<=d.y&&f>=d.next.y&&d.next.y!==d.y){var h=d.x+(f-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(h<=e&&h>g){if(g=h,h===e){if(f===d.y)return d;if(f===d.next.y)return d.next}c=d.x<d.next.x?d:d.next}}d=d.next}while(d!==b);if(!c)return null;if(e===g)return c.prev;var i,j=c,k=c.x,l=c.y,m=1/0;for(d=c.next;d!==j;)e>=d.x&&d.x>=k&&e!==d.x&&p(f<l?e:g,f,k,l,f<l?g:e,f,d.x,d.y)&&((i=Math.abs(f-d.y)/(e-d.x))<m||i===m&&d.x>c.x)&&u(d,a)&&(c=d,m=i),d=d.next;return c}(a,b)){var c=v(b,a);f(c,c.next)}}function n(a,b,c,d,e){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-c)*e)|a<<8))|a<<4))|a<<2))|a<<1))|(b=1431655765&((b=858993459&((b=252645135&((b=16711935&((b=32767*(b-d)*e)|b<<8))|b<<4))|b<<2))|b<<1))<<1}function o(a){var b=a,c=a;do{(b.x<c.x||b.x===c.x&&b.y<c.y)&&(c=b),b=b.next}while(b!==a);return c}function p(a,b,c,d,e,f,g,h){return(e-g)*(b-h)-(a-g)*(f-h)>=0&&(a-g)*(d-h)-(c-g)*(b-h)>=0&&(c-g)*(f-h)-(e-g)*(d-h)>=0}function q(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!function(a,b){var c=a;do{if(c.i!==a.i&&c.next.i!==a.i&&c.i!==b.i&&c.next.i!==b.i&&t(c,c.next,a,b))return!0;c=c.next}while(c!==a);return!1}(a,b)&&u(a,b)&&u(b,a)&&function(a,b){var c=a,d=!1,e=(a.x+b.x)/2,f=(a.y+b.y)/2;do{c.y>f!=c.next.y>f&&c.next.y!==c.y&&e<(c.next.x-c.x)*(f-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next}while(c!==a);return d}(a,b)}function r(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function s(a,b){return a.x===b.x&&a.y===b.y}function t(a,b,c,d){return!!(s(a,b)&&s(c,d)||s(a,d)&&s(c,b))||r(a,b,c)>0!=r(a,b,d)>0&&r(c,d,a)>0!=r(c,d,b)>0}function u(a,b){return r(a.prev,a,a.next)<0?r(a,b,a.next)>=0&&r(a,a.prev,b)>=0:r(a,b,a.prev)<0||r(a,a.next,b)<0}function v(a,b){var c=new y(a.i,a.x,a.y),d=new y(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,c.next=e,e.prev=c,d.next=c,c.prev=d,f.next=d,d.prev=f,d}function w(a,b,c,d){var e=new y(a,b,c);return d?(e.next=d.next,e.prev=d,d.next.prev=e,d.next=e):(e.prev=e,e.next=e),e}function x(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function y(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function z(a,b,c,d){for(var e=0,f=b,g=c-d;f<c;f+=d)e+=(a[g]-a[f])*(a[f+1]+a[g+1]),g=f;return e}b.exports=d,b.exports.default=d,d.deviation=function(a,b,c,d){var e=b&&b.length,f=e?b[0]*c:a.length,g=Math.abs(z(a,0,f,c));if(e)for(var h=0,i=b.length;h<i;h++){var j=b[h]*c,k=h<i-1?b[h+1]*c:a.length;g-=Math.abs(z(a,j,k,c))}var l=0;for(h=0;h<d.length;h+=3){var m=d[h]*c,n=d[h+1]*c,o=d[h+2]*c;l+=Math.abs((a[m]-a[o])*(a[n+1]-a[m+1])-(a[m]-a[n])*(a[o+1]-a[m+1]))}return 0===g&&0===l?0:Math.abs((l-g)/g)},d.flatten=function(a){for(var b=a[0][0].length,c={vertices:[],holes:[],dimensions:b},d=0,e=0;e<a.length;e++){for(var f=0;f<a[e].length;f++)for(var g=0;g<b;g++)c.vertices.push(a[e][f][g]);e>0&&(d+=a[e-1].length,c.holes.push(d))}return c}},{}],494:[function(a,b,c){arguments[4][319][0].apply(c,arguments)},{"./is-implemented":495,"./polyfill":497,dup:319}],495:[function(a,b,c){arguments[4][320][0].apply(c,arguments)},{dup:320}],496:[function(a,b,c){arguments[4][321][0].apply(c,arguments)},{dup:321}],497:[function(a,b,c){arguments[4][322][0].apply(c,arguments)},{"./is-native-implemented":496,d:152,dup:322,"es5-ext/object/is-value":195,"es5-ext/object/set-prototype-of":201,"es5-ext/object/valid-object":205,"es5-ext/object/valid-value":206,"es5-ext/string/random-uniq":211,"es6-iterator/for-of":213,"es6-iterator/get":214,"es6-symbol":220}],498:[function(a,b,c){"use strict";function d(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h.return||h.return()}finally{if(e)throw f}}return c}(a,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function e(a){return function(a){if(Array.isArray(a)){for(var b=0,c=new Array(a.length);b<a.length;b++)c[b]=a[b];return c}}(a)||function(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(a,b){var c=this;if(!(this instanceof f))return new f(a,b);"function"==typeof a?(b||(b={}),b.regl=a):(b=a,a=null),b&&b.length&&(b.positions=b);var d,e=(a=b.regl)._gl,g=[];this.tooManyColors=p,d=a.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),k(this,{regl:a,gl:e,groups:[],markerCache:[null],markerTextures:[null],palette:g,paletteIds:{},paletteTexture:d,maxColors:255,maxSize:100,canvas:e.canvas}),this.update(b);var h={uniforms:{pixelRatio:a.context("pixelRatio"),palette:d,paletteSize:function(a,b){return[c.tooManyColors?0:255,d.height]},scale:a.prop("scale"),scaleFract:a.prop("scaleFract"),translate:a.prop("translate"),translateFract:a.prop("translateFract"),opacity:a.prop("opacity"),marker:a.prop("markerTexture")},attributes:{x:function(a,b){return b.xAttr||{buffer:b.positionBuffer,stride:8,offset:0}},y:function(a,b){return b.yAttr||{buffer:b.positionBuffer,stride:8,offset:4}},xFract:function(a,b){return b.xAttr?{constant:[0,0]}:{buffer:b.positionFractBuffer,stride:8,offset:0}},yFract:function(a,b){return b.yAttr?{constant:[0,0]}:{buffer:b.positionFractBuffer,stride:8,offset:4}},size:function(a,b){return b.size.length?{buffer:b.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*b.size/c.maxSize)]}},borderSize:function(a,b){return b.borderSize.length?{buffer:b.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*b.borderSize/c.maxSize)]}},colorId:function(a,b){return b.color.length?{buffer:b.colorBuffer,stride:c.tooManyColors?8:4,offset:0}:{constant:c.tooManyColors?g.slice(4*b.color,4*b.color+4):[b.color]}},borderColorId:function(a,b){return b.borderColor.length?{buffer:b.colorBuffer,stride:c.tooManyColors?8:4,offset:c.tooManyColors?4:2}:{constant:c.tooManyColors?g.slice(4*b.borderColor,4*b.borderColor+4):[b.borderColor]}},isActive:function(a,b){return!0===b.activation?{constant:[1]}:b.activation?b.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:a.prop("viewport")},viewport:a.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:a.prop("elements"),count:a.prop("count"),offset:a.prop("offset"),primitive:"points"},i=k({},h);i.frag=l(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nuniform sampler2D marker;\nuniform float pixelRatio, opacity;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(marker, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]),i.vert=l(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform float pixelRatio;\nuniform sampler2D palette;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pixelRatio;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]),this.drawMarker=a(i);var j=k({},h);j.frag=l(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\n\nuniform float opacity;\nvarying float fragBorderRadius, fragWidth;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n\tfloat t;\n\tt = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n\treturn t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif (radius > 1.0 + delta) {\n\t\tdiscard;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]),
j.vert=l(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio;\nuniform sampler2D palette;\nuniform vec2 paletteSize;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]),p&&(j.frag=j.frag.replace("smoothstep","smoothStep"),i.frag=i.frag.replace("smoothstep","smoothStep")),this.drawCircle=a(j)}var g=a("color-normalize"),h=a("array-bounds"),i=a("color-id"),j=a("point-cluster"),k=a("object-assign"),l=a("glslify"),m=a("pick-by-alias"),n=a("update-diff"),o=a("flatten-vertex-data"),p=a("is-iexplorer"),q=a("to-float32"),r=a("parse-rect"),s=f;f.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},f.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},f.prototype.draw=function(){for(var a=this,b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];var e=this.groups;if(1===c.length&&Array.isArray(c[0])&&(null===c[0][0]||Array.isArray(c[0][0]))&&(c=c[0]),this.regl._refresh(),c.length)for(var f=0;f<c.length;f++)this.drawItem(f,c[f]);else e.forEach(function(b,c){a.drawItem(c)});return this},f.prototype.drawItem=function(a,b){var c=this.groups,d=c[a];if("number"==typeof b&&(a=b,d=c[b],b=null),d&&d.count&&d.opacity){d.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,d,b));for(var f=[],g=1;g<d.activation.length;g++)d.activation[g]&&(!0===d.activation[g]||d.activation[g].data.length)&&f.push.apply(f,e(this.getMarkerDrawOptions(g,d,b)));f.length&&this.drawMarker(f)}},f.prototype.getMarkerDrawOptions=function(a,b,c){var e=b.range,f=b.tree,g=b.viewport,h=b.activation,i=b.selectionBuffer,j=b.count;if(this.regl,!f)return c?[k({},b,{markerTexture:this.markerTextures[a],activation:h[a],count:c.length,elements:c,offset:0})]:[k({},b,{markerTexture:this.markerTextures[a],activation:h[a],offset:0})];var l=[],m=f.range(e,{lod:!0,px:[(e[2]-e[0])/g.width,(e[3]-e[1])/g.height]});if(c){for(var n=h[a].data,o=new Uint8Array(j),p=0;p<c.length;p++){var q=c[p];o[q]=n?n[q]:1}i.subdata(o)}for(var r=m.length;r--;){var s=d(m[r],2),t=s[0],u=s[1];l.push(k({},b,{markerTexture:this.markerTextures[a],activation:c?i:h[a],offset:t,count:u-t}))}return l},f.prototype.update=function(){for(var a=this,b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];if(c.length){1===c.length&&Array.isArray(c[0])&&(c=c[0]);var e=this.groups,g=this.gl,i=this.regl,l=this.maxSize,p=this.maxColors,s=this.palette;this.groups=e=c.map(function(b,c){var d=e[c];if(void 0===b)return d;null===b?b={positions:null}:"function"==typeof b?b={ondraw:b}:"number"==typeof b[0]&&(b={positions:b}),null===(b=m(b,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions&&(b.positions=[]),null!=b.tooManyColors&&(a.tooManyColors=b.tooManyColors),d||(e[c]=d={id:c,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:i.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:i.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:i.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:i.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:i.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},b=k({},f.defaults,b)),!b.positions||"marker"in b||(b.marker=d.marker,delete d.marker),!b.marker||"positions"in b||(b.positions=d.positions,delete d.positions);var t=0,u=0;if(n(d,b,[{snap:!0,size:function(a,b){return null==a&&(a=f.defaults.size),t+=a&&a.length?1:0,a},borderSize:function(a,b){return null==a&&(a=f.defaults.borderSize),t+=a&&a.length?1:0,a},opacity:parseFloat,color:function(b,c){return null==b&&(b=f.defaults.color),b=a.updateColor(b),u++,b},borderColor:function(b,c){return null==b&&(b=f.defaults.borderColor),b=a.updateColor(b),u++,b},bounds:function(a,b,c){return"range"in c||(c.range=null),a},positions:function(a,b,c){var d=b.snap,e=b.positionBuffer,f=b.positionFractBuffer,g=b.selectionBuffer;if(a.x||a.y)return a.x.length?b.xAttr={buffer:i.buffer(a.x),offset:0,stride:4,count:a.x.length}:b.xAttr={buffer:a.x.buffer,offset:4*a.x.offset||0,stride:4*(a.x.stride||1),count:a.x.count},a.y.length?b.yAttr={buffer:i.buffer(a.y),offset:0,stride:4,count:a.y.length}:b.yAttr={buffer:a.y.buffer,offset:4*a.y.offset||0,stride:4*(a.y.stride||1),count:a.y.count},b.count=Math.max(b.xAttr.count,b.yAttr.count),a;a=o(a,"float64");var k=b.count=Math.floor(a.length/2),l=b.bounds=k?h(a,2):null;if(c.range||b.range||(delete b.range,c.range=l),c.marker||b.marker||(delete b.marker,c.marker=null),d&&(!0===d||k>d)?b.tree=j(a,{bounds:l}):d&&d.length&&(b.tree=d),b.tree){var m={primitive:"points",usage:"static",data:b.tree,type:"uint32"};b.elements?b.elements(m):b.elements=i.elements(m)}return e({data:q.float(a),usage:"dynamic"}),f({data:q.fract(a),usage:"dynamic"}),g({data:new Uint8Array(k),type:"uint8",usage:"stream"}),a}},{marker:function(b,c,d){var e=c.activation;if(e.forEach(function(a){return a&&a.destroy&&a.destroy()}),e.length=0,b&&"number"!=typeof b[0]){for(var f=[],g=0,h=Math.min(b.length,c.count);g<h;g++){var j=a.addMarker(b[g]);f[j]||(f[j]=new Uint8Array(c.count)),f[j][g]=1}for(var k=0;k<f.length;k++)if(f[k]){var l={data:f[k],type:"uint8",usage:"static"};e[k]?e[k](l):e[k]=i.buffer(l),e[k].data=f[k]}}else e[a.addMarker(b)]=!0;return b},range:function(a,b,c){var d=b.bounds;if(d)return a||(a=d),b.scale=[1/(a[2]-a[0]),1/(a[3]-a[1])],b.translate=[-a[0],-a[1]],b.scaleFract=q.fract(b.scale),b.translateFract=q.fract(b.translate),a},viewport:function(a){return r(a||[g.drawingBufferWidth,g.drawingBufferHeight])}}]),t){var v=d,w=v.count,x=v.size,y=v.borderSize,z=v.sizeBuffer,A=new Uint8Array(2*w);if(x.length||y.length)for(var B=0;B<w;B++)A[2*B]=Math.round(255*(null==x[B]?x:x[B])/l),A[2*B+1]=Math.round(255*(null==y[B]?y:y[B])/l);z({data:A,usage:"dynamic"})}if(u){var C,D=d,E=D.count,F=D.color,G=D.borderColor,H=D.colorBuffer;if(a.tooManyColors){if(F.length||G.length){C=new Uint8Array(8*E);for(var I=0;I<E;I++){var J=F[I];C[8*I]=s[4*J],C[8*I+1]=s[4*J+1],C[8*I+2]=s[4*J+2],C[8*I+3]=s[4*J+3];var K=G[I];C[8*I+4]=s[4*K],C[8*I+5]=s[4*K+1],C[8*I+6]=s[4*K+2],C[8*I+7]=s[4*K+3]}}}else if(F.length||G.length){C=new Uint8Array(4*E+2);for(var L=0;L<E;L++)null!=F[L]&&(C[4*L]=F[L]%p,C[4*L+1]=Math.floor(F[L]/p)),null!=G[L]&&(C[4*L+2]=G[L]%p,C[4*L+3]=Math.floor(G[L]/p))}H({data:C||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return d})}},f.prototype.addMarker=function(a){var b,c=this.markerTextures,d=this.regl,e=this.markerCache,f=null==a?0:e.indexOf(a);if(f>=0)return f;if(a instanceof Uint8Array||a instanceof Uint8ClampedArray)b=a;else{b=new Uint8Array(a.length);for(var g=0,h=a.length;g<h;g++)b[g]=255*a[g]}var i=Math.floor(Math.sqrt(b.length));return f=c.length,e.push(a),c.push(d.texture({channels:1,data:b,radius:i,mag:"linear",min:"linear"})),f},f.prototype.updateColor=function(a){var b=this.paletteIds,c=this.palette,d=this.maxColors;Array.isArray(a)||(a=[a]);var e=[];if("number"==typeof a[0]){var f=[];if(Array.isArray(a))for(var h=0;h<a.length;h+=4)f.push(a.slice(h,h+4));else for(var j=0;j<a.length;j+=4)f.push(a.subarray(j,j+4));a=f}for(var k=0;k<a.length;k++){var l=a[k];l=g(l,"uint8");var m=i(l,!1);if(null==b[m]){var n=c.length;b[m]=Math.floor(n/4),c[n]=l[0],c[n+1]=l[1],c[n+2]=l[2],c[n+3]=l[3]}e[k]=b[m]}return!this.tooManyColors&&c.length>4*d&&(this.tooManyColors=!0),this.updatePalette(c),1===e.length?e[0]:e},f.prototype.updatePalette=function(a){if(!this.tooManyColors){var b=this.maxColors,c=this.paletteTexture,d=Math.ceil(.25*a.length/b);if(d>1)for(var e=.25*(a=a.slice()).length%b;e<d*b;e++)a.push(0,0,0,0);c.height<d&&c.resize(b,d),c.subimage({width:Math.min(.25*a.length,b),height:d,data:a},0,0)}},f.prototype.destroy=function(){return this.groups.forEach(function(a){a.sizeBuffer.destroy(),a.positionBuffer.destroy(),a.positionFractBuffer.destroy(),a.colorBuffer.destroy(),a.activation.forEach(function(a){return a&&a.destroy&&a.destroy()}),a.selectionBuffer.destroy(),a.elements&&a.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(a){return a&&a.destroy&&a.destroy()}),this};var t=a("object-assign");b.exports=function(a,b){var c=new s(a,b),d=c.render.bind(c);return t(d,{render:d,update:c.update.bind(c),draw:c.draw.bind(c),destroy:c.destroy.bind(c),regl:c.regl,gl:c.gl,canvas:c.gl.canvas,groups:c.groups,markers:c.markerCache,palette:c.palette}),d}},{"array-bounds":66,"color-id":119,"color-normalize":121,"flatten-vertex-data":228,glslify:410,"is-iexplorer":420,"object-assign":455,"parse-rect":460,"pick-by-alias":466,"point-cluster":500,"to-float32":539,"update-diff":550}],499:[function(a,b,c){arguments[4][112][0].apply(c,arguments)},{dup:112}],500:[function(a,b,c){"use strict";b.exports=a("./quad")},{"./quad":501}],501:[function(a,b,c){"use strict";function d(a,b){for(var c=b[0],d=b[1],e=1/(b[2]-c),g=1/(b[3]-d),h=new Array(a.length),i=0,j=a.length/2;i<j;i++)h[2*i]=f((a[2*i]-c)*e,0,1),h[2*i+1]=f((a[2*i+1]-d)*g,0,1);return h}var e=a("binary-search-bounds"),f=a("clamp"),g=a("parse-rect"),h=a("array-bounds"),i=a("pick-by-alias"),j=a("defined"),k=a("flatten-vertex-data"),l=a("is-obj"),m=a("dtype"),n=a("math-log2");b.exports=function(a,b){function c(a,b,c){for(var d=1,e=.5,f=.5,g=.5,h=0;h<c;h++)d<<=2,d+=a<e?b<f?0:1:b<f?2:3,g*=.5,e+=a<e?-g:g,f+=b<f?-g:g;return d}b||(b={}),a=k(a,"float64"),b=i(b,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var f=j(b.maxDepth,255),o=j(b.bounds,h(a,2));o[0]===o[2]&&o[2]++,o[1]===o[3]&&o[3]++;var p,q=d(a,o),r=a.length>>>1;b.dtype||(b.dtype="array"),"string"==typeof b.dtype?p=new(m(b.dtype))(r):b.dtype&&(p=b.dtype,Array.isArray(p)&&(p.length=r));for(var s=0;s<r;++s)p[s]=s;var t=[],u=[],v=[],w=[];!function a(b,c,d,e,g,h){if(!e.length)return null;var i=t[g]||(t[g]=[]),j=v[g]||(v[g]=[]),k=u[g]||(u[g]=[]),l=i.length;if(++g>f||h>1073741824){for(var m=0;m<e.length;m++)i.push(e[m]),j.push(h),k.push(null,null,null,null);return l}if(i.push(e[0]),j.push(h),e.length<=1)return k.push(null,null,null,null),l;for(var n=.5*d,o=b+n,p=c+n,r=[],s=[],w=[],x=[],y=1,z=e.length;y<z;y++){var A=e[y],B=q[2*A],C=q[2*A+1];B<o?C<p?r.push(A):s.push(A):C<p?w.push(A):x.push(A)}return h<<=2,k.push(a(b,c,n,r,g,h),a(b,p,n,s,g,h+1),a(o,c,n,w,g,h+2),a(o,p,n,x,g,h+3)),l}(0,0,1,p,0,1);for(var x=0,y=0;y<t.length;y++){var z=t[y];if(p.set)p.set(z,x);else for(var A=0,B=z.length;A<B;A++)p[A+x]=z[A];var C=x+t[y].length;w[y]=[x,C],x=C}return p.range=function(){for(var b,f=[],h=arguments.length;h--;)f[h]=arguments[h];if(l(f[f.length-1])){var k=f.pop();f.length||null==k.x&&null==k.l&&null==k.left||(f=[k],b={}),b=i(k,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else b={};f.length||(f=o);var m=g.apply(void 0,f),p=[Math.min(m.x,m.x+m.width),Math.min(m.y,m.y+m.height),Math.max(m.x,m.x+m.width),Math.max(m.y,m.y+m.height)],q=p[0],r=p[1],s=p[2],x=p[3],y=d([q,r,s,x],o),z=y[0],A=y[1],B=y[2],C=y[3],D=j(b.level,t.length);if(null!=b.d){var E;"number"==typeof b.d?E=[b.d,b.d]:b.d.length&&(E=b.d),D=Math.min(Math.max(Math.ceil(-n(Math.abs(E[0])/(o[2]-o[0]))),Math.ceil(-n(Math.abs(E[1])/(o[3]-o[1])))),D)}if(D=Math.min(D,t.length),b.lod)return function(a,b,d,f,g){for(var h=[],i=0;i<g;i++){var j=v[i],k=w[i][0],l=c(a,b,i),m=c(d,f,i),n=e.ge(j,l),o=e.gt(j,m,n,j.length-1);h[i]=[n+k,o+k]}return h}(z,A,B,C,D);var F=[];return function b(c,d,e,f,g,h){if(null!==g&&null!==h){var i=c+e,j=d+e;if(!(z>i||A>j||B<c||C<d||f>=D||g===h)){var k=t[f];void 0===h&&(h=k.length);for(var l=g;l<h;l++){var m=k[l],n=a[2*m],o=a[2*m+1];n>=q&&n<=s&&o>=r&&o<=x&&F.push(m)}var p=u[f],v=p[4*g+0],w=p[4*g+1],y=p[4*g+2],E=p[4*g+3],G=function(a,b){for(var c=null,d=0;null===c;)if(c=a[4*b+d],++d>a.length)return null;return c}(p,g+1),H=.5*e,I=f+1;b(c,d,H,I,v,w||y||E||G),b(c,d+H,H,I,w,y||E||G),b(c+H,d,H,I,y,E||G),b(c+H,d+H,H,I,E,G)}}}(0,0,1,0,0,1),F},p}},{"array-bounds":66,"binary-search-bounds":499,clamp:116,defined:165,dtype:170,"flatten-vertex-data":228,"is-obj":422,"math-log2":433,"parse-rect":460,"pick-by-alias":466}],502:[function(a,b,c){"use strict";function d(a,b){if(!(this instanceof d))return new d(a,b);this.traces=[],this.passes={},this.regl=a,this.scatter=h(a),this.canvas=this.scatter.canvas}function e(a,b,c){return(null!=a.id?a.id:a)<<16|(255&b)<<8|255&c}function f(a,b,c){var d,e,f,g,h=a[b],i=a[c];return h.length>2?(h[0],h[2],d=h[1],e=h[3]):h.length?(d=h[0],e=h[1]):(h.x,d=h.y,h.x,h.width,e=h.y+h.height),i.length>2?(f=i[0],g=i[2],i[1],i[3]):i.length?(f=i[0],g=i[1]):(f=i.x,i.y,g=i.x+i.width,i.y,i.height),[f,d,g,e]}function g(a){if("number"==typeof a)return[a,a,a,a];if(2===a.length)return[a[0],a[1],a[0],a[1]];var b=m(a);return[b.x,b.y,b.x+b.width,b.y+b.height]}var h=a("regl-scatter2d"),i=a("pick-by-alias"),j=a("array-bounds"),k=a("raf"),l=a("array-range"),m=a("parse-rect"),n=a("flatten-vertex-data");b.exports=d,d.prototype.render=function(){for(var a,b=this,c=[],d=arguments.length;d--;)c[d]=arguments[d];return c.length&&(a=this).update.apply(a,c),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?null==this.planned&&(this.planned=k(function(){b.draw(),b.dirty=!0,b.planned=null})):(this.draw(),this.dirty=!0,k(function(){b.dirty=!1})),this)},d.prototype.update=function(){for(var a,b=[],c=arguments.length;c--;)b[c]=arguments[c];if(b.length){for(var d=0;d<b.length;d++)this.updateItem(d,b[d]);this.traces=this.traces.filter(Boolean);for(var e=[],f=0,g=0;g<this.traces.length;g++){for(var h=this.traces[g],i=this.traces[g].passes,j=0;j<i.length;j++)e.push(this.passes[i[j]]);h.passOffset=f,f+=h.passes.length}return(a=this.scatter).update.apply(a,e),this}},d.prototype.updateItem=function(a,b){var c=this.regl;if(null===b)return this.traces[a]=null,this;if(!b)return this;var d,h=i(b,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),k=this.traces[a]||(this.traces[a]={id:a,buffer:c.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:m([c._gl.drawingBufferWidth,c._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(null!=h.color&&(k.color=h.color),null!=h.size&&(k.size=h.size),null!=h.marker&&(k.marker=h.marker),null!=h.borderColor&&(k.borderColor=h.borderColor),null!=h.borderSize&&(k.borderSize=h.borderSize),null!=h.opacity&&(k.opacity=h.opacity),h.viewport&&(k.viewport=m(h.viewport)),null!=h.diagonal&&(k.diagonal=h.diagonal),null!=h.upper&&(k.upper=h.upper),null!=h.lower&&(k.lower=h.lower),h.data){k.buffer(n(h.data)),k.columns=h.data.length,k.count=h.data[0].length,k.bounds=[];for(var l=0;l<k.columns;l++)k.bounds[l]=j(h.data[l],1)}h.range&&(k.range=h.range,d=k.range&&"number"!=typeof k.range[0]),h.domain&&(k.domain=h.domain);var o=!1;null!=h.padding&&(Array.isArray(h.padding)&&h.padding.length===k.columns&&"number"==typeof h.padding[h.padding.length-1]?(k.padding=h.padding.map(g),o=!0):k.padding=g(h.padding));var p=k.columns,q=k.count,r=k.viewport.width,s=k.viewport.height,t=k.viewport.x,u=k.viewport.y,v=r/p,w=s/p;k.passes=[];for(var x=0;x<p;x++)for(var y=0;y<p;y++)if((k.diagonal||y!==x)&&(k.upper||!(x>y))&&(k.lower||!(x<y))){var z=e(k.id,x,y),A=this.passes[z]||(this.passes[z]={});if(h.data&&(h.transpose?A.positions={x:{buffer:k.buffer,offset:y,count:q,stride:p},y:{buffer:k.buffer,offset:x,count:q,stride:p}}:A.positions={x:{buffer:k.buffer,offset:y*q,count:q},y:{buffer:k.buffer,offset:x*q,count:q}},A.bounds=f(k.bounds,x,y)),h.domain||h.viewport||h.data){var B=o?f(k.padding,x,y):k.padding;if(k.domain){var C=f(k.domain,x,y),D=C[0],E=C[1],F=C[2],G=C[3];A.viewport=[t+D*r+B[0],u+E*s+B[1],t+F*r-B[2],u+G*s-B[3]]}else A.viewport=[t+y*v+v*B[0],u+x*w+w*B[1],t+(y+1)*v-v*B[2],u+(x+1)*w-w*B[3]]}h.color&&(A.color=k.color),h.size&&(A.size=k.size),h.marker&&(A.marker=k.marker),h.borderSize&&(A.borderSize=k.borderSize),h.borderColor&&(A.borderColor=k.borderColor),h.opacity&&(A.opacity=k.opacity),h.range&&(A.range=d?f(k.range,x,y):k.range||A.bounds),k.passes.push(z)}return this},d.prototype.draw=function(){for(var a,b=[],c=arguments.length;c--;)b[c]=arguments[c];if(b.length){for(var d=[],e=0;e<b.length;e++)if("number"==typeof b[e]){var f=this.traces[b[e]],g=f.passes,h=f.passOffset;d.push.apply(d,l(h,h+g.length))}else if(b[e].length){var i=b[e],j=this.traces[e],k=j.passes,m=j.passOffset;k=k.map(function(a,b){d[m+b]=i})}(a=this.scatter).draw.apply(a,d)}else this.scatter.draw();return this},d.prototype.destroy=function(){return this.traces.forEach(function(a){a.buffer&&a.buffer.destroy&&a.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":66,"array-range":68,"flatten-vertex-data":228,"parse-rect":460,"pick-by-alias":466,raf:485,"regl-scatter2d":498}],503:[function(a,b,c){var d,e;d=this,e=function(){function a(a,b){this.id=P++,this.type=a,this.data=b}function b(a){return"["+function a(b){if(0===b.length)return[];var c=b.charAt(0),d=b.charAt(b.length-1);if(1<b.length&&c===d&&('"'===c||"'"===c))return['"'+b.substr(1,b.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(c=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(b))return a(b.substr(0,c.index)).concat(a(c[1])).concat(a(b.substr(c.index+c[0].length)));if(1===(c=b.split(".")).length)return['"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(b=[],d=0;d<c.length;++d)b=b.concat(a(c[d]));return b}(a).join("][")+"]"}function c(a){return"string"==typeof a?a.split():a}function d(a){return"string"==typeof a?document.querySelector(a):a}function e(a){var b,e,f,g,h=a||{};a={};var i=[],j=[],k="undefined"==typeof window?1:window.devicePixelRatio,l=!1,m=function(a){},n=function(){};if("string"==typeof h?b=document.querySelector(h):"object"==typeof h&&("string"==typeof h.nodeName&&"function"==typeof h.appendChild&&"function"==typeof h.getBoundingClientRect?b=h:"function"==typeof h.drawArrays||"function"==typeof h.drawElements?f=(g=h).canvas:("gl"in h?g=h.gl:"canvas"in h?f=d(h.canvas):"container"in h&&(e=d(h.container)),"attributes"in h&&(a=h.attributes),"extensions"in h&&(i=c(h.extensions)),"optionalExtensions"in h&&(j=c(h.optionalExtensions)),"onDone"in h&&(m=h.onDone),"profile"in h&&(l=!!h.profile),"pixelRatio"in h&&(k=+h.pixelRatio))),b&&("canvas"===b.nodeName.toLowerCase()?f=b:e=b),!g){if(!f){if(!(b=function(a,b,c){function d(){var b=window.innerWidth,d=window.innerHeight;a!==document.body&&(b=(d=a.getBoundingClientRect()).right-d.left,d=d.bottom-d.top),e.width=c*b,e.height=c*d,O(e.style,{width:b+"px",height:d+"px"})}var e=document.createElement("canvas");return O(e.style,{border:0,margin:0,padding:0,top:0,left:0}),a.appendChild(e),a===document.body&&(e.style.position="absolute",O(a.style,{margin:0,padding:0})),window.addEventListener("resize",d,!1),d(),{canvas:e,onDestroy:function(){window.removeEventListener("resize",d),a.removeChild(e)}}}(e||document.body,0,k)))return null;f=b.canvas,n=b.onDestroy}g=function(a,b){function c(c){try{return a.getContext(c,b)}catch(a){return null}}return c("webgl")||c("experimental-webgl")||c("webgl-experimental")}(f,a)}return g?{gl:g,canvas:f,container:e,extensions:i,optionalExtensions:j,pixelRatio:k,profile:l,onDone:m,onDestroy:n}:(n(),m("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function f(a,b){for(var c=Array(a),d=0;d<a;++d)c[d]=b(d);return c}function g(a){var b,c;return b=(65535<a)<<4,b|=c=(255<(a>>>=b))<<3,(b|=c=(15<(a>>>=c))<<2)|(c=(3<(a>>>=c))<<1)|a>>>c>>1}function h(){function a(a){a:{for(var b=16;268435456>=b;b*=16)if(a<=b){a=b;break a}a=0}return 0<(b=c[g(a)>>2]).length?b.pop():new ArrayBuffer(a)}function b(a){c[g(a.byteLength)>>2].push(a)}var c=f(8,function(){return[]});return{alloc:a,free:b,allocType:function(b,c){var d=null;switch(b){case 5120:d=new Int8Array(a(c),0,c);break;case 5121:d=new Uint8Array(a(c),0,c);break;case 5122:d=new Int16Array(a(2*c),0,c);break;case 5123:d=new Uint16Array(a(2*c),0,c);break;case 5124:d=new Int32Array(a(4*c),0,c);break;case 5125:d=new Uint32Array(a(4*c),0,c);break;case 5126:d=new Float32Array(a(4*c),0,c);break;default:return null}return d.length!==c?d.subarray(0,c):d},freeType:function(a){b(a.buffer)}}}function i(a){return!!a&&"object"==typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"==typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||V(a.data))}function j(a,b,c,d,e,f){for(var g=0;g<b;++g)for(var h=a[g],i=0;i<c;++i)for(var j=h[i],k=0;k<d;++k)e[f++]=j[k]}function k(a){return 0|Y[Object.prototype.toString.call(a)]}function l(a,b){for(var c=0;c<b.length;++c)a[c]=b[c]}function m(a,b,c,d,e,f,g){for(var h=0,i=0;i<c;++i)for(var j=0;j<d;++j)a[h++]=b[e*i+f*j+g]}function n(a,b,c,d){function e(b){this.id=j++,this.buffer=a.createBuffer(),this.type=b,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,c.profile&&(this.stats={size:0})}function f(b,c,d){b.byteLength=c.byteLength,a.bufferData(b.type,c,d)}function g(a,b,c,d,e,g){if(a.usage=c,Array.isArray(b)){if(a.dtype=d||5126,0<b.length)if(Array.isArray(b[0])){e=aa(b);for(var h=d=1;h<e.length;++h)d*=e[h];a.dimension=d,f(a,b=_(b,e,a.dtype),c),g?a.persistentData=b:T.freeType(b)}else"number"==typeof b[0]?(a.dimension=e,l(e=T.allocType(a.dtype,b.length),b),f(a,e,c),g?a.persistentData=e:T.freeType(e)):V(b[0])&&(a.dimension=b[0].length,a.dtype=d||k(b[0])||5126,f(a,b=_(b,[b.length,b[0].length],a.dtype),c),g?a.persistentData=b:T.freeType(b))}else if(V(b))a.dtype=d||k(b),a.dimension=e,f(a,b,c),g&&(a.persistentData=new Uint8Array(new Uint8Array(b.buffer)));else if(i(b)){e=b.shape;var j=b.stride,n=(h=b.offset,0),o=0,p=0,q=0;1===e.length?(n=e[0],o=1,p=j[0],q=0):2===e.length&&(n=e[0],o=e[1],p=j[0],q=j[1]),a.dtype=d||k(b.data)||5126,a.dimension=o,m(e=T.allocType(a.dtype,n*o),b.data,n,o,p,q,h),f(a,e,c),g?a.persistentData=e:T.freeType(e)}}function h(c){b.bufferCount--;for(var e=0;e<d.state.length;++e){var f=d.state[e];f.buffer===c&&(a.disableVertexAttribArray(e),f.buffer=null)}a.deleteBuffer(c.buffer),c.buffer=null,delete n[c.id]}var j=0,n={};e.prototype.bind=function(){a.bindBuffer(this.type,this.buffer)},e.prototype.destroy=function(){h(this)};var o=[];return c.profile&&(b.getTotalBufferSize=function(){var a=0;return Object.keys(n).forEach(function(b){a+=n[b].stats.size}),a}),{create:function(d,f,j,o){function p(b){var d=35044,e=null,f=0,h=0,j=1;return Array.isArray(b)||V(b)||i(b)?e=b:"number"==typeof b?f=0|b:b&&("data"in b&&(e=b.data),"usage"in b&&(d=$[b.usage]),"type"in b&&(h=Z[b.type]),"dimension"in b&&(j=0|b.dimension),"length"in b&&(f=0|b.length)),q.bind(),e?g(q,e,d,h,j,o):(f&&a.bufferData(q.type,f,d),q.dtype=h||5121,q.usage=d,q.dimension=j,q.byteLength=f),c.profile&&(q.stats.size=q.byteLength*ba[q.dtype]),p}b.bufferCount++;var q=new e(f);return n[q.id]=q,j||p(d),p._reglType="buffer",p._buffer=q,p.subdata=function(b,c){var d,e=0|(c||0);if(q.bind(),V(b))a.bufferSubData(q.type,e,b);else if(Array.isArray(b)){if(0<b.length)if("number"==typeof b[0]){var f=T.allocType(q.dtype,b.length);l(f,b),a.bufferSubData(q.type,e,f),T.freeType(f)}else(Array.isArray(b[0])||V(b[0]))&&(d=aa(b),f=_(b,d,q.dtype),a.bufferSubData(q.type,e,f),T.freeType(f))}else if(i(b)){d=b.shape;var g=b.stride,h=f=0,j=0,n=0;1===d.length?(f=d[0],h=1,j=g[0],n=0):2===d.length&&(f=d[0],h=d[1],j=g[0],n=g[1]),d=Array.isArray(b.data)?q.dtype:k(b.data),m(d=T.allocType(d,f*h),b.data,f,h,j,n,b.offset),a.bufferSubData(q.type,e,d),T.freeType(d)}return p},c.profile&&(p.stats=q.stats),p.destroy=function(){h(q)},p},createStream:function(a,b){var c=o.pop();return c||(c=new e(a)),c.bind(),g(c,b,35040,0,1,!1),c},destroyStream:function(a){o.push(a)},clear:function(){W(n).forEach(h),o.forEach(h)},getBuffer:function(a){return a&&a._buffer instanceof e?a._buffer:null},restore:function(){W(n).forEach(function(b){b.buffer=a.createBuffer(),a.bindBuffer(b.type,b.buffer),a.bufferData(b.type,b.persistentData||b.byteLength,b.usage)})},_initBuffer:g}}function o(a,b,c,d){function e(a){this.id=j++,h[this.id]=this,this.buffer=a,this.primType=4,this.type=this.vertCount=0}function f(d,e,f,g,h,j,k){if(d.buffer.bind(),e){var l=k;k||V(e)&&(!i(e)||V(e.data))||(l=b.oes_element_index_uint?5125:5123),c._initBuffer(d.buffer,e,f,l,3)}else a.bufferData(34963,j,f),d.buffer.dtype=l||5121,d.buffer.usage=f,d.buffer.dimension=3,d.buffer.byteLength=j;if(l=k,!k){switch(d.buffer.dtype){case 5121:case 5120:l=5121;break;case 5123:case 5122:l=5123;break;case 5125:case 5124:l=5125}d.buffer.dtype=l}d.type=l,0>(e=h)&&(e=d.buffer.byteLength,5123===l?e>>=1:5125===l&&(e>>=2)),d.vertCount=e,e=g,0>g&&(e=4,1===(g=d.buffer.dimension)&&(e=0),2===g&&(e=1),3===g&&(e=4)),d.primType=e}function g(a){d.elementsCount--,delete h[a.id],a.buffer.destroy(),a.buffer=null}var h={},j=0,k={uint8:5121,uint16:5123};b.oes_element_index_uint&&(k.uint32=5125),e.prototype.bind=function(){this.buffer.bind()};var l=[];return{create:function(a,b){function h(a){if(a)if("number"==typeof a)j(a),l.primType=4,l.vertCount=0|a,l.type=5121;else{var b=null,c=35044,d=-1,e=-1,g=0,m=0;Array.isArray(a)||V(a)||i(a)?b=a:("data"in a&&(b=a.data),"usage"in a&&(c=$[a.usage]),"primitive"in a&&(d=ca[a.primitive]),"count"in a&&(e=0|a.count),"type"in a&&(m=k[a.type]),"length"in a?g=0|a.length:(g=e,5123===m||5122===m?g*=2:5125!==m&&5124!==m||(g*=4))),f(l,b,c,d,e,g,m)}else j(),l.primType=4,l.vertCount=0,l.type=5121;return h}var j=c.create(null,34963,!0),l=new e(j._buffer);return d.elementsCount++,h(a),h._reglType="elements",h._elements=l,h.subdata=function(a,b){return j.subdata(a,b),h},h.destroy=function(){g(l)},h},createStream:function(a){var b=l.pop();return b||(b=new e(c.create(null,34963,!0,!1)._buffer)),f(b,a,35040,-1,-1,0,0),b},destroyStream:function(a){l.push(a)},getElements:function(a){return"function"==typeof a&&a._elements instanceof e?a._elements:null},clear:function(){W(h).forEach(g)}}}function p(a){for(var b=T.allocType(5123,a.length),c=0;c<a.length;++c)if(isNaN(a[c]))b[c]=65535;else if(1/0===a[c])b[c]=31744;else if(-1/0===a[c])b[c]=64512;else{da[0]=a[c];var d=(f=ea[0])>>>31<<15,e=(f<<1>>>24)-127,f=f>>13&1023;b[c]=-24>e?d:-14>e?d+(f+1024>>-14-e):15<e?d+31744:d+(e+15<<10)+f}return b}function q(a){return Array.isArray(a)||V(a)}function r(a){return"[object "+a+"]"}function s(a){return Array.isArray(a)&&(0===a.length||"number"==typeof a[0])}function t(a){return!(!Array.isArray(a)||0===a.length||!q(a[0]))}function u(a){return Object.prototype.toString.call(a)}function v(a){if(!a)return!1;var b=u(a);return 0<=na.indexOf(b)||s(a)||t(a)||i(a)}function w(a,b){36193===a.type?(a.data=p(b),T.freeType(b)):a.data=b}function x(a,b,c,d,e,f){if(a=void 0!==pa[a]?pa[a]:ha[a]*oa[b],f&&(a*=6),e){for(d=0;1<=c;)d+=a*c*c,c/=2;return d}return a*c*d}function y(a,b,c,d,e,f,g){function h(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function j(a,b){a.internalformat=b.internalformat,a.format=b.format,a.type=b.type,a.compressed=b.compressed,a.premultiplyAlpha=b.premultiplyAlpha,a.flipY=b.flipY,a.unpackAlignment=b.unpackAlignment,a.colorSpace=b.colorSpace,a.width=b.width,a.height=b.height,a.channels=b.channels}function k(a,b){if("object"==typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha),"flipY"in b&&(a.flipY=b.flipY),"alignment"in b&&(a.unpackAlignment=b.alignment),"colorSpace"in b&&(a.colorSpace=R[b.colorSpace]),"type"in b&&(a.type=S[b.type]);var c=a.width,d=a.height,e=a.channels,f=!1;"shape"in b?(c=b.shape[0],d=b.shape[1],3===b.shape.length&&(e=b.shape[2],f=!0)):("radius"in b&&(c=d=b.radius),"width"in b&&(c=b.width),"height"in b&&(d=b.height),"channels"in b&&(e=b.channels,f=!0)),a.width=0|c,a.height=0|d,a.channels=0|e,c=!1,"format"in b&&(c=b.format,d=a.internalformat=U[c],a.format=na[d],c in S&&!("type"in b)&&(a.type=S[c]),c in Z&&(a.compressed=!0),c=!0),!f&&c?a.channels=ha[a.format]:f&&!c&&a.channels!==ga[a.format]&&(a.format=a.internalformat=ga[a.channels])}}function l(b){a.pixelStorei(37440,b.flipY),a.pixelStorei(37441,b.premultiplyAlpha),a.pixelStorei(37443,b.colorSpace),a.pixelStorei(3317,b.unpackAlignment)}function m(){h.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function n(a,b){var c=null;if(v(b)?c=b:b&&(k(a,b),"x"in b&&(a.xOffset=0|b.x),"y"in b&&(a.yOffset=0|b.y),v(b.data)&&(c=b.data)),b.copy){var d=e.viewportWidth,f=e.viewportHeight;a.width=a.width||d-a.xOffset,a.height=a.height||f-a.yOffset,a.needsCopy=!0}else if(c){if(V(c))a.channels=a.channels||4,a.data=c,"type"in b||5121!==a.type||(a.type=0|Y[Object.prototype.toString.call(c)]);else if(s(c)){switch(a.channels=a.channels||4,f=(d=c).length,a.type){case 5121:case 5123:case 5125:case 5126:(f=T.allocType(a.type,f)).set(d),a.data=f;break;case 36193:a.data=p(d)}a.alignment=1,a.needsFree=!0}else if(i(c)){d=c.data,Array.isArray(d)||5121!==a.type||(a.type=0|Y[Object.prototype.toString.call(d)]),f=c.shape;var g,h,j,l,m=c.stride;3===f.length?(j=f[2],l=m[2]):l=j=1,g=f[0],h=f[1],f=m[0],m=m[1],a.alignment=1,a.width=g,a.height=h,a.channels=j,
a.format=a.internalformat=ga[j],a.needsFree=!0,g=l,c=c.offset,j=a.width,l=a.height,h=a.channels;for(var n=T.allocType(36193===a.type?5126:a.type,j*l*h),o=0,r=0;r<l;++r)for(var x=0;x<j;++x)for(var y=0;y<h;++y)n[o++]=d[f*x+m*r+g*y+c];w(a,n)}else if(u(c)===ia||u(c)===ja)u(c)===ia?a.element=c:a.element=c.canvas,a.width=a.element.width,a.height=a.element.height,a.channels=4;else if(u(c)===ka)a.element=c,a.width=c.width,a.height=c.height,a.channels=4;else if(u(c)===la)a.element=c,a.width=c.naturalWidth,a.height=c.naturalHeight,a.channels=4;else if(u(c)===ma)a.element=c,a.width=c.videoWidth,a.height=c.videoHeight,a.channels=4;else if(t(c)){for(d=a.width||c[0].length,f=a.height||c.length,m=a.channels,m=q(c[0][0])?m||c[0][0].length:m||1,g=X.shape(c),j=1,l=0;l<g.length;++l)j*=g[l];j=T.allocType(36193===a.type?5126:a.type,j),X.flatten(c,g,"",j),w(a,j),a.alignment=1,a.width=d,a.height=f,a.channels=m,a.format=a.internalformat=ga[m],a.needsFree=!0}}else a.width=a.width||1,a.height=a.height||1,a.channels=a.channels||4}function o(b,c,e,f,g){var h=b.element,i=b.data,j=b.internalformat,k=b.format,m=b.type,n=b.width,o=b.height;l(b),h?a.texSubImage2D(c,g,e,f,k,m,h):b.compressed?a.compressedTexSubImage2D(c,g,e,f,j,n,o,i):b.needsCopy?(d(),a.copyTexSubImage2D(c,g,e,f,b.xOffset,b.yOffset,n,o)):a.texSubImage2D(c,g,e,f,n,o,k,m,i)}function r(){return oa.pop()||new m}function y(a){a.needsFree&&T.freeType(a.data),m.call(a),oa.push(a)}function z(){h.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function A(a,b,c){var d=a.images[0]=r();a.mipmask=1,d.width=a.width=b,d.height=a.height=c,d.channels=a.channels=4}function B(a,b){var c=null;if(v(b))j(c=a.images[0]=r(),a),n(c,b),a.mipmask=1;else if(k(a,b),Array.isArray(b.mipmap))for(var d=b.mipmap,e=0;e<d.length;++e)j(c=a.images[e]=r(),a),c.width>>=e,c.height>>=e,n(c,d[e]),a.mipmask|=1<<e;else j(c=a.images[0]=r(),a),n(c,b),a.mipmask=1;j(a,a.images[0])}function C(b,c){for(var e=b.images,f=0;f<e.length&&e[f];++f){var g=e[f],h=c,i=f,j=g.element,k=g.data,m=g.internalformat,n=g.format,o=g.type,p=g.width,q=g.height,r=g.channels;l(g),j?a.texImage2D(h,i,n,n,o,j):g.compressed?a.compressedTexImage2D(h,i,m,p,q,0,k):g.needsCopy?(d(),a.copyTexImage2D(h,i,n,g.xOffset,g.yOffset,p,q,0)):((g=!k)&&(k=T.zero.allocType(o,p*q*r)),a.texImage2D(h,i,n,p,q,0,n,o,k),g&&k&&T.zero.freeType(k))}}function D(){var a=pa.pop()||new z;h.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function E(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&y(b[c]),b[c]=null;pa.push(a)}function F(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function G(a,b){"min"in b&&(a.minFilter=Q[b.min],0<=fa.indexOf(a.minFilter)&&!("faces"in b)&&(a.genMipmaps=!0)),"mag"in b&&(a.magFilter=P[b.mag]);var c=a.wrapS,d=a.wrapT;if("wrap"in b){var e=b.wrap;"string"==typeof e?c=d=N[e]:Array.isArray(e)&&(c=N[e[0]],d=N[e[1]])}else"wrapS"in b&&(c=N[b.wrapS]),"wrapT"in b&&(d=N[b.wrapT]);if(a.wrapS=c,a.wrapT=d,"anisotropic"in b&&(a.anisotropic=b.anisotropic),"mipmap"in b){switch(c=!1,typeof b.mipmap){case"string":a.mipmapHint=M[b.mipmap],c=a.genMipmaps=!0;break;case"boolean":c=a.genMipmaps=b.mipmap;break;case"object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=9984)}}function H(c,d){a.texParameteri(d,10241,c.minFilter),a.texParameteri(d,10240,c.magFilter),a.texParameteri(d,10242,c.wrapS),a.texParameteri(d,10243,c.wrapT),b.ext_texture_filter_anisotropic&&a.texParameteri(d,34046,c.anisotropic),c.genMipmaps&&(a.hint(33170,c.mipmapHint),a.generateMipmap(d))}function I(b){h.call(this),this.mipmask=0,this.internalformat=6408,this.id=qa++,this.refCount=1,this.target=b,this.texture=a.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new F,g.profile&&(this.stats={size:0})}function J(b){a.activeTexture(33984),a.bindTexture(b.target,b.texture)}function K(){var b=ta[0];b?a.bindTexture(b.target,b.texture):a.bindTexture(3553,null)}function L(b){var c=b.texture,d=b.unit,e=b.target;0<=d&&(a.activeTexture(33984+d),a.bindTexture(e,null),ta[d]=null),a.deleteTexture(c),b.texture=null,b.params=null,b.pixels=null,b.refCount=0,delete ra[b.id],f.textureCount--}var M={"don't care":4352,"dont care":4352,nice:4354,fast:4353},N={repeat:10497,clamp:33071,mirror:33648},P={nearest:9728,linear:9729},Q=O({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},P),R={none:0,browser:37444},S={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},U={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Z={};b.ext_srgb&&(U.srgb=35904,U.srgba=35906),b.oes_texture_float&&(S.float32=S.float=5126),b.oes_texture_half_float&&(S.float16=S["half float"]=36193),b.webgl_depth_texture&&(O(U,{depth:6402,"depth stencil":34041}),O(S,{uint16:5123,uint32:5125,"depth stencil":34042})),b.webgl_compressed_texture_s3tc&&O(Z,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),b.webgl_compressed_texture_atc&&O(Z,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),b.webgl_compressed_texture_pvrtc&&O(Z,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),b.webgl_compressed_texture_etc1&&(Z["rgb etc1"]=36196);var $=Array.prototype.slice.call(a.getParameter(34467));Object.keys(Z).forEach(function(a){var b=Z[a];0<=$.indexOf(b)&&(U[a]=b)});var _=Object.keys(U);c.textureFormats=_;var aa=[];Object.keys(U).forEach(function(a){aa[U[a]]=a});var ba=[];Object.keys(S).forEach(function(a){ba[S[a]]=a});var ca=[];Object.keys(P).forEach(function(a){ca[P[a]]=a});var da=[];Object.keys(Q).forEach(function(a){da[Q[a]]=a});var ea=[];Object.keys(N).forEach(function(a){ea[N[a]]=a});var na=_.reduce(function(a,b){var c=U[b];return 6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407,a},{}),oa=[],pa=[],qa=0,ra={},sa=c.maxTextureUnits,ta=Array(sa).map(function(){return null});return O(I.prototype,{bind:function(){this.bindCount+=1;var b=this.unit;if(0>b){for(var c=0;c<sa;++c){var d=ta[c];if(d){if(0<d.bindCount)continue;d.unit=-1}ta[c]=this,b=c;break}g.profile&&f.maxTextureUnits<b+1&&(f.maxTextureUnits=b+1),this.unit=b,a.activeTexture(33984+b),a.bindTexture(this.target,this.texture)}return b},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&L(this)}}),g.profile&&(f.getTotalTextureSize=function(){var a=0;return Object.keys(ra).forEach(function(b){a+=ra[b].stats.size}),a}),{create2D:function(b,c){function d(a,b){var c=e.texInfo;F.call(c);var f=D();return"number"==typeof a?A(f,0|a,"number"==typeof b?0|b:0|a):a?(G(c,a),B(f,a)):A(f,1,1),c.genMipmaps&&(f.mipmask=(f.width<<1)-1),e.mipmask=f.mipmask,j(e,f),e.internalformat=f.internalformat,d.width=f.width,d.height=f.height,J(e),C(f,3553),H(c,3553),K(),E(f),g.profile&&(e.stats.size=x(e.internalformat,e.type,f.width,f.height,c.genMipmaps,!1)),d.format=aa[e.internalformat],d.type=ba[e.type],d.mag=ca[c.magFilter],d.min=da[c.minFilter],d.wrapS=ea[c.wrapS],d.wrapT=ea[c.wrapT],d}var e=new I(3553);return ra[e.id]=e,f.textureCount++,d(b,c),d.subimage=function(a,b,c,f){b|=0,c|=0,f|=0;var g=r();return j(g,e),g.width=0,g.height=0,n(g,a),g.width=g.width||(e.width>>f)-b,g.height=g.height||(e.height>>f)-c,J(e),o(g,3553,b,c,f),K(),y(g),d},d.resize=function(b,c){var f=0|b,h=0|c||f;if(f===e.width&&h===e.height)return d;d.width=e.width=f,d.height=e.height=h,J(e);for(var i,j=e.channels,k=e.type,l=0;e.mipmask>>l;++l){var m=f>>l,n=h>>l;if(!m||!n)break;i=T.zero.allocType(k,m*n*j),a.texImage2D(3553,l,e.format,m,n,0,e.format,e.type,i),i&&T.zero.freeType(i)}return K(),g.profile&&(e.stats.size=x(e.internalformat,e.type,f,h,!1,!1)),d},d._reglType="texture2d",d._texture=e,g.profile&&(d.stats=e.stats),d.destroy=function(){e.decRef()},d},createCube:function(b,c,d,e,h,i){function l(a,b,c,d,e,f){var h,i=m.texInfo;for(F.call(i),h=0;6>h;++h)p[h]=D();if("number"!=typeof a&&a){if("object"==typeof a)if(b)B(p[0],a),B(p[1],b),B(p[2],c),B(p[3],d),B(p[4],e),B(p[5],f);else if(G(i,a),k(m,a),"faces"in a)for(a=a.faces,h=0;6>h;++h)j(p[h],m),B(p[h],a[h]);else for(h=0;6>h;++h)B(p[h],a)}else for(a=0|a||1,h=0;6>h;++h)A(p[h],a,a);for(j(m,p[0]),m.mipmask=i.genMipmaps?(p[0].width<<1)-1:p[0].mipmask,m.internalformat=p[0].internalformat,l.width=p[0].width,l.height=p[0].height,J(m),h=0;6>h;++h)C(p[h],34069+h);for(H(i,34067),K(),g.profile&&(m.stats.size=x(m.internalformat,m.type,l.width,l.height,i.genMipmaps,!0)),l.format=aa[m.internalformat],l.type=ba[m.type],l.mag=ca[i.magFilter],l.min=da[i.minFilter],l.wrapS=ea[i.wrapS],l.wrapT=ea[i.wrapT],h=0;6>h;++h)E(p[h]);return l}var m=new I(34067);ra[m.id]=m,f.cubeCount++;var p=Array(6);return l(b,c,d,e,h,i),l.subimage=function(a,b,c,d,e){c|=0,d|=0,e|=0;var f=r();return j(f,m),f.width=0,f.height=0,n(f,b),f.width=f.width||(m.width>>e)-c,f.height=f.height||(m.height>>e)-d,J(m),o(f,34069+a,c,d,e),K(),y(f),l},l.resize=function(b){if((b|=0)!==m.width){l.width=m.width=b,l.height=m.height=b,J(m);for(var c=0;6>c;++c)for(var d=0;m.mipmask>>d;++d)a.texImage2D(34069+c,d,m.format,b>>d,b>>d,0,m.format,m.type,null);return K(),g.profile&&(m.stats.size=x(m.internalformat,m.type,l.width,l.height,!1,!0)),l}},l._reglType="textureCube",l._texture=m,g.profile&&(l.stats=m.stats),l.destroy=function(){m.decRef()},l},clear:function(){for(var b=0;b<sa;++b)a.activeTexture(33984+b),a.bindTexture(3553,null),ta[b]=null;W(ra).forEach(L),f.cubeCount=0,f.textureCount=0},getTexture:function(a){return null},restore:function(){for(var b=0;b<sa;++b){var c=ta[b];c&&(c.bindCount=0,c.unit=-1,ta[b]=null)}W(ra).forEach(function(b){b.texture=a.createTexture(),a.bindTexture(b.target,b.texture);for(var c=0;32>c;++c)if(0!=(b.mipmask&1<<c))if(3553===b.target)a.texImage2D(3553,c,b.internalformat,b.width>>c,b.height>>c,0,b.internalformat,b.type,null);else for(var d=0;6>d;++d)a.texImage2D(34069+d,c,b.internalformat,b.width>>c,b.height>>c,0,b.internalformat,b.type,null);H(b.texInfo,b.target)})}}}function z(a,b,c,d,e,f){function g(a,b,c){this.target=a,this.texture=b,this.renderbuffer=c;var d=a=0;b?(a=b.width,d=b.height):c&&(a=c.width,d=c.height),this.width=a,this.height=d}function h(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function i(a,b,c){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function j(b,c){c&&(c.texture?a.framebufferTexture2D(36160,b,c.target,c.texture._texture.texture,0):a.framebufferRenderbuffer(36160,b,36161,c.renderbuffer._renderbuffer.renderbuffer))}function k(a){var b=3553,c=null,d=null,e=a;return"object"==typeof a&&(e=a.data,"target"in a&&(b=0|a.target)),"texture2d"===(a=e._reglType)?c=e:"textureCube"===a?c=e:"renderbuffer"===a&&(d=e,b=36161),new g(b,c,d)}function l(a,b,c,f,h){return c?((a=d.create2D({width:a,height:b,format:f,type:h}))._texture.refCount=0,new g(3553,a,null)):((a=e.create({width:a,height:b,format:f}))._renderbuffer.refCount=0,new g(36161,null,a))}function m(a){return a&&(a.texture||a.renderbuffer)}function n(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c),a.width=b,a.height=c)}function o(){this.id=x++,y[this.id]=this,this.framebuffer=a.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function p(a){a.colorAttachments.forEach(h),h(a.depthAttachment),h(a.stencilAttachment),h(a.depthStencilAttachment)}function q(b){a.deleteFramebuffer(b.framebuffer),b.framebuffer=null,f.framebufferCount--,delete y[b.id]}function r(b){var d;a.bindFramebuffer(36160,b.framebuffer);var e=b.colorAttachments;for(d=0;d<e.length;++d)j(36064+d,e[d]);for(d=e.length;d<c.maxColorAttachments;++d)a.framebufferTexture2D(36160,36064+d,3553,null,0);a.framebufferTexture2D(36160,33306,3553,null,0),a.framebufferTexture2D(36160,36096,3553,null,0),a.framebufferTexture2D(36160,36128,3553,null,0),j(36096,b.depthAttachment),j(36128,b.stencilAttachment),j(33306,b.depthStencilAttachment),a.checkFramebufferStatus(36160),a.isContextLost(),a.bindFramebuffer(36160,t.next?t.next.framebuffer:null),t.cur=t.next,a.getError()}function s(a,b){function c(a,b){var e,f=0,g=0,h=!0,j=!0;e=null;var n=!0,o="rgba",q="uint8",s=1,t=null,w=null,x=null,y=!1;"number"==typeof a?(f=0|a,g=0|b||f):a?("shape"in a?(f=(g=a.shape)[0],g=g[1]):("radius"in a&&(f=g=a.radius),"width"in a&&(f=a.width),"height"in a&&(g=a.height)),("color"in a||"colors"in a)&&(e=a.color||a.colors,Array.isArray(e)),e||("colorCount"in a&&(s=0|a.colorCount),"colorTexture"in a&&(n=!!a.colorTexture,o="rgba4"),"colorType"in a&&(q=a.colorType,!n)&&("half float"===q||"float16"===q?o="rgba16f":"float"!==q&&"float32"!==q||(o="rgba32f")),"colorFormat"in a&&(o=a.colorFormat,0<=u.indexOf(o)?n=!0:0<=v.indexOf(o)&&(n=!1))),("depthTexture"in a||"depthStencilTexture"in a)&&(y=!(!a.depthTexture&&!a.depthStencilTexture)),"depth"in a&&("boolean"==typeof a.depth?h=a.depth:(t=a.depth,j=!1)),"stencil"in a&&("boolean"==typeof a.stencil?j=a.stencil:(w=a.stencil,h=!1)),"depthStencil"in a&&("boolean"==typeof a.depthStencil?h=j=a.depthStencil:(x=a.depthStencil,j=h=!1))):f=g=1;var z=null,A=null,B=null,C=null;if(Array.isArray(e))z=e.map(k);else if(e)z=[k(e)];else for(z=Array(s),e=0;e<s;++e)z[e]=l(f,g,n,o,q);for(f=f||z[0].width,g=g||z[0].height,t?A=k(t):h&&!j&&(A=l(f,g,y,"depth","uint32")),w?B=k(w):j&&!h&&(B=l(f,g,!1,"stencil","uint8")),x?C=k(x):!t&&!w&&j&&h&&(C=l(f,g,y,"depth stencil","depth stencil")),h=null,e=0;e<z.length;++e)i(z[e]),z[e]&&z[e].texture&&(j=sa[z[e].texture._texture.format]*ta[z[e].texture._texture.type],null===h&&(h=j));return i(A),i(B),i(C),p(d),d.width=f,d.height=g,d.colorAttachments=z,d.depthAttachment=A,d.stencilAttachment=B,d.depthStencilAttachment=C,c.color=z.map(m),c.depth=m(A),c.stencil=m(B),c.depthStencil=m(C),c.width=d.width,c.height=d.height,r(d),c}var d=new o;return f.framebufferCount++,c(a,b),O(c,{resize:function(a,b){var e=Math.max(0|a,1),f=Math.max(0|b||e,1);if(e===d.width&&f===d.height)return c;for(var g=d.colorAttachments,h=0;h<g.length;++h)n(g[h],e,f);return n(d.depthAttachment,e,f),n(d.stencilAttachment,e,f),n(d.depthStencilAttachment,e,f),d.width=c.width=e,d.height=c.height=f,r(d),c},_reglType:"framebuffer",_framebuffer:d,destroy:function(){q(d),p(d)},use:function(a){t.setFBO({framebuffer:c},a)}})}var t={cur:null,next:null,dirty:!1,setFBO:null},u=["rgba"],v=["rgba4","rgb565","rgb5 a1"];b.ext_srgb&&v.push("srgba"),b.ext_color_buffer_half_float&&v.push("rgba16f","rgb16f"),b.webgl_color_buffer_float&&v.push("rgba32f");var w=["uint8"];b.oes_texture_half_float&&w.push("half float","float16"),b.oes_texture_float&&w.push("float","float32");var x=0,y={};return O(t,{getFramebuffer:function(a){return"function"==typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer)instanceof o?a:null},create:s,createCube:function(a){function b(a){var e,f={color:null},g=0,h=null;e="rgba";var i="uint8",j=1;if("number"==typeof a?g=0|a:a?("shape"in a?g=a.shape[0]:("radius"in a&&(g=0|a.radius),"width"in a?g=0|a.width:"height"in a&&(g=0|a.height)),("color"in a||"colors"in a)&&(h=a.color||a.colors,Array.isArray(h)),h||("colorCount"in a&&(j=0|a.colorCount),"colorType"in a&&(i=a.colorType),"colorFormat"in a&&(e=a.colorFormat)),"depth"in a&&(f.depth=a.depth),"stencil"in a&&(f.stencil=a.stencil),"depthStencil"in a&&(f.depthStencil=a.depthStencil)):g=1,h)if(Array.isArray(h))for(a=[],e=0;e<h.length;++e)a[e]=h[e];else a=[h];else for(a=Array(j),h={radius:g,format:e,type:i},e=0;e<j;++e)a[e]=d.createCube(h);for(f.color=Array(a.length),e=0;e<a.length;++e)j=a[e],g=g||j.width,f.color[e]={target:34069,data:a[e]};for(e=0;6>e;++e){for(j=0;j<a.length;++j)f.color[j].target=34069+e;0<e&&(f.depth=c[0].depth,f.stencil=c[0].stencil,f.depthStencil=c[0].depthStencil),c[e]?c[e](f):c[e]=s(f)}return O(b,{width:g,height:g,color:a})}var c=Array(6);return b(a),O(b,{faces:c,resize:function(a){var d=0|a;if(d===b.width)return b;var e=b.color;for(a=0;a<e.length;++a)e[a].resize(d);for(a=0;6>a;++a)c[a].resize(d);return b.width=b.height=d,b},_reglType:"framebufferCube",destroy:function(){c.forEach(function(a){a.destroy()})}})},clear:function(){W(y).forEach(q)},restore:function(){t.cur=null,t.next=null,t.dirty=!0,W(y).forEach(function(b){b.framebuffer=a.createFramebuffer(),r(b)})}})}function A(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function B(a,b,c,d){function e(a,b,c,d){this.name=a,this.id=b,this.location=c,this.info=d}function f(a,b){for(var c=0;c<a.length;++c)if(a[c].id===b.id)return void(a[c].location=b.location);a.push(b)}function g(c,d,e){if(!(g=(e=35632===c?j:k)[d])){var f=b.str(d),g=a.createShader(c);a.shaderSource(g,f),a.compileShader(g),e[d]=g}return g}function h(a,b){this.id=n++,this.fragId=a,this.vertId=b,this.program=null,this.uniforms=[],this.attributes=[],d.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function i(c,h){var i,j;i=g(35632,c.fragId),j=g(35633,c.vertId);var k=c.program=a.createProgram();a.attachShader(k,i),a.attachShader(k,j),a.linkProgram(k);var l=a.getProgramParameter(k,35718);d.profile&&(c.stats.uniformsCount=l);var m=c.uniforms;for(i=0;i<l;++i)if(j=a.getActiveUniform(k,i))if(1<j.size)for(var n=0;n<j.size;++n){var o=j.name.replace("[0]","["+n+"]");f(m,new e(o,b.id(o),a.getUniformLocation(k,o),j))}else f(m,new e(j.name,b.id(j.name),a.getUniformLocation(k,j.name),j));for(l=a.getProgramParameter(k,35721),d.profile&&(c.stats.attributesCount=l),m=c.attributes,i=0;i<l;++i)(j=a.getActiveAttrib(k,i))&&f(m,new e(j.name,b.id(j.name),a.getAttribLocation(k,j.name),j))}var j={},k={},l={},m=[],n=0;return d.profile&&(c.getMaxUniformsCount=function(){var a=0;return m.forEach(function(b){b.stats.uniformsCount>a&&(a=b.stats.uniformsCount)}),a},c.getMaxAttributesCount=function(){var a=0;return m.forEach(function(b){b.stats.attributesCount>a&&(a=b.stats.attributesCount)}),a}),{clear:function(){var b=a.deleteShader.bind(a);W(j).forEach(b),j={},W(k).forEach(b),k={},m.forEach(function(b){a.deleteProgram(b.program)}),m.length=0,l={},c.shaderCount=0},program:function(a,b,d){var e=l[b];e||(e=l[b]={});var f=e[a];return f||(f=new h(b,a),c.shaderCount++,i(f),e[a]=f,m.push(f)),f},restore:function(){j={},k={};for(var a=0;a<m.length;++a)i(m[a])},shader:g,frag:-1,vert:-1}}function C(a,b,c,d,e,f,g){function h(e){var f;f=null===b.next?5121:b.next.colorAttachments[0].texture._texture.type;var g=0,h=0,i=d.framebufferWidth,j=d.framebufferHeight,k=null;return V(e)?k=e:e&&(g=0|e.x,h=0|e.y,i=0|(e.width||d.framebufferWidth-g),j=0|(e.height||d.framebufferHeight-h),k=e.data||null),c(),e=i*j*4,k||(5121===f?k=new Uint8Array(e):5126===f&&(k=k||new Float32Array(e))),a.pixelStorei(3333,4),a.readPixels(g,h,i,j,6408,f,k),k}return function(a){return a&&"framebuffer"in a?function(a){var c;return b.setFBO({framebuffer:a.framebuffer},function(){c=h(a)}),c}(a):h(a)}}function D(a){return Array.prototype.slice.call(a)}function E(a){return D(a).join("")}function F(){function a(){var a=[],b=[];return O(function(){a.push.apply(a,D(arguments))},{def:function(){var d="v"+c++;return b.push(d),0<arguments.length&&(a.push(d,"="),a.push.apply(a,D(arguments)),a.push(";")),d},toString:function(){return E([0<b.length?"var "+b+";":"",E(a)])}})}function b(){function b(a,b){d(a,b,"=",c.def(a,b),";")}var c=a(),d=a(),e=c.toString,f=d.toString;return O(function(){c.apply(c,D(arguments))},{def:c.def,entry:c,exit:d,save:b,set:function(a,d,e){b(a,d),c(a,d,"=",e,";")},toString:function(){return e()+f()}})}var c=0,d=[],e=[],f=a(),g={};return{global:f,link:function(a){for(var b=0;b<e.length;++b)if(e[b]===a)return d[b];return b="g"+c++,d.push(b),e.push(a),b},block:a,proc:function(a,c){function d(){var a="a"+e.length;return e.push(a),a}var e=[];c=c||0;for(var f=0;f<c;++f)d();var h=(f=b()).toString;return g[a]=O(f,{arg:d,toString:function(){return E(["function(",e.join(),"){",h(),"}"])}})},scope:b,cond:function(){var a=E(arguments),c=b(),d=b(),e=c.toString,f=d.toString;return O(c,{then:function(){return c.apply(c,D(arguments)),this},else:function(){return d.apply(d,D(arguments)),this},toString:function(){var b=f();return b&&(b="else{"+b+"}"),E(["if(",a,"){",e(),"}",b])}})},compile:function(){var a=['"use strict";',f,"return {"];Object.keys(g).forEach(function(b){a.push('"',b,'":',g[b].toString(),",")}),a.push("}");var b=E(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,d.concat(b)).apply(null,e)}}}function G(a){return Array.isArray(a)||V(a)||i(a)}function H(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function I(a,b,c,d){this.thisDep=a,this.contextDep=b,this.propDep=c,this.append=d}function J(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function K(a){return new I(!1,!1,!1,a)}function L(a,b){var c=a.type;return 0===c?new I(!0,1<=(c=a.data.length),2<=c,b):4===c?new I((c=a.data).thisDep,c.contextDep,c.propDep,b):new I(3===c,2===c,1===c,b)}function M(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p){function r(a){return a.replace(".","_")}function s(a,b,c){var d=r(a);da.push(a),ba[d]=aa[d]=!!c,ea[d]=b}function t(a,b,c){var d=r(a);da.push(a),Array.isArray(c)?(aa[d]=c.slice(),ba[d]=c.slice()):aa[d]=ba[d]=c,fa[d]=b}function u(){var a=F(),c=a.link,d=a.global;a.id=ia++,a.batchId="0";var e=c(ga),f=a.shared={props:"a0"};Object.keys(ga).forEach(function(a){f[a]=d.def(e,".",a)});var g=a.next={},h=a.current={};Object.keys(fa).forEach(function(a){Array.isArray(aa[a])&&(g[a]=d.def(f.next,".",a),h[a]=d.def(f.current,".",a))});var i=a.constants={};Object.keys(ha).forEach(function(a){i[a]=d.def(JSON.stringify(ha[a]))}),a.invoke=function(b,d){switch(d.type){case 0:var e=["this",f.context,f.props,a.batchId];return b.def(c(d.data),".call(",e.slice(0,Math.max(d.data.length+1,4)),")");case 1:return b.def(f.props,d.data);case 2:return b.def(f.context,d.data);case 3:return b.def("this",d.data);case 4:return d.data.append(a,b),d.data.ref}},a.attribCache={};var j={};return a.scopeAttrib=function(a){if((a=b.id(a))in j)return j[a];var d=k.scope[a];return d||(d=k.scope[a]=new X),j[a]=c(d)},a}function v(a,b){var c=a.static,d=a.dynamic;if("framebuffer"in c){var e=c.framebuffer;return e?(e=i.getFramebuffer(e),K(function(a,b){var c=a.link(e),d=a.shared;return b.set(d.framebuffer,".next",c),d=d.context,b.set(d,".framebufferWidth",c+".width"),b.set(d,".framebufferHeight",c+".height"),c})):K(function(a,b){var c=a.shared;return b.set(c.framebuffer,".next","null"),c=c.context,b.set(c,".framebufferWidth",c+".drawingBufferWidth"),b.set(c,".framebufferHeight",c+".drawingBufferHeight"),"null"})}if("framebuffer"in d){var f=d.framebuffer;return L(f,function(a,b){var c=a.invoke(b,f),d=a.shared,e=d.framebuffer;return c=b.def(e,".getFramebuffer(",c,")"),b.set(e,".next",c),d=d.context,b.set(d,".framebufferWidth",c+"?"+c+".width:"+d+".drawingBufferWidth"),b.set(d,".framebufferHeight",c+"?"+c+".height:"+d+".drawingBufferHeight"),c})}return null}function w(a){function c(a){if(a in d){var c=b.id(d[a]);return(a=K(function(){return c})).id=c,a}if(a in e){var f=e[a];return L(f,function(a,b){var c=a.invoke(b,f);return b.def(a.shared.strings,".id(",c,")")})}return null}var d=a.static,e=a.dynamic,f=c("frag"),g=c("vert"),h=null;return J(f)&&J(g)?(h=l.program(g.id,f.id),a=K(function(a,b){return a.link(h)})):a=new I(f&&f.thisDep||g&&g.thisDep,f&&f.contextDep||g&&g.contextDep,f&&f.propDep||g&&g.propDep,function(a,b){var c,d,e=a.shared.shader;return c=f?f.append(a,b):b.def(e,".","frag"),d=g?g.append(a,b):b.def(e,".","vert"),b.def(e+".program("+d+","+c+")")}),{frag:f,vert:g,progVar:a,program:h}}function x(a,b){function c(a,b){if(a in d){var c=0|d[a];return K(function(a,d){return b&&(a.OFFSET=c),c})}if(a in e){var g=e[a];return L(g,function(a,c){var d=a.invoke(c,g);return b&&(a.OFFSET=d),d})}return b&&f?K(function(a,b){return a.OFFSET="0",0}):null}var d=a.static,e=a.dynamic,f=function(){if("elements"in d){var a=d.elements;G(a)?a=g.getElements(g.create(a,!0)):a&&(a=g.getElements(a));var b=K(function(b,c){if(a){var d=b.link(a);return b.ELEMENTS=d}return b.ELEMENTS=null});return b.value=a,b}if("elements"in e){var c=e.elements;return L(c,function(a,b){var d=(e=a.shared).isBufferArgs,e=e.elements,f=a.invoke(b,c),g=b.def("null");return d=b.def(d,"(",f,")"),f=a.cond(d).then(g,"=",e,".createStream(",f,");").else(g,"=",e,".getElements(",f,");"),b.entry(f),b.exit(a.cond(d).then(e,".destroyStream(",g,");")),a.ELEMENTS=g})}return null}(),h=c("offset",!0);return{elements:f,primitive:function(){if("primitive"in d){var a=d.primitive;return K(function(b,c){return ca[a]})}if("primitive"in e){var b=e.primitive;return L(b,function(a,c){var d=a.constants.primTypes,e=a.invoke(c,b);return c.def(d,"[",e,"]")})}return f?J(f)?K(f.value?function(a,b){return b.def(a.ELEMENTS,".primType")}:function(){return 4}):new I(f.thisDep,f.contextDep,f.propDep,function(a,b){var c=a.ELEMENTS;return b.def(c,"?",c,".primType:",4)}):null}(),count:function(){if("count"in d){var a=0|d.count;return K(function(){return a})}if("count"in e){var b=e.count;return L(b,function(a,c){return a.invoke(c,b)})}return f?J(f)?f?h?new I(h.thisDep,h.contextDep,h.propDep,function(a,b){return b.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):K(function(a,b){return b.def(a.ELEMENTS,".vertCount")}):K(function(){return-1}):new I(f.thisDep||h.thisDep,f.contextDep||h.contextDep,f.propDep||h.propDep,function(a,b){var c=a.ELEMENTS;return a.OFFSET?b.def(c,"?",c,".vertCount-",a.OFFSET,":-1"):b.def(c,"?",c,".vertCount:-1")}):null}(),instances:c("instances",!1),offset:h}}function y(a,c){var d=a.static,f=a.dynamic,g={};return Object.keys(d).forEach(function(a){var c=d[a],f=b.id(a),h=new X;if(G(c))h.state=1,h.buffer=e.getBuffer(e.create(c,34962,!1,!0)),h.type=0;else if(j=e.getBuffer(c))h.state=1,h.buffer=j,h.type=0;else if("constant"in c){var i=c.constant;h.buffer="null",h.state=2,"number"==typeof i?h.x=i:ua.forEach(function(a,b){b<i.length&&(h[a]=i[b])})}else{var j=G(c.buffer)?e.getBuffer(e.create(c.buffer,34962,!1,!0)):e.getBuffer(c.buffer),k=0|c.offset,l=0|c.stride,m=0|c.size,n=!!c.normalized,o=0;"type"in c&&(o=Z[c.type]),c=0|c.divisor,h.buffer=j,h.state=1,h.size=m,h.normalized=n,h.type=o||j.dtype,h.offset=k,h.stride=l,h.divisor=c}g[a]=K(function(a,b){var c=a.attribCache;if(f in c)return c[f];var d={isStream:!1};return Object.keys(h).forEach(function(a){d[a]=h[a]}),h.buffer&&(d.buffer=a.link(h.buffer),d.type=d.type||d.buffer+".dtype"),c[f]=d})}),Object.keys(f).forEach(function(a){var b=f[a];g[a]=L(b,function(a,c){function d(a){c(i[a],"=",e,".",a,"|0;")}var e=a.invoke(c,b),f=a.shared,g=f.isBufferArgs,h=f.buffer,i={isStream:c.def(!1)},j=new X;j.state=1,Object.keys(j).forEach(function(a){i[a]=c.def(""+j[a])});var k=i.buffer,l=i.type;return c("if(",g,"(",e,")){",i.isStream,"=true;",k,"=",h,".createStream(",34962,",",e,");",l,"=",k,".dtype;","}else{",k,"=",h,".getBuffer(",e,");","if(",k,"){",l,"=",k,".dtype;",'}else if("constant" in ',e,"){",i.state,"=",2,";","if(typeof "+e+'.constant === "number"){',i[ua[0]],"=",e,".constant;",ua.slice(1).map(function(a){return i[a]}).join("="),"=0;","}else{",ua.map(function(a,b){return i[a]+"="+e+".constant.length>"+b+"?"+e+".constant["+b+"]:0;"}).join(""),"}}else{","if(",g,"(",e,".buffer)){",k,"=",h,".createStream(",34962,",",e,".buffer);","}else{",k,"=",h,".getBuffer(",e,".buffer);","}",l,'="type" in ',e,"?",f.glTypes,"[",e,".type]:",k,".dtype;",i.normalized,"=!!",e,".normalized;"),d("size"),d("offset"),d("stride"),d("divisor"),c("}}"),c.exit("if(",i.isStream,"){",h,".destroyStream(",k,");","}"),i})}),g}function z(a,b,c,d,e){var g=v(a),h=function(a,b,c){function d(a){if(a in e){var c=e[a];a=!0;var d,g,h=0|c.x,i=0|c.y;return"width"in c?d=0|c.width:a=!1,"height"in c?g=0|c.height:a=!1,new I(!a&&b&&b.thisDep,!a&&b&&b.contextDep,!a&&b&&b.propDep,function(a,b){var e=a.shared.context,f=d;"width"in c||(f=b.def(e,".","framebufferWidth","-",h));var j=g;return"height"in c||(j=b.def(e,".","framebufferHeight","-",i)),[h,i,f,j]})}if(a in f){var j=f[a];return a=L(j,function(a,b){var c=a.invoke(b,j),d=a.shared.context,e=b.def(c,".x|0"),f=b.def(c,".y|0");return[e,f,b.def('"width" in ',c,"?",c,".width|0:","(",d,".","framebufferWidth","-",e,")"),c=b.def('"height" in ',c,"?",c,".height|0:","(",d,".","framebufferHeight","-",f,")")]}),b&&(a.thisDep=a.thisDep||b.thisDep,a.contextDep=a.contextDep||b.contextDep,a.propDep=a.propDep||b.propDep),a}return b?new I(b.thisDep,b.contextDep,b.propDep,function(a,b){var c=a.shared.context;return[0,0,b.def(c,".","framebufferWidth"),b.def(c,".","framebufferHeight")]}):null}var e=a.static,f=a.dynamic;if(a=d("viewport")){var g=a;a=new I(a.thisDep,a.contextDep,a.propDep,function(a,b){var c=g.append(a,b),d=a.shared.context;return b.set(d,".viewportWidth",c[2]),b.set(d,".viewportHeight",c[3]),c})}return{viewport:a,scissor_box:d("scissor.box")}}(a,g),i=x(a),j=function(a,b){var c=a.static,d=a.dynamic,e={};return da.forEach(function(a){function b(b,f){if(a in c){var h=b(c[a]);e[g]=K(function(){return h})}else if(a in d){var i=d[a];e[g]=L(i,function(a,b){return f(a,b,a.invoke(b,i))})}}var g=r(a);switch(a){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return b(function(a){return a},function(a,b,c){return c});case"depth.func":return b(function(a){return xa[a]},function(a,b,c){return b.def(a.constants.compareFuncs,"[",c,"]")});case"depth.range":return b(function(a){return a},function(a,b,c){return[b.def("+",c,"[0]"),b=b.def("+",c,"[1]")]});case"blend.func":return b(function(a){return[wa["srcRGB"in a?a.srcRGB:a.src],wa["dstRGB"in a?a.dstRGB:a.dst],wa["srcAlpha"in a?a.srcAlpha:a.src],wa["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,b,c){function d(a,d){return b.def('"',a,d,'" in ',c,"?",c,".",a,d,":",c,".",a)}a=a.constants.blendFuncs;var e=d("src","RGB"),f=d("dst","RGB"),g=(e=b.def(a,"[",e,"]"),b.def(a,"[",d("src","Alpha"),"]"));return[e,f=b.def(a,"[",f,"]"),g,a=b.def(a,"[",d("dst","Alpha"),"]")]});case"blend.equation":return b(function(a){return"string"==typeof a?[Y[a],Y[a]]:"object"==typeof a?[Y[a.rgb],Y[a.alpha]]:void 0},function(a,b,c){var d=a.constants.blendEquations,e=b.def(),f=b.def();return(a=a.cond("typeof ",c,'==="string"')).then(e,"=",f,"=",d,"[",c,"];"),a.else(e,"=",d,"[",c,".rgb];",f,"=",d,"[",c,".alpha];"),b(a),[e,f]});case"blend.color":return b(function(a){return f(4,function(b){return+a[b]})},function(a,b,c){return f(4,function(a){return b.def("+",c,"[",a,"]")})});case"stencil.mask":return b(function(a){return 0|a},function(a,b,c){return b.def(c,"|0")});case"stencil.func":return b(function(a){return[xa[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,b,c){return[a=b.def('"cmp" in ',c,"?",a.constants.compareFuncs,"[",c,".cmp]",":",7680),b.def(c,".ref|0"),b=b.def('"mask" in ',c,"?",c,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return b(function(b){return["stencil.opBack"===a?1029:1028,ya[b.fail||"keep"],ya[b.zfail||"keep"],ya[b.zpass||"keep"]]},function(b,c,d){function e(a){return c.def('"',a,'" in ',d,"?",f,"[",d,".",a,"]:",7680)}var f=b.constants.stencilOps;return["stencil.opBack"===a?1029:1028,e("fail"),e("zfail"),e("zpass")]});case"polygonOffset.offset":return b(function(a){return[0|a.factor,0|a.units]},function(a,b,c){return[b.def(c,".factor|0"),b=b.def(c,".units|0")]});case"cull.face":return b(function(a){var b=0;return"front"===a?b=1028:"back"===a&&(b=1029),b},function(a,b,c){return b.def(c,'==="front"?',1028,":",1029)});case"lineWidth":return b(function(a){return a},function(a,b,c){return c});case"frontFace":return b(function(a){return za[a]},function(a,b,c){return b.def(c+'==="cw"?2304:2305')});case"colorMask":return b(function(a){return a.map(function(a){return!!a})},function(a,b,c){return f(4,function(a){return"!!"+c+"["+a+"]"})})
;case"sample.coverage":return b(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,b,c){return[b.def('"value" in ',c,"?+",c,".value:1"),b=b.def("!!",c,".invert")]})}}),e}(a),k=w(a),l=h.viewport;return l&&(j.viewport=l),(h=h[l=r("scissor.box")])&&(j[l]=h),(g={framebuffer:g,draw:i,shader:k,state:j,dirty:h=0<Object.keys(j).length}).profile=function(a){var b,c=a.static;if(a=a.dynamic,"profile"in c){var d=!!c.profile;(b=K(function(a,b){return d})).enable=d}else if("profile"in a){var e=a.profile;b=L(e,function(a,b){return a.invoke(b,e)})}return b}(a),g.uniforms=function(a,b){var c=a.static,d=a.dynamic,e={};return Object.keys(c).forEach(function(a){var b,d=c[a];if("number"==typeof d||"boolean"==typeof d)b=K(function(){return d});else if("function"==typeof d){var g=d._reglType;"texture2d"===g||"textureCube"===g?b=K(function(a){return a.link(d)}):"framebuffer"!==g&&"framebufferCube"!==g||(b=K(function(a){return a.link(d.color[0])}))}else q(d)&&(b=K(function(a){return a.global.def("[",f(d.length,function(a){return d[a]}),"]")}));b.value=d,e[a]=b}),Object.keys(d).forEach(function(a){var b=d[a];e[a]=L(b,function(a,c){return a.invoke(c,b)})}),e}(c),g.attributes=y(b),g.context=function(a){var b=a.static,c=a.dynamic,d={};return Object.keys(b).forEach(function(a){var c=b[a];d[a]=K(function(a,b){return"number"==typeof c||"boolean"==typeof c?""+c:a.link(c)})}),Object.keys(c).forEach(function(a){var b=c[a];d[a]=L(b,function(a,c){return a.invoke(c,b)})}),d}(d),g}function A(a,b,c){var d=a.shared.context,e=a.scope();Object.keys(c).forEach(function(f){b.save(d,"."+f),e(d,".",f,"=",c[f].append(a,b),";")}),b(e)}function B(a,b,c,d){var e,f=(h=a.shared).gl,g=h.framebuffer;_&&(e=b.def(h.extensions,".webgl_draw_buffers"));var h=(i=a.constants).drawBuffer,i=i.backBuffer;a=c?c.append(a,b):b.def(g,".next"),d||b("if(",a,"!==",g,".cur){"),b("if(",a,"){",f,".bindFramebuffer(",36160,",",a,".framebuffer);"),_&&b(e,".drawBuffersWEBGL(",h,"[",a,".colorAttachments.length]);"),b("}else{",f,".bindFramebuffer(",36160,",null);"),_&&b(e,".drawBuffersWEBGL(",i,");"),b("}",g,".cur=",a,";"),d||b("}")}function C(a,b,c){var d=a.shared,e=d.gl,g=a.current,h=a.next,i=d.current,j=d.next,k=a.cond(i,".dirty");da.forEach(function(b){var d,l;if(!((b=r(b))in c.state))if(b in h){d=h[b],l=g[b];var m=f(aa[b].length,function(a){return k.def(d,"[",a,"]")});k(a.cond(m.map(function(a,b){return a+"!=="+l+"["+b+"]"}).join("||")).then(e,".",fa[b],"(",m,");",m.map(function(a,b){return l+"["+b+"]="+a}).join(";"),";"))}else d=k.def(j,".",b),m=a.cond(d,"!==",i,".",b),k(m),b in ea?m(a.cond(d).then(e,".enable(",ea[b],");").else(e,".disable(",ea[b],");"),i,".",b,"=",d,";"):m(e,".",fa[b],"(",d,");",i,".",b,"=",d,";")}),0===Object.keys(c.state).length&&k(i,".dirty=false;"),b(k)}function D(a,b,c,d){var e=a.shared,f=a.current,g=e.current,h=e.gl;H(Object.keys(c)).forEach(function(e){var i=c[e];if(!d||d(i)){var j=i.append(a,b);if(ea[e]){var k=ea[e];J(i)?b(h,j?".enable(":".disable(",k,");"):b(a.cond(j).then(h,".enable(",k,");").else(h,".disable(",k,");")),b(g,".",e,"=",j,";")}else if(q(j)){var l=f[e];b(h,".",fa[e],"(",j,");",j.map(function(a,b){return l+"["+b+"]="+a}).join(";"),";")}else b(h,".",fa[e],"(",j,");",g,".",e,"=",j,";")}})}function E(a,b){$&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function M(a,b,c,d,e){function f(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function g(a){a(j=b.def(),"=",f(),";"),"string"==typeof e?a(m,".count+=",e,";"):a(m,".count++;"),o&&(d?a(k=b.def(),"=",p,".getNumPendingQueries();"):a(p,".beginQuery(",m,");"))}function h(a){a(m,".cpuTime+=",f(),"-",j,";"),o&&(d?a(p,".pushScopeStats(",k,",",p,".getNumPendingQueries(),",m,");"):a(p,".endQuery();"))}function i(a){var c=b.def(n,".profile");b(n,".profile=",a,";"),b.exit(n,".profile=",c,";")}var j,k,l=a.shared,m=a.stats,n=l.current,p=l.timer;if(c=c.profile){if(J(c))return void(c.enable?(g(b),h(b.exit),i("true")):i("false"));i(c=c.append(a,b))}else c=b.def(n,".profile");g(l=a.block()),b("if(",c,"){",l,"}"),h(a=a.block()),b.exit("if(",c,"){",a,"}")}function N(a,b,c,d,e){function f(c,d,e){function f(){b("if(!",k,".buffer){",i,".enableVertexAttribArray(",j,");}");var c,f=e.type;c=e.size?b.def(e.size,"||",d):d,b("if(",k,".type!==",f,"||",k,".size!==",c,"||",n.map(function(a){return k+"."+a+"!=="+e[a]}).join("||"),"){",i,".bindBuffer(",34962,",",l,".buffer);",i,".vertexAttribPointer(",[j,c,f,e.normalized,e.stride,e.offset],");",k,".type=",f,";",k,".size=",c,";",n.map(function(a){return k+"."+a+"="+e[a]+";"}).join(""),"}"),$&&(f=e.divisor,b("if(",k,".divisor!==",f,"){",a.instancing,".vertexAttribDivisorANGLE(",[j,f],");",k,".divisor=",f,";}"))}function h(){b("if(",k,".buffer){",i,".disableVertexAttribArray(",j,");","}if(",ua.map(function(a,b){return k+"."+a+"!=="+m[b]}).join("||"),"){",i,".vertexAttrib4f(",j,",",m,");",ua.map(function(a,b){return k+"."+a+"="+m[b]+";"}).join(""),"}")}var i=g.gl,j=b.def(c,".location"),k=b.def(g.attributes,"[",j,"]");c=e.state;var l=e.buffer,m=[e.x,e.y,e.z,e.w],n=["buffer","normalized","offset","stride"];1===c?f():2===c?h():(b("if(",c,"===",1,"){"),f(),b("}else{"),h(),b("}"))}var g=a.shared;d.forEach(function(d){var g,h=d.name,i=c.attributes[h];if(i){if(!e(i))return;g=i.append(a,b)}else{if(!e(Aa))return;var j=a.scopeAttrib(h);g={},Object.keys(new X).forEach(function(a){g[a]=b.def(j,".",a)})}f(a.link(d),function(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(d.info.type),g)})}function O(a,c,d,e,g){for(var h,i=a.shared,j=i.gl,k=0;k<e.length;++k){var l,m=(p=e[k]).name,n=p.info.type,o=d.uniforms[m],p=a.link(p)+".location";if(o){if(!g(o))continue;if(J(o)){if(m=o.value,35678===n||35680===n)c(j,".uniform1i(",p,",",(n=a.link(m._texture||m.color[0]._texture))+".bind());"),c.exit(n,".unbind();");else if(35674===n||35675===n||35676===n)o=2,35675===n?o=3:35676===n&&(o=4),c(j,".uniformMatrix",o,"fv(",p,",false,",m=a.global.def("new Float32Array(["+Array.prototype.slice.call(m)+"])"),");");else{switch(n){case 5126:h="1f";break;case 35664:h="2f";break;case 35665:h="3f";break;case 35666:h="4f";break;case 35670:case 5124:h="1i";break;case 35671:case 35667:h="2i";break;case 35672:case 35668:h="3i";break;case 35673:h="4i";break;case 35669:h="4i"}c(j,".uniform",h,"(",p,",",q(m)?Array.prototype.slice.call(m):m,");")}continue}l=o.append(a,c)}else{if(!g(Aa))continue;l=c.def(i.uniforms,"[",b.id(m),"]")}switch(35678===n?c("if(",l,"&&",l,'._reglType==="framebuffer"){',l,"=",l,".color[0];","}"):35680===n&&c("if(",l,"&&",l,'._reglType==="framebufferCube"){',l,"=",l,".color[0];","}"),m=1,n){case 35678:case 35680:n=c.def(l,"._texture"),c(j,".uniform1i(",p,",",n,".bind());"),c.exit(n,".unbind();");continue;case 5124:case 35670:h="1i";break;case 35667:case 35671:h="2i",m=2;break;case 35668:case 35672:h="3i",m=3;break;case 35669:case 35673:h="4i",m=4;break;case 5126:h="1f";break;case 35664:h="2f",m=2;break;case 35665:h="3f",m=3;break;case 35666:h="4f",m=4;break;case 35674:h="Matrix2fv";break;case 35675:h="Matrix3fv";break;case 35676:h="Matrix4fv"}if(c(j,".uniform",h,"(",p,","),"M"===h.charAt(0)){p=Math.pow(n-35674+2,2);var r=a.global.def("new Float32Array(",p,")");c("false,(Array.isArray(",l,")||",l," instanceof Float32Array)?",l,":(",f(p,function(a){return r+"["+a+"]="+l+"["+a+"]"}),",",r,")")}else c(1<m?f(m,function(a){return l+"["+a+"]"}):l);c(");")}}function P(a,b,c,d){function e(e){var f=m[e];return f?f.contextDep&&d.contextDynamic||f.propDep?f.append(a,c):f.append(a,b):b.def(l,".",e)}function f(){function a(){c(i,".drawElementsInstancedANGLE(",[o,q,r,p+"<<(("+r+"-5121)>>1)",h],");")}function b(){c(i,".drawArraysInstancedANGLE(",[o,p,q,h],");")}n?s?a():(c("if(",n,"){"),a(),c("}else{"),b(),c("}")):b()}function g(){function a(){c(k+".drawElements("+[o,q,r,p+"<<(("+r+"-5121)>>1)"]+");")}function b(){c(k+".drawArrays("+[o,p,q]+");")}n?s?a():(c("if(",n,"){"),a(),c("}else{"),b(),c("}")):b()}var h,i,j=a.shared,k=j.gl,l=j.draw,m=d.draw,n=function(){var e=m.elements,f=b;return e?((e.contextDep&&d.contextDynamic||e.propDep)&&(f=c),e=e.append(a,f)):e=f.def(l,".","elements"),e&&f("if("+e+")"+k+".bindBuffer(34963,"+e+".buffer.buffer);"),e}(),o=e("primitive"),p=e("offset"),q=function(){var e=m.count,f=b;return e?((e.contextDep&&d.contextDynamic||e.propDep)&&(f=c),e=e.append(a,f)):e=f.def(l,".","count"),e}();if("number"==typeof q){if(0===q)return}else c("if(",q,"){"),c.exit("}");$&&(h=e("instances"),i=a.instancing);var r=n+".type",s=m.elements&&J(m.elements);$&&("number"!=typeof h||0<=h)?"string"==typeof h?(c("if(",h,">0){"),f(),c("}else if(",h,"<0){"),g(),c("}")):f():g()}function R(a,b,c,d,e){return e=(b=u()).proc("body",e),$&&(b.instancing=e.def(b.shared.extensions,".angle_instanced_arrays")),a(b,e,c,d),b.compile().body}function S(a,b,c,d){E(a,b),N(a,b,c,d.attributes,function(){return!0}),O(a,b,c,d.uniforms,function(){return!0}),P(a,b,b,c)}function T(a,b,c,d){function e(){return!0}a.batchId="a1",E(a,b),N(a,b,c,d.attributes,e),O(a,b,c,d.uniforms,e),P(a,b,b,c)}function U(a,b,c,d){function e(a){return a.contextDep&&g||a.propDep}function f(a){return!e(a)}E(a,b);var g=c.contextDep,h=b.def(),i=b.def();a.shared.props=i,a.batchId=h;var j=a.scope(),k=a.scope();b(j.entry,"for(",h,"=0;",h,"<","a1",";++",h,"){",i,"=","a0","[",h,"];",k,"}",j.exit),c.needsContext&&A(a,k,c.context),c.needsFramebuffer&&B(a,k,c.framebuffer),D(a,k,c.state,e),c.profile&&e(c.profile)&&M(a,k,c,!1,!0),d?(N(a,j,c,d.attributes,f),N(a,k,c,d.attributes,e),O(a,j,c,d.uniforms,f),O(a,k,c,d.uniforms,e),P(a,j,k,c)):(b=a.global.def("{}"),d=c.shader.progVar.append(a,k),i=k.def(d,".id"),j=k.def(b,"[",i,"]"),k(a.shared.gl,".useProgram(",d,".program);","if(!",j,"){",j,"=",b,"[",i,"]=",a.link(function(b){return R(T,a,c,b,2)}),"(",d,");}",j,".call(this,a0[",h,"],",h,");"))}function V(a,c){function d(b){var d=c.shader[b];d&&e.set(f.shader,"."+b,d.append(a,e))}var e=a.proc("scope",3);a.batchId="a2";var f=a.shared,g=f.current;A(a,e,c.context),c.framebuffer&&c.framebuffer.append(a,e),H(Object.keys(c.state)).forEach(function(b){var d=c.state[b].append(a,e);q(d)?d.forEach(function(c,d){e.set(a.next[b],"["+d+"]",c)}):e.set(f.next,"."+b,d)}),M(a,e,c,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(b){var d=c.draw[b];d&&e.set(f.draw,"."+b,""+d.append(a,e))}),Object.keys(c.uniforms).forEach(function(d){e.set(f.uniforms,"["+b.id(d)+"]",c.uniforms[d].append(a,e))}),Object.keys(c.attributes).forEach(function(b){var d=c.attributes[b].append(a,e),f=a.scopeAttrib(b);Object.keys(new X).forEach(function(a){e.set(f,"."+a,d[a])})}),d("vert"),d("frag"),0<Object.keys(c.state).length&&(e(g,".dirty=true;"),e.exit(g,".dirty=true;")),e("a1(",a.shared.context,",a0,",a.batchId,");")}function W(a,b,c){var d=b.static[c];if(d&&function(a){if("object"==typeof a&&!q(a)){for(var b=Object.keys(a),c=0;c<b.length;++c)if(Q.isDynamic(a[b[c]]))return!0;return!1}}(d)){var e=a.global,f=Object.keys(d),g=!1,h=!1,i=!1,j=a.global.def("{}");f.forEach(function(b){var c=d[b];if(Q.isDynamic(c))"function"==typeof c&&(c=d[b]=Q.unbox(c)),b=L(c,null),g=g||b.thisDep,i=i||b.propDep,h=h||b.contextDep;else{switch(e(j,".",b,"="),typeof c){case"number":e(c);break;case"string":e('"',c,'"');break;case"object":Array.isArray(c)&&e("[",c.join(),"]");break;default:e(a.link(c))}e(";")}}),b.dynamic[c]=new Q.DynamicVariable(4,{thisDep:g,contextDep:h,propDep:i,ref:j,append:function(a,b){f.forEach(function(c){var e=d[c];Q.isDynamic(e)&&(e=a.invoke(b,e),b(j,".",c,"=",e,";"))})}}),delete b.static[c]}}var X=k.Record,Y={add:32774,subtract:32778,"reverse subtract":32779};c.ext_blend_minmax&&(Y.min=32775,Y.max=32776);var $=c.angle_instanced_arrays,_=c.webgl_draw_buffers,aa={dirty:!0,profile:p.profile},ba={},da=[],ea={},fa={};s("dither",3024),s("blend.enable",3042),t("blend.color","blendColor",[0,0,0,0]),t("blend.equation","blendEquationSeparate",[32774,32774]),t("blend.func","blendFuncSeparate",[1,0,1,0]),s("depth.enable",2929,!0),t("depth.func","depthFunc",513),t("depth.range","depthRange",[0,1]),t("depth.mask","depthMask",!0),t("colorMask","colorMask",[!0,!0,!0,!0]),s("cull.enable",2884),t("cull.face","cullFace",1029),t("frontFace","frontFace",2305),t("lineWidth","lineWidth",1),s("polygonOffset.enable",32823),t("polygonOffset.offset","polygonOffset",[0,0]),s("sample.alpha",32926),s("sample.enable",32928),t("sample.coverage","sampleCoverage",[1,!1]),s("stencil.enable",2960),t("stencil.mask","stencilMask",-1),t("stencil.func","stencilFunc",[519,0,-1]),t("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),t("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),s("scissor.enable",3089),t("scissor.box","scissor",[0,0,a.drawingBufferWidth,a.drawingBufferHeight]),t("viewport","viewport",[0,0,a.drawingBufferWidth,a.drawingBufferHeight]);var ga={gl:a,context:n,strings:b,next:ba,current:aa,draw:m,elements:g,buffer:e,shader:l,attributes:k.state,uniforms:j,framebuffer:i,extensions:c,timer:o,isBufferArgs:G},ha={primTypes:ca,compareFuncs:xa,blendFuncs:wa,blendEquations:Y,stencilOps:ya,glTypes:Z,orientationType:za};_&&(ha.backBuffer=[1029],ha.drawBuffer=f(d.maxDrawbuffers,function(a){return 0===a?[0]:f(a,function(a){return 36064+a})}));var ia=0;return{next:ba,current:aa,procs:function(){var a=u(),b=a.proc("poll"),c=a.proc("refresh"),e=a.block();b(e),c(e);var g,h=a.shared,i=h.gl,j=h.next,k=h.current;e(k,".dirty=false;"),B(a,b),B(a,c,null,!0),$&&(g=a.link($));for(var l=0;l<d.maxAttributes;++l){var m=c.def(h.attributes,"[",l,"]"),n=a.cond(m,".buffer");n.then(i,".enableVertexAttribArray(",l,");",i,".bindBuffer(",34962,",",m,".buffer.buffer);",i,".vertexAttribPointer(",l,",",m,".size,",m,".type,",m,".normalized,",m,".stride,",m,".offset);").else(i,".disableVertexAttribArray(",l,");",i,".vertexAttrib4f(",l,",",m,".x,",m,".y,",m,".z,",m,".w);",m,".buffer=null;"),c(n),$&&c(g,".vertexAttribDivisorANGLE(",l,",",m,".divisor);")}return Object.keys(ea).forEach(function(d){var f=ea[d],g=e.def(j,".",d),h=a.block();h("if(",g,"){",i,".enable(",f,")}else{",i,".disable(",f,")}",k,".",d,"=",g,";"),c(h),b("if(",g,"!==",k,".",d,"){",h,"}")}),Object.keys(fa).forEach(function(d){var g,h,l=fa[d],m=aa[d],n=a.block();n(i,".",l,"("),q(m)?(l=m.length,g=a.global.def(j,".",d),h=a.global.def(k,".",d),n(f(l,function(a){return g+"["+a+"]"}),");",f(l,function(a){return h+"["+a+"]="+g+"["+a+"];"}).join("")),b("if(",f(l,function(a){return g+"["+a+"]!=="+h+"["+a+"]"}).join("||"),"){",n,"}")):(g=e.def(j,".",d),h=e.def(k,".",d),n(g,");",k,".",d,"=",g,";"),b("if(",g,"!==",h,"){",n,"}")),c(n)}),a.compile()}(),compile:function(a,b,c,d,e){var f=u();return f.stats=f.link(e),Object.keys(b.static).forEach(function(a){W(f,b,a)}),va.forEach(function(b){W(f,a,b)}),c=z(a,b,c,d),function(a,b){var c=a.proc("draw",1);E(a,c),A(a,c,b.context),B(a,c,b.framebuffer),C(a,c,b),D(a,c,b.state),M(a,c,b,!1,!0);var d=b.shader.progVar.append(a,c);if(c(a.shared.gl,".useProgram(",d,".program);"),b.shader.program)S(a,c,b,b.shader.program);else{var e=a.global.def("{}"),f=c.def(d,".id"),g=c.def(e,"[",f,"]");c(a.cond(g).then(g,".call(this,a0);").else(g,"=",e,"[",f,"]=",a.link(function(c){return R(S,a,b,c,1)}),"(",d,");",g,".call(this,a0);"))}0<Object.keys(b.state).length&&c(a.shared.current,".dirty=true;")}(f,c),V(f,c),function(a,b){function c(a){return a.contextDep&&e||a.propDep}var d=a.proc("batch",2);a.batchId="0",E(a,d);var e=!1,f=!0;Object.keys(b.context).forEach(function(a){e=e||b.context[a].propDep}),e||(A(a,d,b.context),f=!1);var g=!1;if((h=b.framebuffer)?(h.propDep?e=g=!0:h.contextDep&&e&&(g=!0),g||B(a,d,h)):B(a,d,null),b.state.viewport&&b.state.viewport.propDep&&(e=!0),C(a,d,b),D(a,d,b.state,function(a){return!c(a)}),b.profile&&c(b.profile)||M(a,d,b,!1,"a1"),b.contextDep=e,b.needsContext=f,b.needsFramebuffer=g,(f=b.shader.progVar).contextDep&&e||f.propDep)U(a,d,b,null);else if(f=f.append(a,d),d(a.shared.gl,".useProgram(",f,".program);"),b.shader.program)U(a,d,b,b.shader.program);else{var h=a.global.def("{}"),i=(g=d.def(f,".id"),d.def(h,"[",g,"]"));d(a.cond(i).then(i,".call(this,a0,a1);").else(i,"=",h,"[",g,"]=",a.link(function(c){return R(U,a,b,c,2)}),"(",f,");",i,".call(this,a0,a1);"))}0<Object.keys(b.state).length&&d(a.shared.current,".dirty=true;")}(f,c),f.compile()}}}function N(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}var O=function(a,b){for(var c=Object.keys(b),d=0;d<c.length;++d)a[c[d]]=b[c[d]];return a},P=0,Q={DynamicVariable:a,define:function(c,d){return new a(c,b(d+""))},isDynamic:function(b){return"function"==typeof b&&!b._reglType||b instanceof a},unbox:function(b,c){return"function"==typeof b?new a(0,b):b},accessor:b},R={next:"function"==typeof requestAnimationFrame?function(a){return requestAnimationFrame(a)}:function(a){return setTimeout(a,16)},cancel:"function"==typeof cancelAnimationFrame?function(a){return cancelAnimationFrame(a)}:clearTimeout},S="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},T=h();T.zero=h();var U=function(a,b){var c=1;b.ext_texture_filter_anisotropic&&(c=a.getParameter(34047));var d=1,e=1;b.webgl_draw_buffers&&(d=a.getParameter(34852),e=a.getParameter(36063));var f=!!b.oes_texture_float;if(f){f=a.createTexture(),a.bindTexture(3553,f),a.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var g=a.createFramebuffer();if(a.bindFramebuffer(36160,g),a.framebufferTexture2D(36160,36064,3553,f,0),a.bindTexture(3553,null),36053!==a.checkFramebufferStatus(36160))f=!1;else{a.viewport(0,0,1,1),a.clearColor(1,0,0,1),a.clear(16384);var h=T.allocType(5126,4);a.readPixels(0,0,1,1,6408,5126,h),a.getError()?f=!1:(a.deleteFramebuffer(g),a.deleteTexture(f),f=1===h[0]),T.freeType(h)}}return h=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(h=a.createTexture(),g=T.allocType(5121,36),a.activeTexture(33984),a.bindTexture(34067,h),a.texImage2D(34069,0,6408,3,3,0,6408,5121,g),T.freeType(g),a.bindTexture(34067,null),a.deleteTexture(h),h=!a.getError()),{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(b).filter(function(a){return!!b[a]}),maxAnisotropic:c,maxDrawbuffers:d,maxColorAttachments:e,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938),readFloat:f,npotTextureCube:h}},V=function(a){return a instanceof Uint8Array||a instanceof Uint16Array||a instanceof Uint32Array||a instanceof Int8Array||a instanceof Int16Array||a instanceof Int32Array||a instanceof Float32Array||a instanceof Float64Array||a instanceof Uint8ClampedArray},W=function(a){return Object.keys(a).map(function(b){return a[b]})},X={shape:function(a){for(var b=[];a.length;a=a[0])b.push(a.length);return b},flatten:function(a,b,c,d){var e=1;if(b.length)for(var f=0;f<b.length;++f)e*=b[f];else e=0;switch(c=d||T.allocType(c,e),b.length){case 0:break;case 1:for(d=b[0],b=0;b<d;++b)c[b]=a[b];break;case 2:for(d=b[0],b=b[1],f=e=0;f<d;++f)for(var g=a[f],h=0;h<b;++h)c[e++]=g[h];break;case 3:j(a,b[0],b[1],b[2],c,0);break;default:!function a(b,c,d,e,f){for(var g=1,h=d+1;h<c.length;++h)g*=c[h];var i=c[d];if(4==c.length-d){var k=c[d+1],l=c[d+2];for(c=c[d+3],h=0;h<i;++h)j(b[h],k,l,c,e,f),f+=g}else for(h=0;h<i;++h)a(b[h],c,d+1,e,f),f+=g}(a,b,0,c,0)}return c}},Y={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Z={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},$={dynamic:35048,stream:35040,static:35044},_=X.flatten,aa=X.shape,ba=[];ba[5120]=1,ba[5122]=2,ba[5124]=4,ba[5121]=1,ba[5123]=2,ba[5125]=4,ba[5126]=4;var ca={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},da=new Float32Array(1),ea=new Uint32Array(da.buffer),fa=[9984,9986,9985,9987],ga=[0,6409,6410,6407,6408],ha={};ha[6409]=ha[6406]=ha[6402]=1,ha[34041]=ha[6410]=2,ha[6407]=ha[35904]=3,ha[6408]=ha[35906]=4;var ia=r("HTMLCanvasElement"),ja=r("CanvasRenderingContext2D"),ka=r("ImageBitmap"),la=r("HTMLImageElement"),ma=r("HTMLVideoElement"),na=Object.keys(Y).concat([ia,ja,ka,la,ma]),oa=[];oa[5121]=1,oa[5126]=4,oa[36193]=2,oa[5123]=2,oa[5125]=4;var pa=[];pa[32854]=2,pa[32855]=2,pa[36194]=2,pa[34041]=4,pa[33776]=.5,pa[33777]=.5,pa[33778]=1,pa[33779]=1,pa[35986]=.5,pa[35987]=1,pa[34798]=1,pa[35840]=.5,pa[35841]=.25,pa[35842]=.5,pa[35843]=.25,pa[36196]=.5;var qa=[];qa[32854]=2,qa[32855]=2,qa[36194]=2,qa[33189]=2,qa[36168]=1,qa[34041]=4,qa[35907]=4,qa[34836]=16,qa[34842]=8,qa[34843]=6;var ra=function(a,b,c,d,e){function f(a){this.id=j++,this.refCount=1,this.renderbuffer=a,this.format=32854,this.height=this.width=0,e.profile&&(this.stats={size:0})}function g(b){var c=b.renderbuffer;a.bindRenderbuffer(36161,null),a.deleteRenderbuffer(c),b.renderbuffer=null,b.refCount=0,delete k[b.id],d.renderbufferCount--}var h={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};b.ext_srgb&&(h.srgba=35907),b.ext_color_buffer_half_float&&(h.rgba16f=34842,h.rgb16f=34843),b.webgl_color_buffer_float&&(h.rgba32f=34836);var i=[];Object.keys(h).forEach(function(a){i[h[a]]=a});var j=0,k={};return f.prototype.decRef=function(){0>=--this.refCount&&g(this)},e.profile&&(d.getTotalRenderbufferSize=function(){var a=0;return Object.keys(k).forEach(function(b){a+=k[b].stats.size}),a}),{create:function(b,c){function g(b,c){var d=0,f=0,k=32854;if("object"==typeof b&&b?("shape"in b?(d=0|(f=b.shape)[0],f=0|f[1]):("radius"in b&&(d=f=0|b.radius),"width"in b&&(d=0|b.width),"height"in b&&(f=0|b.height)),"format"in b&&(k=h[b.format])):"number"==typeof b?(d=0|b,f="number"==typeof c?0|c:d):b||(d=f=1),d!==j.width||f!==j.height||k!==j.format)return g.width=j.width=d,g.height=j.height=f,j.format=k,a.bindRenderbuffer(36161,j.renderbuffer),a.renderbufferStorage(36161,k,d,f),e.profile&&(j.stats.size=qa[j.format]*j.width*j.height),g.format=i[j.format],g}var j=new f(a.createRenderbuffer());return k[j.id]=j,d.renderbufferCount++,g(b,c),g.resize=function(b,c){var d=0|b,f=0|c||d;return d===j.width&&f===j.height?g:(g.width=j.width=d,g.height=j.height=f,a.bindRenderbuffer(36161,j.renderbuffer),a.renderbufferStorage(36161,j.format,d,f),e.profile&&(j.stats.size=qa[j.format]*j.width*j.height),g)},g._reglType="renderbuffer",g._renderbuffer=j,e.profile&&(g.stats=j.stats),g.destroy=function(){j.decRef()},g},clear:function(){W(k).forEach(g)},restore:function(){W(k).forEach(function(b){b.renderbuffer=a.createRenderbuffer(),a.bindRenderbuffer(36161,b.renderbuffer),a.renderbufferStorage(36161,b.format,b.width,b.height)}),a.bindRenderbuffer(36161,null)}}},sa=[];sa[6408]=4,sa[6407]=3;var ta=[];ta[5121]=1,ta[5126]=4,ta[36193]=2;var ua=["x","y","z","w"],va="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),wa={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},xa={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ya={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},za={cw:2304,ccw:2305},Aa=new I(!1,!1,!1,function(){});return function(a){function b(){if(0===X.length)w&&w.update(),_=null;else{_=R.next(b),l();for(var a=X.length-1;0<=a;--a){var c=X[a];c&&c(F,null,0)}q.flush(),w&&w.update()}}function c(){!_&&0<X.length&&(_=R.next(b))}function d(){_&&(R.cancel(b),_=null)}function f(a){a.preventDefault(),d(),Y.forEach(function(a){a()})}function g(a){q.getError(),s.restore(),J.restore(),H.restore(),K.restore(),L.restore(),P.restore(),w&&w.restore(),T.procs.refresh(),c(),Z.forEach(function(a){a()})}function h(a){function b(a){var b={},c={};return Object.keys(a).forEach(function(d){var e=a[d];Q.isDynamic(e)?c[d]=Q.unbox(e,d):b[d]=e}),{dynamic:c,static:b}}var c=b(a.context||{}),d=b(a.uniforms||{}),e=b(a.attributes||{}),f=b(function(a){function b(a){if(a in c){var b=c[a];delete c[a],Object.keys(b).forEach(function(d){c[a+"."+d]=b[d]})}}var c=O({},a);return delete c.uniforms,delete c.attributes,delete c.context,"stencil"in c&&c.stencil.op&&(c.stencil.opBack=c.stencil.opFront=c.stencil.op,delete c.stencil.op),b("blend"),b("depth"),b("cull"),b("stencil"),b("polygonOffset"),b("scissor"),b("sample"),c}(a));a={gpuTime:0,cpuTime:0,count:0};var g=(c=T.compile(f,e,d,c,a)).draw,h=c.batch,i=c.scope,j=[];return O(function(a,b){var c;if("function"==typeof a)return i.call(this,null,a,0);if("function"==typeof b)if("number"==typeof a)for(c=0;c<a;++c)i.call(this,null,b,c);else{if(!Array.isArray(a))return i.call(this,a,b,0);for(c=0;c<a.length;++c)i.call(this,a[c],b,c)}else if("number"==typeof a){if(0<a)return h.call(this,function(a){for(;j.length<a;)j.push(null);return j}(0|a),0|a)}else{if(!Array.isArray(a))return g.call(this,a);if(a.length)return h.call(this,a,a.length)}},{stats:a})}function i(a,b){var c=0;T.procs.poll();var d=b.color;d&&(q.clearColor(+d[0]||0,+d[1]||0,+d[2]||0,+d[3]||0),c|=16384),"depth"in b&&(q.clearDepth(+b.depth),c|=256),"stencil"in b&&(q.clearStencil(0|b.stencil),c|=1024),q.clear(c)}function j(a){return X.push(a),c(),{cancel:function(){var b=N(X,a);X[b]=function a(){var b=N(X,a);X[b]=X[X.length-1],0>=--X.length&&d()}}}}function k(){var a=V.viewport,b=V.scissor_box;a[0]=a[1]=b[0]=b[1]=0,F.viewportWidth=F.framebufferWidth=F.drawingBufferWidth=a[2]=b[2]=q.drawingBufferWidth,F.viewportHeight=F.framebufferHeight=F.drawingBufferHeight=a[3]=b[3]=q.drawingBufferHeight}function l(){F.tick+=1,F.time=p(),k(),T.procs.poll()}function m(){k(),T.procs.refresh(),w&&w.update()}function p(){return(S()-x)/1e3}if(!(a=e(a)))return null;var q=a.gl,r=q.getContextAttributes();q.isContextLost();var s=function(a,b){function c(b){var c;b=b.toLowerCase();try{c=d[b]=a.getExtension(b)}catch(a){}return!!c}for(var d={},e=0;e<b.extensions.length;++e){var f=b.extensions[e];if(!c(f))return b.onDestroy(),b.onDone('"'+f+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return b.optionalExtensions.forEach(c),{extensions:d,restore:function(){Object.keys(d).forEach(function(a){if(d[a]&&!c(a))throw Error("(regl): error restoring extension "+a)})}}}(q,a);if(!s)return null;var t=function(){var a={"":0},b=[""];return{id:function(c){var d=a[c];return d||(d=a[c]=b.length,b.push(c),d)},str:function(a){return b[a]}}}(),u={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},v=s.extensions,w=function(a,b){function c(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function d(a,b,d){var e=g.pop()||new c;e.startQueryIndex=a,e.endQueryIndex=b,e.sum=0,e.stats=d,h.push(e)}if(!b.ext_disjoint_timer_query)return null;var e=[],f=[],g=[],h=[],i=[],j=[];return{beginQuery:function(a){var c=e.pop()||b.ext_disjoint_timer_query.createQueryEXT();b.ext_disjoint_timer_query.beginQueryEXT(35007,c),f.push(c),d(f.length-1,f.length,a)},endQuery:function(){b.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:d,update:function(){var a,c;if(0!==(a=f.length)){j.length=Math.max(j.length,a+1),i.length=Math.max(i.length,a+1),i[0]=0;var d=j[0]=0;for(c=a=0;c<f.length;++c){var k=f[c];b.ext_disjoint_timer_query.getQueryObjectEXT(k,34919)?(d+=b.ext_disjoint_timer_query.getQueryObjectEXT(k,34918),e.push(k)):f[a++]=k,i[c+1]=d,j[c+1]=a}for(f.length=a,c=a=0;c<h.length;++c){var l=(d=h[c]).startQueryIndex;k=d.endQueryIndex,d.sum+=i[k]-i[l],l=j[l],(k=j[k])===l?(d.stats.gpuTime+=d.sum/1e6,g.push(d)):(d.startQueryIndex=l,d.endQueryIndex=k,h[a++]=d)}h.length=a}},getNumPendingQueries:function(){return f.length},clear:function(){e.push.apply(e,f);for(var a=0;a<e.length;a++)b.ext_disjoint_timer_query.deleteQueryEXT(e[a]);f.length=0,e.length=0},restore:function(){f.length=0,e.length=0}}}(0,v),x=S(),D=q.drawingBufferWidth,E=q.drawingBufferHeight,F={tick:0,time:0,viewportWidth:D,viewportHeight:E,framebufferWidth:D,framebufferHeight:E,drawingBufferWidth:D,drawingBufferHeight:E,pixelRatio:a.pixelRatio},G=U(q,v),H=(D=function(a,b,c,d){for(a=c.maxAttributes,b=Array(a),c=0;c<a;++c)b[c]=new A;return{Record:A,scope:{},state:b}}(q,v,G),n(q,u,a,D)),I=o(q,v,H,u),J=B(q,t,u,a),K=y(q,v,G,function(){T.procs.poll()},F,u,a),L=ra(q,v,0,u,a),P=z(q,v,G,K,L,u),T=M(q,t,v,G,H,I,0,P,{},D,J,{elements:null,primitive:4,count:-1,offset:0,instances:-1},F,w,a),V=(t=C(q,P,T.procs.poll,F),T.next),W=q.canvas,X=[],Y=[],Z=[],$=[a.onDestroy],_=null;W&&(W.addEventListener("webglcontextlost",f,!1),W.addEventListener("webglcontextrestored",g,!1));var aa=P.setFBO=h({framebuffer:Q.define.call(null,1,"framebuffer")});return m(),r=O(h,{clear:function(a){if("framebuffer"in a)if(a.framebuffer&&"framebufferCube"===a.framebuffer_reglType)for(var b=0;6>b;++b)aa(O({framebuffer:a.framebuffer.faces[b]},a),i);else aa(a,i);else i(0,a)},prop:Q.define.bind(null,1),context:Q.define.bind(null,2),this:Q.define.bind(null,3),draw:h({}),buffer:function(a){return H.create(a,34962,!1,!1)},elements:function(a){return I.create(a,!1)},texture:K.create2D,cube:K.createCube,renderbuffer:L.create,framebuffer:P.create,framebufferCube:P.createCube,attributes:r,frame:j,on:function(a,b){var c;switch(a){case"frame":return j(b);case"lost":c=Y;break;case"restore":c=Z;break;case"destroy":c=$}return c.push(b),{cancel:function(){for(var a=0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1],c.pop();break}}}},limits:G,hasExtension:function(a){return 0<=G.extensions.indexOf(a.toLowerCase())},read:t,destroy:function(){X.length=0,d(),W&&(W.removeEventListener("webglcontextlost",f),W.removeEventListener("webglcontextrestored",g)),J.clear(),P.clear(),L.clear(),K.clear(),I.clear(),H.clear(),w&&w.clear(),$.forEach(function(a){a()})},_gl:q,_refresh:m,poll:function(){l(),w&&w.update()},now:p,stats:u}),a.onDone(null,r),r}},"object"==typeof c&&void 0!==b?b.exports=e():d.createREGL=e()},{}],504:[function(a,b,c){"use strict";var d,e="";b.exports=function(a,b){if("string"!=typeof a)throw new TypeError("expected a string");if(1===b)return a;if(2===b)return a+a;var c=a.length*b;if(d!==a||void 0===d)d=a,e="";else if(e.length>=c)return e.substr(0,c);for(;c>e.length&&b>1;)1&b&&(e+=a),b>>=1,a+=a;return e=(e+=a).substr(0,c)}},{}],505:[function(a,b,c){(function(a){b.exports=a.performance&&a.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],506:[function(a,b,c){"use strict";b.exports=function(a){for(var b=a.length,c=a[a.length-1],d=b,e=b-2;e>=0;--e){var f=c,g=a[e],h=(c=f+g)-f,i=g-h;i&&(a[--d]=c,c=i)}for(var j=0,e=d;e<b;++e){var f=a[e],g=c,h=(c=f+g)-f,i=g-h;i&&(a[j++]=i)}return a[j++]=c,a.length=j,a}},{}],
507:[function(a,b,c){"use strict";function d(a,b){for(var c=new Array(a.length-1),d=1;d<a.length;++d)for(var e=c[d-1]=new Array(a.length-1),f=0,g=0;f<a.length;++f)f!==b&&(e[g++]=a[d][f]);return c}function e(a){if(2===a.length)return["sum(prod(",a[0][0],",",a[1][1],"),prod(-",a[0][1],",",a[1][0],"))"].join("");for(var b=[],c=0;c<a.length;++c)b.push(["scale(",e(d(a,c)),",",(f=c,1&f?"-":""),a[0][c],")"].join(""));return function a(b){if(1===b.length)return b[0];if(2===b.length)return["sum(",b[0],",",b[1],")"].join("");var c=b.length>>1;return["sum(",a(b.slice(0,c)),",",a(b.slice(c)),")"].join("")}(b);var f}function f(a){return new Function("sum","scale","prod","compress",["function robustDeterminant",a,"(m){return compress(",e(function(a){for(var b=new Array(a),c=0;c<a;++c){b[c]=new Array(a);for(var d=0;d<a;++d)b[c][d]=["m[",c,"][",d,"]"].join("")}return b}(a)),")};return robustDeterminant",a].join(""))(h,i,g,j)}var g=a("two-product"),h=a("robust-sum"),i=a("robust-scale"),j=a("robust-compress"),k=[function(){return[0]},function(a){return[a[0][0]]}];!function(){for(;k.length<6;)k.push(f(k.length));for(var a=[],c=["function robustDeterminant(m){switch(m.length){"],d=0;d<6;++d)a.push("det"+d),c.push("case ",d,":return det",d,"(m);");c.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant"),a.push("CACHE","gen",c.join(""));var e=Function.apply(void 0,a);for(b.exports=e.apply(void 0,k.concat([k,f])),d=0;d<k.length;++d)b.exports[d]=k[d]}()},{"robust-compress":506,"robust-scale":513,"robust-sum":516,"two-product":544}],508:[function(a,b,c){"use strict";var d=a("two-product"),e=a("robust-sum");b.exports=function(a,b){for(var c=d(a[0],b[0]),f=1;f<a.length;++f)c=e(c,d(a[f],b[f]));return c}},{"robust-sum":516,"two-product":544}],509:[function(a,b,c){"use strict";function d(a,b){for(var c=new Array(a.length-1),d=1;d<a.length;++d)for(var e=c[d-1]=new Array(a.length-1),f=0,g=0;f<a.length;++f)f!==b&&(e[g++]=a[d][f]);return c}function e(a){if(1===a.length)return a[0];if(2===a.length)return["sum(",a[0],",",a[1],")"].join("");var b=a.length>>1;return["sum(",e(a.slice(0,b)),",",e(a.slice(b)),")"].join("")}function f(a,b){if("m"===a.charAt(0)){if("w"===b.charAt(0)){var c=a.split("[");return["w",b.substr(1),"m",c[0].substr(1)].join("")}return["prod(",a,",",b,")"].join("")}return f(b,a)}function g(a){if(2===a.length)return[["diff(",f(a[0][0],a[1][1]),",",f(a[1][0],a[0][1]),")"].join("")];for(var b=[],c=0;c<a.length;++c)b.push(["scale(",e(g(d(a,c))),",",(h=c,!0&h?"-":""),a[0][c],")"].join(""));return b;var h}function h(a,b){for(var c=[],d=0;d<b-2;++d)c.push(["prod(m",a,"[",d,"],m",a,"[",d,"])"].join(""));return e(c)}function i(a){for(var b=[],c=[],f=function(a){for(var b=new Array(a),c=0;c<a;++c){b[c]=new Array(a);for(var d=0;d<a;++d)b[c][d]=["m",d,"[",a-c-2,"]"].join("")}return b}(a),i=0;i<a;++i)f[0][i]="1",f[a-1][i]="w"+i;for(i=0;i<a;++i)0==(1&i)?b.push.apply(b,g(d(f,i))):c.push.apply(c,g(d(f,i)));var n=e(b),o=e(c),p="exactInSphere"+a,q=[];for(i=0;i<a;++i)q.push("m"+i);var r=["function ",p,"(",q.join(),"){"];for(i=0;i<a;++i){r.push("var w",i,"=",h(i,a),";");for(var s=0;s<a;++s)s!==i&&r.push("var w",i,"m",s,"=scale(w",i,",m",s,"[0]);")}return r.push("var p=",n,",n=",o,",d=diff(p,n);return d[d.length-1];}return ",p),new Function("sum","diff","prod","scale",r.join(""))(k,l,j,m)}var j=a("two-product"),k=a("robust-sum"),l=a("robust-subtract"),m=a("robust-scale"),n=[function(){return 0},function(){return 0},function(){return 0}];!function(){for(;n.length<=6;)n.push(i(n.length));for(var a=[],c=["slow"],d=0;d<=6;++d)a.push("a"+d),c.push("o"+d);var e=["function testInSphere(",a.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(d=2;d<=6;++d)e.push("case ",d,":return o",d,"(",a.slice(0,d).join(),");");e.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere"),c.push(e.join(""));var f=Function.apply(void 0,c);for(b.exports=f.apply(void 0,[function(a){var b=n[a.length];return b||(b=n[a.length]=i(a.length)),b.apply(void 0,a)}].concat(n)),d=0;d<=6;++d)b.exports[d]=n[d]}()},{"robust-scale":513,"robust-subtract":515,"robust-sum":516,"two-product":544}],510:[function(a,b,c){"use strict";function d(a){for(var b="robustLinearSolve"+a+"d",c=["function ",b,"(A,b){return ["],d=0;d<a;++d){c.push("det([");for(var f=0;f<a;++f){f>0&&c.push(","),c.push("[");for(var g=0;g<a;++g)g>0&&c.push(","),g===d?c.push("+b[",f,"]"):c.push("+A[",f,"][",g,"]");c.push("]")}c.push("]),")}return c.push("det(A)]}return ",b),new Function("det",c.join(""))(a<6?e[a]:e)}var e=a("robust-determinant"),f=[function(){return[0]},function(a,b){return[[b[0]],[a[0][0]]]}];!function(){for(;f.length<6;)f.push(d(f.length));for(var a=[],c=["function dispatchLinearSolve(A,b){switch(A.length){"],e=0;e<6;++e)a.push("s"+e),c.push("case ",e,":return s",e,"(A,b);");c.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve"),a.push("CACHE","g",c.join(""));var g=Function.apply(void 0,a);for(b.exports=g.apply(void 0,f.concat([f,d])),e=0;e<6;++e)b.exports[e]=f[e]}()},{"robust-determinant":507}],511:[function(a,b,c){"use strict";function d(a,b){for(var c=new Array(a.length-1),d=1;d<a.length;++d)for(var e=c[d-1]=new Array(a.length-1),f=0,g=0;f<a.length;++f)f!==b&&(e[g++]=a[d][f]);return c}function e(a){if(1===a.length)return a[0];if(2===a.length)return["sum(",a[0],",",a[1],")"].join("");var b=a.length>>1;return["sum(",e(a.slice(0,b)),",",e(a.slice(b)),")"].join("")}function f(a){if(2===a.length)return[["sum(prod(",a[0][0],",",a[1][1],"),prod(-",a[0][1],",",a[1][0],"))"].join("")];for(var b=[],c=0;c<a.length;++c)b.push(["scale(",e(f(d(a,c))),",",(g=c,1&g?"-":""),a[0][c],")"].join(""));return b;var g}function g(a){for(var b=[],c=[],g=function(a){for(var b=new Array(a),c=0;c<a;++c){b[c]=new Array(a);for(var d=0;d<a;++d)b[c][d]=["m",d,"[",a-c-1,"]"].join("")}return b}(a),l=[],m=0;m<a;++m)0==(1&m)?b.push.apply(b,f(d(g,m))):c.push.apply(c,f(d(g,m))),l.push("m"+m);var n=e(b),o=e(c),p="orientation"+a+"Exact",q=["function ",p,"(",l.join(),"){var p=",n,",n=",o,",d=sub(p,n);return d[d.length-1];};return ",p].join("");return new Function("sum","prod","scale","sub",q)(i,h,j,k)}var h=a("two-product"),i=a("robust-sum"),j=a("robust-scale"),k=a("robust-subtract"),l=g(3),m=g(4),n=[function(){return 0},function(){return 0},function(a,b){return b[0]-a[0]},function(a,b,c){var d,e=(a[1]-c[1])*(b[0]-c[0]),f=(a[0]-c[0])*(b[1]-c[1]),g=e-f;if(e>0){if(f<=0)return g;d=e+f}else{if(!(e<0))return g;if(f>=0)return g;d=-(e+f)}var h=3.3306690738754716e-16*d;return g>=h||g<=-h?g:l(a,b,c)},function(a,b,c,d){var e=a[0]-d[0],f=b[0]-d[0],g=c[0]-d[0],h=a[1]-d[1],i=b[1]-d[1],j=c[1]-d[1],k=a[2]-d[2],l=b[2]-d[2],n=c[2]-d[2],o=f*j,p=g*i,q=g*h,r=e*j,s=e*i,t=f*h,u=k*(o-p)+l*(q-r)+n*(s-t),v=7.771561172376103e-16*((Math.abs(o)+Math.abs(p))*Math.abs(k)+(Math.abs(q)+Math.abs(r))*Math.abs(l)+(Math.abs(s)+Math.abs(t))*Math.abs(n));return u>v||-u>v?u:m(a,b,c,d)}];!function(){for(;n.length<=5;)n.push(g(n.length));for(var a=[],c=["slow"],d=0;d<=5;++d)a.push("a"+d),c.push("o"+d);var e=["function getOrientation(",a.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(d=2;d<=5;++d)e.push("case ",d,":return o",d,"(",a.slice(0,d).join(),");");e.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),c.push(e.join(""));var f=Function.apply(void 0,c);for(b.exports=f.apply(void 0,[function(a){var b=n[a.length];return b||(b=n[a.length]=g(a.length)),b.apply(void 0,a)}].concat(n)),d=0;d<=5;++d)b.exports[d]=n[d]}()},{"robust-scale":513,"robust-subtract":515,"robust-sum":516,"two-product":544}],512:[function(a,b,c){"use strict";var d=a("robust-sum"),e=a("robust-scale");b.exports=function(a,b){if(1===a.length)return e(b,a[0]);if(1===b.length)return e(a,b[0]);if(0===a.length||0===b.length)return[0];var c=[0];if(a.length<b.length)for(var f=0;f<a.length;++f)c=d(c,e(b,a[f]));else for(var f=0;f<b.length;++f)c=d(c,e(a,b[f]));return c}},{"robust-scale":513,"robust-sum":516}],513:[function(a,b,c){"use strict";var d=a("two-product"),e=a("two-sum");b.exports=function(a,b){var c=a.length;if(1===c){var f=d(a[0],b);return f[0]?f:[f[1]]}var g=new Array(2*c),h=[.1,.1],i=[.1,.1],j=0;d(a[0],b,h),h[0]&&(g[j++]=h[0]);for(var k=1;k<c;++k){d(a[k],b,i);var l=h[1];e(l,i[0],h),h[0]&&(g[j++]=h[0]);var m=i[1],n=h[1],o=m+n,p=o-m,q=n-p;h[1]=o,q&&(g[j++]=q)}return h[1]&&(g[j++]=h[1]),0===j&&(g[j++]=0),g.length=j,g}},{"two-product":544,"two-sum":545}],514:[function(a,b,c){"use strict";b.exports=function(a,b,c,e){var f=d(a,c,e),g=d(b,c,e);if(f>0&&g>0||f<0&&g<0)return!1;var h=d(c,a,b),i=d(e,a,b);return!(h>0&&i>0||h<0&&i<0)&&(0!==f||0!==g||0!==h||0!==i||function(a,b,c,d){for(var e=0;e<2;++e){var f=a[e],g=b[e],h=Math.min(f,g),i=Math.max(f,g),j=c[e],k=d[e],l=Math.min(j,k);if(Math.max(j,k)<h||i<l)return!1}return!0}(a,b,c,e))};var d=a("robust-orientation")[3]},{"robust-orientation":511}],515:[function(a,b,c){"use strict";b.exports=function(a,b){var c=0|a.length,d=0|b.length;if(1===c&&1===d)return function(a,b){var c=a+b,d=c-a,e=a-(c-d)+(b-d);return e?[e,c]:[c]}(a[0],-b[0]);var e,f,g=new Array(c+d),h=0,i=0,j=0,k=Math.abs,l=a[i],m=k(l),n=-b[j],o=k(n);m<o?(f=l,(i+=1)<c&&(l=a[i],m=k(l))):(f=n,(j+=1)<d&&(n=-b[j],o=k(n))),i<c&&m<o||j>=d?(e=l,(i+=1)<c&&(l=a[i],m=k(l))):(e=n,(j+=1)<d&&(n=-b[j],o=k(n)));for(var p,q,r=e+f,s=r-e,t=f-s,u=t,v=r;i<c&&j<d;)m<o?(e=l,(i+=1)<c&&(l=a[i],m=k(l))):(e=n,(j+=1)<d&&(n=-b[j],o=k(n))),(t=(f=u)-(s=(r=e+f)-e))&&(g[h++]=t),u=v-((p=v+r)-(q=p-v))+(r-q),v=p;for(;i<c;)(t=(f=u)-(s=(r=(e=l)+f)-e))&&(g[h++]=t),u=v-((p=v+r)-(q=p-v))+(r-q),v=p,(i+=1)<c&&(l=a[i]);for(;j<d;)(t=(f=u)-(s=(r=(e=n)+f)-e))&&(g[h++]=t),u=v-((p=v+r)-(q=p-v))+(r-q),v=p,(j+=1)<d&&(n=-b[j]);return u&&(g[h++]=u),v&&(g[h++]=v),h||(g[h++]=0),g.length=h,g}},{}],516:[function(a,b,c){"use strict";b.exports=function(a,b){var c=0|a.length,d=0|b.length;if(1===c&&1===d)return function(a,b){var c=a+b,d=c-a,e=a-(c-d)+(b-d);return e?[e,c]:[c]}(a[0],b[0]);var e,f,g=new Array(c+d),h=0,i=0,j=0,k=Math.abs,l=a[i],m=k(l),n=b[j],o=k(n);m<o?(f=l,(i+=1)<c&&(l=a[i],m=k(l))):(f=n,(j+=1)<d&&(n=b[j],o=k(n))),i<c&&m<o||j>=d?(e=l,(i+=1)<c&&(l=a[i],m=k(l))):(e=n,(j+=1)<d&&(n=b[j],o=k(n)));for(var p,q,r=e+f,s=r-e,t=f-s,u=t,v=r;i<c&&j<d;)m<o?(e=l,(i+=1)<c&&(l=a[i],m=k(l))):(e=n,(j+=1)<d&&(n=b[j],o=k(n))),(t=(f=u)-(s=(r=e+f)-e))&&(g[h++]=t),u=v-((p=v+r)-(q=p-v))+(r-q),v=p;for(;i<c;)(t=(f=u)-(s=(r=(e=l)+f)-e))&&(g[h++]=t),u=v-((p=v+r)-(q=p-v))+(r-q),v=p,(i+=1)<c&&(l=a[i]);for(;j<d;)(t=(f=u)-(s=(r=(e=n)+f)-e))&&(g[h++]=t),u=v-((p=v+r)-(q=p-v))+(r-q),v=p,(j+=1)<d&&(n=b[j]);return u&&(g[h++]=u),v&&(g[h++]=v),h||(g[h++]=0),g.length=h,g}},{}],517:[function(a,b,c){"use strict";b.exports=function(a){return a<0?-1:a>0?1:0}},{}],518:[function(a,b,c){"use strict";b.exports=function(a){return e(d(a))};var d=a("boundary-cells"),e=a("reduce-simplicial-complex")},{"boundary-cells":96,"reduce-simplicial-complex":490}],519:[function(a,b,c){"use strict";b.exports=function(a,b,c,h){if(c=c||0,void 0===h&&(h=function(a){for(var b=a.length,c=0,d=0;d<b;++d)c=0|Math.max(c,a[d].length);return c-1}(a)),0===a.length||h<1)return{cells:[],vertexIds:[],vertexWeights:[]};var i=function(a,b){for(var c=a.length,d=e.mallocUint8(c),f=0;f<c;++f)d[f]=a[f]<b|0;return d}(b,+c),j=function(a,b){for(var c=a.length,g=b*(b+1)/2*c|0,h=e.mallocUint32(2*g),i=0,j=0;j<c;++j)for(var k=a[j],b=k.length,l=0;l<b;++l)for(var m=0;m<l;++m){var n=k[m],o=k[l];h[i++]=0|Math.min(n,o),h[i++]=0|Math.max(n,o)}f(d(h,[i/2|0,2]));for(var p=2,j=2;j<i;j+=2)h[j-2]===h[j]&&h[j-1]===h[j+1]||(h[p++]=h[j],h[p++]=h[j+1]);return d(h,[p/2|0,2])}(a,h),k=function(a,b,c,f){for(var g=a.data,h=a.shape[0],i=e.mallocDouble(h),j=0,k=0;k<h;++k){var l=g[2*k],m=g[2*k+1];if(c[l]!==c[m]){var n=b[l],o=b[m];g[2*j]=l,g[2*j+1]=m,i[j++]=(o-f)/(o-n)}}return a.shape[0]=j,d(i,[j])}(j,b,i,+c),l=function(a,b){var c=e.mallocInt32(2*b),d=a.shape[0],f=a.data;c[0]=0;for(var g=0,h=0;h<d;++h){var i=f[2*h];if(i!==g){for(c[2*g+1]=h;++g<i;)c[2*g]=h,c[2*g+1]=h;c[2*g]=h}}for(c[2*g+1]=d;++g<b;)c[2*g]=c[2*g+1]=d;return c}(j,0|b.length),m=g(h)(a,j.data,l,i),n=function(a){for(var b=0|a.shape[0],c=a.data,d=new Array(b),e=0;e<b;++e)d[e]=[c[2*e],c[2*e+1]];return d}(j),o=[].slice.call(k.data,0,k.shape[0]);return e.free(i),e.free(j.data),e.free(k.data),e.free(l),{cells:m,vertexIds:n,vertexWeights:o}};var d=a("ndarray"),e=a("typedarray-pool"),f=a("ndarray-sort"),g=a("./lib/codegen")},{"./lib/codegen":520,ndarray:451,"ndarray-sort":449,"typedarray-pool":546}],520:[function(a,b,c){"use strict";b.exports=function(a){var b=f[a];return b||(b=f[a]=function(a){var b=0,c=new Array(a+1);c[0]=[[]];for(var f=1;f<=a;++f)for(var g=c[f]=e(f),h=0;h<g.length;++h)b=Math.max(b,g[f].length);for(var i=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",a,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"],f=a+1;f>1;--f){f<a+1&&i.push("else "),i.push("if(l===",f,"){");for(var j=[],h=0;h<f;++h)j.push("(S[c["+h+"]]<<"+h+")");i.push("var M=",j.join("+"),";if(M===0||M===",(1<<f)-1,"){continue}switch(M){");for(var g=c[f-1],h=0;h<g.length;++h)i.push("case ",h,":"),function(a){if(!(a.length<=0)){i.push("R.push(");for(var b=0;b<a.length;++b){var c=a[b];b>0&&i.push(","),i.push("[");for(var d=0;d<c.length;++d){var e=c[d];d>0&&i.push(","),i.push("B(C,E,c[",e[0],"],c[",e[1],"])")}i.push("]")}i.push(");")}}(g[h]),i.push("break;");i.push("}}")}return i.push("}return R;};return getContour",a,"d"),new Function("pool",i.join(""))(d)}(a)),b};var d=a("typedarray-pool"),e=a("marching-simplex-table"),f={}},{"marching-simplex-table":428,"typedarray-pool":546}],521:[function(a,b,c){"use strict";function d(a,b){var c=a.length,d=a.length-b.length,e=Math.min;if(d)return d;switch(c){case 0:return 0;case 1:return a[0]-b[0];case 2:return(h=a[0]+a[1]-b[0]-b[1])||e(a[0],a[1])-e(b[0],b[1]);case 3:var f=a[0]+a[1],g=b[0]+b[1];if(h=f+a[2]-(g+b[2]))return h;var h,i=e(a[0],a[1]),j=e(b[0],b[1]);return(h=e(i,a[2])-e(j,b[2]))||e(i+a[2],f)-e(j+b[2],g);default:var k=a.slice(0);k.sort();var l=b.slice(0);l.sort();for(var m=0;m<c;++m)if(d=k[m]-l[m])return d;return 0}}function e(a,b){return d(a[0],b[0])}function f(a,b){if(b){for(var c=a.length,f=new Array(c),g=0;g<c;++g)f[g]=[a[g],b[g]];for(f.sort(e),g=0;g<c;++g)a[g]=f[g][0],b[g]=f[g][1];return a}return a.sort(d),a}function g(a){if(0===a.length)return[];for(var b=1,c=a.length,e=1;e<c;++e){var f=a[e];if(d(f,a[e-1])){if(e===b){b++;continue}a[b++]=f}}return a.length=b,a}function h(a,b){for(var c=0,e=a.length-1,f=-1;c<=e;){var g=c+e>>1,h=d(a[g],b);h<=0?(0===h&&(f=g),c=g+1):h>0&&(e=g-1)}return f}function i(a,b){for(var c=new Array(a.length),e=0,f=c.length;e<f;++e)c[e]=[];for(var g=[],i=(e=0,b.length);e<i;++e)for(var j=b[e],l=j.length,m=1,n=1<<l;m<n;++m){g.length=k.popCount(m);for(var o=0,p=0;p<l;++p)m&1<<p&&(g[o++]=j[p]);var q=h(a,g);if(!(q<0))for(;c[q++].push(e),!(q>=a.length||0!==d(a[q],g)););}return c}function j(a,b){if(b<0)return[];for(var c=[],d=(1<<b+1)-1,e=0;e<a.length;++e)for(var g=a[e],h=d;h<1<<g.length;h=k.nextCombination(h)){for(var i=new Array(b+1),j=0,l=0;l<g.length;++l)h&1<<l&&(i[j++]=g[l]);c.push(i)}return f(c)}var k=a("bit-twiddle"),l=a("union-find");c.dimension=function(a){for(var b=0,c=Math.max,d=0,e=a.length;d<e;++d)b=c(b,a[d].length);return b-1},c.countVertices=function(a){for(var b=-1,c=Math.max,d=0,e=a.length;d<e;++d)for(var f=a[d],g=0,h=f.length;g<h;++g)b=c(b,f[g]);return b+1},c.cloneCells=function(a){for(var b=new Array(a.length),c=0,d=a.length;c<d;++c)b[c]=a[c].slice(0);return b},c.compareCells=d,c.normalize=f,c.unique=g,c.findCell=h,c.incidence=i,c.dual=function(a,b){if(!b)return i(g(j(a,0)),a);for(var c=new Array(b),d=0;d<b;++d)c[d]=[];d=0;for(var e=a.length;d<e;++d)for(var f=a[d],h=0,k=f.length;h<k;++h)c[f[h]].push(d);return c},c.explode=function(a){for(var b=[],c=0,d=a.length;c<d;++c)for(var e=a[c],g=0|e.length,h=1,i=1<<g;h<i;++h){for(var j=[],k=0;k<g;++k)h>>>k&1&&j.push(e[k]);b.push(j)}return f(b)},c.skeleton=j,c.boundary=function(a){for(var b=[],c=0,d=a.length;c<d;++c)for(var e=a[c],g=0,h=e.length;g<h;++g){for(var i=new Array(e.length-1),j=0,k=0;j<h;++j)j!==g&&(i[k++]=e[j]);b.push(i)}return f(b)},c.connectedComponents=function(a,b){return b?function(a,b){for(var c=new l(b),d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.length;++f)for(var g=f+1;g<e.length;++g)c.link(e[f],e[g]);var h=[],i=c.ranks;for(d=0;d<i.length;++d)i[d]=-1;for(d=0;d<a.length;++d){var j=c.find(a[d][0]);i[j]<0?(i[j]=h.length,h.push([a[d].slice(0)])):h[i[j]].push(a[d].slice(0))}return h}(a,b):function(a){for(var b=g(f(j(a,0))),c=new l(b.length),d=0;d<a.length;++d)for(var e=a[d],i=0;i<e.length;++i)for(var k=h(b,[e[i]]),m=i+1;m<e.length;++m)c.link(k,h(b,[e[m]]));var n=[],o=c.ranks;for(d=0;d<o.length;++d)o[d]=-1;for(d=0;d<a.length;++d){var p=c.find(h(b,[a[d][0]]));o[p]<0?(o[p]=n.length,n.push([a[d].slice(0)])):n[o[p]].push(a[d].slice(0))}return n}(a)}},{"bit-twiddle":93,"union-find":547}],522:[function(a,b,c){arguments[4][93][0].apply(c,arguments)},{dup:93}],523:[function(a,b,c){arguments[4][521][0].apply(c,arguments)},{"bit-twiddle":522,dup:521,"union-find":524}],524:[function(a,b,c){"use strict";function d(a){this.roots=new Array(a),this.ranks=new Array(a);for(var b=0;b<a;++b)this.roots[b]=b,this.ranks[b]=0}b.exports=d,d.prototype.length=function(){return this.roots.length},d.prototype.makeSet=function(){var a=this.roots.length;return this.roots.push(a),this.ranks.push(0),a},d.prototype.find=function(a){for(var b=this.roots;b[a]!==a;){var c=b[a];b[a]=b[c],a=c}return a},d.prototype.link=function(a,b){var c=this.find(a),d=this.find(b);if(c!==d){var e=this.ranks,f=this.roots,g=e[c],h=e[d];g<h?f[c]=d:h<g?f[d]=c:(f[d]=c,++e[c])}}},{}],525:[function(a,b,c){"use strict";b.exports=function(a,b,c){function f(a){if(t[a])return 1/0;var c,e,f,g,h,i=q[a],j=r[a];return i<0||j<0?1/0:(c=b[a],e=b[i],f=b[j],g=Math.abs(d(c,e,f)),h=Math.sqrt(Math.pow(e[0]-f[0],2)+Math.pow(e[1]-f[1],2)),g/h)}function g(a,b){var c=y[a],d=y[b];y[a]=d,y[b]=c,z[c]=b,z[d]=a}function h(a){return s[y[a]]}function i(a){return 1&a?a-1>>1:(a>>1)-1}function j(a){for(var b=h(a);;){var c=b,d=2*a+1,e=2*(a+1),f=a;if(d<A){var i=h(d);i<c&&(f=d,c=i)}if(e<A){h(e)<c&&(f=e)}if(f===a)return a;g(a,f),a=f}}function k(a){for(var b=h(a);a>0;){var c=i(a);if(c>=0){if(b<h(c)){g(a,c),a=c;continue}}return a}}function l(){if(A>0){var a=y[0];return g(0,A-1),A-=1,j(0),a}return-1}function m(a,b){var c=y[a];return s[c]===b?a:(s[c]=-1/0,k(a),l(),s[c]=b,k((A+=1)-1))}function n(a,b){if(a[b]<0)return b;var c=b,d=b;do{var e=a[d];if(!t[d]||e<0||e===d)break;if(e=a[d=e],!t[d]||e<0||e===d)break;d=e,c=a[c]}while(c!==d);for(var f=b;f!==d;f=a[f])a[f]=d;return d}for(var o=b.length,p=a.length,q=new Array(o),r=new Array(o),s=new Array(o),t=new Array(o),u=0;u<o;++u)q[u]=r[u]=-1,s[u]=1/0,t[u]=!1;for(var u=0;u<p;++u){var v=a[u];if(2!==v.length)throw new Error("Input must be a graph");var w=v[1],x=v[0];-1!==r[x]?r[x]=-2:r[x]=w,-1!==q[w]?q[w]=-2:q[w]=x}for(var y=[],z=new Array(o),u=0;u<o;++u){(s[u]=f(u))<1/0?(z[u]=y.length,y.push(u)):z[u]=-1}for(var A=y.length,u=A>>1;u>=0;--u)j(u);for(;;){var B=l();if(B<0||s[B]>c)break;!function(a){if(!t[a]){t[a]=!0;var b=q[a],c=r[a];q[c]>=0&&(q[c]=b),r[b]>=0&&(r[b]=c),z[b]>=0&&m(z[b],f(b)),z[c]>=0&&m(z[c],f(c))}}(B)}for(var C=[],u=0;u<o;++u)t[u]||(z[u]=C.length,C.push(b[u].slice()));C.length;var D=[];return a.forEach(function(a){var b=n(q,a[0]),c=n(r,a[1]);if(b>=0&&c>=0&&b!==c){var d=z[b],e=z[c];d!==e&&D.push([d,e])}}),e.unique(e.normalize(D)),{positions:C,edges:D}};var d=a("robust-orientation"),e=a("simplicial-complex")},{"robust-orientation":511,"simplicial-complex":523}],526:[function(a,b,c){"use strict";function d(a,b){var c,d,f,g;if(b[0][0]<b[1][0])c=b[0],d=b[1];else{if(!(b[0][0]>b[1][0])){var h=Math.min(a[0][1],a[1][1]),i=Math.max(a[0][1],a[1][1]),j=Math.min(b[0][1],b[1][1]),k=Math.max(b[0][1],b[1][1]);return i<j?i-j:h>k?h-k:i-k}c=b[1],d=b[0]}a[0][1]<a[1][1]?(f=a[0],g=a[1]):(f=a[1],g=a[0]);var l=e(d,c,f);return l||(l=e(d,c,g))||g-d}b.exports=function(a,b){var c,f,g,h;if(b[0][0]<b[1][0])c=b[0],f=b[1];else{if(!(b[0][0]>b[1][0]))return d(b,a);c=b[1],f=b[0]}if(a[0][0]<a[1][0])g=a[0],h=a[1];else{if(!(a[0][0]>a[1][0]))return-d(a,b);g=a[1],h=a[0]}var i=e(c,f,h),j=e(c,f,g);if(i<0){if(j<=0)return i}else if(i>0){if(j>=0)return i}else if(j)return j;if(i=e(h,g,f),j=e(h,g,c),i<0){if(j<=0)return i}else if(i>0){if(j>=0)return i}else if(j)return j;return f[0]-h[0]};var e=a("robust-orientation")},{"robust-orientation":511}],527:[function(a,b,c){"use strict";function d(a,b,c){this.slabs=a,this.coordinates=b,this.horizontal=c}function e(a,b){return a.y-b}function f(a,b){for(var c=null;a;){var d,e,g=a.key;g[0][0]<g[1][0]?(d=g[0],e=g[1]):(d=g[1],e=g[0]);var h=k(d,e,b);if(h<0)a=a.left;else if(h>0)if(b[0]!==g[1][0])c=a,a=a.right;else{if(i=f(a.right,b))return i;a=a.left}else{if(b[0]!==g[1][0])return a;var i;if(i=f(a.right,b))return i;a=a.left}}return c}function g(a,b,c,d){this.y=a,this.index=b,this.start=c,this.closed=d}function h(a,b,c,d){this.x=a,this.segment=b,this.create=c,this.index=d}b.exports=function(a){for(var b=a.length,c=2*b,e=new Array(c),f=0;f<b;++f){var i=a[f],k=i[0][0]<i[1][0];e[2*f]=new h(i[0][0],i,k,f),e[2*f+1]=new h(i[1][0],i,!k,f)}e.sort(function(a,b){var c=a.x-b.x;return c||(c=a.create-b.create)||Math.min(a.segment[0][1],a.segment[1][1])-Math.min(b.segment[0][1],b.segment[1][1])});for(var m=j(l),n=[],o=[],p=[],f=0;f<c;){for(var q=e[f].x,r=[];f<c;){var s=e[f];if(s.x!==q)break;f+=1,s.segment[0][0]===s.x&&s.segment[1][0]===s.x?s.create&&(s.segment[0][1]<s.segment[1][1]?(r.push(new g(s.segment[0][1],s.index,!0,!0)),r.push(new g(s.segment[1][1],s.index,!1,!1))):(r.push(new g(s.segment[1][1],s.index,!0,!1)),r.push(new g(s.segment[0][1],s.index,!1,!0)))):m=s.create?m.insert(s.segment,s.index):m.remove(s.segment)}n.push(m.root),o.push(q),p.push(r)}return new d(n,o,p)};var i=a("binary-search-bounds"),j=a("functional-red-black-tree"),k=a("robust-orientation"),l=a("./lib/order-segments");d.prototype.castUp=function(a){var b=i.le(this.coordinates,a[0]);if(b<0)return-1;this.slabs[b];var c=f(this.slabs[b],a),d=-1;if(c&&(d=c.value),this.coordinates[b]===a[0]){var g=null;if(c&&(g=c.key),b>0){var h=f(this.slabs[b-1],a);h&&(g?l(h.key,g)>0&&(g=h.key,d=h.value):(d=h.value,g=h.key))}var j=this.horizontal[b];if(j.length>0){var m=i.ge(j,a[1],e);if(m<j.length){var n=j[m];if(a[1]===n.y){if(n.closed)return n.index;for(;m<j.length-1&&j[m+1].y===a[1];)if((n=j[m+=1]).closed)return n.index;if(n.y===a[1]&&!n.start){if((m+=1)>=j.length)return d;n=j[m]}}if(n.start)if(g){var o=k(g[0],g[1],[a[0],n.y]);g[0][0]>g[1][0]&&(o=-o),o>0&&(d=n.index)}else d=n.index;else n.y!==a[1]&&(d=n.index)}}}return d}},{"./lib/order-segments":526,"binary-search-bounds":92,"functional-red-black-tree":231,"robust-orientation":511}],528:[function(a,b,c){"use strict";function d(a,b){var c=g(f(a,b),[b[b.length-1]]);return c[c.length-1]}function e(a,b,c,d){var e=-b/(d-b);e<0?e=0:e>1&&(e=1);for(var f=1-e,g=a.length,h=new Array(g),i=0;i<g;++i)h[i]=e*a[i]+f*c[i];return h}var f=a("robust-dot-product"),g=a("robust-sum");b.exports=function(a,b){for(var c=[],f=[],g=d(a[a.length-1],b),h=a[a.length-1],i=a[0],j=0;j<a.length;++j,h=i){var k=d(i=a[j],b);if(g<0&&k>0||g>0&&k<0){var l=e(h,k,i,g);c.push(l),f.push(l.slice())}k<0?f.push(i.slice()):k>0?c.push(i.slice()):(c.push(i.slice()),f.push(i.slice())),g=k}return{positive:c,negative:f}},b.exports.positive=function(a,b){for(var c=[],f=d(a[a.length-1],b),g=a[a.length-1],h=a[0],i=0;i<a.length;++i,g=h){var j=d(h=a[i],b);(f<0&&j>0||f>0&&j<0)&&c.push(e(g,j,h,f)),j>=0&&c.push(h.slice()),f=j}return c},b.exports.negative=function(a,b){for(var c=[],f=d(a[a.length-1],b),g=a[a.length-1],h=a[0],i=0;i<a.length;++i,g=h){var j=d(h=a[i],b);(f<0&&j>0||f>0&&j<0)&&c.push(e(g,j,h,f)),j<=0&&c.push(h.slice()),f=j}return c}},{"robust-dot-product":508,"robust-sum":516}],529:[function(a,b,c){!function(){"use strict";function a(b){return function(b,c){var e,f,g,h,i,j,k,l,m,n=1,o=b.length,p="";for(f=0;f<o;f++)if("string"==typeof b[f])p+=b[f];else if("object"==typeof b[f]){if((h=b[f]).keys)for(e=c[n],g=0;g<h.keys.length;g++){if(null==e)throw new Error(a('[sprintf] Cannot access property "%s" of undefined value "%s"',h.keys[g],h.keys[g-1]));e=e[h.keys[g]]}else e=h.param_no?c[h.param_no]:c[n++];if(d.not_type.test(h.type)&&d.not_primitive.test(h.type)&&e instanceof Function&&(e=e()),d.numeric_arg.test(h.type)&&"number"!=typeof e&&isNaN(e))throw new TypeError(a("[sprintf] expecting number but found %T",e));switch(d.number.test(h.type)&&(l=e>=0),h.type){case"b":e=parseInt(e,10).toString(2);break;case"c":e=String.fromCharCode(parseInt(e,10));break;case"d":case"i":e=parseInt(e,10);break;case"j":e=JSON.stringify(e,null,h.width?parseInt(h.width):0);break;case"e":e=h.precision?parseFloat(e).toExponential(h.precision):parseFloat(e).toExponential();break;case"f":e=h.precision?parseFloat(e).toFixed(h.precision):parseFloat(e);break;case"g":e=h.precision?String(Number(e.toPrecision(h.precision))):parseFloat(e);break;case"o":e=(parseInt(e,10)>>>0).toString(8);break;case"s":e=String(e),e=h.precision?e.substring(0,h.precision):e;break;case"t":e=String(!!e),e=h.precision?e.substring(0,h.precision):e;break;case"T":e=Object.prototype.toString.call(e).slice(8,-1).toLowerCase(),e=h.precision?e.substring(0,h.precision):e;break;case"u":e=parseInt(e,10)>>>0;break;case"v":e=e.valueOf(),e=h.precision?e.substring(0,h.precision):e;break;case"x":e=(parseInt(e,10)>>>0).toString(16);break;case"X":e=(parseInt(e,10)>>>0).toString(16).toUpperCase()}d.json.test(h.type)?p+=e:(!d.number.test(h.type)||l&&!h.sign?m="":(m=l?"+":"-",e=e.toString().replace(d.sign,"")),j=h.pad_char?"0"===h.pad_char?"0":h.pad_char.charAt(1):" ",k=h.width-(m+e).length,i=h.width&&k>0?j.repeat(k):"",p+=h.align?m+e+i:"0"===j?m+i+e:i+m+e)}return p}(function(a){if(e[a])return e[a];for(var b,c=a,f=[],g=0;c;){if(null!==(b=d.text.exec(c)))f.push(b[0]);else if(null!==(b=d.modulo.exec(c)))f.push("%");else{if(null===(b=d.placeholder.exec(c)))throw new SyntaxError("[sprintf] unexpected placeholder");if(b[2]){g|=1;var h=[],i=b[2],j=[];if(null===(j=d.key.exec(i)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(h.push(j[1]);""!==(i=i.substring(j[0].length));)if(null!==(j=d.key_access.exec(i)))h.push(j[1]);else{if(null===(j=d.index_access.exec(i)))throw new SyntaxError("[sprintf] failed to parse named argument key");h.push(j[1])}b[2]=h}else g|=2;if(3===g)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");f.push({placeholder:b[0],param_no:b[1],keys:b[2],sign:b[3],pad_char:b[4],align:b[5],width:b[6],precision:b[7],type:b[8]})}c=c.substring(b[0].length)}return e[a]=f}(b),arguments)}function b(b,c){return a.apply(null,[b].concat(c||[]))}var d={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/},e=Object.create(null);void 0!==c&&(c.sprintf=a,c.vsprintf=b),"undefined"!=typeof window&&(window.sprintf=a,window.vsprintf=b)}()},{}],530:[function(a,b,c){"use strict";var d=a("parenthesis");b.exports=function(a,b,c){if(null==a)throw Error("First argument should be a string");if(null==b)throw Error("Separator should be a string or a RegExp");c?("string"==typeof c||Array.isArray(c))&&(c={ignore:c}):c={},null==c.escape&&(c.escape=!0),null==c.ignore?c.ignore=["[]","()","{}","<>",'""',"''","``","",""]:("string"==typeof c.ignore&&(c.ignore=[c.ignore]),c.ignore=c.ignore.map(function(a){return 1===a.length&&(a+=a),a}));var e=d.parse(a,{flat:!0,brackets:c.ignore}),f=e[0].split(b);if(c.escape){for(var g=[],h=0;h<f.length;h++){var i=f[h],j=f[h+1];"\\"===i[i.length-1]&&"\\"!==i[i.length-2]?(g.push(i+b+j),h++):g.push(i)}f=g}for(h=0;h<f.length;h++)e[0]=f[h],f[h]=d.stringify(e,{flat:!0});return f}},{parenthesis:459}],531:[function(a,b,c){"use strict";b.exports=function(a){for(var b=a.length,c=new Array(b),d=new Array(b),e=new Array(b),f=new Array(b),g=new Array(b),h=new Array(b),i=0;i<b;++i)c[i]=-1,d[i]=0,e[i]=!1,f[i]=0,g[i]=-1,h[i]=[];for(var j,k=0,l=[],m=[],i=0;i<b;++i)c[i]<0&&function(b){var i=[b],j=[b];for(c[b]=d[b]=k,e[b]=!0,k+=1;j.length>0;){b=j[j.length-1];var n=a[b];if(f[b]<n.length){for(var o=f[b];o<n.length;++o){var p=n[o];if(c[p]<0){c[p]=d[p]=k,e[p]=!0,k+=1,i.push(p),j.push(p);break}e[p]&&(d[b]=0|Math.min(d[b],d[p])),g[p]>=0&&h[b].push(g[p])}f[b]=o}else{if(d[b]===c[b]){for(var q=[],r=[],s=0,o=i.length-1;o>=0;--o){var t=i[o];if(e[t]=!1,q.push(t),r.push(h[t]),s+=h[t].length,g[t]=l.length,t===b){i.length=o;break}}l.push(q);for(var u=new Array(s),o=0;o<r.length;o++)for(var v=0;v<r[o].length;v++)u[--s]=r[o][v];m.push(u)}j.pop()}}}(i);for(var i=0;i<m.length;i++){var n=m[i];if(0!==n.length){n.sort(function(a,b){return a-b}),j=[n[0]];for(var o=1;o<n.length;o++)n[o]!==n[o-1]&&j.push(n[o]);m[i]=j}}return{components:l,adjacencyList:m}}},{}],532:[function(a,b,c){"use strict";b.exports=function(a,b){if(a.dimension<=0)return{positions:[],cells:[]};if(1===a.dimension)return function(a,b){for(var c=f(a,b),d=c.length,e=new Array(d),g=new Array(d),h=0;h<d;++h)e[h]=[c[h]],g[h]=[h];return{positions:e,cells:g}}(a,b);var c=a.order.join()+"-"+a.dtype,h=g[c],b=+b||0;return h||(h=g[c]=function(a,b){var c=a.length,f=["'use strict';"],g="surfaceNets"+a.join("_")+"d"+b;f.push("var contour=genContour({","order:[",a.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },"),"generic"===b&&f.push("getters:[0],");for(var h=[],i=[],j=0;j<c;++j)h.push("d"+j),i.push("d"+j);for(var j=0;j<1<<c;++j)h.push("v"+j),i.push("v"+j);for(var j=0;j<1<<c;++j)h.push("p"+j),i.push("p"+j);h.push("a","b","c"),i.push("a","c"),f.push("vertex:function vertexFunc(",h.join(),"){");for(var k=[],j=0;j<1<<c;++j)k.push("(p"+j+"<<"+j+")");f.push("var m=(",k.join("+"),")|0;if(m===0||m===",(1<<(1<<c))-1,"){return}");var l=[],m=[];1<<(1<<c)<=128?(f.push("switch(m){"),m=f):f.push("switch(m>>>7){");for(var j=0;j<1<<(1<<c);++j){if(1<<(1<<c)>128&&j%128==0){l.length>0&&m.push("}}");var n="vExtra"+l.length;f.push("case ",j>>>7,":",n,"(m&0x7f,",i.join(),");break;"),m=["function ",n,"(m,",i.join(),"){switch(m){"],l.push(m)}m.push("case ",127&j,":");for(var o=new Array(c),p=new Array(c),q=new Array(c),r=new Array(c),s=0,t=0;t<c;++t)o[t]=[],p[t]=[],q[t]=0,r[t]=0;for(var t=0;t<1<<c;++t)for(var u=0;u<c;++u){var v=t^1<<u;if(!(v>t)&&!(j&1<<v)!=!(j&1<<t)){var w=1;j&1<<v?p[u].push("v"+v+"-v"+t):(p[u].push("v"+t+"-v"+v),w=-w),w<0?(o[u].push("-v"+t+"-v"+v),q[u]+=2):(o[u].push("v"+t+"+v"+v),q[u]-=2),s+=1;for(var x=0;x<c;++x)x!==u&&(v&1<<x?r[x]+=1:r[x]-=1)}}for(var y=[],u=0;u<c;++u)if(0===o[u].length)y.push("d"+u+"-0.5");else{var z="";q[u]<0?z=q[u]+"*c":q[u]>0&&(z="+"+q[u]+"*c");var A=o[u].length/s*.5,B=.5+r[u]/s*.5;y.push("d"+u+"-"+B+"-"+A+"*("+o[u].join("+")+z+")/("+p[u].join("+")+")")}m.push("a.push([",y.join(),"]);","break;")}f.push("}},"),l.length>0&&m.push("}}");for(var C=[],j=0;j<1<<c-1;++j)C.push("v"+j);C.push("c0","c1","p0","p1","a","b","c"),f.push("cell:function cellFunc(",C.join(),"){");var D=e(c-1);f.push("if(p0){b.push(",D.map(function(a){return"["+a.map(function(a){return"v"+a})+"]"}).join(),")}else{b.push(",D.map(function(a){var b=a.slice();return b.reverse(),"["+b.map(function(a){return"v"+a})+"]"}).join(),")}}});function ",g,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",g,";");for(var j=0;j<l.length;++j)f.push(l[j].join(""))
;return new Function("genContour",f.join(""))(d)}(a.order,a.dtype)),h(a,b)};var d=a("ndarray-extract-contour"),e=a("triangulate-hypercube"),f=a("zero-crossings"),g={}},{"ndarray-extract-contour":440,"triangulate-hypercube":542,"zero-crossings":575}],533:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=function(){return function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a))return function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}(a,b);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),e=2*Math.PI,f=function(a,b,c,d,e,f,g){var h=a.x,i=a.y;return{x:d*(h*=b)-e*(i*=c)+f,y:e*h+d*i+g}},g=function(a,b){var c=.551915024494*(b<0?-1:1),d=Math.cos(a),e=Math.sin(a),f=Math.cos(a+b),g=Math.sin(a+b);return[{x:d-e*c,y:e+d*c},{x:f+g*c,y:g-f*c},{x:f,y:g}]},h=function(a,b,c,d){var e=a*d-b*c<0?-1:1,f=(a*c+b*d)/(Math.sqrt(a*a+b*b)*Math.sqrt(a*a+b*b));return f>1&&(f=1),f<-1&&(f=-1),e*Math.acos(f)};c.default=function(a){var b=a.px,c=a.py,i=a.cx,j=a.cy,k=a.rx,l=a.ry,m=a.xAxisRotation,n=void 0===m?0:m,o=a.largeArcFlag,p=void 0===o?0:o,q=a.sweepFlag,r=void 0===q?0:q,s=[];if(0===k||0===l)return[];var t=Math.sin(n*e/360),u=Math.cos(n*e/360),v=u*(b-i)/2+t*(c-j)/2,w=-t*(b-i)/2+u*(c-j)/2;if(0===v&&0===w)return[];k=Math.abs(k),l=Math.abs(l);var x=Math.pow(v,2)/Math.pow(k,2)+Math.pow(w,2)/Math.pow(l,2);x>1&&(k*=Math.sqrt(x),l*=Math.sqrt(x));var y=function(a,b,c,d,f,g,i,j,k,l,m,n){var o=Math.pow(f,2),p=Math.pow(g,2),q=Math.pow(m,2),r=Math.pow(n,2),s=o*p-o*r-p*q;s<0&&(s=0),s/=o*r+p*q;var t=(s=Math.sqrt(s)*(i===j?-1:1))*f/g*n,u=s*-g/f*m,v=l*t-k*u+(a+c)/2,w=k*t+l*u+(b+d)/2,x=(m-t)/f,y=(n-u)/g,z=(-m-t)/f,A=(-n-u)/g,B=h(1,0,x,y),C=h(x,y,z,A);return 0===j&&C>0&&(C-=e),1===j&&C<0&&(C+=e),[v,w,B,C]}(b,c,i,j,k,l,p,r,t,u,v,w),z=d(y,4),A=z[0],B=z[1],C=z[2],D=z[3],E=Math.abs(D)/(e/4);Math.abs(1-E)<1e-7&&(E=1);var F=Math.max(Math.ceil(E),1);D/=F;for(var G=0;G<F;G++)s.push(g(C,D)),C+=D;return s.map(function(a){var b=f(a[0],k,l,u,t,A,B),c=b.x,d=b.y,e=f(a[1],k,l,u,t,A,B),g=e.x,h=e.y,i=f(a[2],k,l,u,t,A,B);return{x1:c,y1:d,x2:g,y2:h,x:i.x,y:i.y}})},b.exports=c.default},{}],534:[function(a,b,c){"use strict";var d=a("parse-svg-path"),e=a("abs-svg-path"),f=a("normalize-svg-path"),g=a("is-svg-path"),h=a("assert");b.exports=function(a){if(Array.isArray(a)&&1===a.length&&"string"==typeof a[0]&&(a=a[0]),"string"==typeof a&&(h(g(a),"String is not an SVG path."),a=d(a)),h(Array.isArray(a),"Argument should be a string or an array of path segments."),a=e(a),!(a=f(a)).length)return[0,0,0,0];for(var b=[1/0,1/0,-1/0,-1/0],c=0,i=a.length;c<i;c++)for(var j=a[c].slice(1),k=0;k<j.length;k+=2)j[k+0]<b[0]&&(b[0]=j[k+0]),j[k+1]<b[1]&&(b[1]=j[k+1]),j[k+0]>b[2]&&(b[2]=j[k+0]),j[k+1]>b[3]&&(b[3]=j[k+1]);return b}},{"abs-svg-path":61,assert:69,"is-svg-path":425,"normalize-svg-path":535,"parse-svg-path":461}],535:[function(a,b,c){"use strict";function d(a,b,c,d){return["C",a,b,c,d,c,d]}function e(a,b,c,d,e,f){return["C",a/3+2/3*c,b/3+2/3*d,e/3+2/3*c,f/3+2/3*d,e,f]}b.exports=function(a){for(var b,c=[],g=0,h=0,i=0,j=0,k=null,l=null,m=0,n=0,o=0,p=a.length;o<p;o++){var q=a[o],r=q[0];switch(r){case"M":i=q[1],j=q[2];break;case"A":var s=f({px:m,py:n,cx:q[6],cy:q[7],rx:q[1],ry:q[2],xAxisRotation:q[3],largeArcFlag:q[4],sweepFlag:q[5]});if(!s.length)continue;for(var t,u=0;u<s.length;u++)t=s[u],q=["C",t.x1,t.y1,t.x2,t.y2,t.x,t.y],u<s.length-1&&c.push(q);break;case"S":var v=m,w=n;"C"!=b&&"S"!=b||(v+=v-g,w+=w-h),q=["C",v,w,q[1],q[2],q[3],q[4]];break;case"T":"Q"==b||"T"==b?(k=2*m-k,l=2*n-l):(k=m,l=n),q=e(m,n,k,l,q[1],q[2]);break;case"Q":k=q[1],l=q[2],q=e(m,n,q[1],q[2],q[3],q[4]);break;case"L":q=d(m,n,q[1],q[2]);break;case"H":q=d(m,n,q[1],n);break;case"V":q=d(m,n,m,q[1]);break;case"Z":q=d(m,n,i,j)}b=r,m=q[q.length-2],n=q[q.length-1],q.length>4?(g=q[q.length-4],h=q[q.length-3]):(g=m,h=n),c.push(q)}return c};var f=a("svg-arc-to-cubic-bezier")},{"svg-arc-to-cubic-bezier":533}],536:[function(a,b,c){"use strict";var d,e=a("svg-path-bounds"),f=a("parse-svg-path"),g=a("draw-svg-path"),h=a("is-svg-path"),i=a("bitmap-sdf"),j=document.createElement("canvas"),k=j.getContext("2d");b.exports=function(a,b){if(!h(a))throw Error("Argument should be valid svg path string");b||(b={});var c,l;b.shape?(c=b.shape[0],l=b.shape[1]):(c=j.width=b.w||b.width||200,l=j.height=b.h||b.height||200);var m=Math.min(c,l),n=b.stroke||0,o=b.viewbox||b.viewBox||e(a),p=[c/(o[2]-o[0]),l/(o[3]-o[1])],q=Math.min(p[0]||0,p[1]||0)/2;if(k.fillStyle="black",k.fillRect(0,0,c,l),k.fillStyle="white",n&&("number"!=typeof n&&(n=1),k.strokeStyle=n>0?"white":"black",k.lineWidth=Math.abs(n)),k.translate(.5*c,.5*l),k.scale(q,q),function(){if(null!=d)return d;var a=document.createElement("canvas").getContext("2d");if(a.canvas.width=a.canvas.height=1,!window.Path2D)return d=!1;var b=new Path2D("M0,0h1v1h-1v-1Z");a.fillStyle="black",a.fill(b);var c=a.getImageData(0,0,1,1);return d=c&&c.data&&255===c.data[3]}()){var r=new Path2D(a);k.fill(r),n&&k.stroke(r)}else{var s=f(a);g(k,s),k.fill(),n&&k.stroke()}return k.setTransform(1,0,0,1,0,0),i(k,{cutoff:null!=b.cutoff?b.cutoff:.5,radius:null!=b.radius?b.radius:.5*m})}},{"bitmap-sdf":94,"draw-svg-path":169,"is-svg-path":425,"parse-svg-path":461,"svg-path-bounds":534}],537:[function(a,b,c){(function(c){"use strict";b.exports=function a(b,c,e){var e=e||{},g=f[b];g||(g=f[b]={" ":{data:new Float32Array(0),shape:.2}});var h=g[c];if(!h)if(c.length<=1||!/\d/.test(c))h=g[c]=function(a){for(var b=a.cells,c=a.positions,d=new Float32Array(6*b.length),e=0,f=0,g=0;g<b.length;++g)for(var h=b[g],i=0;i<3;++i){var j=c[h[i]];d[e++]=j[0],d[e++]=j[1]+1.4,f=Math.max(j[0],f)}return{data:d,shape:f}}(d(c,{triangles:!0,font:b,textAlign:e.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var i=c.split(/(\d|\s)/),j=new Array(i.length),k=0,l=0,m=0;m<i.length;++m)j[m]=a(b,i[m]),k+=j[m].data.length,l+=j[m].shape,m>0&&(l+=.02);for(var n=new Float32Array(k),o=0,p=-.5*l,m=0;m<j.length;++m){for(var q=j[m].data,r=0;r<q.length;r+=2)n[o++]=q[r]+p,n[o++]=q[r+1];p+=j[m].shape+.02}h=g[c]={data:n,shape:l}}return h};var d=a("vectorize-text"),e=window||c.global||{},f=e.__TEXT_CACHE||{};e.__TEXT_CACHE={}}).call(this,a("_process"))},{_process:483,"vectorize-text":551}],538:[function(a,b,c){!function(a){function c(b,d){if(d=d||{},(b=b||"")instanceof c)return b;if(!(this instanceof c))return new c(b,d);var e=function(b){var c={r:0,g:0,b:0},d=1,e=null,f=null,g=null,h=!1,i=!1;"string"==typeof b&&(b=function(a){a=a.replace(D,"").replace(E,"").toLowerCase();var b,c=!1;if(N[a])a=N[a],c=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};return(b=P.rgb.exec(a))?{r:b[1],g:b[2],b:b[3]}:(b=P.rgba.exec(a))?{r:b[1],g:b[2],b:b[3],a:b[4]}:(b=P.hsl.exec(a))?{h:b[1],s:b[2],l:b[3]}:(b=P.hsla.exec(a))?{h:b[1],s:b[2],l:b[3],a:b[4]}:(b=P.hsv.exec(a))?{h:b[1],s:b[2],v:b[3]}:(b=P.hsva.exec(a))?{h:b[1],s:b[2],v:b[3],a:b[4]}:(b=P.hex8.exec(a))?{r:x(b[1]),g:x(b[2]),b:x(b[3]),a:B(b[4]),format:c?"name":"hex8"}:(b=P.hex6.exec(a))?{r:x(b[1]),g:x(b[2]),b:x(b[3]),format:c?"name":"hex"}:(b=P.hex4.exec(a))?{r:x(b[1]+""+b[1]),g:x(b[2]+""+b[2]),b:x(b[3]+""+b[3]),a:B(b[4]+""+b[4]),format:c?"name":"hex8"}:!!(b=P.hex3.exec(a))&&{r:x(b[1]+""+b[1]),g:x(b[2]+""+b[2]),b:x(b[3]+""+b[3]),format:c?"name":"hex"}}(b)),"object"==typeof b&&(C(b.r)&&C(b.g)&&C(b.b)?(j=b.r,k=b.g,l=b.b,c={r:255*v(j,255),g:255*v(k,255),b:255*v(l,255)},h=!0,i="%"===String(b.r).substr(-1)?"prgb":"rgb"):C(b.h)&&C(b.s)&&C(b.v)?(e=z(b.s),f=z(b.v),c=function(b,c,d){b=6*v(b,360),c=v(c,100),d=v(d,100);var e=a.floor(b),f=b-e,g=d*(1-c),h=d*(1-f*c),i=d*(1-(1-f)*c),j=e%6;return{r:255*[d,h,g,g,i,d][j],g:255*[i,d,d,h,g,g][j],b:255*[g,g,i,d,d,h][j]}}(b.h,e,f),h=!0,i="hsv"):C(b.h)&&C(b.s)&&C(b.l)&&(e=z(b.s),g=z(b.l),c=function(a,b,c){function d(a,b,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+6*(b-a)*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=v(a,360),b=v(b,100),c=v(c,100),0===b)e=f=g=c;else{var h=c<.5?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}(b.h,e,g),h=!0,i="hsl"),b.hasOwnProperty("a")&&(d=b.a));var j,k,l;return d=u(d),{ok:h,format:b.format||i,r:H(255,I(c.r,0)),g:H(255,I(c.g,0)),b:H(255,I(c.b,0)),a:d}}(b);this._originalInput=b,this._r=e.r,this._g=e.g,this._b=e.b,this._a=e.a,this._roundA=G(100*this._a)/100,this._format=d.format||e.format,this._gradientType=d.gradientType,this._r<1&&(this._r=G(this._r)),this._g<1&&(this._g=G(this._g)),this._b<1&&(this._b=G(this._b)),this._ok=e.ok,this._tc_id=F++}function d(a,b,c){a=v(a,255),b=v(b,255),c=v(c,255);var d,e,f=I(a,b,c),g=H(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(b<c?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function e(a,b,c){a=v(a,255),b=v(b,255),c=v(c,255);var d,e,f=I(a,b,c),g=H(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(b<c?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function f(a,b,c,d){var e=[y(G(a).toString(16)),y(G(b).toString(16)),y(G(c).toString(16))];return d&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function g(a,b,c,d){return[y(A(d)),y(G(a).toString(16)),y(G(b).toString(16)),y(G(c).toString(16))].join("")}function h(a,b){b=0===b?0:b||10;var d=c(a).toHsl();return d.s-=b/100,d.s=w(d.s),c(d)}function i(a,b){b=0===b?0:b||10;var d=c(a).toHsl();return d.s+=b/100,d.s=w(d.s),c(d)}function j(a){return c(a).desaturate(100)}function k(a,b){b=0===b?0:b||10;var d=c(a).toHsl();return d.l+=b/100,d.l=w(d.l),c(d)}function l(a,b){b=0===b?0:b||10;var d=c(a).toRgb();return d.r=I(0,H(255,d.r-G(-b/100*255))),d.g=I(0,H(255,d.g-G(-b/100*255))),d.b=I(0,H(255,d.b-G(-b/100*255))),c(d)}function m(a,b){b=0===b?0:b||10;var d=c(a).toHsl();return d.l-=b/100,d.l=w(d.l),c(d)}function n(a,b){var d=c(a).toHsl(),e=(d.h+b)%360;return d.h=e<0?360+e:e,c(d)}function o(a){var b=c(a).toHsl();return b.h=(b.h+180)%360,c(b)}function p(a){var b=c(a).toHsl(),d=b.h;return[c(a),c({h:(d+120)%360,s:b.s,l:b.l}),c({h:(d+240)%360,s:b.s,l:b.l})]}function q(a){var b=c(a).toHsl(),d=b.h;return[c(a),c({h:(d+90)%360,s:b.s,l:b.l}),c({h:(d+180)%360,s:b.s,l:b.l}),c({h:(d+270)%360,s:b.s,l:b.l})]}function r(a){var b=c(a).toHsl(),d=b.h;return[c(a),c({h:(d+72)%360,s:b.s,l:b.l}),c({h:(d+216)%360,s:b.s,l:b.l})]}function s(a,b,d){b=b||6,d=d||30;var e=c(a).toHsl(),f=360/d,g=[c(a)];for(e.h=(e.h-(f*b>>1)+720)%360;--b;)e.h=(e.h+f)%360,g.push(c(e));return g}function t(a,b){b=b||6;for(var d=c(a).toHsv(),e=d.h,f=d.s,g=d.v,h=[],i=1/b;b--;)h.push(c({h:e,s:f,v:g})),g=(g+i)%1;return h}function u(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function v(b,c){(function(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)})(b)&&(b="100%");var d=function(a){return"string"==typeof a&&-1!=a.indexOf("%")}(b);return b=H(c,I(0,parseFloat(b))),d&&(b=parseInt(b*c,10)/100),a.abs(b-c)<1e-6?1:b%c/parseFloat(c)}function w(a){return H(1,I(0,a))}function x(a){return parseInt(a,16)}function y(a){return 1==a.length?"0"+a:""+a}function z(a){return a<=1&&(a=100*a+"%"),a}function A(b){return a.round(255*parseFloat(b)).toString(16)}function B(a){return x(a)/255}function C(a){return!!P.CSS_UNIT.exec(a)}var D=/^\s+/,E=/\s+$/,F=0,G=a.round,H=a.min,I=a.max,J=a.random;c.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1e3},getLuminance:function(){var b,c,d,e=this.toRgb();return b=e.r/255,c=e.g/255,d=e.b/255,.2126*(b<=.03928?b/12.92:a.pow((b+.055)/1.055,2.4))+.7152*(c<=.03928?c/12.92:a.pow((c+.055)/1.055,2.4))+.0722*(d<=.03928?d/12.92:a.pow((d+.055)/1.055,2.4))},setAlpha:function(a){return this._a=u(a),this._roundA=G(100*this._a)/100,this},toHsv:function(){var a=e(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=e(this._r,this._g,this._b),b=G(360*a.h),c=G(100*a.s),d=G(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHsl:function(){var a=d(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=d(this._r,this._g,this._b),b=G(360*a.h),c=G(100*a.s),e=G(100*a.l);return 1==this._a?"hsl("+b+", "+c+"%, "+e+"%)":"hsla("+b+", "+c+"%, "+e+"%, "+this._roundA+")"},toHex:function(a){return f(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(a){return function(a,b,c,d,e){var f=[y(G(a).toString(16)),y(G(b).toString(16)),y(G(c).toString(16)),y(A(d))];return e&&f[0].charAt(0)==f[0].charAt(1)&&f[1].charAt(0)==f[1].charAt(1)&&f[2].charAt(0)==f[2].charAt(1)&&f[3].charAt(0)==f[3].charAt(1)?f[0].charAt(0)+f[1].charAt(0)+f[2].charAt(0)+f[3].charAt(0):f.join("")}(this._r,this._g,this._b,this._a,a)},toHex8String:function(a){return"#"+this.toHex8(a)},toRgb:function(){return{r:G(this._r),g:G(this._g),b:G(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+G(this._r)+", "+G(this._g)+", "+G(this._b)+")":"rgba("+G(this._r)+", "+G(this._g)+", "+G(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:G(100*v(this._r,255))+"%",g:G(100*v(this._g,255))+"%",b:G(100*v(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+G(100*v(this._r,255))+"%, "+G(100*v(this._g,255))+"%, "+G(100*v(this._b,255))+"%)":"rgba("+G(100*v(this._r,255))+"%, "+G(100*v(this._g,255))+"%, "+G(100*v(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(O[f(this._r,this._g,this._b,!0)]||!1)},toFilter:function(a){var b="#"+g(this._r,this._g,this._b,this._a),d=b,e=this._gradientType?"GradientType = 1, ":"";if(a){var f=c(a);d="#"+g(f._r,f._g,f._b,f._a)}return"progid:DXImageTransform.Microsoft.gradient("+e+"startColorstr="+b+",endColorstr="+d+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=this._a<1&&this._a>=0;return b||!d||"hex"!==a&&"hex6"!==a&&"hex3"!==a&&"hex4"!==a&&"hex8"!==a&&"name"!==a?("rgb"===a&&(c=this.toRgbString()),"prgb"===a&&(c=this.toPercentageRgbString()),"hex"!==a&&"hex6"!==a||(c=this.toHexString()),"hex3"===a&&(c=this.toHexString(!0)),"hex4"===a&&(c=this.toHex8String(!0)),"hex8"===a&&(c=this.toHex8String()),"name"===a&&(c=this.toName()),"hsl"===a&&(c=this.toHslString()),"hsv"===a&&(c=this.toHsvString()),c||this.toHexString()):"name"===a&&0===this._a?this.toName():this.toRgbString()},clone:function(){return c(this.toString())},_applyModification:function(a,b){var c=a.apply(null,[this].concat([].slice.call(b)));return this._r=c._r,this._g=c._g,this._b=c._b,this.setAlpha(c._a),this},lighten:function(){return this._applyModification(k,arguments)},brighten:function(){return this._applyModification(l,arguments)},darken:function(){return this._applyModification(m,arguments)},desaturate:function(){return this._applyModification(h,arguments)},saturate:function(){return this._applyModification(i,arguments)},greyscale:function(){return this._applyModification(j,arguments)},spin:function(){return this._applyModification(n,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(s,arguments)},complement:function(){return this._applyCombination(o,arguments)},monochromatic:function(){return this._applyCombination(t,arguments)},splitcomplement:function(){return this._applyCombination(r,arguments)},triad:function(){return this._applyCombination(p,arguments)},tetrad:function(){return this._applyCombination(q,arguments)}},c.fromRatio=function(a,b){if("object"==typeof a){var d={};for(var e in a)a.hasOwnProperty(e)&&(d[e]="a"===e?a[e]:z(a[e]));a=d}return c(a,b)},c.equals=function(a,b){return!(!a||!b)&&c(a).toRgbString()==c(b).toRgbString()},c.random=function(){return c.fromRatio({r:J(),g:J(),b:J()})},c.mix=function(a,b,d){d=0===d?0:d||50;var e=c(a).toRgb(),f=c(b).toRgb(),g=d/100;return c({r:(f.r-e.r)*g+e.r,g:(f.g-e.g)*g+e.g,b:(f.b-e.b)*g+e.b,a:(f.a-e.a)*g+e.a})},c.readability=function(b,d){var e=c(b),f=c(d);return(a.max(e.getLuminance(),f.getLuminance())+.05)/(a.min(e.getLuminance(),f.getLuminance())+.05)},c.isReadable=function(a,b,d){var e,f,g=c.readability(a,b);switch(f=!1,(e=function(a){var b,c;return b=((a=a||{level:"AA",size:"small"}).level||"AA").toUpperCase(),c=(a.size||"small").toLowerCase(),"AA"!==b&&"AAA"!==b&&(b="AA"),"small"!==c&&"large"!==c&&(c="small"),{level:b,size:c}}(d)).level+e.size){case"AAsmall":case"AAAlarge":f=g>=4.5;break;case"AAlarge":f=g>=3;break;case"AAAsmall":f=g>=7}return f},c.mostReadable=function(a,b,d){var e,f,g,h,i=null,j=0;f=(d=d||{}).includeFallbackColors,g=d.level,h=d.size;for(var k=0;k<b.length;k++)(e=c.readability(a,b[k]))>j&&(j=e,i=c(b[k]));return c.isReadable(a,i,{level:g,size:h})||!f?i:(d.includeFallbackColors=!1,c.mostReadable(a,["#fff","#000"],d))};var K,L,M,N=c.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},O=c.hexNames=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}(N),P=(L="[\\s|\\(]+("+(K="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+K+")[,|\\s]+("+K+")\\s*\\)?",M="[\\s|\\(]+("+K+")[,|\\s]+("+K+")[,|\\s]+("+K+")[,|\\s]+("+K+")\\s*\\)?",{CSS_UNIT:new RegExp(K),rgb:new RegExp("rgb"+L),rgba:new RegExp("rgba"+M),hsl:new RegExp("hsl"+L),hsla:new RegExp("hsla"+M),hsv:new RegExp("hsv"+L),hsva:new RegExp("hsva"+M),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});void 0!==b&&b.exports?b.exports=c:window.tinycolor=c}(Math)},{}],539:[function(a,b,c){"use strict";function d(a){if(a.length){if(a instanceof Float32Array)return a;var b=new Float32Array(a);return b.set(a),b}return e[0]=a,e[0]}b.exports=d,b.exports.float32=b.exports.float=d,b.exports.fract32=b.exports.fract=function(a){if(a.length){for(var b=d(a),c=0,e=b.length;c<e;c++)b[c]=a[c]-b[c];return b}return d(a-d(a))};var e=new Float32Array(1)},{}],540:[function(a,b,c){"use strict";function d(a,b){var c=f(getComputedStyle(a).getPropertyValue(b));return c[0]*e(c[1],a)}function e(a,b){switch(b=b||document.body,a=(a||"px").trim().toLowerCase(),b!==window&&b!==document||(b=document.body),a){case"%":return b.clientHeight/100;case"ch":case"ex":return function(a,b){var c=document.createElement("div");c.style["font-size"]="128"+a,b.appendChild(c);var e=d(c,"font-size")/128;return b.removeChild(c),e}(a,b);case"em":return d(b,"font-size");case"rem":return d(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return g;case"cm":return g/2.54;case"mm":return g/25.4;case"pt":return g/72;case"pc":return g/6}return 1}var f=a("parse-unit");b.exports=e;var g=96},{"parse-unit":462}],541:[function(a,b,c){var d;d=this,function(a){"use strict";function b(a,b){var d=b.id,e=b.bbox,f=null==b.properties?{}:b.properties,g=c(a,b);return null==d&&null==e?{type:"Feature",properties:f,geometry:g}:null==e?{type:"Feature",id:d,properties:f,geometry:g}:{type:"Feature",id:d,bbox:e,properties:f,geometry:g}}function c(a,b){function c(a,b){b.length&&b.pop();for(var c=k[a<0?~a:a],d=0,e=c.length;d<e;++d)b.push(j(c[d].slice(),d));a<0&&i(b,e)}function d(a){return j(a.slice())}function e(a){for(var b=[],d=0,e=a.length;d<e;++d)c(a[d],b);return b.length<2&&b.push(b[0].slice()),b}function f(a){for(var b=e(a);b.length<4;)b.push(b[0].slice());return b}function h(a){return a.map(f)}var j=g(a),k=a.arcs;return function a(b){var c,f=b.type;switch(f){case"GeometryCollection":return{type:f,geometries:b.geometries.map(a)};case"Point":c=d(b.coordinates);break;case"MultiPoint":c=b.coordinates.map(d);break;case"LineString":c=e(b.arcs);break;case"MultiLineString":c=b.arcs.map(e);break;case"Polygon":c=h(b.arcs);break;case"MultiPolygon":c=b.arcs.map(h);break;default:return null}return{type:f,coordinates:c}}(b)}function d(a,b,c){var d,e,f;if(arguments.length>1)d=function(a,b,c){function d(a){var b=a<0?~a:a;(i[b]||(i[b]=[])).push({i:a,g:g})}function e(a){a.forEach(d)}function f(a){a.forEach(e)}var g,h=[],i=[];return function a(b){switch(g=b,b.type){case"GeometryCollection":b.geometries.forEach(a);break;case"LineString":e(b.arcs);break;case"MultiLineString":case"Polygon":f(b.arcs);break;case"MultiPolygon":b.arcs.forEach(f)}}(b),i.forEach(null==c?function(a){h.push(a[0].i)}:function(a){c(a[0].g,a[a.length-1].g)&&h.push(a[0].i)}),h}(0,b,c);else for(e=0,d=new Array(f=a.arcs.length);e<f;++e)d[e]=e;return{type:"MultiLineString",arcs:j(a,d)}}function e(a,b){function d(a){a.forEach(function(b){b.forEach(function(b){(f[b=b<0?~b:b]||(f[b]=[])).push(a)})}),g.push(a)}function e(b){return function(a){for(var b,c=-1,d=a.length,e=a[d-1],f=0;++c<d;)b=e,e=a[c],f+=b[0]*e[1]-b[1]*e[0];return Math.abs(f)}(c(a,{type:"Polygon",arcs:[b]}).coordinates[0])}var f={},g=[],h=[];return b.forEach(function a(b){switch(b.type){case"GeometryCollection":b.geometries.forEach(a);break;case"Polygon":d(b.arcs);break;case"MultiPolygon":b.arcs.forEach(d)}}),g.forEach(function(a){if(!a._){var b=[],c=[a];for(a._=1,h.push(b);a=c.pop();)b.push(a),a.forEach(function(a){a.forEach(function(a){f[a<0?~a:a].forEach(function(a){a._||(a._=1,c.push(a))})})})}}),g.forEach(function(a){delete a._}),{type:"MultiPolygon",arcs:h.map(function(b){var c,d=[];if(b.forEach(function(a){a.forEach(function(a){a.forEach(function(a){f[a<0?~a:a].length<2&&d.push(a)})})}),(c=(d=j(a,d)).length)>1)for(var g,h,i=1,k=e(d[0]);i<c;++i)(g=e(d[i]))>k&&(h=d[0],d[0]=d[i],d[i]=h,k=g);return d})}}var f=function(a){return a},g=function(a){if(null==(b=a.transform))return f;var b,c,d,e=b.scale[0],g=b.scale[1],h=b.translate[0],i=b.translate[1];return function(a,b){return b||(c=d=0),a[0]=(c+=a[0])*e+h,a[1]=(d+=a[1])*g+i,a}},h=function(a){function b(a){i[0]=a[0],i[1]=a[1],h(i),i[0]<j&&(j=i[0]),i[0]>l&&(l=i[0]),i[1]<k&&(k=i[1]),i[1]>m&&(m=i[1])}function c(a){switch(a.type){case"GeometryCollection":a.geometries.forEach(c);break;case"Point":b(a.coordinates);break;case"MultiPoint":a.coordinates.forEach(b)}}var d=a.bbox;if(!d){var e,f,h=g(a),i=new Array(2),j=1/0,k=j,l=-j,m=-j;for(f in a.arcs.forEach(function(a){for(var b=-1,c=a.length;++b<c;)e=a[b],i[0]=e[0],i[1]=e[1],h(i,b),i[0]<j&&(j=i[0]),i[0]>l&&(l=i[0]),i[1]<k&&(k=i[1]),i[1]>m&&(m=i[1])}),a.objects)c(a.objects[f]);d=a.bbox=[j,k,l,m]}return d},i=function(a,b){for(var c,d=a.length,e=d-b;e<--d;)c=a[e],a[e++]=a[d],a[d]=c},j=function(a,b){function c(a,b){for(var c in a){var e=a[c];delete b[e.start],delete e.start,delete e.end,e.forEach(function(a){d[a<0?~a:a]=1}),g.push(e)}}var d={},e={},f={},g=[],h=-1;return b.forEach(function(c,d){var e,f=a.arcs[c<0?~c:c];f.length<3&&!f[1][0]&&!f[1][1]&&(e=b[++h],b[h]=c,b[d]=e)}),b.forEach(function(b){var c,d,g=function(b){var c,d=a.arcs[b<0?~b:b],e=d[0];return a.transform?(c=[0,0],d.forEach(function(a){c[0]+=a[0],c[1]+=a[1]})):c=d[d.length-1],b<0?[c,e]:[e,c]}(b),h=g[0],i=g[1];if(c=f[h])if(delete f[c.end],c.push(b),c.end=i,d=e[i]){delete e[d.start];var j=d===c?c:c.concat(d);e[j.start=c.start]=f[j.end=d.end]=j}else e[c.start]=f[c.end]=c;else if(c=e[i])if(delete e[c.start],c.unshift(b),c.start=h,d=f[h]){delete f[d.end];var k=d===c?c:d.concat(c);e[k.start=d.start]=f[k.end=c.end]=k}else e[c.start]=f[c.end]=c;else e[(c=[b]).start=h]=f[c.end=i]=c}),c(f,e),c(e,f),b.forEach(function(a){d[a<0?~a:a]||g.push([a])}),g},k=function(a,b){for(var c=0,d=a.length;c<d;){var e=c+d>>>1;a[e]<b?c=e+1:d=e}return c};a.bbox=h,a.feature=function(a,c){return"GeometryCollection"===c.type?{type:"FeatureCollection",features:c.geometries.map(function(c){return b(a,c)})}:b(a,c)},a.mesh=function(a){return c(a,d.apply(this,arguments))},a.meshArcs=d,a.merge=function(a){return c(a,e.apply(this,arguments))},a.mergeArcs=e,a.neighbors=function(a){function b(a,b){a.forEach(function(a){a<0&&(a=~a);var c=d[a];c?c.push(b):d[a]=[b]})}function c(a,c){a.forEach(function(a){b(a,c)})}var d={},e=a.map(function(){return[]}),f={LineString:b,MultiLineString:c,Polygon:c,MultiPolygon:function(a,b){a.forEach(function(a){c(a,b)})}};for(var g in a.forEach(function a(b,c){"GeometryCollection"===b.type?b.geometries.forEach(function(b){a(b,c)}):b.type in f&&f[b.type](b.arcs,c)}),d)for(var h=d[g],i=h.length,j=0;j<i;++j)for(var l=j+1;l<i;++l){var m,n=h[j],o=h[l];(m=e[n])[g=k(m,o)]!==o&&m.splice(g,0,o),(m=e[o])[g=k(m,n)]!==n&&m.splice(g,0,n)}return e},a.quantize=function(a,b){function c(a){a[0]=Math.round((a[0]-g)/i),a[1]=Math.round((a[1]-j)/k)}function d(a){switch(a.type){case"GeometryCollection":a.geometries.forEach(d);break;case"Point":c(a.coordinates);break;case"MultiPoint":a.coordinates.forEach(c)}}if(!((b=Math.floor(b))>=2))throw new Error("n must be 2");if(a.transform)throw new Error("already quantized");var e,f=h(a),g=f[0],i=(f[2]-g)/(b-1)||1,j=f[1],k=(f[3]-j)/(b-1)||1;for(e in a.arcs.forEach(function(a){for(var b,c,d,e=1,f=1,h=a.length,l=a[0],m=l[0]=Math.round((l[0]-g)/i),n=l[1]=Math.round((l[1]-j)/k);e<h;++e)l=a[e],c=Math.round((l[0]-g)/i),d=Math.round((l[1]-j)/k),c===m&&d===n||((b=a[f++])[0]=c-m,m=c,b[1]=d-n,n=d);f<2&&((b=a[f++])[0]=0,b[1]=0),a.length=f}),a.objects)d(a.objects[e]);return a.transform={scale:[i,k],translate:[g,j]},a},a.transform=g,a.untransform=function(a){if(null==(b=a.transform))return f;var b,c,d,e=b.scale[0],g=b.scale[1],h=b.translate[0],i=b.translate[1];return function(a,b){b||(c=d=0);var f=Math.round((a[0]-h)/e),j=Math.round((a[1]-i)/g);return a[0]=f-c,c=f,a[1]=j-d,d=j,a}},Object.defineProperty(a,"__esModule",{value:!0})}("object"==typeof c&&void 0!==b?c:d.topojson=d.topojson||{})},{}],542:[function(a,b,c){"use strict";b.exports=function(a){if(a<0)return[];if(0===a)return[[0]];for(var b=0|Math.round(f(a+1)),c=[],g=0;g<b;++g){for(var h=d.unrank(a,g),i=[0],j=0,k=0;k<h.length;++k)j+=1<<h[k],i.push(j);e(h)<1&&(i[0]=j,i[a]=0),c.push(i)}return c};var d=a("permutation-rank"),e=a("permutation-parity"),f=a("gamma")},{gamma:232,"permutation-parity":464,"permutation-rank":465}],543:[function(a,b,c){"use strict";function d(a,b,c){return Math.sqrt(Math.pow(a,2)+Math.pow(b,2)+Math.pow(c,2))}function e(a){return Math.min(1,Math.max(-1,a))}function f(a){var b=Math.abs(a[0]),c=Math.abs(a[1]),d=Math.abs(a[2]),e=[0,0,0];b>Math.max(c,d)?e[2]=1:c>Math.max(b,d)?e[0]=1:e[1]=1;for(var f=0,g=0,h=0;h<3;++h)f+=a[h]*a[h],g+=e[h]*a[h];for(h=0;h<3;++h)e[h]-=g/f*a[h];return l(e,e),e}function g(a,b,c,d,e,f,g,i){this.center=h(c),this.up=h(d),this.right=h(e),this.radius=h([f]),this.angle=h([g,i]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(a,b),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var j=0;j<16;++j)this.computedMatrix[j]=.5;this.recalcMatrix(0)}b.exports=function(a){var b=(a=a||{}).center||[0,0,0],c=a.up||[0,1,0],e=a.right||f(c),h=a.radius||1,i=a.theta||0,j=a.phi||0;if(b=[].slice.call(b,0,3),c=[].slice.call(c,0,3),l(c,c),e=[].slice.call(e,0,3),l(e,e),"eye"in a){var n=a.eye,o=[n[0]-b[0],n[1]-b[1],n[2]-b[2]];k(e,o,c),d(e[0],e[1],e[2])<1e-6?e=f(c):l(e,e),h=d(o[0],o[1],o[2]);var p=m(c,o)/h,q=m(e,o)/h;j=Math.acos(p),i=Math.acos(q)}return h=Math.log(h),new g(a.zoomMin,a.zoomMax,b,c,e,h,i,j)};var h=a("filtered-vector"),i=a("gl-mat4/invert"),j=a("gl-mat4/rotate"),k=a("gl-vec3/cross"),l=a("gl-vec3/normalize"),m=a("gl-vec3/dot"),n=g.prototype;n.setDistanceLimits=function(a,b){a=a>0?Math.log(a):-1/0,b=b>0?Math.log(b):1/0,b=Math.max(b,a),this.radius.bounds[0][0]=a,this.radius.bounds[1][0]=b},n.getDistanceLimits=function(a){var b=this.radius.bounds[0];return a?(a[0]=Math.exp(b[0][0]),a[1]=Math.exp(b[1][0]),a):[Math.exp(b[0][0]),Math.exp(b[1][0])]},n.recalcMatrix=function(a){this.center.curve(a),this.up.curve(a),this.right.curve(a),this.radius.curve(a),this.angle.curve(a);for(var b=this.computedUp,c=this.computedRight,e=0,f=0,g=0;g<3;++g)f+=b[g]*c[g],e+=b[g]*b[g];var h=Math.sqrt(e),i=0;for(g=0;g<3;++g)c[g]-=b[g]*f/e,i+=c[g]*c[g],b[g]/=h;var j=Math.sqrt(i);for(g=0;g<3;++g)c[g]/=j;var m=this.computedToward;k(m,b,c),l(m,m);var n=Math.exp(this.computedRadius[0]),o=this.computedAngle[0],p=this.computedAngle[1],q=Math.cos(o),r=Math.sin(o),s=Math.cos(p),t=Math.sin(p),u=this.computedCenter,v=q*s,w=r*s,x=t,y=-q*t,z=-r*t,A=s,B=this.computedEye,C=this.computedMatrix;for(g=0;g<3;++g){var D=v*c[g]+w*m[g]+x*b[g];C[4*g+1]=y*c[g]+z*m[g]+A*b[g],C[4*g+2]=D,C[4*g+3]=0}
var E=C[1],F=C[5],G=C[9],H=C[2],I=C[6],J=C[10],K=F*J-G*I,L=G*H-E*J,M=E*I-F*H,N=d(K,L,M);for(K/=N,L/=N,M/=N,C[0]=K,C[4]=L,C[8]=M,g=0;g<3;++g)B[g]=u[g]+C[2+4*g]*n;for(g=0;g<3;++g){i=0;for(var O=0;O<3;++O)i+=C[g+4*O]*B[O];C[12+g]=-i}C[15]=1},n.getMatrix=function(a,b){this.recalcMatrix(a);var c=this.computedMatrix;if(b){for(var d=0;d<16;++d)b[d]=c[d];return b}return c};var o=[0,0,0];n.rotate=function(a,b,c,d){if(this.angle.move(a,b,c),d){this.recalcMatrix(a);var e=this.computedMatrix;o[0]=e[2],o[1]=e[6],o[2]=e[10];for(var f=this.computedUp,g=this.computedRight,h=this.computedToward,i=0;i<3;++i)e[4*i]=f[i],e[4*i+1]=g[i],e[4*i+2]=h[i];for(j(e,e,d,o),i=0;i<3;++i)f[i]=e[4*i],g[i]=e[4*i+1];this.up.set(a,f[0],f[1],f[2]),this.right.set(a,g[0],g[1],g[2])}},n.pan=function(a,b,c,e){b=b||0,c=c||0,e=e||0,this.recalcMatrix(a);var f=this.computedMatrix,g=(Math.exp(this.computedRadius[0]),f[1]),h=f[5],i=f[9],j=d(g,h,i);g/=j,h/=j,i/=j;var k=f[0],l=f[4],m=f[8],n=k*g+l*h+m*i,o=d(k-=g*n,l-=h*n,m-=i*n),p=(k/=o)*b+g*c,q=(l/=o)*b+h*c,r=(m/=o)*b+i*c;this.center.move(a,p,q,r);var s=Math.exp(this.computedRadius[0]);s=Math.max(1e-4,s+e),this.radius.set(a,Math.log(s))},n.translate=function(a,b,c,d){this.center.move(a,b||0,c||0,d||0)},n.setMatrix=function(a,b,c,f){var g=1;"number"==typeof c&&(g=0|c),(g<0||g>3)&&(g=1);var h=(g+2)%3;b||(this.recalcMatrix(a),b=this.computedMatrix);var j=b[g],k=b[g+4],l=b[g+8];if(f){var m=Math.abs(j),n=Math.abs(k),o=Math.abs(l),p=Math.max(m,n,o);m===p?(j=j<0?-1:1,k=l=0):o===p?(l=l<0?-1:1,j=k=0):(k=k<0?-1:1,j=l=0)}else{var q=d(j,k,l);j/=q,k/=q,l/=q}var r,s,t=b[h],u=b[h+4],v=b[h+8],w=t*j+u*k+v*l,x=d(t-=j*w,u-=k*w,v-=l*w),y=k*(v/=x)-l*(u/=x),z=l*(t/=x)-j*v,A=j*u-k*t,B=d(y,z,A);if(y/=B,z/=B,A/=B,this.center.jump(a,S,T,U),this.radius.idle(a),this.up.jump(a,j,k,l),this.right.jump(a,t,u,v),2===g){var C=b[1],D=b[5],E=b[9],F=C*t+D*u+E*v,G=C*y+D*z+E*A;r=K<0?-Math.PI/2:Math.PI/2,s=Math.atan2(G,F)}else{var H=b[2],I=b[6],J=b[10],K=H*j+I*k+J*l,L=H*t+I*u+J*v,M=H*y+I*z+J*A;r=Math.asin(e(K)),s=Math.atan2(M,L)}this.angle.jump(a,s,r),this.recalcMatrix(a);var N=b[2],O=b[6],P=b[10],Q=this.computedMatrix;i(Q,b);var R=Q[15],S=Q[12]/R,T=Q[13]/R,U=Q[14]/R,V=Math.exp(this.computedRadius[0]);this.center.jump(a,S-N*V,T-O*V,U-P*V)},n.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},n.idle=function(a){this.center.idle(a),this.up.idle(a),this.right.idle(a),this.radius.idle(a),this.angle.idle(a)},n.flush=function(a){this.center.flush(a),this.up.flush(a),this.right.flush(a),this.radius.flush(a),this.angle.flush(a)},n.setDistance=function(a,b){b>0&&this.radius.set(a,Math.log(b))},n.lookAt=function(a,b,c,f){this.recalcMatrix(a),b=b||this.computedEye,c=c||this.computedCenter;var g=(f=f||this.computedUp)[0],h=f[1],i=f[2],j=d(g,h,i);if(!(j<1e-6)){g/=j,h/=j,i/=j;var k=b[0]-c[0],l=b[1]-c[1],m=b[2]-c[2],n=d(k,l,m);if(!(n<1e-6)){k/=n,l/=n,m/=n;var o=this.computedRight,p=o[0],q=o[1],r=o[2],s=g*p+h*q+i*r,t=d(p-=s*g,q-=s*h,r-=s*i);if(!(t<.01&&(t=d(p=h*m-i*l,q=i*k-g*m,r=g*l-h*k))<1e-6)){p/=t,q/=t,r/=t,this.up.set(a,g,h,i),this.right.set(a,p,q,r),this.center.set(a,c[0],c[1],c[2]),this.radius.set(a,Math.log(n));var u=h*r-i*q,v=i*p-g*r,w=g*q-h*p,x=d(u,v,w),y=g*k+h*l+i*m,z=p*k+q*l+r*m,A=(u/=x)*k+(v/=x)*l+(w/=x)*m,B=Math.asin(e(y)),C=Math.atan2(A,z),D=this.angle._state,E=D[D.length-1],F=D[D.length-2];E%=2*Math.PI;var G=Math.abs(E+2*Math.PI-C),H=Math.abs(E-C),I=Math.abs(E-2*Math.PI-C);G<H&&(E+=2*Math.PI),I<H&&(E-=2*Math.PI),this.angle.jump(this.angle.lastT(),E,F),this.angle.set(a,C,B)}}}}},{"filtered-vector":227,"gl-mat4/invert":266,"gl-mat4/rotate":271,"gl-vec3/cross":335,"gl-vec3/dot":340,"gl-vec3/normalize":357}],544:[function(a,b,c){"use strict";b.exports=function(a,b,c){var e=a*b,f=d*a,g=f-(f-a),h=a-g,i=d*b,j=i-(i-b),k=b-j,l=h*k-(e-g*j-h*j-g*k);return c?(c[0]=l,c[1]=e,c):[l,e]};var d=+(Math.pow(2,27)+1)},{}],545:[function(a,b,c){"use strict";b.exports=function(a,b,c){var d=a+b,e=d-a,f=b-e,g=a-(d-e);return c?(c[0]=g+f,c[1]=d,c):[g+f,d]}},{}],546:[function(a,b,c){(function(b,d){"use strict";function e(a){if(a){var b=a.length||a.byteLength,c=r.log2(b);v[c].push(a)}}function f(a){a=r.nextPow2(a);var b=r.log2(a),c=v[b];return c.length>0?c.pop():new ArrayBuffer(a)}function g(a){return new Uint8Array(f(a),0,a)}function h(a){return new Uint16Array(f(2*a),0,a)}function i(a){return new Uint32Array(f(4*a),0,a)}function j(a){return new Int8Array(f(a),0,a)}function k(a){return new Int16Array(f(2*a),0,a)}function l(a){return new Int32Array(f(4*a),0,a)}function m(a){return new Float32Array(f(4*a),0,a)}function n(a){return new Float64Array(f(8*a),0,a)}function o(a){return t?new Uint8ClampedArray(f(a),0,a):g(a)}function p(a){return new DataView(f(a),0,a)}function q(a){a=r.nextPow2(a);var b=r.log2(a),c=w[b];return c.length>0?c.pop():new d(a)}var r=a("bit-twiddle"),s=a("dup");b.__TYPEDARRAY_POOL||(b.__TYPEDARRAY_POOL={UINT8:s([32,0]),UINT16:s([32,0]),UINT32:s([32,0]),INT8:s([32,0]),INT16:s([32,0]),INT32:s([32,0]),FLOAT:s([32,0]),DOUBLE:s([32,0]),DATA:s([32,0]),UINT8C:s([32,0]),BUFFER:s([32,0])});var t="undefined"!=typeof Uint8ClampedArray,u=b.__TYPEDARRAY_POOL;u.UINT8C||(u.UINT8C=s([32,0])),u.BUFFER||(u.BUFFER=s([32,0]));var v=u.DATA,w=u.BUFFER;c.free=function(a){if(d.isBuffer(a))w[r.log2(a.length)].push(a);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(a)&&(a=a.buffer),!a)return;var b=a.length||a.byteLength,c=0|r.log2(b);v[c].push(a)}},c.freeUint8=c.freeUint16=c.freeUint32=c.freeInt8=c.freeInt16=c.freeInt32=c.freeFloat32=c.freeFloat=c.freeFloat64=c.freeDouble=c.freeUint8Clamped=c.freeDataView=function(a){e(a.buffer)},c.freeArrayBuffer=e,c.freeBuffer=function(a){w[r.log2(a.length)].push(a)},c.malloc=function(a,b){if(void 0===b||"arraybuffer"===b)return f(a);switch(b){case"uint8":return g(a);case"uint16":return h(a);case"uint32":return i(a);case"int8":return j(a);case"int16":return k(a);case"int32":return l(a);case"float":case"float32":return m(a);case"double":case"float64":return n(a);case"uint8_clamped":return o(a);case"buffer":return q(a);case"data":case"dataview":return p(a);default:return null}return null},c.mallocArrayBuffer=f,c.mallocUint8=g,c.mallocUint16=h,c.mallocUint32=i,c.mallocInt8=j,c.mallocInt16=k,c.mallocInt32=l,c.mallocFloat32=c.mallocFloat=m,c.mallocFloat64=c.mallocDouble=n,c.mallocUint8Clamped=o,c.mallocDataView=p,c.mallocBuffer=q,c.clearCache=function(){for(var a=0;a<32;++a)u.UINT8[a].length=0,u.UINT16[a].length=0,u.UINT32[a].length=0,u.INT8[a].length=0,u.INT16[a].length=0,u.INT32[a].length=0,u.FLOAT[a].length=0,u.DOUBLE[a].length=0,u.UINT8C[a].length=0,v[a].length=0,w[a].length=0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer)},{"bit-twiddle":93,buffer:106,dup:171}],547:[function(a,b,c){"use strict";function d(a){this.roots=new Array(a),this.ranks=new Array(a);for(var b=0;b<a;++b)this.roots[b]=b,this.ranks[b]=0}b.exports=d;var e=d.prototype;Object.defineProperty(e,"length",{get:function(){return this.roots.length}}),e.makeSet=function(){var a=this.roots.length;return this.roots.push(a),this.ranks.push(0),a},e.find=function(a){for(var b=a,c=this.roots;c[a]!==a;)a=c[a];for(;c[b]!==a;){var d=c[b];c[b]=a,b=d}return a},e.link=function(a,b){var c=this.find(a),d=this.find(b);if(c!==d){var e=this.ranks,f=this.roots,g=e[c],h=e[d];g<h?f[c]=d:h<g?f[d]=c:(f[d]=c,++e[c])}}},{}],548:[function(a,b,c){"use strict";b.exports=function(a,b,c){return 0===a.length?a:b?(c||a.sort(b),function(a,b){for(var c=1,d=a.length,e=a[0],f=a[0],g=1;g<d;++g)if(f=e,b(e=a[g],f)){if(g===c){c++;continue}a[c++]=e}return a.length=c,a}(a,b)):(c||a.sort(),function(a){for(var b=1,c=a.length,d=a[0],e=a[0],f=1;f<c;++f,e=d)if(e=d,(d=a[f])!==e){if(f===b){b++;continue}a[b++]=d}return a.length=b,a}(a))}},{}],549:[function(a,b,c){var d=/[\'\"]/;b.exports=function(a){return a?(d.test(a.charAt(0))&&(a=a.substr(1)),d.test(a.charAt(a.length-1))&&(a=a.substr(0,a.length-1)),a):""}},{}],550:[function(a,b,c){"use strict";b.exports=function(a,b,c){Array.isArray(c)||(c=[].slice.call(arguments,2));for(var d=0,e=c.length;d<e;d++){var f=c[d];for(var g in f)if((void 0===b[g]||Array.isArray(b[g])||a[g]!==b[g])&&g in b){var h;if(!0===f[g])h=b[g];else{if(!1===f[g])continue;if("function"==typeof f[g]&&void 0===(h=f[g](b[g],a,b)))continue}a[g]=h}}return a}},{}],551:[function(a,b,c){"use strict";b.exports=function(a,b){return"object"==typeof b&&null!==b||(b={}),d(a,b.canvas||e,b.context||f,b)};var d=a("./lib/vtext"),e=null,f=null;"undefined"!=typeof document&&((e=document.createElement("canvas")).width=8192,e.height=1024,f=e.getContext("2d"))},{"./lib/vtext":552}],552:[function(a,b,c){function d(a,b,c,d){for(var e="<"+a+">",f="</"+a+">",g=e.length,h=f.length,i=b[0]===s||b[0]===v,j=0,k=-h;j>-1&&-1!==(j=c.indexOf(e,j))&&-1!==(k=c.indexOf(f,j+g))&&!(k<=j);){for(var l=j;l<k+h;++l)if(l<j+g||l>=k)d[l]=null,c=c.substr(0,l)+" "+c.substr(l+1);else if(null!==d[l]){var m=d[l].indexOf(b[0]);-1===m?d[l]+=b:i&&(d[l]=d[l].substr(0,m+1)+(1+parseInt(d[l][m+1]))+d[l].substr(m+2))}var n=j+g,o=c.substr(n,k-n).indexOf(e);j=-1!==o?o:k+h}return d}function e(a,b){var c=h(a,128);return b?j(c.cells,c.positions,.25):{edges:c.cells,positions:c.positions}}function f(a,b,c,d){var f=e(a,d),g=function(a,b,c){for(var d=b.textAlign||"start",e=b.textBaseline||"alphabetic",f=[1<<30,1<<30],g=[0,0],h=a.length,i=0;i<h;++i)for(var j=a[i],k=0;k<2;++k)f[k]=0|Math.min(f[k],j[k]),g[k]=0|Math.max(g[k],j[k]);var l=0;switch(d){case"center":l=-.5*(f[0]+g[0]);break;case"right":case"end":l=-g[0];break;case"left":case"start":l=-f[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+d+"'")}var m=0;switch(e){case"hanging":case"top":m=-f[1];break;case"middle":m=-.5*(f[1]+g[1]);break;case"alphabetic":case"ideographic":m=-3*c;break;case"bottom":m=-g[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+e+"'")}var n=1/c;return"lineHeight"in b?n*=+b.lineHeight:"width"in b?n=b.width/(g[0]-f[0]):"height"in b&&(n=b.height/(g[1]-f[1])),a.map(function(a){return[n*(a[0]+l),n*(a[1]+m)]})}(f.positions,b,c),h=f.edges,i="ccw"===b.orientation;if(k(g,h),b.polygons||b.polygon||b.polyline){for(var j=m(h,g),n=new Array(j.length),o=0;o<j.length;++o){for(var p=j[o],q=new Array(p.length),r=0;r<p.length;++r){for(var s=p[r],t=new Array(s.length),u=0;u<s.length;++u)t[u]=g[s[u]].slice();i&&t.reverse(),q[r]=t}n[o]=q}return n}return b.triangles||b.triangulate||b.triangle?{cells:l(g,h,{delaunay:!1,exterior:!1,interior:!0}),positions:g}:{edges:h,positions:g}}function g(a,b,c){try{return f(a,b,c,!0)}catch(a){}try{return f(a,b,c,!1)}catch(a){}return b.polygons||b.polyline||b.polygon?[]:b.triangles||b.triangulate||b.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}b.exports=function(a,b,c,e){var f=64,h=1.25,j={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return e&&(e.size&&e.size>0&&(f=e.size),e.lineSpacing&&e.lineSpacing>0&&(h=e.lineSpacing),e.styletags&&e.styletags.breaklines&&(j.breaklines=!!e.styletags.breaklines),e.styletags&&e.styletags.bolds&&(j.bolds=!!e.styletags.bolds),e.styletags&&e.styletags.italics&&(j.italics=!!e.styletags.italics),e.styletags&&e.styletags.subscripts&&(j.subscripts=!!e.styletags.subscripts),e.styletags&&e.styletags.superscripts&&(j.superscripts=!!e.styletags.superscripts)),c.font=[e.fontStyle,e.fontVariant,e.fontWeight,f+"px",e.font].filter(function(a){return a}).join(" "),c.textAlign="start",c.textBaseline="alphabetic",c.direction="ltr",g(function(a,b,c,e,f,g){function h(){if(""!==L){var a=b.measureText(L).width;b.fillText(L,G+A,H+B),A+=a}}function j(){return Math.round(C)+"px "}c=c.replace(/\n/g,""),c=!0===g.breaklines?c.replace(/\<br\>/g,"\n"):c.replace(/\<br\>/g," ");var k="",l=[];for(z=0;z<c.length;++z)l[z]=k;!0===g.bolds&&(l=d(n,o,c,l)),!0===g.italics&&(l=d(p,q,c,l)),!0===g.superscripts&&(l=d(r,t,c,l)),!0===g.subscripts&&(l=d(u,w,c,l));var m=[],x="";for(z=0;z<c.length;++z)null!==l[z]&&(x+=c[z],m.push(l[z]));var y,z,A,B,C,D=x.split("\n"),E=D.length,F=Math.round(f*e),G=e,H=2*e,I=0,J=E*F+H;a.height<J&&(a.height=J),b.fillStyle="#000",b.fillRect(0,0,a.width,a.height),b.fillStyle="#fff";var K=0,L="";for(y=0;y<E;++y){var M=D[y]+"\n";for(A=0,B=y*F,C=e,L="",z=0;z<M.length;++z){var N=z+K<m.length?m[z+K]:m[m.length-1];k===N?L+=M[z]:(h(),L=M[z],void 0!==N&&(function(a,c){var d=""+b.font;if(!0===g.subscripts){var e=a.indexOf(v),f=c.indexOf(v),h=e>-1?parseInt(a[1+e]):0,i=f>-1?parseInt(c[1+f]):0;h!==i&&(d=d.replace(j(),"?px "),C*=Math.pow(.75,i-h),d=d.replace("?px ",j())),B+=.25*F*(i-h)}if(!0===g.superscripts){var k=a.indexOf(s),l=c.indexOf(s),m=k>-1?parseInt(a[1+k]):0,n=l>-1?parseInt(c[1+l]):0;m!==n&&(d=d.replace(j(),"?px "),C*=Math.pow(.75,n-m),d=d.replace("?px ",j())),B-=.25*F*(n-m)}if(!0===g.bolds){var p=a.indexOf(o)>-1,r=c.indexOf(o)>-1;!p&&r&&(d=t?d.replace("italic ","italic bold "):"bold "+d),p&&!r&&(d=d.replace("bold ",""))}if(!0===g.italics){var t=a.indexOf(q)>-1,u=c.indexOf(q)>-1;!t&&u&&(d="italic "+d),t&&!u&&(d=d.replace("italic ",""))}b.font=d}(k,N),k=N))}h(),K+=M.length;var O=0|Math.round(A+2*G);I<O&&(I=O)}var P=I,Q=H+F*E;return i(b.getImageData(0,0,P,Q).data,[Q,P,4]).pick(-1,-1,0).transpose(1,0)}(b,c,a,f,h,j),e,f)},b.exports.processPixels=g;var h=a("surface-nets"),i=a("ndarray"),j=a("simplify-planar-graph"),k=a("clean-pslg"),l=a("cdt2d"),m=a("planar-graph-to-polyline"),n="b",o="b|",p="i",q="i|",r="sup",s="+",t="+1",u="sub",v="-",w="-1"},{cdt2d:107,"clean-pslg":117,ndarray:451,"planar-graph-to-polyline":469,"simplify-planar-graph":525,"surface-nets":532}],553:[function(a,b,c){!function(){"use strict";function a(b){b.permitHostObjects___&&b.permitHostObjects___(a)}function c(a){return!(a.substr(0,n.length)==n&&"___"===a.substr(a.length-3))}function d(a){if(a!==Object(a))throw new TypeError("Not an object: "+a);var b=a[o];if(b&&b.key===a)return b;if(m(a)){b={key:a};try{return l(a,o,{value:b,writable:!1,enumerable:!1,configurable:!1}),b}catch(a){return}}}function e(a){return a.prototype=null,Object.freeze(a)}function f(){s||"undefined"==typeof console||(s=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=a);var g=!1;if("function"==typeof WeakMap){var h=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var i=new h,j=Object.freeze({});if(i.set(j,1),1===i.get(j))return void(b.exports=WeakMap);g=!0}}Object.prototype.hasOwnProperty;var k=Object.getOwnPropertyNames,l=Object.defineProperty,m=Object.isExtensible,n="weakmap:",o=n+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var p=new ArrayBuffer(25),q=new Uint8Array(p);crypto.getRandomValues(q),o=n+"rand:"+Array.prototype.map.call(q,function(a){return(a%36).toString(36)}).join("")+"___"}if(l(Object,"getOwnPropertyNames",{value:function(a){return k(a).filter(c)}}),"getPropertyNames"in Object){var r=Object.getPropertyNames;l(Object,"getPropertyNames",{value:function(a){return r(a).filter(c)}})}!function(){var a=Object.freeze;l(Object,"freeze",{value:function(b){return d(b),a(b)}});var b=Object.seal;l(Object,"seal",{value:function(a){return d(a),b(a)}});var c=Object.preventExtensions;l(Object,"preventExtensions",{value:function(a){return d(a),c(a)}})}();var s=!1,t=0,u=function(){this instanceof u||f();var a=[],b=[],c=t++;return Object.create(u.prototype,{get___:{value:e(function(e,f){var g,h=d(e);return h?c in h?h[c]:f:(g=a.indexOf(e))>=0?b[g]:f})},has___:{value:e(function(b){var e=d(b);return e?c in e:a.indexOf(b)>=0})},set___:{value:e(function(e,f){var g,h=d(e);return h?h[c]=f:(g=a.indexOf(e))>=0?b[g]=f:(g=a.length,b[g]=f,a[g]=e),this})},delete___:{value:e(function(e){var f,g,h=d(e);return h?c in h&&delete h[c]:!((f=a.indexOf(e))<0||(g=a.length-1,a[f]=void 0,b[f]=b[g],a[f]=a[g],a.length=g,b.length=g,0))})}})};u.prototype=Object.create(Object.prototype,{get:{value:function(a,b){return this.get___(a,b)},writable:!0,configurable:!0},has:{value:function(a){return this.has___(a)},writable:!0,configurable:!0},set:{value:function(a,b){return this.set___(a,b)},writable:!0,configurable:!0},delete:{value:function(a){return this.delete___(a)},writable:!0,configurable:!0}}),"function"==typeof h?function(){function c(){this instanceof u||f();var b,c=new h,d=void 0,i=!1;return b=g?function(a,b){return c.set(a,b),c.has(a)||(d||(d=new u),d.set(a,b)),this}:function(a,b){if(i)try{c.set(a,b)}catch(c){d||(d=new u),d.set___(a,b)}else c.set(a,b);return this},Object.create(u.prototype,{get___:{value:e(function(a,b){return d?c.has(a)?c.get(a):d.get___(a,b):c.get(a,b)})},has___:{value:e(function(a){return c.has(a)||!!d&&d.has___(a)})},set___:{value:e(b)},delete___:{value:e(function(a){var b=!!c.delete(a);return d&&d.delete___(a)||b})},permitHostObjects___:{value:e(function(b){if(b!==a)throw new Error("bogus call to permitHostObjects___");i=!0})}})}g&&"undefined"!=typeof Proxy&&(Proxy=void 0),c.prototype=u.prototype,b.exports=c,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),b.exports=u)}}()},{}],554:[function(a,b,c){var d=a("./hidden-store.js");b.exports=function(){var a={};return function(b){if(("object"!=typeof b||null===b)&&"function"!=typeof b)throw new Error("Weakmap-shim: Key must be object");var c=b.valueOf(a);return c&&c.identity===a?c:d(b,a)}}},{"./hidden-store.js":555}],555:[function(a,b,c){b.exports=function(a,b){var c={identity:b},d=a.valueOf;return Object.defineProperty(a,"valueOf",{value:function(a){return a!==b?d.apply(this,arguments):c},writable:!0}),c}},{}],556:[function(a,b,c){var d=a("./create-store.js");b.exports=function(){var a=d();return{get:function(b,c){var d=a(b);return d.hasOwnProperty("value")?d.value:c},set:function(b,c){return a(b).value=c,this},has:function(b){return"value"in a(b)},delete:function(b){return delete a(b).value}}}},{"./create-store.js":554}],557:[function(a,b,c){var d=a("get-canvas-context");b.exports=function(a){return d("webgl",a)}},{"get-canvas-context":233}],558:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}var e=a("../main"),f=a("object-assign"),g=e.instance();d.prototype=new e.baseCalendar,f(d.prototype,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(a,b){if("string"==typeof a){var c=a.match(i);return c?c[0]:""}var d=this._validateYear(a),e=a.month(),f=""+this.toChineseMonth(d,e);return b&&f.length<2&&(f="0"+f),this.isIntercalaryMonth(d,e)&&(f+="i"),f},monthNames:function(a){if("string"==typeof a){var b=a.match(j);return b?b[0]:""}var c=this._validateYear(a),d=a.month(),e=["","","","","","","","","","","",""][this.toChineseMonth(c,d)-1];return this.isIntercalaryMonth(c,d)&&(e=""+e),e},monthNamesShort:function(a){if("string"==typeof a){var b=a.match(k);return b?b[0]:""}var c=this._validateYear(a),d=a.month(),e=["","","","","","","","","","","",""][this.toChineseMonth(c,d)-1];return this.isIntercalaryMonth(c,d)&&(e=""+e),e},parseMonth:function(a,b){a=this._validateYear(a);var c,d=parseInt(b);if(isNaN(d))""===b[0]&&(c=!0,b=b.substring(1)),""===b[b.length-1]&&(b=b.substring(0,b.length-1)),d=1+["","","","","","","","","","","",""].indexOf(b);else{var e=b[b.length-1];c="i"===e||"I"===e}return this.toMonthIndex(a,d,c)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(a,b){if(a.year&&(a=a.year()),"number"!=typeof a||a<1888||a>2111)throw b.replace(/\{0\}/,this.local.name);return a},toMonthIndex:function(a,b,c){var d=this.intercalaryMonth(a);if(c&&b!==d||b<1||b>12)throw e.local.invalidMonth.replace(/\{0\}/,this.local.name);return d?!c&&b<=d?b-1:b:b-1},toChineseMonth:function(a,b){a.year&&(b=(a=a.year()).month());var c=this.intercalaryMonth(a);if(b<0||b>(c?12:11))throw e.local.invalidMonth.replace(/\{0\}/,this.local.name);return c?b<c?b+1:b:b+1},intercalaryMonth:function(a){return a=this._validateYear(a),l[a-l[0]]>>13},isIntercalaryMonth:function(a,b){a.year&&(b=(a=a.year()).month());var c=this.intercalaryMonth(a);return!!c&&c===b},leapYear:function(a){return 0!==this.intercalaryMonth(a)},weekOfYear:function(a,b,c){var d,f=this._validateYear(a,e.local.invalidyear),h=m[f-m[0]],i=h>>9&4095,j=h>>5&15,k=31&h;(d=g.newDate(i,j,k)).add(4-(d.dayOfWeek()||7),"d");var l=this.toJD(a,b,c)-d.toJD();return 1+Math.floor(l/7)},monthsInYear:function(a){return this.leapYear(a)?13:12},daysInMonth:function(a,b){a.year&&(b=a.month(),a=a.year()),a=this._validateYear(a);var c=l[a-l[0]];if(b>(c>>13?12:11))throw e.local.invalidMonth.replace(/\{0\}/,this.local.name);return c&1<<12-b?30:29},weekDay:function(a,b,c){return(this.dayOfWeek(a,b,c)||7)<6},toJD:function(a,b,c){var d=this._validate(a,h,c,e.local.invalidDate);a=this._validateYear(d.year()),b=d.month(),c=d.day();var f=this.isIntercalaryMonth(a,b),h=this.toChineseMonth(a,b),i=function(a,b,c,d,e){var f,g,h;if("object"==typeof a)g=a,f=b||{};else{if(!("number"==typeof a&&a>=1888&&a<=2111))throw new Error("Lunar year outside range 1888-2111");if(!("number"==typeof b&&b>=1&&b<=12))throw new Error("Lunar month outside range 1 - 12");var i;if(!("number"==typeof c&&c>=1&&c<=30))throw new Error("Lunar day outside range 1 - 30");"object"==typeof d?(i=!1,f=d):(i=!!d,f={}),g={year:a,month:b,day:c,isIntercalary:i}}h=g.day-1;var j,k=l[g.year-l[0]],n=k>>13;j=n?g.month>n?g.month:g.isIntercalary?g.month:g.month-1:g.month-1;for(var o=0;o<j;o++){h+=k&1<<12-o?30:29}var p=m[g.year-m[0]],q=new Date(p>>9&4095,(p>>5&15)-1,(31&p)+h);return f.year=q.getFullYear(),f.month=1+q.getMonth(),f.day=q.getDate(),f}(a,h,c,f);return g.toJD(i.year,i.month,i.day)},fromJD:function(a){var b=g.fromJD(a),c=function(a,b,c,d){var e,f;if("object"==typeof a)e=a,f=b||{};else{if(!("number"==typeof a&&a>=1888&&a<=2111))throw new Error("Solar year outside range 1888-2111");if(!("number"==typeof b&&b>=1&&b<=12))throw new Error("Solar month outside range 1 - 12");if(!("number"==typeof c&&c>=1&&c<=31))throw new Error("Solar day outside range 1 - 31");e={year:a,month:b,day:c},f={}}var g=m[e.year-m[0]],h=e.year<<9|e.month<<5|e.day;f.year=h>=g?e.year:e.year-1,g=m[f.year-m[0]];var i,j=new Date(g>>9&4095,(g>>5&15)-1,31&g),k=new Date(e.year,e.month-1,e.day);i=Math.round((k-j)/864e5);var n,o=l[f.year-l[0]];for(n=0;n<13;n++){var p=o&1<<12-n?30:29;if(i<p)break;i-=p}var q=o>>13;return!q||n<q?(f.isIntercalary=!1,f.month=1+n):n===q?(f.isIntercalary=!0,f.month=n):(f.isIntercalary=!1,f.month=n),f.day=1+i,f}(b.year(),b.month(),b.day()),d=this.toMonthIndex(c.year,c.month,c.isIntercalary);return this.newDate(c.year,d,c.day)},fromString:function(a){var b=a.match(h),c=this._validateYear(+b[1]),d=+b[2],e=!!b[3],f=this.toMonthIndex(c,d,e),g=+b[4];return this.newDate(c,f,g)},add:function(a,b,c){var e=a.year(),f=a.month(),g=this.isIntercalaryMonth(e,f),h=this.toChineseMonth(e,f),i=Object.getPrototypeOf(d.prototype).add.call(this,a,b,c);if("y"===c){var j=i.year(),k=i.month(),l=this.isIntercalaryMonth(j,h),m=g&&l?this.toMonthIndex(j,h,!0):this.toMonthIndex(j,h,!1);m!==k&&i.month(m)}return i}});var h=/^\s*(-?\d\d\d\d|\d\d)[-\/](\d?\d)([iI]?)[-\/](\d?\d)/m,i=/^\d?\d[iI]?/m,j=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,k=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;e.calendars.chinese=d;var l=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],m=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":572,"object-assign":455}],559:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}var e=a("../main"),f=a("object-assign");d.prototype=new e.baseCalendar,f(d.prototype,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,e.local.invalidYear);return(a=b.year()+(b.year()<0?1:0))%4==3||a%4==-1},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,e.local.invalidYear||e.regionalOptions[""].invalidYear),13},weekOfYear:function(a,b,c){var d=this.newDate(a,b,c);return d.add(-d.dayOfWeek(),"d"),Math.floor((d.dayOfYear()-1)/7)+1},daysInMonth:function(a,b){var c=this._validate(a,b,this.minDay,e.local.invalidMonth);return this.daysPerMonth[c.month()-1]+(13===c.month()&&this.leapYear(c.year())?1:0)},weekDay:function(a,b,c){return(this.dayOfWeek(a,b,c)||7)<6},toJD:function(a,b,c){var d=this._validate(a,b,c,e.local.invalidDate);return(a=d.year())<0&&a++,d.day()+30*(d.month()-1)+365*(a-1)+Math.floor(a/4)+this.jdEpoch-1},fromJD:function(a){var b=Math.floor(a)+.5-this.jdEpoch,c=Math.floor((b-Math.floor((b+366)/1461))/365)+1;c<=0&&c--,b=Math.floor(a)+.5-this.newDate(c,1,1).toJD();var d=Math.floor(b/30)+1,e=b-30*(d-1)+1;return this.newDate(c,d,e)}}),e.calendars.coptic=d},{"../main":572,"object-assign":455}],560:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}var e=a("../main"),f=a("object-assign");d.prototype=new e.baseCalendar,f(d.prototype,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(a){return this._validate(a,this.minMonth,this.minDay,e.local.invalidYear),!1},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,e.local.invalidYear),13},daysInYear:function(a){return this._validate(a,this.minMonth,this.minDay,e.local.invalidYear),400},weekOfYear:function(a,b,c){var d=this.newDate(a,b,c);return d.add(-d.dayOfWeek(),"d"),Math.floor((d.dayOfYear()-1)/8)+1},daysInMonth:function(a,b){var c=this._validate(a,b,this.minDay,e.local.invalidMonth);return this.daysPerMonth[c.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(a,b,c){return(this._validate(a,b,c,e.local.invalidDate).day()+1)%8},weekDay:function(a,b,c){var d=this.dayOfWeek(a,b,c);return d>=2&&d<=6},extraInfo:function(a,b,c){var d=this._validate(a,b,c,e.local.invalidDate);return{century:g[Math.floor((d.year()-1)/100)+1]||""}},toJD:function(a,b,c){var d=this._validate(a,b,c,e.local.invalidDate);return a=d.year()+(d.year()<0?1:0),b=d.month(),(c=d.day())+(b>1?16:0)+(b>2?32*(b-2):0)+400*(a-1)+this.jdEpoch-1},fromJD:function(a){a=Math.floor(a+.5)-Math.floor(this.jdEpoch)-1;var b=Math.floor(a/400)+1;a-=400*(b-1),a+=a>15?16:0;var c=Math.floor(a/32)+1,d=a-32*(c-1)+1;return this.newDate(b<=0?b-1:b,c,d)}});var g={20:"Fruitbat",21:"Anchovy"};e.calendars.discworld=d},{"../main":572,"object-assign":455}],561:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}var e=a("../main"),f=a("object-assign");d.prototype=new e.baseCalendar,f(d.prototype,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,e.local.invalidYear);return(a=b.year()+(b.year()<0?1:0))%4==3||a%4==-1},monthsInYear:function(a){
return this._validate(a,this.minMonth,this.minDay,e.local.invalidYear||e.regionalOptions[""].invalidYear),13},weekOfYear:function(a,b,c){var d=this.newDate(a,b,c);return d.add(-d.dayOfWeek(),"d"),Math.floor((d.dayOfYear()-1)/7)+1},daysInMonth:function(a,b){var c=this._validate(a,b,this.minDay,e.local.invalidMonth);return this.daysPerMonth[c.month()-1]+(13===c.month()&&this.leapYear(c.year())?1:0)},weekDay:function(a,b,c){return(this.dayOfWeek(a,b,c)||7)<6},toJD:function(a,b,c){var d=this._validate(a,b,c,e.local.invalidDate);return(a=d.year())<0&&a++,d.day()+30*(d.month()-1)+365*(a-1)+Math.floor(a/4)+this.jdEpoch-1},fromJD:function(a){var b=Math.floor(a)+.5-this.jdEpoch,c=Math.floor((b-Math.floor((b+366)/1461))/365)+1;c<=0&&c--,b=Math.floor(a)+.5-this.newDate(c,1,1).toJD();var d=Math.floor(b/30)+1,e=b-30*(d-1)+1;return this.newDate(c,d,e)}}),e.calendars.ethiopian=d},{"../main":572,"object-assign":455}],562:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}function e(a,b){return a-b*Math.floor(a/b)}var f=a("../main"),g=a("object-assign");d.prototype=new f.baseCalendar,g(d.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,f.local.invalidYear);return this._leapYear(b.year())},_leapYear:function(a){return e(7*(a=a<0?a+1:a)+1,19)<7},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,f.local.invalidYear),this._leapYear(a.year?a.year():a)?13:12},weekOfYear:function(a,b,c){var d=this.newDate(a,b,c);return d.add(-d.dayOfWeek(),"d"),Math.floor((d.dayOfYear()-1)/7)+1},daysInYear:function(a){return a=this._validate(a,this.minMonth,this.minDay,f.local.invalidYear).year(),this.toJD(-1===a?1:a+1,7,1)-this.toJD(a,7,1)},daysInMonth:function(a,b){return a.year&&(b=a.month(),a=a.year()),this._validate(a,b,this.minDay,f.local.invalidMonth),12===b&&this.leapYear(a)?30:8===b&&5===e(this.daysInYear(a),10)?30:9===b&&3===e(this.daysInYear(a),10)?29:this.daysPerMonth[b-1]},weekDay:function(a,b,c){return 6!==this.dayOfWeek(a,b,c)},extraInfo:function(a,b,c){var d=this._validate(a,b,c,f.local.invalidDate);return{yearType:(this.leapYear(d)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(d)%10-3]}},toJD:function(a,b,c){var d=this._validate(a,b,c,f.local.invalidDate);a=d.year(),b=d.month(),c=d.day();var e=a<=0?a+1:a,g=this.jdEpoch+this._delay1(e)+this._delay2(e)+c+1;if(b<7){for(var h=7;h<=this.monthsInYear(a);h++)g+=this.daysInMonth(a,h);for(h=1;h<b;h++)g+=this.daysInMonth(a,h)}else for(h=7;h<b;h++)g+=this.daysInMonth(a,h);return g},_delay1:function(a){var b=Math.floor((235*a-234)/19),c=12084+13753*b,d=29*b+Math.floor(c/25920);return e(3*(d+1),7)<3&&d++,d},_delay2:function(a){var b=this._delay1(a-1),c=this._delay1(a);return this._delay1(a+1)-c==356?2:c-b==382?1:0},fromJD:function(a){a=Math.floor(a)+.5;for(var b=Math.floor(98496*(a-this.jdEpoch)/35975351)-1;a>=this.toJD(-1===b?1:b+1,7,1);)b++;for(var c=a<this.toJD(b,1,1)?7:1;a>this.toJD(b,c,this.daysInMonth(b,c));)c++;var d=a-this.toJD(b,c,1)+1;return this.newDate(b,c,d)}}),f.calendars.hebrew=d},{"../main":572,"object-assign":455}],563:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}var e=a("../main"),f=a("object-assign");d.prototype=new e.baseCalendar,f(d.prototype,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-khams","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(a){return(11*this._validate(a,this.minMonth,this.minDay,e.local.invalidYear).year()+14)%30<11},weekOfYear:function(a,b,c){var d=this.newDate(a,b,c);return d.add(-d.dayOfWeek(),"d"),Math.floor((d.dayOfYear()-1)/7)+1},daysInYear:function(a){return this.leapYear(a)?355:354},daysInMonth:function(a,b){var c=this._validate(a,b,this.minDay,e.local.invalidMonth);return this.daysPerMonth[c.month()-1]+(12===c.month()&&this.leapYear(c.year())?1:0)},weekDay:function(a,b,c){return 5!==this.dayOfWeek(a,b,c)},toJD:function(a,b,c){var d=this._validate(a,b,c,e.local.invalidDate);return a=d.year(),b=d.month(),a=a<=0?a+1:a,(c=d.day())+Math.ceil(29.5*(b-1))+354*(a-1)+Math.floor((3+11*a)/30)+this.jdEpoch-1},fromJD:function(a){a=Math.floor(a)+.5;var b=Math.floor((30*(a-this.jdEpoch)+10646)/10631);b=b<=0?b-1:b;var c=Math.min(12,Math.ceil((a-29-this.toJD(b,1,1))/29.5)+1),d=a-this.toJD(b,c,1)+1;return this.newDate(b,c,d)}}),e.calendars.islamic=d},{"../main":572,"object-assign":455}],564:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}var e=a("../main"),f=a("object-assign");d.prototype=new e.baseCalendar,f(d.prototype,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,e.local.invalidYear);return(a=b.year()<0?b.year()+1:b.year())%4==0},weekOfYear:function(a,b,c){var d=this.newDate(a,b,c);return d.add(4-(d.dayOfWeek()||7),"d"),Math.floor((d.dayOfYear()-1)/7)+1},daysInMonth:function(a,b){var c=this._validate(a,b,this.minDay,e.local.invalidMonth);return this.daysPerMonth[c.month()-1]+(2===c.month()&&this.leapYear(c.year())?1:0)},weekDay:function(a,b,c){return(this.dayOfWeek(a,b,c)||7)<6},toJD:function(a,b,c){var d=this._validate(a,b,c,e.local.invalidDate);return a=d.year(),b=d.month(),c=d.day(),a<0&&a++,b<=2&&(a--,b+=12),Math.floor(365.25*(a+4716))+Math.floor(30.6001*(b+1))+c-1524.5},fromJD:function(a){var b=Math.floor(a+.5)+1524,c=Math.floor((b-122.1)/365.25),d=Math.floor(365.25*c),e=Math.floor((b-d)/30.6001),f=e-Math.floor(e<14?1:13),g=c-Math.floor(f>2?4716:4715),h=b-d-Math.floor(30.6001*e);return g<=0&&g--,this.newDate(g,f,h)}}),e.calendars.julian=d},{"../main":572,"object-assign":455}],565:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}function e(a,b){return a-b*Math.floor(a/b)}function f(a,b){return e(a-1,b)+1}var g=a("../main"),h=a("object-assign");d.prototype=new g.baseCalendar,h(d.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(a){return this._validate(a,this.minMonth,this.minDay,g.local.invalidYear),!1},formatYear:function(a){a=this._validate(a,this.minMonth,this.minDay,g.local.invalidYear).year();var b=Math.floor(a/400);return a%=400,a+=a<0?400:0,b+"."+Math.floor(a/20)+"."+a%20},forYear:function(a){if((a=a.split(".")).length<3)throw"Invalid Mayan year";for(var b=0,c=0;c<a.length;c++){var d=parseInt(a[c],10);if(Math.abs(d)>19||c>0&&d<0)throw"Invalid Mayan year";b=20*b+d}return b},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,g.local.invalidYear),18},weekOfYear:function(a,b,c){return this._validate(a,b,c,g.local.invalidDate),0},daysInYear:function(a){return this._validate(a,this.minMonth,this.minDay,g.local.invalidYear),360},daysInMonth:function(a,b){return this._validate(a,b,this.minDay,g.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(a,b,c){return this._validate(a,b,c,g.local.invalidDate).day()},weekDay:function(a,b,c){return this._validate(a,b,c,g.local.invalidDate),!0},extraInfo:function(a,b,c){var d=this._validate(a,b,c,g.local.invalidDate).toJD(),e=this._toHaab(d),f=this._toTzolkin(d);return{haabMonthName:this.local.haabMonths[e[0]-1],haabMonth:e[0],haabDay:e[1],tzolkinDayName:this.local.tzolkinMonths[f[0]-1],tzolkinDay:f[0],tzolkinTrecena:f[1]}},_toHaab:function(a){var b=e(8+(a-=this.jdEpoch)+340,365);return[Math.floor(b/20)+1,e(b,20)]},_toTzolkin:function(a){return[f(20+(a-=this.jdEpoch),20),f(a+4,13)]},toJD:function(a,b,c){var d=this._validate(a,b,c,g.local.invalidDate);return d.day()+20*d.month()+360*d.year()+this.jdEpoch},fromJD:function(a){a=Math.floor(a)+.5-this.jdEpoch;var b=Math.floor(a/360);a%=360,a+=a<0?360:0;var c=Math.floor(a/20),d=a%20;return this.newDate(b,c,d)}}),g.calendars.mayan=d},{"../main":572,"object-assign":455}],566:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}var e=a("../main"),f=a("object-assign");d.prototype=new e.baseCalendar;var g=e.instance("gregorian");f(d.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,e.local.invalidYear||e.regionalOptions[""].invalidYear);return g.leapYear(b.year()+(b.year()<1?1:0)+1469)},weekOfYear:function(a,b,c){var d=this.newDate(a,b,c);return d.add(1-(d.dayOfWeek()||7),"d"),Math.floor((d.dayOfYear()-1)/7)+1},daysInMonth:function(a,b){var c=this._validate(a,b,this.minDay,e.local.invalidMonth);return this.daysPerMonth[c.month()-1]+(12===c.month()&&this.leapYear(c.year())?1:0)},weekDay:function(a,b,c){return(this.dayOfWeek(a,b,c)||7)<6},toJD:function(a,b,c){var d=this._validate(a,b,c,e.local.invalidMonth);(a=d.year())<0&&a++;for(var f=d.day(),h=1;h<d.month();h++)f+=this.daysPerMonth[h-1];return f+g.toJD(a+1468,3,13)},fromJD:function(a){a=Math.floor(a+.5);for(var b=Math.floor((a-(this.jdEpoch-1))/366);a>=this.toJD(b+1,1,1);)b++;for(var c=a-Math.floor(this.toJD(b,1,1)+.5)+1,d=1;c>this.daysInMonth(b,d);)c-=this.daysInMonth(b,d),d++;return this.newDate(b,d,c)}}),e.calendars.nanakshahi=d},{"../main":572,"object-assign":455}],567:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}var e=a("../main"),f=a("object-assign");d.prototype=new e.baseCalendar,f(d.prototype,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(a){return this.daysInYear(a)!==this.daysPerYear},weekOfYear:function(a,b,c){var d=this.newDate(a,b,c);return d.add(-d.dayOfWeek(),"d"),Math.floor((d.dayOfYear()-1)/7)+1},daysInYear:function(a){if(a=this._validate(a,this.minMonth,this.minDay,e.local.invalidYear).year(),void 0===this.NEPALI_CALENDAR_DATA[a])return this.daysPerYear;for(var b=0,c=this.minMonth;c<=12;c++)b+=this.NEPALI_CALENDAR_DATA[a][c];return b},daysInMonth:function(a,b){return a.year&&(b=a.month(),a=a.year()),this._validate(a,b,this.minDay,e.local.invalidMonth),void 0===this.NEPALI_CALENDAR_DATA[a]?this.daysPerMonth[b-1]:this.NEPALI_CALENDAR_DATA[a][b]},weekDay:function(a,b,c){return 6!==this.dayOfWeek(a,b,c)},toJD:function(a,b,c){var d=this._validate(a,b,c,e.local.invalidDate);a=d.year(),b=d.month(),c=d.day();var f=e.instance(),g=0,h=b,i=a;this._createMissingCalendarData(a);var j=a-(h>9||9===h&&c>=this.NEPALI_CALENDAR_DATA[i][0]?56:57);for(9!==b&&(g=c,h--);9!==h;)h<=0&&(h=12,i--),g+=this.NEPALI_CALENDAR_DATA[i][h],h--;return 9===b?(g+=c-this.NEPALI_CALENDAR_DATA[i][0])<0&&(g+=f.daysInYear(j)):g+=this.NEPALI_CALENDAR_DATA[i][9]-this.NEPALI_CALENDAR_DATA[i][0],f.newDate(j,1,1).add(g,"d").toJD()},fromJD:function(a){var b=e.instance().fromJD(a),c=b.year(),d=b.dayOfYear(),f=c+56;this._createMissingCalendarData(f);for(var g=9,h=this.NEPALI_CALENDAR_DATA[f][0],i=this.NEPALI_CALENDAR_DATA[f][g]-h+1;d>i;)++g>12&&(g=1,f++),i+=this.NEPALI_CALENDAR_DATA[f][g];var j=this.NEPALI_CALENDAR_DATA[f][g]-(i-d);return this.newDate(f,g,j)},_createMissingCalendarData:function(a){var b=this.daysPerMonth.slice(0);b.unshift(17);for(var c=a-1;c<a+2;c++)void 0===this.NEPALI_CALENDAR_DATA[c]&&(this.NEPALI_CALENDAR_DATA[c]=b)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),e.calendars.nepali=d},{"../main":572,"object-assign":455}],568:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}function e(a,b){return a-b*Math.floor(a/b)}var f=a("../main"),g=a("object-assign");d.prototype=new f.baseCalendar,g(d.prototype,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Chharshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,f.local.invalidYear);return 682*((b.year()-(b.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(a,b,c){var d=this.newDate(a,b,c);return d.add(-(d.dayOfWeek()+1)%7,"d"),Math.floor((d.dayOfYear()-1)/7)+1},daysInMonth:function(a,b){var c=this._validate(a,b,this.minDay,f.local.invalidMonth);return this.daysPerMonth[c.month()-1]+(12===c.month()&&this.leapYear(c.year())?1:0)},weekDay:function(a,b,c){return 5!==this.dayOfWeek(a,b,c)},toJD:function(a,b,c){var d=this._validate(a,b,c,f.local.invalidDate);a=d.year(),b=d.month(),c=d.day();var g=a-(a>=0?474:473),h=474+e(g,2820);return c+(b<=7?31*(b-1):30*(b-1)+6)+Math.floor((682*h-110)/2816)+365*(h-1)+1029983*Math.floor(g/2820)+this.jdEpoch-1},fromJD:function(a){var b=(a=Math.floor(a)+.5)-this.toJD(475,1,1),c=Math.floor(b/1029983),d=e(b,1029983),f=2820;if(1029982!==d){var g=Math.floor(d/366),h=e(d,366);f=Math.floor((2134*g+2816*h+2815)/1028522)+g+1}var i=f+2820*c+474;i=i<=0?i-1:i;var j=a-this.toJD(i,1,1)+1,k=j<=186?Math.ceil(j/31):Math.ceil((j-6)/30),l=a-this.toJD(i,k,1)+1;return this.newDate(i,k,l)}}),f.calendars.persian=d,f.calendars.jalali=d},{"../main":572,"object-assign":455}],569:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}var e=a("../main"),f=a("object-assign"),g=e.instance();d.prototype=new e.baseCalendar,f(d.prototype,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,e.local.invalidYear);return a=this._t2gYear(b.year()),g.leapYear(a)},weekOfYear:function(a,b,c){var d=this._validate(a,this.minMonth,this.minDay,e.local.invalidYear);return a=this._t2gYear(d.year()),g.weekOfYear(a,d.month(),d.day())},daysInMonth:function(a,b){var c=this._validate(a,b,this.minDay,e.local.invalidMonth);return this.daysPerMonth[c.month()-1]+(2===c.month()&&this.leapYear(c.year())?1:0)},weekDay:function(a,b,c){return(this.dayOfWeek(a,b,c)||7)<6},toJD:function(a,b,c){var d=this._validate(a,b,c,e.local.invalidDate);return a=this._t2gYear(d.year()),g.toJD(a,d.month(),d.day())},fromJD:function(a){var b=g.fromJD(a),c=this._g2tYear(b.year());return this.newDate(c,b.month(),b.day())},_t2gYear:function(a){return a+this.yearsOffset+(a>=-this.yearsOffset&&a<=-1?1:0)},_g2tYear:function(a){return a-this.yearsOffset-(a>=1&&a<=this.yearsOffset?1:0)}}),e.calendars.taiwan=d},{"../main":572,"object-assign":455}],570:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}var e=a("../main"),f=a("object-assign"),g=e.instance();d.prototype=new e.baseCalendar,f(d.prototype,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,e.local.invalidYear);return a=this._t2gYear(b.year()),g.leapYear(a)},weekOfYear:function(a,b,c){var d=this._validate(a,this.minMonth,this.minDay,e.local.invalidYear);return a=this._t2gYear(d.year()),g.weekOfYear(a,d.month(),d.day())},daysInMonth:function(a,b){var c=this._validate(a,b,this.minDay,e.local.invalidMonth);return this.daysPerMonth[c.month()-1]+(2===c.month()&&this.leapYear(c.year())?1:0)},weekDay:function(a,b,c){return(this.dayOfWeek(a,b,c)||7)<6},toJD:function(a,b,c){var d=this._validate(a,b,c,e.local.invalidDate);return a=this._t2gYear(d.year()),g.toJD(a,d.month(),d.day())},fromJD:function(a){var b=g.fromJD(a),c=this._g2tYear(b.year());return this.newDate(c,b.month(),b.day())},_t2gYear:function(a){return a-this.yearsOffset-(a>=1&&a<=this.yearsOffset?1:0)},_g2tYear:function(a){return a+this.yearsOffset+(a>=-this.yearsOffset&&a<=-1?1:0)}}),e.calendars.thai=d},{"../main":572,"object-assign":455}],571:[function(a,b,c){function d(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}var e=a("../main"),f=a("object-assign");d.prototype=new e.baseCalendar,f(d.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thalth","Yawm al-Arba","Yawm al-Khams","Yawm al-Juma","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,e.local.invalidYear);return 355===this.daysInYear(b.year())},weekOfYear:function(a,b,c){var d=this.newDate(a,b,c);return d.add(-d.dayOfWeek(),"d"),Math.floor((d.dayOfYear()-1)/7)+1},daysInYear:function(a){for(var b=0,c=1;c<=12;c++)b+=this.daysInMonth(a,c);return b},daysInMonth:function(a,b){for(var c=this._validate(a,b,this.minDay,e.local.invalidMonth).toJD()-24e5+.5,d=0,f=0;f<g.length;f++){if(g[f]>c)return g[d]-g[d-1];d++}return 30},weekDay:function(a,b,c){return 5!==this.dayOfWeek(a,b,c)},toJD:function(a,b,c){var d=this._validate(a,b,c,e.local.invalidDate),f=12*(d.year()-1)+d.month()-15292;return d.day()+g[f-1]-1+24e5-.5},fromJD:function(a){for(var b=a-24e5+.5,c=0,d=0;d<g.length&&!(g[d]>b);d++)c++;var e=c+15292,f=Math.floor((e-1)/12),h=f+1,i=e-12*f,j=b-g[c-1]+1;return this.newDate(h,i,j)},isValid:function(a,b,c){var d=e.baseCalendar.prototype.isValid.apply(this,arguments);return d&&(d=(a=null!=a.year?a.year:a)>=1276&&a<=1500),d},_validate:function(a,b,c,d){var f=e.baseCalendar.prototype._validate.apply(this,arguments);if(f.year<1276||f.year>1500)throw d.replace(/\{0\}/,this.local.name);return f}}),e.calendars.ummalqura=d
;var g=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":572,"object-assign":455}],572:[function(a,b,c){function d(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function e(a,b,c,d){if(this._calendar=a,this._year=b,this._month=c,this._day=d,0===this._calendar._validateLevel&&!this._calendar.isValid(this._year,this._month,this._day))throw(j.local.invalidDate||j.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function f(a,b){return"000000".substring(0,b-(a=""+a).length)+a}function g(){this.shortYearCutoff="+10"}function h(a){this.local=this.regionalOptions[a]||this.regionalOptions[""]}var i=a("object-assign");i(d.prototype,{instance:function(a,b){a=(a||"gregorian").toLowerCase(),b=b||"";var c=this._localCals[a+"-"+b];if(!c&&this.calendars[a]&&(c=new this.calendars[a](b),this._localCals[a+"-"+b]=c),!c)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,a);return c},newDate:function(a,b,c,d,e){return(d=(null!=a&&a.year?a.calendar():"string"==typeof d?this.instance(d,e):d)||this.instance()).newDate(a,b,c)},substituteDigits:function(a){return function(b){return(b+"").replace(/[0-9]/g,function(b){return a[b]})}},substituteChineseDigits:function(a,b){return function(c){for(var d="",e=0;c>0;){var f=c%10;d=(0===f?"":a[f]+b[e])+d,e++,c=Math.floor(c/10)}return 0===d.indexOf(a[1]+b[1])&&(d=d.substr(1)),d||a[0]}}}),i(e.prototype,{newDate:function(a,b,c){return this._calendar.newDate(null==a?this:a,b,c)},year:function(a){return 0===arguments.length?this._year:this.set(a,"y")},month:function(a){return 0===arguments.length?this._month:this.set(a,"m")},day:function(a){return 0===arguments.length?this._day:this.set(a,"d")},date:function(a,b,c){if(!this._calendar.isValid(a,b,c))throw(j.local.invalidDate||j.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=a,this._month=b,this._day=c,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(a,b){return this._calendar.add(this,a,b)},set:function(a,b){return this._calendar.set(this,a,b)},compareTo:function(a){if(this._calendar.name!==a._calendar.name)throw(j.local.differentCalendars||j.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,a._calendar.local.name);var b=this._year!==a._year?this._year-a._year:this._month!==a._month?this.monthOfYear()-a.monthOfYear():this._day-a._day;return 0===b?0:b<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(a){return this._calendar.fromJD(a)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(a){return this._calendar.fromJSDate(a)},toString:function(){return(this.year()<0?"-":"")+f(Math.abs(this.year()),4)+"-"+f(this.month(),2)+"-"+f(this.day(),2)}}),i(g.prototype,{_validateLevel:0,newDate:function(a,b,c){return null==a?this.today():(a.year&&(this._validate(a,b,c,j.local.invalidDate||j.regionalOptions[""].invalidDate),c=a.day(),b=a.month(),a=a.year()),new e(this,a,b,c))},today:function(){return this.fromJSDate(new Date)},epoch:function(a){return this._validate(a,this.minMonth,this.minDay,j.local.invalidYear||j.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,j.local.invalidYear||j.regionalOptions[""].invalidYear);return(b.year()<0?"-":"")+f(Math.abs(b.year()),4)},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,j.local.invalidYear||j.regionalOptions[""].invalidYear),12},monthOfYear:function(a,b){var c=this._validate(a,b,this.minDay,j.local.invalidMonth||j.regionalOptions[""].invalidMonth);return(c.month()+this.monthsInYear(c)-this.firstMonth)%this.monthsInYear(c)+this.minMonth},fromMonthOfYear:function(a,b){var c=(b+this.firstMonth-2*this.minMonth)%this.monthsInYear(a)+this.minMonth;return this._validate(a,c,this.minDay,j.local.invalidMonth||j.regionalOptions[""].invalidMonth),c},daysInYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,j.local.invalidYear||j.regionalOptions[""].invalidYear);return this.leapYear(b)?366:365},dayOfYear:function(a,b,c){var d=this._validate(a,b,c,j.local.invalidDate||j.regionalOptions[""].invalidDate);return d.toJD()-this.newDate(d.year(),this.fromMonthOfYear(d.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(a,b,c){var d=this._validate(a,b,c,j.local.invalidDate||j.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(d))+2)%this.daysInWeek()},extraInfo:function(a,b,c){return this._validate(a,b,c,j.local.invalidDate||j.regionalOptions[""].invalidDate),{}},add:function(a,b,c){return this._validate(a,this.minMonth,this.minDay,j.local.invalidDate||j.regionalOptions[""].invalidDate),this._correctAdd(a,this._add(a,b,c),b,c)},_add:function(a,b,c){if(this._validateLevel++,"d"===c||"w"===c){var d=a.toJD()+b*("w"===c?this.daysInWeek():1),e=a.calendar().fromJD(d);return this._validateLevel--,[e.year(),e.month(),e.day()]}try{var f=a.year()+("y"===c?b:0),g=a.monthOfYear()+("m"===c?b:0);e=a.day(),"y"===c?(a.month()!==this.fromMonthOfYear(f,g)&&(g=this.newDate(f,a.month(),this.minDay).monthOfYear()),g=Math.min(g,this.monthsInYear(f)),e=Math.min(e,this.daysInMonth(f,this.fromMonthOfYear(f,g)))):"m"===c&&(function(a){for(;g<a.minMonth;)f--,g+=a.monthsInYear(f);for(var b=a.monthsInYear(f);g>b-1+a.minMonth;)f++,g-=b,b=a.monthsInYear(f)}(this),e=Math.min(e,this.daysInMonth(f,this.fromMonthOfYear(f,g))));var h=[f,this.fromMonthOfYear(f,g),e];return this._validateLevel--,h}catch(a){throw this._validateLevel--,a}},_correctAdd:function(a,b,c,d){if(!(this.hasYearZero||"y"!==d&&"m"!==d||0!==b[0]&&a.year()>0==b[0]>0)){var e={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[d],f=c<0?-1:1;b=this._add(a,c*e[0]+f*e[1],e[2])}return a.date(b[0],b[1],b[2])},set:function(a,b,c){this._validate(a,this.minMonth,this.minDay,j.local.invalidDate||j.regionalOptions[""].invalidDate);var d="y"===c?b:a.year(),e="m"===c?b:a.month(),f="d"===c?b:a.day();return"y"!==c&&"m"!==c||(f=Math.min(f,this.daysInMonth(d,e))),a.date(d,e,f)},isValid:function(a,b,c){this._validateLevel++;var d=this.hasYearZero||0!==a;if(d){var e=this.newDate(a,b,this.minDay);d=b>=this.minMonth&&b-this.minMonth<this.monthsInYear(e)&&c>=this.minDay&&c-this.minDay<this.daysInMonth(e)}return this._validateLevel--,d},toJSDate:function(a,b,c){var d=this._validate(a,b,c,j.local.invalidDate||j.regionalOptions[""].invalidDate);return j.instance().fromJD(this.toJD(d)).toJSDate()},fromJSDate:function(a){return this.fromJD(j.instance().fromJSDate(a).toJD())},_validate:function(a,b,c,d){if(a.year){if(0===this._validateLevel&&this.name!==a.calendar().name)throw(j.local.differentCalendars||j.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,a.calendar().local.name);return a}try{if(1===++this._validateLevel&&!this.isValid(a,b,c))throw d.replace(/\{0\}/,this.local.name);var e=this.newDate(a,b,c);return this._validateLevel--,e}catch(a){throw this._validateLevel--,a}}}),h.prototype=new g,i(h.prototype,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,j.local.invalidYear||j.regionalOptions[""].invalidYear);return(a=b.year()+(b.year()<0?1:0))%4==0&&(a%100!=0||a%400==0)},weekOfYear:function(a,b,c){var d=this.newDate(a,b,c);return d.add(4-(d.dayOfWeek()||7),"d"),Math.floor((d.dayOfYear()-1)/7)+1},daysInMonth:function(a,b){var c=this._validate(a,b,this.minDay,j.local.invalidMonth||j.regionalOptions[""].invalidMonth);return this.daysPerMonth[c.month()-1]+(2===c.month()&&this.leapYear(c.year())?1:0)},weekDay:function(a,b,c){return(this.dayOfWeek(a,b,c)||7)<6},toJD:function(a,b,c){var d=this._validate(a,b,c,j.local.invalidDate||j.regionalOptions[""].invalidDate);a=d.year(),b=d.month(),c=d.day(),a<0&&a++,b<3&&(b+=12,a--);var e=Math.floor(a/100),f=2-e+Math.floor(e/4);return Math.floor(365.25*(a+4716))+Math.floor(30.6001*(b+1))+c+f-1524.5},fromJD:function(a){var b=Math.floor(a+.5),c=Math.floor((b-1867216.25)/36524.25),d=1524+(c=b+1+c-Math.floor(c/4)),e=Math.floor((d-122.1)/365.25),f=Math.floor(365.25*e),g=Math.floor((d-f)/30.6001),h=d-f-Math.floor(30.6001*g),i=g-(g>13.5?13:1),j=e-(i>2.5?4716:4715);return j<=0&&j--,this.newDate(j,i,h)},toJSDate:function(a,b,c){var d=this._validate(a,b,c,j.local.invalidDate||j.regionalOptions[""].invalidDate),e=new Date(d.year(),d.month()-1,d.day());return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.setHours(e.getHours()>12?e.getHours()+2:0),e},fromJSDate:function(a){return this.newDate(a.getFullYear(),a.getMonth()+1,a.getDate())}});var j=b.exports=new d;j.cdate=e,j.baseCalendar=g,j.calendars.gregorian=h},{"object-assign":455}],573:[function(a,b,c){var d=a("object-assign"),e=a("./main");d(e.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),e.local=e.regionalOptions[""],d(e.cdate.prototype,{formatDate:function(a,b){return"string"!=typeof a&&(b=a,a=""),this._calendar.formatDate(a||"",this,b)}}),d(e.baseCalendar.prototype,{UNIX_EPOCH:e.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:e.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(a,b,c){if("string"!=typeof a&&(c=b,b=a,a=""),!b)return"";if(b.calendar()!==this)throw e.local.invalidFormat||e.regionalOptions[""].invalidFormat;a=a||this.local.dateFormat;for(var d,f,g,h,i=(c=c||{}).dayNamesShort||this.local.dayNamesShort,j=c.dayNames||this.local.dayNames,k=c.monthNumbers||this.local.monthNumbers,l=c.monthNamesShort||this.local.monthNamesShort,m=c.monthNames||this.local.monthNames,n=(c.calculateWeek||this.local.calculateWeek,function(b,c){for(var d=1;u+d<a.length&&a.charAt(u+d)===b;)d++;return u+=d-1,Math.floor(d/(c||1))>1}),o=function(a,b,c,d){var e=""+b;if(n(a,d))for(;e.length<c;)e="0"+e;return e},p=this,q=this.local.digits,r=function(a){return c.localNumbers&&q?q(a):a},s="",t=!1,u=0;u<a.length;u++)if(t)"'"!==a.charAt(u)||n("'")?s+=a.charAt(u):t=!1;else switch(a.charAt(u)){case"d":s+=r(o("d",b.day(),2));break;case"D":s+=(d="D",f=b.dayOfWeek(),g=i,h=j,n(d)?h[f]:g[f]);break;case"o":s+=o("o",b.dayOfYear(),3);break;case"w":s+=o("w",b.weekOfYear(),2);break;case"m":s+=function(a){return"function"==typeof k?k.call(p,a,n("m")):r(o("m",a.month(),2))}(b);break;case"M":s+=function(a,b){return b?"function"==typeof m?m.call(p,a):m[a.month()-p.minMonth]:"function"==typeof l?l.call(p,a):l[a.month()-p.minMonth]}(b,n("M"));break;case"y":s+=n("y",2)?b.year():(b.year()%100<10?"0":"")+b.year()%100;break;case"Y":n("Y",2),s+=b.formatYear();break;case"J":s+=b.toJD();break;case"@":s+=(b.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":s+=(b.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":n("'")?s+="'":t=!0;break;default:s+=a.charAt(u)}return s},parseDate:function(a,b,c){if(null==b)throw e.local.invalidArguments||e.regionalOptions[""].invalidArguments;if(""===(b="object"==typeof b?b.toString():b+""))return null;a=a||this.local.dateFormat;var d=(c=c||{}).shortYearCutoff||this.shortYearCutoff;d="string"!=typeof d?d:this.today().year()%100+parseInt(d,10);for(var f=c.dayNamesShort||this.local.dayNamesShort,g=c.dayNames||this.local.dayNames,h=c.parseMonth||this.local.parseMonth,i=c.monthNumbers||this.local.monthNumbers,j=c.monthNamesShort||this.local.monthNamesShort,k=c.monthNames||this.local.monthNames,l=-1,m=-1,n=-1,o=-1,p=-1,q=!1,r=!1,s=function(b,c){for(var d=1;y+d<a.length&&a.charAt(y+d)===b;)d++;return y+=d-1,Math.floor(d/(c||1))>1},t=function(a,c){var d=s(a,c),f=[2,3,d?4:2,d?4:2,10,11,20]["oyYJ@!".indexOf(a)+1],g=new RegExp("^-?\\d{1,"+f+"}"),h=b.substring(x).match(g);if(!h)throw(e.local.missingNumberAt||e.regionalOptions[""].missingNumberAt).replace(/\{0\}/,x);return x+=h[0].length,parseInt(h[0],10)},u=this,v=function(a,c,d,f){for(var g=s(a,f)?d:c,h=0;h<g.length;h++)if(b.substr(x,g[h].length).toLowerCase()===g[h].toLowerCase())return x+=g[h].length,h+u.minMonth;throw(e.local.unknownNameAt||e.regionalOptions[""].unknownNameAt).replace(/\{0\}/,x)},w=function(){if(b.charAt(x)!==a.charAt(y))throw(e.local.unexpectedLiteralAt||e.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,x);x++},x=0,y=0;y<a.length;y++)if(r)"'"!==a.charAt(y)||s("'")?w():r=!1;else switch(a.charAt(y)){case"d":o=t("d");break;case"D":v("D",f,g);break;case"o":p=t("o");break;case"w":t("w");break;case"m":n=function(){if("function"==typeof i){s("m");var a=i.call(u,b.substring(x));return x+=a.length,a}return t("m")}();break;case"M":n=function(){if("function"==typeof k){var a=s("M")?k.call(u,b.substring(x)):j.call(u,b.substring(x));return x+=a.length,a}return v("M",j,k)}();break;case"y":var z=y;q=!s("y",2),y=z,m=t("y",2);break;case"Y":m=t("Y",2);break;case"J":l=t("J")+.5,"."===b.charAt(x)&&(x++,t("J"));break;case"@":l=t("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":l=t("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":x=b.length;break;case"'":s("'")?w():r=!0;break;default:w()}if(x<b.length)throw e.local.unexpectedText||e.regionalOptions[""].unexpectedText;if(-1===m?m=this.today().year():m<100&&q&&(m+=-1===d?1900:this.today().year()-this.today().year()%100-(m<=d?0:100)),"string"==typeof n&&(n=h.call(this,m,n)),p>-1){n=1,o=p;for(var A=this.daysInMonth(m,n);o>A;A=this.daysInMonth(m,n))n++,o-=A}return l>-1?this.fromJD(l):this.newDate(m,n,o)},determineDate:function(a,b,c,d,e){c&&"object"!=typeof c&&(e=d,d=c,c=null),"string"!=typeof d&&(e=d,d="");var f=this;return b=b?b.newDate():null,a=null==a?b:"string"==typeof a?function(a){try{return f.parseDate(d,a,e)}catch(a){}for(var b=((a=a.toLowerCase()).match(/^c/)&&c?c.newDate():null)||f.today(),g=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,h=g.exec(a);h;)b.add(parseInt(h[1],10),h[2]||"d"),h=g.exec(a);return b}(a):"number"==typeof a?isNaN(a)||a===1/0||a===-1/0?b:f.today().add(a,"d"):f.newDate(a)}})},{"./main":572,"object-assign":455}],574:[function(a,b,c){b.exports=a("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],
localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":147}],575:[function(a,b,c){"use strict";b.exports=function(a,b){var c=[];return b=+b||0,d(a.hi(a.shape[0]-1),c,b),c};var d=a("./lib/zc-core")},{"./lib/zc-core":574}],576:[function(a,b,c){"use strict";b.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],577:[function(a,b,c){"use strict";var d=a("./arrow_paths"),e=a("../../plots/font_attributes"),f=a("../../plots/cartesian/constants"),g=a("../../plot_api/plot_template").templatedArray;b.exports=g("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:e({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:d.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:d.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",f.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",f.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",f.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",f.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:e({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../plot_api/plot_template":757,"../../plots/cartesian/constants":773,"../../plots/font_attributes":793,"./arrow_paths":576}],578:[function(a,b,c){"use strict";function d(a){var b=a._fullLayout;f.filterVisible(b.annotations).forEach(function(b){var c=g.getFromId(a,b.xref),d=g.getFromId(a,b.yref);b._extremes={},c&&e(b,c),d&&e(b,d)})}function e(a,b){var c,d=b._id,e=d.charAt(0),f=a[e],h=a["a"+e],i=a[e+"ref"],j=a["a"+e+"ref"],k=a["_"+e+"padplus"],l=a["_"+e+"padminus"],m={x:1,y:-1}[e]*a[e+"shift"],n=3*a.arrowsize*a.arrowwidth||0,o=n+m,p=n-m,q=3*a.startarrowsize*a.arrowwidth||0,r=q+m,s=q-m;if(j===i){var t=g.findExtremes(b,[b.r2c(f)],{ppadplus:o,ppadminus:p}),u=g.findExtremes(b,[b.r2c(h)],{ppadplus:Math.max(k,r),ppadminus:Math.max(l,s)});c={min:[t.min[0],u.min[0]],max:[t.max[0],u.max[0]]}}else r=h?r+h:r,s=h?s-h:s,c=g.findExtremes(b,[b.r2c(f)],{ppadplus:Math.max(k,o,r),ppadminus:Math.max(l,p,s)});a._extremes[d]=c}var f=a("../../lib"),g=a("../../plots/cartesian/axes"),h=a("./draw").draw;b.exports=function(a){var b=a._fullLayout;if(f.filterVisible(b.annotations).length&&a._fullData.length)return f.syncOrAsync([h,d],a)}},{"../../lib":719,"../../plots/cartesian/axes":767,"./draw":583}],579:[function(a,b,c){"use strict";function d(a,b){var c,d,f,g,h,i,j,k=a._fullLayout.annotations,l=[],m=[],n=[],o=(b||[]).length;for(c=0;c<k.length;c++)if(g=(f=k[c]).clicktoshow){for(d=0;d<o;d++)if(i=(h=b[d]).xaxis,j=h.yaxis,i._id===f.xref&&j._id===f.yref&&i.d2r(h.x)===e(f._xclick,i)&&j.d2r(h.y)===e(f._yclick,j)){(f.visible?"onout"===g?m:n:l).push(c);break}d===o&&f.visible&&"onout"===g&&m.push(c)}return{on:l,off:m,explicitOff:n}}function e(a,b){return"log"===b.type?b.l2r(a):b.d2r(a)}var f=a("../../lib"),g=a("../../registry"),h=a("../../plot_api/plot_template").arrayEditor;b.exports={hasClickToShow:function(a,b){var c=d(a,b);return c.on.length>0||c.explicitOff.length>0},onClick:function(a,b){var c,e,i=d(a,b),j=i.on,k=i.off.concat(i.explicitOff),l={},m=a._fullLayout.annotations;if(j.length||k.length){for(c=0;c<j.length;c++)(e=h(a.layout,"annotations",m[j[c]])).modifyItem("visible",!0),f.extendFlat(l,e.getUpdateObj());for(c=0;c<k.length;c++)(e=h(a.layout,"annotations",m[k[c]])).modifyItem("visible",!1),f.extendFlat(l,e.getUpdateObj());return g.call("update",a,{},l)}}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../registry":848}],580:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../color");b.exports=function(a,b,c,f){f("opacity");var g=f("bgcolor"),h=f("bordercolor"),i=e.opacity(h);f("borderpad");var j=f("borderwidth"),k=f("showarrow");if(f("text",k?" ":c._dfltTitle.annotation),f("textangle"),d.coerceFont(f,"font",c.font),f("width"),f("align"),f("height")&&f("valign"),k){var l,m,n=f("arrowside");-1!==n.indexOf("end")&&(l=f("arrowhead"),m=f("arrowsize")),-1!==n.indexOf("start")&&(f("startarrowhead",l),f("startarrowsize",m)),f("arrowcolor",i?b.bordercolor:e.defaultLine),f("arrowwidth",2*(i&&j||1)),f("standoff"),f("startstandoff")}var o=f("hovertext"),p=c.hoverlabel||{};if(o){var q=f("hoverlabel.bgcolor",p.bgcolor||(e.opacity(g)?e.rgb(g):e.defaultLine)),r=f("hoverlabel.bordercolor",p.bordercolor||e.contrast(q));d.coerceFont(f,"hoverlabel.font",{family:p.font.family,size:p.font.size,color:p.font.color||r})}f("captureevents",!!o)}},{"../../lib":719,"../color":594}],581:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib/to_log_range");b.exports=function(a,b,c,f){function g(a){var c=j[a],g=null;g=h?e(c,b.range):Math.pow(10,c),d(g)||(g=null),f(k+a,g)}b=b||{};var h="log"===c&&"linear"===b.type,i="linear"===c&&"log"===b.type;if(h||i)for(var j,k,l=a._fullLayout.annotations,m=b._id.charAt(0),n=0;n<l.length;n++)j=l[n],k="annotations["+n+"].",j[m+"ref"]===b._id&&g(m),j["a"+m+"ref"]===b._id&&g("a"+m)}},{"../../lib/to_log_range":745,"fast-isnumeric":226}],582:[function(a,b,c){"use strict";function d(a,b,c){function d(c,d){return e.coerce(a,b,i,c,d)}var g=d("visible"),j=d("clicktoshow");if(g||j){h(a,b,c,d);for(var k=b.showarrow,l=["x","y"],m=[-10,-30],n={_fullLayout:c},o=0;o<2;o++){var p=l[o],q=f.coerceRef(a,b,n,p,"","paper");if("paper"!==q&&f.getFromId(n,q)._annIndices.push(b._index),f.coercePosition(b,n,d,q,p,.5),k){var r="a"+p,s=f.coerceRef(a,b,n,r,"pixel");"pixel"!==s&&s!==q&&(s=b[r]="pixel");var t="pixel"===s?m[o]:.4;f.coercePosition(b,n,d,s,r,t)}d(p+"anchor"),d(p+"shift")}if(e.noneOrAll(a,b,["x","y"]),k&&e.noneOrAll(a,b,["ax","ay"]),j){var u=d("xclick"),v=d("yclick");b._xclick=void 0===u?b.x:f.cleanPosition(u,n,b.xref),b._yclick=void 0===v?b.y:f.cleanPosition(v,n,b.yref)}}}var e=a("../../lib"),f=a("../../plots/cartesian/axes"),g=a("../../plots/array_container_defaults"),h=a("./common_defaults"),i=a("./attributes");b.exports=function(a,b){g(a,b,{name:"annotations",handleItemDefaults:d})}},{"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/cartesian/axes":767,"./attributes":577,"./common_defaults":580}],583:[function(a,b,c){"use strict";function d(a,b){var c=a._fullLayout.annotations[b]||{},d=j.getFromId(a,c.xref),f=j.getFromId(a,c.yref);d&&d.setScale(),f&&f.setScale(),e(a,c,b,!1,d,f)}function e(a,b,c,d,e,h){function j(a){var e={index:c,annotation:b._input,fullAnnotation:b,event:a};return d&&(e.subplotId=d),e}function s(c){return c.call(l.font,R).attr({"text-anchor":{left:"start",right:"end"}[b.align]||"middle"}),n.convertToTspans(c,a,t),c}function t(){function c(a,b){return"auto"===b&&(b=a<1/3?"left":a>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[b]}var f=T.selectAll("a");1===f.size()&&f.text()===T.text()&&K.insert("a",":first-child").attr({"xlink:xlink:href":f.attr("xlink:href"),"xlink:xlink:show":f.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(O.node());for(var m=K.select(".annotation-text-math-group"),q=!m.empty(),s=l.bBox((q?m:T).node()),t=s.width,u=s.height,v=b.width||t,z=b.height||u,J=Math.round(v+2*N),M=Math.round(z+2*N),R=!1,S=["x","y"],U=0;U<S.length;U++){var V,W,X,Y,Z,$=S[U],_=b[$+"ref"]||$,aa=b["a"+$+"ref"],ba={x:e,y:h}[$],ca=(F+("x"===$?0:-90))*Math.PI/180,da=J*Math.cos(ca),ea=M*Math.sin(ca),fa=Math.abs(da)+Math.abs(ea),ga=b[$+"anchor"],ha=b[$+"shift"]*("x"===$?1:-1),ia=E[$];if(ba){var ja=ba.r2fraction(b[$]);(ja<0||ja>1)&&(aa===_?((ja=ba.r2fraction(b["a"+$]))<0||ja>1)&&(R=!0):R=!0),V=ba._offset+ba.r2p(b[$]),Y=.5}else"x"===$?(X=b[$],V=x.l+x.w*X):(X=1-b[$],V=x.t+x.h*X),Y=b.showarrow?.5:X;if(b.showarrow){ia.head=V;var ka=b["a"+$];Z=da*c(.5,b.xanchor)-ea*c(.5,b.yanchor),aa===_?(ia.tail=ba._offset+ba.r2p(ka),W=Z):(ia.tail=V+ka,W=Z+ka),ia.text=ia.tail+Z;var la=w["x"===$?"width":"height"];if("paper"===_&&(ia.head=i.constrain(ia.head,1,la-1)),"pixel"===aa){var ma=-Math.max(ia.tail-3,ia.text),na=Math.min(ia.tail+3,ia.text)-la;ma>0?(ia.tail+=ma,ia.text+=ma):na>0&&(ia.tail-=na,ia.text-=na)}ia.tail+=ha,ia.head+=ha}else W=Z=fa*c(Y,ga),ia.text=V+Z;ia.text+=ha,Z+=ha,W+=ha,b["_"+$+"padplus"]=fa/2+W,b["_"+$+"padminus"]=fa/2-W,b["_"+$+"size"]=fa,b["_"+$+"shift"]=Z}if(R)K.remove();else{var oa=0,pa=0;if("left"!==b.align&&(oa=(v-t)*("center"===b.align?.5:1)),"top"!==b.valign&&(pa=(z-u)*("middle"===b.valign?.5:1)),q)m.select("svg").attr({x:N+oa-1,y:N+pa}).call(l.setClipUrl,P?D:null,a);else{var qa=N+pa-s.top,ra=N+oa-s.left;T.call(n.positionText,ra,qa).call(l.setClipUrl,P?D:null,a)}Q.select("rect").call(l.setRect,N,N,v,z),O.call(l.setRect,L/2,L/2,J-L,M-L),K.call(l.setTranslate,Math.round(E.x.text-J/2),Math.round(E.y.text-M/2)),H.attr({transform:"rotate("+F+","+E.x.text+","+E.y.text+")"});var sa,ta=function(c,f){G.selectAll(".annotation-arrow-g").remove();var j=E.x.head,m=E.y.head,n=E.x.tail+c,o=E.y.tail+f,q=E.x.text+c,s=E.y.text+f,t=i.rotationXYMatrix(F,q,s),u=i.apply2DTransform(t),v=i.apply2DTransform2(t),w=+O.attr("width"),z=+O.attr("height"),D=q-.5*w,I=D+w,J=s-.5*z,L=J+z,M=[[D,J,D,L],[D,L,I,L],[I,L,I,J],[I,J,D,J]].map(v);if(!M.reduce(function(a,b){return a^!!i.segmentsIntersect(j,m,j+1e6,m+1e6,b[0],b[1],b[2],b[3])},!1)){M.forEach(function(a){var b=i.segmentsIntersect(n,o,j,m,a[0],a[1],a[2],a[3]);b&&(n=b.x,o=b.y)});var N=b.arrowwidth,P=b.arrowcolor,Q=b.arrowside,R=G.append("g").style({opacity:k.opacity(P)}).classed("annotation-arrow-g",!0),S=R.append("path").attr("d","M"+n+","+o+"L"+j+","+m).style("stroke-width",N+"px").call(k.stroke,k.rgb(P));if(r(S,Q,b),y.annotationPosition&&S.node().parentNode&&!d){var T=j,U=m;if(b.standoff){var V=Math.sqrt(Math.pow(j-n,2)+Math.pow(m-o,2));T+=b.standoff*(n-j)/V,U+=b.standoff*(o-m)/V}var W,X,Y=R.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(n-T)+","+(o-U),transform:"translate("+T+","+U+")"}).style("stroke-width",N+6+"px").call(k.stroke,"rgba(0,0,0,0)").call(k.fill,"rgba(0,0,0,0)");p.init({element:Y.node(),gd:a,prepFn:function(){var a=l.getTranslate(K);W=a.x,X=a.y,e&&e.autorange&&A(e._name+".autorange",!0),h&&h.autorange&&A(h._name+".autorange",!0)},moveFn:function(a,c){var d=u(W,X),f=d[0]+a,g=d[1]+c;K.call(l.setTranslate,f,g),B("x",e?e.p2r(e.r2p(b.x)+a):b.x+a/x.w),B("y",h?h.p2r(h.r2p(b.y)+c):b.y-c/x.h),b.axref===b.xref&&B("ax",e.p2r(e.r2p(b.ax)+a)),b.ayref===b.yref&&B("ay",h.p2r(h.r2p(b.ay)+c)),R.attr("transform","translate("+a+","+c+")"),H.attr({transform:"rotate("+F+","+f+","+g+")"})},doneFn:function(){g.call("_guiRelayout",a,C());var b=document.querySelector(".js-notes-box-panel");b&&b.redraw(b.selectedObj)}})}}};b.showarrow&&ta(0,0),I&&p.init({element:K.node(),gd:a,prepFn:function(){sa=H.attr("transform")},moveFn:function(a,c){var f="pointer";if(b.showarrow)b.axref===b.xref?B("ax",e.p2r(e.r2p(b.ax)+a)):B("ax",b.ax+a),b.ayref===b.yref?B("ay",h.p2r(h.r2p(b.ay)+c)):B("ay",b.ay+c),ta(a,c);else{if(d)return;var g,i;if(e)g=e.p2r(e.r2p(b.x)+a);else{var j=b._xsize/x.w,k=b.x+(b._xshift-b.xshift)/x.w-j/2;g=p.align(k+a/x.w,j,0,1,b.xanchor)}if(h)i=h.p2r(h.r2p(b.y)+c);else{var l=b._ysize/x.h,m=b.y-(b._yshift+b.yshift)/x.h-l/2;i=p.align(m-c/x.h,l,0,1,b.yanchor)}B("x",g),B("y",i),e&&h||(f=p.getCursor(e?.5:g,h?.5:i,b.xanchor,b.yanchor))}H.attr({transform:"translate("+a+","+c+")"+sa}),o(K,f)},clickFn:function(c,d){b.captureevents&&a.emit("plotly_clickannotation",j(d))},doneFn:function(){o(K),g.call("_guiRelayout",a,C());var b=document.querySelector(".js-notes-box-panel");b&&b.redraw(b.selectedObj)}})}}var u,v,w=a._fullLayout,x=a._fullLayout._size,y=a._context.edits;d?(u="annotation-"+d,v=d+".annotations"):(u="annotation",v="annotations");var z=q(a.layout,v,b),A=z.modifyBase,B=z.modifyItem,C=z.getUpdateObj;w._infolayer.selectAll("."+u+'[data-index="'+c+'"]').remove();var D="clip"+w._uid+"_ann"+c;if(b._input&&!1!==b.visible){var E={x:{},y:{}},F=+b.textangle||0,G=w._infolayer.append("g").classed(u,!0).attr("data-index",String(c)).style("opacity",b.opacity),H=G.append("g").classed("annotation-text-g",!0),I=y[b.showarrow?"annotationTail":"annotationPosition"],J=b.captureevents||y.annotationText||I,K=H.append("g").style("pointer-events",J?"all":null).call(o,"pointer").on("click",function(){a._dragging=!1,a.emit("plotly_clickannotation",j(f.event))});b.hovertext&&K.on("mouseover",function(){var c=b.hoverlabel,d=c.font,e=this.getBoundingClientRect(),f=a.getBoundingClientRect();m.loneHover({x0:e.left-f.left,x1:e.right-f.left,y:(e.top+e.bottom)/2-f.top,text:b.hovertext,color:c.bgcolor,borderColor:c.bordercolor,fontFamily:d.family,fontSize:d.size,fontColor:d.color},{container:w._hoverlayer.node(),outerContainer:w._paper.node(),gd:a})}).on("mouseout",function(){m.loneUnhover(w._hoverlayer.node())});var L=b.borderwidth,M=b.borderpad,N=L+M,O=K.append("rect").attr("class","bg").style("stroke-width",L+"px").call(k.stroke,b.bordercolor).call(k.fill,b.bgcolor),P=b.width||b.height,Q=w._topclips.selectAll("#"+D).data(P?[0]:[]);Q.enter().append("clipPath").classed("annclip",!0).attr("id",D).append("rect"),Q.exit().remove();var R=b.font,S=w._meta?i.templateString(b.text,w._meta):b.text,T=K.append("text").classed("annotation-text",!0).text(S);y.annotationText?T.call(n.makeEditable,{delegate:K,gd:a}).call(s).on("edit",function(c){b.text=c,this.call(s),B("text",c),e&&e.autorange&&A(e._name+".autorange",!0),h&&h.autorange&&A(h._name+".autorange",!0),g.call("_guiRelayout",a,C())}):T.call(s)}else f.selectAll("#"+D).remove()}var f=a("d3"),g=a("../../registry"),h=a("../../plots/plots"),i=a("../../lib"),j=a("../../plots/cartesian/axes"),k=a("../color"),l=a("../drawing"),m=a("../fx"),n=a("../../lib/svg_text_utils"),o=a("../../lib/setcursor"),p=a("../dragelement"),q=a("../../plot_api/plot_template").arrayEditor,r=a("./draw_arrow_head");b.exports={draw:function(a){var b=a._fullLayout;b._infolayer.selectAll(".annotation").remove();for(var c=0;c<b.annotations.length;c++)b.annotations[c].visible&&d(a,c);return h.previousPromises(a)},drawOne:d,drawRaw:e}},{"../../lib":719,"../../lib/setcursor":739,"../../lib/svg_text_utils":743,"../../plot_api/plot_template":757,"../../plots/cartesian/axes":767,"../../plots/plots":828,"../../registry":848,"../color":594,"../dragelement":612,"../drawing":615,"../fx":632,"./draw_arrow_head":584,d3:164}],584:[function(a,b,c){"use strict";var d=a("d3"),e=a("../color"),f=a("./arrow_paths");b.exports=function(a,b,c){function g(){a.style("stroke-dasharray","0px,100px")}function h(b,f,g,h){b.path&&(b.noRotate&&(g=0),d.select(m.parentNode).append("path").attr({class:a.attr("class"),d:b.path,transform:"translate("+f.x+","+f.y+")"+(g?"rotate("+180*g/Math.PI+")":"")+"scale("+h+")"}).style({fill:e.rgb(c.arrowcolor),"stroke-width":0}))}var i,j,k,l,m=a.node(),n=f[c.arrowhead||0],o=f[c.startarrowhead||0],p=(c.arrowwidth||1)*(c.arrowsize||1),q=(c.arrowwidth||1)*(c.startarrowsize||1),r=b.indexOf("start")>=0,s=b.indexOf("end")>=0,t=n.backoff*p+c.standoff,u=o.backoff*q+c.startstandoff;if("line"===m.nodeName){i={x:+a.attr("x1"),y:+a.attr("y1")},j={x:+a.attr("x2"),y:+a.attr("y2")};var v=i.x-j.x,w=i.y-j.y;if(l=(k=Math.atan2(w,v))+Math.PI,t&&u&&t+u>Math.sqrt(v*v+w*w))return void g();if(t){if(t*t>v*v+w*w)return void g();var x=t*Math.cos(k),y=t*Math.sin(k);j.x+=x,j.y+=y,a.attr({x2:j.x,y2:j.y})}if(u){if(u*u>v*v+w*w)return void g();var z=u*Math.cos(k),A=u*Math.sin(k);i.x-=z,i.y-=A,a.attr({x1:i.x,y1:i.y})}}else if("path"===m.nodeName){var B=m.getTotalLength(),C="";if(B<t+u)return void g();var D=m.getPointAtLength(0),E=m.getPointAtLength(.1);k=Math.atan2(D.y-E.y,D.x-E.x),i=m.getPointAtLength(Math.min(u,B)),C="0px,"+u+"px,";var F=m.getPointAtLength(B),G=m.getPointAtLength(B-.1);l=Math.atan2(F.y-G.y,F.x-G.x),j=m.getPointAtLength(Math.max(0,B-t)),C+=B-(C?u+t:t)+"px,"+B+"px",a.style("stroke-dasharray",C)}r&&h(o,i,k,q),s&&h(n,j,l,p)}},{"../color":594,"./arrow_paths":576,d3:164}],585:[function(a,b,c){"use strict";var d=a("./draw"),e=a("./click");b.exports={moduleType:"component",name:"annotations",layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),includeBasePlot:a("../../plots/cartesian/include_components")("annotations"),calcAutorange:a("./calc_autorange"),draw:d.draw,drawOne:d.drawOne,drawRaw:d.drawRaw,hasClickToShow:e.hasClickToShow,onClick:e.onClick,convertCoords:a("./convert_coords")}},{"../../plots/cartesian/include_components":777,"./attributes":577,"./calc_autorange":578,"./click":579,"./convert_coords":581,"./defaults":582,"./draw":583}],586:[function(a,b,c){"use strict";var d=a("../annotations/attributes"),e=a("../../plot_api/edit_types").overrideAll,f=a("../../plot_api/plot_template").templatedArray;b.exports=e(f("annotation",{visible:d.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:d.xanchor,xshift:d.xshift,yanchor:d.yanchor,yshift:d.yshift,text:d.text,textangle:d.textangle,font:d.font,width:d.width,height:d.height,opacity:d.opacity,align:d.align,valign:d.valign,bgcolor:d.bgcolor,bordercolor:d.bordercolor,borderpad:d.borderpad,borderwidth:d.borderwidth,showarrow:d.showarrow,arrowcolor:d.arrowcolor,arrowhead:d.arrowhead,startarrowhead:d.startarrowhead,arrowside:d.arrowside,arrowsize:d.arrowsize,startarrowsize:d.startarrowsize,arrowwidth:d.arrowwidth,standoff:d.standoff,startstandoff:d.startstandoff,hovertext:d.hovertext,hoverlabel:d.hoverlabel,captureevents:d.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../annotations/attributes":577}],587:[function(a,b,c){"use strict";function d(a,b){var c=b.fullSceneLayout.domain,d=b.fullLayout._size,g={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};a._xa={},e.extendFlat(a._xa,g),f.setConvert(a._xa),a._xa._offset=d.l+c.x[0]*d.w,a._xa.l2p=function(){return.5*(1+a._pdata[0]/a._pdata[3])*d.w*(c.x[1]-c.x[0])},a._ya={},e.extendFlat(a._ya,g),f.setConvert(a._ya),a._ya._offset=d.t+(1-c.y[1])*d.h,a._ya.l2p=function(){return.5*(1-a._pdata[1]/a._pdata[3])*d.h*(c.y[1]-c.y[0])}}var e=a("../../lib"),f=a("../../plots/cartesian/axes");b.exports=function(a){for(var b=a.fullSceneLayout.annotations,c=0;c<b.length;c++)d(b[c],a);a.fullLayout._infolayer.selectAll(".annotation-"+a.id).remove()}},{"../../lib":719,"../../plots/cartesian/axes":767}],588:[function(a,b,c){"use strict";function d(a,b,c,d){function g(c,d){return e.coerce(a,b,i,c,d)}function j(a){var d=a+"axis",e={_fullLayout:{}};return e._fullLayout[d]=c[d],f.coercePosition(b,e,g,a,a,.5)}g("visible")&&(h(a,b,d.fullLayout,g),j("x"),j("y"),j("z"),e.noneOrAll(a,b,["x","y","z"]),b.xref="x",b.yref="y",b.zref="z",g("xanchor"),g("yanchor"),g("xshift"),g("yshift"),b.showarrow&&(b.axref="pixel",b.ayref="pixel",g("ax",-10),g("ay",-30),e.noneOrAll(a,b,["ax","ay"])))}var e=a("../../lib"),f=a("../../plots/cartesian/axes"),g=a("../../plots/array_container_defaults"),h=a("../annotations/common_defaults"),i=a("./attributes");b.exports=function(a,b,c){g(a,b,{name:"annotations",handleItemDefaults:d,fullLayout:c.fullLayout})}},{"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/cartesian/axes":767,"../annotations/common_defaults":580,"./attributes":586}],589:[function(a,b,c){"use strict";var d=a("../annotations/draw").drawRaw,e=a("../../plots/gl3d/project"),f=["x","y","z"];b.exports=function(a){for(var b=a.fullSceneLayout,c=a.dataScale,g=b.annotations,h=0;h<g.length;h++){for(var i=g[h],j=!1,k=0;k<3;k++){var l=f[k],m=i[l],n=b[l+"axis"].r2fraction(m);if(n<0||n>1){j=!0;break}}j?a.fullLayout._infolayer.select(".annotation-"+a.id+'[data-index="'+h+'"]').remove():(i._pdata=e(a.glplot.cameraParams,[b.xaxis.r2l(i.x)*c[0],b.yaxis.r2l(i.y)*c[1],b.zaxis.r2l(i.z)*c[2]]),d(a.graphDiv,i,h,a.id,i._xa,i._ya))}}},{"../../plots/gl3d/project":816,"../annotations/draw":583}],590:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib");b.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:a("./attributes")}}},layoutAttributes:a("./attributes"),handleDefaults:a("./defaults"),includeBasePlot:function(a,b){var c=d.subplotsRegistry.gl3d;if(c)for(var f=c.attrRegex,g=Object.keys(a),h=0;h<g.length;h++){var i=g[h];f.test(i)&&(a[i].annotations||[]).length&&(e.pushUnique(b._basePlotModules,c),e.pushUnique(b._subplots.gl3d,i))}},convert:a("./convert"),draw:a("./draw")}},{"../../lib":719,"../../registry":848,"./attributes":586,"./convert":587,"./defaults":588,"./draw":589}],591:[function(a,b,c){"use strict";b.exports=a("world-calendars/dist/main"),a("world-calendars/dist/plus"),a("world-calendars/dist/calendars/chinese"),a("world-calendars/dist/calendars/coptic"),a("world-calendars/dist/calendars/discworld"),a("world-calendars/dist/calendars/ethiopian"),a("world-calendars/dist/calendars/hebrew"),a("world-calendars/dist/calendars/islamic"),a("world-calendars/dist/calendars/julian"),a("world-calendars/dist/calendars/mayan"),a("world-calendars/dist/calendars/nanakshahi"),a("world-calendars/dist/calendars/nepali"),a("world-calendars/dist/calendars/persian"),a("world-calendars/dist/calendars/taiwan"),a("world-calendars/dist/calendars/thai"),a("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":558,"world-calendars/dist/calendars/coptic":559,"world-calendars/dist/calendars/discworld":560,"world-calendars/dist/calendars/ethiopian":561,"world-calendars/dist/calendars/hebrew":562,"world-calendars/dist/calendars/islamic":563,"world-calendars/dist/calendars/julian":564,"world-calendars/dist/calendars/mayan":565,"world-calendars/dist/calendars/nanakshahi":566,"world-calendars/dist/calendars/nepali":567,"world-calendars/dist/calendars/persian":568,"world-calendars/dist/calendars/taiwan":569,"world-calendars/dist/calendars/thai":570,"world-calendars/dist/calendars/ummalqura":571,"world-calendars/dist/main":572,"world-calendars/dist/plus":573}],592:[function(a,b,c){"use strict";function d(a){var b=p[a];return b||(b=p[a]=g.instance(a))}function e(a){return h.extendFlat({},l,{description:a})}function f(a){return"Sets the calendar system to use with `"+a+"` date data."}var g=a("./calendars"),h=a("../../lib"),i=a("../../constants/numerical"),j=i.EPOCHJD,k=i.ONEDAY,l={valType:"enumerated",values:Object.keys(g.calendars),editType:"calc",dflt:"gregorian"},m=function(a,b,c,d){var e={};return e[c]=l,h.coerce(a,b,e,c,d)},n="##",o={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:n,w:n,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},p={},q={xcalendar:e(f("x"))},r=h.extendFlat({},q,{ycalendar:e(f("y"))}),s=h.extendFlat({},r,{zcalendar:e(f("z"))}),t=e(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));b.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:r,bar:r,box:r,heatmap:r,contour:r,histogram:r,histogram2d:r,histogram2dcontour:r,scatter3d:s,surface:s,mesh3d:s,scattergl:r,ohlc:q,candlestick:q},layout:{calendar:e(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:t},yaxis:{calendar:t},scene:{xaxis:{calendar:t},yaxis:{calendar:t},zaxis:{calendar:t}},polar:{radialaxis:{calendar:t}}},transforms:{filter:{valuecalendar:e(["Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:e(["Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:l,handleDefaults:m,handleTraceDefaults:function(a,b,c,d){for(var e=0;e<c.length;e++)m(a,b,c[e]+"calendar",d.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:d,worldCalFmt:function(a,b,c){for(var e,f,g,h,i,l=Math.floor((b+.05)/k)+j,m=d(c).fromJD(l),p=0;-1!==(p=a.indexOf("%",p));)"0"===(e=a.charAt(p+1))||"-"===e||"_"===e?(g=3,f=a.charAt(p+2),"_"===e&&(e="-")):(f=e,e="0",g=2),(h=o[f])?(i=h===n?n:m.formatDate(h[e]),a=a.substr(0,p)+i+a.substr(p+g),p+=i.length):p+=g;return a}}},{"../../constants/numerical":695,"../../lib":719,"./calendars":591}],593:[function(a,b,c){"use strict";c.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],c.defaultLine="#444",c.lightLine="#eee",c.background="#fff",c.borderLine="#BEC8D9",c.lightFraction=1e3/11},{}],594:[function(a,b,c){"use strict";function d(a){if(f(a)||"string"!=typeof a)return a;var b=a.trim();if("rgb"!==b.substr(0,3))return a;var c=b.match(/^rgba?\s*\(([^()]*)\)$/);if(!c)return a;var d=c[1].trim().split(/\s*[\s,]\s*/),e="a"===b.charAt(3)&&4===d.length;if(!e&&3!==d.length)return a;for(var g=0;g<d.length;g++){if(!d[g].length)return a;if(d[g]=Number(d[g]),!(d[g]>=0))return a;if(3===g)d[g]>1&&(d[g]=1);else if(d[g]>=1)return a}var h=Math.round(255*d[0])+", "+Math.round(255*d[1])+", "+Math.round(255*d[2]);return e?"rgba("+h+", "+d[3]+")":"rgb("+h+")"}var e=a("tinycolor2"),f=a("fast-isnumeric"),g=b.exports={},h=a("./attributes");g.defaults=h.defaults;var i=g.defaultLine=h.defaultLine;g.lightLine=h.lightLine;var j=g.background=h.background;g.tinyRGB=function(a){var b=a.toRgb();return"rgb("+Math.round(b.r)+", "+Math.round(b.g)+", "+Math.round(b.b)+")"},g.rgb=function(a){return g.tinyRGB(e(a))},g.opacity=function(a){return a?e(a).getAlpha():0},g.addOpacity=function(a,b){var c=e(a).toRgb();return"rgba("+Math.round(c.r)+", "+Math.round(c.g)+", "+Math.round(c.b)+", "+b+")"},g.combine=function(a,b){var c=e(a).toRgb();if(1===c.a)return e(a).toRgbString();var d=e(b||j).toRgb(),f=1===d.a?d:{r:255*(1-d.a)+d.r*d.a,g:255*(1-d.a)+d.g*d.a,b:255*(1-d.a)+d.b*d.a},g={r:f.r*(1-c.a)+c.r*c.a,g:f.g*(1-c.a)+c.g*c.a,b:f.b*(1-c.a)+c.b*c.a};return e(g).toRgbString()},g.contrast=function(a,b,c){var d=e(a);return 1!==d.getAlpha()&&(d=e(g.combine(a,j))),(d.isDark()?b?d.lighten(b):j:c?d.darken(c):i).toString()},g.stroke=function(a,b){var c=e(b);a.style({stroke:g.tinyRGB(c),"stroke-opacity":c.getAlpha()})},g.fill=function(a,b){var c=e(b);a.style({fill:g.tinyRGB(c),"fill-opacity":c.getAlpha()})},g.clean=function(a){if(a&&"object"==typeof a){var b,c,e,f,h=Object.keys(a);for(b=0;b<h.length;b++)if(f=a[e=h[b]],"color"===e.substr(e.length-5))if(Array.isArray(f))for(c=0;c<f.length;c++)f[c]=d(f[c]);else a[e]=d(f);else if("colorscale"===e.substr(e.length-10)&&Array.isArray(f))for(c=0;c<f.length;c++)Array.isArray(f[c])&&(f[c][1]=d(f[c][1]));else if(Array.isArray(f)){var i=f[0];if(!Array.isArray(i)&&i&&"object"==typeof i)for(c=0;c<f.length;c++)g.clean(f[c])}else f&&"object"==typeof f&&g.clean(f)}}},{"./attributes":593,"fast-isnumeric":226,tinycolor2:538}],595:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/layout_attributes"),e=a("../../plots/font_attributes"),f=a("../../lib/extend").extendFlat,g=a("../../plot_api/edit_types").overrideAll;b.exports=g({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},
xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:d.linecolor,outlinewidth:d.linewidth,bordercolor:d.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:d.tickmode,nticks:d.nticks,tick0:d.tick0,dtick:d.dtick,tickvals:d.tickvals,ticktext:d.ticktext,ticks:f({},d.ticks,{dflt:""}),ticklen:d.ticklen,tickwidth:d.tickwidth,tickcolor:d.tickcolor,showticklabels:d.showticklabels,tickfont:e({}),tickangle:d.tickangle,tickformat:d.tickformat,tickformatstops:d.tickformatstops,tickprefix:d.tickprefix,showtickprefix:d.showtickprefix,ticksuffix:d.ticksuffix,showticksuffix:d.showticksuffix,separatethousands:d.separatethousands,exponentformat:d.exponentformat,showexponent:d.showexponent,title:{text:{valType:"string"},font:e({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:e({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/cartesian/layout_attributes":779,"../../plots/font_attributes":793}],596:[function(a,b,c){"use strict";b.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],597:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plot_api/plot_template"),f=a("../../plots/cartesian/tick_value_defaults"),g=a("../../plots/cartesian/tick_mark_defaults"),h=a("../../plots/cartesian/tick_label_defaults"),i=a("./attributes");b.exports=function(a,b,c){function j(a,b){return d.coerce(l,k,i,a,b)}var k=e.newContainer(b,"colorbar"),l=a.colorbar||{};j("thickness","fraction"===j("thicknessmode")?30/(c.width-c.margin.l-c.margin.r):30),j("len","fraction"===j("lenmode")?1:c.height-c.margin.t-c.margin.b),j("x"),j("xanchor"),j("xpad"),j("y"),j("yanchor"),j("ypad"),d.noneOrAll(l,k,["x","y"]),j("outlinecolor"),j("outlinewidth"),j("bordercolor"),j("borderwidth"),j("bgcolor"),f(l,k,j,"linear");var m={outerTicks:!1,font:c.font};h(l,k,j,"linear",m),g(l,k,j,"linear",m),j("title.text",c._dfltTitle.colorbar),d.coerceFont(j,"title.font",c.font),j("title.side")}},{"../../lib":719,"../../plot_api/plot_template":757,"../../plots/cartesian/tick_label_defaults":786,"../../plots/cartesian/tick_mark_defaults":787,"../../plots/cartesian/tick_value_defaults":788,"./attributes":595}],598:[function(a,b,c){"use strict";var d=a("d3"),e=a("tinycolor2"),f=a("../../plots/plots"),g=a("../../registry"),h=a("../../plots/cartesian/axes"),i=a("../dragelement"),j=a("../../lib"),k=a("../../lib/extend").extendFlat,l=a("../../lib/setcursor"),m=a("../drawing"),n=a("../color"),o=a("../titles"),p=a("../../lib/svg_text_utils"),q=a("../colorscale/helpers").flipScale,r=a("../../plots/cartesian/axis_defaults"),s=a("../../plots/cartesian/position_defaults"),t=a("../../plots/cartesian/layout_attributes"),u=a("../../constants/alignment"),v=u.LINE_SPACING,w=u.FROM_TL,x=u.FROM_BR,y=a("./constants").cn;b.exports={draw:function(a){var b=a._fullLayout._infolayer.selectAll("g."+y.colorbar).data(function(a){function b(a){return k(a,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function c(){"function"==typeof g.calc?g.calc(a,f,d):(d._fillgradient=e.reversescale?q(e.colorscale):e.colorscale,d._zrange=[e[g.min],e[g.max]])}for(var d,e,f,g,h=a._fullLayout,i=a.calcdata,j=[],l=0;l<i.length;l++){var m=i[l],n=(f=m[0].trace)._module.colorbar;if(!0===f.visible&&n)for(var o=Array.isArray(n),p=o?n:[n],r=0;r<p.length;r++){var s=(g=p[r]).container;(e=s?f[s]:f)&&e.showscale&&((d=b(e.colorbar))._id="cb"+f.uid+(o&&s?"-"+s:""),d._traceIndex=f.index,d._propPrefix=(s?s+".":"")+"colorbar.",d._meta=f._meta,c(),j.push(d))}}for(var t in h._colorAxes)if((e=h[t]).showscale){var u=h._colorAxes[t];(d=b(e.colorbar))._id="cb"+t,d._propPrefix=t+".colorbar.",d._meta=h._meta,g={min:"cmin",max:"cmax"},"heatmap"!==u[0]&&(f=u[1],g.calc=f._module.colorbar.calc),c(),j.push(d)}return j}(a),function(a){return a._id});b.enter().append("g").attr("class",function(a){return a._id}).classed(y.colorbar,!0),b.each(function(b){var c=d.select(this);j.ensureSingle(c,"rect",y.cbbg),j.ensureSingle(c,"g",y.cbfills),j.ensureSingle(c,"g",y.cblines),j.ensureSingle(c,"g",y.cbaxis,function(a){a.classed(y.crisp,!0)}),j.ensureSingle(c,"g",y.cbtitleunshift,function(a){a.append("g").classed(y.cbtitle,!0)}),j.ensureSingle(c,"rect",y.cboutline);var q=function(a,b,c){function g(d,e){var f={propContainer:U,propName:b._propPrefix+"title",traceIndex:b._traceIndex,_meta:b._meta,placeholder:i._dfltTitle.colorbar,containerGroup:a.select("."+y.cbtitle)},g="h"===d.charAt(0)?d.substr(1):"h"+d;a.selectAll("."+g+",."+g+"-math-group").remove(),o.draw(c,d,k(f,e||{}))}var i=c._fullLayout,l=i._size,q=b._fillcolor,u=b._line,z=b.title,A=z.side,B=b._zrange||d.extent(("function"==typeof q?q:u.color).domain()),C="function"==typeof u.color?u.color:function(){return u.color},D="function"==typeof q?q:function(){return q},E=b._levels,F=function(a,b,c){var d,e,f=b._levels,g=[],h=[],i=f.end+f.size/100,j=f.size,k=1.001*c[0]-.001*c[1],l=1.001*c[1]-.001*c[0];for(e=0;e<1e5&&(d=f.start+e*j,!(j>0?d>=i:d<=i));e++)d>k&&d<l&&g.push(d);if(b._fillgradient)h=[0];else if("function"==typeof b._fillcolor){var m=b._filllevels;if(m)for(i=m.end+m.size/100,j=m.size,e=0;e<1e5&&(d=m.start+e*j,!(j>0?d>=i:d<=i));e++)d>c[0]&&d<c[1]&&h.push(d);else(h=g.map(function(a){return a-f.size/2})).push(h[h.length-1]+f.size)}else b._fillcolor&&"string"==typeof b._fillcolor&&(h=[0]);return f.size<0&&(g.reverse(),h.reverse()),{line:g,fill:h}}(0,b,B),G=F.fill,H=F.line,I=Math.round(b.thickness*("fraction"===b.thicknessmode?l.w:1)),J=I/l.w,K=Math.round(b.len*("fraction"===b.lenmode?l.h:1)),L=K/l.h,M=b.xpad/l.w,N=(b.borderwidth+b.outlinewidth)/2,O=b.ypad/l.h,P=Math.round(b.x*l.w+b.xpad),Q=b.x-J*({middle:.5,right:1}[b.xanchor]||0),R=b.y+L*(({top:-.5,bottom:.5}[b.yanchor]||0)-.5),S=Math.round(l.h*(1-R)),T=S-K;b._lenFrac=L,b._thickFrac=J,b._xLeftFrac=Q,b._yBottomFrac=R;var U=b._axis=function(a,b,c){function d(a,b){return j.coerce(f,g,t,a,b)}var e=a._fullLayout,f={type:"linear",range:c,tickmode:b.tickmode,nticks:b.nticks,tick0:b.tick0,dtick:b.dtick,tickvals:b.tickvals,ticktext:b.ticktext,ticks:b.ticks,ticklen:b.ticklen,tickwidth:b.tickwidth,tickcolor:b.tickcolor,showticklabels:b.showticklabels,tickfont:b.tickfont,tickangle:b.tickangle,tickformat:b.tickformat,exponentformat:b.exponentformat,separatethousands:b.separatethousands,showexponent:b.showexponent,showtickprefix:b.showtickprefix,tickprefix:b.tickprefix,showticksuffix:b.showticksuffix,ticksuffix:b.ticksuffix,title:b.title,showline:!0,anchor:"free",side:"right",position:1},g={type:"linear",_id:"y"+b._id},h={letter:"y",font:e.font,noHover:!0,noTickson:!0,calendar:e.calendar};return r(f,g,d,h,e),s(f,g,d,h),g}(c,b,B);if(U.position=b.x+M+J,-1!==["top","bottom"].indexOf(A)&&(U.title.side=A,U.titlex=b.x+M,U.titley=R+("top"===z.side?L-O:O)),u.color&&"auto"===b.tickmode){U.tickmode="linear",U.tick0=E.start;var V=E.size,W=j.constrain((S-T)/50,4,15)+1,X=(B[1]-B[0])/((b.nticks||W)*V);if(X>1){var Y=Math.pow(10,Math.floor(Math.log(X)/Math.LN10));V*=Y*j.roundUp(X/Y,[2,5,10]),(Math.abs(E.start)/E.size+1e-6)%1<2e-6&&(U.tick0=0)}U.dtick=V}U.domain=[R+O,R+L-O],U.setScale(),a.attr("transform","translate("+Math.round(l.l)+","+Math.round(l.t)+")");var Z,$=a.select("."+y.cbtitleunshift).attr("transform","translate(-"+Math.round(l.l)+",-"+Math.round(l.t)+")"),_=a.select("."+y.cbaxis),aa=0;return j.syncOrAsync([f.previousPromises,function(){if(-1!==["top","bottom"].indexOf(A)){var a,c=l.l+(b.x+M)*l.w,d=U.title.font.size;a="top"===A?(1-(R+L-O))*l.h+l.t+3+.75*d:(1-(R+O))*l.h+l.t-3-.25*d,g(U._id+"title",{attributes:{x:c,y:a,"text-anchor":"start"}})}},function(){if(-1!==["top","bottom"].indexOf(A)){var f=a.select("."+y.cbtitle),g=f.select("text"),i=[-b.outlinewidth/2,b.outlinewidth/2],k=f.select(".h"+U._id+"title-math-group").node(),n=15.6;if(g.node()&&(n=parseInt(g.node().style.fontSize,10)*v),k?(aa=m.bBox(k).height)>n&&(i[1]-=(aa-n)/2):g.node()&&!g.classed(y.jsPlaceholder)&&(aa=m.bBox(g.node()).height),aa){if(aa+=5,"top"===A)U.domain[1]-=aa/l.h,i[1]*=-1;else{U.domain[0]+=aa/l.h;var o=p.lineCount(g);i[1]+=(1-o)*n}f.attr("transform","translate("+i+")"),U.setScale()}}a.selectAll("."+y.cbfills+",."+y.cblines).attr("transform","translate(0,"+Math.round(l.h*(1-U.domain[1]))+")"),_.attr("transform","translate(0,"+Math.round(-l.t)+")");var q=a.select("."+y.cbfills).selectAll("rect."+y.cbfill).data(G);q.enter().append("rect").classed(y.cbfill,!0).style("stroke","none"),q.exit().remove();var r=B.map(U.c2p).map(Math.round).sort(function(a,b){return a-b});q.each(function(a,f){var g=[0===f?B[0]:(G[f]+G[f-1])/2,f===G.length-1?B[1]:(G[f]+G[f+1])/2].map(U.c2p).map(Math.round);g[1]=j.constrain(g[1]+(g[1]>g[0])?1:-1,r[0],r[1]);var h=d.select(this).attr({x:P,width:Math.max(I,2),y:d.min(g),height:Math.max(d.max(g)-d.min(g),2)});if(b._fillgradient)m.gradient(h,c,b._id,"vertical",b._fillgradient,"fill");else{var i=D(a).replace("e-","");h.attr("fill",e(i).toHexString())}});var s=a.select("."+y.cblines).selectAll("path."+y.cbline).data(u.color&&u.width?H:[]);s.enter().append("path").classed(y.cbline,!0),s.exit().remove(),s.each(function(a){d.select(this).attr("d","M"+P+","+(Math.round(U.c2p(a))+u.width/2%1)+"h"+I).call(m.lineGroupStyle,u.width,C(a),u.dash)}),_.selectAll("g."+U._id+"tick,path").remove();var t=P+I+(b.outlinewidth||0)/2-("outside"===b.ticks?1:0),w=h.calcTicks(U),x=h.makeTransFn(U),z=h.getTickSigns(U)[2];return h.drawTicks(c,U,{vals:"inside"===U.ticks?h.clipEnds(U,w):w,layer:_,path:h.makeTickPath(U,t,z),transFn:x}),h.drawLabels(c,U,{vals:w,layer:_,transFn:x,labelFns:h.makeLabelFns(U,t)})},function(){if(-1===["top","bottom"].indexOf(A)){var a=U.title.font.size,b=U._offset+U._length/2,e=l.l+(U.position||0)*l.w+("right"===U.side?10+a*(U.showticklabels?1:.5):-10-a*(U.showticklabels?.5:0));g("h"+U._id+"title",{avoid:{selection:d.select(c).selectAll("g."+U._id+"tick"),side:A,offsetLeft:l.l,offsetTop:0,maxShift:i.width},attributes:{x:e,y:b,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}},f.previousPromises,function(){var d=I+b.outlinewidth/2+m.bBox(_.node()).width;if((Z=$.select("text")).node()&&!Z.classed(y.jsPlaceholder)){var e,g=$.select(".h"+U._id+"title-math-group").node();e=g&&-1!==["top","bottom"].indexOf(A)?m.bBox(g).width:m.bBox($.node()).right-P-l.l,d=Math.max(d,e)}var h=2*b.xpad+d+b.borderwidth+b.outlinewidth/2,i=S-T;a.select("."+y.cbbg).attr({x:P-b.xpad-(b.borderwidth+b.outlinewidth)/2,y:T-N,width:Math.max(h,2),height:Math.max(i+2*N,2)}).call(n.fill,b.bgcolor).call(n.stroke,b.bordercolor).style("stroke-width",b.borderwidth),a.selectAll("."+y.cboutline).attr({x:P,y:T+b.ypad+("top"===A?aa:0),width:Math.max(I,2),height:Math.max(i-2*b.ypad-aa,2)}).call(n.stroke,b.outlinecolor).style({fill:"none","stroke-width":b.outlinewidth});var j=({center:.5,right:1}[b.xanchor]||0)*h;a.attr("transform","translate("+(l.l-j)+","+l.t+")");var k={},o=w[b.yanchor],p=x[b.yanchor];"pixels"===b.lenmode?(k.y=b.y,k.t=i*o,k.b=i*p):(k.t=k.b=0,k.yt=b.y+b.len*o,k.yb=b.y-b.len*p);var q=w[b.xanchor],r=x[b.xanchor];if("pixels"===b.thicknessmode)k.x=b.x,k.l=h*q,k.r=h*r;else{var s=h-I;k.l=s*q,k.r=s*r,k.xl=b.x-b.thickness*q,k.xr=b.x+b.thickness*r}f.autoMargin(c,b._id,k)}],c)}(c,b,a);q&&q.then&&(a._promises||[]).push(q),a._context.edits.colorbarPosition&&function(a,b,c){var d,e,f,h=c._fullLayout._size;i.init({element:a.node(),gd:c,prepFn:function(){d=a.attr("transform"),l(a)},moveFn:function(c,g){a.attr("transform",d+" translate("+c+","+g+")"),e=i.align(b._xLeftFrac+c/h.w,b._thickFrac,0,1,b.xanchor),f=i.align(b._yBottomFrac-g/h.h,b._lenFrac,0,1,b.yanchor);var j=i.getCursor(e,f,b.xanchor,b.yanchor);l(a,j)},doneFn:function(){if(l(a),void 0!==e&&void 0!==f){var d={};d[b._propPrefix+"x"]=e,d[b._propPrefix+"y"]=f,void 0!==b._traceIndex?g.call("_guiRestyle",c,d,b._traceIndex):g.call("_guiRelayout",c,d)}}})}(c,b,a)}),b.exit().each(function(b){f.autoMargin(a,b._id)}).remove(),b.order()}}},{"../../constants/alignment":688,"../../lib":719,"../../lib/extend":710,"../../lib/setcursor":739,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"../../plots/cartesian/axis_defaults":769,"../../plots/cartesian/layout_attributes":779,"../../plots/cartesian/position_defaults":782,"../../plots/plots":828,"../../registry":848,"../color":594,"../colorscale/helpers":605,"../dragelement":612,"../drawing":615,"../titles":681,"./constants":596,d3:164,tinycolor2:538}],599:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a){return d.isPlainObject(a.colorbar)}},{"../../lib":719}],600:[function(a,b,c){"use strict";b.exports={moduleType:"component",name:"colorbar",attributes:a("./attributes"),supplyDefaults:a("./defaults"),draw:a("./draw").draw,hasColorbar:a("./has_colorbar")}},{"./attributes":595,"./defaults":597,"./draw":598,"./has_colorbar":599}],601:[function(a,b,c){"use strict";function d(a){return"`"+a+"`"}var e=a("../colorbar/attributes"),f=a("../../lib/regex").counter,g=a("./scales.js").scales;Object.keys(g),b.exports=function(a,b){a=a||"";var c,h=(b=b||{}).cLetter||"c",i=("onlyIfNumerical"in b?b.onlyIfNumerical:Boolean(a),"noScale"in b?b.noScale:"marker.line"===a),j="showScaleDflt"in b?b.showScaleDflt:"z"===h,k="string"==typeof b.colorscaleDflt?g[b.colorscaleDflt]:null,l=b.editTypeOverride||"",m=a?a+".":"";"colorAttr"in b?(c=b.colorAttr,b.colorAttr):d(m+(c={z:"z",c:"color"}[h]));var n=h+"auto",o=h+"min",p=h+"max",q=h+"mid",r=(d(m+n),d(m+o),d(m+p),{});r[o]=r[p]=void 0;var s={};s[n]=!1;var t={};return"color"===c&&(t.color={valType:"color",arrayOk:!0,editType:l||"style"},b.anim&&(t.color.anim=!0)),t[n]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:r},t[o]={valType:"number",dflt:null,editType:l||"plot",impliedEdits:s},t[p]={valType:"number",dflt:null,editType:l||"plot",impliedEdits:s},t[q]={valType:"number",dflt:null,editType:"calc",impliedEdits:r},t.colorscale={valType:"colorscale",editType:"calc",dflt:k,impliedEdits:{autocolorscale:!1}},t.autocolorscale={valType:"boolean",dflt:!1!==b.autoColorDflt,editType:"calc",impliedEdits:{colorscale:void 0}},t.reversescale={valType:"boolean",dflt:!1,editType:"plot"},i||(t.showscale={valType:"boolean",dflt:j,editType:"calc"},t.colorbar=e),b.noColorAxis||(t.coloraxis={valType:"subplotid",regex:f("coloraxis"),dflt:null,editType:"calc"}),t}},{"../../lib/regex":735,"../colorbar/attributes":595,"./scales.js":609}],602:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib"),f=a("./helpers").extractOpts;b.exports=function(a,b,c){var g,h=a._fullLayout,i=c.vals,j=c.containerStr,k=j?e.nestedProperty(b,j).get():b,l=f(k),m=!1!==l.auto,n=l.min,o=l.max,p=l.mid,q=function(){return e.aggNums(Math.min,null,i)},r=function(){return e.aggNums(Math.max,null,i)};void 0===n?n=q():m&&(n=k._colorAx&&d(n)?Math.min(n,q()):q()),void 0===o?o=r():m&&(o=k._colorAx&&d(o)?Math.max(o,r()):r()),m&&void 0!==p&&(o-p>p-n?n=p-(o-p):o-p<p-n&&(o=p+(p-n))),n===o&&(n-=.5,o+=.5),l._sync("min",n),l._sync("max",o),l.autocolorscale&&(g=n*o<0?h.colorscale.diverging:n>=0?h.colorscale.sequential:h.colorscale.sequentialminus,l._sync("colorscale",g))}},{"../../lib":719,"./helpers":605,"fast-isnumeric":226}],603:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./helpers").hasColorscale,f=a("./helpers").extractOpts;b.exports=function(a,b){function c(a,b){var c=a["_"+b];void 0!==c&&(a[b]=c)}function g(a,e){var g=e.container?d.nestedProperty(a,e.container).get():a;if(g)if(g.coloraxis)g._colorAx=b[g.coloraxis];else{var h=f(g),i=h.auto;(i||void 0===h.min)&&c(g,e.min),(i||void 0===h.max)&&c(g,e.max),h.autocolorscale&&c(g,"colorscale")}}for(var h=0;h<a.length;h++){var i=a[h],j=i._module.colorbar;if(j)if(Array.isArray(j))for(var k=0;k<j.length;k++)g(i,j[k]);else g(i,j);e(i,"marker.line")&&g(i,{container:"marker.line",min:"cmin",max:"cmax"})}for(var l in b._colorAxes)g(b[l],{min:"cmin",max:"cmax"})}},{"../../lib":719,"./helpers":605}],604:[function(a,b,c){"use strict";function d(a,b){var c=b.slice(0,b.length-1);return b?f.nestedProperty(a,c).get()||{}:a}var e=a("fast-isnumeric"),f=a("../../lib"),g=a("../colorbar/has_colorbar"),h=a("../colorbar/defaults"),i=a("./scales").isValid,j=a("../../registry").traceIs;b.exports=function a(b,c,k,l,m){var n=m.prefix,o=m.cLetter,p="_module"in c,q=d(b,n),r=d(c,n),s=d(c._template||{},n)||{},t=function(){return delete b.coloraxis,delete c.coloraxis,a(b,c,k,l,m)};if(p){var u=k._colorAxes||{},v=l(n+"coloraxis");if(v){var w=j(c,"contour")&&f.nestedProperty(c,"contours.coloring").get()||"heatmap",x=u[v];return void(x?(x[2].push(t),x[0]!==w&&(x[0]=!1,f.warn(["Ignoring coloraxis:",v,"setting","as it is linked to incompatible colorscales."].join(" ")))):u[v]=[w,c,[t]])}}var y=q[o+"min"],z=q[o+"max"],A=e(y)&&e(z)&&y<z;l(n+o+"auto",!A)?l(n+o+"mid"):(l(n+o+"min"),l(n+o+"max"));var B,C,D=q.colorscale,E=s.colorscale;void 0!==D&&(B=!i(D)),void 0!==E&&(B=!i(E)),l(n+"autocolorscale",B),l(n+"colorscale"),l(n+"reversescale"),"marker.line."!==n&&(n&&p&&(C=g(q)),l(n+"showscale",C)&&h(q,r,k))}},{"../../lib":719,"../../registry":848,"../colorbar/defaults":597,"../colorbar/has_colorbar":599,"./scales":609,"fast-isnumeric":226}],605:[function(a,b,c){"use strict";function d(a){var b,c,d,e=a._colorAx,f=e||a,g={};for(c=0;c<o.length;c++)g[d=o[c]]=f[d];if(e)for(b="c",c=0;c<p.length;c++)g[d=p[c]]=f["c"+d];else{var h;for(c=0;c<p.length;c++)(h="c"+(d=p[c]))in f?g[d]=f[h]:(h="z"+d)in f&&(g[d]=f[h]);b=h.charAt(0)}return g._sync=function(a,c){var d=-1!==p.indexOf(a)?b+a:a;f[d]=f["_"+d]=c},g}function e(a){for(var b=d(a),c=b.min,e=b.max,g=b.reversescale?f(b.colorscale):b.colorscale,h=g.length,i=new Array(h),j=new Array(h),k=0;k<h;k++){var l=g[k];i[k]=c+l[0]*(e-c),j[k]=l[1]}return{domain:i,range:j}}function f(a){for(var b=a.length,c=new Array(b),d=b-1,e=0;d>=0;d--,e++){var f=a[d];c[e]=[1-f[0],f[1]]}return c}function g(a,b){b=b||{};for(var c=a.domain,d=a.range,e=d.length,f=new Array(e),g=0;g<e;g++){var l=j(d[g]).toRgb();f[g]=[l.r,l.g,l.b,l.a]}var n,o=i.scale.linear().domain(c).range(f).clamp(!0),p=b.noNumericCheck,q=b.returnArray;return(n=p&&q?o:p?function(a){return h(o(a))}:q?function(a){return k(a)?o(a):j(a).isValid()?a:m.defaultLine}:function(a){return k(a)?h(o(a)):j(a).isValid()?a:m.defaultLine}).domain=o.domain,n.range=function(){return d},n}function h(a){var b={r:a[0],g:a[1],b:a[2],a:a[3]};return j(b).toRgbString()}var i=a("d3"),j=a("tinycolor2"),k=a("fast-isnumeric"),l=a("../../lib"),m=a("../color"),n=a("./scales").isValid,o=["showscale","autocolorscale","colorscale","reversescale","colorbar"],p=["min","max","mid","auto"];b.exports={hasColorscale:function(a,b,c){var d=b?l.nestedProperty(a,b).get()||{}:a,e=d[c||"color"],f=!1;if(l.isArrayOrTypedArray(e))for(var g=0;g<e.length;g++)if(k(e[g])){f=!0;break}return l.isPlainObject(d)&&(f||!0===d.showscale||k(d.cmin)&&k(d.cmax)||n(d.colorscale)||l.isPlainObject(d.colorbar))},extractOpts:d,extractScale:e,flipScale:f,makeColorScaleFunc:g,makeColorScaleFuncFromTrace:function(a,b){return g(e(a),b)}}},{"../../lib":719,"../color":594,"./scales":609,d3:164,"fast-isnumeric":226,tinycolor2:538}],606:[function(a,b,c){"use strict";var d=a("./scales"),e=a("./helpers");b.exports={moduleType:"component",name:"colorscale",attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyLayoutDefaults:a("./layout_defaults"),handleDefaults:a("./defaults"),crossTraceDefaults:a("./cross_trace_defaults"),calc:a("./calc"),scales:d.scales,defaultScale:d.defaultScale,getScale:d.get,isValidScale:d.isValid,hasColorscale:e.hasColorscale,extractOpts:e.extractOpts,extractScale:e.extractScale,flipScale:e.flipScale,makeColorScaleFunc:e.makeColorScaleFunc,makeColorScaleFuncFromTrace:e.makeColorScaleFuncFromTrace}},{"./attributes":601,"./calc":602,"./cross_trace_defaults":603,"./defaults":604,"./helpers":605,"./layout_attributes":607,"./layout_defaults":608,"./scales":609}],607:[function(a,b,c){"use strict";var d=a("../../lib/extend").extendFlat,e=a("./attributes"),f=a("./scales").scales;b.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:f.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:f.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:f.RdBu,editType:"calc"}},coloraxis:d({_isSubplotObj:!0,editType:"calc"},e("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":710,"./attributes":601,"./scales":609}],608:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plot_api/plot_template"),f=a("./layout_attributes"),g=a("./defaults");b.exports=function(a,b){function c(c,e){return d.coerce(a,b,f,c,e)}function h(a,b){return d.coerce(i,j,f.coloraxis,a,b)}c("colorscale.sequential"),c("colorscale.sequentialminus"),c("colorscale.diverging");var i,j,k=b._colorAxes;for(var l in k){var m=k[l];if(m[0])i=a[l]||{},(j=e.newContainer(b,l,"coloraxis"))._name=l,g(i,j,b,h,{prefix:"",cLetter:"c"});else{for(var n=0;n<m[2].length;n++)m[2][n]();delete b._colorAxes[l]}}}},{"../../lib":719,"../../plot_api/plot_template":757,"./defaults":604,"./layout_attributes":607}],609:[function(a,b,c){"use strict";function d(a){var b=0;if(!Array.isArray(a)||a.length<2)return!1;if(!a[0]||!a[a.length-1])return!1;if(0!=+a[0][0]||1!=+a[a.length-1][0])return!1;for(var c=0;c<a.length;c++){var d=a[c];if(2!==d.length||+d[0]<b||!e(d[1]).isValid())return!1;b=+d[0]}return!0}var e=a("tinycolor2"),f={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},g=f.RdBu;b.exports={scales:f,defaultScale:g,get:function(a,b){function c(){try{a=f[a]||JSON.parse(a)}catch(c){a=b}}return b||(b=g),a?("string"==typeof a&&(c(),"string"==typeof a&&c()),d(a)?a:b):b},isValid:function(a){return void 0!==f[a]||d(a)}}},{tinycolor2:538}],610:[function(a,b,c){"use strict";b.exports=function(a,b,c,d,e){var f=(a-c)/(d-c),g=f+b/(d-c),h=(f+g)/2;return"left"===e||"bottom"===e?f:"center"===e||"middle"===e?h:"right"===e||"top"===e?g:f<2/3-h?f:g>4/3-h?g:h}},{}],611:[function(a,b,c){"use strict";var d=a("../../lib"),e=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];b.exports=function(a,b,c,f){return a="left"===c?0:"center"===c?1:"right"===c?2:d.constrain(Math.floor(3*a),0,2),b="bottom"===f?0:"middle"===f?1:"top"===f?2:d.constrain(Math.floor(3*b),0,2),e[b][a]}},{"../../lib":719}],612:[function(a,b,c){"use strict";function d(){var a=document.createElement("div");a.className="dragcover";var b=a.style;return b.position="fixed",b.left=0,b.right=0,b.top=0,b.bottom=0,b.zIndex=999999999,b.background="none",document.body.appendChild(a),a}function e(a){return f(a.changedTouches?a.changedTouches[0]:a,document.body)}var f=a("mouse-event-offset"),g=a("has-hover"),h=a("has-passive-events"),i=a("../../lib").removeElement,j=a("../../plots/cartesian/constants"),k=b.exports={};k.align=a("./align"),k.getCursor=a("./cursor");var l=a("./unhover");k.unhover=l.wrapped,k.unhoverRaw=l.raw,k.init=function(a){function b(b){t._dragged=!1,t._dragging=!0;var h=e(b);l=h[0],m=h[1],r=b.target,q=b,s=2===b.buttons||b.ctrlKey,void 0===b.clientX&&void 0===b.clientY&&(b.clientX=l,b.clientY=m),(n=(new Date).getTime())-t._mouseDownTime<v?u+=1:(u=1,t._mouseDownTime=n),a.prepFn&&a.prepFn(b,l,m),g&&!s?(p=d()).style.cursor=window.getComputedStyle(w).cursor:g||(p=document,o=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(w).cursor),document.addEventListener("mouseup",f),document.addEventListener("touchend",f),!1!==a.dragmode&&(b.preventDefault(),document.addEventListener("mousemove",c),document.addEventListener("touchmove",c,{passive:!1}))}function c(b){b.preventDefault();var c=e(b),d=a.minDrag||j.MINDRAG,f=x(c[0]-l,c[1]-m,d),g=f[0],h=f[1];(g||h)&&(t._dragged=!0,k.unhover(t)),t._dragged&&a.moveFn&&!s&&(t._dragdata={element:w,dx:g,dy:h},a.moveFn(g,h))}function f(b){if(delete t._dragdata,!1!==a.dragmode&&(b.preventDefault(),document.removeEventListener("mousemove",c),document.removeEventListener("touchmove",c)),document.removeEventListener("mouseup",f),document.removeEventListener("touchend",f),g?i(p):o&&(p.documentElement.style.cursor=o,o=null),t._dragging){if(t._dragging=!1,(new Date).getTime()-t._mouseDownTime>v&&(u=Math.max(u-1,1)),t._dragged)a.doneFn&&a.doneFn();else if(a.clickFn&&a.clickFn(u,q),!s){var d;try{d=new MouseEvent("click",b)}catch(a){var h=e(b);(d=document.createEvent("MouseEvents")).initMouseEvent("click",b.bubbles,b.cancelable,b.view,b.detail,b.screenX,b.screenY,h[0],h[1],b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,b.button,b.relatedTarget)}r.dispatchEvent(d)}t._dragging=!1,t._dragged=!1}else t._dragged=!1}var l,m,n,o,p,q,r,s,t=a.gd,u=1,v=t._context.doubleClickDelay,w=a.element;t._mouseDownTime||(t._mouseDownTime=0),w.style.pointerEvents="all",w.onmousedown=b,h?(w._ontouchstart&&w.removeEventListener("touchstart",w._ontouchstart),w._ontouchstart=b,w.addEventListener("touchstart",b,{passive:!1})):w.ontouchstart=b;var x=a.clampFn||function(a,b,c){return Math.abs(a)<c&&(a=0),Math.abs(b)<c&&(b=0),[a,b]}},k.coverSlip=d},{"../../lib":719,"../../plots/cartesian/constants":773,"./align":610,"./cursor":611,"./unhover":613,"has-hover":411,"has-passive-events":412,"mouse-event-offset":437}],613:[function(a,b,c){"use strict";var d=a("../../lib/events"),e=a("../../lib/throttle"),f=a("../../lib/dom").getGraphDiv,g=a("../fx/constants"),h=b.exports={};h.wrapped=function(a,b,c){(a=f(a))._fullLayout&&e.clear(a._fullLayout._uid+g.HOVERID),h.raw(a,b,c)},h.raw=function(a,b){var c=a._fullLayout,e=a._hoverdata;b||(b={}),b.target&&!1===d.triggerHandler(a,"plotly_beforehover",b)||(c._hoverlayer.selectAll("g").remove(),c._hoverlayer.selectAll("line").remove(),c._hoverlayer.selectAll("circle").remove(),a._hoverdata=void 0,b.target&&e&&a.emit("plotly_unhover",{event:b,points:e}))}},{"../../lib/dom":708,"../../lib/events":709,"../../lib/throttle":744,"../fx/constants":627}],614:[function(a,b,c){"use strict";c.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"}},{}],615:[function(a,b,c){"use strict";function d(a,b){var c=a%100;return w.symbolFuncs[c](b)+(a>=200?A:"")}function e(a,b,c,d){var e=j.select(a.node().parentNode),f=-1!==b.indexOf("top")?"top":-1!==b.indexOf("bottom")?"bottom":"middle",g=-1!==b.indexOf("left")?"end":-1!==b.indexOf("right")?"start":"middle",h=d?d/.8+1:0,i=(q.lineCount(a)-1)*s+1,k=F[g]*h,l=.75*c+F[f]*h+(F[f]-1)*i*c/2;a.attr("text-anchor",g),e.attr("transform","translate("+k+","+l+")")}function f(a,b){var c=a.ts||b.textfont.size;return k(c)&&c>0?c:0}function g(a,b,c,d){var e=a[0]-b[0],f=a[1]-b[1],g=c[0]-b[0],h=c[1]-b[1],i=Math.pow(e*e+f*f,G/2),k=Math.pow(g*g+h*h,G/2),l=(k*k*e-i*i*g)*d,m=(k*k*f-i*i*h)*d,n=3*k*(i+k),o=3*i*(i+k);return[[j.round(b[0]+(n&&l/n),2),j.round(b[1]+(n&&m/n),2)],[j.round(b[0]-(o&&l/o),2),j.round(b[1]-(o&&m/o),2)]]}function h(a){var b=a.getAttribute("data-unformatted");if(null!==b)return b+a.getAttribute("data-math")+a.getAttribute("text-anchor")+a.getAttribute("style")}function i(a,b){if(!a)return null;var c=b._context;return"url('"+(c._exportedPlot?"":c._baseUrl||"")+"#"+a+"')"}var j=a("d3"),k=a("fast-isnumeric"),l=a("tinycolor2"),m=a("../../registry"),n=a("../color"),o=a("../colorscale"),p=a("../../lib"),q=a("../../lib/svg_text_utils"),r=a("../../constants/xmlns_namespaces"),s=a("../../constants/alignment").LINE_SPACING,t=a("../../constants/interactions").DESELECTDIM,u=a("../../traces/scatter/subtypes"),v=a("../../traces/scatter/make_bubble_size_func"),w=b.exports={},x=a("../fx/helpers").appendArrayPointValue;w.font=function(a,b,c,d){p.isPlainObject(b)&&(d=b.color,c=b.size,b=b.family),b&&a.style("font-family",b),c+1&&a.style("font-size",c+"px"),d&&a.call(n.fill,d)},w.setPosition=function(a,b,c){a.attr("x",b).attr("y",c)},w.setSize=function(a,b,c){a.attr("width",b).attr("height",c)},w.setRect=function(a,b,c,d,e){a.call(w.setPosition,b,c).call(w.setSize,d,e)},w.translatePoint=function(a,b,c,d){var e=c.c2p(a.x),f=d.c2p(a.y);return!!(k(e)&&k(f)&&b.node())&&("text"===b.node().nodeName?b.attr("x",e).attr("y",f):b.attr("transform","translate("+e+","+f+")"),!0)},w.translatePoints=function(a,b,c){a.each(function(a){var d=j.select(this);w.translatePoint(a,d,b,c)})},
w.hideOutsideRangePoint=function(a,b,c,d,e,f){b.attr("display",c.isPtWithinRange(a,e)&&d.isPtWithinRange(a,f)?null:"none")},w.hideOutsideRangePoints=function(a,b){if(b._hasClipOnAxisFalse){var c=b.xaxis,d=b.yaxis;a.each(function(b){var e=b[0].trace,f=e.xcalendar,g=e.ycalendar,h=m.traceIs(e,"bar-like")?".bartext":".point,.textpoint";a.selectAll(h).each(function(a){w.hideOutsideRangePoint(a,j.select(this),c,d,f,g)})})}},w.crispRound=function(a,b,c){return b&&k(b)?a._context.staticPlot?b:b<1?1:Math.round(b):c||0},w.singleLineStyle=function(a,b,c,d,e){b.style("fill","none");var f=(((a||[])[0]||{}).trace||{}).line||{},g=c||f.width||0,h=e||f.dash||"";n.stroke(b,d||f.color),w.dashLine(b,h,g)},w.lineGroupStyle=function(a,b,c,d){a.style("fill","none").each(function(a){var e=(((a||[])[0]||{}).trace||{}).line||{},f=b||e.width||0,g=d||e.dash||"";j.select(this).call(n.stroke,c||e.color).call(w.dashLine,g,f)})},w.dashLine=function(a,b,c){c=+c||0,b=w.dashStyle(b,c),a.style({"stroke-dasharray":b,"stroke-width":c+"px"})},w.dashStyle=function(a,b){b=+b||1;var c=Math.max(b,3);return"solid"===a?a="":"dot"===a?a=c+"px,"+c+"px":"dash"===a?a=3*c+"px,"+3*c+"px":"longdash"===a?a=5*c+"px,"+5*c+"px":"dashdot"===a?a=3*c+"px,"+c+"px,"+c+"px,"+c+"px":"longdashdot"===a&&(a=5*c+"px,"+2*c+"px,"+c+"px,"+2*c+"px"),a},w.singleFillStyle=function(a){var b=(((j.select(a.node()).data()[0]||[])[0]||{}).trace||{}).fillcolor;b&&a.call(n.fill,b)},w.fillGroupStyle=function(a){a.style("stroke-width",0).each(function(a){var b=j.select(this);a[0].trace&&b.call(n.fill,a[0].trace.fillcolor)})};var y=a("./symbol_defs");w.symbolNames=[],w.symbolFuncs=[],w.symbolNeedLines={},w.symbolNoDot={},w.symbolNoFill={},w.symbolList=[],Object.keys(y).forEach(function(a){var b=y[a];w.symbolList=w.symbolList.concat([b.n,a,b.n+100,a+"-open"]),w.symbolNames[b.n]=a,w.symbolFuncs[b.n]=b.f,b.needLine&&(w.symbolNeedLines[b.n]=!0),b.noDot?w.symbolNoDot[b.n]=!0:w.symbolList=w.symbolList.concat([b.n+200,a+"-dot",b.n+300,a+"-open-dot"]),b.noFill&&(w.symbolNoFill[b.n]=!0)});var z=w.symbolNames.length,A="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";w.symbolNumber=function(a){if("string"==typeof a){var b=0;a.indexOf("-open")>0&&(b=100,a=a.replace("-open","")),a.indexOf("-dot")>0&&(b+=200,a=a.replace("-dot","")),(a=w.symbolNames.indexOf(a))>=0&&(a+=b)}return a%100>=z||a>=400?0:Math.floor(Math.max(a,0))};var B={x1:1,x2:0,y1:0,y2:0},C={x1:0,x2:0,y1:1,y2:0},D=j.format("~.1f"),E={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:B},horizontalreversed:{node:"linearGradient",attrs:B,reversed:!0},vertical:{node:"linearGradient",attrs:C},verticalreversed:{node:"linearGradient",attrs:C,reversed:!0}};w.gradient=function(a,b,c,d,e,f){for(var g=e.length,h=E[d],k=new Array(g),m=0;m<g;m++)h.reversed?k[g-1-m]=[D(100*(1-e[m][0])),e[m][1]]:k[m]=[D(100*e[m][0]),e[m][1]];var o="g"+b._fullLayout._uid+"-"+c,q=b._fullLayout._defs.select(".gradients").selectAll("#"+o).data([d+k.join(";")],p.identity);q.exit().remove(),q.enter().append(h.node).each(function(){var a=j.select(this);h.attrs&&a.attr(h.attrs),a.attr("id",o);var b=a.selectAll("stop").data(k);b.exit().remove(),b.enter().append("stop"),b.each(function(a){var b=l(a[1]);j.select(this).attr({offset:a[0]+"%","stop-color":n.tinyRGB(b),"stop-opacity":b.getAlpha()})})}),a.style(f,i(o,b)).style(f+"-opacity",null)},w.initGradients=function(a){p.ensureSingle(a._fullLayout._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove()},w.pointStyle=function(a,b,c){if(a.size()){var d=w.makePointStyleFns(b);a.each(function(a){w.singlePointStyle(a,j.select(this),b,d,c)})}},w.singlePointStyle=function(a,b,c,e,f){var g=c.marker,h=g.line;if(b.style("opacity",e.selectedOpacityFn?e.selectedOpacityFn(a):void 0===a.mo?g.opacity:a.mo),e.ms2mrc){var i;i="various"===a.ms||"various"===g.size?3:e.ms2mrc(a.ms),a.mrc=i,e.selectedSizeFn&&(i=a.mrc=e.selectedSizeFn(a));var j=w.symbolNumber(a.mx||g.symbol)||0;a.om=j%200>=100,b.attr("d",d(j,i))}var k,l,m,o=!1;if(a.so)m=h.outlierwidth,l=h.outliercolor,k=g.outliercolor;else{var q=(h||{}).width;m=(a.mlw+1||q+1||(a.trace?(a.trace.marker.line||{}).width:0)+1)-1||0,l="mlc"in a?a.mlcc=e.lineScale(a.mlc):p.isArrayOrTypedArray(h.color)?n.defaultLine:h.color,p.isArrayOrTypedArray(g.color)&&(k=n.defaultLine,o=!0),k="mc"in a?a.mcc=e.markerScale(a.mc):g.color||"rgba(0,0,0,0)",e.selectedColorFn&&(k=e.selectedColorFn(a))}if(a.om)b.call(n.stroke,k).style({"stroke-width":(m||1)+"px",fill:"none"});else{b.style("stroke-width",(a.isBlank?0:m)+"px");var r=g.gradient,s=a.mgt;if(s?o=!0:s=r&&r.type,Array.isArray(s)&&(s=s[0],E[s]||(s=0)),s&&"none"!==s){var t=a.mgc;t?o=!0:t=r.color;var u=c.uid;o&&(u+="-"+a.i),w.gradient(b,f,u,s,[[0,t],[1,k]],"fill")}else n.fill(b,k);m&&n.stroke(b,l)}},w.makePointStyleFns=function(a){var b={},c=a.marker;return b.markerScale=w.tryColorscale(c,""),b.lineScale=w.tryColorscale(c,"line"),m.traceIs(a,"symbols")&&(b.ms2mrc=u.isBubble(a)?v(a):function(){return(c.size||6)/2}),a.selectedpoints&&p.extendFlat(b,w.makeSelectedPointStyleFns(a)),b},w.makeSelectedPointStyleFns=function(a){var b={},c=a.selected||{},d=a.unselected||{},e=a.marker||{},f=c.marker||{},g=d.marker||{},h=e.opacity,i=f.opacity,j=g.opacity,k=void 0!==i,l=void 0!==j;(p.isArrayOrTypedArray(h)||k||l)&&(b.selectedOpacityFn=function(a){var b=void 0===a.mo?e.opacity:a.mo;return a.selected?k?i:b:l?j:t*b});var n=e.color,o=f.color,q=g.color;(o||q)&&(b.selectedColorFn=function(a){var b=a.mcc||n;return a.selected?o||b:q||b});var r=e.size,s=f.size,u=g.size,v=void 0!==s,w=void 0!==u;return m.traceIs(a,"symbols")&&(v||w)&&(b.selectedSizeFn=function(a){var b=a.mrc||r/2;return a.selected?v?s/2:b:w?u/2:b}),b},w.makeSelectedTextStyleFns=function(a){var b={},c=a.selected||{},d=a.unselected||{},e=a.textfont||{},f=c.textfont||{},g=d.textfont||{},h=e.color,i=f.color,j=g.color;return b.selectedTextColorFn=function(a){var b=a.tc||h;return a.selected?i||b:j||(i?b:n.addOpacity(b,t))},b},w.selectedPointStyle=function(a,b){if(a.size()&&b.selectedpoints){var c=w.makeSelectedPointStyleFns(b),e=b.marker||{},f=[];c.selectedOpacityFn&&f.push(function(a,b){a.style("opacity",c.selectedOpacityFn(b))}),c.selectedColorFn&&f.push(function(a,b){n.fill(a,c.selectedColorFn(b))}),c.selectedSizeFn&&f.push(function(a,b){var f=b.mx||e.symbol||0,g=c.selectedSizeFn(b);a.attr("d",d(w.symbolNumber(f),g)),b.mrc2=g}),f.length&&a.each(function(a){for(var b=j.select(this),c=0;c<f.length;c++)f[c](b,a)})}},w.tryColorscale=function(a,b){var c=b?p.nestedProperty(a,b).get():a;if(c){var d=c.color;if((c.colorscale||c._colorAx)&&p.isArrayOrTypedArray(d))return o.makeColorScaleFuncFromTrace(c)}return p.identity};var F={start:1,end:-1,middle:0,bottom:1,top:-1};w.textPointStyle=function(a,b,c,d){if(a.size()){var g;if(b.selectedpoints){var h=w.makeSelectedTextStyleFns(b);g=h.selectedTextColorFn}var i=b.texttemplate;d&&(i=!1),a.each(function(a){var d=j.select(this),h=p.extractOption(a,b,i?"txt":"tx",i?"texttemplate":"text");if(h||0===h){if(i){var k={};x(k,b,a.i),h=p.texttemplateString(h,{},c._fullLayout._d3locale,k,a,b._meta||{})}var l=a.tp||b.textposition,m=f(a,b),n=g?g(a):a.tc||b.textfont.color;d.call(w.font,a.tf||b.textfont.family,m,n).text(h).call(q.convertToTspans,c).call(e,l,m,a.mrc)}else d.remove()})}},w.selectedTextStyle=function(a,b){if(a.size()&&b.selectedpoints){var c=w.makeSelectedTextStyleFns(b);a.each(function(a){var d=j.select(this),g=c.selectedTextColorFn(a),h=a.tp||b.textposition,i=f(a,b);n.fill(d,g),e(d,h,i,a.mrc2||a.mrc)})}};var G=.5;w.smoothopen=function(a,b){if(a.length<3)return"M"+a.join("L");var c,d="M"+a[0],e=[];for(c=1;c<a.length-1;c++)e.push(g(a[c-1],a[c],a[c+1],b));for(d+="Q"+e[0][0]+" "+a[1],c=2;c<a.length-1;c++)d+="C"+e[c-2][1]+" "+e[c-1][0]+" "+a[c];return d+="Q"+e[a.length-3][1]+" "+a[a.length-1]},w.smoothclosed=function(a,b){if(a.length<3)return"M"+a.join("L")+"Z";var c,d="M"+a[0],e=a.length-1,f=[g(a[e],a[0],a[1],b)];for(c=1;c<e;c++)f.push(g(a[c-1],a[c],a[c+1],b));for(f.push(g(a[e-1],a[e],a[0],b)),c=1;c<=e;c++)d+="C"+f[c-1][1]+" "+f[c][0]+" "+a[c];return d+="C"+f[e][1]+" "+f[0][0]+" "+a[0]+"Z"};var H={hv:function(a,b){return"H"+j.round(b[0],2)+"V"+j.round(b[1],2)},vh:function(a,b){return"V"+j.round(b[1],2)+"H"+j.round(b[0],2)},hvh:function(a,b){return"H"+j.round((a[0]+b[0])/2,2)+"V"+j.round(b[1],2)+"H"+j.round(b[0],2)},vhv:function(a,b){return"V"+j.round((a[1]+b[1])/2,2)+"H"+j.round(b[0],2)+"V"+j.round(b[1],2)}},I=function(a,b){return"L"+j.round(b[0],2)+","+j.round(b[1],2)};w.steps=function(a){var b=H[a]||I;return function(a){for(var c="M"+j.round(a[0][0],2)+","+j.round(a[0][1],2),d=1;d<a.length;d++)c+=b(a[d-1],a[d]);return c}},w.makeTester=function(){var a=p.ensureSingleById(j.select("body"),"svg","js-plotly-tester",function(a){a.attr(r.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),b=p.ensureSingle(a,"path","js-reference-point",function(a){a.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});w.tester=a,w.testref=b},w.savedBBoxes={};var J=0;w.bBox=function(a,b,c){var d,e,f;if(c||(c=h(a)),c){if(d=w.savedBBoxes[c])return p.extendFlat({},d)}else if(1===a.childNodes.length){var g=a.childNodes[0];if(c=h(g)){var i=+g.getAttribute("x")||0,k=+g.getAttribute("y")||0,l=g.getAttribute("transform");if(!l){var m=w.bBox(g,!1,c);return i&&(m.left+=i,m.right+=i),k&&(m.top+=k,m.bottom+=k),m}if(c+="~"+i+"~"+k+"~"+l,d=w.savedBBoxes[c])return p.extendFlat({},d)}}b?e=a:(f=w.tester.node(),e=a.cloneNode(!0),f.appendChild(e)),j.select(e).attr("transform",null).call(q.positionText,0,0);var n=e.getBoundingClientRect(),o=w.testref.node().getBoundingClientRect();b||f.removeChild(e);var r={height:n.height,width:n.width,left:n.left-o.left,top:n.top-o.top,right:n.right-o.left,bottom:n.bottom-o.top};return J>=1e4&&(w.savedBBoxes={},J=0),c&&(w.savedBBoxes[c]=r),J++,p.extendFlat({},r)},w.setClipUrl=function(a,b,c){a.attr("clip-path",i(b,c))},w.getTranslate=function(a){var b=(a[a.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(a,b,c){return[b,c].join(" ")}).split(" ");return{x:+b[0]||0,y:+b[1]||0}},w.setTranslate=function(a,b,c){var d=a.attr?"attr":"getAttribute",e=a.attr?"attr":"setAttribute",f=a[d]("transform")||"";return b=b||0,c=c||0,f=f.replace(/(\btranslate\(.*?\);?)/,"").trim(),f=(f+=" translate("+b+", "+c+")").trim(),a[e]("transform",f),f},w.getScale=function(a){var b=(a[a.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(a,b,c){return[b,c].join(" ")}).split(" ");return{x:+b[0]||1,y:+b[1]||1}},w.setScale=function(a,b,c){var d=a.attr?"attr":"getAttribute",e=a.attr?"attr":"setAttribute",f=a[d]("transform")||"";return b=b||1,c=c||1,f=f.replace(/(\bscale\(.*?\);?)/,"").trim(),f=(f+=" scale("+b+", "+c+")").trim(),a[e]("transform",f),f};var K=/\s*sc.*/;w.setPointGroupScale=function(a,b,c){if(b=b||1,c=c||1,a){var d=1===b&&1===c?"":" scale("+b+","+c+")";a.each(function(){var a=(this.getAttribute("transform")||"").replace(K,"");a=(a+=d).trim(),this.setAttribute("transform",a)})}};var L=/translate\([^)]*\)\s*$/;w.setTextPointsScale=function(a,b,c){a&&a.each(function(){var a,d=j.select(this),e=d.select("text");if(e.node()){var f=parseFloat(e.attr("x")||0),g=parseFloat(e.attr("y")||0),h=(d.attr("transform")||"").match(L);a=1===b&&1===c?[]:["translate("+f+","+g+")","scale("+b+","+c+")","translate("+-f+","+-g+")"],h&&a.push(h),d.attr("transform",a.join(" "))}})}},{"../../constants/alignment":688,"../../constants/interactions":694,"../../constants/xmlns_namespaces":696,"../../lib":719,"../../lib/svg_text_utils":743,"../../registry":848,"../../traces/scatter/make_bubble_size_func":1127,"../../traces/scatter/subtypes":1134,"../color":594,"../colorscale":606,"../fx/helpers":629,"./symbol_defs":616,d3:164,"fast-isnumeric":226,tinycolor2:538}],616:[function(a,b,c){"use strict";var d=a("d3");b.exports={circle:{n:0,f:function(a){var b=d.round(a,2);return"M"+b+",0A"+b+","+b+" 0 1,1 0,-"+b+"A"+b+","+b+" 0 0,1 "+b+",0Z"}},square:{n:1,f:function(a){var b=d.round(a,2);return"M"+b+","+b+"H-"+b+"V-"+b+"H"+b+"Z"}},diamond:{n:2,f:function(a){var b=d.round(1.3*a,2);return"M"+b+",0L0,"+b+"L-"+b+",0L0,-"+b+"Z"}},cross:{n:3,f:function(a){var b=d.round(.4*a,2),c=d.round(1.2*a,2);return"M"+c+","+b+"H"+b+"V"+c+"H-"+b+"V"+b+"H-"+c+"V-"+b+"H-"+b+"V-"+c+"H"+b+"V-"+b+"H"+c+"Z"}},x:{n:4,f:function(a){var b=d.round(.8*a/Math.sqrt(2),2),c="l"+b+","+b,e="l"+b+",-"+b,f="l-"+b+",-"+b,g="l-"+b+","+b;return"M0,"+b+c+e+f+e+f+g+f+g+c+g+c+"Z"}},"triangle-up":{n:5,f:function(a){var b=d.round(2*a/Math.sqrt(3),2);return"M-"+b+","+d.round(a/2,2)+"H"+b+"L0,-"+d.round(a,2)+"Z"}},"triangle-down":{n:6,f:function(a){var b=d.round(2*a/Math.sqrt(3),2);return"M-"+b+",-"+d.round(a/2,2)+"H"+b+"L0,"+d.round(a,2)+"Z"}},"triangle-left":{n:7,f:function(a){var b=d.round(2*a/Math.sqrt(3),2);return"M"+d.round(a/2,2)+",-"+b+"V"+b+"L-"+d.round(a,2)+",0Z"}},"triangle-right":{n:8,f:function(a){var b=d.round(2*a/Math.sqrt(3),2);return"M-"+d.round(a/2,2)+",-"+b+"V"+b+"L"+d.round(a,2)+",0Z"}},"triangle-ne":{n:9,f:function(a){var b=d.round(.6*a,2),c=d.round(1.2*a,2);return"M-"+c+",-"+b+"H"+b+"V"+c+"Z"}},"triangle-se":{n:10,f:function(a){var b=d.round(.6*a,2),c=d.round(1.2*a,2);return"M"+b+",-"+c+"V"+b+"H-"+c+"Z"}},"triangle-sw":{n:11,f:function(a){var b=d.round(.6*a,2),c=d.round(1.2*a,2);return"M"+c+","+b+"H-"+b+"V-"+c+"Z"}},"triangle-nw":{n:12,f:function(a){var b=d.round(.6*a,2),c=d.round(1.2*a,2);return"M-"+b+","+c+"V-"+b+"H"+c+"Z"}},pentagon:{n:13,f:function(a){var b=d.round(.951*a,2),c=d.round(.588*a,2),e=d.round(-a,2),f=d.round(-.309*a,2);return"M"+b+","+f+"L"+c+","+d.round(.809*a,2)+"H-"+c+"L-"+b+","+f+"L0,"+e+"Z"}},hexagon:{n:14,f:function(a){var b=d.round(a,2),c=d.round(a/2,2),e=d.round(a*Math.sqrt(3)/2,2);return"M"+e+",-"+c+"V"+c+"L0,"+b+"L-"+e+","+c+"V-"+c+"L0,-"+b+"Z"}},hexagon2:{n:15,f:function(a){var b=d.round(a,2),c=d.round(a/2,2),e=d.round(a*Math.sqrt(3)/2,2);return"M-"+c+","+e+"H"+c+"L"+b+",0L"+c+",-"+e+"H-"+c+"L-"+b+",0Z"}},octagon:{n:16,f:function(a){var b=d.round(.924*a,2),c=d.round(.383*a,2);return"M-"+c+",-"+b+"H"+c+"L"+b+",-"+c+"V"+c+"L"+c+","+b+"H-"+c+"L-"+b+","+c+"V-"+c+"Z"}},star:{n:17,f:function(a){var b=1.4*a,c=d.round(.225*b,2),e=d.round(.951*b,2),f=d.round(.363*b,2),g=d.round(.588*b,2),h=d.round(-b,2),i=d.round(-.309*b,2),j=d.round(.118*b,2),k=d.round(.809*b,2);return"M"+c+","+i+"H"+e+"L"+f+","+j+"L"+g+","+k+"L0,"+d.round(.382*b,2)+"L-"+g+","+k+"L-"+f+","+j+"L-"+e+","+i+"H-"+c+"L0,"+h+"Z"}},hexagram:{n:18,f:function(a){var b=d.round(.66*a,2),c=d.round(.38*a,2),e=d.round(.76*a,2);return"M-"+e+",0l-"+c+",-"+b+"h"+e+"l"+c+",-"+b+"l"+c+","+b+"h"+e+"l-"+c+","+b+"l"+c+","+b+"h-"+e+"l-"+c+","+b+"l-"+c+",-"+b+"h-"+e+"Z"}},"star-triangle-up":{n:19,f:function(a){var b=d.round(a*Math.sqrt(3)*.8,2),c=d.round(.8*a,2),e=d.round(1.6*a,2),f=d.round(4*a,2),g="A "+f+","+f+" 0 0 1 ";return"M-"+b+","+c+g+b+","+c+g+"0,-"+e+g+"-"+b+","+c+"Z"}},"star-triangle-down":{n:20,f:function(a){var b=d.round(a*Math.sqrt(3)*.8,2),c=d.round(.8*a,2),e=d.round(1.6*a,2),f=d.round(4*a,2),g="A "+f+","+f+" 0 0 1 ";return"M"+b+",-"+c+g+"-"+b+",-"+c+g+"0,"+e+g+b+",-"+c+"Z"}},"star-square":{n:21,f:function(a){var b=d.round(1.1*a,2),c=d.round(2*a,2),e="A "+c+","+c+" 0 0 1 ";return"M-"+b+",-"+b+e+"-"+b+","+b+e+b+","+b+e+b+",-"+b+e+"-"+b+",-"+b+"Z"}},"star-diamond":{n:22,f:function(a){var b=d.round(1.4*a,2),c=d.round(1.9*a,2),e="A "+c+","+c+" 0 0 1 ";return"M-"+b+",0"+e+"0,"+b+e+b+",0"+e+"0,-"+b+e+"-"+b+",0Z"}},"diamond-tall":{n:23,f:function(a){var b=d.round(.7*a,2),c=d.round(1.4*a,2);return"M0,"+c+"L"+b+",0L0,-"+c+"L-"+b+",0Z"}},"diamond-wide":{n:24,f:function(a){var b=d.round(1.4*a,2),c=d.round(.7*a,2);return"M0,"+c+"L"+b+",0L0,-"+c+"L-"+b+",0Z"}},hourglass:{n:25,f:function(a){var b=d.round(a,2);return"M"+b+","+b+"H-"+b+"L"+b+",-"+b+"H-"+b+"Z"},noDot:!0},bowtie:{n:26,f:function(a){var b=d.round(a,2);return"M"+b+","+b+"V-"+b+"L-"+b+","+b+"V-"+b+"Z"},noDot:!0},"circle-cross":{n:27,f:function(a){var b=d.round(a,2);return"M0,"+b+"V-"+b+"M"+b+",0H-"+b+"M"+b+",0A"+b+","+b+" 0 1,1 0,-"+b+"A"+b+","+b+" 0 0,1 "+b+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(a){var b=d.round(a,2),c=d.round(a/Math.sqrt(2),2);return"M"+c+","+c+"L-"+c+",-"+c+"M"+c+",-"+c+"L-"+c+","+c+"M"+b+",0A"+b+","+b+" 0 1,1 0,-"+b+"A"+b+","+b+" 0 0,1 "+b+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(a){var b=d.round(a,2);return"M0,"+b+"V-"+b+"M"+b+",0H-"+b+"M"+b+","+b+"H-"+b+"V-"+b+"H"+b+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(a){var b=d.round(a,2);return"M"+b+","+b+"L-"+b+",-"+b+"M"+b+",-"+b+"L-"+b+","+b+"M"+b+","+b+"H-"+b+"V-"+b+"H"+b+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(a){var b=d.round(1.3*a,2);return"M"+b+",0L0,"+b+"L-"+b+",0L0,-"+b+"ZM0,-"+b+"V"+b+"M-"+b+",0H"+b},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(a){var b=d.round(1.3*a,2),c=d.round(.65*a,2);return"M"+b+",0L0,"+b+"L-"+b+",0L0,-"+b+"ZM-"+c+",-"+c+"L"+c+","+c+"M-"+c+","+c+"L"+c+",-"+c},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(a){var b=d.round(1.4*a,2);return"M0,"+b+"V-"+b+"M"+b+",0H-"+b},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(a){var b=d.round(a,2);return"M"+b+","+b+"L-"+b+",-"+b+"M"+b+",-"+b+"L-"+b+","+b},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(a){var b=d.round(1.2*a,2),c=d.round(.85*a,2);return"M0,"+b+"V-"+b+"M"+b+",0H-"+b+"M"+c+","+c+"L-"+c+",-"+c+"M"+c+",-"+c+"L-"+c+","+c},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(a){var b=d.round(a/2,2),c=d.round(a,2);return"M"+b+","+c+"V-"+c+"m-"+c+",0V"+c+"M"+c+","+b+"H-"+c+"m0,-"+c+"H"+c},needLine:!0,noFill:!0},"y-up":{n:37,f:function(a){var b=d.round(1.2*a,2),c=d.round(1.6*a,2),e=d.round(.8*a,2);return"M-"+b+","+e+"L0,0M"+b+","+e+"L0,0M0,-"+c+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(a){var b=d.round(1.2*a,2),c=d.round(1.6*a,2),e=d.round(.8*a,2);return"M-"+b+",-"+e+"L0,0M"+b+",-"+e+"L0,0M0,"+c+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(a){var b=d.round(1.2*a,2),c=d.round(1.6*a,2),e=d.round(.8*a,2);return"M"+e+","+b+"L0,0M"+e+",-"+b+"L0,0M-"+c+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(a){var b=d.round(1.2*a,2),c=d.round(1.6*a,2),e=d.round(.8*a,2);return"M-"+e+","+b+"L0,0M-"+e+",-"+b+"L0,0M"+c+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(a){var b=d.round(1.4*a,2);return"M"+b+",0H-"+b},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(a){var b=d.round(1.4*a,2);return"M0,"+b+"V-"+b},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(a){var b=d.round(a,2);return"M"+b+",-"+b+"L-"+b+","+b},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(a){var b=d.round(a,2);return"M"+b+","+b+"L-"+b+",-"+b},needLine:!0,noDot:!0,noFill:!0}}},{d3:164}],617:[function(a,b,c){"use strict";b.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],618:[function(a,b,c){"use strict";function d(a,b,c,d){var f=b["error_"+d]||{},j=[];if(f.visible&&-1!==["linear","log"].indexOf(c.type)){for(var k=i(f),l=0;l<a.length;l++){var m=a[l],n=m.i;if(void 0===n)n=l;else if(null===n)continue;var o=m[d];if(e(c.c2l(o))){var p=k(o,n);if(e(p[0])&&e(p[1])){var q=m[d+"s"]=o-p[0],r=m[d+"h"]=o+p[1];j.push(q,r)}}}var s=c._id,t=b._extremes[s],u=g.findExtremes(c,j,h.extendFlat({tozero:t.opts.tozero},{padded:!0}));t.min=t.min.concat(u.min),t.max=t.max.concat(u.max)}}var e=a("fast-isnumeric"),f=a("../../registry"),g=a("../../plots/cartesian/axes"),h=a("../../lib"),i=a("./compute_error");b.exports=function(a){for(var b=a.calcdata,c=0;c<b.length;c++){var e=b[c],h=e[0].trace;if(!0===h.visible&&f.traceIs(h,"errorBarsOK")){var i=g.getFromId(a,h.xaxis),j=g.getFromId(a,h.yaxis);d(e,h,i,"x"),d(e,h,j,"y")}}}},{"../../lib":719,"../../plots/cartesian/axes":767,"../../registry":848,"./compute_error":619,"fast-isnumeric":226}],619:[function(a,b,c){"use strict";function d(a,b){return"percent"===a?function(a){return Math.abs(a*b/100)}:"constant"===a?function(){return Math.abs(b)}:"sqrt"===a?function(a){return Math.sqrt(Math.abs(a))}:void 0}b.exports=function(a){var b=a.type,c=a.symmetric;if("data"===b){var e=a.array||[];if(c)return function(a,b){var c=+e[b];return[c,c]};var f=a.arrayminus||[];return function(a,b){var c=+e[b],d=+f[b];return isNaN(c)&&isNaN(d)?[NaN,NaN]:[d||0,c||0]}}var g=d(b,a.value),h=d(b,a.valueminus);return c||void 0===a.valueminus?function(a){var b=g(a);return[b,b]}:function(a){return[h(a),g(a)]}}},{}],620:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../registry"),f=a("../../lib"),g=a("../../plot_api/plot_template"),h=a("./attributes");b.exports=function(a,b,c,i){function j(a,b){return f.coerce(m,l,h,a,b)}var k="error_"+i.axis,l=g.newContainer(b,k),m=a[k]||{};if(!1!==j("visible",void 0!==m.array||void 0!==m.value||"sqrt"===m.type)){var n=j("type","array"in m?"data":"percent"),o=!0;"sqrt"!==n&&(o=j("symmetric",!(("data"===n?"arrayminus":"valueminus")in m))),"data"===n?(j("array"),j("traceref"),o||(j("arrayminus"),j("tracerefminus"))):"percent"!==n&&"constant"!==n||(j("value"),o||j("valueminus"));var p="copy_"+i.inherit+"style";i.inherit&&(b["error_"+i.inherit]||{}).visible&&j(p,!(m.color||d(m.thickness)||d(m.width))),i.inherit&&l[p]||(j("color",c),j("thickness"),j("width",e.traceIs(b,"gl3d")?0:4))}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../registry":848,"./attributes":617,"fast-isnumeric":226}],621:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plot_api/edit_types").overrideAll,f=a("./attributes"),g={error_x:d.extendFlat({},f),error_y:d.extendFlat({},f)};delete g.error_x.copy_zstyle,delete g.error_y.copy_zstyle,delete g.error_y.copy_ystyle;var h={error_x:d.extendFlat({},f),error_y:d.extendFlat({},f),error_z:d.extendFlat({},f)};delete h.error_x.copy_ystyle,delete h.error_y.copy_ystyle,delete h.error_z.copy_ystyle,delete h.error_z.copy_zstyle,b.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:g,bar:g,histogram:g,scatter3d:e(h,"calc","nested"),scattergl:e(g,"calc","nested")}},supplyDefaults:a("./defaults"),calc:a("./calc"),makeComputeError:a("./compute_error"),plot:a("./plot"),style:a("./style"),hoverInfo:function(a,b,c){(b.error_y||{}).visible&&(c.yerr=a.yh-a.y,b.error_y.symmetric||(c.yerrneg=a.y-a.ys)),(b.error_x||{}).visible&&(c.xerr=a.xh-a.x,b.error_x.symmetric||(c.xerrneg=a.x-a.xs))}}},{"../../lib":719,"../../plot_api/edit_types":750,"./attributes":617,"./calc":618,"./compute_error":619,"./defaults":620,"./plot":622,"./style":623}],622:[function(a,b,c){"use strict";var d=a("d3"),e=a("fast-isnumeric"),f=a("../drawing"),g=a("../../traces/scatter/subtypes");b.exports=function(a,b,c,h){var i=c.xaxis,j=c.yaxis,k=h&&h.duration>0;b.each(function(b){var l,m=b[0].trace,n=m.error_x||{},o=m.error_y||{};m.ids&&(l=function(a){return a.id});var p=g.hasMarkers(m)&&m.marker.maxdisplayed>0;o.visible||n.visible||(b=[]);var q=d.select(this).selectAll("g.errorbar").data(b,l);if(q.exit().remove(),b.length){n.visible||q.selectAll("path.xerror").remove(),o.visible||q.selectAll("path.yerror").remove(),q.style("opacity",1);var r=q.enter().append("g").classed("errorbar",!0);k&&r.style("opacity",0).transition().duration(h.duration).style("opacity",1),f.setClipUrl(q,c.layerClipId,a),q.each(function(a){var b=d.select(this),c=function(a,b,c){var d={x:b.c2p(a.x),y:c.c2p(a.y)};return void 0!==a.yh&&(d.yh=c.c2p(a.yh),d.ys=c.c2p(a.ys),e(d.ys)||(d.noYS=!0,d.ys=c.c2p(a.ys,!0))),void 0!==a.xh&&(d.xh=b.c2p(a.xh),d.xs=b.c2p(a.xs),e(d.xs)||(d.noXS=!0,d.xs=b.c2p(a.xs,!0))),d}(a,i,j);if(!p||a.vis){var f,g=b.select("path.yerror");if(o.visible&&e(c.x)&&e(c.yh)&&e(c.ys)){var l=o.width;f="M"+(c.x-l)+","+c.yh+"h"+2*l+"m-"+l+",0V"+c.ys,c.noYS||(f+="m-"+l+",0h"+2*l),g.size()?k&&(g=g.transition().duration(h.duration).ease(h.easing)):g=b.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),g.attr("d",f)}else g.remove();var m=b.select("path.xerror");if(n.visible&&e(c.y)&&e(c.xh)&&e(c.xs)){var q=(n.copy_ystyle?o:n).width;f="M"+c.xh+","+(c.y-q)+"v"+2*q+"m0,-"+q+"H"+c.xs,c.noXS||(f+="m0,-"+q+"v"+2*q),m.size()?k&&(m=m.transition().duration(h.duration).ease(h.easing)):m=b.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),m.attr("d",f)}else m.remove()}})}})}},{"../../traces/scatter/subtypes":1134,"../drawing":615,d3:164,"fast-isnumeric":226}],623:[function(a,b,c){"use strict";var d=a("d3"),e=a("../color");b.exports=function(a){a.each(function(a){var b=a[0].trace,c=b.error_y||{},f=b.error_x||{},g=d.select(this);g.selectAll("path.yerror").style("stroke-width",c.thickness+"px").call(e.stroke,c.color),f.copy_ystyle&&(f=c),g.selectAll("path.xerror").style("stroke-width",f.thickness+"px").call(e.stroke,f.color)})}},{"../color":594,d3:164}],624:[function(a,b,c){"use strict";var d=a("../../plots/font_attributes"),e=a("./layout_attributes").hoverlabel,f=a("../../lib/extend").extendFlat;b.exports={hoverlabel:{bgcolor:f({},e.bgcolor,{arrayOk:!0}),bordercolor:f({},e.bordercolor,{arrayOk:!0}),font:d({arrayOk:!0,editType:"none"}),align:f({},e.align,{arrayOk:!0}),namelength:f({},e.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":710,"../../plots/font_attributes":793,"./layout_attributes":633}],625:[function(a,b,c){"use strict";function d(a,b,c,d){d=d||e.identity,Array.isArray(a)&&(b[0][c]=d(a))}var e=a("../../lib"),f=a("../../registry");b.exports=function(a){for(var b=a.calcdata,c=a._fullLayout,g=0;g<b.length;g++){var h=b[g],i=h[0].trace;if(!f.traceIs(i,"pie-like")){var j=f.traceIs(i,"2dMap")?d:e.fillArray;j(i.hoverinfo,h,"hi",function(a){return function(b){return e.coerceHoverinfo({hoverinfo:b},{_module:a._module},c)}}(i)),i.hovertemplate&&j(i.hovertemplate,h,"ht"),i.hoverlabel&&(j(i.hoverlabel.bgcolor,h,"hbg"),j(i.hoverlabel.bordercolor,h,"hbc"),j(i.hoverlabel.font.size,h,"hts"),j(i.hoverlabel.font.color,h,"htc"),j(i.hoverlabel.font.family,h,"htf"),j(i.hoverlabel.namelength,h,"hnl"),j(i.hoverlabel.align,h,"hta"))}}}},{"../../lib":719,"../../registry":848}],626:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("./hover").hover;b.exports=function(a,b,c){function f(){a.emit("plotly_click",{points:a._hoverdata,event:b})}var g=d.getComponentMethod("annotations","onClick")(a,a._hoverdata);void 0!==c&&e(a,b,c,!0),a._hoverdata&&b&&b.target&&(g&&g.then?g.then(f):f(),b.stopImmediatePropagation&&b.stopImmediatePropagation())}},{"../../registry":848,"./hover":630}],627:[function(a,b,c){"use strict";b.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],628:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("./hoverlabel_defaults");b.exports=function(a,b,c,g){var h=d.extendFlat({},g.hoverlabel);b.hovertemplate&&(h.namelength=-1),f(a,b,function(c,f){return d.coerce(a,b,e,c,f)},h)}},{"../../lib":719,"./attributes":624,"./hoverlabel_defaults":631}],629:[function(a,b,c){"use strict";function d(a){return g[a]||a}function e(a,b){return Array.isArray(b)?Array.isArray(a)&&Array.isArray(a[b[0]])?a[b[0]][b[1]]:void 0:a[b]}var f=a("../../lib");c.getSubplot=function(a){return a.subplot||a.xaxis+a.yaxis||a.geo},c.isTraceInSubplots=function(a,b){if("splom"===a.type){for(var d=a.xaxes||[],e=a.yaxes||[],f=0;f<d.length;f++)for(var g=0;g<e.length;g++)if(-1!==b.indexOf(d[f]+e[g]))return!0;return!1}return-1!==b.indexOf(c.getSubplot(a))},c.flat=function(a,b){for(var c=new Array(a.length),d=0;d<a.length;d++)c[d]=b;return c},c.p2c=function(a,b){for(var c=new Array(a.length),d=0;d<a.length;d++)c[d]=a[d].p2c(b);return c},c.getDistanceFunction=function(a,b,d,e){return"closest"===a?e||c.quadrature(b,d):"x"===a?b:d},c.getClosest=function(a,b,c){if(!1!==c.index)c.index>=0&&c.index<a.length?c.distance=0:c.index=!1;else for(var d=0;d<a.length;d++){var e=b(a[d]);e<=c.distance&&(c.index=d,c.distance=e)}return c},c.inbox=function(a,b,c){return a*b<0||0===a?c:1/0},c.quadrature=function(a,b){return function(c){var d=a(c),e=b(c);return Math.sqrt(d*d+e*e)}},c.makeEventData=function(a,b,d){var e="index"in a?a.index:a.pointNumber,f={data:b._input,fullData:b,curveNumber:b.index,pointNumber:e};if(b._indexToPoints){var g=b._indexToPoints[e];1===g.length?f.pointIndex=g[0]:f.pointIndices=g}else f.pointIndex=e;return b._module.eventData?f=b._module.eventData(f,a,b,d,e):("xVal"in a?f.x=a.xVal:"x"in a&&(f.x=a.x),"yVal"in a?f.y=a.yVal:"y"in a&&(f.y=a.y),a.xa&&(f.xaxis=a.xa),a.ya&&(f.yaxis=a.ya),void 0!==a.zLabelVal&&(f.z=a.zLabelVal)),c.appendArrayPointValue(f,b,e),f},c.appendArrayPointValue=function(a,b,c){var g=b._arrayAttrs;if(g)for(var h=0;h<g.length;h++){var i=g[h],j=d(i);if(void 0===a[j]){var k=e(f.nestedProperty(b,i).get(),c);void 0!==k&&(a[j]=k)}}},c.appendArrayMultiPointValues=function(a,b,c){var g=b._arrayAttrs;if(g)for(var h=0;h<g.length;h++){var i=g[h],j=d(i);if(void 0===a[j]){for(var k=f.nestedProperty(b,i).get(),l=new Array(c.length),m=0;m<c.length;m++)l[m]=e(k,c[m]);a[j]=l}}};var g={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"}},{"../../lib":719}],630:[function(a,b,c){"use strict";function d(a,b,c){var d=c._fullLayout,e=b.hovermode,f=b.rotateLabels,g=b.bgColor,h=b.container,k=b.outerContainer,l=b.commonLabelOpts||{},n=b.fontFamily||w.HOVERFONT,p=b.fontSize||w.HOVERFONTSIZE,s=a[0],t=s.xa,u=s.ya,v="y"===e?"yLabel":"xLabel",y=s[v],z=(String(y)||"").split(" ")[0],A=k.node().getBoundingClientRect(),B=A.top,F=A.width,G=A.height,H=void 0!==y&&s.distance<=b.hoverdistance&&("x"===e||"y"===e);if(H){var I,J,K=!0;for(I=0;I<a.length;I++)if(K&&void 0===a[I].zLabel&&(K=!1),J=a[I].hoverinfo||a[I].trace.hoverinfo){var L=Array.isArray(J)?J:J.split("+");if(-1===L.indexOf("all")&&-1===L.indexOf(e)){H=!1;break}}K&&(H=!1)}var M=h.selectAll("g.axistext").data(H?[0]:[]);M.enter().append("g").classed("axistext",!0),M.exit().remove(),M.each(function(){var b=j.select(this),d=m.ensureSingle(b,"path","",function(a){a.style({"stroke-width":"1px"})}),f=m.ensureSingle(b,"text","",function(a){a.attr("data-notex",1)}),g=l.bgcolor||r.defaultLine,h=l.bordercolor||r.contrast(g),i=r.contrast(g);d.style({fill:g,stroke:h}),f.text(y).call(q.font,l.font.family||n,l.font.size||p,l.font.color||i).call(o.positionText,0,0).call(o.convertToTspans,c),b.attr("transform","");var k=f.node().getBoundingClientRect();if("x"===e){f.attr("text-anchor","middle").call(o.positionText,0,"top"===t.side?B-k.bottom-C-D:B-k.top+C+D);var w="top"===t.side?"-":"";d.attr("d","M0,0L"+C+","+w+C+"H"+(D+k.width/2)+"v"+w+(2*D+k.height)+"H-"+(D+k.width/2)+"V"+w+C+"H-"+C+"Z"),b.attr("transform","translate("+(t._offset+(s.x0+s.x1)/2)+","+(u._offset+("top"===t.side?0:u._length))+")")}else{f.attr("text-anchor","right"===u.side?"start":"end").call(o.positionText,("right"===u.side?1:-1)*(D+C),B-k.top-k.height/2);var x="right"===u.side?"":"-";d.attr("d","M0,0L"+x+C+","+C+"V"+(D+k.height/2)+"h"+x+(2*D+k.width)+"V-"+(D+k.height/2)+"H"+x+C+"V-"+C+"Z"),b.attr("transform","translate("+(t._offset+("right"===u.side?t._length:0))+","+(u._offset+(s.y0+s.y1)/2)+")")}a=a.filter(function(a){return void 0!==a.zLabelVal||(a[v]||"").split(" ")[0]===z})})
;var N=h.selectAll("g.hovertext").data(a,function(a){return[a.trace.index,a.index,a.x0,a.y0,a.name,a.attr,a.xa,a.ya||""].join(",")});return N.enter().append("g").classed("hovertext",!0).each(function(){var a=j.select(this);a.append("rect").call(r.fill,r.addOpacity(g,.8)),a.append("text").classed("name",!0),a.append("path").style("stroke-width","1px"),a.append("text").classed("nums",!0).call(q.font,n,p)}),N.exit().remove(),N.each(function(a){var b=j.select(this).attr("transform",""),h="",k="",l=a.bgcolor||a.color,s=r.combine(r.opacity(l)?l:r.defaultLine,g),t=r.combine(r.opacity(a.color)?a.color:r.defaultLine,g),u=a.borderColor||r.contrast(s);void 0!==a.nameOverride&&(a.name=a.nameOverride),a.name&&(a.trace._meta&&(a.name=m.templateString(a.name,a.trace._meta)),h=i(a.name,a.nameLength)),void 0!==a.zLabel?(void 0!==a.xLabel&&(k+="x: "+a.xLabel+"<br>"),void 0!==a.yLabel&&(k+="y: "+a.yLabel+"<br>"),"choropleth"!==a.trace.type&&"choroplethmapbox"!==a.trace.type&&(k+=(k?"z: ":"")+a.zLabel)):H&&a[e+"Label"]===y?k=a[("x"===e?"y":"x")+"Label"]||"":void 0===a.xLabel?void 0!==a.yLabel&&"scattercarpet"!==a.trace.type&&(k=a.yLabel):k=void 0===a.yLabel?a.xLabel:"("+a.xLabel+", "+a.yLabel+")",!a.text&&0!==a.text||Array.isArray(a.text)||(k+=(k?"<br>":"")+a.text),void 0!==a.extraText&&(k+=(k?"<br>":"")+a.extraText),""!==k||a.hovertemplate||(""===h&&b.remove(),k=h);var v=d._d3locale,w=a.hovertemplate||!1,z=a.hovertemplateLabels||a,A=a.eventData[0]||{};w&&(k=(k=m.hovertemplateString(w,z,v,A,a.trace._meta)).replace(E,function(b,c){return h=i(c,a.nameLength),""}));var I=b.select("text.nums").call(q.font,a.fontFamily||n,a.fontSize||p,a.fontColor||u).text(k).attr("data-notex",1).call(o.positionText,0,0).call(o.convertToTspans,c),J=b.select("text.name"),K=0,L=0;if(h&&h!==k){J.call(q.font,a.fontFamily||n,a.fontSize||p,t).text(h).attr("data-notex",1).call(o.positionText,0,0).call(o.convertToTspans,c);var M=J.node().getBoundingClientRect();K=M.width+2*D,L=M.height+2*D}else J.remove(),b.select("rect").remove();b.select("path").style({fill:s,stroke:u});var N,O,P=I.node().getBoundingClientRect(),Q=a.xa._offset+(a.x0+a.x1)/2,R=a.ya._offset+(a.y0+a.y1)/2,S=Math.abs(a.x1-a.x0),T=Math.abs(a.y1-a.y0),U=P.width+C+D+K;if(a.ty0=B-P.top,a.bx=P.width+2*D,a.by=Math.max(P.height+2*D,L),a.anchor="start",a.txwidth=P.width,a.tx2width=K,a.offset=0,f)a.pos=Q,N=R+T/2+U<=G,O=R-T/2-U>=0,"top"!==a.idealAlign&&N||!O?N?(R+=T/2,a.anchor="start"):a.anchor="middle":(R-=T/2,a.anchor="end");else if(a.pos=R,N=Q+S/2+U<=F,O=Q-S/2-U>=0,"left"!==a.idealAlign&&N||!O)if(N)Q+=S/2,a.anchor="start";else{a.anchor="middle";var V=U/2,W=Q+V-F,X=Q-V;W>0&&(Q-=W),X<0&&(Q+=-X)}else Q-=S/2,a.anchor="end";I.attr("text-anchor",a.anchor),K&&J.attr("text-anchor",a.anchor),b.attr("transform","translate("+Q+","+R+")"+(f?"rotate("+x+")":""))}),N}function e(a,b){a.each(function(a){var c=j.select(this);if(a.del)return c.remove();var d=c.select("text.nums"),e=a.anchor,f="end"===e?-1:1,g={start:1,end:-1,middle:0}[e],h=g*(C+D),i=h+g*(a.txwidth+D),k=0,l=a.offset;"middle"===e&&(h-=a.tx2width/2,i+=a.txwidth/2+D),b&&(l*=-B,k=a.offset*A),c.select("path").attr("d","middle"===e?"M-"+(a.bx/2+a.tx2width/2)+","+(l-a.by/2)+"h"+a.bx+"v"+a.by+"h-"+a.bx+"Z":"M0,0L"+(f*C+k)+","+(C+l)+"v"+(a.by/2-C)+"h"+f*a.bx+"v-"+a.by+"H"+(f*C+k)+"V"+(l-C)+"Z");var m=h+k,n=l+a.ty0-a.by/2+D,p=a.textAlign||"auto";"auto"!==p&&("left"===p&&"start"!==e?(d.attr("text-anchor","start"),m="middle"===e?-a.bx/2-a.tx2width/2+D:-a.bx-D):"right"===p&&"end"!==e&&(d.attr("text-anchor","end"),m="middle"===e?a.bx/2-a.tx2width/2-D:a.bx+D)),d.call(o.positionText,m,n),a.tx2width&&(c.select("text.name").call(o.positionText,i+g*D+k,l+a.ty0-a.by/2+D),c.select("rect").call(q.setRect,i+(g-1)*a.tx2width/2+k,l-a.by/2-1,a.tx2width,a.by+2))})}function f(a,b){function c(a){return a||k(a)&&0===a}function d(b,d,e){var f=i(d,e);c(f)&&(a[b]=f)}var e=a.index,f=a.trace||{},g=a.cd[0],h=a.cd[e]||{},i=Array.isArray(e)?function(a,b){var d=m.castOption(g,e,a);return c(d)?d:m.extractOption({},f,"",b)}:function(a,b){return m.extractOption(h,f,a,b)};if(d("hoverinfo","hi","hoverinfo"),d("bgcolor","hbg","hoverlabel.bgcolor"),d("borderColor","hbc","hoverlabel.bordercolor"),d("fontFamily","htf","hoverlabel.font.family"),d("fontSize","hts","hoverlabel.font.size"),d("fontColor","htc","hoverlabel.font.color"),d("nameLength","hnl","hoverlabel.namelength"),d("textAlign","hta","hoverlabel.align"),a.posref="y"===b||"closest"===b&&"h"===f.orientation?a.xa._offset+(a.x0+a.x1)/2:a.ya._offset+(a.y0+a.y1)/2,a.x0=m.constrain(a.x0,0,a.xa._length),a.x1=m.constrain(a.x1,0,a.xa._length),a.y0=m.constrain(a.y0,0,a.ya._length),a.y1=m.constrain(a.y1,0,a.ya._length),void 0!==a.xLabelVal&&(a.xLabel="xLabel"in a?a.xLabel:t.hoverLabelText(a.xa,a.xLabelVal),a.xVal=a.xa.c2d(a.xLabelVal)),void 0!==a.yLabelVal&&(a.yLabel="yLabel"in a?a.yLabel:t.hoverLabelText(a.ya,a.yLabelVal),a.yVal=a.ya.c2d(a.yLabelVal)),void 0!==a.zLabelVal&&void 0===a.zLabel&&(a.zLabel=String(a.zLabelVal)),!(isNaN(a.xerr)||"log"===a.xa.type&&a.xerr<=0)){var j=t.tickText(a.xa,a.xa.c2l(a.xerr),"hover").text;void 0!==a.xerrneg?a.xLabel+=" +"+j+" / -"+t.tickText(a.xa,a.xa.c2l(a.xerrneg),"hover").text:a.xLabel+="  "+j,"x"===b&&(a.distance+=1)}if(!(isNaN(a.yerr)||"log"===a.ya.type&&a.yerr<=0)){var l=t.tickText(a.ya,a.ya.c2l(a.yerr),"hover").text;void 0!==a.yerrneg?a.yLabel+=" +"+l+" / -"+t.tickText(a.ya,a.ya.c2l(a.yerrneg),"hover").text:a.yLabel+="  "+l,"y"===b&&(a.distance+=1)}var n=a.hoverinfo||a.trace.hoverinfo;return n&&"all"!==n&&(-1===(n=Array.isArray(n)?n:n.split("+")).indexOf("x")&&(a.xLabel=void 0),-1===n.indexOf("y")&&(a.yLabel=void 0),-1===n.indexOf("z")&&(a.zLabel=void 0),-1===n.indexOf("text")&&(a.text=void 0),-1===n.indexOf("name")&&(a.name=void 0)),a}function g(a,b,c){var d,e,f=c.container,g=c.fullLayout,h=g._size,i=c.event,j=!!b.hLinePoint,k=!!b.vLinePoint;if(f.selectAll(".spikeline").remove(),k||j){var m=r.combine(g.plot_bgcolor,g.paper_bgcolor);if(j){var n,o,p=b.hLinePoint;d=p&&p.xa,"cursor"===(e=p&&p.ya).spikesnap?(n=i.pointerX,o=i.pointerY):(n=d._offset+p.x,o=e._offset+p.y);var s,u,v=l.readability(p.color,m)<1.5?r.contrast(m):p.color,w=e.spikemode,x=e.spikethickness,y=e.spikecolor||v,z=t.getPxPosition(a,e);if(-1!==w.indexOf("toaxis")||-1!==w.indexOf("across")){if(-1!==w.indexOf("toaxis")&&(s=z,u=n),-1!==w.indexOf("across")){var A=e._counterDomainMin,B=e._counterDomainMax;"free"===e.anchor&&(A=Math.min(A,e.position),B=Math.max(B,e.position)),s=h.l+A*h.w,u=h.l+B*h.w}f.insert("line",":first-child").attr({x1:s,x2:u,y1:o,y2:o,"stroke-width":x,stroke:y,"stroke-dasharray":q.dashStyle(e.spikedash,x)}).classed("spikeline",!0).classed("crisp",!0),f.insert("line",":first-child").attr({x1:s,x2:u,y1:o,y2:o,"stroke-width":x+2,stroke:m}).classed("spikeline",!0).classed("crisp",!0)}-1!==w.indexOf("marker")&&f.insert("circle",":first-child").attr({cx:z+("right"!==e.side?x:-x),cy:o,r:x,fill:y}).classed("spikeline",!0)}if(k){var C,D,E=b.vLinePoint;d=E&&E.xa,e=E&&E.ya,"cursor"===d.spikesnap?(C=i.pointerX,D=i.pointerY):(C=d._offset+E.x,D=e._offset+E.y);var F,G,H=l.readability(E.color,m)<1.5?r.contrast(m):E.color,I=d.spikemode,J=d.spikethickness,K=d.spikecolor||H,L=t.getPxPosition(a,d);if(-1!==I.indexOf("toaxis")||-1!==I.indexOf("across")){if(-1!==I.indexOf("toaxis")&&(F=L,G=D),-1!==I.indexOf("across")){var M=d._counterDomainMin,N=d._counterDomainMax;"free"===d.anchor&&(M=Math.min(M,d.position),N=Math.max(N,d.position)),F=h.t+(1-N)*h.h,G=h.t+(1-M)*h.h}f.insert("line",":first-child").attr({x1:C,x2:C,y1:F,y2:G,"stroke-width":J,stroke:K,"stroke-dasharray":q.dashStyle(d.spikedash,J)}).classed("spikeline",!0).classed("crisp",!0),f.insert("line",":first-child").attr({x1:C,x2:C,y1:F,y2:G,"stroke-width":J+2,stroke:m}).classed("spikeline",!0).classed("crisp",!0)}-1!==I.indexOf("marker")&&f.insert("circle",":first-child").attr({cx:C,cy:L-("top"!==d.side?J:-J),r:J,fill:K}).classed("spikeline",!0)}}}function h(a,b){return!b||b.vLinePoint!==a._spikepoints.vLinePoint||b.hLinePoint!==a._spikepoints.hLinePoint}function i(a,b){return o.plainText(a||"",{len:b,allowedTags:["br","sub","sup","b","i","em"]})}var j=a("d3"),k=a("fast-isnumeric"),l=a("tinycolor2"),m=a("../../lib"),n=a("../../lib/events"),o=a("../../lib/svg_text_utils"),p=a("../../lib/override_cursor"),q=a("../drawing"),r=a("../color"),s=a("../dragelement"),t=a("../../plots/cartesian/axes"),u=a("../../registry"),v=a("./helpers"),w=a("./constants"),x=w.YANGLE,y=Math.PI*x/180,z=1/Math.sin(y),A=Math.cos(y),B=Math.sin(y),C=w.HOVERARROWSIZE,D=w.HOVERTEXTPAD;c.hover=function(a,b,c,i){a=m.getGraphDiv(a),m.throttle(a._fullLayout._uid+w.HOVERID,w.HOVERMINTIME,function(){!function(a,b,c,i){function l(a,b){for(var c,d=null,e=1/0,f=0;f<a.length;f++)(c=a[f].spikeDistance)<e&&c<=b&&(d=a[f],e=c);return d}function o(a){return a?{xa:a.xa,ya:a.ya,x:void 0!==a.xSpike?a.xSpike:(a.x0+a.x1)/2,y:void 0!==a.ySpike?a.ySpike:(a.y0+a.y1)/2,distance:a.distance,spikeDistance:a.spikeDistance,curveNumber:a.trace.index,color:a.color,pointNumber:a.index}:null}c||(c="xy");var q=Array.isArray(c)?c:[c],w=a._fullLayout,x=w._plots||[],y=x[c],A=w._has("cartesian");if(y){var B=y.overlays.map(function(a){return a.id});q=q.concat(B)}for(var C=q.length,D=new Array(C),E=new Array(C),F=!1,G=0;G<C;G++){var H=q[G],I=x[H];if(I)F=!0,D[G]=t.getFromId(a,I.xaxis._id),E[G]=t.getFromId(a,I.yaxis._id);else{var J=w[H]._subplot;D[G]=J.xaxis,E[G]=J.yaxis}}var K=b.hovermode||w.hovermode;if(K&&!F&&(K="closest"),-1===["x","y","closest"].indexOf(K)||!a.calcdata||a.querySelector(".zoombox")||a._dragging)return s.unhoverRaw(a,b);var L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=-1===w.hoverdistance?1/0:w.hoverdistance,Z=-1===w.spikedistance?1/0:w.spikedistance,$=[],_=[],aa={hLinePoint:null,vLinePoint:null},ba=!1;if(Array.isArray(b))for(K="array",N=0;N<b.length;N++)(P=a.calcdata[b[N].curveNumber||0])&&(Q=P[0].trace,"skip"!==P[0].trace.hoverinfo&&(_.push(P),"h"===Q.orientation&&(ba=!0)));else{for(O=0;O<a.calcdata.length;O++)P=a.calcdata[O],"skip"!==(Q=P[0].trace).hoverinfo&&v.isTraceInSubplots(Q,q)&&(_.push(P),"h"===Q.orientation&&(ba=!0));var ca,da;if(!b.target)ca="xpx"in b?b.xpx:D[0]._length/2,da="ypx"in b?b.ypx:E[0]._length/2;else{if(!1===n.triggerHandler(a,"plotly_beforehover",b))return;var ea=b.target.getBoundingClientRect();if(ca=b.clientX-ea.left,da=b.clientY-ea.top,ca<0||ca>D[0]._length||da<0||da>E[0]._length)return s.unhoverRaw(a,b)}if(b.pointerX=ca+D[0]._offset,b.pointerY=da+E[0]._offset,L="xval"in b?v.flat(q,b.xval):v.p2c(D,ca),M="yval"in b?v.flat(q,b.yval):v.p2c(E,da),!k(L[0])||!k(M[0]))return m.warn("Fx.hover failed",b,a),s.unhoverRaw(a,b)}var fa=1/0;for(O=0;O<_.length;O++)if((P=_[O])&&P[0]&&P[0].trace&&!0===(Q=P[0].trace).visible&&0!==Q._length&&-1===["carpet","contourcarpet"].indexOf(Q._module.name)){if("splom"===Q.type?R=q[S=0]:(R=v.getSubplot(Q),S=q.indexOf(R)),T=K,W={cd:P,trace:Q,xa:D[S],ya:E[S],maxHoverDistance:Y,maxSpikeDistance:Z,index:!1,distance:Math.min(fa,Y),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:r.defaultLine,name:Q.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},w[R]&&(W.subplot=w[R]._subplot),w._splomScenes&&w._splomScenes[Q.uid]&&(W.scene=w._splomScenes[Q.uid]),X=$.length,"array"===T){var ga=b[O];"pointNumber"in ga?(W.index=ga.pointNumber,T="closest"):(T="","xval"in ga&&(U=ga.xval,T="x"),"yval"in ga&&(V=ga.yval,T=T?"closest":"y"))}else U=L[S],V=M[S];if(0!==Y)if(Q._module&&Q._module.hoverPoints){var ha=Q._module.hoverPoints(W,U,V,T,w._hoverlayer);if(ha)for(var ia,ja=0;ja<ha.length;ja++)ia=ha[ja],k(ia.x0)&&k(ia.y0)&&$.push(f(ia,K))}else m.log("Unrecognized trace type in hover:",Q);if("closest"===K&&$.length>X&&($.splice(0,X),fa=$[0].distance),A&&0!==Z&&0===$.length){W.distance=Z,W.index=!1;var ka=Q._module.hoverPoints(W,U,V,"closest",w._hoverlayer);if(ka&&(ka=ka.filter(function(a){return a.spikeDistance<=Z})),ka&&ka.length){var la,ma=ka.filter(function(a){return a.xa.showspikes});if(ma.length){var na=ma[0];k(na.x0)&&k(na.y0)&&(la=o(na),(!aa.vLinePoint||aa.vLinePoint.spikeDistance>la.spikeDistance)&&(aa.vLinePoint=la))}var oa=ka.filter(function(a){return a.ya.showspikes});if(oa.length){var pa=oa[0];k(pa.x0)&&k(pa.y0)&&(la=o(pa),(!aa.hLinePoint||aa.hLinePoint.spikeDistance>la.spikeDistance)&&(aa.hLinePoint=la))}}}}var qa={fullLayout:w,container:w._hoverlayer,outerContainer:w._paperdiv,event:b},ra=a._spikepoints,sa={vLinePoint:aa.vLinePoint,hLinePoint:aa.hLinePoint};if(a._spikepoints=sa,A&&0!==Z&&0!==$.length){var ta=$.filter(function(a){return a.ya.showspikes}),ua=l(ta,Z);aa.hLinePoint=o(ua);var va=$.filter(function(a){return a.xa.showspikes}),wa=l(va,Z);aa.vLinePoint=o(wa)}if(0===$.length){var xa=s.unhoverRaw(a,b);return!A||null===aa.hLinePoint&&null===aa.vLinePoint||h(ra)&&g(a,aa,qa),xa}A&&h(ra)&&g(a,aa,qa),$.sort(function(a,b){return a.distance-b.distance});var ya=a._hoverdata,za=[];for(N=0;N<$.length;N++){var Aa=$[N],Ba=v.makeEventData(Aa,Aa.trace,Aa.cd);if(!1!==Aa.hovertemplate){var Ca=!1;Aa.cd[Aa.index]&&Aa.cd[Aa.index].ht&&(Ca=Aa.cd[Aa.index].ht),Aa.hovertemplate=Ca||Aa.trace.hovertemplate||!1}Aa.eventData=[Ba],za.push(Ba)}a._hoverdata=za;var Da="y"===K&&(_.length>1||$.length>1)||"closest"===K&&ba&&$.length>1,Ea=r.combine(w.plot_bgcolor||r.background,w.paper_bgcolor),Fa={hovermode:K,rotateLabels:Da,bgColor:Ea,container:w._hoverlayer,outerContainer:w._paperdiv,commonLabelOpts:w.hoverlabel,hoverdistance:w.hoverdistance},Ga=d($,Fa,a);if(function(a,b,c){function d(a){var b=a[0],c=a[a.length-1];if(f=b.pmin-b.pos-b.dp+b.size,g=c.pos+c.dp+c.size-b.pmax,f>.01){for(i=a.length-1;i>=0;i--)a[i].dp+=f;e=!1}if(!(g<.01)){if(f<-.01){for(i=a.length-1;i>=0;i--)a[i].dp-=g;e=!1}if(e){var d=0;for(h=0;h<a.length;h++)(j=a[h]).pos+j.dp+j.size>b.pmax&&d++;for(h=a.length-1;h>=0&&!(d<=0);h--)(j=a[h]).pos>b.pmax-1&&(j.del=!0,d--);for(h=0;h<a.length&&!(d<=0);h++)if((j=a[h]).pos<b.pmin+1)for(j.del=!0,d--,g=2*j.size,i=a.length-1;i>=0;i--)a[i].dp-=g;for(h=a.length-1;h>=0&&!(d<=0);h--)(j=a[h]).pos+j.dp+j.size>b.pmax&&(j.del=!0,d--)}}}var e,f,g,h,i,j,k,l=0,m=1,n=a.size(),o=new Array(n),p=0;for(a.each(function(a){var d=a[b],e="x"===d._id.charAt(0),f=d.range;0===p&&f&&f[0]>f[1]!==e&&(m=-1),o[p++]=[{datum:a,traceIndex:a.trace.index,dp:0,pos:a.pos,posref:a.posref,size:a.by*(e?z:1)/2,pmin:0,pmax:e?c.width:c.height}]}),o.sort(function(a,b){return a[0].posref-b[0].posref||m*(b[0].traceIndex-a[0].traceIndex)});!e&&l<=n;){for(l++,e=!0,h=0;h<o.length-1;){var q=o[h],r=o[h+1],s=q[q.length-1],t=r[0];if((f=s.pos+s.dp+s.size-t.pos-t.dp+t.size)>.01&&s.pmin===t.pmin&&s.pmax===t.pmax){for(i=r.length-1;i>=0;i--)r[i].dp+=f;for(q.push.apply(q,r),o.splice(h+1,1),k=0,i=q.length-1;i>=0;i--)k+=q[i].dp;for(g=k/q.length,i=q.length-1;i>=0;i--)q[i].dp-=g;e=!1}else h++}o.forEach(d)}for(h=o.length-1;h>=0;h--){var u=o[h];for(i=u.length-1;i>=0;i--){var v=u[i],w=v.datum;w.offset=v.dp,w.del=v.del}}}(Ga,Da?"xa":"ya",w),e(Ga,Da),b.target&&b.target.tagName){var Ha=u.getComponentMethod("annotations","hasClickToShow")(a,za);p(j.select(b.target),Ha?"pointer":"")}b.target&&!i&&function(a,b,c){if(!c||c.length!==a._hoverdata.length)return!0;for(var d=c.length-1;d>=0;d--){var e=c[d],f=a._hoverdata[d];if(e.curveNumber!==f.curveNumber||String(e.pointNumber)!==String(f.pointNumber)||String(e.pointNumbers)!==String(f.pointNumbers))return!0}return!1}(a,0,ya)&&(ya&&a.emit("plotly_unhover",{event:b,points:ya}),a.emit("plotly_hover",{event:b,points:a._hoverdata,xaxes:D,yaxes:E,xvals:L,yvals:M}))}(a,b,c,i)})},c.loneHover=function(a,b){var c=!0;Array.isArray(a)||(c=!1,a=[a]);var f=a.map(function(a){return{color:a.color||r.defaultLine,x0:a.x0||a.x||0,x1:a.x1||a.x||0,y0:a.y0||a.y||0,y1:a.y1||a.y||0,xLabel:a.xLabel,yLabel:a.yLabel,zLabel:a.zLabel,text:a.text,name:a.name,idealAlign:a.idealAlign,borderColor:a.borderColor,fontFamily:a.fontFamily,fontSize:a.fontSize,fontColor:a.fontColor,nameLength:a.nameLength,textAlign:a.textAlign,trace:a.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:a.hovertemplate||!1,eventData:a.eventData||!1,hovertemplateLabels:a.hovertemplateLabels||!1}}),g=j.select(b.container),h=b.outerContainer?j.select(b.outerContainer):g,i={hovermode:"closest",rotateLabels:!1,bgColor:b.bgColor||r.background,container:g,outerContainer:h},k=d(f,i,b.gd),l=0,m=0;return k.sort(function(a,b){return a.y0-b.y0}).each(function(a,c){var d=a.y0-a.by/2;a.offset=d-5<l?l-d+5:0,l=d+a.by+a.offset,c===b.anchorIndex&&(m=a.offset)}).each(function(a){a.offset-=m}),e(k,i.rotateLabels),c?k:k.node()};var E=/<extra>([\s\S]*)<\/extra>/},{"../../lib":719,"../../lib/events":709,"../../lib/override_cursor":730,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"../../registry":848,"../color":594,"../dragelement":612,"../drawing":615,"./constants":627,"./helpers":629,d3:164,"fast-isnumeric":226,tinycolor2:538}],631:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b,c,e){c("hoverlabel.bgcolor",(e=e||{}).bgcolor),c("hoverlabel.bordercolor",e.bordercolor),c("hoverlabel.namelength",e.namelength),d.coerceFont(c,"hoverlabel.font",e.font),c("hoverlabel.align",e.align)}},{"../../lib":719}],632:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../lib"),f=a("../dragelement"),g=a("./helpers"),h=a("./layout_attributes"),i=a("./hover");b.exports={moduleType:"component",name:"fx",constants:a("./constants"),schema:{layout:h},attributes:a("./attributes"),layoutAttributes:h,supplyLayoutGlobalDefaults:a("./layout_global_defaults"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc"),getDistanceFunction:g.getDistanceFunction,getClosest:g.getClosest,inbox:g.inbox,quadrature:g.quadrature,appendArrayPointValue:g.appendArrayPointValue,castHoverOption:function(a,b,c){return e.castOption(a,b,"hoverlabel."+c)},castHoverinfo:function(a,b,c){return e.castOption(a,c,"hoverinfo",function(c){return e.coerceHoverinfo({hoverinfo:c},{_module:a._module},b)})},hover:i.hover,unhover:f.unhover,loneHover:i.loneHover,loneUnhover:function(a){var b=e.isD3Selection(a)?a:d.select(a);b.selectAll("g.hovertext").remove(),b.selectAll(".spikeline").remove()},click:a("./click")}},{"../../lib":719,"../dragelement":612,"./attributes":624,"./calc":625,"./click":626,"./constants":627,"./defaults":628,"./helpers":629,"./hover":630,"./layout_attributes":633,"./layout_defaults":634,"./layout_global_defaults":635,d3:164}],633:[function(a,b,c){"use strict";var d=a("./constants"),e=a("../../plots/font_attributes")({editType:"none"});e.family.dflt=d.HOVERFONT,e.size.dflt=d.HOVERFONTSIZE,b.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1],editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:20,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:e,align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":793,"./constants":627}],634:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(a,b,c){function f(c,f){return d.coerce(a,b,e,c,f)}var g,h=f("clickmode");"select"===f("dragmode")&&f("selectdirection"),b._has("cartesian")?h.indexOf("select")>-1?g="closest":(b._isHoriz=function(a,b){for(var c=b._scatterStackOpts||{},d=0;d<a.length;d++){var e=a[d],f=e.xaxis+e.yaxis,g=c[f]||{},h=g[e.stackgroup]||{};if("h"!==e.orientation&&"h"!==h.orientation)return!1}return!0}(c,b),g=b._isHoriz?"y":"x"):g="closest",f("hovermode",g)&&(f("hoverdistance"),f("spikedistance"));var i=b._has("mapbox"),j=b._has("geo"),k=b._basePlotModules.length;"zoom"===b.dragmode&&((i||j)&&1===k||i&&j&&2===k)&&(b.dragmode="pan")}},{"../../lib":719,"./layout_attributes":633}],635:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./hoverlabel_defaults"),f=a("./layout_attributes");b.exports=function(a,b){e(a,b,function(c,e){return d.coerce(a,b,f,c,e)})}},{"../../lib":719,"./hoverlabel_defaults":631,"./layout_attributes":633}],636:[function(a,b,c){"use strict";function d(a,b,c){var d=b[c+"axes"],e=Object.keys((a._splomAxes||{})[c]||{});return Array.isArray(d)?d:e.length?e:void 0}function e(a,b,c,d,e,f){var g=b(a+"gap",c),h=b("domain."+a);b(a+"side",d);for(var i=new Array(e),j=h[0],k=(h[1]-j)/(e-g),l=k*(1-g),m=0;m<e;m++){var n=j+k*m;i[f?e-1-m:m]=[n,n+l]}return i}function f(a,b,c,d,e){function f(a,c){-1!==b.indexOf(c)&&void 0===d[c]?(h[a]=c,d[c]=a):h[a]=""}var g,h=new Array(c);if(Array.isArray(a))for(g=0;g<c;g++)f(g,a[g]);else for(f(0,e),g=1;g<c;g++)f(g,e+(g+1));return h}var g=a("../../lib"),h=a("../../lib/regex").counter,i=a("../../plots/domain").attributes,j=a("../../plots/cartesian/constants").idRegex,k=a("../../plot_api/plot_template"),l={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[h("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[j.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[j.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:i({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};b.exports={moduleType:"component",name:"grid",schema:{layout:{grid:l}},layoutAttributes:l,sizeDefaults:function(a,b){function c(a,b){return g.coerce(f,r,l,a,b)}var f=a.grid||{},h=d(b,f,"x"),i=d(b,f,"y");if(a.grid||h||i){var j,m,n=Array.isArray(f.subplots)&&Array.isArray(f.subplots[0]),o=Array.isArray(h),p=Array.isArray(i),q=o&&h!==f.xaxes&&p&&i!==f.yaxes;n?(j=f.subplots.length,m=f.subplots[0].length):(p&&(j=i.length),o&&(m=h.length));var r=k.newContainer(b,"grid"),s=c("rows",j),t=c("columns",m);if(s*t>1){n||o||p||"independent"===c("pattern")&&(n=!0),r._hasSubplotGrid=n;var u,v,w="top to bottom"===c("roworder"),x=n?.2:.1,y=n?.3:.1;q&&b._splomGridDflt&&(u=b._splomGridDflt.xside,v=b._splomGridDflt.yside),r._domains={x:e("x",c,x,u,t),y:e("y",c,y,v,s,w)}}else delete b.grid}},contentDefaults:function(a,b){var c=b.grid;if(c&&c._domains){var e,g,h,i,j,k,l,m=a.grid||{},n=b._subplots,o=c._hasSubplotGrid,p=c.rows,q=c.columns,r="independent"===c.pattern,s=c._axisMap={};if(o){var t=m.subplots||[];k=c.subplots=new Array(p);var u=1;for(e=0;e<p;e++){var v=k[e]=new Array(q),w=t[e]||[];for(g=0;g<q;g++)if(r?(j=1===u?"xy":"x"+u+"y"+u,u++):j=w[g],v[g]="",-1!==n.cartesian.indexOf(j)){if(l=j.indexOf("y"),h=j.slice(0,l),i=j.slice(l),void 0!==s[h]&&s[h]!==g||void 0!==s[i]&&s[i]!==e)continue;v[g]=j,s[h]=g,s[i]=e}}}else{var x=d(b,m,"x"),y=d(b,m,"y");c.xaxes=f(x,n.xaxis,q,s,"x"),c.yaxes=f(y,n.yaxis,p,s,"y")}var z=c._anchors={},A="top to bottom"===c.roworder;for(var B in s){var C,D,E,F=B.charAt(0),G=c[F+"side"];if(G.length<8)z[B]="free";else if("x"===F){if("t"===G.charAt(0)===A?(C=0,D=1,E=p):(C=p-1,D=-1,E=-1),o){var H=s[B];for(e=C;e!==E;e+=D)if((j=k[e][H])&&(l=j.indexOf("y"),j.slice(0,l)===B)){z[B]=j.slice(l);break}}else for(e=C;e!==E;e+=D)if(i=c.yaxes[e],-1!==n.cartesian.indexOf(B+i)){z[B]=i;break}}else if("l"===G.charAt(0)?(C=0,D=1,E=q):(C=q-1,D=-1,E=-1),o){var I=s[B];for(e=C;e!==E;e+=D)if((j=k[I][e])&&(l=j.indexOf("y"),j.slice(l)===B)){z[B]=j.slice(0,l);break}}else for(e=C;e!==E;e+=D)if(h=c.xaxes[e],-1!==n.cartesian.indexOf(h+B)){z[B]=h;break}}}}}},{"../../lib":719,"../../lib/regex":735,"../../plot_api/plot_template":757,"../../plots/cartesian/constants":773,"../../plots/domain":792}],637:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/constants"),e=a("../../plot_api/plot_template").templatedArray;b.exports=e("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",d.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",d.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../plot_api/plot_template":757,"../../plots/cartesian/constants":773}],638:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib/to_log_range");b.exports=function(a,b,c,f){b=b||{};var g="log"===c&&"linear"===b.type,h="linear"===c&&"log"===b.type;if(g||h)for(var i,j,k=a._fullLayout.images,l=b._id.charAt(0),m=0;m<k.length;m++)if(j="images["+m+"].",(i=k[m])[l+"ref"]===b._id){var n=i[l],o=i["size"+l],p=null,q=null;if(g){p=e(n,b.range);var r=o/Math.pow(10,p)/2;q=2*Math.log(r+Math.sqrt(1+r*r))/Math.LN10}else q=(p=Math.pow(10,n))*(Math.pow(10,o/2)-Math.pow(10,-o/2));d(p)?d(q)||(q=null):(p=null,q=null),f(j+l,p),f(j+"size"+l,q)}}},{"../../lib/to_log_range":745,"fast-isnumeric":226}],639:[function(a,b,c){"use strict";function d(a,b,c){function d(c,d){return e.coerce(a,b,h,c,d)}if(!d("visible",!!d("source")))return b;d("layer"),d("xanchor"),d("yanchor"),d("sizex"),d("sizey"),d("sizing"),d("opacity");for(var g={_fullLayout:c},i=["x","y"],j=0;j<2;j++){var k=i[j],l=f.coerceRef(a,b,g,k,"paper");"paper"!==l&&f.getFromId(g,l)._imgIndices.push(b._index),f.coercePosition(b,g,d,l,k,0)}return b}var e=a("../../lib"),f=a("../../plots/cartesian/axes"),g=a("../../plots/array_container_defaults"),h=a("./attributes");b.exports=function(a,b){g(a,b,{name:"images",handleItemDefaults:d})}},{"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/cartesian/axes":767,"./attributes":637}],640:[function(a,b,c){"use strict";var d=a("d3"),e=a("../drawing"),f=a("../../plots/cartesian/axes"),g=a("../../constants/xmlns_namespaces");b.exports=function(a){function b(b){var c=d.select(this);if(this._imgSrc!==b.source)if(c.attr("xmlns",g.svg),b.source&&"data:"===b.source.slice(0,5))c.attr("xlink:href",b.source),this._imgSrc=b.source;else{var e=new Promise(function(a){function d(){c.remove(),a()}var e=new Image;this.img=e,e.setAttribute("crossOrigin","anonymous"),e.onerror=d,e.onload=function(){var b=document.createElement("canvas");b.width=this.width,b.height=this.height,b.getContext("2d").drawImage(this,0,0);var d=b.toDataURL("image/png");c.attr("xlink:href",d),a()},c.on("error",d),e.src=b.source,this._imgSrc=b.source}.bind(this));a._promises.push(e)}}function c(b){var c=d.select(this),g=f.getFromId(a,b.xref),h=f.getFromId(a,b.yref),i=j._size,k=g?Math.abs(g.l2p(b.sizex)-g.l2p(0)):b.sizex*i.w,l=h?Math.abs(h.l2p(b.sizey)-h.l2p(0)):b.sizey*i.h,m=k*p.x[b.xanchor].offset,n=l*p.y[b.yanchor].offset,o=p.x[b.xanchor].sizing+p.y[b.yanchor].sizing,q=(g?g.r2p(b.x)+g._offset:b.x*i.w+i.l)+m,r=(h?h.r2p(b.y)+h._offset:i.h-b.y*i.h+i.t)+n;switch(b.sizing){case"fill":o+=" slice";break;case"stretch":o="none"}c.attr({x:q,y:r,width:k,height:l,preserveAspectRatio:o,opacity:b.opacity});var s=(g?g._id:"")+(h?h._id:"");e.setClipUrl(c,s?"clip"+j._uid+s:null,a)}var h,i,j=a._fullLayout,k=[],l={},m=[];for(i=0;i<j.images.length;i++){var n=j.images[i];if(n.visible)if("below"===n.layer&&"paper"!==n.xref&&"paper"!==n.yref){h=n.xref+n.yref;var o=j._plots[h];if(!o){m.push(n);continue}o.mainplot&&(h=o.mainplot.id),l[h]||(l[h]=[]),l[h].push(n)}else"above"===n.layer?k.push(n):m.push(n)}var p={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}}},q=j._imageLowerLayer.selectAll("image").data(m),r=j._imageUpperLayer.selectAll("image").data(k);q.enter().append("image"),r.enter().append("image"),q.exit().remove(),r.exit().remove(),q.each(function(a){b.bind(this)(a),c.bind(this)(a)}),r.each(function(a){b.bind(this)(a),c.bind(this)(a)});var s=Object.keys(j._plots);for(i=0;i<s.length;i++){h=s[i];var t=j._plots[h];if(t.imagelayer){var u=t.imagelayer.selectAll("image").data(l[h]||[]);u.enter().append("image"),u.exit().remove(),u.each(function(a){b.bind(this)(a),c.bind(this)(a)})}}}},{"../../constants/xmlns_namespaces":696,"../../plots/cartesian/axes":767,"../drawing":615,d3:164}],641:[function(a,b,c){"use strict";b.exports={moduleType:"component",name:"images",layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),includeBasePlot:a("../../plots/cartesian/include_components")("images"),draw:a("./draw"),convertCoords:a("./convert_coords")}},{"../../plots/cartesian/include_components":777,"./attributes":637,"./convert_coords":638,"./defaults":639,"./draw":640}],642:[function(a,b,c){"use strict";var d=a("../../plots/font_attributes"),e=a("../color/attributes");b.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:d({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":793,"../color/attributes":593}],643:[function(a,b,c){"use strict";b.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},textGap:40,itemGap:5}},{}],644:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("../../plot_api/plot_template"),g=a("./attributes"),h=a("../../plots/layout_attributes"),i=a("./helpers");b.exports=function(a,b,c){function j(a,b){return e.coerce(k,u,g,a,b)}for(var k=a.legend||{},l=0,m=!1,n="normal",o=0;o<c.length;o++){var p=c[o];p.visible&&((p.showlegend||p._dfltShowLegend)&&(l++,p.showlegend&&(m=!0,(d.traceIs(p,"pie-like")||!0===p._input.showlegend)&&l++)),
(d.traceIs(p,"bar")&&"stack"===b.barmode||-1!==["tonextx","tonexty"].indexOf(p.fill))&&(n=i.isGrouped({traceorder:n})?"grouped+reversed":"reversed"),void 0!==p.legendgroup&&""!==p.legendgroup&&(n=i.isReversed({traceorder:n})?"reversed+grouped":"grouped"))}var q=e.coerce(a,b,h,"showlegend",m&&l>1);if(!1!==q||k.uirevision){var r,s,t,u=f.newContainer(b,"legend");j("uirevision",b.uirevision),!1!==q&&(j("bgcolor",b.paper_bgcolor),j("bordercolor"),j("borderwidth"),e.coerceFont(j,"font",b.font),"h"===j("orientation")?(r=0,d.getComponentMethod("rangeslider","isVisible")(a.xaxis)?(s=1.1,t="bottom"):(s=-.1,t="top")):(r=1.02,s=1,t="auto"),j("traceorder",n),i.isGrouped(b.legend)&&j("tracegroupgap"),j("itemsizing"),j("itemclick"),j("itemdoubleclick"),j("x",r),j("xanchor"),j("y",s),j("yanchor",t),j("valign"),e.noneOrAll(k,u,["x","y"]))}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../plots/layout_attributes":819,"../../registry":848,"./attributes":642,"./helpers":648}],645:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=c.data()[0][0].trace,g={event:e,node:c.node(),curveNumber:f.index,expandedIndex:f._expandedIndex,data:a.data,layout:a.layout,frames:a._transitionData._frames,config:a._context,fullData:a._fullData,fullLayout:a._fullLayout};f._group&&(g.group=f._group),m.traceIs(f,"pie-like")&&(g.label=c.datum()[0].label),!1!==n.triggerHandler(a,"plotly_legendclick",g)&&(1===d?b._clickTimeout=setTimeout(function(){s(c,a,d)},a._context.doubleClickDelay):2===d&&(b._clickTimeout&&clearTimeout(b._clickTimeout),a._legendMouseDownTime=0,!1!==n.triggerHandler(a,"plotly_legenddoubleclick",g)&&s(c,a,d)))}function e(a,b){function c(c){r.convertToTspans(c,b,function(){!function(a,b){var c=a.data()[0][0];if(!c.trace.showlegend)return void a.remove();var d,e,f=a.select("g[class*=math-group]"),g=f.node(),h=b._fullLayout.legend.font.size*v;if(g){var i=p.bBox(g);d=i.height,e=i.width,p.setTranslate(f,0,d/4)}else{var j=a.select(".legendtext"),k=r.lineCount(j),l=j.node();d=h*k,e=l?p.bBox(l).width:0;var m=h*(.3+(1-k)/2);r.positionText(j,t.textGap,m)}c.lineHeight=h,c.height=Math.max(d,16)+3,c.width=e}(a,b)})}var d=a.data()[0][0],e=b._fullLayout,g=e.legend,h=d.trace,i=m.traceIs(h,"pie-like"),j=h.index,l=b._context.edits.legendText&&!i,n=g._maxNameLength,o=i?d.label:h.name;h._meta&&(o=k.templateString(o,h._meta));var q=k.ensureSingle(a,"text","legendtext");q.attr("text-anchor","start").classed("user-select-none",!0).call(p.font,e.legend.font).text(l?f(o,n):o),r.positionText(q,t.textGap,0),l?q.call(r.makeEditable,{gd:b,text:o}).call(c).on("edit",function(a){this.text(f(a,n)).call(c);var e=d.trace._fullInput||{},g={};if(m.hasTransform(e,"groupby")){var h=m.getTransformIndices(e,"groupby"),i=h[h.length-1],l=k.keyedContainer(e,"transforms["+i+"].styles","target","value.name");l.set(d.trace._group,a),g=l.constructUpdate()}else g.name=a;return m.call("_guiRestyle",b,g,j)}):c(q)}function f(a,b){var c=Math.max(4,b);if(a&&a.trim().length>=c/2)return a;for(var d=c-(a=a||"").length;d>0;d--)a+=" ";return a}function g(a,b){var c,e=b._context.doubleClickDelay,f=1,g=k.ensureSingle(a,"rect","legendtoggle",function(a){a.style("cursor","pointer").attr("pointer-events","all").call(q.fill,"rgba(0,0,0,0)")});g.on("mousedown",function(){(c=(new Date).getTime())-b._legendMouseDownTime<e?f+=1:(f=1,b._legendMouseDownTime=c)}),g.on("mouseup",function(){if(!b._dragged&&!b._editing){var c=b._fullLayout.legend;(new Date).getTime()-b._legendMouseDownTime>e&&(f=Math.max(f-1,1)),d(b,c,a,f,j.event)}})}function h(a){return k.isRightAnchor(a)?"right":k.isCenterAnchor(a)?"center":"left"}function i(a){return k.isBottomAnchor(a)?"bottom":k.isMiddleAnchor(a)?"middle":"top"}var j=a("d3"),k=a("../../lib"),l=a("../../plots/plots"),m=a("../../registry"),n=a("../../lib/events"),o=a("../dragelement"),p=a("../drawing"),q=a("../color"),r=a("../../lib/svg_text_utils"),s=a("./handle_click"),t=a("./constants"),u=a("../../constants/alignment"),v=u.LINE_SPACING,w=u.FROM_TL,x=u.FROM_BR,y=a("./get_legend_data"),z=a("./style"),A=a("./helpers");b.exports=function(a){var b=a._fullLayout,c="legend"+b._uid;if(b._infolayer&&a.calcdata){a._legendMouseDownTime||(a._legendMouseDownTime=0);var f=b.legend,n=b.showlegend&&y(a.calcdata,f),r=b.hiddenlabels||[];if(!b.showlegend||!n.length)return b._infolayer.selectAll(".legend").remove(),b._topdefs.select("#"+c).remove(),l.autoMargin(a,"legend");var s=k.ensureSingle(b._infolayer,"g","legend",function(a){a.attr("pointer-events","all")}),u=k.ensureSingleById(b._topdefs,"clipPath",c,function(a){a.append("rect")}),v=k.ensureSingle(s,"rect","bg",function(a){a.attr("shape-rendering","crispEdges")});v.call(q.stroke,f.bordercolor).call(q.fill,f.bgcolor).style("stroke-width",f.borderwidth+"px");var B=k.ensureSingle(s,"g","scrollbox"),C=k.ensureSingle(s,"rect","scrollbar",function(a){a.attr(t.scrollBarEnterAttrs).call(q.fill,t.scrollBarColor)}),D=B.selectAll("g.groups").data(n);D.enter().append("g").attr("class","groups"),D.exit().remove();var E=D.selectAll("g.traces").data(k.identity);E.enter().append("g").attr("class","traces"),E.exit().remove(),E.style("opacity",function(a){var b=a[0].trace;return m.traceIs(b,"pie-like")?-1!==r.indexOf(a[0].label)?.5:1:"legendonly"===b.visible?.5:1}).each(function(){j.select(this).call(e,a)}).call(z,a).each(function(){j.select(this).call(g,a)}),k.syncOrAsync([l.previousPromises,function(){return function(a,b,c){var d=a._fullLayout,e=d.legend,f=d._size,g=A.isVertical(e),k=A.isGrouped(e),l=e.borderwidth,m=2*l,n=t.textGap,o=t.itemGap,q=2*(l+o),r=i(e),s=e.y<0||0===e.y&&"top"===r,u=e.y>1||1===e.y&&"bottom"===r;e._maxHeight=Math.max(s||u?d.height/2:f.h,30);var v=0;if(e._width=0,e._height=0,g)c.each(function(a){var b=a[0].height;p.setTranslate(this,l,o+l+e._height+b/2),e._height+=b,e._width=Math.max(e._width,a[0].width)}),v=n+e._width,e._width+=o+n+m,e._height+=q,k&&(b.each(function(a,b){p.setTranslate(this,0,b*e.tracegroupgap)}),e._height+=(e._lgroupsLength-1)*e.tracegroupgap);else{var w=h(e),x=e.x<0||0===e.x&&"right"===w,y=e.x>1||1===e.x&&"left"===w,z=u||s,B=d.width/2;e._maxWidth=Math.max(x?z&&"left"===w?f.l+f.w:B:y?z&&"right"===w?f.r+f.w:B:f.w,2*n);var C=0,D=0;c.each(function(a){var b=a[0].width+n;C=Math.max(C,b),D+=b}),v=null;var E=0;if(k){var F=0,G=0,H=0;b.each(function(){var a=0,b=0;j.select(this).selectAll("g.traces").each(function(c){var d=c[0].height;p.setTranslate(this,0,o+l+d/2+b),b+=d,a=Math.max(a,n+c[0].width)}),F=Math.max(F,b);var c=a+o;c+l+G>e._maxWidth&&(E=Math.max(E,G),G=0,H+=F+e.tracegroupgap,F=b),p.setTranslate(this,G,H),G+=c}),e._width=Math.max(E,G)+l,e._height=H+F+q}else{var I=c.size(),J=D+m+(I-1)*o<e._maxWidth,K=0,L=0,M=0,N=0;c.each(function(a){var b=a[0].height,c=n+a[0].width,d=(J?c:C)+o;d+l+L>e._maxWidth&&(E=Math.max(E,N),L=0,M+=K,e._height+=K,K=0),p.setTranslate(this,l+L,o+l+b/2+M),N=L+c+o,L+=d,K=Math.max(K,b)}),J?(e._width=L+m,e._height=K+q):(e._width=Math.max(E,N)+m,e._height+=K+q)}}e._width=Math.ceil(e._width),e._height=Math.ceil(e._height),e._effHeight=Math.min(e._height,e._maxHeight);var O=a._context.edits,P=O.legendText||O.legendPosition;c.each(function(a){var b=j.select(this).select(".legendtoggle"),c=a[0].height,d=P?n:v||n+a[0].width;g||(d+=o/2),p.setRect(b,0,-c/2,d,c)})}(a,D,E)},function(){function e(b,c,d){f._scrollY=a._fullLayout.legend._scrollY=b,p.setTranslate(B,0,-b),p.setRect(C,f._width,t.scrollBarMargin+b*d,t.scrollBarWidth,c),u.select("rect").attr("y",z+b)}if(!function(a){var b=a._fullLayout.legend,c=h(b),d=i(b);return l.autoMargin(a,"legend",{x:b.x,y:b.y,l:b._width*w[c],r:b._width*x[c],b:b._effHeight*x[d],t:b._effHeight*w[d]})}(a)){var g,n,q,r,y=b._size,z=f.borderwidth,A=y.l+y.w*f.x-w[h(f)]*f._width,D=y.t+y.h*(1-f.y)-w[i(f)]*f._effHeight;if(b.margin.autoexpand){var E=A,F=D;A=k.constrain(A,0,b.width-f._width),D=k.constrain(D,0,b.height-f._effHeight),A!==E&&k.log("Constrain legend.x to make legend fit inside graph"),D!==F&&k.log("Constrain legend.y to make legend fit inside graph")}if(p.setTranslate(s,A,D),C.on(".drag",null),s.on("wheel",null),f._height<=f._maxHeight||a._context.staticPlot)v.attr({width:f._width-z,height:f._effHeight-z,x:z/2,y:z/2}),p.setTranslate(B,0,0),u.select("rect").attr({width:f._width-2*z,height:f._effHeight-2*z,x:z,y:z}),p.setClipUrl(B,c,a),p.setRect(C,0,0,0,0),delete f._scrollY;else{var G,H,I,J=Math.max(t.scrollBarMinHeight,f._effHeight*f._effHeight/f._height),K=f._effHeight-J-2*t.scrollBarMargin,L=f._height-f._effHeight,M=K/L,N=Math.min(f._scrollY||0,L);v.attr({width:f._width-2*z+t.scrollBarWidth+t.scrollBarMargin,height:f._effHeight-z,x:z/2,y:z/2}),u.select("rect").attr({width:f._width-2*z+t.scrollBarWidth+t.scrollBarMargin,height:f._effHeight-2*z,x:z,y:z+N}),p.setClipUrl(B,c,a),e(N,J,M),s.on("wheel",function(){e(N=k.constrain(f._scrollY+j.event.deltaY/K*L,0,L),J,M),0!==N&&N!==L&&j.event.preventDefault()});var O=j.behavior.drag().on("dragstart",function(){var a=j.event.sourceEvent;G="touchstart"===a.type?a.changedTouches[0].clientY:a.clientY,I=N}).on("drag",function(){var a=j.event.sourceEvent;2===a.buttons||a.ctrlKey||(H="touchmove"===a.type?a.changedTouches[0].clientY:a.clientY,e(N=function(a,b,c){var d=(c-b)/M+a;return k.constrain(d,0,L)}(I,G,H),J,M))});C.call(O);var P=j.behavior.drag().on("dragstart",function(){var a=j.event.sourceEvent;"touchstart"===a.type&&(G=a.changedTouches[0].clientY,I=N)}).on("drag",function(){var a=j.event.sourceEvent;"touchmove"===a.type&&(H=a.changedTouches[0].clientY,e(N=function(a,b,c){var d=(b-c)/M+a;return k.constrain(d,0,L)}(I,G,H),J,M))});B.call(P)}a._context.edits.legendPosition&&(s.classed("cursor-move",!0),o.init({element:s.node(),gd:a,prepFn:function(){var a=p.getTranslate(s);q=a.x,r=a.y},moveFn:function(a,b){var c=q+a,d=r+b;p.setTranslate(s,c,d),g=o.align(c,0,y.l,y.l+y.w,f.xanchor),n=o.align(d,0,y.t+y.h,y.t,f.yanchor)},doneFn:function(){void 0!==g&&void 0!==n&&m.call("_guiRelayout",a,{"legend.x":g,"legend.y":n})},clickFn:function(c,e){var f=b._infolayer.selectAll("g.traces").filter(function(){var a=this.getBoundingClientRect();return e.clientX>=a.left&&e.clientX<=a.right&&e.clientY>=a.top&&e.clientY<=a.bottom});f.size()>0&&d(a,s,f,c,e)}}))}}],a)}}},{"../../constants/alignment":688,"../../lib":719,"../../lib/events":709,"../../lib/svg_text_utils":743,"../../plots/plots":828,"../../registry":848,"../color":594,"../dragelement":612,"../drawing":615,"./constants":643,"./get_legend_data":646,"./handle_click":647,"./helpers":648,"./style":650,d3:164}],646:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("./helpers");b.exports=function(a,b){function c(a,c){if(""!==a&&e.isGrouped(b))-1===i.indexOf(a)?(i.push(a),j=!0,h[a]=[[c]]):h[a].push([c]);else{var d="~~i"+l;i.push(d),h[d]=[[c]],l++}}var f,g,h={},i=[],j=!1,k={},l=0,m=0;for(f=0;f<a.length;f++){var n=a[f],o=n[0],p=o.trace,q=p.legendgroup;if(p.visible&&p.showlegend)if(d.traceIs(p,"pie-like"))for(k[q]||(k[q]={}),g=0;g<n.length;g++){var r=n[g].label;k[q][r]||(c(q,{label:r,color:n[g].color,i:n[g].i,trace:p,pts:n[g].pts}),k[q][r]=!0,m=Math.max(m,(r||"").length))}else c(q,o),m=Math.max(m,(p.name||"").length)}if(!i.length)return[];var s,t,u=i.length;if(j&&e.isGrouped(b))for(t=new Array(u),f=0;f<u;f++)s=h[i[f]],t[f]=e.isReversed(b)?s.reverse():s;else{for(t=[new Array(u)],f=0;f<u;f++)s=h[i[f]][0],t[0][e.isReversed(b)?u-f-1:f]=s;u=1}return b._lgroupsLength=u,b._maxNameLength=m,t}},{"../../registry":848,"./helpers":648}],647:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../registry"),f=!0;b.exports=function(a,b,c){function g(a,b,c){var d=x.indexOf(a),e=w[b];return e||(e=w[b]=[]),-1===x.indexOf(a)&&(x.push(a),d=x.length-1),e[d]=c,d}function h(a,b){var c=a._fullInput;if(e.hasTransform(c,"groupby")){var f=y[c.index];if(!f){var h=e.getTransformIndices(c,"groupby"),i=h[h.length-1];f=d.keyedContainer(c,"transforms["+i+"].styles","target","value.visible"),y[c.index]=f}var j=f.get(a._group);void 0===j&&(j=!0),!1!==j&&f.set(a._group,b),z[c.index]=g(c.index,"visible",!1!==c.visible)}else{var k=!1!==c.visible&&b;g(c.index,"visible",k)}}var i=b._fullLayout;if(!b._dragged&&!b._editing){var j,k=i.legend.itemclick,l=i.legend.itemdoubleclick;if(1===c&&"toggle"===k&&"toggleothers"===l&&f&&b.data&&b._context.showTips?(d.notifier(d._(b,"Double-click on legend to isolate one trace"),"long"),f=!1):f=!1,1===c?j=k:2===c&&(j=l),j){var m,n,o,p,q,r=i.hiddenlabels?i.hiddenlabels.slice():[],s=a.data()[0][0],t=b._fullData,u=s.trace,v=u.legendgroup,w={},x=[],y=[],z=[];if(e.traceIs(u,"pie-like")){var A=s.label,B=r.indexOf(A);"toggle"===j?-1===B?r.push(A):r.splice(B,1):"toggleothers"===j&&(r=[],b.calcdata[0].forEach(function(a){A!==a.label&&r.push(a.label)}),b._fullLayout.hiddenlabels&&b._fullLayout.hiddenlabels.length===r.length&&-1===B&&(r=[])),e.call("_guiRelayout",b,"hiddenlabels",r)}else{var C,D=v&&v.length,E=[];if(D)for(m=0;m<t.length;m++)(C=t[m]).visible&&C.legendgroup===v&&E.push(m);if("toggle"===j){var F;switch(u.visible){case!0:F="legendonly";break;case!1:F=!1;break;case"legendonly":F=!0}if(D)for(m=0;m<t.length;m++)!1!==t[m].visible&&t[m].legendgroup===v&&h(t[m],F);else h(u,F)}else if("toggleothers"===j){var G,H,I=!0;for(m=0;m<t.length;m++)if(t[m]!==u&&!(G=D&&t[m].legendgroup===v)&&!0===t[m].visible&&!e.traceIs(t[m],"notLegendIsolatable")){I=!1;break}for(m=0;m<t.length;m++)if(!1!==t[m].visible&&!e.traceIs(t[m],"notLegendIsolatable"))switch(u.visible){case"legendonly":h(t[m],!0);break;case!0:H=!!I||"legendonly",G=t[m]===u||D&&t[m].legendgroup===v,h(t[m],!!G||H)}}for(m=0;m<y.length;m++)if(o=y[m]){var J=o.constructUpdate(),K=Object.keys(J);for(n=0;n<K.length;n++)p=K[n],(w[p]=w[p]||[])[z[m]]=J[p]}for(q=Object.keys(w),m=0;m<q.length;m++)for(p=q[m],n=0;n<x.length;n++)w[p].hasOwnProperty(n)||(w[p][n]=void 0);e.call("_guiRestyle",b,w,x)}}}}},{"../../lib":719,"../../registry":848}],648:[function(a,b,c){"use strict";c.isGrouped=function(a){return-1!==(a.traceorder||"").indexOf("grouped")},c.isVertical=function(a){return"h"!==a.orientation},c.isReversed=function(a){return-1!==(a.traceorder||"").indexOf("reversed")}},{}],649:[function(a,b,c){"use strict";b.exports={moduleType:"component",name:"legend",layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),draw:a("./draw"),style:a("./style")}},{"./attributes":642,"./defaults":644,"./draw":645,"./style":650}],650:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../registry"),f=a("../../lib"),g=a("../drawing"),h=a("../color"),i=a("../../traces/scatter/subtypes"),j=a("../../traces/pie/style_one"),k=a("../../traces/pie/helpers").castOption,l=2,m=5;b.exports=function(a,b){function c(a,b,c,d){var e;if(a+1)e=a;else{if(!(b&&b.width>0))return 0;e=b.width}return q?d:Math.min(e,c)}function n(a,b,f){var g=a[0].trace,i=g.marker||{},j=i.line||{},k=f?g.type===f&&g.visible:e.traceIs(g,"bar"),n=d.select(b).select("g.legendpoints").selectAll("path.legend"+f).data(k?[a]:[]);n.enter().append("path").classed("legend"+f,!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),n.exit().remove(),n.each(function(a){var b=d.select(this),e=a[0],f=c(e.mlw,i.line,m,l);b.style("stroke-width",f+"px").call(h.fill,e.mc||i.color),f&&h.stroke(b,e.mlc||j.color)})}function o(a,b,g){var h=a[0],i=h.trace,n=g?i.type===g&&i.visible:e.traceIs(i,g),o=d.select(b).select("g.legendpoints").selectAll("path.legend"+g).data(n?[a]:[]);if(o.enter().append("path").classed("legend"+g,!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),o.exit().remove(),o.size()){var p=(i.marker||{}).line,q=c(k(p.width,h.pts),p,m,l),r=f.minExtend(i,{marker:{line:{width:q}}});r.marker.line.color=p.color;var s=f.minExtend(h,{trace:r});j(o,s,r)}}var p=b._fullLayout.legend,q="constant"===p.itemsizing;a.each(function(a){var b=d.select(this),c=f.ensureSingle(b,"g","layers");c.style("opacity",a[0].trace.opacity);var e=p.valign,g=a[0].lineHeight,h=a[0].height;if("middle"!==e&&g&&h){var i={top:1,bottom:-1}[e]*(.5*(g-h+3));c.attr("transform","translate(0,"+i+")")}else c.attr("transform",null);c.selectAll("g.legendfill").data([a]).enter().append("g").classed("legendfill",!0),c.selectAll("g.legendlines").data([a]).enter().append("g").classed("legendlines",!0);var j=c.selectAll("g.legendsymbols").data([a]);j.enter().append("g").classed("legendsymbols",!0),j.selectAll("g.legendpoints").data([a]).enter().append("g").classed("legendpoints",!0)}).each(function(a){var b=a[0].trace,e=[];"waterfall"===b.type&&b.visible&&(e=a[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var f=d.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(e);f.enter().append("path").classed("legendwaterfall",!0).attr("transform","translate(20,0)").style("stroke-miterlimit",1),f.exit().remove(),f.each(function(a){var e=d.select(this),f=b[a[0]].marker,g=c(void 0,f.line,m,l);e.attr("d",a[1]).style("stroke-width",g+"px").call(h.fill,f.color),g&&e.call(h.stroke,f.line.color)})}).each(function(a){n(a,this,"funnel")}).each(function(a){n(a,this)}).each(function(a){var i=a[0].trace,j=d.select(this).select("g.legendpoints").selectAll("path.legendbox").data(e.traceIs(i,"box-violin")&&i.visible?[a]:[]);j.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),j.exit().remove(),j.each(function(){var a=d.select(this);if("all"!==i.boxpoints&&"all"!==i.points||0!==h.opacity(i.fillcolor)||0!==h.opacity((i.line||{}).color)){var e=c(void 0,i.line,m,l);a.style("stroke-width",e+"px").call(h.fill,i.fillcolor),e&&h.stroke(a,i.line.color)}else{var k=f.minExtend(i,{marker:{size:q?12:f.constrain(i.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});j.call(g.pointStyle,k,b)}})}).each(function(a){o(a,this,"funnelarea")}).each(function(a){o(a,this,"pie")}).each(function(a){var e,h,j=a[0],k=j.trace,l=k.visible&&k.fill&&"none"!==k.fill,m=i.hasLines(k),n=k.contours,o=!1,p=!1;if(n){var q=n.coloring;"lines"===q?o=!0:m="none"===q||"heatmap"===q||n.showlines,"constraint"===n.type?l="="!==n._operation:"fill"!==q&&"heatmap"!==q||(p=!0)}var r=i.hasMarkers(k)||i.hasText(k),s=l||p,t=m||o,u=r||!s?"M5,0":t?"M5,-2":"M5,-3",v=d.select(this),w=v.select(".legendfill").selectAll("path").data(l||p?[a]:[]);if(w.enter().append("path").classed("js-fill",!0),w.exit().remove(),w.attr("d",u+"h30v6h-30z").call(l?g.fillGroupStyle:function(a){if(a.size()){var c="legendfill-"+k.uid;g.gradient(a,b,c,"horizontalreversed",k.colorscale,"fill")}}),m||o){var x=c(void 0,k.line,10,5);h=f.minExtend(k,{line:{width:x}}),e=[f.minExtend(j,{trace:h})]}var y=v.select(".legendlines").selectAll("path").data(m||o?[e]:[]);y.enter().append("path").classed("js-line",!0),y.exit().remove(),y.attr("d",u+(o?"l30,0.0001":"h30")).call(m?g.lineGroupStyle:function(a){if(a.size()){var c="legendline-"+k.uid;g.lineGroupStyle(a),g.gradient(a,b,c,"horizontalreversed",k.colorscale,"stroke")}})}).each(function(a){function c(a,b,c,d){var e=f.nestedProperty(m,a).get(),g=f.isArrayOrTypedArray(e)&&b?b(e):e;if(q&&g&&void 0!==d&&(g=d),c){if(g<c[0])return c[0];if(g>c[1])return c[1]}return g}function e(a){return a[0]}var h,j,k=a[0],m=k.trace,n=i.hasMarkers(m),o=i.hasText(m),p=i.hasLines(m);if(n||o||p){var r={},s={};if(n){r.mc=c("marker.color",e),r.mx=c("marker.symbol",e),r.mo=c("marker.opacity",f.mean,[.2,1]),r.mlc=c("marker.line.color",e),r.mlw=c("marker.line.width",f.mean,[0,5],l),s.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var t=c("marker.size",f.mean,[2,16],12);r.ms=t,s.marker.size=t}p&&(s.line={width:c("line.width",e,[0,10],5)}),o&&(r.tx="Aa",r.tp=c("textposition",e),r.ts=10,r.tc=c("textfont.color",e),r.tf=c("textfont.family",e)),h=[f.minExtend(k,r)],(j=f.minExtend(m,s)).selectedpoints=null}var u=d.select(this).select("g.legendpoints"),v=u.selectAll("path.scatterpts").data(n?h:[]);v.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform","translate(20,0)"),v.exit().remove(),v.call(g.pointStyle,j,b),n&&(h[0].mrc=3);var w=u.selectAll("g.pointtext").data(o?h:[]);w.enter().append("g").classed("pointtext",!0).append("text").attr("transform","translate(20,0)"),w.exit().remove(),w.selectAll("text").call(g.textPointStyle,j,b,!0)}).each(function(a){var b=a[0].trace,e=d.select(this).select("g.legendpoints").selectAll("path.legendcandle").data("candlestick"===b.type&&b.visible?[a,a]:[]);e.enter().append("path").classed("legendcandle",!0).attr("d",function(a,b){return b?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1),e.exit().remove(),e.each(function(a,e){var f=d.select(this),g=b[e?"increasing":"decreasing"],i=c(void 0,g.line,m,l);f.style("stroke-width",i+"px").call(h.fill,g.fillcolor),i&&h.stroke(f,g.line.color)})}).each(function(a){var b=a[0].trace,e=d.select(this).select("g.legendpoints").selectAll("path.legendohlc").data("ohlc"===b.type&&b.visible?[a,a]:[]);e.enter().append("path").classed("legendohlc",!0).attr("d",function(a,b){return b?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1),e.exit().remove(),e.each(function(a,e){var f=d.select(this),i=b[e?"increasing":"decreasing"],j=c(void 0,i.line,m,l);f.style("fill","none").call(g.dashLine,i.line.dash,j),j&&h.stroke(f,i.line.color)})})}},{"../../lib":719,"../../registry":848,"../../traces/pie/helpers":1090,"../../traces/pie/style_one":1096,"../../traces/scatter/subtypes":1134,"../color":594,"../drawing":615,d3:164}],651:[function(a,b,c){"use strict";function d(a,b){var c,d,e=b.currentTarget,f=e.getAttribute("data-attr"),g=e.getAttribute("data-val")||!0,h=a._fullLayout,i={},j=n.list(a,null,!0),k=h._cartesianSpikesEnabled;if("zoom"===f){var m,o="in"===g?.5:2,p=(1+o)/2,q=(1-o)/2;for(d=0;d<j.length;d++)if(!(c=j[d]).fixedrange)if(m=c._name,"auto"===g)i[m+".autorange"]=!0;else if("reset"===g){if(void 0===c._rangeInitial)i[m+".autorange"]=!0;else{var r=c._rangeInitial.slice();i[m+".range[0]"]=r[0],i[m+".range[1]"]=r[1]}void 0!==c._showSpikeInitial&&(i[m+".showspikes"]=c._showSpikeInitial,"on"!==k||c._showSpikeInitial||(k="off"))}else{var s=[c.r2l(c.range[0]),c.r2l(c.range[1])],t=[p*s[0]+q*s[1],p*s[1]+q*s[0]];i[m+".range[0]"]=c.l2r(t[0]),i[m+".range[1]"]=c.l2r(t[1])}}else"hovermode"!==f||"x"!==g&&"y"!==g||(g=h._isHoriz?"y":"x",e.setAttribute("data-val",g)),i[f]=g;h._cartesianSpikesEnabled=k,l.call("_guiRelayout",a,i)}function e(a,b){for(var c=b.currentTarget,d=c.getAttribute("data-attr"),e=c.getAttribute("data-val")||!0,f=a._fullLayout._subplots.gl3d,g={},h=d.split("."),i=0;i<f.length;i++)g[f[i]+"."+h[1]]=e;var j="pan"===e?e:"zoom";g.dragmode=j,l.call("_guiRelayout",a,g)}function f(a,b){for(var c=b.currentTarget.getAttribute("data-attr"),d=a._fullLayout,e=d._subplots.gl3d||[],f={},g=0;g<e.length;g++){var h=e[g],i=h+".camera",j=d[h]._scene;"resetLastSave"===c?(f[i+".up"]=j.viewInitial.up,f[i+".eye"]=j.viewInitial.eye,f[i+".center"]=j.viewInitial.center):"resetDefault"===c&&(f[i+".up"]=null,f[i+".eye"]=null,f[i+".center"]=null)}l.call("_guiRelayout",a,f)}function g(a,b){var c=b.currentTarget,d=c._previousVal,e=a._fullLayout,f=e._subplots.gl3d||[],g=["xaxis","yaxis","zaxis"],h={},i={};if(d)i=d,c._previousVal=null;else{for(var j=0;j<f.length;j++){var k=f[j],l=e[k],m=k+".hovermode";h[m]=l.hovermode,i[m]=!1;for(var n=0;n<3;n++){var o=g[n],p=k+"."+o+".showspikes";i[p]=!1,h[p]=l[o].showspikes}}c._previousVal=h}return i}function h(a,b){for(var c=b.currentTarget,d=c.getAttribute("data-attr"),e=c.getAttribute("data-val")||!0,f=a._fullLayout,g=f._subplots.geo,h=0;h<g.length;h++){var i=g[h],j=f[i];if("zoom"===d){var m=j.projection.scale,n="in"===e?2*m:.5*m;l.call("_guiRelayout",a,i+".projection.scale",n)}else"reset"===d&&k(a,"geo")}}function i(a){var b=a._fullLayout;return!b.hovermode&&(b._has("cartesian")?b._isHoriz?"y":"x":"closest")}function j(a){var b=i(a);l.call("_guiRelayout",a,"hovermode",b)}function k(a,b){for(var c=a._fullLayout,d=c._subplots[b]||[],e={},f=0;f<d.length;f++)for(var g=d[f],h=c[g]._subplot.viewInitial,i=Object.keys(h),j=0;j<i.length;j++){var k=i[j];e[g+"."+k]=h[k]}l.call("_guiRelayout",a,e)}var l=a("../../registry"),m=a("../../plots/plots"),n=a("../../plots/cartesian/axis_ids"),o=a("../../lib"),p=a("../../fonts/ploticon"),q=o._,r=b.exports={};r.toImage={name:"toImage",title:function(a){var b=(a._context.toImageButtonOptions||{}).format||"png";return q(a,"png"===b?"Download plot as a png":"Download plot")},icon:p.camera,click:function(a){var b=a._context.toImageButtonOptions,c={format:b.format||"png"};o.notifier(q(a,"Taking snapshot - this may take a few seconds"),"long"),"svg"!==c.format&&o.isIE()&&(o.notifier(q(a,"IE only supports svg.  Changing format to svg."),"long"),c.format="svg"),["filename","width","height","scale"].forEach(function(a){a in b&&(c[a]=b[a])}),l.call("downloadImage",a,c).then(function(b){o.notifier(q(a,"Snapshot succeeded")+" - "+b,"long")}).catch(function(){o.notifier(q(a,"Sorry, there was a problem downloading your snapshot!"),"long")})}},r.sendDataToCloud={name:"sendDataToCloud",title:function(a){return q(a,"Edit in Chart Studio")},icon:p.disk,click:function(a){m.sendDataToCloud(a)}},r.editInChartStudio={name:"editInChartStudio",title:function(a){return q(a,"Edit in Chart Studio")},icon:p.pencil,click:function(a){m.sendDataToCloud(a)}},r.zoom2d={name:"zoom2d",title:function(a){return q(a,"Zoom")},attr:"dragmode",val:"zoom",icon:p.zoombox,click:d},r.pan2d={name:"pan2d",title:function(a){return q(a,"Pan")},attr:"dragmode",val:"pan",icon:p.pan,click:d},r.select2d={name:"select2d",title:function(a){return q(a,"Box Select")},attr:"dragmode",val:"select",icon:p.selectbox,click:d},r.lasso2d={name:"lasso2d",title:function(a){return q(a,"Lasso Select")},attr:"dragmode",val:"lasso",icon:p.lasso,click:d},r.zoomIn2d={name:"zoomIn2d",title:function(a){return q(a,"Zoom in")},attr:"zoom",val:"in",icon:p.zoom_plus,click:d},r.zoomOut2d={name:"zoomOut2d",title:function(a){return q(a,"Zoom out")},attr:"zoom",val:"out",icon:p.zoom_minus,click:d},r.autoScale2d={name:"autoScale2d",title:function(a){return q(a,"Autoscale")},attr:"zoom",val:"auto",icon:p.autoscale,click:d},r.resetScale2d={name:"resetScale2d",title:function(a){return q(a,"Reset axes")},attr:"zoom",val:"reset",icon:p.home,click:d},r.hoverClosestCartesian={name:"hoverClosestCartesian",title:function(a){return q(a,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:p.tooltip_basic,gravity:"ne",click:d},r.hoverCompareCartesian={name:"hoverCompareCartesian",title:function(a){return q(a,"Compare data on hover")},attr:"hovermode",val:function(a){return a._fullLayout._isHoriz?"y":"x"},icon:p.tooltip_compare,gravity:"ne",click:d},r.zoom3d={name:"zoom3d",title:function(a){return q(a,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:p.zoombox,click:e},r.pan3d={name:"pan3d",title:function(a){return q(a,"Pan")},attr:"scene.dragmode",val:"pan",icon:p.pan,click:e},r.orbitRotation={name:"orbitRotation",title:function(a){return q(a,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:p["3d_rotate"],click:e},r.tableRotation={name:"tableRotation",title:function(a){return q(a,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:p["z-axis"],click:e},r.resetCameraDefault3d={name:"resetCameraDefault3d",title:function(a){return q(a,"Reset camera to default")},attr:"resetDefault",icon:p.home,click:f},r.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:function(a){return q(a,"Reset camera to last save")},attr:"resetLastSave",icon:p.movie,click:f},r.hoverClosest3d={name:"hoverClosest3d",title:function(a){return q(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:function(a,b){var c=g(a,b);l.call("_guiRelayout",a,c)}},r.zoomInGeo={name:"zoomInGeo",title:function(a){return q(a,"Zoom in")},attr:"zoom",val:"in",icon:p.zoom_plus,click:h},r.zoomOutGeo={name:"zoomOutGeo",title:function(a){return q(a,"Zoom out")},attr:"zoom",val:"out",icon:p.zoom_minus,click:h},r.resetGeo={name:"resetGeo",title:function(a){return q(a,"Reset")},attr:"reset",val:null,icon:p.autoscale,click:h},r.hoverClosestGeo={name:"hoverClosestGeo",title:function(a){return q(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:j},r.hoverClosestGl2d={name:"hoverClosestGl2d",title:function(a){return q(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:j},r.hoverClosestPie={name:"hoverClosestPie",title:function(a){return q(a,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:p.tooltip_basic,gravity:"ne",click:j},r.resetViewSankey={name:"resetSankeyGroup",title:function(a){return q(a,"Reset view")},icon:p.home,click:function(a){for(var b={"node.groups":[],"node.x":[],"node.y":[]},c=0;c<a._fullData.length;c++){var d=a._fullData[c]._viewInitial;b["node.groups"].push(d.node.groups.slice()),b["node.x"].push(d.node.x.slice()),b["node.y"].push(d.node.y.slice())}l.call("restyle",a,b)}},r.toggleHover={name:"toggleHover",title:function(a){return q(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:function(a,b){var c=g(a,b);c.hovermode=i(a),l.call("_guiRelayout",a,c)}},r.resetViews={name:"resetViews",title:function(a){return q(a,"Reset views")},icon:p.home,click:function(a,b){var c=b.currentTarget;c.setAttribute("data-attr","zoom"),c.setAttribute("data-val","reset"),d(a,b),c.setAttribute("data-attr","resetLastSave"),f(a,b),k(a,"geo"),k(a,"mapbox")}},r.toggleSpikelines={name:"toggleSpikelines",title:function(a){return q(a,"Toggle Spike Lines")},icon:p.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(a){var b=a._fullLayout,c=b._cartesianSpikesEnabled;b._cartesianSpikesEnabled="on"===c?"off":"on",l.call("_guiRelayout",a,function(a){for(var b="on"===a._fullLayout._cartesianSpikesEnabled,c=n.list(a,null,!0),d={},e=0;e<c.length;e++){var f=c[e];d[f._name+".showspikes"]=!!b||f._showSpikeInitial}return d}(a))}},r.resetViewMapbox={name:"resetViewMapbox",title:function(a){return q(a,"Reset view")},attr:"reset",icon:p.home,click:function(a){k(a,"mapbox")}}},{"../../fonts/ploticon":699,"../../lib":719,"../../plots/cartesian/axis_ids":770,"../../plots/plots":828,"../../registry":848}],652:[function(a,b,c){"use strict";c.manage=a("./manage")},{"./manage":653}],653:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axis_ids"),e=a("../../traces/scatter/subtypes"),f=a("../../registry"),g=a("./modebar"),h=a("./buttons");b.exports=function(a){var b=a._fullLayout,c=a._context,i=b._modeBar;if(c.displayModeBar||c.watermark){if(!Array.isArray(c.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(c.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var j,k=c.modeBarButtons;j=Array.isArray(k)&&k.length?function(a){for(var b=0;b<a.length;b++)for(var c=a[b],d=0;d<c.length;d++){var e=c[d];if("string"==typeof e){if(void 0===h[e])throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));a[b][d]=h[e]}}return a}(k):!c.displayModeBar&&c.watermark?[]:function(a){function b(a){if(a.length){for(var b=[],c=0;c<a.length;c++){var d=a[c];-1===j.indexOf(d)&&b.push(h[d])}w.push(b)}}var c=a._fullLayout,g=a._fullData,i=a._context,j=i.modeBarButtonsToRemove,k=i.modeBarButtonsToAdd,l=c._has("cartesian"),m=c._has("gl3d"),n=c._has("geo"),o=c._has("pie"),p=c._has("funnelarea"),q=c._has("gl2d"),r=c._has("ternary"),s=c._has("mapbox"),t=c._has("polar"),u=c._has("sankey"),v=function(a){for(var b=d.list({_fullLayout:a},null,!0),c=0;c<b.length;c++)if(!b[c].fixedrange)return!1;return!0}(c),w=[],x=["toImage"];i.showEditInChartStudio?x.push("editInChartStudio"):i.showSendToCloud&&x.push("sendDataToCloud"),b(x);var y=[],z=[],A=[],B=[];return(l||q||o||p||r)+n+m+s+t>1?(z=["toggleHover"],A=["resetViews"]):n?(y=["zoomInGeo","zoomOutGeo"],
z=["hoverClosestGeo"],A=["resetGeo"]):m?(z=["hoverClosest3d"],A=["resetCameraDefault3d","resetCameraLastSave3d"]):s?(z=["toggleHover"],A=["resetViewMapbox"]):q?z=["hoverClosestGl2d"]:o?z=["hoverClosestPie"]:u?(z=["hoverClosestCartesian","hoverCompareCartesian"],A=["resetViewSankey"]):z=["toggleHover"],l&&(z=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),function(a){for(var b=0;b<a.length;b++)if(!f.traceIs(a[b],"noHover"))return!1;return!0}(g)&&(z=[]),!l&&!q||v||(y=["zoomIn2d","zoomOut2d","autoScale2d"],"resetViews"!==A[0]&&(A=["resetScale2d"])),m?B=["zoom3d","pan3d","orbitRotation","tableRotation"]:(l||q)&&!v||r?B=["zoom2d","pan2d"]:s||n?B=["pan2d"]:t&&(B=["zoom2d"]),function(a){for(var b=!1,c=0;c<a.length&&!b;c++){var d=a[c];d._module&&d._module.selectPoints&&(f.traceIs(d,"scatter-like")?(e.hasMarkers(d)||e.hasText(d))&&(b=!0):f.traceIs(d,"box-violin")&&"all"!==d.boxpoints&&"all"!==d.points||(b=!0))}return b}(g)&&B.push("select2d","lasso2d"),b(B),b(y.concat(A)),b(z),function(a,b){if(b.length)if(Array.isArray(b[0]))for(var c=0;c<b.length;c++)a.push(b[c]);else a.push(b);return a}(w,k)}(a),i?i.update(a,j):b._modeBar=g(a,j)}else i&&(i.destroy(),delete b._modeBar)}},{"../../plots/cartesian/axis_ids":770,"../../registry":848,"../../traces/scatter/subtypes":1134,"./buttons":651,"./modebar":654}],654:[function(a,b,c){"use strict";function d(a){this.container=a.container,this.element=document.createElement("div"),this.update(a.graphInfo,a.buttons),this.container.appendChild(this.element)}var e=a("d3"),f=a("fast-isnumeric"),g=a("../../lib"),h=a("../../fonts/ploticon"),i=new DOMParser,j=d.prototype;j.update=function(a,b){this.graphInfo=a;var c=this.graphInfo._context,d=this.graphInfo._fullLayout,e="modebar-"+d._uid;this.element.setAttribute("id",e),this._uid=e,this.element.className="modebar","hover"===c.displayModeBar&&(this.element.className+=" modebar--hover ease-bg"),"v"===d.modebar.orientation&&(this.element.className+=" vertical",b=b.reverse());var f=d.modebar,h="hover"===c.displayModeBar?".js-plotly-plot .plotly:hover ":"";g.deleteRelatedStyleRule(e),g.addRelatedStyleRule(e,h+"#"+e+" .modebar-group","background-color: "+f.bgcolor),g.addRelatedStyleRule(e,"#"+e+" .modebar-btn .icon path","fill: "+f.color),g.addRelatedStyleRule(e,"#"+e+" .modebar-btn:hover .icon path","fill: "+f.activecolor),g.addRelatedStyleRule(e,"#"+e+" .modebar-btn.active .icon path","fill: "+f.activecolor);var i=!this.hasButtons(b),j=this.hasLogo!==c.displaylogo,k=this.locale!==c.locale;if(this.locale=c.locale,(i||j||k)&&(this.removeAllButtons(),this.updateButtons(b),c.watermark||c.displaylogo)){var l=this.getLogo();c.watermark&&(l.className=l.className+" watermark"),"v"===d.modebar.orientation?this.element.insertBefore(l,this.element.childNodes[0]):this.element.appendChild(l),this.hasLogo=!0}this.updateActiveButton()},j.updateButtons=function(a){var b=this;this.buttons=a,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(a){var c=b.createGroup();a.forEach(function(a){var d=a.name;if(!d)throw new Error("must provide button 'name' in button config");if(-1!==b.buttonsNames.indexOf(d))throw new Error("button name '"+d+"' is taken");b.buttonsNames.push(d);var e=b.createButton(a);b.buttonElements.push(e),c.appendChild(e)}),b.element.appendChild(c)})},j.createGroup=function(){var a=document.createElement("div");return a.className="modebar-group",a},j.createButton=function(a){var b=this,c=document.createElement("a");c.setAttribute("rel","tooltip"),c.className="modebar-btn";var d=a.title;void 0===d?d=a.name:"function"==typeof d&&(d=d(this.graphInfo)),(d||0===d)&&c.setAttribute("data-title",d),void 0!==a.attr&&c.setAttribute("data-attr",a.attr);var f=a.val;if(void 0!==f&&("function"==typeof f&&(f=f(this.graphInfo)),c.setAttribute("data-val",f)),"function"!=typeof a.click)throw new Error("must provide button 'click' function in button config");c.addEventListener("click",function(c){a.click(b.graphInfo,c),b.updateActiveButton(c.currentTarget)}),c.setAttribute("data-toggle",a.toggle||!1),a.toggle&&e.select(c).classed("active",!0);var g=a.icon;return"function"==typeof g?c.appendChild(g()):c.appendChild(this.createIcon(g||h.question)),c.setAttribute("data-gravity",a.gravity||"n"),c},j.createIcon=function(a){var b,c=f(a.height)?Number(a.height):a.ascent-a.descent,d="http://www.w3.org/2000/svg";if(a.path){(b=document.createElementNS(d,"svg")).setAttribute("viewBox",[0,0,a.width,c].join(" ")),b.setAttribute("class","icon");var e=document.createElementNS(d,"path");e.setAttribute("d",a.path),a.transform?e.setAttribute("transform",a.transform):void 0!==a.ascent&&e.setAttribute("transform","matrix(1 0 0 -1 0 "+a.ascent+")"),b.appendChild(e)}return a.svg&&(b=i.parseFromString(a.svg,"application/xml").childNodes[0]),b.setAttribute("height","1em"),b.setAttribute("width","1em"),b},j.updateActiveButton=function(a){var b=this.graphInfo._fullLayout,c=void 0!==a?a.getAttribute("data-attr"):null;this.buttonElements.forEach(function(a){var d=a.getAttribute("data-val")||!0,f=a.getAttribute("data-attr"),h="true"===a.getAttribute("data-toggle"),i=e.select(a);if(h)f===c&&i.classed("active",!i.classed("active"));else{var j=null===f?f:g.nestedProperty(b,f).get();i.classed("active",j===d)}})},j.hasButtons=function(a){var b=this.buttons;if(!b)return!1;if(a.length!==b.length)return!1;for(var c=0;c<a.length;++c){if(a[c].length!==b[c].length)return!1;for(var d=0;d<a[c].length;d++)if(a[c][d].name!==b[c][d].name)return!1}return!0},j.getLogo=function(){var a=this.createGroup(),b=document.createElement("a");return b.href="https://plot.ly/",b.target="_blank",b.setAttribute("data-title",g._(this.graphInfo,"Produced with Plotly")),b.className="modebar-btn plotlyjsicon modebar-btn--logo",b.appendChild(this.createIcon(h.newplotlylogo)),a.appendChild(b),a},j.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},j.destroy=function(){g.removeElement(this.container.querySelector(".modebar")),g.deleteRelatedStyleRule(this._uid)},b.exports=function(a,b){var c=a._fullLayout,f=new d({graphInfo:a,container:c._modebardiv.node(),buttons:b});return c._privateplot&&e.select(f.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),f}},{"../../fonts/ploticon":699,"../../lib":719,d3:164,"fast-isnumeric":226}],655:[function(a,b,c){"use strict";var d=a("../../plots/font_attributes"),e=a("../color/attributes"),f=(0,a("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});b.exports={visible:{valType:"boolean",editType:"plot"},buttons:f,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:d({editType:"plot"}),bgcolor:{valType:"color",dflt:e.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":757,"../../plots/font_attributes":793,"../color/attributes":593}],656:[function(a,b,c){"use strict";b.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],657:[function(a,b,c){"use strict";function d(a,b,c,d){function f(c,d){return e.coerce(a,b,i.buttons,c,d)}var g=d.calendar;if(f("visible")){var h=f("step");"all"!==h&&(!g||"gregorian"===g||"month"!==h&&"year"!==h?f("stepmode"):b.stepmode="backward",f("count")),f("label")}}var e=a("../../lib"),f=a("../color"),g=a("../../plot_api/plot_template"),h=a("../../plots/array_container_defaults"),i=a("./attributes"),j=a("./constants");b.exports=function(a,b,c,k,l){function m(a,b){return e.coerce(n,o,i,a,b)}var n=a.rangeselector||{},o=g.newContainer(b,"rangeselector");if(m("visible",h(n,o,{name:"buttons",handleItemDefaults:d,calendar:l}).length>0)){var p=function(a,b,c){for(var d=c.filter(function(c){return b[c].anchor===a._id}),e=0,f=0;f<d.length;f++){var g=b[d[f]].domain;g&&(e=Math.max(g[1],e))}return[a.domain[0],e+j.yPad]}(b,c,k);m("x",p[0]),m("y",p[1]),e.noneOrAll(a,b,["x","y"]),m("xanchor"),m("yanchor"),e.coerceFont(m,"font",c.font);var q=m("bgcolor");m("activecolor",f.contrast(q,j.lightAmount,j.darkAmount)),m("bordercolor"),m("borderwidth")}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../plots/array_container_defaults":763,"../color":594,"./attributes":655,"./constants":656}],658:[function(a,b,c){"use strict";function d(a){return a._id}function e(a,b,c){var d=l.ensureSingle(a,"rect","selector-rect",function(a){a.attr("shape-rendering","crispEdges")});d.attr({rx:s.rx,ry:s.ry}),d.call(j.stroke,b.bordercolor).call(j.fill,function(a,b){return b._isActive||b._isHovered?a.activecolor:a.bgcolor}(b,c)).style("stroke-width",b.borderwidth+"px")}function f(a,b,c,d){l.ensureSingle(a,"text","selector-text",function(a){a.classed("user-select-none",!0).attr("text-anchor","middle")}).call(k.font,b.font).text(function(a,b){return a.label?b?l.templateString(a.label,b):a.label:"all"===a.step?"all":a.count+a.step.charAt(0)}(c,d._fullLayout._meta)).call(function(a){m.convertToTspans(a,d)})}var g=a("d3"),h=a("../../registry"),i=a("../../plots/plots"),j=a("../color"),k=a("../drawing"),l=a("../../lib"),m=a("../../lib/svg_text_utils"),n=a("../../plots/cartesian/axis_ids"),o=a("../../constants/alignment"),p=o.LINE_SPACING,q=o.FROM_TL,r=o.FROM_BR,s=a("./constants"),t=a("./get_update_object");b.exports=function(a){var b=a._fullLayout._infolayer.selectAll(".rangeselector").data(function(a){for(var b=n.list(a,"x",!0),c=[],d=0;d<b.length;d++){var e=b[d];e.rangeselector&&e.rangeselector.visible&&c.push(e)}return c}(a),d);b.enter().append("g").classed("rangeselector",!0),b.exit().remove(),b.style({cursor:"pointer","pointer-events":"all"}),b.each(function(b){var c=g.select(this),d=b,j=d.rangeselector,n=c.selectAll("g.button").data(l.filterVisible(j.buttons));n.enter().append("g").classed("button",!0),n.exit().remove(),n.each(function(b){var c=g.select(this),i=t(d,b);b._isActive=function(a,b,c){if("all"===b.step)return!0===a.autorange;var d=Object.keys(c);return a.range[0]===c[d[0]]&&a.range[1]===c[d[1]]}(d,b,i),c.call(e,j,b),c.call(f,j,b,a),c.on("click",function(){a._dragged||h.call("_guiRelayout",a,i)}),c.on("mouseover",function(){b._isHovered=!0,c.call(e,j,b)}),c.on("mouseout",function(){b._isHovered=!1,c.call(e,j,b)})}),function(a,b,c,d,e){var f=0,h=0,j=c.borderwidth;b.each(function(){var a=g.select(this),b=a.select(".selector-text"),d=c.font.size*p,e=Math.max(d*m.lineCount(b),16)+3;h=Math.max(h,e)}),b.each(function(){var a=g.select(this),b=a.select(".selector-rect"),d=a.select(".selector-text"),e=d.node()&&k.bBox(d.node()).width,i=c.font.size*p,l=m.lineCount(d),n=Math.max(e+10,s.minButtonWidth);a.attr("transform","translate("+(j+f)+","+j+")"),b.attr({x:0,y:0,width:n,height:h}),m.positionText(d,n/2,h/2-(l-1)*i/2+3),f+=n+5});var n=a._fullLayout._size,o=n.l+n.w*c.x,t=n.t+n.h*(1-c.y),u="left";l.isRightAnchor(c)&&(o-=f,u="right"),l.isCenterAnchor(c)&&(o-=f/2,u="center");var v="top";l.isBottomAnchor(c)&&(t-=h,v="bottom"),l.isMiddleAnchor(c)&&(t-=h/2,v="middle"),f=Math.ceil(f),h=Math.ceil(h),o=Math.round(o),t=Math.round(t),i.autoMargin(a,d+"-range-selector",{x:c.x,y:c.y,l:f*q[u],r:f*r[u],b:h*r[v],t:h*q[v]}),e.attr("transform","translate("+o+","+t+")")}(a,n,j,d._name,c)})}},{"../../constants/alignment":688,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/cartesian/axis_ids":770,"../../plots/plots":828,"../../registry":848,"../color":594,"../drawing":615,"./constants":656,"./get_update_object":659,d3:164}],659:[function(a,b,c){"use strict";var d=a("d3");b.exports=function(a,b){var c=a._name,e={};if("all"===b.step)e[c+".autorange"]=!0;else{var f=function(a,b){var c,e=a.range,f=new Date(a.r2l(e[1])),g=b.step,h=b.count;switch(b.stepmode){case"backward":c=a.l2r(+d.time[g].utc.offset(f,-h));break;case"todate":var i=d.time[g].utc.offset(f,-h);c=a.l2r(+d.time[g].utc.ceil(i))}return[c,e[1]]}(a,b);e[c+".range[0]"]=f[0],e[c+".range[1]"]=f[1]}return e}},{d3:164}],660:[function(a,b,c){"use strict";b.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:a("./attributes")}}},layoutAttributes:a("./attributes"),handleDefaults:a("./defaults"),draw:a("./draw")}},{"./attributes":655,"./defaults":657,"./draw":658}],661:[function(a,b,c){"use strict";var d=a("../color/attributes");b.exports={bgcolor:{valType:"color",dflt:d.background,editType:"plot"},bordercolor:{valType:"color",dflt:d.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":593}],662:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axis_ids").list,e=a("../../plots/cartesian/autorange").getAutoRange,f=a("./constants");b.exports=function(a){for(var b=d(a,"x",!0),c=0;c<b.length;c++){var g=b[c],h=g[f.name];h&&h.visible&&h.autorange&&(h._input.autorange=!0,h._input.range=h.range=e(a,g))}}},{"../../plots/cartesian/autorange":766,"../../plots/cartesian/axis_ids":770,"./constants":663}],663:[function(a,b,c){"use strict";b.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],664:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plot_api/plot_template"),f=a("../../plots/cartesian/axis_ids"),g=a("./attributes"),h=a("./oppaxis_attributes");b.exports=function(a,b,c){function i(a,b){return d.coerce(o,p,g,a,b)}function j(a,b){return d.coerce(m,n,h,a,b)}var k=a[c],l=b[c];if(k.rangeslider||b._requestRangeslider[l._id]){d.isPlainObject(k.rangeslider)||(k.rangeslider={});var m,n,o=k.rangeslider,p=e.newContainer(l,"rangeslider");if(i("visible")){i("bgcolor",b.plot_bgcolor),i("bordercolor"),i("borderwidth"),i("thickness"),i("autorange",!l.isValidRange(o.range)),i("range");var q=b._subplots;if(q)for(var r=q.cartesian.filter(function(a){return a.substr(0,a.indexOf("y"))===f.name2id(c)}).map(function(a){return a.substr(a.indexOf("y"),a.length)}),s=d.simpleMap(r,f.id2name),t=0;t<s.length;t++){var u=s[t];m=o[u]||{},n=e.newContainer(p,u,"yaxis");var v,w=b[u];m.range&&w.isValidRange(m.range)&&(v="fixed"),"match"!==j("rangemode",v)&&j("range",w.range.slice())}p._input=o}}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../plots/cartesian/axis_ids":770,"./attributes":661,"./oppaxis_attributes":668}],665:[function(a,b,c){"use strict";function d(a,b,c,d){var e=m.ensureSingle(a,"rect",u.bgClassName,function(a){a.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),f=d.borderwidth%2==0?d.borderwidth:d.borderwidth-1,g=-d._offsetShift,h=n.crispRound(b,d.borderwidth);e.attr({width:d._width+f,height:d._height+f,transform:"translate("+g+","+g+")",fill:d.bgcolor,stroke:d.bordercolor,"stroke-width":h})}function e(a,b,c,d){var e=b._fullLayout;m.ensureSingleById(e._topdefs,"clipPath",d._clipId,function(a){a.append("rect").attr({x:0,y:0})}).select("rect").attr({width:d._width,height:d._height})}function f(a,b,c,d){var e,f=b.calcdata,g=a.selectAll("g."+u.rangePlotClassName).data(c._subplotsWith,m.identity);g.enter().append("g").attr("class",function(a){return u.rangePlotClassName+" "+a}).call(n.setClipUrl,d._clipId,b),g.order(),g.exit().remove(),g.each(function(a,g){var h=j.select(this),i=0===g,k=r.getFromId(b,a,"y"),m=k._name,n=d[m],o={data:[],layout:{xaxis:{type:c.type,domain:[0,1],range:d.range.slice(),calendar:c.calendar},width:d._width,height:d._height,margin:{t:0,b:0,l:0,r:0}},_context:b._context};o.layout[m]={type:k.type,domain:[0,1],range:"match"!==n.rangemode?n.range.slice():k.range.slice(),calendar:k.calendar},l.supplyDefaults(o);var p=o._fullLayout.xaxis,s=o._fullLayout[m];p.clearCalc(),p.setScale(),s.clearCalc(),s.setScale();var t={id:a,plotgroup:h,xaxis:p,yaxis:s,isRangePlot:!0};i?e=t:(t.mainplot="xy",t.mainplotinfo=e),q.rangePlot(b,t,function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d],f=e[0].trace;f.xaxis+f.yaxis===b&&c.push(e)}return c}(f,a))})}function g(a,b,c,d,e){m.ensureSingle(a,"rect",u.maskMinClassName,function(a){a.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",d._height).call(o.fill,u.maskColor),m.ensureSingle(a,"rect",u.maskMaxClassName,function(a){a.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",d._height).call(o.fill,u.maskColor),"match"!==e.rangemode&&(m.ensureSingle(a,"rect",u.maskMinOppAxisClassName,function(a){a.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",d._width).call(o.fill,u.maskOppAxisColor),m.ensureSingle(a,"rect",u.maskMaxOppAxisClassName,function(a){a.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",d._width).style("border-top",u.maskOppBorder).call(o.fill,u.maskOppAxisColor))}function h(a,b,c,d){b._context.staticPlot||m.ensureSingle(a,"rect",u.slideBoxClassName,function(a){a.attr({y:0,cursor:u.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:d._height,fill:u.slideBoxFill})}function i(a,b,c,d){var e=m.ensureSingle(a,"g",u.grabberMinClassName),f=m.ensureSingle(a,"g",u.grabberMaxClassName),g={x:0,width:u.handleWidth,rx:u.handleRadius,fill:o.background,stroke:o.defaultLine,"stroke-width":u.handleStrokeWidth,"shape-rendering":"crispEdges"},h={y:Math.round(d._height/4),height:Math.round(d._height/2)};if(m.ensureSingle(e,"rect",u.handleMinClassName,function(a){a.attr(g)}).attr(h),m.ensureSingle(f,"rect",u.handleMaxClassName,function(a){a.attr(g)}).attr(h),!b._context.staticPlot){var i={width:u.grabAreaWidth,x:0,y:0,fill:u.grabAreaFill,cursor:u.grabAreaCursor};m.ensureSingle(e,"rect",u.grabAreaMinClassName,function(a){a.attr(i)}).attr("height",d._height),m.ensureSingle(f,"rect",u.grabAreaMaxClassName,function(a){a.attr(i)}).attr("height",d._height)}}var j=a("d3"),k=a("../../registry"),l=a("../../plots/plots"),m=a("../../lib"),n=a("../drawing"),o=a("../color"),p=a("../titles"),q=a("../../plots/cartesian"),r=a("../../plots/cartesian/axis_ids"),s=a("../dragelement"),t=a("../../lib/setcursor"),u=a("./constants");b.exports=function(a){for(var b=a._fullLayout,c=b._rangeSliderData,l=0;l<c.length;l++){var n=c[l][u.name];n._clipId=n._id+"-"+b._uid}var o=b._infolayer.selectAll("g."+u.containerClassName).data(c,function(a){return a._name});o.exit().each(function(a){var c=a[u.name];b._topdefs.select("#"+c._clipId).remove()}).remove(),0!==c.length&&(o.enter().append("g").classed(u.containerClassName,!0).attr("pointer-events","all"),o.each(function(c){var l=j.select(this),n=c[u.name],o=b[r.id2name(c.anchor)],q=n[r.id2name(c.anchor)];if(n.range){var v,w=m.simpleMap(n.range,c.r2l),x=m.simpleMap(c.range,c.r2l);v=x[0]<x[1]?[Math.min(w[0],x[0]),Math.max(w[1],x[1])]:[Math.max(w[0],x[0]),Math.min(w[1],x[1])],n.range=n._input.range=m.simpleMap(v,c.l2r)}c.cleanRange("rangeslider.range");var y=b._size,z=c.domain;n._width=y.w*(z[1]-z[0]);var A=Math.round(y.l+y.w*z[0]),B=Math.round(y.t+y.h*(1-c._counterDomainMin)+("bottom"===c.side?c._depth:0)+n._offsetShift+u.extraPad);l.attr("transform","translate("+A+","+B+")");var C=c.r2l(n.range[0]),D=c.r2l(n.range[1]),E=D-C;if(n.p2d=function(a){return a/n._width*E+C},n.d2p=function(a){return(a-C)/E*n._width},n._rl=[C,D],"match"!==q.rangemode){var F=o.r2l(q.range[0]),G=o.r2l(q.range[1])-F;n.d2pOppAxis=function(a){return(a-F)/G*n._height}}l.call(d,a,c,n).call(e,a,c,n).call(f,a,c,n).call(g,a,c,n,q).call(h,a,c,n).call(i,a,c,n),function(a,b,c,d){var e=a.select("rect."+u.slideBoxClassName).node(),f=a.select("rect."+u.grabAreaMinClassName).node(),g=a.select("rect."+u.grabAreaMaxClassName).node();a.on("mousedown",function(){function h(a){var h,i,s,u=+a.clientX-n;switch(l){case e:s="ew-resize",h=p+u,i=q+u;break;case f:s="col-resize",h=p+u,i=q;break;case g:s="col-resize",h=p,i=q+u;break;default:s="ew-resize",h=o,i=o+u}if(i<h){var v=i;i=h,h=v}d._pixelMin=h,d._pixelMax=i,t(j.select(r),s),function(a,b,c,d){function e(a){return c.l2r(m.constrain(a,d._rl[0],d._rl[1]))}var f=e(d.p2d(d._pixelMin)),g=e(d.p2d(d._pixelMax));window.requestAnimationFrame(function(){k.call("_guiRelayout",b,c._name+".range",[f,g])})}(0,b,c,d)}var i=j.event,l=i.target,n=i.clientX,o=n-a.node().getBoundingClientRect().left,p=d.d2p(c._rl[0]),q=d.d2p(c._rl[1]),r=s.coverSlip();r.addEventListener("mousemove",h),r.addEventListener("mouseup",function a(){r.removeEventListener("mousemove",h),r.removeEventListener("mouseup",a),m.removeElement(r)})})}(l,a,c,n),function(a,b,c,d,e,f){function g(a){return m.constrain(a,0,d._width)}function h(a){return m.constrain(a,0,d._height)}function i(a){return m.constrain(a,-j,d._width+j)}var j=u.handleWidth/2,k=g(d.d2p(c._rl[0])),l=g(d.d2p(c._rl[1]));if(a.select("rect."+u.slideBoxClassName).attr("x",k).attr("width",l-k),a.select("rect."+u.maskMinClassName).attr("width",k),a.select("rect."+u.maskMaxClassName).attr("x",l).attr("width",d._width-l),"match"!==f.rangemode){var n=d._height-h(d.d2pOppAxis(e._rl[1])),o=d._height-h(d.d2pOppAxis(e._rl[0]));a.select("rect."+u.maskMinOppAxisClassName).attr("x",k).attr("height",n).attr("width",l-k),a.select("rect."+u.maskMaxOppAxisClassName).attr("x",k).attr("y",o).attr("height",d._height-o).attr("width",l-k),a.select("rect."+u.slideBoxClassName).attr("y",n).attr("height",o-n)}var p=Math.round(i(k-j))-.5,q=Math.round(i(l-j))+.5;a.select("g."+u.grabberMinClassName).attr("transform","translate("+p+",0.5)"),a.select("g."+u.grabberMaxClassName).attr("transform","translate("+q+",0.5)")}(l,0,c,n,o,q),"bottom"===c.side&&p.draw(a,c._id+"title",{propContainer:c,propName:c._name+".title",placeholder:b._dfltTitle.x,attributes:{x:c._offset+c._length/2,y:B+n._height+n._offsetShift+10+1.5*c.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":719,"../../lib/setcursor":739,"../../plots/cartesian":778,"../../plots/cartesian/axis_ids":770,"../../plots/plots":828,"../../registry":848,"../color":594,"../dragelement":612,"../drawing":615,"../titles":681,"./constants":663,d3:164}],666:[function(a,b,c){"use strict";function d(a){var b=a&&a[i];return b&&b.visible}var e=a("../../plots/cartesian/axis_ids"),f=a("../../lib/svg_text_utils"),g=a("./constants"),h=a("../../constants/alignment").LINE_SPACING,i=g.name;c.isVisible=d,c.makeData=function(a){var b=e.list({_fullLayout:a},"x",!0),c=a.margin,f=[];if(!a._has("gl2d"))for(var g=0;g<b.length;g++){var h=b[g];if(d(h)){f.push(h);var j=h[i];j._id=i+h._id,j._height=(a.height-c.b-c.t)*j.thickness,j._offsetShift=Math.floor(j.borderwidth/2)}}a._rangeSliderData=f},c.autoMarginOpts=function(a,b){var c=a._fullLayout,d=b[i],e=b._id.charAt(0),j=0,k=0;return"bottom"===b.side&&(j=b._depth,b.title.text!==c._dfltTitle[e]&&(k=1.5*b.title.font.size+10+d._offsetShift,k+=(b.title.text.match(f.BR_TAG_ALL)||[]).length*b.title.font.size*h)),{x:0,y:b._counterDomainMin,l:0,r:0,t:0,b:d._height+j+Math.max(c.margin.b,k),pad:g.extraPad+2*d._offsetShift}}},{"../../constants/alignment":688,"../../lib/svg_text_utils":743,"../../plots/cartesian/axis_ids":770,"./constants":663}],667:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("./oppaxis_attributes"),g=a("./helpers");b.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:d.extendFlat({},e,{yaxis:f})}}},layoutAttributes:a("./attributes"),handleDefaults:a("./defaults"),calcAutorange:a("./calc_autorange"),draw:a("./draw"),isVisible:g.isVisible,makeData:g.makeData,autoMarginOpts:g.autoMarginOpts}},{"../../lib":719,"./attributes":661,"./calc_autorange":662,"./defaults":664,"./draw":665,"./helpers":666,"./oppaxis_attributes":668}],668:[function(a,b,c){"use strict";b.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],669:[function(a,b,c){"use strict";var d=a("../annotations/attributes"),e=a("../../traces/scatter/attributes").line,f=a("../drawing/attributes").dash,g=a("../../lib/extend").extendFlat,h=a("../../plot_api/plot_template").templatedArray;b.exports=h("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:g({},d.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:g({},d.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:g({},e.color,{editType:"arraydraw"}),width:g({},e.width,{editType:"calc+arraydraw"}),dash:g({},f,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},editType:"arraydraw"})},{"../../lib/extend":710,"../../plot_api/plot_template":757,"../../traces/scatter/attributes":1111,"../annotations/attributes":577,"../drawing/attributes":614}],670:[function(a,b,c){"use strict";function d(a){return f(a.line.width,a.xsizemode,a.x0,a.x1,a.path,!1)}function e(a){return f(a.line.width,a.ysizemode,a.y0,a.y1,a.path,!0)}function f(a,b,c,d,e,f){var g=a/2,i=f;if("pixel"===b){var l=e?k.extractPathCoords(e,f?j.paramIsY:j.paramIsX):[c,d],m=h.aggNums(Math.max,null,l),n=h.aggNums(Math.min,null,l),o=n<0?Math.abs(n)+g:g,p=m>0?m+g:g;return{ppad:g,ppadplus:i?o:p,ppadminus:i?p:o}}return{ppad:g}}function g(a,b,c,d,e){var f="category"===a.type||"multicategory"===a.type?a.r2c:a.d2c;if(void 0!==b)return[f(b),f(c)];if(d){var g,h,i,l,m=1/0,n=-1/0,o=d.match(j.segmentRE);for("date"===a.type&&(f=k.decodeDate(f)),g=0;g<o.length;g++)void 0!==(h=e[o[g].charAt(0)].drawn)&&(!(i=o[g].substr(1).match(j.paramRE))||i.length<h||((l=f(i[h]))<m&&(m=l),l>n&&(n=l)));return n>=m?[m,n]:void 0}}var h=a("../../lib"),i=a("../../plots/cartesian/axes"),j=a("./constants"),k=a("./helpers");b.exports=function(a){var b=a._fullLayout,c=h.filterVisible(b.shapes);if(c.length&&a._fullData.length)for(var f=0;f<c.length;f++){var k,l,m=c[f];if(m._extremes={},"paper"!==m.xref){var n="pixel"===m.xsizemode?m.xanchor:m.x0,o="pixel"===m.xsizemode?m.xanchor:m.x1;(l=g(k=i.getFromId(a,m.xref),n,o,m.path,j.paramIsX))&&(m._extremes[k._id]=i.findExtremes(k,l,d(m)))}if("paper"!==m.yref){var p="pixel"===m.ysizemode?m.yanchor:m.y0,q="pixel"===m.ysizemode?m.yanchor:m.y1;(l=g(k=i.getFromId(a,m.yref),p,q,m.path,j.paramIsY))&&(m._extremes[k._id]=i.findExtremes(k,l,e(m)))}}}},{"../../lib":719,"../../plots/cartesian/axes":767,"./constants":671,"./helpers":674}],671:[function(a,b,c){"use strict";b.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],672:[function(a,b,c){"use strict";function d(a,b,c){function d(c,d){return e.coerce(a,b,h,c,d)}if(d("visible")){d("layer"),d("opacity"),d("fillcolor"),d("line.color"),d("line.width"),d("line.dash");for(var g=d("type",a.path?"path":"rect"),j=d("xsizemode"),k=d("ysizemode"),l=["x","y"],m=0;m<2;m++){var n,o,p,q=l[m],r=q+"anchor",s="x"===q?j:k,t={_fullLayout:c},u=f.coerceRef(a,b,t,q,"","paper");if("paper"!==u?((n=f.getFromId(t,u))._shapeIndices.push(b._index),p=i.rangeToShapePosition(n),o=i.shapePositionToRange(n)):o=p=e.identity,"path"!==g){var v=q+"0",w=q+"1",x=a[v],y=a[w];a[v]=o(a[v],!0),a[w]=o(a[w],!0),"pixel"===s?(d(v,0),d(w,10)):(f.coercePosition(b,t,d,u,v,.25),f.coercePosition(b,t,d,u,w,.75)),b[v]=p(b[v]),b[w]=p(b[w]),a[v]=x,a[w]=y}if("pixel"===s){var z=a[r];a[r]=o(a[r],!0),f.coercePosition(b,t,d,u,r,.25),b[r]=p(b[r]),a[r]=z}}"path"===g?d("path"):e.noneOrAll(a,b,["x0","x1","y0","y1"])}}var e=a("../../lib"),f=a("../../plots/cartesian/axes"),g=a("../../plots/array_container_defaults"),h=a("./attributes"),i=a("./helpers");b.exports=function(a,b){g(a,b,{name:"shapes",handleItemDefaults:d})}},{"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/cartesian/axes":767,"./attributes":669,"./helpers":674}],673:[function(a,b,c){"use strict";function d(a,b){function c(c){var r={"data-index":b,"fill-rule":"evenodd",d:f(a,d)},s=d.line.width?d.line.color:"rgba(0,0,0,0)",t=c.append("path").attr(r).style("opacity",d.opacity).call(k.stroke,s).call(k.fill,d.fillcolor).call(l.dashLine,d.line.dash,d.line.width);e(t,a,d),a._context.edits.shapePosition&&function(a,b,c,d,k){function r(a){if(Q)L="path"===a.target.tagName?"move":"start-point"===a.target.attributes["data-line-point"].value?"resize-over-start-point":"resize-over-end-point";else{var c=_.element.getBoundingClientRect(),d=c.right-c.left,e=c.bottom-c.top,f=a.clientX-c.left,g=a.clientY-c.top,h=!R&&d>M&&e>N&&!a.shiftKey?n.getCursor(f/d,1-g/e):"move";o(b,h),L=h.split("-")[0]}}function s(d,e){if("path"===c.type){var h=function(a){return a},i=h,j=h;O?T("xanchor",c.xanchor=Y(A+d)):(i=function(a){return Y(W(a)+d)},U&&"date"===U.type&&(i=q.encodeDate(i))),P?T("yanchor",c.yanchor=Z(B+e)):(j=function(a){return Z(X(a)+e)},V&&"date"===V.type&&(j=q.encodeDate(j))),T("path",c.path=g(K,i,j))}else O?T("xanchor",c.xanchor=Y(A+d)):(T("x0",c.x0=Y(w+d)),T("x1",c.x1=Y(y+d))),P?T("yanchor",c.yanchor=Z(B+e)):(T("y0",c.y0=Z(x+e)),T("y1",c.y1=Z(z+e)));b.attr("d",f(a,c)),u(k,c)}function t(d,e){if(R){var h=function(a){return a},i=h,j=h;O?T("xanchor",c.xanchor=Y(A+d)):(i=function(a){return Y(W(a)+d)},U&&"date"===U.type&&(i=q.encodeDate(i))),P?T("yanchor",c.yanchor=Z(B+e)):(j=function(a){return Z(X(a)+e)},V&&"date"===V.type&&(j=q.encodeDate(j))),T("path",c.path=g(K,i,j))}else if(Q){if("resize-over-start-point"===L){var l=w+d,m=P?x-e:x+e;T("x0",c.x0=O?l:Y(l)),T("y0",c.y0=P?m:Z(m))}else if("resize-over-end-point"===L){var n=y+d,o=P?z-e:z+e;T("x1",c.x1=O?n:Y(n)),
T("y1",c.y1=P?o:Z(o))}}else{var p=~L.indexOf("n")?C+e:C,r=~L.indexOf("s")?D+e:D,s=~L.indexOf("w")?E+d:E,t=~L.indexOf("e")?F+d:F;~L.indexOf("n")&&P&&(p=C-e),~L.indexOf("s")&&P&&(r=D-e),(!P&&r-p>N||P&&p-r>N)&&(T(G,c[G]=P?p:Z(p)),T(H,c[H]=P?r:Z(r))),t-s>M&&(T(I,c[I]=O?s:Y(s)),T(J,c[J]=O?t:Y(t)))}b.attr("d",f(a,c)),u(k,c)}function u(a,b){(O||P)&&function(){var c="path"!==b.type,d=a.selectAll(".visual-cue").data([0]);d.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var e=W(O?b.xanchor:i.midRange(c?[b.x0,b.x1]:q.extractPathCoords(b.path,p.paramIsX))),f=X(P?b.yanchor:i.midRange(c?[b.y0,b.y1]:q.extractPathCoords(b.path,p.paramIsY)));if(e=q.roundPositionForSharpStrokeRendering(e,1),f=q.roundPositionForSharpStrokeRendering(f,1),O&&P){var g="M"+(e-1-1)+","+(f-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";d.attr("d",g)}else if(O){var h="M"+(e-1-1)+","+(f-9-1)+"v18 h2 v-18 Z";d.attr("d",h)}else{var j="M"+(e-9-1)+","+(f-1-1)+"h18 v2 h-18 Z";d.attr("d",j)}}()}function v(a){a.selectAll(".visual-cue").remove()}var w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=10,N=10,O="pixel"===c.xsizemode,P="pixel"===c.ysizemode,Q="line"===c.type,R="path"===c.type,S=m(a.layout,"shapes",c),T=S.modifyItem,U=j.getFromId(a,c.xref),V=j.getFromId(a,c.yref),W=q.getDataToPixel(a,U),X=q.getDataToPixel(a,V,!0),Y=q.getPixelToData(a,U),Z=q.getPixelToData(a,V,!0),$=Q?function(){var a=Math.max(c.line.width,10),e=k.append("g").attr("data-index",d);e.append("path").attr("d",b.attr("d")).style({cursor:"move","stroke-width":a,"stroke-opacity":"0"});var f={"fill-opacity":"0"},g=a/2>10?a/2:10;return e.append("circle").attr({"data-line-point":"start-point",cx:O?W(c.xanchor)+c.x0:W(c.x0),cy:P?X(c.yanchor)-c.y0:X(c.y0),r:g}).style(f).classed("cursor-grab",!0),e.append("circle").attr({"data-line-point":"end-point",cx:O?W(c.xanchor)+c.x1:W(c.x1),cy:P?X(c.yanchor)-c.y1:X(c.y1),r:g}).style(f).classed("cursor-grab",!0),e}():b,_={element:$.node(),gd:a,prepFn:function(d){O&&(A=W(c.xanchor)),P&&(B=X(c.yanchor)),"path"===c.type?K=c.path:(w=O?c.x0:W(c.x0),x=P?c.y0:X(c.y0),y=O?c.x1:W(c.x1),z=P?c.y1:X(c.y1)),w<y?(E=w,I="x0",F=y,J="x1"):(E=y,I="x1",F=w,J="x0"),!P&&x<z||P&&x>z?(C=x,G="y0",D=z,H="y1"):(C=z,G="y1",D=x,H="y0"),r(d),u(k,c),function(a,b,c){var d=b.xref,e=b.yref,f=j.getFromId(c,d),g=j.getFromId(c,e),h="";"paper"===d||f.autorange||(h+=d),"paper"===e||g.autorange||(h+=e),l.setClipUrl(a,h?"clip"+c._fullLayout._uid+h:null,c)}(b,c,a),_.moveFn="move"===L?s:t},doneFn:function(){o(b),v(k),e(b,a,c),h.call("_guiRelayout",a,S.getUpdateObj())},clickFn:function(){v(k)}};n.init(_),$.node().onmousemove=r}(a,t,d,b,c)}a._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+b+'"]').remove();var d=a._fullLayout.shapes[b]||{};if(d._input&&!1!==d.visible)if("below"!==d.layer)c(a._fullLayout._shapeUpperLayer);else if("paper"===d.xref||"paper"===d.yref)c(a._fullLayout._shapeLowerLayer);else{var r=a._fullLayout._plots[d.xref+d.yref];c(r?(r.mainplotinfo||r).shapelayer:a._fullLayout._shapeLowerLayer)}}function e(a,b,c){var d=(c.xref+c.yref).replace(/paper/g,"");l.setClipUrl(a,d?"clip"+b._fullLayout._uid+d:null,b)}function f(a,b){var c,d,e,f,g,h,k,l,m=b.type,n=j.getFromId(a,b.xref),o=j.getFromId(a,b.yref),r=a._fullLayout._size;if(n?(c=q.shapePositionToRange(n),d=function(a){return n._offset+n.r2p(c(a,!0))}):d=function(a){return r.l+r.w*a},o?(e=q.shapePositionToRange(o),f=function(a){return o._offset+o.r2p(e(a,!0))}):f=function(a){return r.t+r.h*(1-a)},"path"===m)return n&&"date"===n.type&&(d=q.decodeDate(d)),o&&"date"===o.type&&(f=q.decodeDate(f)),function(a,b,c){var d=a.path,e=a.xsizemode,f=a.ysizemode,g=a.xanchor,h=a.yanchor;return d.replace(p.segmentRE,function(a){var d=0,j=a.charAt(0),k=p.paramIsX[j],l=p.paramIsY[j],m=p.numParams[j],n=a.substr(1).replace(p.paramRE,function(a){return k[d]?a="pixel"===e?b(g)+Number(a):b(a):l[d]&&(a="pixel"===f?c(h)-Number(a):c(a)),++d>m&&(a="X"),a});return d>m&&(n=n.replace(/[\s,]*X.*/,""),i.log("Ignoring extra params in segment "+a)),j+n})}(b,d,f);if("pixel"===b.xsizemode){var s=d(b.xanchor);g=s+b.x0,h=s+b.x1}else g=d(b.x0),h=d(b.x1);if("pixel"===b.ysizemode){var t=f(b.yanchor);k=t-b.y0,l=t-b.y1}else k=f(b.y0),l=f(b.y1);if("line"===m)return"M"+g+","+k+"L"+h+","+l;if("rect"===m)return"M"+g+","+k+"H"+h+"V"+l+"H"+g+"Z";var u=(g+h)/2,v=(k+l)/2,w=Math.abs(u-g),x=Math.abs(v-k),y="A"+w+","+x,z=u+w+","+v;return"M"+z+y+" 0 1,1 "+u+","+(v-x)+y+" 0 0,1 "+z+"Z"}function g(a,b,c){return a.replace(p.segmentRE,function(a){var d=0,e=a.charAt(0),f=p.paramIsX[e],g=p.paramIsY[e],h=p.numParams[e];return e+a.substr(1).replace(p.paramRE,function(a){return d>=h?a:(f[d]?a=b(a):g[d]&&(a=c(a)),d++,a)})})}var h=a("../../registry"),i=a("../../lib"),j=a("../../plots/cartesian/axes"),k=a("../color"),l=a("../drawing"),m=a("../../plot_api/plot_template").arrayEditor,n=a("../dragelement"),o=a("../../lib/setcursor"),p=a("./constants"),q=a("./helpers");b.exports={draw:function(a){var b=a._fullLayout;for(var c in b._shapeUpperLayer.selectAll("path").remove(),b._shapeLowerLayer.selectAll("path").remove(),b._plots){var e=b._plots[c].shapelayer;e&&e.selectAll("path").remove()}for(var f=0;f<b.shapes.length;f++)b.shapes[f].visible&&d(a,f)},drawOne:d}},{"../../lib":719,"../../lib/setcursor":739,"../../plot_api/plot_template":757,"../../plots/cartesian/axes":767,"../../registry":848,"../color":594,"../dragelement":612,"../drawing":615,"./constants":671,"./helpers":674}],674:[function(a,b,c){"use strict";var d=a("./constants"),e=a("../../lib");c.rangeToShapePosition=function(a){return"log"===a.type?a.r2d:function(a){return a}},c.shapePositionToRange=function(a){return"log"===a.type?a.d2r:function(a){return a}},c.decodeDate=function(a){return function(b){return b.replace&&(b=b.replace("_"," ")),a(b)}},c.encodeDate=function(a){return function(b){return a(b).replace(" ","_")}},c.extractPathCoords=function(a,b){var c=[];return a.match(d.segmentRE).forEach(function(a){var f=b[a.charAt(0)].drawn;if(void 0!==f){var g=a.substr(1).match(d.paramRE);!g||g.length<f||c.push(e.cleanNumber(g[f]))}}),c},c.getDataToPixel=function(a,b,d){var e,f=a._fullLayout._size;if(b){var g=c.shapePositionToRange(b);e=function(a){return b._offset+b.r2p(g(a,!0))},"date"===b.type&&(e=c.decodeDate(e))}else e=d?function(a){return f.t+f.h*(1-a)}:function(a){return f.l+f.w*a};return e},c.getPixelToData=function(a,b,d){var e,f=a._fullLayout._size;if(b){var g=c.rangeToShapePosition(b);e=function(a){return g(b.p2r(a-b._offset))}}else e=d?function(a){return 1-(a-f.t)/f.h}:function(a){return(a-f.l)/f.w};return e},c.roundPositionForSharpStrokeRendering=function(a,b){var c=1===Math.round(b%2),d=Math.round(a);return c?d+.5:d}},{"../../lib":719,"./constants":671}],675:[function(a,b,c){"use strict";var d=a("./draw");b.exports={moduleType:"component",name:"shapes",layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),includeBasePlot:a("../../plots/cartesian/include_components")("shapes"),calcAutorange:a("./calc_autorange"),draw:d.draw,drawOne:d.drawOne}},{"../../plots/cartesian/include_components":777,"./attributes":669,"./calc_autorange":670,"./defaults":672,"./draw":673}],676:[function(a,b,c){"use strict";var d=a("../../plots/font_attributes"),e=a("../../plots/pad_attributes"),f=a("../../lib/extend").extendDeepAll,g=a("../../plot_api/edit_types").overrideAll,h=a("../../plots/animation_attributes"),i=a("../../plot_api/plot_template").templatedArray,j=a("./constants"),k=i("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});b.exports=g(i("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:k,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:f(e({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:h.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:d({})},font:d({}),activebgcolor:{valType:"color",dflt:j.gripBgActiveColor},bgcolor:{valType:"color",dflt:j.railBgColor},bordercolor:{valType:"color",dflt:j.railBorderColor},borderwidth:{valType:"number",min:0,dflt:j.railBorderWidth},ticklen:{valType:"number",min:0,dflt:j.tickLength},tickcolor:{valType:"color",dflt:j.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:j.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../../plots/animation_attributes":762,"../../plots/font_attributes":793,"../../plots/pad_attributes":827,"./constants":677}],677:[function(a,b,c){"use strict";b.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],678:[function(a,b,c){"use strict";function d(a,b,c){function d(c,d){return f.coerce(a,b,h,c,d)}for(var i=g(a,b,{name:"steps",handleItemDefaults:e}),j=0,k=0;k<i.length;k++)i[k].visible&&j++;if(j<2?b.visible=!1:d("visible")){b._stepCount=j;var l=b._visibleSteps=f.filterVisible(i);(i[d("active")]||{}).visible||(b.active=l[0]._index),d("x"),d("y"),f.noneOrAll(a,b,["x","y"]),d("xanchor"),d("yanchor"),d("len"),d("lenmode"),d("pad.t"),d("pad.r"),d("pad.b"),d("pad.l"),f.coerceFont(d,"font",c.font),d("currentvalue.visible")&&(d("currentvalue.xanchor"),d("currentvalue.prefix"),d("currentvalue.suffix"),d("currentvalue.offset"),f.coerceFont(d,"currentvalue.font",b.font)),d("transition.duration"),d("transition.easing"),d("bgcolor"),d("activebgcolor"),d("bordercolor"),d("borderwidth"),d("ticklen"),d("tickwidth"),d("tickcolor"),d("minorticklen")}}function e(a,b){function c(c,d){return f.coerce(a,b,j,c,d)}if("skip"===a.method||Array.isArray(a.args)?c("visible"):b.visible=!1){c("method"),c("args");c("value",c("label","step-"+b._index)),c("execute")}}var f=a("../../lib"),g=a("../../plots/array_container_defaults"),h=a("./attributes"),i=a("./constants").name,j=h.steps;b.exports=function(a,b){g(a,b,{name:i,handleItemDefaults:d})}},{"../../lib":719,"../../plots/array_container_defaults":763,"./attributes":676,"./constants":677}],679:[function(a,b,c){"use strict";function d(a){return A.autoMarginIdRoot+a._index}function e(a){return a._index}function f(a,b){var c=w.tester.selectAll("g."+A.labelGroupClass).data(b._visibleSteps);c.enter().append("g").classed(A.labelGroupClass,!0);var e=0,f=0;c.each(function(a){var c=i(t.select(this),{step:a},b).node();if(c){var d=w.bBox(c);f=Math.max(f,d.height),e=Math.max(e,d.width)}}),c.remove();var h=b._dims={};h.inputAreaWidth=Math.max(A.railWidth,A.gripHeight);var j=a._fullLayout._size;h.lx=j.l+j.w*b.x,h.ly=j.t+j.h*(1-b.y),"fraction"===b.lenmode?h.outerLength=Math.round(j.w*b.len):h.outerLength=b.len,h.inputAreaStart=0,h.inputAreaLength=Math.round(h.outerLength-b.pad.l-b.pad.r);var k=(h.inputAreaLength-2*A.stepInset)/(b._stepCount-1),l=e+A.labelPadding;if(h.labelStride=Math.max(1,Math.ceil(l/k)),h.labelHeight=f,h.currentValueMaxWidth=0,h.currentValueHeight=0,h.currentValueTotalHeight=0,h.currentValueMaxLines=1,b.currentvalue.visible){var m=w.tester.append("g");c.each(function(a){var c=g(m,b,a.label),d=c.node()&&w.bBox(c.node())||{width:0,height:0},e=y.lineCount(c);h.currentValueMaxWidth=Math.max(h.currentValueMaxWidth,Math.ceil(d.width)),h.currentValueHeight=Math.max(h.currentValueHeight,Math.ceil(d.height)),h.currentValueMaxLines=Math.max(h.currentValueMaxLines,e)}),h.currentValueTotalHeight=h.currentValueHeight+b.currentvalue.offset,m.remove()}h.height=h.currentValueTotalHeight+A.tickOffset+b.ticklen+A.labelOffset+h.labelHeight+b.pad.t+b.pad.b;var n="left";x.isRightAnchor(b)&&(h.lx-=h.outerLength,n="right"),x.isCenterAnchor(b)&&(h.lx-=h.outerLength/2,n="center");var o="top";x.isBottomAnchor(b)&&(h.ly-=h.height,o="bottom"),x.isMiddleAnchor(b)&&(h.ly-=h.height/2,o="middle"),h.outerLength=Math.ceil(h.outerLength),h.height=Math.ceil(h.height),h.lx=Math.round(h.lx),h.ly=Math.round(h.ly);var p={y:b.y,b:h.height*E[o],t:h.height*D[o]};"fraction"===b.lenmode?(p.l=0,p.xl=b.x-b.len*D[n],p.r=0,p.xr=b.x+b.len*E[n]):(p.x=b.x,p.l=h.outerLength*D[n],p.r=h.outerLength*E[n]),u.autoMargin(a,d(b),p)}function g(a,b,c){if(b.currentvalue.visible){var d,e,f=b._dims;switch(b.currentvalue.xanchor){case"right":d=f.inputAreaLength-A.currentValueInset-f.currentValueMaxWidth,e="left";break;case"center":d=.5*f.inputAreaLength,e="middle";break;default:d=A.currentValueInset,e="left"}var g=x.ensureSingle(a,"text",A.labelClass,function(a){a.classed("user-select-none",!0).attr({"text-anchor":e,"data-notex":1})}),h=b.currentvalue.prefix?b.currentvalue.prefix:"";if("string"==typeof c)h+=c;else{var i=b.steps[b.active].label,j=b._gd._fullLayout._meta;j&&(i=x.templateString(i,j)),h+=i}b.currentvalue.suffix&&(h+=b.currentvalue.suffix),g.call(w.font,b.currentvalue.font).text(h).call(y.convertToTspans,b._gd);var k=y.lineCount(g),l=(f.currentValueMaxLines+1-k)*b.currentvalue.font.size*C;return y.positionText(g,d,l),g}}function h(a,b,c){x.ensureSingle(a,"rect",A.gripRectClass,function(d){d.call(m,b,a,c).style("pointer-events","all")}).attr({width:A.gripWidth,height:A.gripHeight,rx:A.gripRadius,ry:A.gripRadius}).call(v.stroke,c.bordercolor).call(v.fill,c.bgcolor).style("stroke-width",c.borderwidth+"px")}function i(a,b,c){var d=x.ensureSingle(a,"text",A.labelClass,function(a){a.classed("user-select-none",!0).attr({"text-anchor":"middle","data-notex":1})}),e=b.step.label,f=c._gd._fullLayout._meta;return f&&(e=x.templateString(e,f)),d.call(w.font,c.font).text(e).call(y.convertToTspans,c._gd),d}function j(a,b){var c=x.ensureSingle(a,"g",A.labelsClass),d=b._dims,e=c.selectAll("g."+A.labelGroupClass).data(d.labelSteps);e.enter().append("g").classed(A.labelGroupClass,!0),e.exit().remove(),e.each(function(a){var c=t.select(this);c.call(i,a,b),w.setTranslate(c,p(b,a.fraction),A.tickOffset+b.ticklen+b.font.size*C+A.labelOffset+d.currentValueTotalHeight)})}function k(a,b,c,d,e){var f=Math.round(d*(c._stepCount-1)),g=c._visibleSteps[f]._index;g!==c.active&&l(a,b,c,g,!0,e)}function l(a,b,c,d,e,f){var h=c.active;c.active=d,z(a.layout,A.name,c).applyUpdate("active",d);var i=c.steps[c.active];b.call(o,c,f),b.call(g,c),a.emit("plotly_sliderchange",{slider:c,step:c.steps[c.active],interaction:e,previousActive:h}),i&&i.method&&e&&(b._nextMethod?(b._nextMethod.step=i,b._nextMethod.doCallback=e,b._nextMethod.doTransition=f):(b._nextMethod={step:i,doCallback:e,doTransition:f},b._nextMethodRaf=window.requestAnimationFrame(function(){var c=b._nextMethod.step;c.method&&(c.execute&&u.executeAPICommand(a,c.method,c.args),b._nextMethod=null,b._nextMethodRaf=null)})))}function m(a,b,c){function d(){return c.data()[0]}var e=c.node(),f=t.select(b);a.on("mousedown",function(){var a=d();b.emit("plotly_sliderstart",{slider:a});var g=c.select("."+A.gripRectClass);t.event.stopPropagation(),t.event.preventDefault(),g.call(v.fill,a.activebgcolor);var h=q(a,t.mouse(e)[0]);k(b,c,a,h,!0),a._dragging=!0,f.on("mousemove",function(){var a=d(),f=q(a,t.mouse(e)[0]);k(b,c,a,f,!1)}),f.on("mouseup",function(){var a=d();a._dragging=!1,g.call(v.fill,a.bgcolor),f.on("mouseup",null),f.on("mousemove",null),b.emit("plotly_sliderend",{slider:a,step:a.steps[a.active]})})})}function n(a,b){var c=a.selectAll("rect."+A.tickRectClass).data(b._visibleSteps),d=b._dims;c.enter().append("rect").classed(A.tickRectClass,!0),c.exit().remove(),c.attr({width:b.tickwidth+"px","shape-rendering":"crispEdges"}),c.each(function(a,c){var e=c%d.labelStride==0,f=t.select(this);f.attr({height:e?b.ticklen:b.minorticklen}).call(v.fill,b.tickcolor),w.setTranslate(f,p(b,c/(b._stepCount-1))-.5*b.tickwidth,(e?A.tickOffset:A.minorTickOffset)+d.currentValueTotalHeight)})}function o(a,b,c){for(var d=a.select("rect."+A.gripRectClass),e=0,f=0;f<b._stepCount;f++)if(b._visibleSteps[f]._index===b.active){e=f;break}var g=p(b,e/(b._stepCount-1));if(!b._invokingCommand){var h=d;c&&b.transition.duration>0&&(h=h.transition().duration(b.transition.duration).ease(b.transition.easing)),h.attr("transform","translate("+(g-.5*A.gripWidth)+","+b._dims.currentValueTotalHeight+")")}}function p(a,b){var c=a._dims;return c.inputAreaStart+A.stepInset+(c.inputAreaLength-2*A.stepInset)*Math.min(1,Math.max(0,b))}function q(a,b){var c=a._dims;return Math.min(1,Math.max(0,(b-A.stepInset-c.inputAreaStart)/(c.inputAreaLength-2*A.stepInset-2*c.inputAreaStart)))}function r(a,b,c){var d=c._dims,e=x.ensureSingle(a,"rect",A.railTouchRectClass,function(d){d.call(m,b,a,c).style("pointer-events","all")});e.attr({width:d.inputAreaLength,height:Math.max(d.inputAreaWidth,A.tickOffset+c.ticklen+d.labelHeight)}).call(v.fill,c.bgcolor).attr("opacity",0),w.setTranslate(e,0,d.currentValueTotalHeight)}function s(a,b){var c=b._dims,d=c.inputAreaLength-2*A.railInset,e=x.ensureSingle(a,"rect",A.railRectClass);e.attr({width:d,height:A.railWidth,rx:A.railRadius,ry:A.railRadius,"shape-rendering":"crispEdges"}).call(v.stroke,b.bordercolor).call(v.fill,b.bgcolor).style("stroke-width",b.borderwidth+"px"),w.setTranslate(e,A.railInset,.5*(c.inputAreaWidth-A.railWidth)+c.currentValueTotalHeight)}var t=a("d3"),u=a("../../plots/plots"),v=a("../color"),w=a("../drawing"),x=a("../../lib"),y=a("../../lib/svg_text_utils"),z=a("../../plot_api/plot_template").arrayEditor,A=a("./constants"),B=a("../../constants/alignment"),C=B.LINE_SPACING,D=B.FROM_TL,E=B.FROM_BR;b.exports=function(a){function b(b){b._commandObserver&&(b._commandObserver.remove(),delete b._commandObserver),u.autoMargin(a,d(b))}var c=a._fullLayout,i=function(a,b){for(var c=a[A.name],d=[],e=0;e<c.length;e++){var f=c[e];f.visible&&(f._gd=b,d.push(f))}return d}(c,a),k=c._infolayer.selectAll("g."+A.containerClassName).data(i.length>0?[0]:[]);if(k.enter().append("g").classed(A.containerClassName,!0).style("cursor","ew-resize"),k.exit().each(function(){t.select(this).selectAll("g."+A.groupClassName).each(b)}).remove(),0!==i.length){var m=k.selectAll("g."+A.groupClassName).data(i,e);m.enter().append("g").classed(A.groupClassName,!0),m.exit().each(b).remove();for(var p=0;p<i.length;p++){var q=i[p];f(a,q)}m.each(function(b){var c=t.select(this);!function(a){var b=a._dims;b.labelSteps=[];for(var c=a._stepCount,d=0;d<c;d+=b.labelStride)b.labelSteps.push({fraction:d/(c-1),step:a._visibleSteps[d]})}(b),u.manageCommandObserver(a,b,b._visibleSteps,function(b){var d=c.data()[0];d.active!==b.index&&(d._dragging||l(a,c,d,b.index,!1,!0))}),function(a,b,c){(c.steps[c.active]||{}).visible||(c.active=c._visibleSteps[0]._index),b.call(g,c).call(s,c).call(j,c).call(n,c).call(r,a,c).call(h,a,c);var d=c._dims;w.setTranslate(b,d.lx+c.pad.l,d.ly+c.pad.t),b.call(o,c,!1),b.call(g,c)}(a,t.select(this),b)})}}},{"../../constants/alignment":688,"../../lib":719,"../../lib/svg_text_utils":743,"../../plot_api/plot_template":757,"../../plots/plots":828,"../color":594,"../drawing":615,"./constants":677,d3:164}],680:[function(a,b,c){"use strict";var d=a("./constants");b.exports={moduleType:"component",name:d.name,layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),draw:a("./draw")}},{"./attributes":676,"./constants":677,"./defaults":678,"./draw":679}],681:[function(a,b,c){"use strict";var d=a("d3"),e=a("fast-isnumeric"),f=a("../../plots/plots"),g=a("../../registry"),h=a("../../lib"),i=a("../drawing"),j=a("../color"),k=a("../../lib/svg_text_utils"),l=a("../../constants/interactions");b.exports={draw:function(a,b,c){function n(a){h.syncOrAsync([o,p],a)}function o(b){var c;return x?(c="",x.rotate&&(c+="rotate("+[x.rotate,w.x,w.y]+")"),x.offset&&(c+="translate(0, "+x.offset+")")):c=null,b.attr("transform",c),b.style({"font-family":F,"font-size":d.round(G,2)+"px",fill:j.rgb(H),opacity:A*j.opacity(H),"font-weight":f.fontWeight}).attr(w).call(k.convertToTspans,a),f.previousPromises(a)}function p(a){var b=d.select(a.node().parentNode);if(v&&v.selection&&v.side&&D){b.attr("transform",null);var c=0,f={left:"right",right:"left",top:"bottom",bottom:"top"}[v.side],g=-1!==["left","top"].indexOf(v.side)?-1:1,j=e(v.pad)?v.pad:2,k=i.bBox(b.node()),l={left:0,top:0,right:z.width,bottom:z.height},m=v.maxShift||(l[v.side]-k[v.side])*("left"===v.side||"top"===v.side?-1:1);if(m<0)c=m;else{var n=v.offsetLeft||0,o=v.offsetTop||0;k.left-=n,k.right-=n,k.top-=o,k.bottom-=o,v.selection.each(function(){var a=i.bBox(this);h.bBoxIntersect(k,a,j)&&(c=Math.max(c,g*(a[v.side]-k[f])+j))}),c=Math.min(m,c)}if(c>0||m<0){var p={left:[-c,0],right:[c,0],top:[0,-c],bottom:[0,c]}[v.side];b.attr("transform","translate("+p+")")}}}var q,r=c.propContainer,s=c.propName,t=c.placeholder,u=c.traceIndex,v=c.avoid||{},w=c.attributes,x=c.transform,y=c.containerGroup,z=a._fullLayout,A=1,B=!1,C=r.title,D=(C&&C.text?C.text:"").trim(),E=C&&C.font?C.font:{},F=E.family,G=E.size,H=E.color;"title.text"===s?q="titleText":-1!==s.indexOf("axis")?q="axisTitleText":s.indexOf(!0)&&(q="colorbarTitleText");var I=a._context.edits[q];""===D?A=0:D.replace(m," % ")===t.replace(m," % ")&&(A=.2,B=!0,I||(D="")),c._meta?D=h.templateString(D,c._meta):z._meta&&(D=h.templateString(D,z._meta));var J=D||I;y||(y=h.ensureSingle(z._infolayer,"g","g-"+b));var K=y.selectAll("text").data(J?[0]:[]);return K.enter().append("text"),K.text(D).attr("class",b),K.exit().remove(),J?(K.call(n),I&&(D?K.on(".opacity",null):(A=0,B=!0,K.text(t).on("mouseover.opacity",function(){d.select(this).transition().duration(l.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){d.select(this).transition().duration(l.HIDE_PLACEHOLDER).style("opacity",0)})),K.call(k.makeEditable,{gd:a}).on("edit",function(b){void 0!==u?g.call("_guiRestyle",a,s,b,u):g.call("_guiRelayout",a,s,b)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(n)}).on("input",function(a){this.text(a||" ").call(k.positionText,w.x,w.y)})),K.classed("js-placeholder",B),y):y}};var m=/ [XY][0-9]* /},{"../../constants/interactions":694,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/plots":828,"../../registry":848,"../color":594,"../drawing":615,d3:164,"fast-isnumeric":226}],682:[function(a,b,c){"use strict";var d=a("../../plots/font_attributes"),e=a("../color/attributes"),f=a("../../lib/extend").extendFlat,g=a("../../plot_api/edit_types").overrideAll,h=a("../../plots/pad_attributes"),i=a("../../plot_api/plot_template").templatedArray,j=i("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});b.exports=g(i("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:j,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:f(h({editType:"arraydraw"}),{}),font:d({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:e.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../../plots/font_attributes":793,"../../plots/pad_attributes":827,"../color/attributes":593}],683:[function(a,b,c){"use strict";b.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"",right:"",up:"",down:""}}},{}],684:[function(a,b,c){"use strict";function d(a,b,c){function d(c,d){return f.coerce(a,b,h,c,d)}d("visible",g(a,b,{name:"buttons",handleItemDefaults:e}).length>0)&&(d("active"),d("direction"),d("type"),d("showactive"),d("x"),d("y"),f.noneOrAll(a,b,["x","y"]),d("xanchor"),d("yanchor"),d("pad.t"),d("pad.r"),d("pad.b"),d("pad.l"),f.coerceFont(d,"font",c.font),d("bgcolor",c.paper_bgcolor),d("bordercolor"),d("borderwidth"))}function e(a,b){function c(c,d){return f.coerce(a,b,j,c,d)}c("visible","skip"===a.method||Array.isArray(a.args))&&(c("method"),c("args"),c("label"),c("execute"))}var f=a("../../lib"),g=a("../../plots/array_container_defaults"),h=a("./attributes"),i=a("./constants").name,j=h.buttons;b.exports=function(a,b){g(a,b,{name:i,handleItemDefaults:d})}},{"../../lib":719,"../../plots/array_container_defaults":763,"./attributes":682,"./constants":683}],685:[function(a,b,c){"use strict";function d(a){return a._index}function e(a,b){return+a.attr(A.menuIndexAttrName)===b._index}function f(a,b,c,d,e,f,i,j){b.active=i,y(a.layout,A.name,b).applyUpdate("active",i),"buttons"===b.type?h(a,d,null,null,b):"dropdown"===b.type&&(e.attr(A.menuIndexAttrName,"-1"),g(a,d,e,f,b),j||h(a,d,e,f,b))}function g(a,b,c,d,f){var g=w.ensureSingle(b,"g",A.headerClassName,function(a){a.style("pointer-events","all")}),j=f._dims,k=f.active,l=f.buttons[k]||A.blankHeaderOpts,o={y:f.pad.t,yPad:0,x:f.pad.l,xPad:0,index:0},p={width:j.headerWidth,height:j.headerHeight};g.call(i,f,l,a).call(q,f,o,p),w.ensureSingle(b,"text",A.headerArrowClassName,function(a){a.classed("user-select-none",!0).attr("text-anchor","end").call(v.font,f.font).text(A.arrowSymbol[f.direction])}).attr({x:j.headerWidth-A.arrowOffsetX+f.pad.l,y:j.headerHeight/2+A.textOffsetY+f.pad.t}),g.on("click",function(){c.call(r,String(e(c,f)?-1:f._index)),h(a,b,c,d,f)}),g.on("mouseover",function(){g.call(m)}),g.on("mouseout",function(){g.call(n,f)}),v.setTranslate(b,j.lx,j.ly)}function h(a,b,c,d,e){c||(c=b).attr("pointer-events","all");var g=function(a){return-1==+a.attr(A.menuIndexAttrName)}(c)&&"buttons"!==e.type?[]:e.buttons,h="dropdown"===e.type?A.dropdownButtonClassName:A.buttonClassName,j=c.selectAll("g."+h).data(w.filterVisible(g)),k=j.enter().append("g").classed(h,!0),o=j.exit();"dropdown"===e.type?(k.attr("opacity","0").transition().attr("opacity","1"),o.transition().attr("opacity","0").remove()):o.remove();var p=0,r=0,u=e._dims,v=-1!==["up","down"].indexOf(e.direction);"dropdown"===e.type&&(v?r=u.headerHeight+A.gapButtonHeader:p=u.headerWidth+A.gapButtonHeader),"dropdown"===e.type&&"up"===e.direction&&(r=-A.gapButtonHeader+A.gapButton-u.openHeight),"dropdown"===e.type&&"left"===e.direction&&(p=-A.gapButtonHeader+A.gapButton-u.openWidth);var x={x:u.lx+p+e.pad.l,y:u.ly+r+e.pad.t,yPad:A.gapButton,xPad:A.gapButton,index:0},y={l:x.x+e.borderwidth,t:x.y+e.borderwidth};j.each(function(g,h){var k=s.select(this);k.call(i,e,g,a).call(q,e,x),k.on("click",function(){s.event.defaultPrevented||(f(a,e,0,b,c,d,h),g.execute&&t.executeAPICommand(a,g.method,g.args),a.emit("plotly_buttonclicked",{menu:e,button:g,active:e.active}))}),k.on("mouseover",function(){k.call(m)}),k.on("mouseout",function(){k.call(n,e),j.call(l,e)})}),j.call(l,e),v?(y.w=Math.max(u.openWidth,u.headerWidth),y.h=x.y-y.t):(y.w=x.x-y.l,y.h=Math.max(u.openHeight,u.headerHeight)),y.direction=e.direction,d&&(j.size()?function(a,b,c,d,e,f){var g,h,i,j=e.direction,k="up"===j||"down"===j,l=e._dims,m=e.active;if(k)for(h=0,i=0;i<m;i++)h+=l.heights[i]+A.gapButton;else for(g=0,i=0;i<m;i++)g+=l.widths[i]+A.gapButton;d.enable(f,g,h),d.hbar&&d.hbar.attr("opacity","0").transition().attr("opacity","1"),d.vbar&&d.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,d,e,y):function(a){var b=!!a.hbar,c=!!a.vbar;b&&a.hbar.transition().attr("opacity","0").each("end",function(){b=!1,c||a.disable()}),c&&a.vbar.transition().attr("opacity","0").each("end",function(){c=!1,b||a.disable()})}(d))}function i(a,b,c,d){a.call(j,b).call(k,b,c,d)}function j(a,b){w.ensureSingle(a,"rect",A.itemRectClassName,function(a){a.attr({rx:A.rx,ry:A.ry,"shape-rendering":"crispEdges"})}).call(u.stroke,b.bordercolor).call(u.fill,b.bgcolor).style("stroke-width",b.borderwidth+"px")}function k(a,b,c,d){var e=w.ensureSingle(a,"text",A.itemTextClassName,function(a){a.classed("user-select-none",!0).attr({"text-anchor":"start","data-notex":1})}),f=c.label,g=d._fullLayout._meta;g&&(f=w.templateString(f,g)),e.call(v.font,b.font).text(f).call(x.convertToTspans,d)}function l(a,b){var c=b.active;a.each(function(a,d){var e=s.select(this);d===c&&b.showactive&&e.select("rect."+A.itemRectClassName).call(u.fill,A.activeColor)})}function m(a){a.select("rect."+A.itemRectClassName).call(u.fill,A.hoverColor)}function n(a,b){a.select("rect."+A.itemRectClassName).call(u.fill,b.bgcolor)}function o(a,b){var c=b._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},d=v.tester.selectAll("g."+A.dropdownButtonClassName).data(w.filterVisible(b.buttons));d.enter().append("g").classed(A.dropdownButtonClassName,!0);var e=-1!==["up","down"].indexOf(b.direction);d.each(function(d,f){var g=s.select(this);g.call(i,b,d,a);var h=g.select("."+A.itemTextClassName),j=h.node()&&v.bBox(h.node()).width,k=Math.max(j+A.textPadX,A.minWidth),l=b.font.size*z,m=x.lineCount(h),n=Math.max(l*m,A.minHeight)+A.textOffsetY;n=Math.ceil(n),k=Math.ceil(k),c.widths[f]=k,c.heights[f]=n,c.height1=Math.max(c.height1,n),c.width1=Math.max(c.width1,k),e?(c.totalWidth=Math.max(c.totalWidth,k),c.openWidth=c.totalWidth,c.totalHeight+=n+A.gapButton,c.openHeight+=n+A.gapButton):(c.totalWidth+=k+A.gapButton,c.openWidth+=k+A.gapButton,c.totalHeight=Math.max(c.totalHeight,n),c.openHeight=c.totalHeight)}),e?c.totalHeight-=A.gapButton:c.totalWidth-=A.gapButton,c.headerWidth=c.width1+A.arrowPadX,c.headerHeight=c.height1,"dropdown"===b.type&&(e?(c.width1+=A.arrowPadX,c.totalHeight=c.height1):c.totalWidth=c.width1,c.totalWidth+=A.arrowPadX),d.remove()
;var f=c.totalWidth+b.pad.l+b.pad.r,g=c.totalHeight+b.pad.t+b.pad.b,h=a._fullLayout._size;c.lx=h.l+h.w*b.x,c.ly=h.t+h.h*(1-b.y);var j="left";w.isRightAnchor(b)&&(c.lx-=f,j="right"),w.isCenterAnchor(b)&&(c.lx-=f/2,j="center");var k="top";w.isBottomAnchor(b)&&(c.ly-=g,k="bottom"),w.isMiddleAnchor(b)&&(c.ly-=g/2,k="middle"),c.totalWidth=Math.ceil(c.totalWidth),c.totalHeight=Math.ceil(c.totalHeight),c.lx=Math.round(c.lx),c.ly=Math.round(c.ly),t.autoMargin(a,p(b),{x:b.x,y:b.y,l:f*({right:1,center:.5}[j]||0),r:f*({left:1,center:.5}[j]||0),b:g*({top:1,middle:.5}[k]||0),t:g*({bottom:1,middle:.5}[k]||0)})}function p(a){return A.autoMarginIdRoot+a._index}function q(a,b,c,d){d=d||{};var e=a.select("."+A.itemRectClassName),f=a.select("."+A.itemTextClassName),g=b.borderwidth,h=c.index,i=b._dims;v.setTranslate(a,g+c.x,g+c.y);var j=-1!==["up","down"].indexOf(b.direction),k=d.height||(j?i.heights[h]:i.height1);e.attr({x:0,y:0,width:d.width||(j?i.width1:i.widths[h]),height:k});var l=b.font.size*z,m=(x.lineCount(f)-1)*l/2;x.positionText(f,A.textOffsetX,k/2-m+A.textOffsetY),j?c.y+=i.heights[h]+c.yPad:c.x+=i.widths[h]+c.xPad,c.index++}function r(a,b){a.attr(A.menuIndexAttrName,b||"-1").selectAll("g."+A.dropdownButtonClassName).remove()}var s=a("d3"),t=a("../../plots/plots"),u=a("../color"),v=a("../drawing"),w=a("../../lib"),x=a("../../lib/svg_text_utils"),y=a("../../plot_api/plot_template").arrayEditor,z=a("../../constants/alignment").LINE_SPACING,A=a("./constants"),B=a("./scrollbox");b.exports=function(a){function b(b){t.autoMargin(a,p(b))}var c=a._fullLayout,i=w.filterVisible(c[A.name]),j=c._menulayer.selectAll("g."+A.containerClassName).data(i.length>0?[0]:[]);if(j.enter().append("g").classed(A.containerClassName,!0).style("cursor","pointer"),j.exit().each(function(){s.select(this).selectAll("g."+A.headerGroupClassName).each(b)}).remove(),0!==i.length){var k=j.selectAll("g."+A.headerGroupClassName).data(i,d);k.enter().append("g").classed(A.headerGroupClassName,!0);for(var l=w.ensureSingle(j,"g",A.dropdownButtonGroupClassName,function(a){a.style("pointer-events","all")}),m=0;m<i.length;m++){var n=i[m];o(a,n)}var q="updatemenus"+c._uid,u=new B(a,l,q);k.enter().size()&&(l.node().parentNode.appendChild(l.node()),l.call(r)),k.exit().each(function(a){l.call(r),b(a)}).remove(),k.each(function(b){var c=s.select(this),d="dropdown"===b.type?l:null;t.manageCommandObserver(a,b,b.buttons,function(e){f(a,b,b.buttons[e.index],c,d,u,e.index,!0)}),"dropdown"===b.type?(g(a,c,l,u,b),e(l,b)&&h(a,c,l,u,b)):h(a,c,null,null,b)})}}},{"../../constants/alignment":688,"../../lib":719,"../../lib/svg_text_utils":743,"../../plot_api/plot_template":757,"../../plots/plots":828,"../color":594,"../drawing":615,"./constants":683,"./scrollbox":687,d3:164}],686:[function(a,b,c){arguments[4][680][0].apply(c,arguments)},{"./attributes":682,"./constants":683,"./defaults":684,"./draw":685,dup:680}],687:[function(a,b,c){"use strict";function d(a,b,c){this.gd=a,this.container=b,this.id=c,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}b.exports=d;var e=a("d3"),f=a("../color"),g=a("../drawing"),h=a("../../lib");d.barWidth=2,d.barLength=20,d.barRadius=2,d.barPad=1,d.barColor="#808BA4",d.prototype.enable=function(a,b,c){var h=this.gd._fullLayout,i=h.width,j=h.height;this.position=a;var k,l,m,n,o=this.position.l,p=this.position.w,q=this.position.t,r=this.position.h,s=this.position.direction,t="down"===s,u="left"===s,v="up"===s,w=p,x=r;t||u||"right"===s||v||(this.position.direction="down",t=!0),t||v?(l=(k=o)+w,t?(m=q,x=(n=Math.min(m+x,j))-m):x=(n=q+x)-(m=Math.max(n-x,0))):(n=(m=q)+x,u?w=(l=o+w)-(k=Math.max(l-w,0)):(k=o,w=(l=Math.min(k+w,i))-k)),this._box={l:k,t:m,w:w,h:x};var y=p>w,z=d.barLength+2*d.barPad,A=d.barWidth+2*d.barPad,B=o,C=q+r;C+A>j&&(C=j-A);var D=this.container.selectAll("rect.scrollbar-horizontal").data(y?[0]:[]);D.exit().on(".drag",null).remove(),D.enter().append("rect").classed("scrollbar-horizontal",!0).call(f.fill,d.barColor),y?(this.hbar=D.attr({rx:d.barRadius,ry:d.barRadius,x:B,y:C,width:z,height:A}),this._hbarXMin=B+z/2,this._hbarTranslateMax=w-z):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var E=r>x,F=d.barWidth+2*d.barPad,G=d.barLength+2*d.barPad,H=o+p,I=q;H+F>i&&(H=i-F);var J=this.container.selectAll("rect.scrollbar-vertical").data(E?[0]:[]);J.exit().on(".drag",null).remove(),J.enter().append("rect").classed("scrollbar-vertical",!0).call(f.fill,d.barColor),E?(this.vbar=J.attr({rx:d.barRadius,ry:d.barRadius,x:H,y:I,width:F,height:G}),this._vbarYMin=I+G/2,this._vbarTranslateMax=x-G):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var K=this.id,L=k-.5,M=E?l+F+.5:l+.5,N=m-.5,O=y?n+A+.5:n+.5,P=h._topdefs.selectAll("#"+K).data(y||E?[0]:[]);if(P.exit().remove(),P.enter().append("clipPath").attr("id",K).append("rect"),y||E?(this._clipRect=P.select("rect").attr({x:Math.floor(L),y:Math.floor(N),width:Math.ceil(M)-Math.floor(L),height:Math.ceil(O)-Math.floor(N)}),this.container.call(g.setClipUrl,K,this.gd),this.bg.attr({x:o,y:q,width:p,height:r})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(g.setClipUrl,null),delete this._clipRect),y||E){var Q=e.behavior.drag().on("dragstart",function(){e.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(Q);var R=e.behavior.drag().on("dragstart",function(){e.event.sourceEvent.preventDefault(),e.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));y&&this.hbar.on(".drag",null).call(R),E&&this.vbar.on(".drag",null).call(R)}this.setTranslate(b,c)},d.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(g.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},d.prototype._onBoxDrag=function(){var a=this.translateX,b=this.translateY;this.hbar&&(a-=e.event.dx),this.vbar&&(b-=e.event.dy),this.setTranslate(a,b)},d.prototype._onBoxWheel=function(){var a=this.translateX,b=this.translateY;this.hbar&&(a+=e.event.deltaY),this.vbar&&(b+=e.event.deltaY),this.setTranslate(a,b)},d.prototype._onBarDrag=function(){var a=this.translateX,b=this.translateY;if(this.hbar){var c=a+this._hbarXMin,d=c+this._hbarTranslateMax;a=(h.constrain(e.event.x,c,d)-c)/(d-c)*(this.position.w-this._box.w)}if(this.vbar){var f=b+this._vbarYMin,g=f+this._vbarTranslateMax;b=(h.constrain(e.event.y,f,g)-f)/(g-f)*(this.position.h-this._box.h)}this.setTranslate(a,b)},d.prototype.setTranslate=function(a,b){var c=this.position.w-this._box.w,d=this.position.h-this._box.h;if(a=h.constrain(a||0,0,c),b=h.constrain(b||0,0,d),this.translateX=a,this.translateY=b,this.container.call(g.setTranslate,this._box.l-this.position.l-a,this._box.t-this.position.t-b),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+a-.5),y:Math.floor(this.position.t+b-.5)}),this.hbar){var e=a/c;this.hbar.call(g.setTranslate,a+e*this._hbarTranslateMax,b)}if(this.vbar){var f=b/d;this.vbar.call(g.setTranslate,a,b+f*this._vbarTranslateMax)}}},{"../../lib":719,"../color":594,"../drawing":615,d3:164}],688:[function(a,b,c){"use strict";b.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],689:[function(a,b,c){"use strict";b.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:""},DECREASING:{COLOR:"#FF4136",SYMBOL:""}}},{}],690:[function(a,b,c){"use strict";b.exports={FORMAT_LINK:"https://github.com/d3/d3-3.x-api-reference/blob/master/Formatting.md#d3_format",DATE_FORMAT_LINK:"https://github.com/d3/d3-3.x-api-reference/blob/master/Time-Formatting.md#format"}},{}],691:[function(a,b,c){"use strict";b.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],692:[function(a,b,c){"use strict";b.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],693:[function(a,b,c){"use strict";b.exports={circle:"","circle-open":"",square:"","square-open":"",diamond:"","diamond-open":"",cross:"+",x:""}},{}],694:[function(a,b,c){"use strict";b.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],695:[function(a,b,c){"use strict";b.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE/1e4,ONEAVGYEAR:315576e5,ONEAVGMONTH:26298e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:""}},{}],696:[function(a,b,c){"use strict";c.xmlns="http://www.w3.org/2000/xmlns/",c.svg="http://www.w3.org/2000/svg",c.xlink="http://www.w3.org/1999/xlink",c.svgAttrs={xmlns:c.svg,"xmlns:xlink":c.xlink}},{}],697:[function(a,b,c){"use strict";c.version="1.50.0",a("es6-promise").polyfill(),a("../build/plotcss"),a("./fonts/mathjax_config")();for(var d=a("./registry"),e=c.register=d.register,f=a("./plot_api"),g=Object.keys(f),h=0;h<g.length;h++){var i=g[h];"_"!==i.charAt(0)&&(c[i]=f[i]),e({moduleType:"apiMethod",name:i,fn:f[i]})}e(a("./traces/scatter")),e([a("./components/fx"),a("./components/legend"),a("./components/annotations"),a("./components/annotations3d"),a("./components/shapes"),a("./components/images"),a("./components/updatemenus"),a("./components/sliders"),a("./components/rangeslider"),a("./components/rangeselector"),a("./components/grid"),a("./components/errorbars"),a("./components/colorscale"),a("./components/colorbar")]),e([a("./locale-en"),a("./locale-en-us")]),c.Icons=a("./fonts/ploticon"),c.Plots=a("./plots/plots"),c.Fx=a("./components/fx"),c.Snapshot=a("./snapshot"),c.PlotSchema=a("./plot_api/plot_schema"),c.Queue=a("./lib/queue"),c.d3=a("d3")},{"../build/plotcss":1,"./components/annotations":585,"./components/annotations3d":590,"./components/colorbar":600,"./components/colorscale":606,"./components/errorbars":621,"./components/fx":632,"./components/grid":636,"./components/images":641,"./components/legend":649,"./components/rangeselector":660,"./components/rangeslider":667,"./components/shapes":675,"./components/sliders":680,"./components/updatemenus":686,"./fonts/mathjax_config":698,"./fonts/ploticon":699,"./lib/queue":734,"./locale-en":748,"./locale-en-us":747,"./plot_api":752,"./plot_api/plot_schema":756,"./plots/plots":828,"./registry":848,"./snapshot":853,"./traces/scatter":1122,d3:164,"es6-promise":219}],698:[function(a,b,c){"use strict";b.exports=function(){"undefined"!=typeof MathJax&&"local"!==(window.PlotlyConfig||{}).MathJaxConfig&&(MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:!0,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}}),MathJax.Hub.Configured())}},{}],699:[function(a,b,c){"use strict";b.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #119dff;} .cls-2 {fill: #25fefd;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],700:[function(a,b,c){"use strict";c.isLeftAnchor=function(a){return"left"===a.xanchor||"auto"===a.xanchor&&a.x<=1/3},c.isCenterAnchor=function(a){return"center"===a.xanchor||"auto"===a.xanchor&&a.x>1/3&&a.x<2/3},c.isRightAnchor=function(a){return"right"===a.xanchor||"auto"===a.xanchor&&a.x>=2/3},c.isTopAnchor=function(a){return"top"===a.yanchor||"auto"===a.yanchor&&a.y>=2/3},c.isMiddleAnchor=function(a){return"middle"===a.yanchor||"auto"===a.yanchor&&a.y>1/3&&a.y<2/3},c.isBottomAnchor=function(a){return"bottom"===a.yanchor||"auto"===a.yanchor&&a.y<=1/3}},{}],701:[function(a,b,c){"use strict";function d(a){return Math.abs(a[1]-a[0])>l-1e-14}function e(a,b){return j(b-a,l)}function f(a,b){if(d(b))return!0;var c,e;b[0]<b[1]?(c=b[0],e=b[1]):(c=b[1],e=b[0]),(c=i(c,l))>(e=i(e,l))&&(e+=l);var f=i(a,l),g=f+l;return f>=c&&f<=e||g>=c&&g<=e}function g(a,b,c,e,f,g,h){function i(a,b){return[a*Math.cos(b)+f,g-a*Math.sin(b)]}function j(a,b,c){return"A"+[a,a]+" "+[0,t,c]+" "+i(a,b)}f=f||0,g=g||0;var m,n,o,p,q,r=d([c,e]);r?(m=0,n=k,o=l):c<e?(m=c,o=e):(m=e,o=c),a<b?(p=a,q=b):(p=b,q=a);var s,t=Math.abs(o-m)<=k?0:1;return r?s=null===p?"M"+i(q,m)+j(q,n,0)+j(q,o,0)+"Z":"M"+i(p,m)+j(p,n,0)+j(p,o,0)+"ZM"+i(q,m)+j(q,n,1)+j(q,o,1)+"Z":null===p?(s="M"+i(q,m)+j(q,o,0),h&&(s+="L0,0Z")):s="M"+i(p,m)+"L"+i(q,m)+j(q,o,0)+"L"+i(p,o)+j(p,m,1)+"Z",s}var h=a("./mod"),i=h.mod,j=h.modHalf,k=Math.PI,l=2*k;b.exports={deg2rad:function(a){return a/180*k},rad2deg:function(a){return a/k*180},angleDelta:e,angleDist:function(a,b){return Math.abs(e(a,b))},isFullCircle:d,isAngleInsideSector:f,isPtInsideSector:function(a,b,c,d){return!!f(b,d)&&(c[0]<c[1]?(e=c[0],g=c[1]):(e=c[1],g=c[0]),a>=e&&a<=g);var e,g},pathArc:function(a,b,c,d,e){return g(null,a,b,c,d,e,0)},pathSector:function(a,b,c,d,e){return g(null,a,b,c,d,e,1)},pathAnnulus:function(a,b,c,d,e,f){return g(a,b,c,d,e,f,1)}}},{"./mod":726}],702:[function(a,b,c){"use strict";function d(a){return h.isView(a)&&!(a instanceof i)}function e(a){return g(a)||d(a)}function f(a,b,c){if(e(a)){if(e(a[0])){for(var d=c,f=0;f<a.length;f++)d=b(d,a[f].length);return d}return a.length}return 0}var g=Array.isArray,h="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer:{isView:function(){return!1}},i="undefined"==typeof DataView?function(){}:DataView;c.isTypedArray=d,c.isArrayOrTypedArray=e,c.isArray1D=function(a){return!e(a[0])},c.ensureArray=function(a,b){return g(a)||(a=[]),a.length=b,a},c.concat=function(){var a,b,c,d,e,f,h,i,j=[],k=!0,l=0;for(c=0;c<arguments.length;c++)(f=(d=arguments[c]).length)&&(b?j.push(d):(b=d,e=f),g(d)?a=!1:(k=!1,l?a!==d.constructor&&(a=!1):a=d.constructor),l+=f);if(!l)return[];if(!j.length)return b;if(k)return b.concat.apply(b,j);if(a){for((h=new a(l)).set(b),c=0;c<j.length;c++)d=j[c],h.set(d,e),e+=d.length;return h}for(h=new Array(l),i=0;i<b.length;i++)h[i]=b[i];for(c=0;c<j.length;c++){for(d=j[c],i=0;i<d.length;i++)h[e+i]=d[i];e+=i}return h},c.maxRowLength=function(a){return f(a,Math.max,0)},c.minRowLength=function(a){return f(a,Math.min,1/0)}},{}],703:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../constants/numerical").BADNUM,f=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;b.exports=function(a){return"string"==typeof a&&(a=a.replace(f,"")),d(a)?Number(a):e}},{"../constants/numerical":695,"fast-isnumeric":226}],704:[function(a,b,c){"use strict";b.exports=function(a){var b=a._fullLayout;b._glcanvas&&b._glcanvas.size()&&b._glcanvas.each(function(a){a.regl&&a.regl.clear({color:!0,depth:!0})})}},{}],705:[function(a,b,c){"use strict";b.exports=function(a){a._responsiveChartHandler&&(window.removeEventListener("resize",a._responsiveChartHandler),delete a._responsiveChartHandler)}},{}],706:[function(a,b,c){"use strict";function d(a,b){var d=c.valObjectMeta[b.valType];if(b.arrayOk&&m(a))return!0;if(d.validateFunction)return d.validateFunction(a,b);var e={},f=e,g={set:function(a){f=a}};return d.coerceFunction(a,g,e,b),f!==e}var e=a("fast-isnumeric"),f=a("tinycolor2"),g=a("../plots/attributes"),h=a("../components/colorscale/scales"),i=a("../constants/interactions").DESELECTDIM,j=a("./nested_property"),k=a("./regex").counter,l=a("./mod").modHalf,m=a("./array").isArrayOrTypedArray;c.valObjectMeta={data_array:{coerceFunction:function(a,b,c){m(a)?b.set(a):void 0!==c&&b.set(c)}},enumerated:{coerceFunction:function(a,b,c,d){d.coerceNumber&&(a=+a),-1===d.values.indexOf(a)?b.set(c):b.set(a)},validateFunction:function(a,b){b.coerceNumber&&(a=+a);for(var c=b.values,d=0;d<c.length;d++){var e=String(c[d]);if("/"===e.charAt(0)&&"/"===e.charAt(e.length-1)){if(new RegExp(e.substr(1,e.length-2)).test(a))return!0}else if(a===c[d])return!0}return!1}},boolean:{coerceFunction:function(a,b,c){!0===a||!1===a?b.set(a):b.set(c)}},number:{coerceFunction:function(a,b,c,d){!e(a)||void 0!==d.min&&a<d.min||void 0!==d.max&&a>d.max?b.set(c):b.set(+a)}},integer:{coerceFunction:function(a,b,c,d){a%1||!e(a)||void 0!==d.min&&a<d.min||void 0!==d.max&&a>d.max?b.set(c):b.set(+a)}},string:{coerceFunction:function(a,b,c,d){if("string"!=typeof a){var e="number"==typeof a;!0!==d.strict&&e?b.set(String(a)):b.set(c)}else d.noBlank&&!a?b.set(c):b.set(a)}},color:{coerceFunction:function(a,b,c){f(a).isValid()?b.set(a):b.set(c)}},colorlist:{coerceFunction:function(a,b,c){Array.isArray(a)&&a.length&&a.every(function(a){return f(a).isValid()})?b.set(a):b.set(c)}},colorscale:{coerceFunction:function(a,b,c){b.set(h.get(a,c))}},angle:{coerceFunction:function(a,b,c){"auto"===a?b.set("auto"):e(a)?b.set(l(+a,360)):b.set(c)}},subplotid:{coerceFunction:function(a,b,c,d){var e=d.regex||k(c);"string"==typeof a&&e.test(a)?b.set(a):b.set(c)},validateFunction:function(a,b){var c=b.dflt;return a===c||"string"==typeof a&&!!k(c).test(a)}},flaglist:{coerceFunction:function(a,b,c,d){if("string"==typeof a)if(-1===(d.extras||[]).indexOf(a)){for(var e=a.split("+"),f=0;f<e.length;){var g=e[f];-1===d.flags.indexOf(g)||e.indexOf(g)<f?e.splice(f,1):f++}e.length?b.set(e.join("+")):b.set(c)}else b.set(a);else b.set(c)}},any:{coerceFunction:function(a,b,c){void 0===a?b.set(c):b.set(a)}},info_array:{coerceFunction:function(a,b,d,e){function f(a,b,d){var e,f={set:function(a){e=a}};return void 0===d&&(d=b.dflt),c.valObjectMeta[b.valType].coerceFunction(a,f,d,b),e}var g=2===e.dimensions||"1-2"===e.dimensions&&Array.isArray(a)&&Array.isArray(a[0]);if(Array.isArray(a)){var h,i,j,k,l,m,n=e.items,o=[],p=Array.isArray(n),q=p&&g&&Array.isArray(n[0]),r=g&&p&&!q,s=p&&!r?n.length:a.length;if(d=Array.isArray(d)?d:[],g)for(h=0;h<s;h++)for(o[h]=[],j=Array.isArray(a[h])?a[h]:[],l=r?n.length:p?n[h].length:j.length,i=0;i<l;i++)k=r?n[i]:p?n[h][i]:n,void 0!==(m=f(j[i],k,(d[h]||[])[i]))&&(o[h][i]=m);else for(h=0;h<s;h++)void 0!==(m=f(a[h],p?n[h]:n,d[h]))&&(o[h]=m);b.set(o)}else b.set(d)},validateFunction:function(a,b){if(!Array.isArray(a))return!1;var c=b.items,e=Array.isArray(c),f=2===b.dimensions;if(!b.freeLength&&a.length!==c.length)return!1;for(var g=0;g<a.length;g++)if(f){if(!Array.isArray(a[g])||!b.freeLength&&a[g].length!==c[g].length)return!1;for(var h=0;h<a[g].length;h++)if(!d(a[g][h],e?c[g][h]:c))return!1}else if(!d(a[g],e?c[g]:c))return!1;return!0}}},c.coerce=function(a,b,e,f,g){var h=j(e,f).get(),i=j(a,f),k=j(b,f),l=i.get(),n=b._template;if(void 0===l&&n&&(l=j(n,f).get(),n=0),void 0===g&&(g=h.dflt),h.arrayOk&&m(l))return k.set(l),l;var o=c.valObjectMeta[h.valType].coerceFunction;o(l,k,g,h);var p=k.get();return n&&p===g&&!d(l,h)&&(o(l=j(n,f).get(),k,g,h),p=k.get()),p},c.coerce2=function(a,b,d,e,f){var g=j(a,e),h=c.coerce(a,b,d,e,f);return null!=g.get()&&h},c.coerceFont=function(a,b,c){var d={};return c=c||{},d.family=a(b+".family",c.family),d.size=a(b+".size",c.size),d.color=a(b+".color",c.color),d},c.coerceHoverinfo=function(a,b,d){var e,f=b._module.attributes,h=f.hoverinfo?f:g,i=h.hoverinfo;if(1===d._dataLength){var j="all"===i.dflt?i.flags.slice():i.dflt.split("+");j.splice(j.indexOf("name"),1),e=j.join("+")}return c.coerce(a,b,h,"hoverinfo",e)},c.coerceSelectionMarkerOpacity=function(a,b){if(a.marker){var c,d,e=a.marker.opacity;void 0!==e&&(m(e)||a.selected||a.unselected||(c=e,d=i*e),b("selected.marker.opacity",c),b("unselected.marker.opacity",d))}},c.validate=d},{"../components/colorscale/scales":609,"../constants/interactions":694,"../plots/attributes":764,"./array":702,"./mod":726,"./nested_property":727,"./regex":735,"fast-isnumeric":226,tinycolor2:538}],707:[function(a,b,c){"use strict";function d(a){return a&&u.componentsRegistry.calendars&&"string"==typeof a&&"gregorian"!==a}function e(a,b){return String(a+Math.pow(10,b)).substr(1)}function f(a,b,c,d,f){if((b||c||d||f)&&(a+=" "+e(b,2)+":"+e(c,2),(d||f)&&(a+=":"+e(d,2),f))){for(var g=4;f%10==0;)g-=1,f/=10;a+="."+e(f,g)}return a}function g(a,b,c,e){a=a.replace(C,function(a){var c=Math.min(+a.charAt(1)||6,6);return(b/1e3%1+2).toFixed(c).substr(2).replace(/0+$/,"")||"0"});var f=new Date(Math.floor(b+.05));if(d(e))try{a=u.getComponentMethod("calendars","worldCalFmt")(a,b,e)}catch(a){return"Invalid"}return c(a)(f)}var h,i,j=a("d3"),k=a("fast-isnumeric"),l=a("./loggers"),m=a("./mod").mod,n=a("../constants/numerical"),o=n.BADNUM,p=n.ONEDAY,q=n.ONEHOUR,r=n.ONEMIN,s=n.ONESEC,t=n.EPOCHJD,u=a("../registry"),v=j.time.format.utc,w=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m,x=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m,y=(new Date).getFullYear()-70;c.dateTick0=function(a,b){return d(a)?b?u.getComponentMethod("calendars","CANONICAL_SUNDAY")[a]:u.getComponentMethod("calendars","CANONICAL_TICK")[a]:b?"2000-01-02":"2000-01-01"},c.dfltRange=function(a){return d(a)?u.getComponentMethod("calendars","DFLTRANGE")[a]:["2000-01-01","2001-01-01"]},c.isJSDate=function(a){return"object"==typeof a&&null!==a&&"function"==typeof a.getTime},c.dateTime2ms=function(a,b){if(c.isJSDate(a)){var e=a.getTimezoneOffset()*r,f=(a.getUTCMinutes()-a.getMinutes())*r+(a.getUTCSeconds()-a.getSeconds())*s+(a.getUTCMilliseconds()-a.getMilliseconds());if(f){var g=3*r;e=e-g/2+m(f-e+g/2,g)}return(a=Number(a)-e)>=h&&a<=i?a:o}if("string"!=typeof a&&"number"!=typeof a)return o;a=String(a);var j=d(b),k=a.charAt(0);!j||"G"!==k&&"g"!==k||(a=a.substr(1),b="");var l=j&&"chinese"===b.substr(0,7),n=a.match(l?x:w);if(!n)return o;var v=n[1],z=n[3]||"1",A=Number(n[5]||1),B=Number(n[7]||0),C=Number(n[9]||0),D=Number(n[11]||0);if(j){if(2===v.length)return o;var E;v=Number(v);try{var F=u.getComponentMethod("calendars","getCal")(b);if(l){var G="i"===z.charAt(z.length-1);z=parseInt(z,10),E=F.newDate(v,F.toMonthIndex(v,z,G),A)}else E=F.newDate(v,Number(z),A)}catch(a){return o}return E?(E.toJD()-t)*p+B*q+C*r+D*s:o}v=2===v.length?(Number(v)+2e3-y)%100+y:Number(v),z-=1;var H=new Date(Date.UTC(2e3,z,A,B,C));return H.setUTCFullYear(v),H.getUTCMonth()!==z?o:H.getUTCDate()!==A?o:H.getTime()+D*s},h=c.MIN_MS=c.dateTime2ms("-9999"),i=c.MAX_MS=c.dateTime2ms("9999-12-31 23:59:59.9999"),c.isDateTime=function(a,b){return c.dateTime2ms(a,b)!==o};var z=90*p,A=3*q,B=5*r;c.ms2DateTime=function(a,b,c){if("number"!=typeof a||!(a>=h&&a<=i))return o;b||(b=0);var e,g,j,k,l,n,w=Math.floor(10*m(a+.05,1)),x=Math.round(a-w/10);if(d(c)){var y=Math.floor(x/p)+t,C=Math.floor(m(a,p));try{
e=u.getComponentMethod("calendars","getCal")(c).fromJD(y).formatDate("yyyy-mm-dd")}catch(a){e=v("G%Y-%m-%d")(new Date(x))}if("-"===e.charAt(0))for(;e.length<11;)e="-0"+e.substr(1);else for(;e.length<10;)e="0"+e;g=b<z?Math.floor(C/q):0,j=b<z?Math.floor(C%q/r):0,k=b<A?Math.floor(C%r/s):0,l=b<B?C%s*10+w:0}else n=new Date(x),e=v("%Y-%m-%d")(n),g=b<z?n.getUTCHours():0,j=b<z?n.getUTCMinutes():0,k=b<A?n.getUTCSeconds():0,l=b<B?10*n.getUTCMilliseconds()+w:0;return f(e,g,j,k,l)},c.ms2DateTimeLocal=function(a){if(!(a>=h+p&&a<=i-p))return o;var b=Math.floor(10*m(a+.05,1)),c=new Date(Math.round(a-b/10));return f(j.time.format("%Y-%m-%d")(c),c.getHours(),c.getMinutes(),c.getSeconds(),10*c.getUTCMilliseconds()+b)},c.cleanDate=function(a,b,e){if(a===o)return b;if(c.isJSDate(a)||"number"==typeof a&&isFinite(a)){if(d(e))return l.error("JS Dates and milliseconds are incompatible with world calendars",a),b;if(!(a=c.ms2DateTimeLocal(+a))&&void 0!==b)return b}else if(!c.isDateTime(a,e))return l.error("unrecognized date",a),b;return a};var C=/%\d?f/g,D=[59,59.9,59.99,59.999,59.9999];c.formatDate=function(a,b,c,f,h,i){if(h=d(h)&&h,!b)if("y"===c)b=i.year;else if("m"===c)b=i.month;else{if("d"!==c)return function(a,b){var c=m(a+.05,p),d=e(Math.floor(c/q),2)+":"+e(m(Math.floor(c/r),60),2);if("M"!==b){k(b)||(b=0);var f=(100+Math.min(m(a/s,60),D[b])).toFixed(b).substr(1);b>0&&(f=f.replace(/0+$/,"").replace(/[\.]$/,"")),d+=":"+f}return d}(a,c)+"\n"+g(i.dayMonthYear,a,f,h);b=i.dayMonth+"\n"+i.year}return g(b,a,f,h)};var E=3*p;c.incrementMonth=function(a,b,c){c=d(c)&&c;var e=m(a,p);if(a=Math.round(a-e),c)try{var f=Math.round(a/p)+t,g=u.getComponentMethod("calendars","getCal")(c),h=g.fromJD(f);return b%12?g.add(h,b,"m"):g.add(h,b/12,"y"),(h.toJD()-t)*p+e}catch(b){l.error("invalid ms "+a+" in calendar "+c)}var i=new Date(a+E);return i.setUTCMonth(i.getUTCMonth()+b)+e-E},c.findExactDates=function(a,b){for(var c,e,f=0,g=0,h=0,i=0,j=d(b)&&u.getComponentMethod("calendars","getCal")(b),l=0;l<a.length;l++)if(e=a[l],k(e)){if(!(e%p))if(j)try{1===(c=j.fromJD(e/p+t)).day()?1===c.month()?f++:g++:h++}catch(a){}else 1===(c=new Date(e)).getUTCDate()?0===c.getUTCMonth()?f++:g++:h++}else i++;h+=g+=f;var m=a.length-i;return{exactYears:f/m,exactMonths:g/m,exactDays:h/m}}},{"../constants/numerical":695,"../registry":848,"./loggers":723,"./mod":726,d3:164,"fast-isnumeric":226}],708:[function(a,b,c){"use strict";function d(a){var b=a&&a.parentNode;b&&b.removeChild(a)}function e(a,b,c){var d="plotly.js-style-"+a,e=document.getElementById(d);e||((e=document.createElement("style")).setAttribute("id",d),e.appendChild(document.createTextNode("")),document.head.appendChild(e));var f=e.sheet;f.insertRule?f.insertRule(b+"{"+c+"}",0):f.addRule?f.addRule(b,c,0):g.warn("addStyleRule failed")}var f=a("d3"),g=a("./loggers");b.exports={getGraphDiv:function(a){var b;if("string"==typeof a){if(null===(b=document.getElementById(a)))throw new Error("No DOM element with id '"+a+"' exists on the page.");return b}if(null==a)throw new Error("DOM element provided is null or undefined");return a},isPlotDiv:function(a){var b=f.select(a);return b.node()instanceof HTMLElement&&b.size()&&b.classed("js-plotly-plot")},removeElement:d,addStyleRule:function(a,b){e("global",a,b)},addRelatedStyleRule:e,deleteRelatedStyleRule:function(a){var b="plotly.js-style-"+a,c=document.getElementById(b);c&&d(c)}}},{"./loggers":723,d3:164}],709:[function(a,b,c){"use strict";var d=a("events").EventEmitter,e={init:function(a){if(a._ev instanceof d)return a;var b=new d,c=new d;return a._ev=b,a._internalEv=c,a.on=b.on.bind(b),a.once=b.once.bind(b),a.removeListener=b.removeListener.bind(b),a.removeAllListeners=b.removeAllListeners.bind(b),a._internalOn=c.on.bind(c),a._internalOnce=c.once.bind(c),a._removeInternalListener=c.removeListener.bind(c),a._removeAllInternalListeners=c.removeAllListeners.bind(c),a.emit=function(d,e){"undefined"!=typeof jQuery&&jQuery(a).trigger(d,e),b.emit(d,e),c.emit(d,e)},a},triggerHandler:function(a,b,c){function d(a){return a.listener?(g.removeListener(b,a.listener),a.fired?void 0:(a.fired=!0,a.listener.apply(g,[c]))):a.apply(g,[c])}var e,f;"undefined"!=typeof jQuery&&(e=jQuery(a).triggerHandler(b,c));var g=a._ev;if(!g)return e;var h,i=g._events[b];if(!i)return e;for(i=Array.isArray(i)?i:[i],h=0;h<i.length-1;h++)d(i[h]);return f=d(i[h]),void 0!==e?e:f},purge:function(a){return delete a._ev,delete a.on,delete a.once,delete a.removeListener,delete a.removeAllListeners,delete a.emit,delete a._ev,delete a._internalEv,delete a._internalOn,delete a._internalOnce,delete a._removeInternalListener,delete a._removeAllInternalListeners,a}};b.exports=e},{events:105}],710:[function(a,b,c){"use strict";function d(a,b,c,g){var h,i,j,k,l,m,n=a[0],o=a.length;if(2===o&&f(n)&&f(a[1])&&0===n.length){if(function(a,b){var c,d;for(c=0;c<a.length;c++){if(null!==(d=a[c])&&"object"==typeof d)return!1;void 0!==d&&(b[c]=d)}return!0}(a[1],n))return n;n.splice(0,n.length)}for(var p=1;p<o;p++)for(i in h=a[p])j=n[i],k=h[i],g&&f(k)?n[i]=k:b&&k&&(e(k)||(l=f(k)))?(l?(l=!1,m=j&&f(j)?j:[]):m=j&&e(j)?j:{},n[i]=d([m,k],b,c,g)):(void 0!==k||c)&&(n[i]=k);return n}var e=a("./is_plain_object.js"),f=Array.isArray;c.extendFlat=function(){return d(arguments,!1,!1,!1)},c.extendDeep=function(){return d(arguments,!0,!1,!1)},c.extendDeepAll=function(){return d(arguments,!0,!0,!1)},c.extendDeepNoArrays=function(){return d(arguments,!0,!1,!0)}},{"./is_plain_object.js":720}],711:[function(a,b,c){"use strict";b.exports=function(a){for(var b={},c=[],d=0,e=0;e<a.length;e++){var f=a[e];1!==b[f]&&(b[f]=1,c[d++]=f)}return c}},{}],712:[function(a,b,c){"use strict";function d(a){return!0===a.visible}function e(a){var b=a[0].trace;return!0===b.visible&&0!==b._length}b.exports=function(a){for(var b,c=(b=a,Array.isArray(b)&&Array.isArray(b[0])&&b[0][0]&&b[0][0].trace?e:d),f=[],g=0;g<a.length;g++){var h=a[g];c(h)&&f.push(h)}return f}},{}],713:[function(a,b,c){"use strict";var d=a("country-regex"),e=a("../lib"),f=Object.keys(d),g={"ISO-3":e.identity,"USA-states":e.identity,"country names":function(a){for(var b=0;b<f.length;b++){var c=f[b];if(new RegExp(d[c]).test(a.trim().toLowerCase()))return c}return e.log("Unrecognized country name: "+a+"."),!1}};b.exports={locationToFeature:function(a,b,c){if(!b||"string"!=typeof b)return!1;var d,f,h,i=g[a](b);if(i){if("USA-states"===a)for(d=[],h=0;h<c.length;h++)(f=c[h]).properties&&f.properties.gu&&"USA"===f.properties.gu&&d.push(f);else d=c;for(h=0;h<d.length;h++)if((f=d[h]).id===i)return f;e.log(["Location with id",i,"does not have a matching topojson feature at this resolution."].join(" "))}return!1}}},{"../lib":719,"country-regex":135}],714:[function(a,b,c){"use strict";var d=a("../constants/numerical").BADNUM;c.calcTraceToLineCoords=function(a){for(var b=a[0].trace.connectgaps,c=[],e=[],f=0;f<a.length;f++){var g=a[f].lonlat;g[0]!==d?e.push(g):!b&&e.length>0&&(c.push(e),e=[])}return e.length>0&&c.push(e),c},c.makeLine=function(a){return 1===a.length?{type:"LineString",coordinates:a[0]}:{type:"MultiLineString",coordinates:a}},c.makePolygon=function(a){if(1===a.length)return{type:"Polygon",coordinates:a};for(var b=new Array(a.length),c=0;c<a.length;c++)b[c]=[a[c]];return{type:"MultiPolygon",coordinates:b}},c.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":695}],715:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g,h){var i=c-a,j=e-a,k=g-e,l=d-b,m=f-b,n=h-f,o=i*n-k*l;if(0===o)return null;var p=(j*n-k*m)/o,q=(j*l-i*m)/o;return q<0||q>1||p<0||p>1?null:{x:a+i*p,y:b+l*p}}function e(a,b,c,d,e){var f=d*a+e*b;if(f<0)return d*d+e*e;if(f>c){var g=d-a,h=e-b;return g*g+h*h}var i=d*b-e*a;return i*i/c}var f,g,h,i=a("./mod").mod;c.segmentsIntersect=d,c.segmentDistance=function(a,b,c,f,g,h,i,j){if(d(a,b,c,f,g,h,i,j))return 0;var k=c-a,l=f-b,m=i-g,n=j-h,o=k*k+l*l,p=m*m+n*n,q=Math.min(e(k,l,o,g-a,h-b),e(k,l,o,i-a,j-b),e(m,n,p,a-g,b-h),e(m,n,p,c-g,f-h));return Math.sqrt(q)},c.getTextLocation=function(a,b,c,d){if(a===g&&d===h||(f={},g=a,h=d),f[c])return f[c];var e=a.getPointAtLength(i(c-d/2,b)),j=a.getPointAtLength(i(c+d/2,b)),k=Math.atan((j.y-e.y)/(j.x-e.x)),l=a.getPointAtLength(i(c,b)),m={x:(4*l.x+e.x+j.x)/6,y:(4*l.y+e.y+j.y)/6,theta:k};return f[c]=m,m},c.clearLocationCache=function(){g=null},c.getVisibleSegment=function(a,b,c){function d(b){var c=a.getPointAtLength(b);0===b?e=c:b===l&&(f=c);var d=c.x<g?g-c.x:c.x>h?c.x-h:0,k=c.y<i?i-c.y:c.y>j?c.y-j:0;return Math.sqrt(d*d+k*k)}for(var e,f,g=b.left,h=b.right,i=b.top,j=b.bottom,k=0,l=a.getTotalLength(),m=l,n=d(k);n;){if((k+=n+c)>m)return;n=d(k)}for(n=d(m);n;){if(k>(m-=n+c))return;n=d(m)}return{min:k,max:m,len:m-k,total:l,isClosed:0===k&&m===l&&Math.abs(e.x-f.x)<.1&&Math.abs(e.y-f.y)<.1}},c.findPointOnPath=function(a,b,c,d){for(var e,f,g,h=(d=d||{}).pathLength||a.getTotalLength(),i=d.tolerance||.001,j=d.iterationLimit||30,k=a.getPointAtLength(0)[c]>a.getPointAtLength(h)[c]?-1:1,l=0,m=0,n=h;l<j;){if(e=(m+n)/2,g=(f=a.getPointAtLength(e))[c]-b,Math.abs(g)<i)return f;k*g>0?n=e:m=e,l++}return f}},{"./mod":726}],716:[function(a,b,c){"use strict";function d(a,b){var c=a;return c[3]*=b,c}function e(a){if(g(a))return m;var b=i(a);return b.length?b:m}function f(a){return g(a)?a:n}var g=a("fast-isnumeric"),h=a("tinycolor2"),i=a("color-normalize"),j=a("../components/colorscale"),k=a("../components/color/attributes").defaultLine,l=a("./array").isArrayOrTypedArray,m=i(k),n=1;b.exports={formatColor:function(a,b,c){var g,h,k,o,p,q=a.color,r=l(q),s=l(b),t=j.extractOpts(a),u=[];if(g=void 0!==t.colorscale?j.makeColorScaleFuncFromTrace(a):e,h=r?function(a,b){return void 0===a[b]?m:i(g(a[b]))}:e,k=s?function(a,b){return void 0===a[b]?n:f(a[b])}:f,r||s)for(var v=0;v<c;v++)o=h(q,v),p=k(b,v),u[v]=d(o,p);else u=d(i(q),b);return u},parseColorScale:function(a,b){void 0===b&&(b=1);var c=j.extractOpts(a);return(c.reversescale?j.flipScale(c.colorscale):c.colorscale).map(function(a){var c=a[0],d=h(a[1]).toRgb();return{index:c,rgb:[d.r,d.g,d.b,b]}})}}},{"../components/color/attributes":593,"../components/colorscale":606,"./array":702,"color-normalize":121,"fast-isnumeric":226,tinycolor2:538}],717:[function(a,b,c){"use strict";function d(a){return[a]}var e=a("./identity");b.exports={keyFun:function(a){return a.key},repeat:d,descend:e,wrap:d,unwrap:function(a){return a[0]}}},{"./identity":718}],718:[function(a,b,c){"use strict";b.exports=function(a){return a}},{}],719:[function(a,b,c){"use strict";function d(a){var b={};for(var c in a)for(var d=a[c],e=0;e<d.length;e++)b[d[e]]=+c;return b}function e(a,b,c){var d=this,e=arguments;b||(b={});var g={};return a.replace(k.TEMPLATE_STRING_REGEX,function(a,h,i){var j,l,m,n;for(m=3;m<e.length;m++)if(j=e[m]){if(j.hasOwnProperty(h)){l=j[h];break}if(E.test(h)||(l=g[h]||k.nestedProperty(j,h).get())&&(g[h]=l),void 0!==l)break}if(void 0===l&&d)return d.count<d.max&&(k.warn("Variable '"+h+"' in "+d.name+" could not be found!"),l=a),d.count===d.max&&k.warn("Too many "+d.name+" warnings - additional warnings will be suppressed"),d.count++,a;if(i){if(":"===i[0]&&(l=(n=c?c.numberFormat:f.format)(i.replace(H,""))(l)),"|"===i[0]){n=c?c.timeFormat.utc:f.time.format.utc;var o=k.dateTime2ms(l);l=k.formatDate(o,i.replace(H,""),!1,n)}}else b.hasOwnProperty(h+"Label")&&(l=b[h+"Label"]);return l})}var f=a("d3"),g=a("fast-isnumeric"),h=a("../constants/numerical"),i=h.FP_SAFE,j=h.BADNUM,k=b.exports={};k.nestedProperty=a("./nested_property"),k.keyedContainer=a("./keyed_container"),k.relativeAttr=a("./relative_attr"),k.isPlainObject=a("./is_plain_object"),k.toLogRange=a("./to_log_range"),k.relinkPrivateKeys=a("./relink_private");var l=a("./array");k.isTypedArray=l.isTypedArray,k.isArrayOrTypedArray=l.isArrayOrTypedArray,k.isArray1D=l.isArray1D,k.ensureArray=l.ensureArray,k.concat=l.concat,k.maxRowLength=l.maxRowLength,k.minRowLength=l.minRowLength;var m=a("./mod");k.mod=m.mod,k.modHalf=m.modHalf;var n=a("./coerce");k.valObjectMeta=n.valObjectMeta,k.coerce=n.coerce,k.coerce2=n.coerce2,k.coerceFont=n.coerceFont,k.coerceHoverinfo=n.coerceHoverinfo,k.coerceSelectionMarkerOpacity=n.coerceSelectionMarkerOpacity,k.validate=n.validate;var o=a("./dates");k.dateTime2ms=o.dateTime2ms,k.isDateTime=o.isDateTime,k.ms2DateTime=o.ms2DateTime,k.ms2DateTimeLocal=o.ms2DateTimeLocal,k.cleanDate=o.cleanDate,k.isJSDate=o.isJSDate,k.formatDate=o.formatDate,k.incrementMonth=o.incrementMonth,k.dateTick0=o.dateTick0,k.dfltRange=o.dfltRange,k.findExactDates=o.findExactDates,k.MIN_MS=o.MIN_MS,k.MAX_MS=o.MAX_MS;var p=a("./search");k.findBin=p.findBin,k.sorterAsc=p.sorterAsc,k.sorterDes=p.sorterDes,k.distinctVals=p.distinctVals,k.roundUp=p.roundUp,k.sort=p.sort,k.findIndexOfMin=p.findIndexOfMin;var q=a("./stats");k.aggNums=q.aggNums,k.len=q.len,k.mean=q.mean,k.median=q.median,k.midRange=q.midRange,k.variance=q.variance,k.stdev=q.stdev,k.interp=q.interp;var r=a("./matrix");k.init2dArray=r.init2dArray,k.transposeRagged=r.transposeRagged,k.dot=r.dot,k.translationMatrix=r.translationMatrix,k.rotationMatrix=r.rotationMatrix,k.rotationXYMatrix=r.rotationXYMatrix,k.apply2DTransform=r.apply2DTransform,k.apply2DTransform2=r.apply2DTransform2;var s=a("./angles");k.deg2rad=s.deg2rad,k.rad2deg=s.rad2deg,k.angleDelta=s.angleDelta,k.angleDist=s.angleDist,k.isFullCircle=s.isFullCircle,k.isAngleInsideSector=s.isAngleInsideSector,k.isPtInsideSector=s.isPtInsideSector,k.pathArc=s.pathArc,k.pathSector=s.pathSector,k.pathAnnulus=s.pathAnnulus;var t=a("./anchor_utils");k.isLeftAnchor=t.isLeftAnchor,k.isCenterAnchor=t.isCenterAnchor,k.isRightAnchor=t.isRightAnchor,k.isTopAnchor=t.isTopAnchor,k.isMiddleAnchor=t.isMiddleAnchor,k.isBottomAnchor=t.isBottomAnchor;var u=a("./geometry2d");k.segmentsIntersect=u.segmentsIntersect,k.segmentDistance=u.segmentDistance,k.getTextLocation=u.getTextLocation,k.clearLocationCache=u.clearLocationCache,k.getVisibleSegment=u.getVisibleSegment,k.findPointOnPath=u.findPointOnPath;var v=a("./extend");k.extendFlat=v.extendFlat,k.extendDeep=v.extendDeep,k.extendDeepAll=v.extendDeepAll,k.extendDeepNoArrays=v.extendDeepNoArrays;var w=a("./loggers");k.log=w.log,k.warn=w.warn,k.error=w.error;var x=a("./regex");k.counterRegex=x.counter;var y=a("./throttle");k.throttle=y.throttle,k.throttleDone=y.done,k.clearThrottle=y.clear;var z=a("./dom");k.getGraphDiv=z.getGraphDiv,k.isPlotDiv=z.isPlotDiv,k.removeElement=z.removeElement,k.addStyleRule=z.addStyleRule,k.addRelatedStyleRule=z.addRelatedStyleRule,k.deleteRelatedStyleRule=z.deleteRelatedStyleRule,k.clearResponsive=a("./clear_responsive"),k.makeTraceGroups=a("./make_trace_groups"),k._=a("./localize"),k.notifier=a("./notifier"),k.filterUnique=a("./filter_unique"),k.filterVisible=a("./filter_visible"),k.pushUnique=a("./push_unique"),k.cleanNumber=a("./clean_number"),k.ensureNumber=function(a){return g(a)?(a=Number(a))<-i||a>i?j:g(a)?Number(a):j:j},k.isIndex=function(a,b){return!(void 0!==b&&a>=b)&&g(a)&&a>=0&&a%1==0},k.noop=a("./noop"),k.identity=a("./identity"),k.repeat=function(a,b){for(var c=new Array(b),d=0;d<b;d++)c[d]=a;return c},k.swapAttrs=function(a,b,c,d){c||(c="x"),d||(d="y");for(var e=0;e<b.length;e++){var f=b[e],g=k.nestedProperty(a,f.replace("?",c)),h=k.nestedProperty(a,f.replace("?",d)),i=g.get();g.set(h.get()),h.set(i)}},k.raiseToTop=function(a){a.parentNode.appendChild(a)},k.cancelTransition=function(a){return a.transition().duration(0)},k.constrain=function(a,b,c){return b>c?Math.max(c,Math.min(b,a)):Math.max(b,Math.min(c,a))},k.bBoxIntersect=function(a,b,c){return c=c||0,a.left<=b.right+c&&b.left<=a.right+c&&a.top<=b.bottom+c&&b.top<=a.bottom+c},k.simpleMap=function(a,b,c,d){for(var e=a.length,f=new Array(e),g=0;g<e;g++)f[g]=b(a[g],c,d);return f},k.randstr=function a(b,c,d,e){if(d||(d=16),void 0===c&&(c=24),c<=0)return"0";var f,g,h=Math.log(Math.pow(2,c))/Math.log(d),i="";for(f=2;h===1/0;f*=2)h=Math.log(Math.pow(2,c/f))/Math.log(d)*f;var j=h-Math.floor(h);for(f=0;f<Math.floor(h);f++)i=Math.floor(Math.random()*d).toString(d)+i;j&&(g=Math.pow(d,j),i=Math.floor(Math.random()*g).toString(d)+i);var l=parseInt(i,d);return b&&b[i]||l!==1/0&&l>=Math.pow(2,c)?e>10?(k.warn("randstr failed uniqueness"),i):a(b,c,d,(e||0)+1):i},k.OptionControl=function(a,b){a||(a={}),b||(b="opt");var c={optionList:[],_newoption:function(d){d[b]=a,c[d.name]=d,c.optionList.push(d)}};return c["_"+b]=a,c},k.smooth=function(a,b){if((b=Math.round(b)||0)<2)return a;var c,d,e,f,g=a.length,h=2*g,i=2*b-1,j=new Array(i),k=new Array(g);for(c=0;c<i;c++)j[c]=(1-Math.cos(Math.PI*(c+1)/b))/(2*b);for(c=0;c<g;c++){for(f=0,d=0;d<i;d++)(e=c+d+1-b)<-g?e-=h*Math.round(e/h):e>=h&&(e-=h*Math.floor(e/h)),e<0?e=-1-e:e>=g&&(e=h-1-e),f+=a[e]*j[d];k[c]=f}return k},k.syncOrAsync=function(a,b,c){function d(){return k.syncOrAsync(a,b,c)}for(var e;a.length;)if((e=(0,a.splice(0,1)[0])(b))&&e.then)return e.then(d).then(void 0,k.promiseError);return c&&c(b)},k.stripTrailingSlash=function(a){return"/"===a.substr(-1)?a.substr(0,a.length-1):a},k.noneOrAll=function(a,b,c){if(a){var d,e=!1,f=!0;for(d=0;d<c.length;d++)null!=a[c[d]]?e=!0:f=!1;if(e&&!f)for(d=0;d<c.length;d++)a[c[d]]=b[c[d]]}},k.mergeArray=function(a,b,c,d){var e="function"==typeof d;if(k.isArrayOrTypedArray(a))for(var f=Math.min(a.length,b.length),g=0;g<f;g++){var h=a[g];b[g][c]=e?d(h):h}},k.mergeArrayCastPositive=function(a,b,c){return k.mergeArray(a,b,c,function(a){var b=+a;return isFinite(b)&&b>0?b:0})},k.fillArray=function(a,b,c,d){if(d=d||k.identity,k.isArrayOrTypedArray(a))for(var e=0;e<b.length;e++)b[e][c]=d(a[e])},k.castOption=function(a,b,c,d){d=d||k.identity;var e=k.nestedProperty(a,c).get();return k.isArrayOrTypedArray(e)?d(Array.isArray(b)&&k.isArrayOrTypedArray(e[b[0]])?e[b[0]][b[1]]:e[b]):e},k.extractOption=function(a,b,c,d){if(c in a)return a[c];var e=k.nestedProperty(b,d).get();return Array.isArray(e)?void 0:e},k.tagSelected=function(a,b,c){var e,f,g=b.selectedpoints,h=b._indexToPoints;h&&(e=d(h));for(var i=0;i<g.length;i++){var j=g[i];if(k.isIndex(j)){var l=e?e[j]:j,m=c?c[l]:l;void 0!==(f=m)&&f<a.length&&(a[m].selected=1)}}},k.selIndices2selPoints=function(a){var b=a.selectedpoints,c=a._indexToPoints;if(c){for(var e=d(c),f=[],g=0;g<b.length;g++){var h=b[g];if(k.isIndex(h)){var i=e[h];k.isIndex(i)&&f.push(i)}}return f}return b},k.getTargetArray=function(a,b){var c=b.target;if("string"==typeof c&&c){var d=k.nestedProperty(a,c).get();return!!Array.isArray(d)&&d}return!!Array.isArray(c)&&c},k.minExtend=function(a,b){var c={};"object"!=typeof b&&(b={});var d,e,f,g=Object.keys(a);for(d=0;d<g.length;d++)f=a[e=g[d]],"_"!==e.charAt(0)&&"function"!=typeof f&&("module"===e?c[e]=f:Array.isArray(f)?c[e]="colorscale"===e?f.slice():f.slice(0,3):c[e]=f&&"object"==typeof f?k.minExtend(a[e],b[e]):f);for(g=Object.keys(b),d=0;d<g.length;d++)"object"==typeof(f=b[e=g[d]])&&e in c&&"object"==typeof c[e]||(c[e]=f);return c},k.titleCase=function(a){return a.charAt(0).toUpperCase()+a.substr(1)},k.containsAny=function(a,b){for(var c=0;c<b.length;c++)if(-1!==a.indexOf(b[c]))return!0;return!1},k.isIE=function(){return void 0!==window.navigator.msSaveBlob};var A=/MSIE [1-9]\./;k.isIE9orBelow=function(){return k.isIE()&&A.test(window.navigator.userAgent)};var B=/Version\/[\d\.]+.*Safari/;k.isSafari=function(){return B.test(window.navigator.userAgent)},k.isD3Selection=function(a){return a&&"function"==typeof a.classed},k.ensureSingle=function(a,b,c,d){var e=a.select(b+(c?"."+c:""));if(e.size())return e;var f=a.append(b);return c&&f.classed(c,!0),d&&f.call(d),f},k.ensureSingleById=function(a,b,c,d){var e=a.select(b+"#"+c);if(e.size())return e;var f=a.append(b).attr("id",c);return d&&f.call(d),f},k.objectFromPath=function(a,b){for(var c,d=a.split("."),e=c={},f=0;f<d.length;f++){var g=d[f],h=null,i=d[f].match(/(.*)\[([0-9]+)\]/);i?(g=i[1],h=i[2],c=c[g]=[],f===d.length-1?c[h]=b:c[h]={},c=c[h]):(f===d.length-1?c[g]=b:c[g]={},c=c[g])}return e};var C=/^([^\[\.]+)\.(.+)?/,D=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;k.expandObjectPaths=function(a){var b,c,d,e,f,g,h;if("object"==typeof a&&!Array.isArray(a))for(c in a)a.hasOwnProperty(c)&&((b=c.match(C))?(e=a[c],d=b[1],delete a[c],a[d]=k.extendDeepNoArrays(a[d]||{},k.objectFromPath(c,k.expandObjectPaths(e))[d])):(b=c.match(D))?(e=a[c],d=b[1],f=parseInt(b[2]),delete a[c],a[d]=a[d]||[],"."===b[3]?(h=b[4],g=a[d][f]=a[d][f]||{},k.extendDeepNoArrays(g,k.objectFromPath(h,k.expandObjectPaths(e)))):a[d][f]=k.expandObjectPaths(e)):a[c]=k.expandObjectPaths(a[c]));return a},k.numSeparate=function(a,b,c){if(c||(c=!1),"string"!=typeof b||0===b.length)throw new Error("Separator string required for formatting!");"number"==typeof a&&(a=String(a));var d=/(\d+)(\d{3})/,e=b.charAt(0),f=b.charAt(1),g=a.split("."),h=g[0],i=g.length>1?e+g[1]:"";if(f&&(g.length>1||h.length>4||c))for(;d.test(h);)h=h.replace(d,"$1"+f+"$2");return h+i},k.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var E=/^\w*$/;k.templateString=function(a,b){var c={};return a.replace(k.TEMPLATE_STRING_REGEX,function(a,d){return E.test(d)?b[d]||"":(c[d]=c[d]||k.nestedProperty(b,d).get,c[d]()||"")})};var F={max:10,count:0,name:"hovertemplate"};k.hovertemplateString=function(){return e.apply(F,arguments)};var G={max:10,count:0,name:"texttemplate"};k.texttemplateString=function(){return e.apply(G,arguments)};var H=/^[:|\|]/;k.subplotSort=function(a,b){for(var c=Math.min(a.length,b.length)+1,d=0,e=0,f=0;f<c;f++){var g=a.charCodeAt(f)||0,h=b.charCodeAt(f)||0,i=g>=48&&g<=57,j=h>=48&&h<=57;if(i&&(d=10*d+g-48),j&&(e=10*e+h-48),!i||!j){if(d!==e)return d-e;if(g!==h)return g-h}}return e-d};var I=2e9;k.seedPseudoRandom=function(){I=2e9},k.pseudoRandom=function(){var a=I;return I=(69069*I+1)%4294967296,Math.abs(I-a)<429496729?k.pseudoRandom():I/4294967296},k.fillText=function(a,b,c){var d=Array.isArray(c)?function(a){c.push(a)}:function(a){c.text=a},e=k.extractOption(a,b,"htx","hovertext");if(k.isValidTextValue(e))return d(e);var f=k.extractOption(a,b,"tx","text");return k.isValidTextValue(f)?d(f):void 0},k.isValidTextValue=function(a){return a||0===a},k.formatPercent=function(a,b){b=b||0;for(var c=(Math.round(100*a*Math.pow(10,b))*Math.pow(.1,b)).toFixed(b)+"%",d=0;d<b;d++)-1!==c.indexOf(".")&&(c=(c=c.replace("0%","%")).replace(".%","%"));return c},k.isHidden=function(a){var b=window.getComputedStyle(a).display;return!b||"none"===b},k.getTextTransform=function(a){var b,c=a.textX,d=a.textY,e=a.targetX,f=a.targetY,g=a.scale,h=a.rotate;return g<1?b="scale("+g+") ":(g=1,b=""),"translate("+(e-g*c)+" "+(f-g*d)+")"+b+(h?"rotate("+h+" "+c+" "+d+") ":"")}},{"../constants/numerical":695,"./anchor_utils":700,"./angles":701,"./array":702,"./clean_number":703,"./clear_responsive":705,"./coerce":706,"./dates":707,"./dom":708,"./extend":710,"./filter_unique":711,"./filter_visible":712,"./geometry2d":715,"./identity":718,"./is_plain_object":720,"./keyed_container":721,"./localize":722,"./loggers":723,"./make_trace_groups":724,"./matrix":725,"./mod":726,"./nested_property":727,"./noop":728,"./notifier":729,"./push_unique":733,"./regex":735,"./relative_attr":736,"./relink_private":737,"./search":738,"./stats":741,"./throttle":744,"./to_log_range":745,d3:164,"fast-isnumeric":226}],720:[function(a,b,c){"use strict";b.exports=function(a){return window&&window.process&&window.process.versions?"[object Object]"===Object.prototype.toString.call(a):"[object Object]"===Object.prototype.toString.call(a)&&Object.getPrototypeOf(a)===Object.prototype}},{}],721:[function(a,b,c){"use strict";var d=a("./nested_property"),e=/^\w*$/;b.exports=function(a,b,c,f){var g,h,i;c=c||"name",f=f||"value";var j={};b&&b.length?(i=d(a,b),h=i.get()):h=a,b=b||"";var k={};if(h)for(g=0;g<h.length;g++)k[h[g][c]]=g;var l=e.test(f),m={set:function(a,b){var e=null===b?4:0;if(!h){if(!i||4===e)return;h=[],i.set(h)}var g=k[a];if(void 0===g){if(4===e)return;e|=3,g=h.length,k[a]=g}else b!==(l?h[g][f]:d(h[g],f).get())&&(e|=2);var n=h[g]=h[g]||{};return n[c]=a,l?n[f]=b:d(n,f).set(b),null!==b&&(e&=-5),j[g]=j[g]|e,m},get:function(a){if(h){var b=k[a];return void 0===b?void 0:l?h[b][f]:d(h[b],f).get()}},rename:function(a,b){var d=k[a];return void 0===d?m:(j[d]=1|j[d],k[b]=d,delete k[a],h[d][c]=b,m)},remove:function(a){var b=k[a];if(void 0===b)return m;var e=h[b];if(Object.keys(e).length>2)return j[b]=2|j[b],m.set(a,null);if(l){for(g=b;g<h.length;g++)j[g]=3|j[g];for(g=b;g<h.length;g++)k[h[g][c]]--;h.splice(b,1),delete k[a]}else d(e,f).set(null),j[b]=6|j[b];return m},constructUpdate:function(){for(var a,e,g={},i=Object.keys(j),k=0;k<i.length;k++)e=i[k],a=b+"["+e+"]",h[e]?(1&j[e]&&(g[a+"."+c]=h[e][c]),2&j[e]&&(g[a+"."+f]=l?4&j[e]?null:h[e][f]:4&j[e]?null:d(h[e],f).get())):g[a]=null;return g}};return m}},{"./nested_property":727}],722:[function(a,b,c){"use strict";var d=a("../registry");b.exports=function(a,b){for(var c=a._context.locale,e=0;e<2;e++){for(var f=a._context.locales,g=0;g<2;g++){var h=(f[c]||{}).dictionary;if(h){var i=h[b];if(i)return i}f=d.localeRegistry}var j=c.split("-")[0];if(j===c)break;c=j}return b}},{"../registry":848}],723:[function(a,b,c){"use strict";function d(a,b){if(a&&a.apply)try{return void a.apply(console,b)}catch(a){}for(var c=0;c<b.length;c++)try{a(b[c])}catch(a){console.log(b[c])}}var e=a("../plot_api/plot_config").dfltConfig,f=b.exports={};f.log=function(){if(e.logging>1){for(var a=["LOG:"],b=0;b<arguments.length;b++)a.push(arguments[b]);d(console.trace||console.log,a)}},f.warn=function(){if(e.logging>0){for(var a=["WARN:"],b=0;b<arguments.length;b++)a.push(arguments[b]);d(console.trace||console.log,a)}},f.error=function(){if(e.logging>0){for(var a=["ERROR:"],b=0;b<arguments.length;b++)a.push(arguments[b]);d(console.error,a)}}},{"../plot_api/plot_config":755}],724:[function(a,b,c){"use strict";var d=a("d3");b.exports=function(a,b,c){var e=a.selectAll("g."+c.replace(/\s/g,".")).data(b,function(a){return a[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",c),e.order();var f=a.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(a){a[0][f]=d.select(this)}),e}},{d3:164}],725:[function(a,b,c){"use strict";c.init2dArray=function(a,b){for(var c=new Array(a),d=0;d<a;d++)c[d]=new Array(b);return c},c.transposeRagged=function(a){var b,c,d=0,e=a.length;for(b=0;b<e;b++)d=Math.max(d,a[b].length);var f=new Array(d);for(b=0;b<d;b++)for(f[b]=new Array(e),c=0;c<e;c++)f[b][c]=a[c][b];return f},c.dot=function(a,b){if(!a.length||!b.length||a.length!==b.length)return null;var d,e,f=a.length;if(a[0].length)for(d=new Array(f),e=0;e<f;e++)d[e]=c.dot(a[e],b);else if(b[0].length){var g=c.transposeRagged(b);for(d=new Array(g.length),e=0;e<g.length;e++)d[e]=c.dot(a,g[e])}else for(d=0,e=0;e<f;e++)d+=a[e]*b[e];return d},c.translationMatrix=function(a,b){return[[1,0,a],[0,1,b],[0,0,1]]},c.rotationMatrix=function(a){var b=a*Math.PI/180;return[[Math.cos(b),-Math.sin(b),0],[Math.sin(b),Math.cos(b),0],[0,0,1]]},c.rotationXYMatrix=function(a,b,d){return c.dot(c.dot(c.translationMatrix(b,d),c.rotationMatrix(a)),c.translationMatrix(-b,-d))},c.apply2DTransform=function(a){return function(){var b=arguments;3===b.length&&(b=b[0]);var d=1===arguments.length?b[0]:[b[0],b[1]];return c.dot(a,[d[0],d[1],1]).slice(0,2)}},c.apply2DTransform2=function(a){var b=c.apply2DTransform(a);return function(a){return b(a.slice(0,2)).concat(b(a.slice(2,4)))}}},{}],726:[function(a,b,c){"use strict";b.exports={mod:function(a,b){var c=a%b;return c<0?c+b:c},modHalf:function(a,b){return Math.abs(a)>b/2?a-Math.round(a/b)*b:a}}},{}],727:[function(a,b,c){"use strict";function d(a,b){return void 0===a||null===a&&!b.match(k)}function e(a,b,c){return function(e){var i,k,l=a,m="",n=[[a,m]],o=d(e,c);for(k=0;k<b.length-1;k++){if("number"==typeof(i=b[k])&&!j(l))throw"array index but container is not an array";if(-1===i){if(o=!g(l,b.slice(k+1),e,c))break;return}if(!h(l,i,b[k+1],o))break;if("object"!=typeof(l=l[i])||null===l)throw"container is not an object";m=f(m,i),n.push([l,m])}if(o){if(k===b.length-1&&(delete l[b[k]],Array.isArray(l)&&+b[k]==l.length-1))for(;l.length&&void 0===l[l.length-1];)l.pop()}else l[b[k]]=e}}function f(a,b){var c=b;return i(b)?c="["+b+"]":a&&(c="."+b),a+c}function g(a,b,c,f){var g,i=j(c),k=!0,l=c,m=f.replace("-1",0),n=!i&&d(c,m),o=b[0];for(g=0;g<a.length;g++)m=f.replace("-1",g),i&&(n=d(l=c[g%c.length],m)),n&&(k=!1),h(a,g,o,n)&&e(a[g],b,f.replace("-1",g))(l);return k}function h(a,b,c,d){if(void 0===a[b]){if(d)return!1;a[b]="number"==typeof c?[]:{}}return!0}var i=a("fast-isnumeric"),j=a("./array").isArrayOrTypedArray;b.exports=function(a,b){if(i(b))b=String(b);else if("string"!=typeof b||"[-1]"===b.substr(b.length-4))throw"bad property string";for(var c,d,f,g=0,h=b.split(".");g<h.length;){if(c=String(h[g]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(c[1])h[g]=c[1];else{if(0!==g)throw"bad property string";h.splice(0,1)}for(d=c[2].substr(1,c[2].length-2).split("]["),f=0;f<d.length;f++)g++,h.splice(g,0,Number(d[f]))}g++}return"object"!=typeof a?function(a,b,c){return{set:function(){throw"bad container"},get:function(){},astr:b,parts:c,obj:a}}(a,b,h):{set:e(a,h,b),get:function a(b,c){return function(){var d,e,f,g,h,i=b;for(g=0;g<c.length-1;g++){if(-1===(d=c[g])){for(e=!0,f=[],h=0;h<i.length;h++)f[h]=a(i[h],c.slice(g+1))(),f[h]!==f[0]&&(e=!1);return e?f[0]:f}if("number"==typeof d&&!j(i))return;if("object"!=typeof(i=i[d])||null===i)return}if("object"==typeof i&&null!==i&&null!==(f=i[c[g]]))return f}}(a,h),astr:b,parts:h,obj:a}};var k=/(^|\.)args\[/},{"./array":702,"fast-isnumeric":226}],728:[function(a,b,c){"use strict";b.exports=function(){}},{}],729:[function(a,b,c){"use strict";var d=a("d3"),e=a("fast-isnumeric"),f=[];b.exports=function(a,b){function c(a){a.duration(700).style("opacity",0).each("end",function(a){var b=f.indexOf(a);-1!==b&&f.splice(b,1),d.select(this).remove()})}if(-1===f.indexOf(a)){f.push(a);var g=1e3;e(b)?g=b:"long"===b&&(g=3e3);var h=d.select("body").selectAll(".plotly-notifier").data([0]);h.enter().append("div").classed("plotly-notifier",!0),h.selectAll(".notifier-note").data(f).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(a){var b=d.select(this);b.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){b.transition().call(c)});for(var e=b.append("p"),f=a.split(/<br\s*\/?>/g),h=0;h<f.length;h++)h&&e.append("br"),e.append("span").text(f[h]);b.transition().duration(700).style("opacity",1).transition().delay(g).call(c)})}}},{d3:164,"fast-isnumeric":226}],730:[function(a,b,c){"use strict";var d=a("./setcursor"),e="data-savedcursor";b.exports=function(a,b){var c=a.attr(e);if(b){if(!c){for(var f=(a.attr("class")||"").split(" "),g=0;g<f.length;g++){var h=f[g];0===h.indexOf("cursor-")&&a.attr(e,h.substr(7)).classed(h,!1)}a.attr(e)||a.attr(e,"!!")}d(a,b)}else c&&(a.attr(e,null),"!!"===c?d(a):d(a,c))}},{"./setcursor":739}],731:[function(a,b,c){"use strict";var d=a("./matrix").dot,e=a("../constants/numerical").BADNUM,f=b.exports={};f.tester=function(a){var b,c=a.slice(),d=c[0][0],f=d,g=c[0][1],h=g;for(c.push(c[0]),b=1;b<c.length;b++)d=Math.min(d,c[b][0]),f=Math.max(f,c[b][0]),g=Math.min(g,c[b][1]),h=Math.max(h,c[b][1]);var i,j=!1;5===c.length&&(c[0][0]===c[1][0]?c[2][0]===c[3][0]&&c[0][1]===c[3][1]&&c[1][1]===c[2][1]&&(j=!0,i=function(a){return a[0]===c[0][0]}):c[0][1]===c[1][1]&&c[2][1]===c[3][1]&&c[0][0]===c[3][0]&&c[1][0]===c[2][0]&&(j=!0,i=function(a){return a[1]===c[0][1]}));var k=!0,l=c[0];for(b=1;b<c.length;b++)if(l[0]!==c[b][0]||l[1]!==c[b][1]){k=!1;break}return{xmin:d,xmax:f,ymin:g,ymax:h,pts:c,contains:j?function(a,b){var c=a[0],j=a[1];return!(c===e||c<d||c>f||j===e||j<g||j>h||b&&i(a))}:function(a,b){var i=a[0],j=a[1];if(i===e||i<d||i>f||j===e||j<g||j>h)return!1;var k,l,m,n,o,p=c.length,q=c[0][0],r=c[0][1],s=0;for(k=1;k<p;k++)if(l=q,m=r,q=c[k][0],r=c[k][1],!(i<(n=Math.min(l,q))||i>Math.max(l,q)||j>Math.max(m,r)))if(j<Math.min(m,r))i!==n&&s++;else{if(j===(o=q===l?j:m+(i-l)*(r-m)/(q-l)))return 1!==k||!b;j<=o&&i!==n&&s++}return s%2==1},isRect:j,degenerate:k}},f.isSegmentBent=function(a,b,c,e){var f,g,h,i=a[b],j=[a[c][0]-i[0],a[c][1]-i[1]],k=d(j,j),l=Math.sqrt(k),m=[-j[1]/l,j[0]/l]
;for(f=b+1;f<c;f++)if(g=[a[f][0]-i[0],a[f][1]-i[1]],(h=d(g,j))<0||h>k||Math.abs(d(g,m))>e)return!0;return!1},f.filter=function(a,b){function c(c){a.push(c);var h=d.length,i=e;d.splice(g+1);for(var j=i+1;j<a.length;j++)(j===a.length-1||f.isSegmentBent(a,i,j+1,b))&&(d.push(a[j]),d.length<h-2&&(e=j,g=d.length-1),i=j)}var d=[a[0]],e=0,g=0;return a.length>1&&c(a.pop()),{addPt:c,raw:a,filtered:d}}},{"../constants/numerical":695,"./matrix":725}],732:[function(a,b,c){(function(c){"use strict";var d=a("./show_no_webgl_msg"),e=a("regl");b.exports=function(a,b){var f=a._fullLayout,g=!0;return f._glcanvas.each(function(d){if(!d.regl&&(!d.pick||f._has("parcoords"))){try{d.regl=e({canvas:this,attributes:{antialias:!d.pick,preserveDrawingBuffer:!0},pixelRatio:a._context.plotGlPixelRatio||c.devicePixelRatio,extensions:b||[]})}catch(a){g=!1}g&&this.addEventListener("webglcontextlost",function(b){a&&a.emit&&a.emit("plotly_webglcontextlost",{event:b,layer:d.key})},!1)}}),g||d({container:f._glcontainer.node()}),g}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./show_no_webgl_msg":740,regl:503}],733:[function(a,b,c){"use strict";b.exports=function(a,b){if(b instanceof RegExp){for(var c=b.toString(),d=0;d<a.length;d++)if(a[d]instanceof RegExp&&a[d].toString()===c)return a;a.push(b)}else!b&&0!==b||-1!==a.indexOf(b)||a.push(b);return a}},{}],734:[function(a,b,c){"use strict";var d=a("../lib"),e=a("../plot_api/plot_config").dfltConfig,f={add:function(a,b,c,d,f){var g,h;a.undoQueue=a.undoQueue||{index:0,queue:[],sequence:!1},h=a.undoQueue.index,a.autoplay?a.undoQueue.inSequence||(a.autoplay=!1):(!a.undoQueue.sequence||a.undoQueue.beginSequence?(g={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},a.undoQueue.queue.splice(h,a.undoQueue.queue.length-h,g),a.undoQueue.index+=1):g=a.undoQueue.queue[h-1],a.undoQueue.beginSequence=!1,g&&(g.undo.calls.unshift(b),g.undo.args.unshift(c),g.redo.calls.push(d),g.redo.args.push(f)),a.undoQueue.queue.length>e.queueLength&&(a.undoQueue.queue.shift(),a.undoQueue.index--))},startSequence:function(a){a.undoQueue=a.undoQueue||{index:0,queue:[],sequence:!1},a.undoQueue.sequence=!0,a.undoQueue.beginSequence=!0},stopSequence:function(a){a.undoQueue=a.undoQueue||{index:0,queue:[],sequence:!1},a.undoQueue.sequence=!1,a.undoQueue.beginSequence=!1},undo:function(a){var b,c;if(a.framework&&a.framework.isPolar)a.framework.undo();else if(!(void 0===a.undoQueue||isNaN(a.undoQueue.index)||a.undoQueue.index<=0)){for(a.undoQueue.index--,b=a.undoQueue.queue[a.undoQueue.index],a.undoQueue.inSequence=!0,c=0;c<b.undo.calls.length;c++)f.plotDo(a,b.undo.calls[c],b.undo.args[c]);a.undoQueue.inSequence=!1,a.autoplay=!1}},redo:function(a){var b,c;if(a.framework&&a.framework.isPolar)a.framework.redo();else if(!(void 0===a.undoQueue||isNaN(a.undoQueue.index)||a.undoQueue.index>=a.undoQueue.queue.length)){for(b=a.undoQueue.queue[a.undoQueue.index],a.undoQueue.inSequence=!0,c=0;c<b.redo.calls.length;c++)f.plotDo(a,b.redo.calls[c],b.redo.args[c]);a.undoQueue.inSequence=!1,a.autoplay=!1,a.undoQueue.index++}}};f.plotDo=function(a,b,c){a.autoplay=!0,c=function(a,b){for(var c,e=[],f=0;f<b.length;f++)c=b[f],e[f]=c===a?c:"object"==typeof c?Array.isArray(c)?d.extendDeep([],c):d.extendDeepAll({},c):c;return e}(a,c),b.apply(null,c)},b.exports=f},{"../lib":719,"../plot_api/plot_config":755}],735:[function(a,b,c){"use strict";c.counter=function(a,b,c,d){var e=(b||"")+(c?"":"$"),f=!1===d?"":"^";return"xy"===a?new RegExp(f+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(f+a+"([2-9]|[1-9][0-9]+)?"+e)}},{}],736:[function(a,b,c){"use strict";var d=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,e=/^[^\.\[\]]+$/;b.exports=function(a,b){for(;b;){var c=a.match(d);if(c)a=c[1];else{if(!a.match(e))throw new Error("bad relativeAttr call:"+[a,b]);a=""}if("^"!==b.charAt(0))break;b=b.slice(1)}return a&&"["!==b.charAt(0)?a+"."+b:a+b}},{}],737:[function(a,b,c){"use strict";var d=a("./array").isArrayOrTypedArray,e=a("./is_plain_object");b.exports=function a(b,c){for(var f in c){var g=c[f],h=b[f];if(h!==g)if("_"===f.charAt(0)||"function"==typeof g){if(f in b)continue;b[f]=g}else if(d(g)&&d(h)&&e(g[0])){if("customdata"===f||"ids"===f)continue;for(var i=Math.min(g.length,h.length),j=0;j<i;j++)h[j]!==g[j]&&e(g[j])&&e(h[j])&&a(h[j],g[j])}else e(g)&&e(h)&&(a(h,g),Object.keys(h).length||delete b[f])}}},{"./array":702,"./is_plain_object":720}],738:[function(a,b,c){"use strict";function d(a,b){return a<b}function e(a,b){return a<=b}function f(a,b){return a>b}function g(a,b){return a>=b}var h=a("fast-isnumeric"),i=a("./loggers"),j=a("./identity");c.findBin=function(a,b,c){if(h(b.start))return c?Math.ceil((a-b.start)/b.size-1e-9)-1:Math.floor((a-b.start)/b.size+1e-9);var j,k,l=0,m=b.length,n=0,o=m>1?(b[m-1]-b[0])/(m-1):1;for(k=o>=0?c?d:e:c?g:f,a+=1e-9*o*(c?-1:1)*(o>=0?1:-1);l<m&&n++<100;)k(b[j=Math.floor((l+m)/2)],a)?l=j+1:m=j;return n>90&&i.log("Long binary search..."),l-1},c.sorterAsc=function(a,b){return a-b},c.sorterDes=function(a,b){return b-a},c.distinctVals=function(a){var b=a.slice();b.sort(c.sorterAsc);for(var d=b.length-1,e=b[d]-b[0]||1,f=e/(d||1)/1e4,g=[b[0]],h=0;h<d;h++)b[h+1]>b[h]+f&&(e=Math.min(e,b[h+1]-b[h]),g.push(b[h+1]));return{vals:g,minDiff:e}},c.roundUp=function(a,b,c){for(var d,e=0,f=b.length-1,g=0,h=c?0:1,i=c?1:0,j=c?Math.ceil:Math.floor;e<f&&g++<100;)b[d=j((e+f)/2)]<=a?e=d+h:f=d-i;return b[e]},c.sort=function(a,b){for(var c=0,d=0,e=1;e<a.length;e++){var f=b(a[e],a[e-1]);if(f<0?c=1:f>0&&(d=1),c&&d)return a.sort(b)}return d?a:a.reverse()},c.findIndexOfMin=function(a,b){b=b||j;for(var c,d=1/0,e=0;e<a.length;e++){var f=b(a[e]);f<d&&(d=f,c=e)}return c}},{"./identity":718,"./loggers":723,"fast-isnumeric":226}],739:[function(a,b,c){"use strict";b.exports=function(a,b){(a.attr("class")||"").split(" ").forEach(function(b){0===b.indexOf("cursor-")&&a.classed(b,!1)}),b&&a.classed("cursor-"+b,!0)}},{}],740:[function(a,b,c){"use strict";var d=a("../components/color"),e=function(){};b.exports=function(a){for(var b in a)"function"==typeof a[b]&&(a[b]=e);a.destroy=function(){a.container.parentNode.removeChild(a.container)};var c=document.createElement("div");c.className="no-webgl",c.style.cursor="pointer",c.style.fontSize="24px",c.style.color=d.defaults[0],c.style.position="absolute",c.style.left=c.style.top="0px",c.style.width=c.style.height="100%",c.style["background-color"]=d.lightLine,c.style["z-index"]=30;var f=document.createElement("p");return f.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",f.style.position="relative",f.style.top="50%",f.style.left="50%",f.style.height="30%",f.style.width="50%",f.style.margin="-15% 0 0 -25%",c.appendChild(f),a.container.appendChild(c),a.container.style.background="#FFFFFF",a.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":594}],741:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("./array").isArrayOrTypedArray;c.aggNums=function(a,b,f,g){var h,i;if((!g||g>f.length)&&(g=f.length),d(b)||(b=!1),e(f[0])){for(i=new Array(g),h=0;h<g;h++)i[h]=c.aggNums(a,b,f[h]);f=i}for(h=0;h<g;h++)d(b)?d(f[h])&&(b=a(+b,+f[h])):b=f[h];return b},c.len=function(a){return c.aggNums(function(a){return a+1},0,a)},c.mean=function(a,b){return b||(b=c.len(a)),c.aggNums(function(a,b){return a+b},0,a)/b},c.midRange=function(a){if(void 0!==a&&0!==a.length)return(c.aggNums(Math.max,null,a)+c.aggNums(Math.min,null,a))/2},c.variance=function(a,b,e){return b||(b=c.len(a)),d(e)||(e=c.mean(a,b)),c.aggNums(function(a,b){return a+Math.pow(b-e,2)},0,a)/b},c.stdev=function(a,b,d){return Math.sqrt(c.variance(a,b,d))},c.median=function(a){var b=a.slice().sort();return c.interp(b,.5)},c.interp=function(a,b){if(!d(b))throw"n should be a finite number";if((b=b*a.length-.5)<0)return a[0];if(b>a.length-1)return a[a.length-1];var c=b%1;return c*a[Math.ceil(b)]+(1-c)*a[Math.floor(b)]}},{"./array":702,"fast-isnumeric":226}],742:[function(a,b,c){"use strict";var d=a("color-normalize");b.exports=function(a){return a?d(a):[0,0,0,1]}},{"color-normalize":121}],743:[function(a,b,c){"use strict";function d(a,b){return a.node().getBoundingClientRect()[b]}function e(a,b){if(!a)return null;var c=a.match(b),d=c&&(c[3]||c[4]);return d&&f(d)}function f(a){return a.replace(D,function(a,b){return("#"===b.charAt(0)?function(a){if(!(a>1114111)){var b=String.fromCodePoint;if(b)return b(a);var c=String.fromCharCode;return a<=65535?c(a):c(55232+(a>>10),a%1024+56320)}}("x"===b.charAt(1)?parseInt(b.substr(2),16):parseInt(b.substr(1),10)):C[b])||a})}function g(a,b,c){var d,e,f,g=c.horizontalAlign,h=c.verticalAlign||"top",i=a.node().getBoundingClientRect(),j=b.node().getBoundingClientRect();return e="bottom"===h?function(){return i.bottom-d.height}:"middle"===h?function(){return i.top+(i.height-d.height)/2}:function(){return i.top},f="right"===g?function(){return i.right-d.width}:"center"===g?function(){return i.left+(i.width-d.width)/2}:function(){return i.left},function(){return d=this.node().getBoundingClientRect(),this.style({top:e()-j.top+"px",left:f()-j.left+"px","z-index":1e3}),this}}var h=a("d3"),i=a("../lib"),j=a("../constants/xmlns_namespaces"),k=a("../constants/alignment").LINE_SPACING,l=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;c.convertToTspans=function(a,b,g){function C(){F.empty()||(G=a.attr("class")+"-math",F.select("svg."+G).remove()),a.text("").style("white-space","pre"),function(a,b){function c(){C++;var b=document.createElementNS(j.svg,"tspan");h.select(b).attr({class:"line",dy:C*k+"em"}),a.appendChild(b),l=b;var c=n;if(n=[{node:b}],c.length>1)for(var e=1;e<c.length;e++)d(c[e])}function d(a){var b,c=a.type,d={};if("a"===c){b="a";var e=a.target,f=a.href,i=a.popup;f&&(d={"xlink:xlink:show":"_blank"===e||"_"!==e.charAt(0)?"new":"replace",target:e,"xlink:xlink:href":f},i&&(d.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+i+'");return false;'))}else b="tspan";a.style&&(d.style=a.style);var k=document.createElementNS(j.svg,b);if("sup"===c||"sub"===c){g(l,r),l.appendChild(k);var m=document.createElementNS(j.svg,"tspan");g(m,r),h.select(m).attr("dy",q[c]),d.dy=p[c],l.appendChild(k),l.appendChild(m)}else l.appendChild(k);h.select(k).attr(d),l=a.node=k,n.push(a)}function g(a,b){a.appendChild(document.createTextNode(b))}b=b.replace(t," ");var l,m=!1,n=[],C=-1;w.test(b)?c():(l=a,n=[{node:a}]);for(var D=b.split(u),E=0;E<D.length;E++){var F=D[E],G=F.match(v),H=G&&G[2].toLowerCase(),I=o[H];if("br"===H)c();else if(void 0===I)g(l,f(F));else if(G[1])!function(a){if(1!==n.length){var c=n.pop();a!==c.type&&i.log("Start tag <"+c.type+"> doesnt match end tag <"+a+">. Pretending it did match.",b),l=n[n.length-1].node}else i.log("Ignoring unexpected end tag </"+a+">.",b)}(H);else{var J=G[4],K={type:H},L=e(J,x);if(L?(L=L.replace(B,"$1 fill:"),I&&(L+=";"+I)):I&&(L=I),L&&(K.style=L),"a"===H){m=!0;var M=e(J,y);if(M){var N=document.createElement("a");N.href=M,-1!==s.indexOf(N.protocol)&&(K.href=encodeURI(decodeURI(M)),K.target=e(J,z)||"_blank",K.popup=e(J,A))}}d(K)}}return m}(a.node(),D)&&a.style("pointer-events","all"),c.positionText(a),g&&g.call(a)}var D=a.text(),E=!a.attr("data-notex")&&"undefined"!=typeof MathJax&&D.match(l),F=h.select(a.node().parentNode);if(!F.empty()){var G=a.attr("class")?a.attr("class").split(" ")[0]:"text";return G+="-math",F.selectAll("svg."+G).remove(),F.selectAll("g."+G+"-group").remove(),a.style("display",null).attr({"data-unformatted":D,"data-math":"N"}),E?(b&&b._promises||[]).push(new Promise(function(b){a.style("display","none");var c=parseInt(a.node().style.fontSize,10),e={fontSize:c};!function(a,b,c){var d,e,f,g;MathJax.Hub.Queue(function(){return e=i.extendDeepAll({},MathJax.Hub.config),f=MathJax.Hub.processSectionDelay,void 0!==MathJax.Hub.processSectionDelay&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})},function(){if("SVG"!==(d=MathJax.Hub.config.menuSettings.renderer))return MathJax.Hub.setRenderer("SVG")},function(){var c="math-output-"+i.randstr({},64);return g=h.select("body").append("div").attr({id:c}).style({visibility:"hidden",position:"absolute"}).style({"font-size":b.fontSize+"px"}).text(a.replace(m,"\\lt ").replace(n,"\\gt ")),MathJax.Hub.Typeset(g.node())},function(){var b=h.select("body").select("#MathJax_SVG_glyphs");if(g.select(".MathJax_SVG").empty()||!g.select("svg").node())i.log("There was an error in the tex syntax.",a),c();else{var e=g.select("svg").node().getBoundingClientRect();c(g.select(".MathJax_SVG"),b,e)}if(g.remove(),"SVG"!==d)return MathJax.Hub.setRenderer(d)},function(){return void 0!==f&&(MathJax.Hub.processSectionDelay=f),MathJax.Hub.Config(e)})}(E[2],e,function(e,f,h){F.selectAll("svg."+G).remove(),F.selectAll("g."+G+"-group").remove();var i=e&&e.select("svg");if(!i||!i.node())return C(),void b();var j=F.append("g").classed(G+"-group",!0).attr({"pointer-events":"none","data-unformatted":D,"data-math":"Y"});j.node().appendChild(i.node()),f&&f.node()&&i.node().insertBefore(f.node().cloneNode(!0),i.node().firstChild),i.attr({class:G,height:h.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var k=a.node().style.fill||"black",l=i.select("g");l.attr({fill:k,stroke:k});var m=d(l,"width"),n=d(l,"height"),o=+a.attr("x")-m*{start:0,middle:.5,end:1}[a.attr("text-anchor")||"start"],p=-(c||d(a,"height"))/4;"y"===G[0]?(j.attr({transform:"rotate("+[-90,+a.attr("x"),+a.attr("y")]+") translate("+[-m/2,p-n/2]+")"}),i.attr({x:+a.attr("x"),y:+a.attr("y")})):"l"===G[0]?i.attr({x:a.attr("x"),y:p-n/2}):"a"===G[0]&&0!==G.indexOf("atitle")?i.attr({x:0,y:p}):i.attr({x:o,y:+a.attr("y")+p-n/2}),g&&g.call(a,j),b(j)})})):C(),a}};var m=/(<|&lt;|&#60;)/g,n=/(>|&gt;|&#62;)/g,o={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},p={sub:"0.3em",sup:"-0.6em"},q={sub:"-0.21em",sup:"0.42em"},r="",s=["http:","https:","mailto:","",void 0,":"],t=c.NEWLINES=/(\r\n?|\n)/g,u=/(<[^<>]*>)/,v=/<(\/?)([^ >]*)(\s+(.*))?>/i,w=/<br(\s+.*)?>/i;c.BR_TAG_ALL=/<br(\s+.*)?>/gi;var x=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,y=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,z=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,A=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i,B=/(^|;)\s*color:/;c.plainText=function(a,b){for(var c=void 0!==(b=b||{}).len&&-1!==b.len?b.len:1/0,d=void 0!==b.allowedTags?b.allowedTags:["br"],e="...".length,f=a.split(u),g=[],h="",i=0,j=0;j<f.length;j++){var k=f[j],l=k.match(v),m=l&&l[2].toLowerCase();if(m)-1!==d.indexOf(m)&&(g.push(k),h=m);else{var n=k.length;if(i+n<c)g.push(k),i+=n;else if(i<c){var o=c-i;h&&("br"!==h||o<=e||n<=e)&&g.pop(),c>e?g.push(k.substr(0,o-e)+"..."):g.push(k.substr(0,o));break}h=""}}return g.join("")};var C={mu:"",amp:"&",lt:"<",gt:">",nbsp:"",times:"",plusmn:"",deg:""},D=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;c.convertEntities=f,c.lineCount=function(a){return a.selectAll("tspan.line").size()||1},c.positionText=function(a,b,c){return a.each(function(){function a(a,b){return void 0===b?null===(b=d.attr(a))&&(d.attr(a,0),b=0):d.attr(a,b),b}var d=h.select(this),e=a("x",b),f=a("y",c);"text"===this.nodeName&&d.selectAll("tspan.line").attr({x:e,y:f})})},c.makeEditable=function(a,b){function c(){!function(){var c=h.select(e).select(".svg-container"),f=c.append("div"),j=a.node().style,k=parseFloat(j.fontSize||12),l=b.text;void 0===l&&(l=a.attr("data-unformatted")),f.classed("plugin-editable editable",!0).style({position:"absolute","font-family":j.fontFamily||"Arial","font-size":k,color:b.fill||j.fill||"black",opacity:1,"background-color":b.background||"transparent",outline:"#ffffff33 1px solid",margin:[-k/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(l).call(g(a,c,b)).on("blur",function(){e._editing=!1,a.text(this.textContent).style({opacity:1});var b,c=h.select(this).attr("class");(b=c?"."+c.split(" ")[0]+"-math-group":"[class*=-math-group]")&&h.select(a.node().parentNode).select(b).style({opacity:0});var d=this.textContent;h.select(this).transition().duration(0).remove(),h.select(document).on("mouseup",null),i.edit.call(a,d)}).on("focus",function(){var a=this;e._editing=!0,h.select(document).on("mouseup",function(){if(h.event.target===a)return!1;document.activeElement===f.node()&&f.node().blur()})}).on("keyup",function(){27===h.event.which?(e._editing=!1,a.style({opacity:1}),h.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),i.cancel.call(a,this.textContent)):(i.input.call(a,this.textContent),h.select(this).call(g(a,c,b)))}).on("keydown",function(){13===h.event.which&&this.blur()}).call(d)}(),a.style({opacity:0});var c,f=j.attr("class");(c=f?"."+f.split(" ")[0]+"-math-group":"[class*=-math-group]")&&h.select(a.node().parentNode).select(c).style({opacity:0})}function d(a){var b=a.node(),c=document.createRange();c.selectNodeContents(b);var d=window.getSelection();d.removeAllRanges(),d.addRange(c),b.focus()}var e=b.gd,f=b.delegate,i=h.dispatch("edit","input","cancel"),j=f||a;if(a.style({"pointer-events":f?"none":"all"}),1!==a.size())throw new Error("boo");return b.immediate?c():j.on("click",c),h.rebind(a,i,"on")}},{"../constants/alignment":688,"../constants/xmlns_namespaces":696,"../lib":719,d3:164}],744:[function(a,b,c){"use strict";function d(a){a&&null!==a.timer&&(clearTimeout(a.timer),a.timer=null)}var e={};c.throttle=function(a,b,c){function f(){c(),g.ts=Date.now(),g.onDone&&(g.onDone(),g.onDone=null)}var g=e[a],h=Date.now();if(!g){for(var i in e)e[i].ts<h-6e4&&delete e[i];g=e[a]={ts:0,timer:null}}d(g),h>g.ts+b?f():g.timer=setTimeout(function(){f(),g.timer=null},b)},c.done=function(a){var b=e[a];return b&&b.timer?new Promise(function(a){var c=b.onDone;b.onDone=function(){c&&c(),a(),b.onDone=null}}):Promise.resolve()},c.clear=function(a){if(a)d(e[a]),delete e[a];else for(var b in e)c.clear(b)}},{}],745:[function(a,b,c){"use strict";var d=a("fast-isnumeric");b.exports=function(a,b){if(a>0)return Math.log(a)/Math.LN10;var c=Math.log(Math.min(b[0],b[1]))/Math.LN10;return d(c)||(c=Math.log(Math.max(b[0],b[1]))/Math.LN10-6),c}},{"fast-isnumeric":226}],746:[function(a,b,c){"use strict";var d=b.exports={},e=a("../plots/geo/constants").locationmodeToLayer,f=a("topojson-client").feature;d.getTopojsonName=function(a){return[a.scope.replace(/ /g,"-"),"_",a.resolution.toString(),"m"].join("")},d.getTopojsonPath=function(a,b){return a+b+".json"},d.getTopojsonFeatures=function(a,b){var c=e[a.locationmode],d=b.objects[c];return f(b,d).features}},{"../plots/geo/constants":795,"topojson-client":541}],747:[function(a,b,c){"use strict";b.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],748:[function(a,b,c){"use strict";b.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],749:[function(a,b,c){"use strict";var d=a("../registry");b.exports=function(a){for(var b,c,e=d.layoutArrayContainers,f=d.layoutArrayRegexes,g=a.split("[")[0],h=0;h<f.length;h++)if((c=a.match(f[h]))&&0===c.index){b=c[0];break}if(b||(b=e[e.indexOf(g)]),!b)return!1;var i=a.substr(b.length);return i?!!(c=i.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:b,index:Number(c[1]),property:c[3]||""}:{array:b,index:"",property:""}}},{"../registry":848}],750:[function(a,b,c){"use strict";function d(a){for(var b={},c=0;c<a.length;c++)b[a[c]]=!1;return b}function e(a,b,c){var d=h({},a);for(var e in d){var g=d[e];i(g)&&(d[e]=f(g,b,c,e))}return"from-root"===c&&(d.editType=b),d}function f(a,b,c,d){if(a.valType){var g=h({},a);if(g.editType=b,Array.isArray(a.items)){g.items=new Array(a.items.length);for(var i=0;i<a.items.length;i++)g.items[i]=f(a.items[i],b,"from-root")}return g}return e(a,b,"_"===d.charAt(0)?"nested":"from-root")}var g=a("../lib"),h=g.extendFlat,i=g.isPlainObject,j={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},k={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},l=j.flags.slice().concat(["fullReplot"]),m=k.flags.slice().concat("layoutReplot");b.exports={traces:j,layout:k,traceFlags:function(){return d(l)},layoutFlags:function(){return d(m)},update:function(a,b){var c=b.editType;if(c&&"none"!==c)for(var d=c.split("+"),e=0;e<d.length;e++)a[d[e]]=!0},overrideAll:e}},{"../lib":719}],751:[function(a,b,c){"use strict";function d(a,b){var c=a[b],d=b.charAt(0);c&&"paper"!==c&&(a[b]=r(c,d))}function e(a){function b(b,c){var d=a[b],e=a.title&&a.title[c];d&&!e&&(a.title||(a.title={}),a.title[c]=a[b],delete a[b])}a&&("string"!=typeof a.title&&"number"!=typeof a.title||(a.title={text:a.title}),b("titlefont","font"),b("titleposition","position"),b("titleside","side"),b("titleoffset","offset"))}function f(a){if(!n.isPlainObject(a))return!1;var b=a.name;return delete a.name,delete a.showlegend,("string"==typeof b||"number"==typeof b)&&String(b)}function g(a,b,c,d){if(c&&!d)return a;if(d&&!c)return b;if(!a.trim())return b;if(!b.trim())return a;var e,f=Math.min(a.length,b.length);for(e=0;e<f&&a.charAt(e)===b.charAt(e);e++);return a.substr(0,e).trim()}function h(a){var b="middle",c="center";return"string"==typeof a&&(-1!==a.indexOf("top")?b="top":-1!==a.indexOf("bottom")&&(b="bottom"),-1!==a.indexOf("left")?c="left":-1!==a.indexOf("right")&&(c="right")),b+" "+c}function i(a,b){return b in a&&"object"==typeof a[b]&&0===Object.keys(a[b]).length}function j(a){var b=a.search(u);if(b>0)return a.substr(0,b)}var k=a("fast-isnumeric"),l=a("gl-mat4/fromQuat"),m=a("../registry"),n=a("../lib"),o=a("../plots/plots"),p=a("../plots/cartesian/axis_ids"),q=a("../components/color"),r=p.cleanId,s=p.getFromTrace,t=m.traceIs;c.clearPromiseQueue=function(a){Array.isArray(a._promises)&&a._promises.length>0&&n.log("Clearing previous rejected promises from queue."),a._promises=[]},c.cleanLayout=function(a){var b,f;a||(a={}),a.xaxis1&&(a.xaxis||(a.xaxis=a.xaxis1),delete a.xaxis1),a.yaxis1&&(a.yaxis||(a.yaxis=a.yaxis1),delete a.yaxis1),a.scene1&&(a.scene||(a.scene=a.scene1),delete a.scene1);var g=(o.subplotsRegistry.cartesian||{}).attrRegex,h=(o.subplotsRegistry.polar||{}).attrRegex,j=(o.subplotsRegistry.ternary||{}).attrRegex,k=(o.subplotsRegistry.gl3d||{}).attrRegex,m=Object.keys(a);for(b=0;b<m.length;b++){var p=m[b];if(g&&g.test(p)){var s=a[p];s.anchor&&"free"!==s.anchor&&(s.anchor=r(s.anchor)),s.overlaying&&(s.overlaying=r(s.overlaying)),s.type||(s.isdate?s.type="date":s.islog?s.type="log":!1===s.isdate&&!1===s.islog&&(s.type="linear")),"withzero"!==s.autorange&&"tozero"!==s.autorange||(s.autorange=!0,s.rangemode="tozero"),delete s.islog,delete s.isdate,delete s.categories,i(s,"domain")&&delete s.domain,void 0!==s.autotick&&(void 0===s.tickmode&&(s.tickmode=s.autotick?"auto":"linear"),delete s.autotick),e(s)}else if(h&&h.test(p))e(a[p].radialaxis);else if(j&&j.test(p)){var t=a[p];e(t.aaxis),e(t.baxis),e(t.caxis)}else if(k&&k.test(p)){var u=a[p],v=u.cameraposition;if(Array.isArray(v)&&4===v[0].length){var w=v[0],x=v[1],y=v[2],z=l([],w),A=[];for(f=0;f<3;++f)A[f]=x[f]+y*z[2+4*f];u.camera={eye:{x:A[0],y:A[1],z:A[2]},center:{x:x[0],y:x[1],z:x[2]},up:{x:0,y:0,z:1}},delete u.cameraposition}e(u.xaxis),e(u.yaxis),e(u.zaxis)}}var B=Array.isArray(a.annotations)?a.annotations.length:0;for(b=0;b<B;b++){var C=a.annotations[b];n.isPlainObject(C)&&(C.ref&&("paper"===C.ref?(C.xref="paper",C.yref="paper"):"data"===C.ref&&(C.xref="x",C.yref="y"),delete C.ref),d(C,"xref"),d(C,"yref"))}var D=Array.isArray(a.shapes)?a.shapes.length:0;for(b=0;b<D;b++){var E=a.shapes[b];n.isPlainObject(E)&&(d(E,"xref"),d(E,"yref"))}var F=a.legend;return F&&(F.x>3?(F.x=1.02,F.xanchor="left"):F.x<-2&&(F.x=-.02,F.xanchor="right"),F.y>3?(F.y=1.02,F.yanchor="bottom"):F.y<-2&&(F.y=-.02,F.yanchor="top")),e(a),"rotate"===a.dragmode&&(a.dragmode="orbit"),q.clean(a),a.template&&a.template.layout&&c.cleanLayout(a.template.layout),a},c.cleanData=function(a){for(var b=0;b<a.length;b++){var d,j=a[b];if("histogramy"===j.type&&"xbins"in j&&!("ybins"in j)&&(j.ybins=j.xbins,delete j.xbins),j.error_y&&"opacity"in j.error_y){var k=q.defaults,l=j.error_y.color||(t(j,"bar")?q.defaultLine:k[b%k.length]);j.error_y.color=q.addOpacity(q.rgb(l),q.opacity(l)*j.error_y.opacity),delete j.error_y.opacity}if("bardir"in j&&("h"!==j.bardir||!t(j,"bar")&&"histogram"!==j.type.substr(0,9)||(j.orientation="h",c.swapXYData(j)),delete j.bardir),"histogramy"===j.type&&c.swapXYData(j),"histogramx"!==j.type&&"histogramy"!==j.type||(j.type="histogram"),"scl"in j&&!("colorscale"in j)&&(j.colorscale=j.scl,delete j.scl),"reversescl"in j&&!("reversescale"in j)&&(j.reversescale=j.reversescl,delete j.reversescl),j.xaxis&&(j.xaxis=r(j.xaxis,"x")),j.yaxis&&(j.yaxis=r(j.yaxis,"y")),t(j,"gl3d")&&j.scene&&(j.scene=o.subplotsRegistry.gl3d.cleanId(j.scene)),!t(j,"pie-like")&&!t(j,"bar-like"))if(Array.isArray(j.textposition))for(d=0;d<j.textposition.length;d++)j.textposition[d]=h(j.textposition[d]);else j.textposition&&(j.textposition=h(j.textposition));var p=m.getModule(j);if(p&&p.colorbar){var s=p.colorbar.container,u=s?j[s]:j;u&&u.colorscale&&("YIGnBu"===u.colorscale&&(u.colorscale="YlGnBu"),"YIOrRd"===u.colorscale&&(u.colorscale="YlOrRd"))}if("surface"===j.type&&n.isPlainObject(j.contours)){var v=["x","y","z"];for(d=0;d<v.length;d++){var w=j.contours[v[d]];n.isPlainObject(w)&&(w.highlightColor&&(w.highlightcolor=w.highlightColor,delete w.highlightColor),w.highlightWidth&&(w.highlightwidth=w.highlightWidth,delete w.highlightWidth))}}if("candlestick"===j.type||"ohlc"===j.type){var x=!1!==(j.increasing||{}).showlegend,y=!1!==(j.decreasing||{}).showlegend,z=f(j.increasing),A=f(j.decreasing);if(!1!==z&&!1!==A){var B=g(z,A,x,y);B&&(j.name=B)}else!z&&!A||j.name||(j.name=z||A)}if(Array.isArray(j.transforms)){var C=j.transforms;for(d=0;d<C.length;d++){var D=C[d];if(n.isPlainObject(D))switch(D.type){case"filter":D.filtersrc&&(D.target=D.filtersrc,delete D.filtersrc),D.calendar&&(D.valuecalendar||(D.valuecalendar=D.calendar),delete D.calendar);break;case"groupby":if(D.styles=D.styles||D.style,D.styles&&!Array.isArray(D.styles)){var E=D.styles,F=Object.keys(E);D.styles=[];for(var G=0;G<F.length;G++)D.styles.push({target:F[G],value:E[F[G]]})}}}}i(j,"line")&&delete j.line,"marker"in j&&(i(j.marker,"line")&&delete j.marker.line,i(j,"marker")&&delete j.marker),q.clean(j),j.autobinx&&(delete j.autobinx,delete j.xbins),j.autobiny&&(delete j.autobiny,delete j.ybins),e(j),j.colorbar&&e(j.colorbar),j.marker&&j.marker.colorbar&&e(j.marker.colorbar),j.line&&j.line.colorbar&&e(j.line.colorbar),j.aaxis&&e(j.aaxis),j.baxis&&e(j.baxis)}},c.swapXYData=function(a){var b;if(n.swapAttrs(a,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(a.z)&&Array.isArray(a.z[0])&&(a.transpose?delete a.transpose:a.transpose=!0),a.error_x&&a.error_y){var c=a.error_y,d="copy_ystyle"in c?c.copy_ystyle:!(c.color||c.thickness||c.width);n.swapAttrs(a,["error_?.copy_ystyle"]),d&&n.swapAttrs(a,["error_?.color","error_?.thickness","error_?.width"])}if("string"==typeof a.hoverinfo){var e=a.hoverinfo.split("+");for(b=0;b<e.length;b++)"x"===e[b]?e[b]="y":"y"===e[b]&&(e[b]="x");a.hoverinfo=e.join("+")}},c.coerceTraceIndices=function(a,b){if(k(b))return[b];if(!Array.isArray(b)||!b.length)return a.data.map(function(a,b){return b});if(Array.isArray(b)){for(var c=[],d=0;d<b.length;d++)n.isIndex(b[d],a.data.length)?c.push(b[d]):n.warn("trace index (",b[d],") is not a number or is out of bounds");return c}return b},c.manageArrayContainers=function(a,b,c){var d=a.obj,e=a.parts,f=e.length,g=e[f-1],h=k(g);if(h&&null===b){var i=e.slice(0,f-1).join(".");n.nestedProperty(d,i).get().splice(g,1)}else h&&void 0===a.get()?(void 0===a.get()&&(c[a.astr]=null),a.set(b)):a.set(b)};var u=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;c.hasParent=function(a,b){for(var c=j(b);c;){if(c in a)return!0;c=j(c)}return!1};var v=["x","y","z"];c.clearAxisTypes=function(a,b,c){for(var d=0;d<b.length;d++)for(var e=a._fullData[d],f=0;f<3;f++){var g=s(a,e,v[f]);if(g&&"log"!==g.type){var h=g._name,i=g._id.substr(1);if("scene"===i.substr(0,5)){if(void 0!==c[i])continue;h=i+"."+h}var j=h+".type";void 0===c[h]&&void 0===c[j]&&n.nestedProperty(a.layout,j).set(null)}}}},{"../components/color":594,"../lib":719,"../plots/cartesian/axis_ids":770,"../plots/plots":828,"../registry":848,"fast-isnumeric":226,"gl-mat4/fromQuat":263}],752:[function(a,b,c){"use strict";var d=a("./plot_api");c.plot=d.plot,c.newPlot=d.newPlot,c.restyle=d.restyle,c.relayout=d.relayout,c.redraw=d.redraw,c.update=d.update,c._guiRestyle=d._guiRestyle,c._guiRelayout=d._guiRelayout,c._guiUpdate=d._guiUpdate,c._storeDirectGUIEdit=d._storeDirectGUIEdit,c.react=d.react,c.extendTraces=d.extendTraces,c.prependTraces=d.prependTraces,c.addTraces=d.addTraces,c.deleteTraces=d.deleteTraces,c.moveTraces=d.moveTraces,c.purge=d.purge,c.addFrames=d.addFrames,c.deleteFrames=d.deleteFrames,c.animate=d.animate,c.setPlotConfig=d.setPlotConfig,c.toImage=a("./to_image"),c.validate=a("./validate"),c.downloadImage=a("../snapshot/download");var e=a("./template_api");c.makeTemplate=e.makeTemplate,c.validateTemplate=e.validateTemplate},{"../snapshot/download":850,"./plot_api":754,"./template_api":759,"./to_image":760,"./validate":761}],753:[function(a,b,c){"use strict";var d=a("../lib/is_plain_object"),e=a("../lib/noop"),f=a("../lib/loggers"),g=a("../lib/search").sorterAsc,h=a("../registry");c.containerArrayMatch=a("./container_array_match");var i=c.isAddVal=function(a){return"add"===a||d(a)},j=c.isRemoveVal=function(a){return null===a||"remove"===a};c.applyContainerArrayChanges=function(a,b,c,d,k){var l=b.astr,m=h.getComponentMethod(l,"supplyLayoutDefaults"),n=h.getComponentMethod(l,"draw"),o=h.getComponentMethod(l,"drawOne"),p=d.replot||d.recalc||m===e||n===e,q=a.layout,r=a._fullLayout;if(c[""]){Object.keys(c).length>1&&f.warn("Full array edits are incompatible with other edits",l);var s=c[""][""];if(j(s))b.set(null);else{if(!Array.isArray(s))return f.warn("Unrecognized full array edit value",l,s),!0;b.set(s)}return!p&&(m(q,r),n(a),!0)}var t,u,v,w,x,y,z,A,B=Object.keys(c).map(Number).sort(g),C=b.get(),D=C||[],E=k(r,l).get(),F=[],G=-1,H=D.length;for(t=0;t<B.length;t++)if(w=c[v=B[t]],x=Object.keys(w),y=w[""],z=i(y),v<0||v>D.length-(z?0:1))f.warn("index out of range",l,v);else if(void 0!==y)x.length>1&&f.warn("Insertion & removal are incompatible with edits to the same index.",l,v),j(y)?F.push(v):z?("add"===y&&(y={}),D.splice(v,0,y),E&&E.splice(v,0,{})):f.warn("Unrecognized full object edit value",l,v,y),-1===G&&(G=v);else for(u=0;u<x.length;u++)A=l+"["+v+"].",k(D[v],x[u],A).set(w[x[u]]);for(t=F.length-1;t>=0;t--)D.splice(F[t],1),E&&E.splice(F[t],1);if(D.length?C||b.set(D):b.set(null),p)return!1;if(m(q,r),o!==e){var I;if(-1===G)I=B;else{for(H=Math.max(D.length,H),I=[],t=0;t<B.length&&!((v=B[t])>=G);t++)I.push(v);for(t=G;t<H;t++)I.push(t)}for(t=0;t<I.length;t++)o(a,I[t])}else n(a);return!0}},{"../lib/is_plain_object":720,"../lib/loggers":723,"../lib/noop":728,"../lib/search":738,"../registry":848,"./container_array_match":749}],754:[function(a,b,c){"use strict";function d(a){var b=a._fullLayout
;b._redrawFromAutoMarginCount?b._redrawFromAutoMarginCount--:a.emit("plotly_afterplot")}function e(a,b){try{a._fullLayout._paper.style("background",b)}catch(a){J.error(a)}}function f(a,b){e(a,T.combine(b,"white"))}function g(a,b){if(!a._context){a._context=J.extendDeep({},Y);var c=G.select("base");a._context._baseUrl=c.size()&&c.attr("href")?window.location.href.split("#")[0]:""}var d,g,h,i=a._context;if(b){for(g=Object.keys(b),d=0;d<g.length;d++)"editable"!==(h=g[d])&&"edits"!==h&&h in i&&("setBackground"===h&&"opaque"===b[h]?i[h]=f:i[h]=b[h]);b.plot3dPixelRatio&&!i.plotGlPixelRatio&&(i.plotGlPixelRatio=i.plot3dPixelRatio);var j=b.editable;if(void 0!==j)for(i.editable=j,g=Object.keys(i.edits),d=0;d<g.length;d++)i.edits[g[d]]=j;if(b.edits)for(g=Object.keys(b.edits),d=0;d<g.length;d++)(h=g[d])in i.edits&&(i.edits[h]=b.edits[h]);i._exportedPlot=b._exportedPlot}i.staticPlot&&(i.editable=!1,i.edits={},i.autosizable=!1,i.scrollZoom=!1,i.doubleClick=!1,i.showTips=!1,i.showLink=!1,i.displayModeBar=!1),"hover"!==i.displayModeBar||I||(i.displayModeBar=!0),"transparent"!==i.setBackground&&"function"==typeof i.setBackground||(i.setBackground=e),i._hasZeroHeight=i._hasZeroHeight||0===a.clientHeight,i._hasZeroWidth=i._hasZeroWidth||0===a.clientWidth;var k=i.scrollZoom,l=i._scrollZoom={};if(!0===k)l.cartesian=1,l.gl3d=1,l.geo=1,l.mapbox=1;else if("string"==typeof k){var m=k.split("+");for(d=0;d<m.length;d++)l[m[d]]=1}else!1!==k&&(l.gl3d=1,l.geo=1,l.mapbox=1)}function h(a,b){var c,d,e=b+1,f=[];for(c=0;c<a.length;c++)(d=a[c])<0?f.push(e+d):f.push(d);return f}function i(a,b,c){var d,e;for(d=0;d<b.length;d++){if((e=b[d])!==parseInt(e,10))throw new Error("all values in "+c+" must be integers");if(e>=a.data.length||e<-a.data.length)throw new Error(c+" must be valid indices for gd.data.");if(b.indexOf(e,d+1)>-1||e>=0&&b.indexOf(-a.data.length+e)>-1||e<0&&b.indexOf(a.data.length+e)>-1)throw new Error("each index in "+c+" must be unique.")}}function j(a,b,c){if(!Array.isArray(a.data))throw new Error("gd.data must be an array.");if(void 0===b)throw new Error("currentIndices is a required argument.");if(Array.isArray(b)||(b=[b]),i(a,b,"currentIndices"),void 0===c||Array.isArray(c)||(c=[c]),void 0!==c&&i(a,c,"newIndices"),void 0!==c&&b.length!==c.length)throw new Error("current and new indices must be of equal length.")}function k(a,b,c,d,e){!function(a,b,c,d){var e=J.isPlainObject(d);if(!Array.isArray(a.data))throw new Error("gd.data must be an array");if(!J.isPlainObject(b))throw new Error("update must be a key:value object");if(void 0===c)throw new Error("indices must be an integer or array of integers");for(var f in i(a,c,"indices"),b){if(!Array.isArray(b[f])||b[f].length!==c.length)throw new Error("attribute "+f+" must be an array of length equal to indices array length");if(e&&(!(f in d)||!Array.isArray(d[f])||d[f].length!==b[f].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}(a,b,c,d);for(var f=function(a,b,c,d){var e,f,g,i,j,k=J.isPlainObject(d),l=[];for(var m in Array.isArray(c)||(c=[c]),c=h(c,a.data.length-1),b)for(var n=0;n<c.length;n++){if(e=a.data[c[n]],f=(g=K(e,m)).get(),i=b[m][n],!J.isArrayOrTypedArray(i))throw new Error("attribute: "+m+" index: "+n+" must be an array");if(!J.isArrayOrTypedArray(f))throw new Error("cannot extend missing or non-array attribute: "+m);if(f.constructor!==i.constructor)throw new Error("cannot extend array with an array of a different type: "+m);j=k?d[m][n]:d,H(j)||(j=-1),l.push({prop:g,target:f,insert:i,maxp:Math.floor(j)})}return l}(a,b,c,d),g={},j={},k=0;k<f.length;k++){var l=f[k].prop,m=f[k].maxp,n=e(f[k].target,f[k].insert,m);l.set(n[0]),Array.isArray(g[l.astr])||(g[l.astr]=[]),g[l.astr].push(n[1]),Array.isArray(j[l.astr])||(j[l.astr]=[]),j[l.astr].push(f[k].target.length)}return{update:g,maxPoints:j}}function l(a,b){var c=new a.constructor(a.length+b.length);return c.set(a),c.set(b,a.length),c}function m(a,b,e,f){a=J.getGraphDiv(a),$.clearPromiseQueue(a);var g={};if("string"==typeof b)g[b]=e;else{if(!J.isPlainObject(b))return J.warn("Restyle fail.",b,e,f),Promise.reject();g=J.extendFlat({},b),void 0===f&&(f=e)}Object.keys(g).length&&(a.changed=!0);var h=$.coerceTraceIndices(a,f),i=q(a,g,h),j=i.flags;j.calc&&(a.calcdata=void 0),j.clearAxisTypes&&$.clearAxisTypes(a,h,{});var k=[];j.fullReplot?k.push(c.plot):(k.push(P.previousPromises),P.supplyDefaults(a),j.markerSize&&(P.doCalcdata(a),u(k)),j.style&&k.push(_.doTraceStyle),j.colorbars&&k.push(_.doColorBars),k.push(d)),k.push(P.rehover,P.redrag),M.add(a,m,[a,i.undoit,i.traces],m,[a,i.redoit,i.traces]);var l=J.syncOrAsync(k,a);return l&&l.then||(l=Promise.resolve()),l.then(function(){return a.emit("plotly_restyle",i.eventData),a})}function n(a){return void 0===a?null:a}function o(a,b){return b?function(b,c,d){var e=K(b,c),f=e.set;return e.set=function(b){p((d||"")+c,e.get(),b,a),f(b)},e}:K}function p(a,b,c,d){if(Array.isArray(b)||Array.isArray(c))for(var e=Array.isArray(b)?b:[],f=Array.isArray(c)?c:[],g=Math.max(e.length,f.length),h=0;h<g;h++)p(a+"["+h+"]",e[h],f[h],d);else if(J.isPlainObject(b)||J.isPlainObject(c)){var i=J.isPlainObject(b)?b:{},j=J.isPlainObject(c)?c:{},k=J.extendFlat({},i,j);for(var l in k)p(a+"."+l,i[l],j[l],d)}else void 0===d[a]&&(d[a]=n(b))}function q(a,b,c){function d(){return c.map(function(){})}function e(a){var b=R.id2name(a);-1===t.indexOf(b)&&t.push(b)}function f(a){return"LAYOUT"+a+".autorange"}function g(a){return"LAYOUT"+a+".range"}function h(a){for(var b=a;b<l.length;b++)if(l[b]._input===m[a])return l[b]}function i(e,f,g){if(Array.isArray(e))e.forEach(function(a){i(a,f,g)});else if(!(e in b||$.hasParent(b,e))){var j;if("LAYOUT"===e.substr(0,6))j=q(a.layout,e.replace("LAYOUT",""));else{var l=c[g];j=o(k._tracePreGUI[h(l)._fullInput.uid],p)(m[l],e)}e in w||(w[e]=d()),void 0===w[e][g]&&(w[e][g]=n(j.get())),void 0!==f&&j.set(f)}}var j,k=a._fullLayout,l=a._fullData,m=a.data,p=k._guiEditing,q=o(k._preGUI,p),s=J.extendDeepAll({},b);r(b);var t,u=aa.traceFlags(),v={},w={};for(var x in b){if($.hasParent(b,x))throw new Error("cannot set "+x+" and a parent attribute simultaneously");var y,z,A,B,C,D,E=b[x];if("autobinx"!==x&&"autobiny"!==x||(x=x.charAt(x.length-1)+"bins",E=Array.isArray(E)?E.map(function(a){return function(b,d){return!1===b?l[c[d]][a]:null}}(x)):!1===E?c.map(function(a){return function(b){return l[b][a]}}(x)):null),v[x]=E,"LAYOUT"!==x.substr(0,6)){for(w[x]=d(),j=0;j<c.length;j++)if(y=m[c[j]],z=h(c[j]),B=(A=o(k._tracePreGUI[z._fullInput.uid],p)(y,x)).get(),void 0!==(C=Array.isArray(E)?E[j%E.length]:E)){var F=A.parts[A.parts.length-1],G=x.substr(0,x.length-F.length-1),H=G?G+".":"",I=G?K(z,G).get():z;if((D=O.getTraceValObject(z,A.parts))&&D.impliedEdits&&null!==C)for(var L in D.impliedEdits)i(J.relativeAttr(x,L),D.impliedEdits[L],j);else if("thicknessmode"!==F&&"lenmode"!==F||B===C||"fraction"!==C&&"pixels"!==C||!I){if("type"===x&&("pie"===C!=("pie"===B)||"funnelarea"===C!=("funnelarea"===B))){var M="x",Q="y";"bar"!==C&&"bar"!==B||"h"!==y.orientation||(M="y",Q="x"),J.swapAttrs(y,["?","?src"],"labels",M),J.swapAttrs(y,["d?","?0"],"label",M),J.swapAttrs(y,["?","?src"],"values",Q),"pie"===B||"funnelarea"===B?(K(y,"marker.color").set(K(y,"marker.colors").get()),k._pielayer.selectAll("g.trace").remove()):N.traceIs(y,"cartesian")&&K(y,"marker.colors").set(K(y,"marker.color").get())}}else{var S=k._size,T=I.orient,U="top"===T||"bottom"===T;if("thicknessmode"===F){var V=U?S.h:S.w;i(H+"thickness",I.thickness*("fraction"===C?1/V:V),j)}else{var W=U?S.w:S.h;i(H+"len",I.len*("fraction"===C?1/W:W),j)}}if(w[x][j]=n(B),-1!==["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(x)){if("orientation"===x){A.set(C);var X=y.x&&!y.y?"h":"v";if((A.get()||X)===z.orientation)continue}else"orientationaxes"===x&&(y.orientation={v:"h",h:"v"}[z.orientation]);$.swapXYData(y),u.calc=u.clearAxisTypes=!0}else-1!==P.dataArrayContainers.indexOf(A.parts[0])?($.manageArrayContainers(A,C,w),u.calc=!0):(D?D.arrayOk&&!N.traceIs(z,"regl")&&(J.isArrayOrTypedArray(C)||J.isArrayOrTypedArray(B))?u.calc=!0:aa.update(u,D):u.calc=!0,A.set(C))}if(-1!==["swapxyaxes","orientationaxes"].indexOf(x)&&R.swap(a,c),"orientationaxes"===x){var Y=K(a.layout,"hovermode");"x"===Y.get()?Y.set("y"):"y"===Y.get()&&Y.set("x")}if(-1!==["orientation","type"].indexOf(x)){for(t=[],j=0;j<c.length;j++){var Z=m[c[j]];N.traceIs(Z,"cartesian")&&(e(Z.xaxis||"x"),e(Z.yaxis||"y"))}i(t.map(f),!0,0),i(t.map(g),[0,1],0)}}else A=q(a.layout,x.replace("LAYOUT","")),w[x]=[n(A.get())],A.set(Array.isArray(E)?E[0]:E),u.calc=!0}return(u.calc||u.plot)&&(u.fullReplot=!0),{flags:u,undoit:w,redoit:v,traces:c,eventData:J.extendDeepNoArrays([],[s,c])}}function r(a){function b(b,c){a[c]=a[b],delete a[b]}var c,d,e,f=J.counterRegex("axis",".title",!1,!1),g=/colorbar\.title$/,h=Object.keys(a);for(c=0;c<h.length;c++)d=h[c],e=a[d],"title"!==d&&!f.test(d)&&!g.test(d)||"string"!=typeof e&&"number"!=typeof e?d.indexOf("titlefont")>-1?b(d,d.replace("titlefont","title.font")):d.indexOf("titleposition")>-1?b(d,d.replace("titleposition","title.position")):d.indexOf("titleside")>-1?b(d,d.replace("titleside","title.side")):d.indexOf("titleoffset")>-1&&b(d,d.replace("titleoffset","title.offset")):b(d,d.replace("title","title.text"))}function s(a,b,c){if(a=J.getGraphDiv(a),$.clearPromiseQueue(a),a.framework&&a.framework.isPolar)return Promise.resolve(a);var e={};if("string"==typeof b)e[b]=c;else{if(!J.isPlainObject(b))return J.warn("Relayout fail.",b,c),Promise.reject();e=J.extendFlat({},b)}Object.keys(e).length&&(a.changed=!0);var f=v(a,e),g=f.flags;g.calc&&(a.calcdata=void 0);var h=[P.previousPromises];g.layoutReplot?h.push(_.layoutReplot):Object.keys(e).length&&(t(a,g,f)||P.supplyDefaults(a),g.legend&&h.push(_.doLegend),g.layoutstyle&&h.push(_.layoutStyles),g.axrange&&u(h,f.rangesAltered),g.ticks&&h.push(_.doTicksRelayout),g.modebar&&h.push(_.doModeBar),g.camera&&h.push(_.doCamera),g.colorbars&&h.push(_.doColorBars),h.push(d)),h.push(P.rehover,P.redrag),M.add(a,s,[a,f.undoit],s,[a,f.redoit]);var i=J.syncOrAsync(h,a);return i&&i.then||(i=Promise.resolve(a)),i.then(function(){return a.emit("plotly_relayout",f.eventData),a})}function t(a,b,c){var d=a._fullLayout;if(!b.axrange)return!1;for(var e in b)if("axrange"!==e&&b[e])return!1;for(var f in c.rangesAltered){var g=R.id2name(f),h=a.layout[g],i=d[g];if(i.autorange=h.autorange,i.range=h.range.slice(),i.cleanRange(),i._matchGroup)for(var j in i._matchGroup)if(j!==f){var k=d[R.id2name(j)];k.autorange=i.autorange,k.range=i.range.slice(),k._input.range=i.range.slice()}}return!0}function u(a,b){var c=b?function(a){var c=[],d=!0;for(var e in b){var f=R.getFromId(a,e);if(c.push(e),f._matchGroup)for(var g in f._matchGroup)b[g]||c.push(g);f.automargin&&(d=!1)}return R.draw(a,c,{skipTitle:d})}:function(a){return R.draw(a,"redraw")};a.push(X,_.doAutoRangeAndConstraints,c,_.drawData,_.finalDraw)}function v(a,b){function c(a,d){if(Array.isArray(a))a.forEach(function(a){c(a,d)});else if(!(a in b||$.hasParent(b,a))){var e=k(h,a);a in z||(z[a]=n(e.get())),void 0!==d&&e.set(d)}}function d(a){var b=R.name2id(a.split(".")[0]);return A[b]=1,b}var e,f,g,h=a.layout,i=a._fullLayout,j=i._guiEditing,k=o(i._preGUI,j),l=Object.keys(b),m=R.list(a),p=J.extendDeepAll({},b),q={};for(r(b),l=Object.keys(b),f=0;f<l.length;f++)if(0===l[f].indexOf("allaxes")){for(g=0;g<m.length;g++){var s=m[g]._id.substr(1),t=-1!==s.indexOf("scene")?s+".":"",u=l[f].replace("allaxes",t+m[g]._name);b[u]||(b[u]=b[l[f]])}delete b[l[f]]}var v,x=aa.layoutFlags(),y={},z={},A={};for(var B in b){if($.hasParent(b,B))throw new Error("cannot set "+B+" and a parent attribute simultaneously");for(var C=k(h,B),D=b[B],E=C.parts.length-1;E>0&&"string"!=typeof C.parts[E];)E--;var F=C.parts[E],G=C.parts[E-1]+"."+F,H=C.parts.slice(0,E).join("."),I=K(a.layout,H).get(),L=K(i,H).get(),M=C.get();if(void 0!==D){y[B]=D,z[B]="reverse"===F?D:n(M);var P=O.getLayoutValObject(i,C.parts);if(P&&P.impliedEdits&&null!==D)for(var Q in P.impliedEdits)c(J.relativeAttr(B,Q),P.impliedEdits[Q]);if(-1!==["width","height"].indexOf(B))if(D){c("autosize",null);var S="height"===B?"width":"height";c(S,i[S])}else i[B]=a._initialAutoSize[B];else if("autosize"===B)c("width",D?null:i.width),c("height",D?null:i.height);else if(G.match(da))d(G),K(i,H+"._inputRange").set(null);else if(G.match(ea)){d(G),K(i,H+"._inputRange").set(null);var T=K(i,H).get();T._inputDomain&&(T._input.domain=T._inputDomain.slice())}else G.match(fa)&&K(i,H+"._inputDomain").set(null);if("type"===F){var U=I,V="linear"===L.type&&"log"===D,W="log"===L.type&&"linear"===D;if(V||W){if(U&&U.range)if(L.autorange)V&&(U.range=U.range[1]>U.range[0]?[1,2]:[2,1]);else{var X=U.range[0],Y=U.range[1];V?(X<=0&&Y<=0&&c(H+".autorange",!0),X<=0?X=Y/1e6:Y<=0&&(Y=X/1e6),c(H+".range[0]",Math.log(X)/Math.LN10),c(H+".range[1]",Math.log(Y)/Math.LN10)):(c(H+".range[0]",Math.pow(10,X)),c(H+".range[1]",Math.pow(10,Y)))}else c(H+".autorange",!0);Array.isArray(i._subplots.polar)&&i._subplots.polar.length&&i[C.parts[0]]&&"radialaxis"===C.parts[1]&&delete i[C.parts[0]]._subplot.viewInitial["radialaxis.range"],N.getComponentMethod("annotations","convertCoords")(a,L,D,c),N.getComponentMethod("images","convertCoords")(a,L,D,c)}else c(H+".autorange",!0),c(H+".range",null);K(i,H+"._inputRange").set(null)}else if(F.match(ba)){var _=K(i,B).get(),ca=(D||{}).type;ca&&"-"!==ca||(ca="linear"),N.getComponentMethod("annotations","convertCoords")(a,_,ca,c),N.getComponentMethod("images","convertCoords")(a,_,ca,c)}var ga=Z.containerArrayMatch(B);if(ga){e=ga.array,f=ga.index;var ha=ga.property,ia=P||{editType:"calc"};""!==f&&""===ha&&(Z.isAddVal(D)?z[B]=null:Z.isRemoveVal(D)?z[B]=(K(h,e).get()||[])[f]:J.warn("unrecognized full object value",b)),aa.update(x,ia),q[e]||(q[e]={});var ja=q[e][f];ja||(ja=q[e][f]={}),ja[ha]=D,delete b[B]}else"reverse"===F?(I.range?I.range.reverse():(c(H+".autorange",!0),I.range=[1,0]),L.autorange?x.calc=!0:x.plot=!0):(i._has("scatter-like")&&i._has("regl")&&"dragmode"===B&&("lasso"===D||"select"===D)&&"lasso"!==M&&"select"!==M?x.plot=!0:i._has("gl2d")?x.plot=!0:P?aa.update(x,P):x.calc=!0,C.set(D))}}for(e in q)Z.applyContainerArrayChanges(a,k(h,e),q[e],x,k)||(x.plot=!0);var ka=i._axisConstraintGroups||[];for(v in A)for(f=0;f<ka.length;f++){var la=ka[f];if(la[v])for(var ma in x.calc=!0,la)A[ma]||(R.getFromId(a,ma)._constraintShrinkable=!0)}return(w(a)||b.height||b.width)&&(x.plot=!0),(x.plot||x.calc)&&(x.layoutReplot=!0),{flags:x,rangesAltered:A,undoit:z,redoit:y,eventData:p}}function w(a){var b=a._fullLayout,c=b.width,d=b.height;return a.layout.autosize&&P.plotAutoSize(a,a.layout,b),b.width!==c||b.height!==d}function x(a,b,e,f){if(a=J.getGraphDiv(a),$.clearPromiseQueue(a),a.framework&&a.framework.isPolar)return Promise.resolve(a);J.isPlainObject(b)||(b={}),J.isPlainObject(e)||(e={}),Object.keys(b).length&&(a.changed=!0),Object.keys(e).length&&(a.changed=!0);var g=$.coerceTraceIndices(a,f),h=q(a,J.extendFlat({},b),g),i=h.flags,j=v(a,J.extendFlat({},e)),k=j.flags;(i.calc||k.calc)&&(a.calcdata=void 0),i.clearAxisTypes&&$.clearAxisTypes(a,g,e);var l=[];k.layoutReplot?l.push(_.layoutReplot):i.fullReplot?l.push(c.plot):(l.push(P.previousPromises),t(a,k,j)||P.supplyDefaults(a),i.style&&l.push(_.doTraceStyle),(i.colorbars||k.colorbars)&&l.push(_.doColorBars),k.legend&&l.push(_.doLegend),k.layoutstyle&&l.push(_.layoutStyles),k.axrange&&u(l,j.rangesAltered),k.ticks&&l.push(_.doTicksRelayout),k.modebar&&l.push(_.doModeBar),k.camera&&l.push(_.doCamera),l.push(d)),l.push(P.rehover,P.redrag),M.add(a,x,[a,h.undoit,j.undoit,h.traces],x,[a,h.redoit,j.redoit,h.traces]);var m=J.syncOrAsync(l,a);return m&&m.then||(m=Promise.resolve(a)),m.then(function(){return a.emit("plotly_update",{data:h.eventData,layout:j.eventData}),a})}function y(a){return function(b){b._fullLayout._guiEditing=!0;var c=a.apply(null,arguments);return b._fullLayout._guiEditing=!1,c}}function z(a,b){for(var c=0;c<b.length;c++){var d=b[c],e=a.match(d.pattern);if(e)return{head:e[1],attr:d.attr}}}function A(a,b){var c=K(b,a).get();if(void 0!==c)return c;var d=a.split(".");for(d.pop();d.length>1;)if(d.pop(),void 0!==(c=K(b,d.join(".")+".uirevision").get()))return c;return b.uirevision}function B(a,b){for(var c=0;c<b.length;c++)if(b[c]._fullInput.uid===a)return c;return-1}function C(a,b,c){for(var d=0;d<b.length;d++)if(b[d].uid===a)return d;return!b[c]||b[c].uid?-1:c}function D(a,b){var c=J.isPlainObject(a),d=Array.isArray(a);return c||d?(c&&J.isPlainObject(b)||d&&Array.isArray(b))&&JSON.stringify(a)===JSON.stringify(b):a===b}function E(a,b,c,d){function e(){var a=g.editType;m&&-1!==a.indexOf("arraydraw")?J.pushUnique(k.arrays[m],n):(aa.update(k,g),"none"!==a&&k.nChanges++,d.transition&&g.anim&&k.nChangesAnim++,(da.test(i)||ea.test(i))&&(k.rangesAltered[c[0]]=1),fa.test(i)&&K(b,"_inputDomain").set(null),"datarevision"===h&&(k.newDataRevision=1))}function f(a){return"data_array"===a.valType||a.arrayOk}var g,h,i,j=d.getValObject,k=d.flags,l=d.immutable,m=d.inArray,n=d.arrayIndex;for(h in a){if(k.calc&&!d.transition)return;var o=a[h],p=b[h],q=c.concat(h);if(i=q.join("."),"_"!==h.charAt(0)&&"function"!=typeof o&&o!==p){if(("tick0"===h||"dtick"===h)&&"geo"!==c[0]){var r=b.tickmode;if("auto"===r||"array"===r||!r)continue}if(("range"!==h||!b.autorange)&&("zmin"!==h&&"zmax"!==h||"contourcarpet"!==b.type)&&(g=j(q))&&(!g._compareAsJSON||JSON.stringify(o)!==JSON.stringify(p))){var s,t=g.valType,u=f(g),v=Array.isArray(o),w=Array.isArray(p);if(v&&w){var x="_input_"+h,y=a[x],z=b[x];if(Array.isArray(y)&&y===z)continue}if(void 0===p)u&&v?k.calc=!0:e();else if(g._isLinkedToArray){var A=[],B=!1;m||(k.arrays[h]=A);var C=Math.min(o.length,p.length),D=Math.max(o.length,p.length);if(C!==D){if("arraydraw"!==g.editType){e();continue}B=!0}for(s=0;s<C;s++)E(o[s],p[s],q.concat(s),J.extendFlat({inArray:h,arrayIndex:s},d));if(B)for(s=C;s<D;s++)A.push(s)}else!t&&J.isPlainObject(o)?E(o,p,q,d):u?v&&w?(l&&(k.calc=!0),(l||d.newDataRevision)&&e()):v!==w?k.calc=!0:e():v&&w&&o.length===p.length&&String(o)===String(p)||e()}}}for(h in b)if(!(h in a||"_"===h.charAt(0)||"function"==typeof b[h])){if(f(g=j(c.concat(h)))&&Array.isArray(b[h]))return void(k.calc=!0);e()}}function F(a){var b=G.select(a),c=a._fullLayout;if(c._container=b.selectAll(".plot-container").data([0]),c._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),c._paperdiv=c._container.selectAll(".svg-container").data([0]),c._paperdiv.enter().append("div").classed("svg-container",!0).style("position","relative"),c._glcontainer=c._paperdiv.selectAll(".gl-container").data([{}]),c._glcontainer.enter().append("div").classed("gl-container",!0),c._paperdiv.selectAll(".main-svg").remove(),c._paperdiv.select(".modebar-container").remove(),c._paper=c._paperdiv.insert("svg",":first-child").classed("main-svg",!0),c._toppaper=c._paperdiv.append("svg").classed("main-svg",!0),c._modebardiv=c._paperdiv.append("div"),c._hoverpaper=c._paperdiv.append("svg").classed("main-svg",!0),!c._uid){var d={};G.selectAll("defs").each(function(){this.id&&(d[this.id.split("-")[1]]=1)}),c._uid=J.randstr(d)}c._paperdiv.selectAll(".main-svg").attr(V.svgAttrs),c._defs=c._paper.append("defs").attr("id","defs-"+c._uid),c._clips=c._defs.append("g").classed("clips",!0),c._topdefs=c._toppaper.append("defs").attr("id","topdefs-"+c._uid),c._topclips=c._topdefs.append("g").classed("clips",!0),c._bgLayer=c._paper.append("g").classed("bglayer",!0),c._draggers=c._paper.append("g").classed("draglayer",!0);var e=c._paper.append("g").classed("layer-below",!0);c._imageLowerLayer=e.append("g").classed("imagelayer",!0),c._shapeLowerLayer=e.append("g").classed("shapelayer",!0),c._cartesianlayer=c._paper.append("g").classed("cartesianlayer",!0),c._polarlayer=c._paper.append("g").classed("polarlayer",!0),c._ternarylayer=c._paper.append("g").classed("ternarylayer",!0),c._geolayer=c._paper.append("g").classed("geolayer",!0),c._funnelarealayer=c._paper.append("g").classed("funnelarealayer",!0),c._pielayer=c._paper.append("g").classed("pielayer",!0),c._treemaplayer=c._paper.append("g").classed("treemaplayer",!0),c._sunburstlayer=c._paper.append("g").classed("sunburstlayer",!0),c._indicatorlayer=c._toppaper.append("g").classed("indicatorlayer",!0),c._glimages=c._paper.append("g").classed("glimages",!0);var f=c._toppaper.append("g").classed("layer-above",!0);c._imageUpperLayer=f.append("g").classed("imagelayer",!0),c._shapeUpperLayer=f.append("g").classed("shapelayer",!0),c._infolayer=c._toppaper.append("g").classed("infolayer",!0),c._menulayer=c._toppaper.append("g").classed("menulayer",!0),c._zoomlayer=c._toppaper.append("g").classed("zoomlayer",!0),c._hoverlayer=c._hoverpaper.append("g").classed("hoverlayer",!0),c._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),a.emit("plotly_framework")}var G=a("d3"),H=a("fast-isnumeric"),I=a("has-hover"),J=a("../lib"),K=J.nestedProperty,L=a("../lib/events"),M=a("../lib/queue"),N=a("../registry"),O=a("./plot_schema"),P=a("../plots/plots"),Q=a("../plots/polar/legacy"),R=a("../plots/cartesian/axes"),S=a("../components/drawing"),T=a("../components/color"),U=a("../plots/cartesian/graph_interact").initInteractions,V=a("../constants/xmlns_namespaces"),W=a("../lib/svg_text_utils"),X=a("../plots/cartesian/select").clearSelect,Y=a("./plot_config").dfltConfig,Z=a("./manage_arrays"),$=a("./helpers"),_=a("./subroutines"),aa=a("./edit_types"),ba=a("../plots/cartesian/constants").AX_NAME_PATTERN,ca=0,da=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,ea=/^[xyz]axis[0-9]*\.autorange$/,fa=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/,ga=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],ha=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];c.animate=function(a,b,c){function d(a){return Array.isArray(h)?a>=h.length?h[0]:h[a]:h}function e(a){return Array.isArray(i)?a>=i.length?i[0]:i[a]:i}function f(a,b){var c=0;return function(){if(a&&++c===b)return a()}}if(a=J.getGraphDiv(a),!J.isPlotDiv(a))throw new Error("This element is not a Plotly plot: "+a+". It's likely that you've failed to create a plot before animating it. For more details, see https://plot.ly/javascript/animations/");var g=a._transitionData;g._frameQueue||(g._frameQueue=[]);var h=(c=P.supplyAnimationDefaults(c)).transition,i=c.frame;return void 0===g._frameWaitingCnt&&(g._frameWaitingCnt=0),new Promise(function(i,j){function k(){g._currentFrame&&g._currentFrame.onComplete&&g._currentFrame.onComplete();var b=g._currentFrame=g._frameQueue.shift();if(b){var c=b.name?b.name.toString():null;a._fullLayout._currentFrame=c,g._lastFrameAt=Date.now(),g._timeToNext=b.frameOpts.duration,P.transition(a,b.frame.data,b.frame.layout,$.coerceTraceIndices(a,b.frame.traces),b.frameOpts,b.transitionOpts).then(function(){b.onComplete&&b.onComplete()}),a.emit("plotly_animatingframe",{name:c,frame:b.frame,animation:{frame:b.frameOpts,transition:b.transitionOpts}})}else a.emit("plotly_animated"),window.cancelAnimationFrame(g._animationRaf),g._animationRaf=null}function l(){a.emit("plotly_animating"),g._lastFrameAt=-1/0,g._timeToNext=0,g._runningTransitions=0,g._currentFrame=null;var b=function(){g._animationRaf=window.requestAnimationFrame(b),Date.now()-g._lastFrameAt>g._timeToNext&&k()};b()}function m(a){return Array.isArray(h)?p>=h.length?a.transitionOpts=h[p]:a.transitionOpts=h[0]:a.transitionOpts=h,p++,a}var n,o,p=0,q=[],r=null==b,s=Array.isArray(b);if(r||s||!J.isPlainObject(b)){if(r||-1!==["string","number"].indexOf(typeof b))for(n=0;n<g._frames.length;n++)(o=g._frames[n])&&(r||String(o.group)===String(b))&&q.push({type:"byname",name:String(o.name),data:m({name:o.name})});else if(s)for(n=0;n<b.length;n++){var t=b[n];-1!==["number","string"].indexOf(typeof t)?(t=String(t),q.push({type:"byname",name:t,data:m({name:t})})):J.isPlainObject(t)&&q.push({type:"object",data:m(J.extendFlat({},t))})}}else q.push({type:"object",data:m(J.extendFlat({},b))});for(n=0;n<q.length;n++)if("byname"===(o=q[n]).type&&!g._frameHash[o.data.name])return J.warn('animate failure: frame not found: "'+o.data.name+'"'),void j();-1!==["next","immediate"].indexOf(c.mode)&&function(){if(0!==g._frameQueue.length){for(;g._frameQueue.length;){var b=g._frameQueue.pop();b.onInterrupt&&b.onInterrupt()}a.emit("plotly_animationinterrupted",[])}}(),"reverse"===c.direction&&q.reverse();var u=a._fullLayout._currentFrame;if(u&&c.fromcurrent){var v=-1;for(n=0;n<q.length;n++)if("byname"===(o=q[n]).type&&o.name===u){v=n;break}if(v>0&&v<q.length-1){var w=[];for(n=0;n<q.length;n++)o=q[n],("byname"!==q[n].type||n>v)&&w.push(o);q=w}}q.length>0?function(b){if(0!==b.length){for(var h=0;h<b.length;h++){var k;k="byname"===b[h].type?P.computeFrame(a,b[h].name):b[h].data;var m=e(h),n=d(h);n.duration=Math.min(n.duration,m.duration);var o={frame:k,name:b[h].name,frameOpts:m,transitionOpts:n};h===b.length-1&&(o.onComplete=f(i,2),o.onInterrupt=j),g._frameQueue.push(o)}"immediate"===c.mode&&(g._lastFrameAt=-1/0),g._animationRaf||l()}}(q):(a.emit("plotly_animated"),i())})},c.addFrames=function(a,b,c){if(a=J.getGraphDiv(a),null==b)return Promise.resolve();if(!J.isPlotDiv(a))throw new Error("This element is not a Plotly plot: "+a+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plot.ly/javascript/animations/");var d,e,f,g,h=a._transitionData._frames,i=a._transitionData._frameHash;if(!Array.isArray(b))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+b);var j=h.length+2*b.length,k=[],l={};for(d=b.length-1;d>=0;d--)if(J.isPlainObject(b[d])){var m=b[d].name,n=(i[m]||l[m]||{}).name,o=b[d].name,p=i[n]||l[n];n&&o&&"number"==typeof o&&p&&ca<5&&(ca++,J.warn('addFrames: overwriting frame "'+(i[n]||l[n]).name+'" with a frame whose name of type "number" also equates to "'+n+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),5===ca&&J.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),l[m]={name:m},k.push({frame:P.supplyFrameDefaults(b[d]),index:c&&void 0!==c[d]&&null!==c[d]?c[d]:j+d})}k.sort(function(a,b){return a.index>b.index?-1:a.index<b.index?1:0});var q=[],r=[],s=h.length;for(d=k.length-1;d>=0;d--){if("number"==typeof(e=k[d].frame).name&&J.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!e.name)for(;i[e.name="frame "+a._transitionData._counter++];);if(i[e.name]){for(f=0;f<h.length&&(h[f]||{}).name!==e.name;f++);q.push({type:"replace",index:f,value:e}),r.unshift({type:"replace",index:f,value:h[f]})}else g=Math.max(0,Math.min(k[d].index,s)),q.push({type:"insert",index:g,value:e}),r.unshift({type:"delete",index:g}),s++}var t=P.modifyFrames,u=P.modifyFrames,v=[a,r],w=[a,q];return M&&M.add(a,t,v,u,w),P.modifyFrames(a,q)},c.deleteFrames=function(a,b){if(a=J.getGraphDiv(a),!J.isPlotDiv(a))throw new Error("This element is not a Plotly plot: "+a);var c,d,e=a._transitionData._frames,f=[],g=[];if(!b)for(b=[],c=0;c<e.length;c++)b.push(c);for((b=b.slice()).sort(),c=b.length-1;c>=0;c--)d=b[c],f.push({type:"delete",index:d}),g.unshift({type:"insert",index:d,value:e[d]});var h=P.modifyFrames,i=P.modifyFrames,j=[a,g],k=[a,f];return M&&M.add(a,h,j,i,k),P.modifyFrames(a,f)},c.addTraces=function a(b,d,e){b=J.getGraphDiv(b);var f,g,h=[],i=c.deleteTraces,k=a,l=[b,h],m=[b,d];for(function(a,b,c){var d,e;if(!Array.isArray(a.data))throw new Error("gd.data must be an array.");if(void 0===b)throw new Error("traces must be defined.");for(Array.isArray(b)||(b=[b]),d=0;d<b.length;d++)if("object"!=typeof(e=b[d])||Array.isArray(e)||null===e)throw new Error("all values in traces array must be non-array objects");if(void 0===c||Array.isArray(c)||(c=[c]),void 0!==c&&c.length!==b.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(b,d,e),Array.isArray(d)||(d=[d]),d=d.map(function(a){return J.extendFlat({},a)}),$.cleanData(d),f=0;f<d.length;f++)b.data.push(d[f]);for(f=0;f<d.length;f++)h.push(-d.length+f);if(void 0===e)return g=c.redraw(b),M.add(b,i,l,k,m),g;Array.isArray(e)||(e=[e]);try{j(b,h,e)}catch(a){throw b.data.splice(b.data.length-d.length,d.length),a}return M.startSequence(b),M.add(b,i,l,k,m),g=c.moveTraces(b,h,e),M.stopSequence(b),g},c.deleteTraces=function a(b,d){b=J.getGraphDiv(b);var e,f,g=[],j=c.addTraces,k=a,l=[b,g,d],m=[b,d];if(void 0===d)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(d)||(d=[d]),i(b,d,"indices"),(d=h(d,b.data.length-1)).sort(J.sorterDes),e=0;e<d.length;e+=1)f=b.data.splice(d[e],1)[0],g.push(f);var n=c.redraw(b);return M.add(b,j,l,k,m),n},c.extendTraces=function a(b,d,e,f){var g=k(b=J.getGraphDiv(b),d,e,f,function(a,b,c){var d,e;if(J.isTypedArray(a))if(c<0){var f=new a.constructor(0),g=l(a,b);c<0?(d=g,e=f):(d=f,e=g)}else if(d=new a.constructor(c),e=new a.constructor(a.length+b.length-c),c===b.length)d.set(b),e.set(a);else if(c<b.length){var h=b.length-c;d.set(b.subarray(h)),e.set(a),e.set(b.subarray(0,h),a.length)}else{var i=c-b.length,j=a.length-i;d.set(a.subarray(j)),d.set(b,i),e.set(a.subarray(0,j))}else d=a.concat(b),e=c>=0&&c<d.length?d.splice(0,d.length-c):[];return[d,e]}),h=c.redraw(b),i=[b,g.update,e,g.maxPoints];return M.add(b,c.prependTraces,i,a,arguments),h},c.moveTraces=function a(b,d,e){var f,g=[],i=[],k=a,l=a,m=[b=J.getGraphDiv(b),e,d],n=[b,d,e];if(j(b,d,e),d=Array.isArray(d)?d:[d],void 0===e)for(e=[],f=0;f<d.length;f++)e.push(-d.length+f);for(e=Array.isArray(e)?e:[e],d=h(d,b.data.length-1),e=h(e,b.data.length-1),f=0;f<b.data.length;f++)-1===d.indexOf(f)&&g.push(b.data[f]);for(f=0;f<d.length;f++)i.push({newIndex:e[f],trace:b.data[d[f]]});for(i.sort(function(a,b){return a.newIndex-b.newIndex}),f=0;f<i.length;f+=1)g.splice(i[f].newIndex,0,i[f].trace);b.data=g;var o=c.redraw(b);return M.add(b,k,m,l,n),o},c.prependTraces=function a(b,d,e,f){var g=k(b=J.getGraphDiv(b),d,e,f,function(a,b,c){var d,e;if(J.isTypedArray(a))if(c<=0){var f=new a.constructor(0),g=l(b,a);c<0?(d=g,e=f):(d=f,e=g)}else if(d=new a.constructor(c),e=new a.constructor(a.length+b.length-c),c===b.length)d.set(b),e.set(a);else if(c<b.length){var h=b.length-c;d.set(b.subarray(0,h)),e.set(b.subarray(h)),e.set(a,h)}else{var i=c-b.length;d.set(b),d.set(a.subarray(0,i),b.length),e.set(a.subarray(i))}else d=b.concat(a),e=c>=0&&c<d.length?d.splice(c,d.length):[];return[d,e]}),h=c.redraw(b),i=[b,g.update,e,g.maxPoints];return M.add(b,c.extendTraces,i,a,arguments),h},c.newPlot=function(a,b,d,e){return a=J.getGraphDiv(a),P.cleanPlot([],{},a._fullData||[],a._fullLayout||{}),P.purge(a),c.plot(a,b,d,e)},c.plot=function(a,b,e,f){function h(){return P.clearAutoMarginIds(a),_.drawMarginPushers(a),R.allowAutoMargin(a),P.doAutoMargin(a),P.previousPromises(a)}function i(){a._transitioning||(_.doAutoRangeAndConstraints(a),l&&R.saveRangeInitial(a),N.getComponentMethod("rangeslider","calcAutorange")(a))}var j;if(a=J.getGraphDiv(a),
L.init(a),J.isPlainObject(b)){var k=b;b=k.data,e=k.layout,f=k.config,j=k.frames}if(!1===L.triggerHandler(a,"plotly_beforeplot",[b,e,f]))return Promise.reject();b||e||J.isPlotDiv(a)||J.warn("Calling Plotly.plot as if redrawing but this container doesn't yet have a plot.",a),g(a,f),e||(e={}),G.select(a).classed("js-plotly-plot",!0),S.makeTester(),Array.isArray(a._promises)||(a._promises=[]);var l=0===(a.data||[]).length&&Array.isArray(b);Array.isArray(b)&&($.cleanData(b),l?a.data=b:a.data.push.apply(a.data,b),a.empty=!1),a.layout&&!l||(a.layout=$.cleanLayout(e)),P.supplyDefaults(a);var m=a._fullLayout,n=m._has("cartesian");if(!m._has("polar")&&b&&b[0]&&b[0].r)return J.log("Legacy polar charts are deprecated!"),function(a,b,c){var d=G.select(a).selectAll(".plot-container").data([0]);d.enter().insert("div",":first-child").classed("plot-container plotly",!0);var e=d.selectAll(".svg-container").data([0]);e.enter().append("div").classed("svg-container",!0).style("position","relative"),e.html(""),b&&(a.data=b),c&&(a.layout=c),Q.manager.fillLayout(a),e.style({width:a._fullLayout.width+"px",height:a._fullLayout.height+"px"}),a.framework=Q.manager.framework(a),a.framework({data:a.data,layout:a.layout},e.node()),a.framework.setUndoPoint();var f=a.framework.svg(),g=1,h=a._fullLayout.title?a._fullLayout.title.text:"";""!==h&&h||(g=0);var i=function(){this.call(W.convertToTspans,a)},j=f.select(".title-group text").call(i);if(a._context.edits.titleText){var k=J._(a,"Click to enter Plot title");h&&h!==k||(g=.2,j.attr({"data-unformatted":k}).text(k).style({opacity:g}).on("mouseover.opacity",function(){G.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){G.select(this).transition().duration(1e3).style("opacity",0)}));var l=function(){this.call(W.makeEditable,{gd:a}).on("edit",function(b){a.framework({layout:{title:{text:b}}}),this.text(b).call(i),this.call(l)}).on("cancel",function(){var a=this.attr("data-unformatted");this.text(a).call(i)})};j.call(l)}return a._context.setBackground(a,a._fullLayout.paper_bgcolor),P.addLinks(a),Promise.resolve()}(a,b,e);m._replotting=!0,l&&F(a),a.framework!==F&&(a.framework=F,F(a)),S.initGradients(a),l&&R.saveShowSpikeInitial(a);var o=!a.calcdata||a.calcdata.length!==(a._fullData||[]).length;o&&P.doCalcdata(a);for(var p=0;p<a.calcdata.length;p++)a.calcdata[p][0].trace=a._fullData[p];a._context.responsive?a._responsiveChartHandler||(a._responsiveChartHandler=function(){J.isHidden(a)||P.resize(a)},window.addEventListener("resize",a._responsiveChartHandler)):J.clearResponsive(a);var q=J.extendFlat({},m._size),r=0,s=[P.previousPromises,function(){if(j)return c.addFrames(a,j)},function b(){for(var c=m._basePlotModules,d=0;d<c.length;d++)c[d].drawFramework&&c[d].drawFramework(a);if(!m._glcanvas&&m._has("gl")&&(m._glcanvas=m._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(a){return a.key}),m._glcanvas.enter().append("canvas").attr("class",function(a){return"gl-canvas gl-canvas-"+a.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"})),m._glcanvas){m._glcanvas.attr("width",m.width).attr("height",m.height);var e=m._glcanvas.data()[0].regl;if(e&&(Math.floor(m.width)!==e._gl.drawingBufferWidth||Math.floor(m.height)!==e._gl.drawingBufferHeight)){var f="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!r)return J.log(f+" Clearing graph and plotting again."),P.cleanPlot([],{},a._fullData,m),P.supplyDefaults(a),m=a._fullLayout,P.doCalcdata(a),r++,b();J.error(f)}}return"h"===m.modebar.orientation?m._modebardiv.style("height",null).style("width","100%"):m._modebardiv.style("width",null).style("height",m.height+"px"),P.previousPromises(a)},h,function(){if(P.didMarginChange(q,m._size))return J.syncOrAsync([h,_.layoutStyles],a)}];n&&s.push(function(){if(o)return J.syncOrAsync([N.getComponentMethod("shapes","calcAutorange"),N.getComponentMethod("annotations","calcAutorange"),i],a);i()}),s.push(_.layoutStyles),n&&s.push(function(){return R.draw(a,l?"":"redraw")}),s.push(_.drawData,_.finalDraw,U,P.addLinks,P.rehover,P.redrag,P.doAutoMargin,P.previousPromises);var t=J.syncOrAsync(s,a);return t&&t.then||(t=Promise.resolve()),t.then(function(){return d(a),a})},c.purge=function(a){var b=(a=J.getGraphDiv(a))._fullLayout||{},c=a._fullData||[];return P.cleanPlot([],{},c,b),P.purge(a),L.purge(a),b._container&&b._container.remove(),delete a._context,a},c.react=function(a,b,e,f){var h,i;a=J.getGraphDiv(a),$.clearPromiseQueue(a);var j=a._fullData,k=a._fullLayout;if(J.isPlotDiv(a)&&j&&k){if(J.isPlainObject(b)){var l=b;b=l.data,e=l.layout,f=l.config,h=l.frames}var m=!1;if(f){var o=J.extendDeep({},a._context);a._context=void 0,g(a,f),m=function a(b,c){var d;for(d in b)if("_"!==d.charAt(0)){var e=b[d],f=c[d];if(e!==f)if(J.isPlainObject(e)&&J.isPlainObject(f)){if(a(e,f))return!0}else{if(!Array.isArray(e)||!Array.isArray(f))return!0;if(e.length!==f.length)return!0;for(var g=0;g<e.length;g++)if(e[g]!==f[g]){if(!J.isPlainObject(e[g])||!J.isPlainObject(f[g]))return!0;if(a(e[g],f[g]))return!0}}}}(o,a._context)}a.data=b||[],$.cleanData(a.data),a.layout=e||{},$.cleanLayout(a.layout),function(a,b,c,d){var e,f,g,h,i,j,k,l,m=d._preGUI,o=[],p={};for(e in m){if(i=z(e,ga)){if(f=i.attr||i.head+".uirevision",(h=(g=K(d,f).get())&&A(f,b))&&h===g&&(null===(j=m[e])&&(j=void 0),D(l=(k=K(b,e)).get(),j))){void 0===l&&"autorange"===e.substr(e.length-9)&&o.push(e.substr(0,e.length-10)),k.set(n(K(d,e).get()));continue}}else J.warn("unrecognized GUI edit: "+e);delete m[e],"range["===e.substr(e.length-8,6)&&(p[e.substr(0,e.length-9)]=1)}for(var q=0;q<o.length;q++){var r=o[q];if(p[r]){var s=K(b,r).get();s&&delete s.autorange}}var t=d._tracePreGUI;for(var u in t){var v,w=t[u],x=null;for(e in w){if(!x){var y=B(u,c);if(y<0){delete t[u];break}var E=C(u,a,(v=c[y]._fullInput).index);if(E<0){delete t[u];break}x=a[E]}if(i=z(e,ha)){if(i.attr?h=(g=K(d,i.attr).get())&&A(i.attr,b):(g=v.uirevision,void 0===(h=x.uirevision)&&(h=b.uirevision)),h&&h===g&&(null===(j=w[e])&&(j=void 0),D(l=(k=K(x,e)).get(),j))){k.set(n(K(v,e).get()));continue}}else J.warn("unrecognized GUI edit: "+e+" in trace uid "+u);delete w[e]}}}(a.data,a.layout,j,k),P.supplyDefaults(a,{skipUpdateCalc:!0});var p=a._fullData,q=a._fullLayout,r=void 0===q.datarevision,s=q.transition,t=function(a,b,c,d,e){var f=aa.layoutFlags();return f.arrays={},f.rangesAltered={},f.nChanges=0,f.nChangesAnim=0,E(b,c,[],{getValObject:function(a){return O.getLayoutValObject(c,a)},flags:f,immutable:d,transition:e,gd:a}),(f.plot||f.calc)&&(f.layoutReplot=!0),e&&f.nChanges&&f.nChangesAnim&&(f.anim=f.nChanges===f.nChangesAnim?"all":"some"),f}(a,k,q,r,s),v=t.newDataRevision,x=function(a,b,c,d,e,f){var g=b.length===c.length;if(!e&&!g)return{fullReplot:!0,calc:!0};var h,i,j=aa.traceFlags();j.arrays={},j.nChanges=0,j.nChangesAnim=0;var k={getValObject:function(a){var b=O.getTraceValObject(i,a);return!i._module.animatable&&b.anim&&(b.anim=!1),b},flags:j,immutable:d,transition:e,newDataRevision:f,gd:a},l={};for(h=0;h<b.length;h++)if(c[h]){if(i=c[h]._fullInput,P.hasMakesDataTransform(i)&&(i=c[h]),l[i.uid])continue;l[i.uid]=1,E(b[h]._fullInput,i,[],k)}return(j.calc||j.plot)&&(j.fullReplot=!0),e&&j.nChanges&&j.nChangesAnim&&(j.anim=j.nChanges===j.nChangesAnim&&g?"all":"some"),j}(a,j,p,r,s,v);w(a)&&(t.layoutReplot=!0),x.calc||t.calc?a.calcdata=void 0:P.supplyDefaultsUpdateCalc(a.calcdata,p);var y=[];if(h&&(a._transitionData={},P.createTransitionData(a),y.push(function(){return c.addFrames(a,h)})),q.transition&&!m&&(x.anim||t.anim))P.doCalcdata(a),_.doAutoRangeAndConstraints(a),y.push(function(){return P.transitionFromReact(a,x,t,k)});else if(x.fullReplot||t.layoutReplot||m)a._fullLayout._skipDefaults=!0,y.push(c.plot);else{for(var F in t.arrays){var G=t.arrays[F];if(G.length){var H=N.getComponentMethod(F,"drawOne");if(H!==J.noop)for(var I=0;I<G.length;I++)H(a,G[I]);else{var L=N.getComponentMethod(F,"draw");if(L===J.noop)throw new Error("cannot draw components: "+F);L(a)}}}y.push(P.previousPromises),x.style&&y.push(_.doTraceStyle),(x.colorbars||t.colorbars)&&y.push(_.doColorBars),t.legend&&y.push(_.doLegend),t.layoutstyle&&y.push(_.layoutStyles),t.axrange&&u(y),t.ticks&&y.push(_.doTicksRelayout),t.modebar&&y.push(_.doModeBar),t.camera&&y.push(_.doCamera),y.push(d)}y.push(P.rehover,P.redrag),(i=J.syncOrAsync(y,a))&&i.then||(i=Promise.resolve(a))}else i=c.newPlot(a,b,e,f);return i.then(function(){return a.emit("plotly_react",{data:b,layout:e}),a})},c.redraw=function(a){if(a=J.getGraphDiv(a),!J.isPlotDiv(a))throw new Error("This element is not a Plotly plot: "+a);return $.cleanData(a.data),$.cleanLayout(a.layout),a.calcdata=void 0,c.plot(a).then(function(){return a.emit("plotly_redraw"),a})},c.relayout=s,c.restyle=m,c.setPlotConfig=function(a){return J.extendFlat(Y,a)},c.update=x,c._guiRelayout=y(s),c._guiRestyle=y(m),c._guiUpdate=y(x),c._storeDirectGUIEdit=function(a,b,c){for(var d in c)p(d,K(a,d).get(),c[d],b)}},{"../components/color":594,"../components/drawing":615,"../constants/xmlns_namespaces":696,"../lib":719,"../lib/events":709,"../lib/queue":734,"../lib/svg_text_utils":743,"../plots/cartesian/axes":767,"../plots/cartesian/constants":773,"../plots/cartesian/graph_interact":776,"../plots/cartesian/select":784,"../plots/plots":828,"../plots/polar/legacy":836,"../registry":848,"./edit_types":750,"./helpers":751,"./manage_arrays":753,"./plot_config":755,"./plot_schema":756,"./subroutines":758,d3:164,"fast-isnumeric":226,"has-hover":411}],755:[function(a,b,c){"use strict";var d={staticPlot:{valType:"boolean",dflt:!1},plotlyServerURL:{valType:"string",dflt:"https://plot.ly"},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"boolean",dflt:1},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},e={};!function a(b,c){for(var d in b){var e=b[d];e.valType?c[d]=e.dflt:(c[d]||(c[d]={}),a(e,c[d]))}}(d,e),b.exports={configAttributes:d,dfltConfig:e}},{}],756:[function(a,b,c){"use strict";function d(a,b,c){if(!a)return!1;if(a._isLinkedToArray)if(e(b[c]))c++;else if(c<b.length)return!1;for(;c<b.length;c++){var d=a[b[c]];if(!u(d))break;if(a=d,c===b.length-1)break;if(a._isLinkedToArray){if(!e(b[++c]))return!1}else if("info_array"===a.valType){var f=b[++c];if(!e(f))return!1;var g=a.items;if(Array.isArray(g)){if(f>=g.length)return!1;if(2===a.dimensions){if(c++,b.length===c)return a;var h=b[c];if(!e(h))return!1;a=g[f][h]}else a=g[f]}else a=g}}return a}function e(a){return a===Math.round(a)&&a>=0}function f(a){return function(a){c.crawl(a,function(a,b,d){c.isValObject(a)?"data_array"===a.valType?(a.role="data",d[b+"src"]={valType:"string",editType:"none"}):!0===a.arrayOk&&(d[b+"src"]={valType:"string",editType:"none"}):u(a)&&(a.role="object")})}(a),function(a){c.crawl(a,function(a,b,c){if(a){var d=a[z];d&&(delete a[z],c[b]={items:{}},c[b].items[d]=a,c[b].role="object")}})}(a),function(a){!function a(b){for(var c in b)if(u(b[c]))a(b[c]);else if(Array.isArray(b[c]))for(var d=0;d<b[c].length;d++)a(b[c][d]);else b[c]instanceof RegExp&&(b[c]=b[c].toString())}(a)}(a),a}function g(a,b,c){var d=w(a,c),e=t({},b.layoutAttributes);e[y]=!0,d.set(e)}function h(a,b,c){var d=w(a,c);d.set(t(d.get()||{},b))}var i=a("../registry"),j=a("../lib"),k=a("../plots/attributes"),l=a("../plots/layout_attributes"),m=a("../plots/frame_attributes"),n=a("../plots/animation_attributes"),o=a("./plot_config").configAttributes,p=a("../plots/polar/legacy/area_attributes"),q=a("../plots/polar/legacy/axis_attributes"),r=a("./edit_types"),s=j.extendFlat,t=j.extendDeepAll,u=j.isPlainObject,v=j.isArrayOrTypedArray,w=j.nestedProperty,x=j.valObjectMeta,y="_isSubplotObj",z="_isLinkedToArray",A=[y,z,"_arrayAttrRegexps","_deprecated"];c.IS_SUBPLOT_OBJ=y,c.IS_LINKED_TO_ARRAY=z,c.DEPRECATED="_deprecated",c.UNDERSCORE_ATTRS=A,c.get=function(){var a={};i.allTypes.concat("area").forEach(function(b){a[b]=function(a){var b,d;"area"===a?(b={attributes:p},d={}):(b=i.modules[a]._module,d=b.basePlotModule);var e={type:null},g=t({},k),h=t({},b.attributes);c.crawl(h,function(a,b,c,d,e){w(g,e).set(void 0),void 0===a&&w(h,e).set(void 0)}),t(e,g),i.traceIs(a,"noOpacity")&&delete e.opacity,i.traceIs(a,"showLegend")||(delete e.showlegend,delete e.legendgroup),i.traceIs(a,"noHover")&&(delete e.hoverinfo,delete e.hoverlabel),b.selectPoints||delete e.selectedpoints,t(e,h),d.attributes&&t(e,d.attributes),e.type=a;var j={meta:b.meta||{},categories:b.categories||{},animatable:Boolean(b.animatable),type:a,attributes:f(e)};if(b.layoutAttributes){var l={};t(l,b.layoutAttributes),j.layoutAttributes=f(l)}return b.animatable||c.crawl(j,function(a){c.isValObject(a)&&"anim"in a&&delete a.anim}),j}(b)});var b,d={};return Object.keys(i.transformsRegistry).forEach(function(a){d[a]=function(a){var b=i.transformsRegistry[a],c=t({},b.attributes);return Object.keys(i.componentsRegistry).forEach(function(b){var d=i.componentsRegistry[b];d.schema&&d.schema.transforms&&d.schema.transforms[a]&&Object.keys(d.schema.transforms[a]).forEach(function(b){h(c,d.schema.transforms[a][b],b)})}),{attributes:f(c)}}(a)}),{defs:{valObjects:x,metaKeys:A.concat(["description","role","editType","impliedEdits"]),editType:{traces:r.traces,layout:r.layout},impliedEdits:{}},traces:a,layout:function(){var a,b,c={};for(a in t(c,l),i.subplotsRegistry)if((b=i.subplotsRegistry[a]).layoutAttributes)if(Array.isArray(b.attr))for(var d=0;d<b.attr.length;d++)g(c,b,b.attr[d]);else{var e="subplot"===b.attr?b.name:b.attr;g(c,b,e)}for(a in c=function(a){return s(a,{radialaxis:q.radialaxis,angularaxis:q.angularaxis}),s(a,q.layout),a}(c),i.componentsRegistry){var j=(b=i.componentsRegistry[a]).schema;if(j&&(j.subplots||j.layout)){var k=j.subplots;if(k&&k.xaxis&&!k.yaxis)for(var m in k.xaxis)delete c.yaxis[m]}else"colorscale"===b.name?t(c,b.layoutAttributes):b.layoutAttributes&&h(c,b.layoutAttributes,b.name)}return{layoutAttributes:f(c)}}(),transforms:d,frames:(b={frames:t({},m)},f(b),b.frames),animation:f(n),config:f(o)}},c.crawl=function(a,b,d,e){var f=d||0;e=e||"",Object.keys(a).forEach(function(d){var g=a[d];if(-1===A.indexOf(d)){var h=(e?e+".":"")+d;b(g,d,a,f,h),c.isValObject(g)||u(g)&&"impliedEdits"!==d&&c.crawl(g,b,f+1,h)}})},c.isValObject=function(a){return a&&void 0!==a.valType},c.findArrayAttributes=function(a){function b(a,b,c,i){g=g.slice(0,i).concat([b]),h=h.slice(0,i).concat([a&&a._isLinkedToArray]),a&&("data_array"===a.valType||!0===a.arrayOk)&&!("colorbar"===g[i-1]&&("ticktext"===b||"tickvals"===b))&&function a(b,c,d){var i=b[g[c]],j=d+g[c];if(c===g.length-1)v(i)&&f.push(e+j);else if(h[c]){if(Array.isArray(i))for(var k=0;k<i.length;k++)u(i[k])&&a(i[k],c+1,j+"["+k+"].")}else u(i)&&a(i,c+1,j+".")}(d,0,"")}var d,e,f=[],g=[],h=[];d=a,e="",c.crawl(k,b),a._module&&a._module.attributes&&c.crawl(a._module.attributes,b);var i=a.transforms;if(i)for(var j=0;j<i.length;j++){var l=i[j],m=l._module;m&&(e="transforms["+j+"].",d=l,c.crawl(m.attributes,b))}return f},c.getTraceValObject=function(a,b){var c,f,g=b[0],h=1;if("transforms"===g){if(1===b.length)return k.transforms;var j=a.transforms;if(!Array.isArray(j)||!j.length)return!1;var l=b[1];if(!e(l)||l>=j.length)return!1;f=(c=(i.transformsRegistry[j[l].type]||{}).attributes)&&c[b[2]],h=3}else if("area"===a.type)f=p[g];else{var m=a._module;if(m||(m=(i.modules[a.type||k.type.dflt]||{})._module),!m)return!1;if(!(f=(c=m.attributes)&&c[g])){var n=m.basePlotModule;n&&n.attributes&&(f=n.attributes[g])}f||(f=k[g])}return d(f,b,h)},c.getLayoutValObject=function(a,b){return d(function(a,b){var c,d,e,f,g=a._basePlotModules;if(g){var h;for(c=0;c<g.length;c++){if((e=g[c]).attrRegex&&e.attrRegex.test(b)){if(e.layoutAttrOverrides)return e.layoutAttrOverrides;!h&&e.layoutAttributes&&(h=e.layoutAttributes)}var j=e.baseLayoutAttrOverrides;if(j&&b in j)return j[b]}if(h)return h}var k=a._modules;if(k)for(c=0;c<k.length;c++)if((f=k[c].layoutAttributes)&&b in f)return f[b];for(d in i.componentsRegistry){if("colorscale"===(e=i.componentsRegistry[d]).name&&0===b.indexOf("coloraxis"))return e.layoutAttributes[b];if(!e.schema&&b===e.name)return e.layoutAttributes}return b in l?l[b]:"radialaxis"===b||"angularaxis"===b?q[b]:q.layout[b]||!1}(a,b[0]),b,1)}},{"../lib":719,"../plots/animation_attributes":762,"../plots/attributes":764,"../plots/frame_attributes":794,"../plots/layout_attributes":819,"../plots/polar/legacy/area_attributes":834,"../plots/polar/legacy/axis_attributes":835,"../registry":848,"./edit_types":750,"./plot_config":755}],757:[function(a,b,c){"use strict";function d(a){return a&&"string"==typeof a}function e(a){var b=a.length-1;return"s"!==a.charAt(b)&&f.warn("bad argument to arrayDefaultKey: "+a),a.substr(0,a.length-1)+"defaults"}var f=a("../lib"),g=a("../plots/attributes"),h="templateitemname",i={name:{valType:"string",editType:"none"}};i[h]={valType:"string",editType:"calc"},c.templatedArray=function(a,b){return b._isLinkedToArray=a,b.name=i.name,b[h]=i[h],b},c.traceTemplater=function(a){var b,c,d={};for(b in a)c=a[b],Array.isArray(c)&&c.length&&(d[b]=0);return{newTrace:function(e){var h={type:b=f.coerce(e,{},g,"type"),_template:null};if(b in d){c=a[b];var i=d[b]%c.length;d[b]++,h._template=c[i]}return h}}},c.newContainer=function(a,b,c){var d=a._template,e=d&&(d[b]||c&&d[c]);return f.isPlainObject(e)||(e=null),a[b]={_template:e}},c.arrayTemplater=function(a,b,c){var f=a._template,g=f&&f[e(b)],i=f&&f[b];Array.isArray(i)&&i.length||(i=[]);var j={};return{newItem:function(a){var b={name:a.name,_input:a},e=b[h]=a[h];if(!d(e))return b._template=g,b;for(var f=0;f<i.length;f++){var k=i[f];if(k.name===e)return j[e]=1,b._template=k,b}return b[c]=a[c]||!1,b._template=!1,b},defaultItems:function(){for(var a=[],b=0;b<i.length;b++){var c=i[b],e=c.name;if(d(e)&&!j[e]){var f={_template:c,name:e,_input:{_templateitemname:e}};f[h]=c[h],a.push(f),j[e]=1}}return a}}},c.arrayDefaultKey=e,c.arrayEditor=function(a,b,c){function d(){l={},k&&(l[m]={},l[m][h]=k)}function e(a,b){k?f.nestedProperty(l[m],a).set(b):l[m+"."+a]=b}function g(){var a=l;return d(),a}var i=(f.nestedProperty(a,b).get()||[]).length,j=c._index,k=j>=i&&(c._input||{})._templateitemname;k&&(j=i);var l,m=b+"["+j+"]";return d(),{modifyBase:function(a,b){l[a]=b},modifyItem:e,getUpdateObj:g,applyUpdate:function(b,c){b&&e(b,c);var d=g();for(var h in d)f.nestedProperty(a,h).set(d[h])}}}},{"../lib":719,"../plots/attributes":764}],758:[function(a,b,c){"use strict";function d(a,b,c){for(var d=0;d<c.length;d++){var e=c[d][0],f=c[d][1];if(!(e[0]>=a[1]||e[1]<=a[0])&&f[0]<b[1]&&f[1]>b[0])return!0}return!1}function e(a){function b(a,b,c){var d=a._lw/2;return"x"===a._id.charAt(0)?b?"top"===c?b._offset-B-d:b._offset+b._length+B+d:A.t+A.h*(1-(a.position||0))+d%1:b?"right"===c?b._offset+b._length+B+d:b._offset-B-d:A.l+A.w*(a.position||0)+d%1}function e(a){return"M"+N+","+a+"H"+O}function g(a){return"M"+x._offset+","+a+"h"+x._length}function j(a){return"M"+a+","+U+"V"+T}function m(a){return"M"+a+","+y._offset+"v"+y._length}function p(a,b,c){if(!a.showline||u!==a._mainSubplot)return"";if(!a._anchorAxis)return c(a._mainLinePosition);var d=b(a._mainLinePosition);return a.mirror&&(d+=b(a._mainMirrorPosition)),d}var t,u,v,w,x,y,z=a._fullLayout,A=z._size,B=A.p,C=r.list(a,"",!0);if(z._paperdiv.style({width:a._context.responsive&&z.autosize&&!a._context._hasZeroWidth&&!a.layout.width?"100%":z.width+"px",height:a._context.responsive&&z.autosize&&!a._context._hasZeroHeight&&!a.layout.height?"100%":z.height+"px"}).selectAll(".main-svg").call(o.setSize,z.width,z.height),a._context.setBackground(a,z.paper_bgcolor),c.drawMainTitle(a),q.manage(a),!z._has("cartesian"))return k.previousPromises(a);for(t=0;t<C.length;t++){var D=(w=C[t])._anchorAxis;w._linepositions={},w._lw=o.crispRound(a,w.linewidth,1),w._mainLinePosition=b(w,D,w.side),w._mainMirrorPosition=w.mirror&&D?b(w,D,s.OPPOSITE_SIDE[w.side]):null}var E=[],F=[],G=[],H=1===n.opacity(z.paper_bgcolor)&&1===n.opacity(z.plot_bgcolor)&&z.paper_bgcolor===z.plot_bgcolor;for(u in z._plots)if((v=z._plots[u]).mainplot)v.bg&&v.bg.remove(),v.bg=void 0;else{var I=v.xaxis.domain,J=v.yaxis.domain,K=v.plotgroup;if(d(I,J,G)){var L=K.node(),M=v.bg=l.ensureSingle(K,"rect","bg");L.insertBefore(M.node(),L.childNodes[0]),F.push(u)}else K.select("rect.bg").remove(),G.push([I,J]),H||(E.push(u),F.push(u))}var N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$=z._bgLayer.selectAll(".bg").data(E);for($.enter().append("rect").classed("bg",!0),$.exit().remove(),$.each(function(a){z._plots[a].bg=i.select(this)}),t=0;t<F.length;t++)v=z._plots[F[t]],x=v.xaxis,y=v.yaxis,v.bg&&v.bg.call(o.setRect,x._offset-B,y._offset-B,x._length+2*B,y._length+2*B).call(n.fill,z.plot_bgcolor).style("stroke-width",0);if(!z._hasOnlyLargeSploms)for(u in z._plots){v=z._plots[u],x=v.xaxis,y=v.yaxis;var _,aa,ba=v.clipId="clip"+z._uid+u+"plot",ca=l.ensureSingleById(z._clips,"clipPath",ba,function(a){a.classed("plotclip",!0).append("rect")});v.clipRect=ca.select("rect").attr({width:x._length,height:y._length}),o.setTranslate(v.plot,x._offset,y._offset),v._hasClipOnAxisFalse?(_=null,aa=ba):(_=ba,aa=null),o.setClipUrl(v.plot,_,a),v.layerClipId=aa}for(u in z._plots){v=z._plots[u],x=v.xaxis,y=v.yaxis;var da="M0,0";f(x,u)&&(R=h(x,"left",y,C),N=x._offset-(R?B+R:0),S=h(x,"right",y,C),O=x._offset+x._length+(S?B+S:0),P=b(x,y,"bottom"),Q=b(x,y,"top"),!(Z=!x._anchorAxis||u!==x._mainSubplot)||"allticks"!==x.mirror&&"all"!==x.mirror||(x._linepositions[u]=[P,Q]),da=p(x,e,g),Z&&x.showline&&("all"===x.mirror||"allticks"===x.mirror)&&(da+=e(P)+e(Q)),v.xlines.style("stroke-width",x._lw+"px").call(n.stroke,x.showline?x.linecolor:"rgba(0,0,0,0)")),v.xlines.attr("d",da);var ea="M0,0";f(y,u)&&(X=h(y,"bottom",x,C),T=y._offset+y._length+(X?B:0),Y=h(y,"top",x,C),U=y._offset-(Y?B:0),V=b(y,x,"left"),W=b(y,x,"right"),!(Z=!y._anchorAxis||u!==y._mainSubplot)||"allticks"!==y.mirror&&"all"!==y.mirror||(y._linepositions[u]=[V,W]),ea=p(y,j,m),Z&&y.showline&&("all"===y.mirror||"allticks"===y.mirror)&&(ea+=j(V)+j(W)),v.ylines.style("stroke-width",y._lw+"px").call(n.stroke,y.showline?y.linecolor:"rgba(0,0,0,0)")),v.ylines.attr("d",ea)}return r.makeClipPaths(a),k.previousPromises(a)}function f(a,b){return(a.ticks||a.showline)&&(b===a._mainSubplot||"all"===a.mirror||"allticks"===a.mirror)}function g(a,b,c){if(!c.showline||!c._lw)return!1;if("all"===c.mirror||"allticks"===c.mirror)return!0;var d=c._anchorAxis;if(!d)return!1;var e=s.FROM_BL[b];return c.side===b?d.domain[e]===a.domain[e]:c.mirror&&d.domain[1-e]===a.domain[1-e]}function h(a,b,c,d){if(g(a,b,c))return c._lw;for(var e=0;e<d.length;e++){var f=d[e];if(f._mainAxis===c._mainAxis&&g(a,b,f))return f._lw}return 0}var i=a("d3"),j=a("../registry"),k=a("../plots/plots"),l=a("../lib"),m=a("../lib/clear_gl_canvases"),n=a("../components/color"),o=a("../components/drawing"),p=a("../components/titles"),q=a("../components/modebar"),r=a("../plots/cartesian/axes"),s=a("../constants/alignment"),t=a("../plots/cartesian/constraints"),u=t.enforce,v=t.clean,w=a("../plots/cartesian/autorange").doAutoRange,x="start";c.layoutStyles=function(a){return l.syncOrAsync([k.doAutoMargin,e],a)},c.drawMainTitle=function(a){var b=a._fullLayout,c=function(a){var b=a.title,c="middle";return l.isRightAnchor(b)?c="end":l.isLeftAnchor(b)&&(c=x),c}(b),d=function(a){var b=a.title,c="0em";return l.isTopAnchor(b)?c=s.CAP_SHIFT+"em":l.isMiddleAnchor(b)&&(c=s.MID_SHIFT+"em"),c}(b);p.draw(a,"gtitle",{propContainer:b,propName:"title.text",placeholder:b._dfltTitle.plot,attributes:{x:function(a,b){var c=a.title,d=a._size,e=0;switch(b===x?e=c.pad.l:"end"===b&&(e=-c.pad.r),c.xref){case"paper":return d.l+d.w*c.x+e;case"container":default:return a.width*c.x+e}}(b,c),y:function(a,b){var c=a.title,d=a._size,e=0;if("0em"!==b&&b?b===s.CAP_SHIFT+"em"&&(e=c.pad.t):e=-c.pad.b,"auto"===c.y)return d.t/2;switch(c.yref){case"paper":return d.t+d.h-d.h*c.y+e;case"container":default:return a.height-a.height*c.y+e}}(b,d),"text-anchor":c,dy:d}})},c.doTraceStyle=function(a){var b,d=a.calcdata,e=[];for(b=0;b<d.length;b++){var f=d[b],g=f[0]||{},h=g.trace||{},i=h._module||{},l=i.arraysToCalcdata;l&&l(f,h);var n=i.editStyle;n&&e.push({fn:n,cd0:g})}if(e.length){for(b=0;b<e.length;b++){var o=e[b];o.fn(a,o.cd0)}m(a),c.redrawReglTraces(a)}return k.style(a),j.getComponentMethod("legend","draw")(a),k.previousPromises(a)},c.doColorBars=function(a){return j.getComponentMethod("colorbar","draw")(a),k.previousPromises(a)},c.layoutReplot=function(a){var b=a.layout;return a.layout=void 0,j.call("plot",a,"",b)},c.doLegend=function(a){return j.getComponentMethod("legend","draw")(a),k.previousPromises(a)},c.doTicksRelayout=function(a){return r.draw(a,"redraw"),a._fullLayout._hasOnlyLargeSploms&&(j.subplotsRegistry.splom.updateGrid(a),m(a),c.redrawReglTraces(a)),c.drawMainTitle(a),k.previousPromises(a)},c.doModeBar=function(a){var b=a._fullLayout;q.manage(a);for(var c=0;c<b._basePlotModules.length;c++){var d=b._basePlotModules[c].updateFx;d&&d(a)}return k.previousPromises(a)},c.doCamera=function(a){for(var b=a._fullLayout,c=b._subplots.gl3d,d=0;d<c.length;d++){var e=b[c[d]],f=e._scene,g=e.camera;f.setCamera(g)}},c.drawData=function(a){var b=a._fullLayout;m(a);for(var d=b._basePlotModules,e=0;e<d.length;e++)d[e].plot(a);return c.redrawReglTraces(a),k.style(a),j.getComponentMethod("shapes","draw")(a),j.getComponentMethod("annotations","draw")(a),j.getComponentMethod("images","draw")(a),b._replotting=!1,k.previousPromises(a)},c.redrawReglTraces=function(a){var b=a._fullLayout;if(b._has("regl")){var c,d,e=a._fullData,f=[],g=[];for(b._hasOnlyLargeSploms&&b._splomGrid.draw(),c=0;c<e.length;c++){var h=e[c];!0===h.visible&&0!==h._length&&("splom"===h.type?b._splomScenes[h.uid].draw():"scattergl"===h.type?l.pushUnique(f,h.xaxis+h.yaxis):"scatterpolargl"===h.type&&l.pushUnique(g,h.subplot))}for(c=0;c<f.length;c++)(d=b._plots[f[c]])._scene&&d._scene.draw();for(c=0;c<g.length;c++)(d=b[g[c]]._subplot)._scene&&d._scene.draw()}},c.doAutoRangeAndConstraints=function(a){for(var b,c,d=a._fullLayout,e=r.list(a,"",!0),f=d._axisMatchGroups||[],g=0;g<e.length;g++)b=e[g],v(a,b),w(a,b);u(a);a:for(var h=0;h<f.length;h++){var i,j=f[h],k=null;for(i in j){if(!1===(b=r.getFromId(a,i)).autorange)continue a;c=l.simpleMap(b.range,b.r2l),k?k[0]<k[1]?(k[0]=Math.min(k[0],c[0]),k[1]=Math.max(k[1],c[1])):(k[0]=Math.max(k[0],c[0]),k[1]=Math.min(k[1],c[1])):k=c}for(i in j)(b=r.getFromId(a,i)).range=l.simpleMap(k,b.l2r),b._input.range=b.range.slice(),b.setScale()}},c.finalDraw=function(a){j.getComponentMethod("rangeslider","draw")(a),j.getComponentMethod("rangeselector","draw")(a)},c.drawMarginPushers=function(a){j.getComponentMethod("legend","draw")(a),j.getComponentMethod("rangeselector","draw")(a),j.getComponentMethod("sliders","draw")(a),j.getComponentMethod("updatemenus","draw")(a),j.getComponentMethod("colorbar","draw")(a)}},{"../components/color":594,"../components/drawing":615,"../components/modebar":652,"../components/titles":681,"../constants/alignment":688,"../lib":719,"../lib/clear_gl_canvases":704,"../plots/cartesian/autorange":766,"../plots/cartesian/axes":767,"../plots/cartesian/constraints":774,"../plots/plots":828,"../registry":848,d3:164}],759:[function(a,b,c){"use strict";function d(a,b){function c(b,c,e){if(k(c)&&k(b))d(b,c);else if(Array.isArray(c)&&Array.isArray(b)){var f=o.arrayTemplater({_template:a},e);for(g=0;g<c.length;g++){var h=c[g],i=f.newItem(h)._template;i&&d(i,h)}var j=f.defaultItems();for(g=0;g<j.length;g++)c.push(j[g]._template);for(g=0;g<c.length;g++)delete c[g].templateitemname}}a=j.extendDeep({},a);var f,g,h=Object.keys(a).sort();for(f=0;f<h.length;f++){var i=h[f],l=a[i];if(i in b?c(l,b[i],i):b[i]=l,e(i)===i)for(var m in b){var n=e(m);m===n||n!==i||m in a||c(l,b[m],i)}}}function e(a){return a.replace(/[0-9]+$/,"")}function f(a,b,c,d,h){var i=h&&c(h);for(var l in a){var m=a[l],n=g(a,l,d),p=g(a,l,h),q=c(p);if(!q){var r=e(l);r!==l&&(q=c(p=g(a,r,h)))}if(!(i&&i===q||!q||q._noTemplating||"data_array"===q.valType||q.arrayOk&&Array.isArray(m)))if(!q.valType&&k(m))f(m,b,c,n,p);else if(q._isLinkedToArray&&Array.isArray(m))for(var s=!1,t=0,u={},v=0;v<m.length;v++){var w=m[v];if(k(w)){var x=w.name;if(x)u[x]||(f(w,b,c,g(m,t,n),g(m,t,p)),t++,u[x]=1);else if(!s){var y=g(a,o.arrayDefaultKey(l),d),z=g(m,t,n);f(w,b,c,z,g(m,t,p));var A=j.nestedProperty(b,z);j.nestedProperty(b,y).set(A.get()),A.set(null),s=!0}}}else j.nestedProperty(b,n).set(m)}}function g(a,b,c){return c?Array.isArray(a)?c+"["+b+"]":c+"."+b:b}function h(a){for(var b=0;b<a.length;b++)if(k(a[b]))return!0}function i(a){var b;switch(a.code){case"data":b="The template has no key data.";break;case"layout":b="The template has no key layout.";break;case"missing":b=a.path?"There are no templates for item "+a.path+" with name "+a.templateitemname:"There are no templates for trace "+a.index+", of type "+a.traceType+".";break;case"unused":b=a.path?"The template item at "+a.path+" was not used in constructing the plot.":a.dataCount?"Some of the templates of type "+a.traceType+" were not used. The template has "+a.templateCount+" traces, the data only has "+a.dataCount+" of this type.":"The template has "+a.templateCount+" traces of type "+a.traceType+" but there are none in the data.";break;case"reused":b="Some of the templates of type "+a.traceType+" were used more than once. The template has "+a.templateCount+" traces, the data has "+a.dataCount+" of this type."}return a.msg=b,a}var j=a("../lib"),k=j.isPlainObject,l=a("./plot_schema"),m=a("../plots/plots"),n=a("../plots/attributes"),o=a("./plot_template"),p=a("./plot_config").dfltConfig;c.makeTemplate=function(a){a=j.isPlainObject(a)?a:j.getGraphDiv(a),a=j.extendDeep({_context:p},{data:a.data,layout:a.layout}),m.supplyDefaults(a);var b=a.data||[],c=a.layout||{};c._basePlotModules=a._fullLayout._basePlotModules,c._modules=a._fullLayout._modules;var e={data:{},layout:{}};b.forEach(function(a){var b={};f(a,b,function(a,b){return l.getTraceValObject(a,j.nestedProperty({},b).parts)}.bind(null,a));var c=j.coerce(a,{},n,"type"),d=e.data[c];d||(d=e.data[c]=[]),d.push(b)}),
f(c,e.layout,function(a,b){return l.getLayoutValObject(a,j.nestedProperty({},b).parts)}.bind(null,c)),delete e.layout.template;var g=c.template;if(k(g)){var h,i,o,q,r,s,t=g.layout;k(t)&&d(t,e.layout);var u=g.data;if(k(u)){for(i in e.data)if(o=u[i],Array.isArray(o)){for(s=(r=e.data[i]).length,q=o.length,h=0;h<s;h++)d(o[h%q],r[h]);for(h=s;h<q;h++)r.push(j.extendDeep({},o[h]))}for(i in u)i in e.data||(e.data[i]=j.extendDeep([],u[i]))}}return e},c.validateTemplate=function(a,b){var c=j.extendDeep({},{_context:p,data:a.data,layout:a.layout}),d=c.layout||{};k(b)||(b=d.template||{});var f=b.layout,l=b.data,n=[];c.layout=d,c.layout.template=b,m.supplyDefaults(c);var o=c._fullLayout,q=c._fullData,r={};if(k(f)?(function a(b,c){for(var d in b)if("_"!==d.charAt(0)&&k(b[d])){var f,h=e(d),i=[];for(f=0;f<c.length;f++)i.push(g(b,d,c[f])),h!==d&&i.push(g(b,h,c[f]));for(f=0;f<i.length;f++)r[i[f]]=1;a(b[d],i)}}(o,["layout"]),function a(b,c){for(var d in b)if(-1===d.indexOf("defaults")&&k(b[d])){var e=g(b,d,c);r[e]?a(b[d],e):n.push({code:"unused",path:e})}}(f,"layout")):n.push({code:"layout"}),k(l)){for(var s,t={},u=0;u<q.length;u++){var v=q[u];t[s=v.type]=(t[s]||0)+1,v._fullInput._template||n.push({code:"missing",index:v._fullInput.index,traceType:s})}for(s in l){var w=l[s].length,x=t[s]||0;w>x?n.push({code:"unused",traceType:s,templateCount:w,dataCount:x}):x>w&&n.push({code:"reused",traceType:s,templateCount:w,dataCount:x})}}else n.push({code:"data"});if(function a(b,c){for(var d in b)if("_"!==d.charAt(0)){var e=b[d],f=g(b,d,c);k(e)?(Array.isArray(b)&&!1===e._template&&e.templateitemname&&n.push({code:"missing",path:f,templateitemname:e.templateitemname}),a(e,f)):Array.isArray(e)&&h(e)&&a(e,f)}}({data:q,layout:o},""),n.length)return n.map(i)}},{"../lib":719,"../plots/attributes":764,"../plots/plots":828,"./plot_config":755,"./plot_schema":756,"./plot_template":757}],760:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("./plot_api"),f=a("../lib"),g=a("../snapshot/helpers"),h=a("../snapshot/tosvg"),i=a("../snapshot/svgtoimg"),j={format:{valType:"enumerated",values:["png","jpeg","webp","svg"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};b.exports=function(a,b){function c(a){return!(a in b)||f.validate(b[a],j[a])}function k(a,c){return f.coerce(b,r,j,a,c)}function l(){return new Promise(function(a){setTimeout(a,g.getDelay(y._fullLayout))})}function m(){return new Promise(function(a,b){var c=h(y,s,v),d=y._fullLayout.width,j=y._fullLayout.height;if(e.purge(y),document.body.removeChild(y),"svg"===s)return a(x?c:g.encodeSVG(c));var k=document.createElement("canvas");k.id=f.randstr(),i({format:s,width:d,height:j,scale:v,canvas:k,svg:c,promise:!0}).then(a).catch(b)})}var n,o,p,q;if(b=b||{},f.isPlainObject(a)?(n=a.data||[],o=a.layout||{},p=a.config||{},q={}):(a=f.getGraphDiv(a),n=f.extendDeep([],a.data),o=f.extendDeep({},a.layout),p=a._context,q=a._fullLayout||{}),!c("width")&&null!==b.width||!c("height")&&null!==b.height)throw new Error("Height and width should be pixel values.");if(!c("format"))throw new Error("Image format is not jpeg, png, svg or webp.");var r={},s=k("format"),t=k("width"),u=k("height"),v=k("scale"),w=k("setBackground"),x=k("imageDataOnly"),y=document.createElement("div");y.style.position="absolute",y.style.left="-5000px",document.body.appendChild(y);var z=f.extendFlat({},o);t?z.width=t:null===b.width&&d(q.width)&&(z.width=q.width),u?z.height=u:null===b.height&&d(q.height)&&(z.height=q.height);var A=f.extendFlat({},p,{_exportedPlot:!0,staticPlot:!0,setBackground:w}),B=g.getRedrawFunc(y);return new Promise(function(a,b){e.plot(y,n,z,A).then(B).then(l).then(m).then(function(b){a(function(a){return x?a.replace(g.IMAGE_URL_PREFIX,""):a}(b))}).catch(function(a){b(a)})})}},{"../lib":719,"../snapshot/helpers":852,"../snapshot/svgtoimg":854,"../snapshot/tosvg":856,"./plot_api":754,"fast-isnumeric":226}],761:[function(a,b,c){"use strict";function d(a,b,c,e,i,k){k=k||[];for(var l=Object.keys(a),m=0;m<l.length;m++){var q=l[m];if("transforms"!==q){var r=k.slice();r.push(q);var s=a[q],t=b[q],u=h(c,q),v="info_array"===(u||{}).valType,w="colorscale"===(u||{}).valType,x=(u||{}).items;if(g(c,q))if(n(s)&&n(t))d(s,t,u,e,i,r);else if(v&&o(s)){s.length>t.length&&e.push(f("unused",i,r.concat(t.length)));var y,z,A,B,C,D=t.length,E=Array.isArray(x);if(E&&(D=Math.min(D,x.length)),2===u.dimensions)for(z=0;z<D;z++)if(o(s[z])){s[z].length>t[z].length&&e.push(f("unused",i,r.concat(z,t[z].length)));var F=t[z].length;for(y=0;y<(E?Math.min(F,x[z].length):F);y++)A=E?x[z][y]:x,B=s[z][y],C=t[z][y],j.validate(B,A)?C!==B&&C!==+B&&e.push(f("dynamic",i,r.concat(z,y),B,C)):e.push(f("value",i,r.concat(z,y),B))}else e.push(f("array",i,r.concat(z),s[z]));else for(z=0;z<D;z++)A=E?x[z]:x,B=s[z],C=t[z],j.validate(B,A)?C!==B&&C!==+B&&e.push(f("dynamic",i,r.concat(z),B,C)):e.push(f("value",i,r.concat(z),B))}else if(u.items&&!v&&o(s)){var G,H,I=x[Object.keys(x)[0]],J=[];for(G=0;G<t.length;G++){var K=t[G]._index||G;if((H=r.slice()).push(K),n(s[K])&&n(t[G])){J.push(K);var L=s[K],M=t[G];n(L)&&!1!==L.visible&&!1===M.visible?e.push(f("invisible",i,H)):d(L,M,I,e,i,H)}}for(G=0;G<s.length;G++)(H=r.slice()).push(G),n(s[G])?-1===J.indexOf(G)&&e.push(f("unused",i,H)):e.push(f("object",i,H,s[G]))}else!n(s)&&n(t)?e.push(f("object",i,r,s)):p(s)||!p(t)||v||w?q in b?j.validate(s,u)?"enumerated"===u.valType&&(u.coerceNumber&&s!==+t||s!==t)&&e.push(f("dynamic",i,r,s,t)):e.push(f("value",i,r,s)):e.push(f("unused",i,r,s)):e.push(f("array",i,r,s));else e.push(f("schema",i,r))}}return e}function e(a){return o(a)?"In data trace "+a[1]+", ":"In "+a+", "}function f(a,b,c,d,e){var f,g;c=c||"",o(b)?(f=b[0],g=b[1]):(f=b,g=null);var h=function(a){if(!o(a))return String(a);for(var b="",c=0;c<a.length;c++){var d=a[c];"number"==typeof d?b=b.substr(0,b.length-1)+"["+d+"]":b+=d,c<a.length-1&&(b+=".")}return b}(c),i=q[a](b,h,d,e);return j.log(i),{code:a,container:f,trace:g,path:c,astr:h,msg:i}}function g(a,b){var c=i(b),d=c.keyMinusId,e=c.id;return!!(d in a&&a[d]._isSubplotObj&&e)||b in a}function h(a,b){return b in a?a[b]:a[i(b).keyMinusId]}function i(a){var b=a.match(r);return{keyMinusId:b&&b[1],id:b&&b[2]}}var j=a("../lib"),k=a("../plots/plots"),l=a("./plot_schema"),m=a("./plot_config").dfltConfig,n=j.isPlainObject,o=Array.isArray,p=j.isArrayOrTypedArray;b.exports=function(a,b){var c,e,g=l.get(),h=[],i={_context:j.extendFlat({},m)};o(a)?(i.data=j.extendDeep([],a),c=a):(i.data=[],c=[],h.push(f("array","data"))),n(b)?(i.layout=j.extendDeep({},b),e=b):(i.layout={},e={},arguments.length>1&&h.push(f("object","layout"))),k.supplyDefaults(i);for(var p=i._fullData,q=c.length,r=0;r<q;r++){var s=c[r],t=["data",r];if(n(s)){var u=p[r],v=u.type,w=g.traces[v].attributes;w.type={valType:"enumerated",values:[v]},!1===u.visible&&!1!==s.visible&&h.push(f("invisible",t)),d(s,u,w,h,t);var x=s.transforms,y=u.transforms;if(x){o(x)||h.push(f("array",t,["transforms"])),t.push("transforms");for(var z=0;z<x.length;z++){var A=["transforms",z],B=x[z].type;if(n(x[z])){var C=g.transforms[B]?g.transforms[B].attributes:{};C.type={valType:"enumerated",values:Object.keys(g.transforms)},d(x[z],y[z],C,h,t,A)}else h.push(f("object",t,A))}}}else h.push(f("object",t))}return d(e,i._fullLayout,function(a,b){for(var c=a.layout.layoutAttributes,d=0;d<b.length;d++){var e=b[d],f=a.traces[e.type],g=f.layoutAttributes;g&&(e.subplot?j.extendFlat(c[f.attributes.subplot.dflt],g):j.extendFlat(c,g))}return c}(g,p),h,"layout"),0===h.length?void 0:h};var q={object:function(a,b){return("layout"===a&&""===b?"The layout argument":"data"===a[0]&&""===b?"Trace "+a[1]+" in the data argument":e(a)+"key "+b)+" must be linked to an object container"},array:function(a,b){return("data"===a?"The data argument":e(a)+"key "+b)+" must be linked to an array container"},schema:function(a,b){return e(a)+"key "+b+" is not part of the schema"},unused:function(a,b,c){var d=n(c)?"container":"key";return e(a)+d+" "+b+" did not get coerced"},dynamic:function(a,b,c,d){return[e(a)+"key",b,"(set to '"+c+"')","got reset to","'"+d+"'","during defaults."].join(" ")},invisible:function(a,b){return(b?e(a)+"item "+b:"Trace "+a[1])+" got defaulted to be not visible"},value:function(a,b,c){return[e(a)+"key "+b,"is set to an invalid value ("+c+")"].join(" ")}},r=j.counterRegex("([a-z]+)")},{"../lib":719,"../plots/plots":828,"./plot_config":755,"./plot_schema":756}],762:[function(a,b,c){"use strict";b.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],763:[function(a,b,c){"use strict";var d=a("../lib"),e=a("../plot_api/plot_template");b.exports=function(a,b,c){var f,g,h=c.name,i=c.inclusionAttr||"visible",j=b[h],k=d.isArrayOrTypedArray(a[h])?a[h]:[],l=b[h]=[],m=e.arrayTemplater(b,h,i);for(f=0;f<k.length;f++){var n=k[f];d.isPlainObject(n)?g=m.newItem(n):(g=m.newItem({}))[i]=!1,g._index=f,!1!==g[i]&&c.handleItemDefaults(n,g,b,c),l.push(g)}var o=m.defaultItems();for(f=0;f<o.length;f++)(g=o[f])._index=l.length,c.handleItemDefaults({},g,b,c,{}),l.push(g);if(d.isArrayOrTypedArray(j)){var p=Math.min(j.length,l.length);for(f=0;f<p;f++)d.relinkPrivateKeys(l[f],j[f])}return l}},{"../lib":719,"../plot_api/plot_template":757}],764:[function(a,b,c){"use strict";var d=a("../components/fx/attributes");b.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:d.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":624}],765:[function(a,b,c){"use strict";b.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],766:[function(a,b,c){"use strict";function d(a,b){var c,d,g=[],h=e(b),i=f(a,b),j=i.min,k=i.max;if(0===j.length||0===k.length)return n.simpleMap(b.range,b.r2l);var l=j[0].val,m=k[0].val;for(c=1;c<j.length&&l===m;c++)l=Math.min(l,j[c].val);for(c=1;c<k.length&&l===m;c++)m=Math.max(m,k[c].val);var o=!1;if(b.range){var p=n.simpleMap(b.range,b.r2l);o=p[1]<p[0]}"reversed"===b.autorange&&(o=!0,b.autorange=!0);var q,r,s,t,u,v,w=b.rangemode,x="tozero"===w,y="nonnegative"===w,z=b._length,A=z/10,B=0;for(c=0;c<j.length;c++)for(q=j[c],d=0;d<k.length;d++)(v=(r=k[d]).val-q.val)>0&&((u=z-h(q)-h(r))>A?v/u>B&&(s=q,t=r,B=v/u):v/z>B&&(s={val:q.val,pad:0},t={val:r.val,pad:0},B=v/z));if(l===m){var C=l-1,D=l+1;if(x)if(0===l)g=[0,1];else{var E=(l>0?k:j).reduce(function(a,b){return Math.max(a,h(b))},0),F=l/(1-Math.min(.5,E/z));g=l>0?[0,F]:[F,0]}else g=y?[Math.max(0,C),Math.max(1,D)]:[C,D]}else x?(s.val>=0&&(s={val:0,pad:0}),t.val<=0&&(t={val:0,pad:0})):y&&(s.val-B*h(s)<0&&(s={val:0,pad:0}),t.val<=0&&(t={val:1,pad:0})),B=(t.val-s.val)/(z-h(s)-h(t)),g=[s.val-B*h(s),t.val+B*h(t)];return o&&g.reverse(),n.simpleMap(g,b.l2r||Number)}function e(a){var b=a._length/20;return"domain"===a.constrain&&a._inputDomain&&(b*=(a._inputDomain[1]-a._inputDomain[0])/(a.domain[1]-a.domain[0])),function(a){return a.pad+(a.extrapad?b:0)}}function f(a,b){function c(a,b){for(d=0;d<b.length;d++){var c=a[b[d]],j=(c._extremes||{})[i];if(!0===c.visible&&j){for(e=0;e<j.min.length;e++)f=j.min[e],g(l,f.val,f.pad,{extrapad:f.extrapad});for(e=0;e<j.max.length;e++)f=j.max[e],h(m,f.val,f.pad,{extrapad:f.extrapad})}}}var d,e,f,i=b._id,j=a._fullData,k=a._fullLayout,l=[],m=[];return c(j,b._traceIndices),c(k.annotations||[],b._annIndices||[]),c(k.shapes||[],b._shapeIndices||[]),{min:l,max:m}}function g(a,b,c,d){i(a,b,c,d,k)}function h(a,b,c,d){i(a,b,c,d,l)}function i(a,b,c,d,e){for(var f=d.tozero,g=d.extrapad,h=!0,i=0;i<a.length&&h;i++){var j=a[i];if(e(j.val,b)&&j.pad>=c&&(j.extrapad||!g)){h=!1;break}e(b,j.val)&&j.pad<=c&&(g||!j.extrapad)&&(a.splice(i,1),i--)}if(h){var k=f&&0===b;a.push({val:b,pad:k?0:c,extrapad:!k&&g})}}function j(a){return m(a)&&Math.abs(a)<o}function k(a,b){return a<=b}function l(a,b){return a>=b}var m=a("fast-isnumeric"),n=a("../../lib"),o=a("../../constants/numerical").FP_SAFE,p=a("../../registry");b.exports={getAutoRange:d,makePadFn:e,doAutoRange:function(a,b){if(b.setScale(),b.autorange){b.range=d(a,b),b._r=b.range.slice(),b._rl=n.simpleMap(b._r,b.r2l);var c=b._input,e={};e[b._attr+".range"]=b.range,e[b._attr+".autorange"]=b.autorange,p.call("_storeDirectGUIEdit",a.layout,a._fullLayout._preGUI,e),c.range=b.range.slice(),c.autorange=b.autorange}var f=b._anchorAxis;if(f&&f.rangeslider){var g=f.rangeslider[b._name];g&&"auto"===g.rangemode&&(g.range=d(a,b)),f._input.rangeslider[b._name]=n.extendFlat({},g)}},findExtremes:function(a,b,c){function d(a){if(Array.isArray(a))return z=!0,function(b){return Math.max(Number(a[b]||0),0)};var b=Math.max(Number(a||0),0);return function(){return b}}function e(c){k=b[c],m(k)&&(p=A(c),q=B(c),r=k-D(c),s=k+C(c),y&&r<s/10&&(r=s/10),l=a.c2l(r),n=a.c2l(s),x&&(l=Math.min(0,l),n=Math.max(0,n)),j(l)&&g(t,l,q,E),j(n)&&h(u,n,p,E))}c||(c={}),a._m||a.setScale();var f,i,k,l,n,p,q,r,s,t=[],u=[],v=b.length,w=c.padded||!1,x=c.tozero&&("linear"===a.type||"-"===a.type),y="log"===a.type,z=!1,A=d((a._m>0?c.ppadplus:c.ppadminus)||c.ppad||0),B=d((a._m>0?c.ppadminus:c.ppadplus)||c.ppad||0),C=d(c.vpadplus||c.vpad),D=d(c.vpadminus||c.vpad);if(!z){if(r=1/0,s=-1/0,y)for(f=0;f<v;f++)(i=b[f])<r&&i>0&&(r=i),i>s&&i<o&&(s=i);else for(f=0;f<v;f++)(i=b[f])<r&&i>-o&&(r=i),i>s&&i<o&&(s=i);b=[r,s],v=2}var E={tozero:x,extrapad:w},F=Math.min(6,v);for(f=0;f<F;f++)e(f);for(f=v-1;f>=F;f--)e(f);return{min:t,max:u,opts:c}},concatExtremes:f}},{"../../constants/numerical":695,"../../lib":719,"../../registry":848,"fast-isnumeric":226}],767:[function(a,b,c){"use strict";function d(a){return+a}function e(a){return String(a)}function f(a,b,c){return b*z.roundUp(a/b,c)}function g(a){var b=a.dtick;if(a._tickexponent=0,w(b)||"string"==typeof b||(b=1),"category"!==a.type&&"multicategory"!==a.type||(a._tickround=null),"date"===a.type){var c=a.r2l(a.tick0),d=a.l2r(c).replace(/(^-|i)/g,""),e=d.length;if("M"===String(b).charAt(0))e>10||"01-01"!==d.substr(5)?a._tickround="d":a._tickround=+b.substr(1)%12==0?"y":"m";else if(b>=J&&e<=10||b>=15*J)a._tickround="d";else if(b>=L&&e<=16||b>=K)a._tickround="M";else if(b>=M&&e<=19||b>=L)a._tickround="S";else{var f=a.l2r(c+b).replace(/^-/,"").length;a._tickround=Math.max(e,f)-20,a._tickround<0&&(a._tickround=4)}}else if(w(b)||"L"===b.charAt(0)){var g=a.range.map(a.r2d||Number);w(b)||(b=Number(b.substr(1))),a._tickround=2-Math.floor(Math.log(b)/Math.LN10+.01);var h=Math.max(Math.abs(g[0]),Math.abs(g[1])),k=Math.floor(Math.log(h)/Math.LN10+.01);Math.abs(k)>3&&(i(a.exponentformat)&&!j(k)?a._tickexponent=3*Math.round((k-1)/3):a._tickexponent=k)}else a._tickround=null}function h(a,b,c){var d=a.tickfont||{};return{x:b,dx:0,dy:0,text:c||"",fontSize:d.size,font:d.family,fontColor:d.color}}function i(a){return"SI"===a||"B"===a}function j(a){return a>14||a<-15}function k(a,b,c,d){var e=a<0,f=b._tickround,h=c||b.exponentformat||"B",k=b._tickexponent,l=S.getTickFormat(b),m=b.separatethousands;if(d){var n={exponentformat:h,dtick:"none"===b.showexponent?b.dtick:w(a)&&Math.abs(a)||1,range:"none"===b.showexponent?b.range.map(b.r2d):[0,a||1]};g(n),f=(Number(n._tickround)||0)+4,k=n._tickexponent,b.hoverformat&&(l=b.hoverformat)}if(l)return b._numFormat(l)(a).replace(/-/g,N);var o,p=Math.pow(10,-f)/2;if("none"===h&&(k=0),(a=Math.abs(a))<p)a="0",e=!1;else{if(a+=p,k&&(a*=Math.pow(10,-k),f+=k),0===f)a=String(Math.floor(a));else if(f<0){a=(a=String(Math.round(a))).substr(0,a.length+f);for(var q=f;q<0;q++)a+="0"}else{var r=(a=String(a)).indexOf(".")+1;r&&(a=a.substr(0,r+f).replace(/\.?0+$/,""))}a=z.numSeparate(a,b._separators,m)}return k&&"hide"!==h&&(i(h)&&j(k)&&(h="power"),o=k<0?N+-k:"power"!==h?"+"+k:String(k),"e"===h||"E"===h?a+=h+o:"power"===h?a+="10<sup>"+o+"</sup>":"B"===h&&9===k?a+="B":i(h)&&(a+=ca[k/3+5])),e?N+a:a}function l(a){return[a.text,a.x,a.axInfo,a.font,a.fontSize,a.fontColor].join("_")}function m(a,b){var c=a.l2p(b);return c>1&&c<a._length-1}function n(a){var b=v.select(a),c=b.select(".text-math-group");return c.empty()?b.select("text"):c}function o(a){return a._id+".automargin"}function p(a){return o(a)+".mirror"}function q(a){return a._id+".rangeslider"}function r(a,b){for(var c=0;c<b.length;c++)-1===a.indexOf(b[c])&&a.push(b[c])}function s(a,b,c){var d,e,f=[],g=[],h=a.layout;for(d=0;d<b.length;d++)f.push(S.getFromId(a,b[d]));for(d=0;d<c.length;d++)g.push(S.getFromId(a,c[d]));var i=Object.keys(E),j=["anchor","domain","overlaying","position","side","tickangle","editType"],k=["linear","log"];for(d=0;d<i.length;d++){var l=i[d],m=f[0][l],n=g[0][l],o=!0,p=!1,q=!1;if("_"!==l.charAt(0)&&"function"!=typeof m&&-1===j.indexOf(l)){for(e=1;e<f.length&&o;e++){var r=f[e][l];"type"===l&&-1!==k.indexOf(m)&&-1!==k.indexOf(r)&&m!==r?p=!0:r!==m&&(o=!1)}for(e=1;e<g.length&&o;e++){var s=g[e][l];"type"===l&&-1!==k.indexOf(n)&&-1!==k.indexOf(s)&&n!==s?q=!0:g[e][l]!==n&&(o=!1)}o&&(p&&(h[f[0]._name].type="linear"),q&&(h[g[0]._name].type="linear"),t(h,l,f,g,a._fullLayout._dfltTitle))}}for(d=0;d<a._fullLayout.annotations.length;d++){var u=a._fullLayout.annotations[d];-1!==b.indexOf(u.xref)&&-1!==c.indexOf(u.yref)&&z.swapAttrs(h.annotations[d],["?"])}}function t(a,b,c,d,e){var f,g=z.nestedProperty,h=g(a[c[0]._name],b).get(),i=g(a[d[0]._name],b).get();for("title"===b&&(h&&h.text===e.x&&(h.text=e.y),i&&i.text===e.y&&(i.text=e.x)),f=0;f<c.length;f++)g(a,c[f]._name+"."+b).set(i);for(f=0;f<d.length;f++)g(a,d[f]._name+"."+b).set(h)}function u(a){return"angularaxis"===a._id}var v=a("d3"),w=a("fast-isnumeric"),x=a("../../plots/plots"),y=a("../../registry"),z=a("../../lib"),A=a("../../lib/svg_text_utils"),B=a("../../components/titles"),C=a("../../components/color"),D=a("../../components/drawing"),E=a("./layout_attributes"),F=a("./clean_ticks"),G=a("../../constants/numerical"),H=G.ONEAVGYEAR,I=G.ONEAVGMONTH,J=G.ONEDAY,K=G.ONEHOUR,L=G.ONEMIN,M=G.ONESEC,N=G.MINUS_SIGN,O=G.BADNUM,P=a("../../constants/alignment").MID_SHIFT,Q=a("../../constants/alignment").LINE_SPACING,R=a("../../constants/alignment").OPPOSITE_SIDE,S=b.exports={};S.setConvert=a("./set_convert");var T=a("./axis_autotype"),U=a("./axis_ids");S.id2name=U.id2name,S.name2id=U.name2id,S.cleanId=U.cleanId,S.list=U.list,S.listIds=U.listIds,S.getFromId=U.getFromId,S.getFromTrace=U.getFromTrace;var V=a("./autorange");S.getAutoRange=V.getAutoRange,S.findExtremes=V.findExtremes,S.coerceRef=function(a,b,c,d,e,f){var g=d.charAt(d.length-1),h=c._fullLayout._subplots[g+"axis"],i=d+"ref",j={};return e||(e=h[0]||f),f||(f=e),j[i]={valType:"enumerated",values:h.concat(f?[f]:[]),dflt:e},z.coerce(a,b,j,i)},S.coercePosition=function(a,b,c,d,e,f){var g,h;if("paper"===d||"pixel"===d)g=z.ensureNumber,h=c(e,f);else{var i=S.getFromId(b,d);h=c(e,f=i.fraction2r(f)),g=i.cleanPos}a[e]=g(h)},S.cleanPosition=function(a,b,c){return("paper"===c||"pixel"===c?z.ensureNumber:S.getFromId(b,c).cleanPos)(a)},S.redrawComponents=function(a,b){function c(c,e,f,g){for(var h=y.getComponentMethod(c,e),i={},j=0;j<b.length;j++)for(var k=d[S.id2name(b[j])][f],l=0;l<k.length;l++){var m=k[l];if(!i[m]&&(h(a,m),i[m]=1,g))return}}b=b||S.listIds(a);var d=a._fullLayout;c("annotations","drawOne","_annIndices"),c("shapes","drawOne","_shapeIndices"),c("images","draw","_imgIndices",!0)};var W=S.getDataConversions=function(a,b,c,f){var g,h="x"===c||"y"===c||"z"===c?c:f;if(Array.isArray(h)){if(g={type:T(f),_categories:[]},S.setConvert(g),"category"===g.type)for(var i=0;i<f.length;i++)g.d2c(f[i])}else g=S.getFromTrace(a,b,h);return g?{d2c:g.d2c,c2d:g.c2d}:"ids"===h?{d2c:e,c2d:e}:{d2c:d,c2d:d}};S.getDataToCoordFunc=function(a,b,c,d){return W(a,b,c,d).d2c},S.counterLetter=function(a){var b=a.charAt(0);return"x"===b?"y":"y"===b?"x":void 0},S.minDtick=function(a,b,c,d){-1===["log","category","multicategory"].indexOf(a.type)&&d?void 0===a._minDtick?(a._minDtick=b,a._forceTick0=c):a._minDtick&&((a._minDtick/b+1e-6)%1<2e-6&&((c-a._forceTick0)/b%1+1.000001)%1<2e-6?(a._minDtick=b,a._forceTick0=c):((b/a._minDtick+1e-6)%1>2e-6||((c-a._forceTick0)/a._minDtick%1+1.000001)%1>2e-6)&&(a._minDtick=0)):a._minDtick=0},S.saveRangeInitial=function(a,b){for(var c=S.list(a,"",!0),d=!1,e=0;e<c.length;e++){var f=c[e],g=void 0===f._rangeInitial,h=g||!(f.range[0]===f._rangeInitial[0]&&f.range[1]===f._rangeInitial[1]);(g&&!1===f.autorange||b&&h)&&(f._rangeInitial=f.range.slice(),d=!0)}return d},S.saveShowSpikeInitial=function(a,b){for(var c=S.list(a,"",!0),d=!1,e="on",f=0;f<c.length;f++){var g=c[f],h=void 0===g._showSpikeInitial,i=h||!(g.showspikes===g._showspikes);(h||b&&i)&&(g._showSpikeInitial=g.showspikes,d=!0),"on"!==e||g.showspikes||(e="off")}return a._fullLayout._cartesianSpikesEnabled=e,d},S.autoBin=function(a,b,c,d,e,f){var g,h=z.aggNums(Math.min,null,a),i=z.aggNums(Math.max,null,a);if("category"===b.type||"multicategory"===b.type)return{start:h-.5,end:i+.5,size:Math.max(1,Math.round(f)||1),_dataSpan:i-h};if(e||(e=b.calendar),g="log"===b.type?{type:"linear",range:[h,i]}:{type:b.type,range:z.simpleMap([h,i],b.c2r,0,e),calendar:e},S.setConvert(g),f=f&&F.dtick(f,g.type))g.dtick=f,g.tick0=F.tick0(void 0,g.type,e);else{var j;if(c)j=(i-h)/c;else{var k=z.distinctVals(a),l=Math.pow(10,Math.floor(Math.log(k.minDiff)/Math.LN10)),m=l*z.roundUp(k.minDiff/l,[.9,1.9,4.9,9.9],!0);j=Math.max(m,2*z.stdev(a)/Math.pow(a.length,d?.25:.4)),w(j)||(j=1)}S.autoTicks(g,j)}var n,o=g.dtick,p=S.tickIncrement(S.tickFirst(g),o,"reverse",e);if("number"==typeof o)n=(p=function(a,b,c,d,e){function f(b){return(1+100*(b-a)/c.dtick)%100<2}for(var g=0,h=0,i=0,j=0,k=0;k<b.length;k++)b[k]%1==0?i++:w(b[k])||j++,f(b[k])&&g++,f(b[k]+c.dtick/2)&&h++;var l=b.length-j;if(i===l&&"date"!==c.type)c.dtick<1?a=d-.5*c.dtick:(a-=.5)+c.dtick<d&&(a+=c.dtick);else if(h<.1*l&&(g>.3*l||f(d)||f(e))){var m=c.dtick/2;a+=a+m<d?m:-m}return a}(p,a,g,h,i))+(1+Math.floor((i-p)/o))*o;else for("M"===g.dtick.charAt(0)&&(p=function(a,b,c,d,e){var f=z.findExactDates(b,e);if(f.exactDays>.8){var g=Number(c.substr(1));f.exactYears>.8&&g%12==0?a=S.tickIncrement(a,"M6","reverse")+1.5*J:f.exactMonths>.8?a=S.tickIncrement(a,"M1","reverse")+15.5*J:a-=J/2;var h=S.tickIncrement(a,c);if(h<=d)return h}return a}(p,a,o,h,e)),n=p,0;n<=i;)n=S.tickIncrement(n,o,!1,e);return{start:b.c2r(p,0,e),end:b.c2r(n,0,e),size:o,_dataSpan:i-h}},S.prepTicks=function(a){var b=z.simpleMap(a.range,a.r2l);if("auto"===a.tickmode||!a.dtick){var c,d=a.nticks;d||("category"===a.type||"multicategory"===a.type?(c=a.tickfont?1.2*(a.tickfont.size||12):15,d=a._length/c):(c="y"===a._id.charAt(0)?40:80,d=z.constrain(a._length/c,4,9)+1),"radialaxis"===a._name&&(d*=2)),"array"===a.tickmode&&(d*=100),S.autoTicks(a,Math.abs(b[1]-b[0])/d),a._minDtick>0&&a.dtick<2*a._minDtick&&(a.dtick=a._minDtick,a.tick0=a.l2r(a._forceTick0))}a.tick0||(a.tick0="date"===a.type?"2000-01-01":0),"date"===a.type&&a.dtick<.1&&(a.dtick=.1),g(a)},S.calcTicks=function(a){S.prepTicks(a);var b=z.simpleMap(a.range,a.r2l);if("array"===a.tickmode)return function(a){var b=a.tickvals,c=a.ticktext,d=new Array(b.length),e=z.simpleMap(a.range,a.r2l),f=1.0001*e[0]-1e-4*e[1],g=1.0001*e[1]-1e-4*e[0],i=Math.min(f,g),j=Math.max(f,g),k=0;Array.isArray(c)||(c=[]);var l="category"===a.type?a.d2l_noadd:a.d2l;"log"===a.type&&"L"!==String(a.dtick).charAt(0)&&(a.dtick="L"+Math.pow(10,Math.floor(Math.min(a.range[0],a.range[1]))-1));for(var m=0;m<b.length;m++){var n=l(b[m]);n>i&&n<j&&(void 0===c[m]?d[k]=S.tickText(a,n):d[k]=h(a,n,String(c[m])),k++)}return k<b.length&&d.splice(k,b.length-k),d}(a);a._tmin=S.tickFirst(a);var c=1.0001*b[0]-1e-4*b[1],d=1.0001*b[1]-1e-4*b[0],e=b[1]<b[0];if(a._tmin<c!==e)return[];var f=[];"category"!==a.type&&"multicategory"!==a.type||(d=e?Math.max(-.5,d):Math.min(a._categories.length-.5,d));for(var g="log"===a.type&&!(w(a.dtick)||"L"===a.dtick.charAt(0)),i=null,j=Math.max(1e3,a._length||0),k=a._tmin;(e?k>=d:k<=d)&&!(f.length>j||k===i);k=S.tickIncrement(k,a.dtick,e,a.calendar)){i=k;var l=!1;g&&k!==(0|k)&&(l=!0),f.push({minor:l,value:k})}u(a)&&360===Math.abs(b[1]-b[0])&&f.pop(),a._tmax=(f[f.length-1]||{}).value,a._prevDateHead="",a._inCalcTicks=!0;for(var m=new Array(f.length),n=0;n<f.length;n++)m[n]=S.tickText(a,f[n].value,!1,f[n].minor);return a._inCalcTicks=!1,m};var X=[2,5,10],Y=[1,2,3,6,12],Z=[1,2,5,10,15,30],$=[1,2,3,7,14],_=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],aa=[-.301,0,.301,.699,1],ba=[15,30,45,90,180];S.autoTicks=function(a,b){function c(a){return Math.pow(a,Math.floor(Math.log(b)/Math.LN10))}var d;if("date"===a.type){a.tick0=z.dateTick0(a.calendar);var e=2*b;e>H?(b/=H,d=c(10),a.dtick="M"+12*f(b,d,X)):e>I?(b/=I,a.dtick="M"+f(b,1,Y)):e>J?(a.dtick=f(b,J,$),a.tick0=z.dateTick0(a.calendar,!0)):e>K?a.dtick=f(b,K,Y):e>L?a.dtick=f(b,L,Z):e>M?a.dtick=f(b,M,Z):(d=c(10),a.dtick=f(b,d,X))}else if("log"===a.type){a.tick0=0;var g=z.simpleMap(a.range,a.r2l);if(b>.7)a.dtick=Math.ceil(b);else if(Math.abs(g[1]-g[0])<1){var h=1.5*Math.abs((g[1]-g[0])/b);b=Math.abs(Math.pow(10,g[1])-Math.pow(10,g[0]))/h,d=c(10),a.dtick="L"+f(b,d,X)}else a.dtick=b>.3?"D2":"D1"}else"category"===a.type||"multicategory"===a.type?(a.tick0=0,a.dtick=Math.ceil(Math.max(b,1))):u(a)?(a.tick0=0,d=1,a.dtick=f(b,d,ba)):(a.tick0=0,d=c(10),a.dtick=f(b,d,X));if(0===a.dtick&&(a.dtick=1),!w(a.dtick)&&"string"!=typeof a.dtick){var i=a.dtick;throw a.dtick=1,"ax.dtick error: "+String(i)}},S.tickIncrement=function(a,b,c,d){var e=c?-1:1;if(w(b))return a+e*b;var f=b.charAt(0),g=e*Number(b.substr(1));if("M"===f)return z.incrementMonth(a,g,d);if("L"===f)return Math.log(Math.pow(10,a)+g)/Math.LN10;if("D"===f){var h="D2"===b?aa:_,i=a+.01*e,j=z.roundUp(z.mod(i,1),h,c);return Math.floor(i)+Math.log(v.round(Math.pow(10,j),1))/Math.LN10}throw"unrecognized dtick "+String(b)},S.tickFirst=function(a){var b=a.r2l||Number,c=z.simpleMap(a.range,b),d=c[1]<c[0],e=d?Math.floor:Math.ceil,f=1.0001*c[0]-1e-4*c[1],g=a.dtick,h=b(a.tick0);if(w(g)){var i=e((f-h)/g)*g+h;return"category"!==a.type&&"multicategory"!==a.type||(i=z.constrain(i,0,a._categories.length-1)),i}var j=g.charAt(0),k=Number(g.substr(1));if("M"===j){for(var l,m,n,o=0,p=h;o<10;){if(((l=S.tickIncrement(p,g,d,a.calendar))-f)*(p-f)<=0)return d?Math.min(p,l):Math.max(p,l);m=(f-(p+l)/2)/(l-p),n=j+(Math.abs(Math.round(m))||1)*k,p=S.tickIncrement(p,n,m<0?!d:d,a.calendar),o++}return z.error("tickFirst did not converge",a),p}if("L"===j)return Math.log(e((Math.pow(10,f)-h)/k)*k+h)/Math.LN10;if("D"===j){var q="D2"===g?aa:_,r=z.roundUp(z.mod(f,1),q,d);return Math.floor(f)+Math.log(v.round(Math.pow(10,r),1))/Math.LN10}throw"unrecognized dtick "+String(g)},S.tickText=function(a,b,c,d){function e(d){if(void 0===d)return!0;if(c)return"none"===d;var e={first:a._tmin,last:a._tmax}[d];return"all"!==d&&b!==e}var f,g=h(a,b),l="array"===a.tickmode,m=c||l,n=a.type,o="category"===n?a.d2l_noadd:a.d2l;if(l&&Array.isArray(a.ticktext)){var p=z.simpleMap(a.range,a.r2l),q=Math.abs(p[1]-p[0])/1e4;for(f=0;f<a.ticktext.length&&!(Math.abs(b-o(a.tickvals[f]))<q);f++);if(f<a.ticktext.length)return g.text=String(a.ticktext[f]),g}var r=c?"never":"none"!==a.exponentformat&&e(a.showexponent)?"hide":"";if("date"===n?function(a,b,c,d){var e=a._tickround,f=c&&a.hoverformat||S.getTickFormat(a);d&&(e=w(e)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[e]);var g,h=z.formatDate(b.x,f,e,a._dateFormat,a.calendar,a._extraFormat),i=h.indexOf("\n");-1!==i&&(g=h.substr(i+1),h=h.substr(0,i)),d&&("00:00:00"===h||"00:00"===h?(h=g,g=""):8===h.length&&(h=h.replace(/:00$/,""))),g&&(c?"d"===e?h+=", "+g:h=g+(h?", "+h:""):a._inCalcTicks&&g===a._prevDateHead||(h+="<br>"+g,a._prevDateHead=g)),b.text=h}(a,g,c,m):"log"===n?function(a,b,c,d,e){var f=a.dtick,g=b.x,h=a.tickformat,l="string"==typeof f&&f.charAt(0);if("never"===e&&(e=""),d&&"L"!==l&&(f="L3",l="L"),h||"L"===l)b.text=k(Math.pow(10,g),a,e,d);else if(w(f)||"D"===l&&z.mod(g+.01,1)<.1){var m=Math.round(g),n=Math.abs(m),o=a.exponentformat;"power"===o||i(o)&&j(m)?(b.text=0===m?1:1===m?"10":"10<sup>"+(m>1?"":N)+n+"</sup>",b.fontSize*=1.25):("e"===o||"E"===o)&&n>2?b.text="1"+o+(m>0?"+":N)+n:(b.text=k(Math.pow(10,g),a,"","fakehover"),"D1"===f&&"y"===a._id.charAt(0)&&(b.dy-=b.fontSize/6))}else{if("D"!==l)throw"unrecognized dtick "+String(f);b.text=String(Math.round(Math.pow(10,z.mod(g,1)))),b.fontSize*=.75}if("D1"===a.dtick){var p=String(b.text).charAt(0);"0"!==p&&"1"!==p||("y"===a._id.charAt(0)?b.dx-=b.fontSize/4:(b.dy+=b.fontSize/2,b.dx+=(a.range[1]>a.range[0]?1:-1)*b.fontSize*(g<0?.5:.25)))}}(a,g,0,m,r):"category"===n?function(a,b){var c=a._categories[Math.round(b.x)];void 0===c&&(c=""),b.text=String(c)}(a,g):"multicategory"===n?function(a,b,c){var d=Math.round(b.x),e=a._categories[d]||[],f=void 0===e[1]?"":String(e[1]),g=void 0===e[0]?"":String(e[0]);c?b.text=g+" - "+f:(b.text=f,b.text2=g)}(a,g,c):u(a)?function(a,b,c,d,e){if("radians"!==a.thetaunit||c)b.text=k(b.x,a,e,d);else{var f=b.x/180;if(0===f)b.text="0";else{var g=function(a){function b(a,b){return Math.abs(a-b)<=1e-6}var c=function(a){for(var c=1;!b(Math.round(a*c)/c,a);)c*=10;return c}(a),d=a*c,e=Math.abs(function a(c,d){return b(d,0)?c:a(d,c%d)}(d,c));return[Math.round(d/e),Math.round(c/e)]}(f);if(g[1]>=100)b.text=k(z.deg2rad(b.x),a,e,d);else{var h=b.x<0;1===g[1]?1===g[0]?b.text="":b.text=g[0]+"":b.text=["<sup>",g[0],"</sup>","","<sub>",g[1],"</sub>",""].join(""),h&&(b.text=N+b.text)}}}}(a,g,c,m,r):function(a,b,c,d,e){"never"===e?e="":"all"===a.showexponent&&Math.abs(b.x/a.dtick)<1e-6&&(e="hide"),b.text=k(b.x,a,e,d)}(a,g,0,m,r),d||(a.tickprefix&&!e(a.showtickprefix)&&(g.text=a.tickprefix+g.text),a.ticksuffix&&!e(a.showticksuffix)&&(g.text+=a.ticksuffix)),"boundaries"===a.tickson||a.showdividers){var s=function(b){var c=a.l2p(b);return c>=0&&c<=a._length?b:null};g.xbnd=[s(g.x-.5),s(g.x+a.dtick-.5)]}return g},S.hoverLabelText=function(a,b,c){if(c!==O&&c!==b)return S.hoverLabelText(a,b)+" - "+S.hoverLabelText(a,c);var d="log"===a.type&&b<=0,e=S.tickText(a,a.c2l(d?-b:b),"hover").text;return d?0===b?"0":N+e:e};var ca=["f","p","n","","m","","k","M","G","T"];S.getTickFormat=function(a){function b(a){return"string"!=typeof a?a:Number(a.replace("M",""))*I}function c(a,b){var c=["L","D"];if(typeof a==typeof b){if("number"==typeof a)return a-b;var d=c.indexOf(a.charAt(0)),e=c.indexOf(b.charAt(0))
;return d===e?Number(a.replace(/(L|D)/g,""))-Number(b.replace(/(L|D)/g,"")):d-e}return"number"==typeof a?1:-1}var d,e,f,g,h,i,j,k;if(a.tickformatstops&&a.tickformatstops.length>0)switch(a.type){case"date":case"linear":for(d=0;d<a.tickformatstops.length;d++)if((f=a.tickformatstops[d]).enabled&&(g=a.dtick,h=f.dtickrange,i=void 0,i=b||function(a){return a},j=h[0],k=h[1],(!j&&"number"!=typeof j||i(j)<=i(g))&&(!k&&"number"!=typeof k||i(k)>=i(g)))){e=f;break}break;case"log":for(d=0;d<a.tickformatstops.length;d++)if((f=a.tickformatstops[d]).enabled&&function(a,b){var d=null===b[0],e=null===b[1],f=c(a,b[0])>=0,g=c(a,b[1])<=0;return(d||f)&&(e||g)}(a.dtick,f.dtickrange)){e=f;break}}return e?e.value:a.tickformat},S.getSubplots=function(a,b){var c=a._fullLayout._subplots,d=c.cartesian.concat(c.gl2d||[]),e=b?S.findSubplotsWithAxis(d,b):d;return e.sort(function(a,b){var c=a.substr(1).split("y"),d=b.substr(1).split("y");return c[0]===d[0]?+c[1]-+d[1]:+c[0]-+d[0]}),e},S.findSubplotsWithAxis=function(a,b){for(var c=new RegExp("x"===b._id.charAt(0)?"^"+b._id+"y":b._id+"$"),d=[],e=0;e<a.length;e++){var f=a[e];c.test(f)&&d.push(f)}return d},S.makeClipPaths=function(a){var b=a._fullLayout;if(!b._hasOnlyLargeSploms){var c,d,e={_offset:0,_length:b.width,_id:""},f={_offset:0,_length:b.height,_id:""},g=S.list(a,"x",!0),h=S.list(a,"y",!0),i=[];for(c=0;c<g.length;c++)for(i.push({x:g[c],y:f}),d=0;d<h.length;d++)0===c&&i.push({x:e,y:h[d]}),i.push({x:g[c],y:h[d]});var j=b._clips.selectAll(".axesclip").data(i,function(a){return a.x._id+a.y._id});j.enter().append("clipPath").classed("axesclip",!0).attr("id",function(a){return"clip"+b._uid+a.x._id+a.y._id}).append("rect"),j.exit().remove(),j.each(function(a){v.select(this).select("rect").attr({x:a.x._offset||0,y:a.y._offset||0,width:a.x._length||1,height:a.y._length||1})})}},S.draw=function(a,b,c){var d=a._fullLayout;"redraw"===b&&d._paper.selectAll("g.subplot").each(function(a){var b=a[0],c=d._plots[b],e=c.xaxis,f=c.yaxis;c.xaxislayer.selectAll("."+e._id+"tick").remove(),c.yaxislayer.selectAll("."+f._id+"tick").remove(),c.xaxislayer.selectAll("."+e._id+"tick2").remove(),c.yaxislayer.selectAll("."+f._id+"tick2").remove(),c.xaxislayer.selectAll("."+e._id+"divider").remove(),c.yaxislayer.selectAll("."+f._id+"divider").remove(),c.gridlayer&&c.gridlayer.selectAll("path").remove(),c.zerolinelayer&&c.zerolinelayer.selectAll("path").remove(),d._infolayer.select(".g-"+e._id+"title").remove(),d._infolayer.select(".g-"+f._id+"title").remove()});var e=b&&"redraw"!==b?b:S.listIds(a);return z.syncOrAsync(e.map(function(b){return function(){if(b){var d=S.getFromId(a,b),e=S.drawOne(a,d,c);return d._r=d.range.slice(),d._rl=z.simpleMap(d._r,d.r2l),e}}}))},S.drawOne=function(a,b,c){function d(a){var c=j+(a||"tick");return w[c]||(w[c]=function(a,b){var c,d,e,f;return a._selections[b].size()?(c=1/0,d=-1/0,e=1/0,f=-1/0,a._selections[b].each(function(){var a=n(this),b=D.bBox(a.node().parentNode);c=Math.min(c,b.top),d=Math.max(d,b.bottom),e=Math.min(e,b.left),f=Math.max(f,b.right)})):(c=0,d=0,e=0,f=0),{top:c,bottom:d,left:e,right:f,height:d-c,width:f-e}}(b,c)),w[c]}var e,f,g;c=c||{},b.setScale();var i=a._fullLayout,j=b._id,k=j.charAt(0),m=S.counterLetter(j),r=b._mainLinePosition,s=b._mainMirrorPosition,t=i._plots[b._mainSubplot][k+"axislayer"],u=b._vals=S.calcTicks(b),v=[b.mirror,r,s].join("_");for(e=0;e<u.length;e++)u[e].axInfo=v;b._selections={},b._tickAngles&&(b._prevTickAngles=b._tickAngles),b._tickAngles={},b._depth=null;var w={};if(b.visible){var E,F,G=S.makeTransFn(b);if("boundaries"===b.tickson){var H=function(a,b){var c,d=[],e=function(a,b){var c=a.xbnd[b];null!==c&&d.push(z.extendFlat({},a,{x:c}))};if(b.length){for(c=0;c<b.length;c++)e(b[c],0);e(b[c-1],1)}return d}(0,u);F=S.clipEnds(b,H),E="inside"===b.ticks?F:H}else F=S.clipEnds(b,u),E="inside"===b.ticks?F:u;var I=b._gridVals=F,J=function(a,b){var c,d,e=[],f=function(a,b){var c=a.xbnd[b];null!==c&&e.push(z.extendFlat({},a,{x:c}))};if(a.showdividers&&b.length){for(c=0;c<b.length;c++){var g=b[c];g.text2!==d&&f(g,0),d=g.text2}f(b[c-1],1)}return e}(b,u);if(!i._hasOnlyLargeSploms){var K=b._subplotsWith,L={};for(e=0;e<K.length;e++){f=K[e];var M=(g=i._plots[f])[m+"axis"],N=M._mainAxis._id;if(!L[N]){L[N]=1;var O="x"===k?"M0,"+M._offset+"v"+M._length:"M"+M._offset+",0h"+M._length;S.drawGrid(a,b,{vals:I,counterAxis:M,layer:g.gridlayer.select("."+j),path:O,transFn:G}),S.drawZeroLine(a,b,{counterAxis:M,layer:g.zerolinelayer,path:O,transFn:G})}}}var P=S.getTickSigns(b),T=[];if(b.ticks){var U,V,W,X=S.makeTickPath(b,r,P[2]);if(b._anchorAxis&&b.mirror&&!0!==b.mirror?(U=S.makeTickPath(b,s,P[3]),V=X+U):(U="",V=X),b.showdividers&&"outside"===b.ticks&&"boundaries"===b.tickson){var Y={};for(e=0;e<J.length;e++)Y[J[e].x]=1;W=function(a){return Y[a.x]?U:V}}else W=V;S.drawTicks(a,b,{vals:E,layer:t,path:W,transFn:G}),"allticks"===b.mirror&&(T=Object.keys(b._linepositions||{}))}for(e=0;e<T.length;e++){f=T[e],g=i._plots[f];var Z=b._linepositions[f]||[],$=S.makeTickPath(b,Z[0],P[0])+S.makeTickPath(b,Z[1],P[1]);S.drawTicks(a,b,{vals:E,layer:g[k+"axislayer"],path:$,transFn:G})}var _=[];if(_.push(function(){return S.drawLabels(a,b,{vals:u,layer:t,transFn:G,labelFns:S.makeLabelFns(b,r)})}),"multicategory"===b.type){var aa={x:2,y:10}[k],ba={l:-1,t:-1,r:1,b:1}[b.side.charAt(0)];_.push(function(){var c={x:"height",y:"width"}[k],e=d()[c]+aa+(b._tickAngles[j+"tick"]?b.tickfont.size*Q:0);return S.drawLabels(a,b,{vals:function(a,b){for(var c=[],d={},e=0;e<b.length;e++){var f=b[e];d[f.text2]?d[f.text2].push(f.x):d[f.text2]=[f.x]}for(var g in d)c.push(h(a,z.interp(d[g],.5),g));return c}(b,u),layer:t,cls:j+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:G,labelFns:S.makeLabelFns(b,r+e*ba)})}),_.push(function(){return b._depth=ba*(d("tick2")[b.side]-r),function(a,b,c){var d=b._id+"divider",e=c.vals,f=c.layer.selectAll("path."+d).data(e,l);f.exit().remove(),f.enter().insert("path",":first-child").classed(d,1).classed("crisp",1).call(C.stroke,b.dividercolor).style("stroke-width",D.crispRound(a,b.dividerwidth,1)+"px"),f.attr("transform",c.transFn).attr("d",c.path)}(a,b,{vals:J,layer:t,path:S.makeTickPath(b,r,ba,b._depth),transFn:G})})}var ca=y.getComponentMethod("rangeslider","isVisible")(b);return _.push(function(){var c,e,f,g,h=b.side.charAt(0),j=R[b.side].charAt(0),l=S.getPxPosition(a,b),n="outside"===b.ticks?b.ticklen:0;if((b.automargin||ca)&&("multicategory"===b.type?c=d("tick2"):(c=d(),"x"===k&&"b"===h&&(b._depth=Math.max(c.width>0?c.bottom-l:0,n)))),b.automargin){e={x:0,y:0,r:0,l:0,t:0,b:0};var r=[0,1];if("x"===k){if("b"===h?e[h]=b._depth:(e[h]=b._depth=Math.max(c.width>0?l-c.top:0,n),r.reverse()),c.width>0){var s=c.right-(b._offset+b._length);s>0&&(e.xr=1,e.r=s);var t=b._offset-c.left;t>0&&(e.xl=0,e.l=t)}}else if("l"===h?e[h]=b._depth=Math.max(c.height>0?l-c.left:0,n):(e[h]=b._depth=Math.max(c.height>0?c.right-l:0,n),r.reverse()),c.height>0){var u=c.bottom-(b._offset+b._length);u>0&&(e.yb=0,e.b=u);var v=b._offset-c.top;v>0&&(e.yt=1,e.t=v)}if(e[m]="free"===b.anchor?b.position:b._anchorAxis.domain[r[0]],b.title.text!==i._dfltTitle[k]){var w=(b.title.text.match(A.BR_TAG_ALL)||[]).length;e[h]+=w?b.title.font.size*(w+1)*Q:b.title.font.size}b.mirror&&((f={x:0,y:0,r:0,l:0,t:0,b:0})[j]=b.linewidth,b.mirror&&!0!==b.mirror&&(f[j]+=n),!0===b.mirror||"ticks"===b.mirror?f[m]=b._anchorAxis.domain[r[1]]:"all"!==b.mirror&&"allticks"!==b.mirror||(f[m]=[b._counterDomainMin,b._counterDomainMax][r[1]]))}ca&&(g=y.getComponentMethod("rangeslider","autoMarginOpts")(a,b)),x.autoMargin(a,o(b),e),x.autoMargin(a,p(b),f),x.autoMargin(a,q(b),g)}),c.skipTitle||ca&&"bottom"===b.side||_.push(function(){return function(a,b){var c,d=a._fullLayout,e=b._id,f=e.charAt(0),g=b.title.font.size;c="multicategory"===b.type?b._depth:10+1.5*g+(b.linewidth?b.linewidth-1:0);var h,i,j,k,l=S.getPxPosition(a,b);if("x"===f?(i=b._offset+b._length/2,j="top"===b.side?-c-g*(b.showticklabels?1:0):c+g*(b.showticklabels?1.5:.5),j+=l):(j=b._offset+b._length/2,i="right"===b.side?c+g*(b.showticklabels?1:.5):-c-g*(b.showticklabels?.5:0),i+=l,h={rotate:"-90",offset:0}),"multicategory"!==b.type){var m=b._selections[b._id+"tick"];if(k={selection:m,side:b.side},m&&m.node()&&m.node().parentNode){var n=D.getTranslate(m.node().parentNode);k.offsetLeft=n.x,k.offsetTop=n.y}}return B.draw(a,e+"title",{propContainer:b,propName:b._name+".title.text",placeholder:d._dfltTitle[f],avoid:k,transform:h,attributes:{x:i,y:j,"text-anchor":"middle"}})}(a,b)}),z.syncOrAsync(_)}},S.getTickSigns=function(a){var b=a._id.charAt(0),c={x:"top",y:"right"}[b],d=a.side===c?1:-1,e=[-1,1,d,-d];return"inside"!==a.ticks==("x"===b)&&(e=e.map(function(a){return-a})),e},S.makeTransFn=function(a){var b=a._id.charAt(0),c=a._offset;return"x"===b?function(b){return"translate("+(c+a.l2p(b.x))+",0)"}:function(b){return"translate(0,"+(c+a.l2p(b.x))+")"}},S.makeTickPath=function(a,b,c,d){d=void 0!==d?d:a.ticklen;var e=a._id.charAt(0),f=(a.linewidth||1)/2;return"x"===e?"M0,"+(b+f*c)+"v"+d*c:"M"+(b+f*c)+",0h"+d*c},S.makeLabelFns=function(a,b,c){var d=a._id.charAt(0),e="boundaries"!==a.tickson&&"outside"===a.ticks,f=0,g=0;if(e&&(f+=a.ticklen),c&&"outside"===a.ticks){var h=z.deg2rad(c);f=a.ticklen*Math.cos(h)+1,g=a.ticklen*Math.sin(h)}a.showticklabels&&(e||a.showline)&&(f+=.2*a.tickfont.size);var i,j,k,l,m={labelStandoff:f+=(a.linewidth||1)/2,labelShift:g};return"x"===d?(l="bottom"===a.side?1:-1,i=g*l,j=b+f*l,k="bottom"===a.side?1:-.2,m.xFn=function(a){return a.dx+i},m.yFn=function(a){return a.dy+j+a.fontSize*k},m.anchorFn=function(a,b){return w(b)&&0!==b&&180!==b?b*l<0?"end":"start":"middle"},m.heightFn=function(b,c,d){return c<-60||c>60?-.5*d:"top"===a.side?-d:0}):"y"===d&&(l="right"===a.side?1:-1,i=f,j=-g*l,k=90===Math.abs(a.tickangle)?.5:0,m.xFn=function(a){return a.dx+b+(i+a.fontSize*k)*l},m.yFn=function(a){return a.dy+j+a.fontSize*P},m.anchorFn=function(b,c){return w(c)&&90===Math.abs(c)?"middle":"right"===a.side?"start":"end"},m.heightFn=function(b,c,d){return(c*="left"===a.side?1:-1)<-30?-d:c<30?-.5*d:0}),m},S.drawTicks=function(a,b,c){c=c||{};var d=b._id+"tick",e=c.layer.selectAll("path."+d).data(b.ticks?c.vals:[],l);e.exit().remove(),e.enter().append("path").classed(d,1).classed("ticks",1).classed("crisp",!1!==c.crisp).call(C.stroke,b.tickcolor).style("stroke-width",D.crispRound(a,b.tickwidth,1)+"px").attr("d",c.path),e.attr("transform",c.transFn)},S.drawGrid=function(a,b,c){c=c||{};var d=b._id+"grid",e=c.vals,f=c.counterAxis;if(!1===b.showgrid)e=[];else if(f&&S.shouldShowZeroLine(a,b,f))for(var g="array"===b.tickmode,h=0;h<e.length;h++){var i=e[h].x;if(g?!i:Math.abs(i)<b.dtick/100){if(e=e.slice(0,h).concat(e.slice(h+1)),!g)break;h--}}var j=c.layer.selectAll("path."+d).data(e,l);j.exit().remove(),j.enter().append("path").classed(d,1).classed("crisp",!1!==c.crisp),b._gw=D.crispRound(a,b.gridwidth,1),j.attr("transform",c.transFn).attr("d",c.path).call(C.stroke,b.gridcolor||"#ddd").style("stroke-width",b._gw+"px"),"function"==typeof c.path&&j.attr("d",c.path)},S.drawZeroLine=function(a,b,c){c=c||c;var d=b._id+"zl",e=S.shouldShowZeroLine(a,b,c.counterAxis),f=c.layer.selectAll("path."+d).data(e?[{x:0,id:b._id}]:[]);f.exit().remove(),f.enter().append("path").classed(d,1).classed("zl",1).classed("crisp",!1!==c.crisp).each(function(){c.layer.selectAll("path").sort(function(a,b){return U.idSort(a.id,b.id)})}),f.attr("transform",c.transFn).attr("d",c.path).call(C.stroke,b.zerolinecolor||C.defaultLine).style("stroke-width",D.crispRound(a,b.zerolinewidth,b._gw||1)+"px")},S.drawLabels=function(a,b,c){function d(a,b){a.each(function(a){var d=v.select(this),e=d.select(".text-math-group"),f=j.anchorFn(a,b),g=c.transFn.call(d.node(),a)+(w(b)&&0!=+b?" rotate("+b+","+j.xFn(a)+","+(j.yFn(a)-a.fontSize/2)+")":""),h=A.lineCount(d),i=Q*a.fontSize,k=j.heightFn(a,w(b)?+b:0,(h-1)*i);if(k&&(g+=" translate(0, "+k+")"),e.empty())d.select("text").attr({transform:g,"text-anchor":f});else{var l=D.bBox(e.node()).width*{end:-.5,start:.5}[f];e.attr("transform",g+(l?"translate("+l+",0)":""))}})}c=c||{};var e=a._fullLayout,f=b._id,g=f.charAt(0),h=c.cls||f+"tick",i=c.vals,j=c.labelFns,k=c.secondary?0:b.tickangle,m=(b._prevTickAngles||{})[h],o=c.layer.selectAll("g."+h).data(b.showticklabels?i:[],l),p=[];o.enter().append("g").classed(h,1).append("text").attr("text-anchor","middle").each(function(b){var c=v.select(this),e=a._promises.length;c.call(A.positionText,j.xFn(b),j.yFn(b)).call(D.font,b.font,b.fontSize,b.fontColor).text(b.text).call(A.convertToTspans,a),a._promises[e]?p.push(a._promises.pop().then(function(){d(c,k)})):d(c,k)}),o.exit().remove(),c.repositionOnUpdate&&o.each(function(a){v.select(this).select("text").call(A.positionText,j.xFn(a),j.yFn(a))}),d(o,m+1?m:k);var q=null;b._selections&&(b._selections[h]=o);var r=[function(){return p.length&&Promise.all(p)}];b.automargin&&e._redrawFromAutoMarginCount&&90===m?(q=90,r.push(function(){d(o,m)})):r.push(function(){if(d(o,k),i.length&&"x"===g&&!w(k)&&("log"!==b.type||"D"!==String(b.dtick).charAt(0))){q=0;var a,e=0,f=[];if(o.each(function(a){e=Math.max(e,a.fontSize);var c=b.l2p(a.x),d=n(this),g=D.bBox(d.node());f.push({top:0,bottom:10,height:10,left:c-g.width/2,right:c+g.width/2+2,width:g.width+2})}),"boundaries"!==b.tickson&&!b.showdividers||c.secondary){var h=i.length,j=Math.abs((i[h-1].x-i[0].x)*b._m)/(h-1)<2.5*e||"multicategory"===b.type;for(a=0;a<f.length-1;a++)if(z.bBoxIntersect(f[a],f[a+1])){q=j?90:30;break}}else{var l=2;for(b.ticks&&(l+=b.tickwidth/2),a=0;a<f.length;a++){var m=i[a].xbnd,p=f[a];if(null!==m[0]&&p.left-b.l2p(m[0])<l||null!==m[1]&&b.l2p(m[1])-p.right<l){q=90;break}}}q&&d(o,q)}}),b._tickAngles&&r.push(function(){b._tickAngles[h]=null===q?w(k)?k:0:q});var s=z.syncOrAsync(r);return s&&s.then&&a._promises.push(s),s},S.getPxPosition=function(a,b){var c,d=a._fullLayout._size,e=b._id.charAt(0),f=b.side;return"free"!==b.anchor?c=b._anchorAxis:"x"===e?c={_offset:d.t+(1-(b.position||0))*d.h,_length:0}:"y"===e&&(c={_offset:d.l+(b.position||0)*d.w,_length:0}),"top"===f||"left"===f?c._offset:"bottom"===f||"right"===f?c._offset+c._length:void 0},S.shouldShowZeroLine=function(a,b,c){var d=z.simpleMap(b.range,b.r2l);return d[0]*d[1]<=0&&b.zeroline&&("linear"===b.type||"-"===b.type)&&(m(b,0)||!function(a,b,c,d){function e(a){function c(a){return"number"==typeof a&&Math.abs(a-j)<d}if(!a.showline||!a.linewidth)return!1;var d=Math.max((a.linewidth+b.zerolinewidth)/2,1);if(c(a._mainLinePosition)||c(a._mainMirrorPosition))return!0;var e=a._linepositions||{};for(var f in e)if(c(e[f][0])||c(e[f][1]))return!0}var f=c._mainAxis;if(f){var g=a._fullLayout,h=b._id.charAt(0),i=S.counterLetter(b._id),j=b._offset+(Math.abs(d[0])<Math.abs(d[1])==("x"===h)?0:b._length),k=g._plots[c._mainSubplot];if(!(k.mainplotinfo||k).overlays.length)return e(c);for(var l=S.list(a,i),m=0;m<l.length;m++){var n=l[m];if(n._mainAxis===f&&e(n))return!0}}}(a,b,c,d)||function(a,b){for(var c=a._fullData,d=b._mainSubplot,e=b._id.charAt(0),f=0;f<c.length;f++){var g=c[f];if(!0===g.visible&&g.xaxis+g.yaxis===d){if(y.traceIs(g,"bar-like")&&g.orientation==={x:"h",y:"v"}[e])return!0;if(g.fill&&g.fill.charAt(g.fill.length-1)===e)return!0}}return!1}(a,b))},S.clipEnds=function(a,b){return b.filter(function(b){return m(a,b.x)})},S.allowAutoMargin=function(a){for(var b=S.list(a,"",!0),c=0;c<b.length;c++){var d=b[c];d.automargin&&(x.allowAutoMargin(a,o(d)),d.mirror&&x.allowAutoMargin(a,p(d))),y.getComponentMethod("rangeslider","isVisible")(d)&&x.allowAutoMargin(a,q(d))}},S.swap=function(a,b){for(var c=function(a,b){var c,d,e=[];for(c=0;c<b.length;c++){var f=[],g=a._fullData[b[c]].xaxis,h=a._fullData[b[c]].yaxis;if(g&&h){for(d=0;d<e.length;d++)-1===e[d].x.indexOf(g)&&-1===e[d].y.indexOf(h)||f.push(d);if(f.length){var i,j=e[f[0]];if(f.length>1)for(d=1;d<f.length;d++)i=e[f[d]],r(j.x,i.x),r(j.y,i.y);r(j.x,[g]),r(j.y,[h])}else e.push({x:[g],y:[h]})}}return e}(a,b),d=0;d<c.length;d++)s(a,c[d].x,c[d].y)}},{"../../components/color":594,"../../components/drawing":615,"../../components/titles":681,"../../constants/alignment":688,"../../constants/numerical":695,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/plots":828,"../../registry":848,"./autorange":766,"./axis_autotype":768,"./axis_ids":770,"./clean_ticks":772,"./layout_attributes":779,"./set_convert":785,d3:164,"fast-isnumeric":226}],768:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib"),f=a("../../constants/numerical").BADNUM;b.exports=function(a,b,c){return!(c=c||{}).noMultiCategory&&(g=a,e.isArrayOrTypedArray(g[0])&&e.isArrayOrTypedArray(g[1]))?"multicategory":function(a,b){for(var c=Math.max(1,(a.length-1)/1e3),f=0,g=0,h={},i=0;i<a.length;i+=c){var j=a[Math.round(i)],k=String(j);h[k]||(h[k]=1,e.isDateTime(j,b)&&(f+=1),d(j)&&(g+=1))}return f>2*g}(a,b)?"date":function(a){for(var b=Math.max(1,(a.length-1)/1e3),c=0,d=0,g={},h=0;h<a.length;h+=b){var i=a[Math.round(h)],j=String(i);g[j]||(g[j]=1,"boolean"==typeof i?d++:e.cleanNumber(i)!==f?c++:"string"==typeof i&&d++)}return d>2*c}(a)?"category":function(a){if(!a)return!1;for(var b=0;b<a.length;b++)if(d(a[b]))return!0;return!1}(a)?"linear":"-";var g}},{"../../constants/numerical":695,"../../lib":719,"fast-isnumeric":226}],769:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("./layout_attributes"),g=a("./tick_value_defaults"),h=a("./tick_mark_defaults"),i=a("./tick_label_defaults"),j=a("./category_order_defaults"),k=a("./line_grid_defaults"),l=a("./set_convert");b.exports=function(a,b,c,m,n){var o=m.letter,p=m.font||{},q=m.splomStash||{},r=c("visible",!m.visibleDflt),s=b.type;"date"===s&&d.getComponentMethod("calendars","handleDefaults")(a,b,"calendar",m.calendar),l(b,n);var t=!b.isValidRange(a.range);t&&m.reverseDflt&&(t="reversed"),!c("autorange",t)||"linear"!==s&&"-"!==s||c("rangemode"),c("range"),b.cleanRange(),j(a,b,c,m),"category"===s||m.noHover||c("hoverformat");var u=c("color"),v=u!==f.color.dflt?u:p.color,w=q.label||n._dfltTitle[o];if(i(a,b,c,s,m,{pass:1}),!r)return b;c("title.text",w),e.coerceFont(c,"title.font",{family:p.family,size:Math.round(1.2*p.size),color:v}),g(a,b,c,s),i(a,b,c,s,m,{pass:2}),h(a,b,c,m),k(a,b,c,{dfltColor:u,bgColor:m.bgColor,showGrid:m.showGrid,attributes:f}),(b.showline||b.ticks)&&c("mirror"),m.automargin&&c("automargin");var x,y="multicategory"===b.type;return m.noTickson||"category"!==b.type&&!y||!b.ticks&&!b.showgrid||(y&&(x="boundaries"),c("tickson",x)),y&&c("showdividers")&&(c("dividercolor"),c("dividerwidth")),b}},{"../../lib":719,"../../registry":848,"./category_order_defaults":771,"./layout_attributes":779,"./line_grid_defaults":781,"./set_convert":785,"./tick_label_defaults":786,"./tick_mark_defaults":787,"./tick_value_defaults":788}],770:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("./constants");c.id2name=function(a){if("string"==typeof a&&a.match(e.AX_ID_PATTERN)){var b=a.substr(1);return"1"===b&&(b=""),a.charAt(0)+"axis"+b}},c.name2id=function(a){if(a.match(e.AX_NAME_PATTERN)){var b=a.substr(5);return"1"===b&&(b=""),a.charAt(0)+b}},c.cleanId=function(a,b){if(a.match(e.AX_ID_PATTERN)&&(!b||a.charAt(0)===b)){var c=a.substr(1).replace(/^0+/,"");return"1"===c&&(c=""),a.charAt(0)+c}},c.list=function(a,b,d){var e=a._fullLayout;if(!e)return[];var f,g=c.listIds(a,b),h=new Array(g.length);for(f=0;f<g.length;f++){var i=g[f];h[f]=e[i.charAt(0)+"axis"+i.substr(1)]}if(!d){var j=e._subplots.gl3d||[];for(f=0;f<j.length;f++){var k=e[j[f]];b?h.push(k[b+"axis"]):h.push(k.xaxis,k.yaxis,k.zaxis)}}return h},c.listIds=function(a,b){var c=a._fullLayout;if(!c)return[];var d=c._subplots;return b?d[b+"axis"]:d.xaxis.concat(d.yaxis)},c.getFromId=function(a,b,d){var e=a._fullLayout;return"x"===d?b=b.replace(/y[0-9]*/,""):"y"===d&&(b=b.replace(/x[0-9]*/,"")),e[c.id2name(b)]},c.getFromTrace=function(a,b,e){var f=a._fullLayout,g=null;if(d.traceIs(b,"gl3d")){var h=b.scene;"scene"===h.substr(0,5)&&(g=f[h][e+"axis"])}else g=c.getFromId(a,b[e+"axis"]||e);return g},c.idSort=function(a,b){var c=a.charAt(0),d=b.charAt(0);return c!==d?c>d?1:-1:+(a.substr(1)||1)-+(b.substr(1)||1)},c.getAxisGroup=function(a,b){for(var c=a._axisMatchGroups,d=0;d<c.length;d++)if(c[d][b])return"g"+d;return b}},{"../../registry":848,"./constants":773}],771:[function(a,b,c){"use strict";b.exports=function(a,b,c,d){if("category"===b.type){var e,f=a.categoryarray,g=Array.isArray(f)&&f.length>0;g&&(e="array");var h,i=c("categoryorder",e);"array"===i&&(h=c("categoryarray")),g||"array"!==i||(i=b.categoryorder="trace"),"trace"===i?b._initialCategories=[]:"array"===i?b._initialCategories=h.slice():(h=function(a,b){var c,d,e,f=b.dataAttr||a._id.charAt(0),g={};if(b.axData)c=b.axData;else for(c=[],d=0;d<b.data.length;d++){var h=b.data[d];h[f+"axis"]===a._id&&c.push(h)}for(d=0;d<c.length;d++){var i=c[d][f];for(e=0;e<i.length;e++){var j=i[e];null!=j&&(g[j]=1)}}return Object.keys(g)}(b,d).sort(),"category ascending"===i?b._initialCategories=h:"category descending"===i&&(b._initialCategories=h.reverse()))}}},{}],772:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib"),f=a("../../constants/numerical").ONEDAY;c.dtick=function(a,b){var c="log"===b,e="date"===b,g="category"===b,h=e?f:1;if(!a)return h;if(d(a))return(a=Number(a))<=0?h:g?Math.max(1,Math.round(a)):e?Math.max(.1,a):a;if("string"!=typeof a||!e&&!c)return h;var i=a.charAt(0),j=a.substr(1);return(j=d(j)?Number(j):0)<=0||!(e&&"M"===i&&j===Math.round(j)||c&&"L"===i||c&&"D"===i&&(1===j||2===j))?h:a},c.tick0=function(a,b,c,f){return"date"===b?e.cleanDate(a,e.dateTick0(c)):"D1"!==f&&"D2"!==f?d(a)?Number(a):0:void 0}},{"../../constants/numerical":695,"../../lib":719,"fast-isnumeric":226}],773:[function(a,b,c){"use strict";var d=a("../../lib/regex").counter;b.exports={idRegex:{x:d("x"),y:d("y")},attrRegex:d("[xy]axis"),xAxisMatch:d("xaxis"),yAxisMatch:d("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":735}],774:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f,g,i,j,k="range"!==e,l=d[h(b)].type,m=[];for(g=0;g<c.length;g++)(i=c[g])!==b&&(j=d[h(i)]).type===l&&(j.fixedrange?k&&j.anchor&&d[h(j.anchor)].fixedrange&&m.push(i):m.push(i));for(f=0;f<a.length;f++)if(a[f][b]){var n=a[f],o=[];for(g=0;g<m.length;g++)n[i=m[g]]||o.push(i);return{linkableAxes:o,thisGroup:n}}return{linkableAxes:m,thisGroup:null}}function e(a,b,c,d,e){var f,g,h,i,j;null===b?((b={})[c]=1,j=a.length,a.push(b)):j=a.indexOf(b);var k=Object.keys(b);for(f=0;f<a.length;f++)if(h=a[f],f!==j&&h[d]){var l=h[d];for(g=0;g<k.length;g++)h[i=k[g]]=l*e*b[i];return void a.splice(j,1)}if(1!==e)for(g=0;g<k.length;g++)b[k[g]]*=e;b[d]=1}function f(a,b){var c=a._inputDomain,d=m[a.constraintoward],e=c[0]+(c[1]-c[0])*d;a.domain=a._input.domain=[e+(c[0]-e)/b,e+(c[1]-e)/b],a.setScale()}var g=a("../../lib"),h=a("./axis_ids").id2name,i=a("./scale_zoom"),j=a("./autorange").makePadFn,k=a("./autorange").concatExtremes,l=a("../../constants/numerical").ALMOST_EQUAL,m=a("../../constants/alignment").FROM_BL;c.handleConstraintDefaults=function(a,b,c,f,h){var i,j,k,l,m=h._axisConstraintGroups,n=h._axisMatchGroups,o=b._id,p=o.charAt(0),q=((h._splomAxes||{})[p]||{})[o]||{},r=b._id,s=r.charAt(0),t=c("constrain");if(g.coerce(a,b,{constraintoward:{valType:"enumerated",values:"x"===s?["left","center","right"]:["bottom","middle","top"],dflt:"x"===s?"center":"middle"}},"constraintoward"),!a.matches&&!q.matches||b.fixedrange||(j=d(n,r,f,h),i=g.coerce(a,b,{matches:{valType:"enumerated",values:j.linkableAxes||[],dflt:q.matches}},"matches")),i||!a.scaleanchor||b.fixedrange&&"domain"!==t||(l=d(m,r,f,h,t),k=g.coerce(a,b,{scaleanchor:{valType:"enumerated",values:l.linkableAxes||[]}},"scaleanchor")),i?(delete b.constrain,e(n,j.thisGroup,r,i,1)):-1!==f.indexOf(a.matches)&&g.warn("ignored "+b._name+'.matches: "'+a.matches+'" to avoid either an infinite loop or because the target axis has fixed range.'),k){var u=c("scaleratio");u||(u=b.scaleratio=1),e(m,l.thisGroup,r,k,u)}else-1!==f.indexOf(a.scaleanchor)&&g.warn("ignored "+b._name+'.scaleanchor: "'+a.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because the target axis has fixed range or this axis declares a *matches* constraint.')},c.enforce=function(a){var b,c,d,e,g,m,n,o=a._fullLayout,p=o._axisConstraintGroups||[];for(b=0;b<p.length;b++){var q=p[b],r=Object.keys(q),s=1/0,t=0,u=1/0,v={},w={},x=!1;for(c=0;c<r.length;c++)w[d=r[c]]=e=o[h(d)],e._inputDomain?e.domain=e._inputDomain.slice():e._inputDomain=e.domain.slice(),e._inputRange||(e._inputRange=e.range.slice()),e.setScale(),v[d]=g=Math.abs(e._m)/q[d],s=Math.min(s,g),"domain"!==e.constrain&&e._constraintShrinkable||(u=Math.min(u,g)),delete e._constraintShrinkable,t=Math.max(t,g),"domain"===e.constrain&&(x=!0);if(!(s>l*t)||x)for(c=0;c<r.length;c++)if(g=v[d=r[c]],m=(e=w[d]).constrain,g!==u||"domain"===m)if(n=g/u,"range"===m)i(e,n);else{var y=e._inputDomain,z=(e.domain[1]-e.domain[0])/(y[1]-y[0]),A=(e.r2l(e.range[1])-e.r2l(e.range[0]))/(e.r2l(e._inputRange[1])-e.r2l(e._inputRange[0]));if((n/=z)*A<1){e.domain=e._input.domain=y.slice(),i(e,n);continue}if(A<1&&(e.range=e._input.range=e._inputRange.slice(),n*=A),e.autorange){var B=e.r2l(e.range[0]),C=e.r2l(e.range[1]),D=(B+C)/2,E=D,F=D,G=Math.abs(C-D),H=D-G*n*1.0001,I=D+G*n*1.0001,J=j(e);f(e,n);var K,L,M=Math.abs(e._m),N=k(a,e),O=N.min,P=N.max;for(L=0;L<O.length;L++)(K=O[L].val-J(O[L])/M)>H&&K<E&&(E=K);for(L=0;L<P.length;L++)(K=P[L].val+J(P[L])/M)<I&&K>F&&(F=K);n/=(F-E)/(2*G),E=e.l2r(E),F=e.l2r(F),e.range=e._input.range=B<C?[E,F]:[F,E]}f(e,n)}}},c.clean=function(a,b){if(b._inputDomain){for(var c=!1,d=b._id,e=a._fullLayout._axisConstraintGroups,f=0;f<e.length;f++)if(e[f][d]){c=!0;break}c&&"domain"===b.constrain||(b._input.domain=b.domain=b._inputDomain,delete b._inputDomain)}}},{"../../constants/alignment":688,"../../constants/numerical":695,"../../lib":719,"./autorange":766,"./axis_ids":770,"./scale_zoom":783}],775:[function(a,b,c){"use strict";function d(a,b,c,d){var e=y.ensureSingle(a.draglayer,b,c,function(b){b.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",a.id)});return e.call(E,d),e.node()}function e(a,b,c,e,f,g,h){var i=d(a,"rect",b,c);return u.select(i).call(B.setRect,e,f,g,h),i}function f(a,b){for(var c=0;c<a.length;c++)if(!a[c].fixedrange)return b;return""}function g(a,b,c,d,e){for(var f=0;f<a.length;f++){var h=a[f];if(!h.fixedrange){var i=h._rl[0],j=h._rl[1]-i;d[h._name+".range[0]"]=h.l2r(i+j*b),d[h._name+".range[1]"]=h.l2r(i+j*c)}}if(e&&e.length){var k=(b+(1-c))/2;g(e,k,1-k,d,[])}}function h(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.fixedrange||(d.range=[d.l2r(d._rl[0]-b/d._m),d.l2r(d._rl[1]-b/d._m)])}}function i(a){return 1-(a>=0?Math.min(a,.9):1/(1/Math.max(a,-.3)+3.222))}function j(a,b,c,d,e){return a.append("path").attr("class","zoombox").style({fill:b>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform","translate("+c+", "+d+")").attr("d",e+"Z")}function k(a,b,c){return a.append("path").attr("class","zoombox-corners").style({fill:A.background,stroke:A.defaultLine,"stroke-width":1,opacity:0}).attr("transform","translate("+b+", "+c+")").attr("d","M0,0Z")}function l(a,b,c,d,e,f){a.attr("d",d+"M"+c.l+","+c.t+"v"+c.h+"h"+c.w+"v-"+c.h+"h-"+c.w+"Z"),m(a,b,e,f)}function m(a,b,c,d){c||(a.transition().style("fill",d>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),b.transition().style("opacity",1).duration(200))}function n(a){u.select(a).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function o(a){S&&a.data&&a._context.showTips&&(y.notifier(y._(a,"Double-click to zoom back out"),"long"),S=!1)}function p(a){return"lasso"===a||"select"===a}function q(a){var b=Math.floor(Math.min(a.b-a.t,a.r-a.l,R)/2);return"M"+(a.l-3.5)+","+(a.t-.5+b)+"h3v"+-b+"h"+b+"v-3h-"+(b+3)+"ZM"+(a.r+3.5)+","+(a.t-.5+b)+"h-3v"+-b+"h"+-b+"v-3h"+(b+3)+"ZM"+(a.r+3.5)+","+(a.b+.5-b)+"h-3v"+b+"h"+-b+"v3h"+(b+3)+"ZM"+(a.l-3.5)+","+(a.b+.5-b)+"h3v"+b+"h"+b+"v3h-"+(b+3)+"Z"}function r(a,b,c,d){for(var e,f,g,h,i=!1,j={},k={},l=0;l<b.length;l++){var m=b[l];for(e in c)if(m[e]){for(g in m)("x"===g.charAt(0)?c:d)[g]||(j[g]=e);for(f in d)m[f]&&(i=!0)}for(f in d)if(m[f])for(h in m)("x"===h.charAt(0)?c:d)[h]||(k[h]=f)}i&&(y.extendFlat(j,k),k={});var n={},o=[];for(g in j){var p=K(a,g);o.push(p),n[p._id]=p}var q={},r=[];for(h in k){var s=K(a,h);r.push(s),q[s._id]=s}return{xaHash:n,yaHash:q,xaxes:o,yaxes:r,xLinks:j,yLinks:k,isSubplotConstrained:i}}function s(a,b){if(w){var c=void 0!==a.onwheel?"wheel":"mousewheel";a._onwheel&&a.removeEventListener(c,a._onwheel),a._onwheel=b,a.addEventListener(c,b,{passive:!1})}else void 0!==a.onwheel?a.onwheel=b:void 0!==a.onmousewheel&&(a.onmousewheel=b)}function t(a){var b=[];for(var c in a)b.push(a[c]);return b}var u=a("d3"),v=a("tinycolor2"),w=a("has-passive-events"),x=a("../../registry"),y=a("../../lib"),z=a("../../lib/svg_text_utils"),A=a("../../components/color"),B=a("../../components/drawing"),C=a("../../components/fx"),D=a("./axes"),E=a("../../lib/setcursor"),F=a("../../components/dragelement"),G=a("../../constants/alignment").FROM_TL,H=a("../../lib/clear_gl_canvases"),I=a("../../plot_api/subroutines").redrawReglTraces,J=a("../plots"),K=a("./axis_ids").getFromId,L=a("./select").prepSelect,M=a("./select").clearSelect,N=a("./select").selectOnClick,O=a("./scale_zoom"),P=a("./constants"),Q=P.MINDRAG,R=P.MINZOOM,S=!0;b.exports={makeDragBox:function(a,b,c,d,m,w,A,E){function S(){if(ea=b.xaxis,fa=b.yaxis,ma=ea._length,na=fa._length,ka=ea._offset,la=fa._offset,(ga={})[ea._id]=ea,(ha={})[fa._id]=fa,A&&E)for(var c=b.overlays,d=0;d<c.length;d++){var e=c[d].xaxis;ga[e._id]=e;var g=c[d].yaxis;ha[g._id]=g}ia=t(ga),ja=t(ha),qa=f(ia,E),ra=f(ja,A),sa=!ra&&!qa,oa=r(a,a._fullLayout._axisConstraintGroups,ga,ha),pa=r(a,a._fullLayout._axisMatchGroups,ga,ha),ta=E||oa.isSubplotConstrained||pa.isSubplotConstrained,ua=A||oa.isSubplotConstrained||pa.isSubplotConstrained;var h=a._fullLayout;va=h._has("scattergl"),wa=h._has("splom"),xa=h._has("svg")}function T(){Oa.plotinfo.selection=!1,M(a)}function U(c,d){var e=a._fullLayout.clickmode;if(n(a),2!==c||Ba||function(){if(!a._transitioningWithDuration){var b=a._context.doubleClick,c=[];qa&&(c=c.concat(ia)),ra&&(c=c.concat(ja)),pa.xaxes&&(c=c.concat(pa.xaxes)),pa.yaxes&&(c=c.concat(pa.yaxes));var d,e,f,g={};if("reset+autosize"===b)for(b="autosize",e=0;e<c.length;e++)if((d=c[e])._rangeInitial&&(d.range[0]!==d._rangeInitial[0]||d.range[1]!==d._rangeInitial[1])||!d._rangeInitial&&!d.autorange){b="reset";break}if("autosize"===b)for(e=0;e<c.length;e++)(d=c[e]).fixedrange||(g[d._name+".autorange"]=!0);else if("reset"===b)for((qa||oa.isSubplotConstrained)&&(c=c.concat(oa.xaxes)),ra&&!oa.isSubplotConstrained&&(c=c.concat(oa.yaxes)),oa.isSubplotConstrained&&(qa?ra||(c=c.concat(ja)):c=c.concat(ia)),e=0;e<c.length;e++)(d=c[e]).fixedrange||(d._rangeInitial?(f=d._rangeInitial,g[d._name+".range[0]"]=f[0],g[d._name+".range[1]"]=f[1]):g[d._name+".autorange"]=!0);a.emit("plotly_doubleclick",null),x.call("_guiRelayout",a,g)}}(),Aa)e.indexOf("select")>-1&&N(d,a,ia,ja,b.id,Oa),e.indexOf("event")>-1&&C.click(a,d,b.id);else if(1===c&&Ba){var f=A?fa:ea,g="s"===A||"w"===E?0:1,h=f._name+".range["+g+"]",i=function(a,b){var c,d=a.range[b],e=Math.abs(d-a.range[1-b]);return"date"===a.type?d:"log"===a.type?(c=Math.ceil(Math.max(0,-Math.log(e)/Math.LN10))+3,u.format("."+c+"g")(Math.pow(10,d))):(c=Math.floor(Math.log(Math.abs(d))/Math.LN10)-Math.floor(Math.log(e)/Math.LN10)+4,
u.format("."+String(c)+"g")(d))}(f,g),j="left",k="middle";if(f.fixedrange)return;A?(k="n"===A?"top":"bottom","right"===f.side&&(j="right")):"e"===E&&(j="right"),a._context.showAxisRangeEntryBoxes&&u.select(Da).call(z.makeEditable,{gd:a,immediate:!0,background:a._fullLayout.paper_bgcolor,text:String(i),fill:f.tickfont?f.tickfont.color:"#444",horizontalAlign:j,verticalAlign:k}).on("edit",function(b){var c=f.d2r(b);void 0!==c&&x.call("_guiRelayout",a,h,c)})}}function V(b,c){function d(){Ka="",Ga.r=Ga.l,Ga.t=Ga.b,Ma.attr("d","M0,0Z")}if(a._transitioningWithDuration)return!1;var e=Math.max(0,Math.min(ma,b+Ea)),f=Math.max(0,Math.min(na,c+Fa)),g=Math.abs(e-Ea),h=Math.abs(f-Fa);if(Ga.l=Math.min(Ea,e),Ga.r=Math.max(Ea,e),Ga.t=Math.min(Fa,f),Ga.b=Math.max(Fa,f),oa.isSubplotConstrained)g>R||h>R?(Ka="xy",g/ma>h/na?(h=g*na/ma,Fa>f?Ga.t=Fa-h:Ga.b=Fa+h):(g=h*ma/na,Ea>e?Ga.l=Ea-g:Ga.r=Ea+g),Ma.attr("d",q(Ga))):d();else if(pa.isSubplotConstrained)if(g>R||h>R){Ka="xy";var i=Math.min(Ga.l/ma,(na-Ga.b)/na),j=Math.max(Ga.r/ma,(na-Ga.t)/na);Ga.l=i*ma,Ga.r=j*ma,Ga.b=(1-i)*na,Ga.t=(1-j)*na,Ma.attr("d",q(Ga))}else d();else!ra||h<Math.min(Math.max(.6*g,Q),R)?g<Q||!qa?d():(Ga.t=0,Ga.b=na,Ka="x",Ma.attr("d",function(a,b){return"M"+(a.l-.5)+","+(b-R-.5)+"h-3v"+(2*R+1)+"h3ZM"+(a.r+.5)+","+(b-R-.5)+"h3v"+(2*R+1)+"h-3Z"}(Ga,Fa))):!qa||g<Math.min(.6*h,R)?(Ga.l=0,Ga.r=ma,Ka="y",Ma.attr("d",function(a,b){return"M"+(b-R-.5)+","+(a.t-.5)+"v-3h"+(2*R+1)+"v3ZM"+(b-R-.5)+","+(a.b+.5)+"v3h"+(2*R+1)+"v-3Z"}(Ga,Ea))):(Ka="xy",Ma.attr("d",q(Ga)));Ga.w=Ga.r-Ga.l,Ga.h=Ga.b-Ga.t,Ka&&(Na=!0),a._dragged=Na,l(La,Ma,Ga,Ia,Ja,Ha),W(),a.emit("plotly_relayouting",ya),Ja=!0}function W(){ya={},"xy"!==Ka&&"x"!==Ka||(g(ia,Ga.l/ma,Ga.r/ma,ya,oa.xaxes),Z("x",ya)),"xy"!==Ka&&"y"!==Ka||(g(ja,(na-Ga.b)/na,(na-Ga.t)/na,ya,oa.yaxes),Z("y",ya))}function X(){W(),n(a),_(),o(a)}function Y(b,c){function d(a,b,c){for(var d,e,f=1-b,g=0;g<a.length;g++){var h=a[g];if(!h.fixedrange){d=h,e=h._rl[f]+(h._rl[b]-h._rl[f])/i(c/h._length);var j=h.l2r(e);!1!==j&&void 0!==j&&(h.range[b]=j)}}return d._length*(d._rl[b]-e)/(d._rl[b]-d._rl[f])}if(!a._transitioningWithDuration){if(a._fullLayout._replotting=!0,"ew"===qa||"ns"===ra)return qa&&(h(ia,b),Z("x")),ra&&(h(ja,c),Z("y")),aa([qa?-b:0,ra?-c:0,ma,na]),$(),void a.emit("plotly_relayouting",ya);if(oa.isSubplotConstrained&&qa&&ra){var e="w"===qa==("n"===ra)?1:-1,f=(b/ma+e*c/na)/2;b=f*ma,c=e*f*na}"w"===qa?b=d(ia,0,b):"e"===qa?b=d(ia,1,-b):qa||(b=0),"n"===ra?c=d(ja,1,c):"s"===ra?c=d(ja,0,-c):ra||(c=0);var g="w"===qa?b:0,j="n"===ra?c:0;if(oa.isSubplotConstrained){var k;if(!qa&&1===ra.length){for(k=0;k<ia.length;k++)ia[k].range=ia[k]._r.slice(),O(ia[k],1-c/na);g=(b=c*ma/na)/2}if(!ra&&1===qa.length){for(k=0;k<ja.length;k++)ja[k].range=ja[k]._r.slice(),O(ja[k],1-b/ma);j=(c=b*na/ma)/2}}Z("x"),Z("y"),aa([g,j,ma-b,na-c]),$(),a.emit("plotly_relayouting",ya)}}function Z(a,b){for(var c=pa.isSubplotConstrained?{x:ja,y:ia}[a]:pa[a+"axes"],d=pa.isSubplotConstrained?{x:ia,y:ja}[a]:[],e=0;e<c.length;e++){var f=c[e],g=f._id,h=pa.xLinks[g]||pa.yLinks[g],i=d[0]||ga[h]||ha[h];i&&(b?(b[f._name+".range[0]"]=b[i._name+".range[0]"],b[f._name+".range[1]"]=b[i._name+".range[1]"]):f.range=i.range.slice())}}function $(){function b(a){for(c=0;c<a.length;c++)a[c].fixedrange||d.push(a[c]._id)}var c,d=[];for(ta&&(b(ia),b(oa.xaxes),b(pa.xaxes)),ua&&(b(ja),b(oa.yaxes),b(pa.yaxes)),ya={},c=0;c<d.length;c++){var e=d[c],f=K(a,e);D.drawOne(a,f,{skipTitle:!0}),ya[f._name+".range[0]"]=f.range[0],ya[f._name+".range[1]"]=f.range[1]}D.redrawComponents(a,d)}function _(){aa([0,0,ma,na]),y.syncOrAsync([J.previousPromises,function(){a._fullLayout._replotting=!1,x.call("_guiRelayout",a,ya)}],a)}function aa(b){var c,d,e,f,g=a._fullLayout,h=g._plots,i=g._subplots.cartesian;if(wa&&x.subplotsRegistry.splom.drag(a),va)for(c=0;c<i.length;c++)if(e=(d=h[i[c]]).xaxis,f=d.yaxis,d._scene){var j=y.simpleMap(e.range,e.r2l),k=y.simpleMap(f.range,f.r2l);d._scene.update({range:[j[0],k[0],j[1],k[1]]})}if((wa||va)&&(H(a),I(a)),xa){var l=b[2]/ea._length,m=b[3]/fa._length;for(c=0;c<i.length;c++){e=(d=h[i[c]]).xaxis,f=d.yaxis;var n,o,p,q,r=ta&&!e.fixedrange&&ga[e._id],s=ua&&!f.fixedrange&&ha[f._id];if(r?(n=l,p=E?b[0]:da(e,n)):pa.xaHash[e._id]?(n=l,p=b[0]*e._length/ea._length):pa.yaHash[e._id]?(n=m,p="ns"===ra?-b[1]*e._length/fa._length:da(e,n,{n:"top",s:"bottom"}[ra])):p=ca(e,n=ba(e,l,m)),s?(o=m,q=A?b[1]:da(f,o)):pa.yaHash[f._id]?(o=m,q=b[1]*f._length/fa._length):pa.xaHash[f._id]?(o=l,q="ew"===qa?-b[0]*f._length/ea._length:da(f,o,{e:"right",w:"left"}[qa])):q=ca(f,o=ba(f,l,m)),n||o){n||(n=1),o||(o=1);var t=e._offset-p/n,u=f._offset-q/o;d.clipRect.call(B.setTranslate,p,q).call(B.setScale,n,o),d.plot.call(B.setTranslate,t,u).call(B.setScale,1/n,1/o),n===d.xScaleFactor&&o===d.yScaleFactor||(B.setPointGroupScale(d.zoomScalePts,n,o),B.setTextPointsScale(d.zoomScaleTxt,n,o)),B.hideOutsideRangePoints(d.clipOnAxisFalseTraces,d),d.xScaleFactor=n,d.yScaleFactor=o}}}}function ba(a,b,c){return a.fixedrange?0:ta&&oa.xaHash[a._id]?b:ua&&(oa.isSubplotConstrained?oa.xaHash:oa.yaHash)[a._id]?c:0}function ca(a,b){return b?(a.range=a._r.slice(),O(a,b),da(a,b)):0}function da(a,b,c){return a._length*(1-b)*G[c||a.constraintoward||"middle"]}var ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za=a._fullLayout._zoomlayer,Aa=A+E==="nsew",Ba=1===(A+E).length;S();var Ca=function(a,b,c){return a?"nsew"===a?c?"":"pan"===b?"move":"crosshair":a.toLowerCase()+"-resize":"pointer"}(ra+qa,a._fullLayout.dragmode,Aa),Da=e(b,A+E+"drag",Ca,c,d,m,w);if(sa&&!Aa)return Da.onmousedown=null,Da.style.pointerEvents="none",Da;var Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa={element:Da,gd:a,plotinfo:b};Oa.prepFn=function(b,c,d){var e=Oa.dragmode,f=a._fullLayout.dragmode;f!==e&&(Oa.dragmode=f),S(),sa||(Aa?b.shiftKey?"pan"===f?f="zoom":p(f)||(f="pan"):b.ctrlKey&&(f="pan"):f="pan"),Oa.minDrag="lasso"===f?1:void 0,p(f)?(Oa.xaxes=ia,Oa.yaxes=ja,L(b,c,d,Oa,f)):(Oa.clickFn=U,p(e)&&T(),sa||("zoom"===f?(Oa.moveFn=V,Oa.doneFn=X,Oa.minDrag=1,function(b,c,d){var e=Da.getBoundingClientRect();Ea=c-e.left,Fa=d-e.top,Ga={l:Ea,r:Ea,w:0,t:Fa,b:Fa,h:0},Ha=a._hmpixcount?a._hmlumcount/a._hmpixcount:v(a._fullLayout.plot_bgcolor).getLuminance(),Ja=!1,Ka="xy",Na=!1,La=j(za,Ha,ka,la,Ia="M0,0H"+ma+"V"+na+"H0V0"),Ma=k(za,ka,la)}(0,c,d)):"pan"===f&&(Oa.moveFn=Y,Oa.doneFn=_))),a._fullLayout._redrag=function(){var b=a._dragdata;b&&b.element===Da&&(p(a._fullLayout.dragmode)||(S(),aa([0,0,ma,na]),Oa.moveFn(b.dx,b.dy)))}},F.init(Oa);var Pa=[0,0,ma,na],Qa=null,Ra=P.REDRAWDELAY,Sa=b.mainplot?a._fullLayout._plots[b.mainplot]:b;return A.length*E.length!=1&&s(Da,function(b){function c(a,b,c){if(!a.fixedrange){var d=y.simpleMap(a.range,a.r2l),e=d[0]+(d[1]-d[0])*b;a.range=d.map(function(b){return a.l2r(e+(b-e)*c)})}}if(a._context._scrollZoom.cartesian||a._fullLayout._enablescrollzoom){if(T(),a._transitioningWithDuration)return b.preventDefault(),void b.stopPropagation();S(),clearTimeout(Qa);var d=-b.deltaY;if(isFinite(d)||(d=b.wheelDelta/10),isFinite(d)){var e,f=Math.exp(-Math.min(Math.max(d,-20),20)/200),g=Sa.draglayer.select(".nsewdrag").node().getBoundingClientRect(),h=(b.clientX-g.left)/g.width,i=(g.bottom-b.clientY)/g.height;if(ta){for(E||(h=.5),e=0;e<ia.length;e++)c(ia[e],h,f);Z("x"),Pa[2]*=f,Pa[0]+=Pa[2]*h*(1/f-1)}if(ua){for(A||(i=.5),e=0;e<ja.length;e++)c(ja[e],i,f);Z("y"),Pa[3]*=f,Pa[1]+=Pa[3]*(1-i)*(1/f-1)}aa(Pa),$(),a.emit("plotly_relayouting",ya),Qa=setTimeout(function(){Pa=[0,0,ma,na],_()},Ra),b.preventDefault()}else y.log("Did not find wheel motion attributes: ",b)}}),Da},makeDragger:d,makeRectDragger:e,makeZoombox:j,makeCorners:k,updateZoombox:l,xyCorners:q,transitionZoombox:m,removeZoombox:n,showDoubleClickNotifier:o,attachWheelEventHandler:s}},{"../../components/color":594,"../../components/dragelement":612,"../../components/drawing":615,"../../components/fx":632,"../../constants/alignment":688,"../../lib":719,"../../lib/clear_gl_canvases":704,"../../lib/setcursor":739,"../../lib/svg_text_utils":743,"../../plot_api/subroutines":758,"../../registry":848,"../plots":828,"./axes":767,"./axis_ids":770,"./constants":773,"./scale_zoom":783,"./select":784,d3:164,"has-passive-events":412,tinycolor2:538}],776:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../components/fx"),f=a("../../components/dragelement"),g=a("../../lib/setcursor"),h=a("./dragbox").makeDragBox,i=a("./constants").DRAGGERSIZE;c.initInteractions=function(a){var b=a._fullLayout;if(a._context.staticPlot)d.select(a).selectAll(".drag").remove();else if(b._has("cartesian")||b._has("splom")){Object.keys(b._plots||{}).sort(function(a,c){if((b._plots[a].mainplot&&!0)===(b._plots[c].mainplot&&!0)){var d=a.split("y"),e=c.split("y");return d[0]===e[0]?Number(d[1]||1)-Number(e[1]||1):Number(d[0]||1)-Number(e[0]||1)}return b._plots[a].mainplot?1:-1}).forEach(function(c){var d=b._plots[c],g=d.xaxis,j=d.yaxis;if(!d.mainplot){var k=h(a,d,g._offset,j._offset,g._length,j._length,"ns","ew");k.onmousemove=function(b){a._fullLayout._rehover=function(){a._fullLayout._hoversubplot===c&&e.hover(a,b,c)},e.hover(a,b,c),a._fullLayout._lasthover=k,a._fullLayout._hoversubplot=c},k.onmouseout=function(b){a._dragging||(a._fullLayout._hoversubplot=null,f.unhover(a,b))},a._context.showAxisDragHandles&&(h(a,d,g._offset-i,j._offset-i,i,i,"n","w"),h(a,d,g._offset+g._length,j._offset-i,i,i,"n","e"),h(a,d,g._offset-i,j._offset+j._length,i,i,"s","w"),h(a,d,g._offset+g._length,j._offset+j._length,i,i,"s","e"))}if(a._context.showAxisDragHandles){if(c===g._mainSubplot){var l=g._mainLinePosition;"top"===g.side&&(l-=i),h(a,d,g._offset+.1*g._length,l,.8*g._length,i,"","ew"),h(a,d,g._offset,l,.1*g._length,i,"","w"),h(a,d,g._offset+.9*g._length,l,.1*g._length,i,"","e")}if(c===j._mainSubplot){var m=j._mainLinePosition;"right"!==j.side&&(m-=i),h(a,d,m,j._offset+.1*j._length,i,.8*j._length,"ns",""),h(a,d,m,j._offset+.9*j._length,i,.1*j._length,"s",""),h(a,d,m,j._offset,i,.1*j._length,"n","")}}});var g=b._hoverlayer.node();g.onmousemove=function(c){c.target=a._fullLayout._lasthover,e.hover(a,c,b._hoversubplot)},g.onclick=function(b){b.target=a._fullLayout._lasthover,e.click(a,b)},g.onmousedown=function(b){a._fullLayout._lasthover.onmousedown(b)},c.updateFx(a)}},c.updateFx=function(a){var b=a._fullLayout,c="pan"===b.dragmode?"move":"crosshair";g(b._draggers,c)}},{"../../components/dragelement":612,"../../components/fx":632,"../../lib/setcursor":739,"./constants":773,"./dragbox":775,d3:164}],777:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib");b.exports=function(a){return function(b,c){var f=b[a];if(Array.isArray(f))for(var g=d.subplotsRegistry.cartesian,h=g.idRegex,i=c._subplots,j=i.xaxis,k=i.yaxis,l=i.cartesian,m=c._has("cartesian")||c._has("gl2d"),n=0;n<f.length;n++){var o=f[n];if(e.isPlainObject(o)){var p=o.xref,q=o.yref,r=h.x.test(p),s=h.y.test(q);if(r||s){m||e.pushUnique(c._basePlotModules,g);var t=!1;r&&-1===j.indexOf(p)&&(j.push(p),t=!0),s&&-1===k.indexOf(q)&&(k.push(q),t=!0),t&&r&&s&&l.push(p+q)}}}}}},{"../../lib":719,"../../registry":848}],778:[function(a,b,c){"use strict";function d(a,b,c){return k.ensureSingle(a,b,c,function(a){a.datum(c)})}function e(a,b,c,d,e){for(var f,g,h,k=p.traceLayerClasses,l=a._fullLayout,o=l._modules,q=[],r=[],s=0;s<o.length;s++){var t=(f=o[s]).name,u=j.modules[t].categories;if(u.svg){var v=f.layerName||t+"layer",w=f.plot;h=(g=n(c,w))[0],c=g[1],h.length&&q.push({i:k.indexOf(v),className:v,plotMethod:w,cdModule:h}),u.zoomScale&&r.push("."+v)}}q.sort(function(a,b){return a.i-b.i});var x=b.plot.selectAll("g.mlayer").data(q,function(a){return a.className});if(x.enter().append("g").attr("class",function(a){return a.className}).classed("mlayer",!0).classed("rangeplot",b.isRangePlot),x.exit().remove(),x.order(),x.each(function(c){var f=i.select(this),g=c.className;c.plotMethod(a,b,c.cdModule,f,d,e),-1===p.clipOnAxisFalseQuery.indexOf("."+g)&&m.setClipUrl(f,b.layerClipId,a)}),l._has("scattergl")&&(f=j.getModule("scattergl"),h=n(c,f)[0],f.plot(a,b,h)),!a._context.staticPlot&&(b._hasClipOnAxisFalse&&(b.clipOnAxisFalseTraces=b.plot.selectAll(p.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),r.length)){var y=b.plot.selectAll(r.join(",")).selectAll(".trace");b.zoomScalePts=y.selectAll("path.point"),b.zoomScaleTxt=y.selectAll(".textpoint")}}function f(a,b){var c=b.plotgroup,e=b.id,f=p.layerValue2layerClass[b.xaxis.layer],g=p.layerValue2layerClass[b.yaxis.layer],h=a._fullLayout._hasOnlyLargeSploms;if(b.mainplot){var i=b.mainplotinfo,j=i.plotgroup,k=e+"-x",l=e+"-y";b.gridlayer=i.gridlayer,b.zerolinelayer=i.zerolinelayer,r(i.overlinesBelow,"path",k),r(i.overlinesBelow,"path",l),r(i.overaxesBelow,"g",k),r(i.overaxesBelow,"g",l),b.plot=r(i.overplot,"g",e),r(i.overlinesAbove,"path",k),r(i.overlinesAbove,"path",l),r(i.overaxesAbove,"g",k),r(i.overaxesAbove,"g",l),b.xlines=j.select(".overlines-"+f).select("."+k),b.ylines=j.select(".overlines-"+g).select("."+l),b.xaxislayer=j.select(".overaxes-"+f).select("."+k),b.yaxislayer=j.select(".overaxes-"+g).select("."+l)}else if(h)b.xlines=r(c,"path","xlines-above"),b.ylines=r(c,"path","ylines-above"),b.xaxislayer=r(c,"g","xaxislayer-above"),b.yaxislayer=r(c,"g","yaxislayer-above");else{var m=r(c,"g","layer-subplot");b.shapelayer=r(m,"g","shapelayer"),b.imagelayer=r(m,"g","imagelayer"),b.gridlayer=r(c,"g","gridlayer"),b.zerolinelayer=r(c,"g","zerolinelayer"),r(c,"path","xlines-below"),r(c,"path","ylines-below"),b.overlinesBelow=r(c,"g","overlines-below"),r(c,"g","xaxislayer-below"),r(c,"g","yaxislayer-below"),b.overaxesBelow=r(c,"g","overaxes-below"),b.plot=r(c,"g","plot"),b.overplot=r(c,"g","overplot"),b.xlines=r(c,"path","xlines-above"),b.ylines=r(c,"path","ylines-above"),b.overlinesAbove=r(c,"g","overlines-above"),r(c,"g","xaxislayer-above"),r(c,"g","yaxislayer-above"),b.overaxesAbove=r(c,"g","overaxes-above"),b.xlines=c.select(".xlines-"+f),b.ylines=c.select(".ylines-"+g),b.xaxislayer=c.select(".xaxislayer-"+f),b.yaxislayer=c.select(".yaxislayer-"+g)}h||(d(b.gridlayer,"g",b.xaxis._id),d(b.gridlayer,"g",b.yaxis._id),b.gridlayer.selectAll("g").map(function(a){return a[0]}).sort(o.idSort)),b.xlines.style("fill","none").classed("crisp",!0),b.ylines.style("fill","none").classed("crisp",!0)}function g(a,b){if(a){var c={};for(var d in a.each(function(a){var d=a[0];i.select(this).remove(),h(d,b),c[d]=!0}),b._plots)for(var e=b._plots[d].overlays||[],f=0;f<e.length;f++){var g=e[f];c[g.id]&&g.plot.selectAll(".trace").remove()}}}function h(a,b){b._draggers.selectAll("g."+a).remove(),b._defs.select("#clip"+b._uid+a+"plot").remove()}var i=a("d3"),j=a("../../registry"),k=a("../../lib"),l=a("../plots"),m=a("../../components/drawing"),n=a("../get_data").getModuleCalcData,o=a("./axis_ids"),p=a("./constants"),q=a("../../constants/xmlns_namespaces"),r=k.ensureSingle;c.name="cartesian",c.attr=["xaxis","yaxis"],c.idRoot=["x","y"],c.idRegex=p.idRegex,c.attrRegex=p.attrRegex,c.attributes=a("./attributes"),c.layoutAttributes=a("./layout_attributes"),c.supplyLayoutDefaults=a("./layout_defaults"),c.transitionAxes=a("./transition_axes"),c.finalizeSubplots=function(a,b){var c,d,e,f=b._subplots,g=f.xaxis,h=f.yaxis,i=f.cartesian,j=i.concat(f.gl2d||[]),l={},m={};for(c=0;c<j.length;c++){var n=j[c].split("y");l[n[0]]=1,m["y"+n[1]]=1}for(c=0;c<g.length;c++)l[d=g[c]]||(e=(a[o.id2name(d)]||{}).anchor,p.idRegex.y.test(e)||(e="y"),i.push(d+e),j.push(d+e),m[e]||(m[e]=1,k.pushUnique(h,e)));for(c=0;c<h.length;c++)m[e=h[c]]||(d=(a[o.id2name(e)]||{}).anchor,p.idRegex.x.test(d)||(d="x"),i.push(d+e),j.push(d+e),l[d]||(l[d]=1,k.pushUnique(g,d)));if(!j.length){for(var q in d="",e="",a)p.attrRegex.test(q)&&("x"===q.charAt(0)?(!d||+q.substr(5)<+d.substr(5))&&(d=q):(!e||+q.substr(5)<+e.substr(5))&&(e=q));d=d?o.name2id(d):"x",e=e?o.name2id(e):"y",g.push(d),h.push(e),i.push(d+e)}},c.plot=function(a,b,c,d){var f,g=a._fullLayout,h=g._subplots.cartesian,i=a.calcdata;if(!Array.isArray(b))for(b=[],f=0;f<i.length;f++)b.push(f);for(f=0;f<h.length;f++){for(var j,k=h[f],l=g._plots[k],m=[],n=0;n<i.length;n++){var o=i[n],p=o[0].trace;p.xaxis+p.yaxis===k&&((-1!==b.indexOf(p.index)||p.carpet)&&(j&&j[0].trace.xaxis+j[0].trace.yaxis===k&&-1!==["tonextx","tonexty","tonext"].indexOf(p.fill)&&-1===m.indexOf(j)&&m.push(j),m.push(o)),j=o)}e(a,l,m,c,d)}},c.clean=function(a,b,c,d){var e,f,i,j=d._plots||{},k=b._plots||{},l=d._subplots||{};if(d._hasOnlyLargeSploms&&!b._hasOnlyLargeSploms)for(i in j)(e=j[i]).plotgroup&&e.plotgroup.remove();var m=d._has&&d._has("gl"),n=b._has&&b._has("gl");if(m&&!n)for(i in j)(e=j[i])._scene&&e._scene.destroy();if(l.xaxis&&l.yaxis){var p=o.listIds({_fullLayout:d});for(f=0;f<p.length;f++){var q=p[f];b[o.id2name(q)]||d._infolayer.selectAll(".g-"+q+"title").remove()}}var r=d._has&&d._has("cartesian"),s=b._has&&b._has("cartesian");if(r&&!s)g(d._cartesianlayer.selectAll(".subplot"),d),d._defs.selectAll(".axesclip").remove(),delete d._axisConstraintGroups;else if(l.cartesian)for(f=0;f<l.cartesian.length;f++){var t=l.cartesian[f];if(!k[t]){var u="."+t+",."+t+"-x,."+t+"-y";d._cartesianlayer.selectAll(u).remove(),h(t,d)}}},c.drawFramework=function(a){var b=a._fullLayout,c=function(a){var b,c,d,e,f,g,h=a._fullLayout,i=h._subplots.cartesian,j=i.length,k=[],l=[];for(b=0;b<j;b++){d=i[b],e=h._plots[d],f=e.xaxis,g=e.yaxis;var m=f._mainAxis,n=g._mainAxis,o=m._id+n._id,p=h._plots[o];e.overlays=[],o!==d&&p?(e.mainplot=o,e.mainplotinfo=p,l.push(d)):(e.mainplot=void 0,e.mainPlotinfo=void 0,k.push(d))}for(b=0;b<l.length;b++)d=l[b],(e=h._plots[d]).mainplotinfo.overlays.push(e);var q=k.concat(l),r=new Array(j);for(b=0;b<j;b++){d=q[b],e=h._plots[d],f=e.xaxis,g=e.yaxis;var s=[d,f.layer,g.layer,f.overlaying||"",g.overlaying||""];for(c=0;c<e.overlays.length;c++)s.push(e.overlays[c].id);r[b]=s}return r}(a),d=b._cartesianlayer.selectAll(".subplot").data(c,String);d.enter().append("g").attr("class",function(a){return"subplot "+a[0]}),d.order(),d.exit().call(g,b),d.each(function(c){var d=c[0],e=b._plots[d];e.plotgroup=i.select(this),f(a,e),e.draglayer=r(b._draggers,"g",d)})},c.rangePlot=function(a,b,c){f(a,b),e(a,b,c),l.style(a)},c.toSVG=function(a){var b=a._fullLayout._glimages,c=i.select(a).selectAll(".svg-container");c.filter(function(a,b){return b===c.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var a=this.toDataURL("image/png");b.append("svg:image").attr({xmlns:q.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:this.width,height:this.height})})},c.updateFx=a("./graph_interact").updateFx},{"../../components/drawing":615,"../../constants/xmlns_namespaces":696,"../../lib":719,"../../registry":848,"../get_data":802,"../plots":828,"./attributes":765,"./axis_ids":770,"./constants":773,"./graph_interact":776,"./layout_attributes":779,"./layout_defaults":780,"./transition_axes":789,d3:164}],779:[function(a,b,c){"use strict";var d=a("../font_attributes"),e=a("../../components/color/attributes"),f=a("../../components/drawing/attributes").dash,g=a("../../lib/extend").extendFlat,h=a("../../plot_api/plot_template").templatedArray,i=(a("../../constants/docs").FORMAT_LINK,a("../../constants/docs").DATE_FORMAT_LINK,a("./constants"));b.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:e.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:d({editType:"ticks"}),editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[i.idRegex.x.toString(),i.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],dflt:"range",editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[i.idRegex.x.toString(),i.idRegex.y.toString()],editType:"calc"},tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:e.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:g({},f,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor"],dflt:"data",editType:"none"},tickfont:d({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks"},tickformatstops:h("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none"},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:e.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:e.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:e.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:e.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",i.idRegex.x.toString(),i.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",i.idRegex.x.toString(),i.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:d({editType:"ticks"})}}},{"../../components/color/attributes":593,"../../components/drawing/attributes":614,"../../constants/docs":690,"../../lib/extend":710,"../../plot_api/plot_template":757,"../font_attributes":793,"./constants":773}],780:[function(a,b,c){"use strict";function d(a,b,c){Array.isArray(a[b])?a[b].push(c):a[b]=[c]}var e=a("../../lib"),f=a("../../components/color"),g=a("../../plot_api/plot_template"),h=a("../layout_attributes"),i=a("./layout_attributes"),j=a("./type_defaults"),k=a("./axis_defaults"),l=a("./constraints").handleConstraintDefaults,m=a("./position_defaults"),n=a("./axis_ids"),o=n.id2name,p=n.name2id,q=a("../../registry"),r=q.traceIs,s=q.getComponentMethod;b.exports=function(a,b,c){function n(a,b){return e.coerce(R,S,i,a,b)}function q(a,b){return e.coerce2(R,S,i,a,b)}function t(a){return"x"===a?K:J}var u,v,w={},x={},y={},z={},A={},B={},C={},D={},E={};for(u=0;u<c.length;u++){var F=c[u];if(r(F,"cartesian")||r(F,"gl2d")){var G,H;if(F.xaxis)d(w,G=o(F.xaxis),F);else if(F.xaxes)for(v=0;v<F.xaxes.length;v++)d(w,o(F.xaxes[v]),F);if(F.yaxis)d(w,H=o(F.yaxis),F);else if(F.yaxes)for(v=0;v<F.yaxes.length;v++)d(w,o(F.yaxes[v]),F);"funnel"===F.type?"h"===F.orientation?(G&&(x[G]=!0),H&&(C[H]=!0)):H&&(y[H]=!0):(H&&(A[H]=!0,B[H]=!0),r(F,"carpet")&&("carpet"!==F.type||F._cheater)||G&&(z[G]=!0)),"carpet"===F.type&&F._cheater&&G&&(x[G]=!0),r(F,"2dMap")&&(D[G]=!0,D[H]=!0),r(F,"oriented")&&(E["h"===F.orientation?H:G]=!0)}}var I=b._subplots,J=I.xaxis,K=I.yaxis,L=e.simpleMap(J,o),M=e.simpleMap(K,o),N=L.concat(M),O=f.background;J.length&&K.length&&(O=e.coerce(a,b,h,"plot_bgcolor"));var P,Q,R,S,T=f.combine(O,b.paper_bgcolor),U={x:t("x"),y:t("y")},V=U.x.concat(U.y);for(u=0;u<N.length;u++){Q=(P=N[u]).charAt(0),e.isPlainObject(a[P])||(a[P]={}),R=a[P],S=g.newContainer(b,P,Q+"axis");var W=w[P]||[];S._traceIndices=W.map(function(a){return a._expandedIndex}),S._annIndices=[],S._shapeIndices=[],S._imgIndices=[],S._subplotsWith=[],S._counterAxes=[],S._name=S._attr=P;var X=S._id=p(P),Y=function(b,c){for(var d="x"===b?L:M,e=[],f=0;f<d.length;f++){var g=d[f];g===c||(a[g]||{}).overlaying||e.push(p(g))}return e}(Q,P),Z="x"===Q&&!z[P]&&x[P]||"y"===Q&&!A[P]&&y[P],$="y"===Q&&!B[P]&&C[P],_={letter:Q,font:b.font,outerTicks:D[P],showGrid:!E[P],data:W,bgColor:T,calendar:b.calendar,automargin:!0,visibleDflt:Z,reverseDflt:$,splomStash:((b._splomAxes||{})[Q]||{})[X]};n("uirevision",b.uirevision),j(R,S,n,_),k(R,S,n,_,b);var aa=q("spikecolor"),ba=q("spikethickness"),ca=q("spikedash"),da=q("spikemode"),ea=q("spikesnap");n("showspikes",!!(aa||ba||ca||da||ea))||(delete S.spikecolor,delete S.spikethickness,delete S.spikedash,delete S.spikemode,delete S.spikesnap),m(R,S,n,{letter:Q,counterAxes:U[Q],overlayableAxes:Y,grid:b.grid}),S._input=R}var fa=s("rangeslider","handleDefaults"),ga=s("rangeselector","handleDefaults");for(u=0;u<L.length;u++)P=L[u],R=a[P],S=b[P],fa(a,b,P),"date"===S.type&&ga(R,S,b,M,S.calendar),n("fixedrange");for(u=0;u<M.length;u++){P=M[u],R=a[P],S=b[P];var ha=b[o(S.anchor)];n("fixedrange",s("rangeslider","isVisible")(ha))}var ia=b._axisConstraintGroups=[],ja=b._axisMatchGroups=[];for(u=0;u<N.length;u++)Q=(P=N[u]).charAt(0),R=a[P],S=b[P],l(R,S,n,V,b);for(u=0;u<ja.length;u++){var ka,la=ja[u],ma=null,na=null;for(ka in la)(S=b[o(ka)]).matches||(ma=S.range,na=S.autorange);if(null===ma||null===na)for(ka in la){ma=(S=b[o(ka)]).range,na=S.autorange;break}for(ka in la)(S=b[o(ka)]).matches&&(S.range=ma.slice(),S.autorange=na),S._matchGroup=la;if(ia.length)for(ka in la)for(v=0;v<ia.length;v++){var oa=ia[v];for(var pa in oa)ka===pa&&(e.warn("Axis "+pa+" is set with both a *scaleanchor* and *matches* constraint; ignoring the scale constraint."),delete oa[pa],Object.keys(oa).length<2&&ia.splice(v,1))}}}},{"../../components/color":594,"../../lib":719,"../../plot_api/plot_template":757,"../../registry":848,"../layout_attributes":819,"./axis_defaults":769,"./axis_ids":770,"./constraints":774,"./layout_attributes":779,"./position_defaults":782,"./type_defaults":790}],781:[function(a,b,c){"use strict";var d=a("tinycolor2").mix,e=a("../../components/color/attributes").lightFraction,f=a("../../lib");b.exports=function(a,b,c,g){function h(c,d){return f.coerce2(a,b,g.attributes,c,d)}var i=(g=g||{}).dfltColor,j=h("linecolor",i),k=h("linewidth");c("showline",g.showLine||!!j||!!k)||(delete b.linecolor,delete b.linewidth);var l=h("gridcolor",d(i,g.bgColor,g.blend||e).toRgbString()),m=h("gridwidth");if(c("showgrid",g.showGrid||!!l||!!m)||(delete b.gridcolor,delete b.gridwidth),!g.noZeroLine){var n=h("zerolinecolor",i),o=h("zerolinewidth");c("zeroline",g.showGrid||!!n||!!o)||(delete b.zerolinecolor,delete b.zerolinewidth)}}},{"../../components/color/attributes":593,"../../lib":719,tinycolor2:538}],782:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib");b.exports=function(a,b,c,f){var g,h,i,j,k=f.counterAxes||[],l=f.overlayableAxes||[],m=f.letter,n=f.grid;n&&(h=n._domains[m][n._axisMap[b._id]],g=n._anchors[b._id],h&&(i=n[m+"side"].split(" ")[0],j=n.domain[m]["right"===i||"top"===i?1:0])),h=h||[0,1],g=g||(d(a.position)?"free":k[0]||"free"),i=i||("x"===m?"bottom":"left"),j=j||0,"free"===e.coerce(a,b,{anchor:{valType:"enumerated",values:["free"].concat(k),dflt:g}},"anchor")&&c("position",j),e.coerce(a,b,{side:{valType:"enumerated",values:"x"===m?["bottom","top"]:["left","right"],dflt:i}},"side");var o=!1;if(l.length&&(o=e.coerce(a,b,{overlaying:{valType:"enumerated",values:[!1].concat(l),dflt:!1}},"overlaying")),!o){var p=c("domain",h);p[0]>p[1]-1/4096&&(b.domain=h),e.noneOrAll(a.domain,b.domain,h)}return c("layer"),b}},{"../../lib":719,"fast-isnumeric":226}],783:[function(a,b,c){"use strict";var d=a("../../constants/alignment").FROM_BL;b.exports=function(a,b,c){void 0===c&&(c=d[a.constraintoward||"center"]);var e=[a.r2l(a.range[0]),a.r2l(a.range[1])],f=e[0]+(e[1]-e[0])*c;a.range=a._input.range=[a.l2r(f+(e[0]-f)*b),a.l2r(f+(e[1]-f)*b)]}},{"../../constants/alignment":688}],784:[function(a,b,c){"use strict";function d(a){return a._id}function e(a,b,c,d,e,f,g){var p,q,r,s,t,u,v,w,x,y=b._hoverdata,z=b._fullLayout.clickmode.indexOf("event")>-1,A=[];if(function(a){return a&&Array.isArray(a)&&!0!==a[0].hoverOnBox}(y)){i(a,b,f);var B=function(a,b){var c,d,e=a[0],f=-1,g=[];for(d=0;d<b.length;d++)if(c=b[d],e.fullData._expandedIndex===c.cd[0].trace._expandedIndex){if(!0===e.hoverOnBox)break;void 0!==e.pointNumber?f=e.pointNumber:void 0!==e.binNumber&&(f=e.binNumber,g=e.pointNumbers);break}return{pointNumber:f,pointNumbers:g,searchInfo:c}}(y,p=k(b,c,d,e));if(B.pointNumbers.length>0?function(a,b){var c,d,e,f=[];for(e=0;e<a.length;e++)(c=a[e]).cd[0].trace.selectedpoints&&c.cd[0].trace.selectedpoints.length>0&&f.push(c);if(1===f.length&&f[0]===b.searchInfo&&(d=b.searchInfo.cd[0].trace).selectedpoints.length===b.pointNumbers.length){for(e=0;e<b.pointNumbers.length;e++)if(d.selectedpoints.indexOf(b.pointNumbers[e])<0)return!1;return!0}return!1}(p,B):function(a){var b,c,d,e=0;for(d=0;d<a.length;d++)if(b=a[d],(c=b.cd[0].trace).selectedpoints){if(c.selectedpoints.length>1)return!1;if((e+=c.selectedpoints.length)>1)return!1}return 1===e}(p)&&(u=m(B))){for(g&&g.remove(),
x=0;x<p.length;x++)(q=p[x])._module.selectPoints(q,!1);n(b,p),j(f),z&&b.emit("plotly_deselect",null)}else{for(v=a.shiftKey&&(void 0!==u?u:m(B)),r=function(a,b,c){return{pointNumber:a,searchInfo:b,subtract:c}}(B.pointNumber,B.searchInfo,v),s=h(f.selectionDefs.concat([r])),x=0;x<p.length;x++)if(t=o(p[x]._module.selectPoints(p[x],s),p[x]),A.length)for(var C=0;C<t.length;C++)A.push(t[C]);else A=t;n(b,p,w={points:A}),r&&f&&f.selectionDefs.push(r),g&&l(f.mergedPolygons,g),z&&b.emit("plotly_selected",w)}}}function f(a){return"pointNumber"in a&&"searchInfo"in a}function g(a){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(b,c,d,e){var f=a.searchInfo.cd[0].trace._expandedIndex;return e.cd[0].trace._expandedIndex===f&&d===a.pointNumber},isRect:!1,degenerate:!1,subtract:a.subtract}}function h(a){for(var b=[],c=f(a[0])?0:a[0][0][0],d=c,e=f(a[0])?0:a[0][0][1],h=e,i=0;i<a.length;i++)if(f(a[i]))b.push(g(a[i]));else{var j=v.tester(a[i]);j.subtract=a[i].subtract,b.push(j),c=Math.min(c,j.xmin),d=Math.max(d,j.xmax),e=Math.min(e,j.ymin),h=Math.max(h,j.ymax)}return{xmin:c,xmax:d,ymin:e,ymax:h,pts:[],contains:function(a,c,d,e){for(var f=!1,g=0;g<b.length;g++)b[g].contains(a,c,d,e)&&(f=!1===b[g].subtract);return f},isRect:!1,degenerate:!1}}function i(a,b,c){var d=b._fullLayout,e=c.plotinfo,f=d._lastSelectedSubplot&&d._lastSelectedSubplot===e.id,g=a.shiftKey||a.altKey;f&&g&&e.selection&&e.selection.selectionDefs&&!c.selectionDefs?(c.selectionDefs=e.selection.selectionDefs,c.mergedPolygons=e.selection.mergedPolygons):g&&e.selection||j(c),f||(p(b),d._lastSelectedSubplot=e.id)}function j(a){var b=a.plotinfo;b.selection={},b.selection.selectionDefs=a.selectionDefs=[],b.selection.mergedPolygons=a.mergedPolygons=[]}function k(a,b,c,e){function f(a,b,c,d){return{_module:a,cd:b,xaxis:c,yaxis:d}}var g,h,i,j=[],k=b.map(d),l=c.map(d);for(i=0;i<a.calcdata.length;i++)if(!0===(h=(g=a.calcdata[i])[0].trace).visible&&h._module&&h._module.selectPoints)if(!e||h.subplot!==e&&h.geo!==e)if("splom"===h.type&&h._xaxes[k[0]]&&h._yaxes[l[0]]){var m=f(h._module,g,b[0],c[0]);m.scene=a._fullLayout._splomScenes[h.uid],j.push(m)}else if("sankey"===h.type){var n=f(h._module,g,b[0],c[0]);j.push(n)}else{if(-1===k.indexOf(h.xaxis))continue;if(-1===l.indexOf(h.yaxis))continue;j.push(f(h._module,g,y(a,h.xaxis),y(a,h.yaxis)))}else j.push(f(h._module,g,b[0],c[0]));return j}function l(a,b){var c,d,e=[];for(c=0;c<a.length;c++){var f=a[c];e.push(f.join("L")+"L"+f[0])}d=a.length>0?"M"+e.join("M")+"Z":"M0,0Z",b.attr("d",d)}function m(a){var b=a.searchInfo.cd[0].trace,c=a.pointNumber,d=a.pointNumbers,e=d.length>0?d[0]:c;return!!b.selectedpoints&&b.selectedpoints.indexOf(e)>-1}function n(a,b,c){var d,e,f,g;for(d=0;d<b.length;d++){var h=b[d].cd[0].trace._fullInput,i=a._fullLayout._tracePreGUI[h.uid]||{};void 0===i.selectedpoints&&(i.selectedpoints=h._input.selectedpoints||null)}if(c){var j=c.points||[];for(d=0;d<b.length;d++)(g=b[d].cd[0].trace)._input.selectedpoints=g._fullInput.selectedpoints=[],g._fullInput!==g&&(g.selectedpoints=[]);for(d=0;d<j.length;d++){var k=j[d],l=k.data,m=k.fullData;k.pointIndices?([].push.apply(l.selectedpoints,k.pointIndices),g._fullInput!==g&&[].push.apply(m.selectedpoints,k.pointIndices)):(l.selectedpoints.push(k.pointIndex),g._fullInput!==g&&m.selectedpoints.push(k.pointIndex))}}else for(d=0;d<b.length;d++)delete(g=b[d].cd[0].trace).selectedpoints,delete g._input.selectedpoints,g._fullInput!==g&&delete g._fullInput.selectedpoints;var n=!1;for(d=0;d<b.length;d++){g=(f=(e=b[d]).cd)[0].trace,r.traceIs(g,"regl")&&(n=!0);var o=e._module,p=o.styleOnSelect||o.style;p&&(p(a,f,f[0].node3),f[0].nodeRangePlot3&&p(a,f,f[0].nodeRangePlot3))}n&&(z(a),A(a))}function o(a,b){if(Array.isArray(a))for(var c=b.cd,d=b.cd[0].trace,e=0;e<a.length;e++)a[e]=x(a[e],d,c);return a}function p(a){var b=(a._fullLayout||{})._zoomlayer;b&&b.selectAll(".select-outline").remove()}var q=a("polybooljs"),r=a("../../registry"),s=a("../../components/color"),t=a("../../components/fx"),u=a("../../lib"),v=a("../../lib/polygon"),w=a("../../lib/throttle"),x=a("../../components/fx/helpers").makeEventData,y=a("./axis_ids").getFromId,z=a("../../lib/clear_gl_canvases"),A=a("../../plot_api/subroutines").redrawReglTraces,B=a("./constants"),C=B.MINSELECT,D=v.filter,E=v.tester;b.exports={prepSelect:function(a,b,c,d,f){function g(a,b){return"log"===a.type?a.p2d(b):a.p2r(b)}function m(a){var b="y"===a._id.charAt(0)?1:0;return function(c){return g(a,c[b])}}function p(a,b){return a-b}var r,v,x,y,z,A,F,G=d.gd,H=G._fullLayout,I=H._zoomlayer,J=d.element.getBoundingClientRect(),K=d.plotinfo,L=K.xaxis._offset,M=K.yaxis._offset,N=b-J.left,O=c-J.top,P=N,Q=O,R="M"+N+","+O,S=d.xaxes[0]._length,T=d.yaxes[0]._length,U=d.xaxes.concat(d.yaxes),V=a.altKey;i(a,G,d),"lasso"===f&&(r=D([[N,O]],B.BENDPX));var W=I.selectAll("path.select-outline-"+K.id).data([1,2]);W.enter().append("path").attr("class",function(a){return"select-outline select-outline-"+a+" select-outline-"+K.id}).attr("transform","translate("+L+", "+M+")").attr("d",R+"Z");var X,Y=I.append("path").attr("class","zoombox-corners").style({fill:s.background,stroke:s.defaultLine,"stroke-width":1}).attr("transform","translate("+L+", "+M+")").attr("d","M0,0Z"),Z=H._uid+B.SELECTID,$=[],_=k(G,d.xaxes,d.yaxes,d.subplot);X=K.fillRangeItems?K.fillRangeItems:"select"===f?function(a,b){var c=a.range={};for(z=0;z<U.length;z++){var d=U[z],e=d._id.charAt(0);c[d._id]=[g(d,b[e+"min"]),g(d,b[e+"max"])].sort(p)}}:function(a,b,c){var d=a.lassoPoints={};for(z=0;z<U.length;z++){var e=U[z];d[e._id]=c.filtered.map(m(e))}},d.moveFn=function(a,b){P=Math.max(0,Math.min(S,a+N)),Q=Math.max(0,Math.min(T,b+O));var c=Math.abs(P-N),e=Math.abs(Q-O);if("select"===f){var g=H.selectdirection;"h"===(g="any"===H.selectdirection?e<Math.min(.6*c,C)?"h":c<Math.min(.6*e,C)?"v":"d":H.selectdirection)?((y=[[N,0],[N,T],[P,T],[P,0]]).xmin=Math.min(N,P),y.xmax=Math.max(N,P),y.ymin=Math.min(0,T),y.ymax=Math.max(0,T),Y.attr("d","M"+y.xmin+","+(O-C)+"h-4v"+2*C+"h4ZM"+(y.xmax-1)+","+(O-C)+"h4v"+2*C+"h-4Z")):"v"===g?((y=[[0,O],[0,Q],[S,Q],[S,O]]).xmin=Math.min(0,S),y.xmax=Math.max(0,S),y.ymin=Math.min(O,Q),y.ymax=Math.max(O,Q),Y.attr("d","M"+(N-C)+","+y.ymin+"v-4h"+2*C+"v4ZM"+(N-C)+","+(y.ymax-1)+"v4h"+2*C+"v-4Z")):"d"===g&&((y=[[N,O],[N,Q],[P,Q],[P,O]]).xmin=Math.min(N,P),y.xmax=Math.max(N,P),y.ymin=Math.min(O,Q),y.ymax=Math.max(O,Q),Y.attr("d","M0,0Z"))}else"lasso"===f&&(r.addPt([P,Q]),y=r.filtered);d.selectionDefs&&d.selectionDefs.length?(x=function(a,b,c){return c?q.difference({regions:a,inverted:!1},{regions:[b],inverted:!1}).regions:q.union({regions:a,inverted:!1},{regions:[b],inverted:!1}).regions}(d.mergedPolygons,y,V),y.subtract=V,v=h(d.selectionDefs.concat([y]))):(x=[y],v=E(y)),l(x,W),w.throttle(Z,B.SELECTDELAY,function(){var a;$=[];var b,c=[];for(z=0;z<_.length;z++)if(b=(A=_[z])._module.selectPoints(A,v),c.push(b),a=o(b,A),$.length)for(var e=0;e<a.length;e++)$.push(a[e]);else $=a;n(G,_,F={points:$}),X(F,y,r),d.gd.emit("plotly_selecting",F)})},d.clickFn=function(a,b){var c=H.clickmode;Y.remove(),w.done(Z).then(function(){if(w.clear(Z),2===a){for(W.remove(),z=0;z<_.length;z++)(A=_[z])._module.selectPoints(A,!1);n(G,_),j(d),G.emit("plotly_deselect",null)}else c.indexOf("select")>-1&&e(b,G,d.xaxes,d.yaxes,d.subplot,d,W),"event"===c&&G.emit("plotly_selected",void 0);t.click(G,b)}).catch(u.error)},d.doneFn=function(){Y.remove(),w.done(Z).then(function(){w.clear(Z),d.gd.emit("plotly_selected",F),y&&d.selectionDefs&&(y.subtract=V,d.selectionDefs.push(y),d.mergedPolygons.length=0,[].push.apply(d.mergedPolygons,x)),d.doneFnCompleted&&d.doneFnCompleted($)}).catch(u.error)}},clearSelect:p,selectOnClick:e}},{"../../components/color":594,"../../components/fx":632,"../../components/fx/helpers":629,"../../lib":719,"../../lib/clear_gl_canvases":704,"../../lib/polygon":731,"../../lib/throttle":744,"../../plot_api/subroutines":758,"../../registry":848,"./axis_ids":770,"./constants":773,polybooljs:474}],785:[function(a,b,c){"use strict";function d(a){return Math.pow(10,a)}function e(a){return null!=a}var f=a("d3"),g=a("fast-isnumeric"),h=a("../../lib"),i=h.cleanNumber,j=h.ms2DateTime,k=h.dateTime2ms,l=h.ensureNumber,m=h.isArrayOrTypedArray,n=a("../../constants/numerical"),o=n.FP_SAFE,p=n.BADNUM,q=n.LOG_CLIP,r=a("./constants"),s=a("./axis_ids");b.exports=function(a,b){function c(b,c){if(b>0)return Math.log(b)/Math.LN10;if(b<=0&&c&&a.range&&2===a.range.length){var d=a.range[0],e=a.range[1];return.5*(d+e-2*q*Math.abs(d-e))}return p}function n(b,c,d){var e=k(b,d||a.calendar);if(e===p){if(!g(b))return p;b=+b;var f=Math.floor(10*h.mod(b+.05,1)),i=Math.round(b-f/10);e=k(new Date(i))+f/10}return e}function t(b,c,d){return j(b,c,d||a.calendar)}function u(b){return a._categories[Math.round(b)]}function v(b){if(e(b)){if(void 0===a._categoriesMap&&(a._categoriesMap={}),void 0!==a._categoriesMap[b])return a._categoriesMap[b];a._categories.push("number"==typeof b?String(b):b);var c=a._categories.length-1;return a._categoriesMap[b]=c,c}return p}function w(b){if(a._categoriesMap)return a._categoriesMap[b]}function x(a){var b=w(a);return void 0!==b?b:g(a)?+a:void 0}function y(b){return g(b)?f.round(a._b+a._m*b,2):p}function z(b){return(b-a._b)/a._m}b=b||{};var A=a._id||"x",B=A.charAt(0);a.c2l="log"===a.type?c:l,a.l2c="log"===a.type?d:l,a.l2p=y,a.p2l=z,a.c2p="log"===a.type?function(a,b){return y(c(a,b))}:y,a.p2c="log"===a.type?function(a){return d(z(a))}:z,-1!==["linear","-"].indexOf(a.type)?(a.d2r=a.r2d=a.d2c=a.r2c=a.d2l=a.r2l=i,a.c2d=a.c2r=a.l2d=a.l2r=l,a.d2p=a.r2p=function(b){return a.l2p(i(b))},a.p2d=a.p2r=z,a.cleanPos=l):"log"===a.type?(a.d2r=a.d2l=function(a,b){return c(i(a),b)},a.r2d=a.r2c=function(a){return d(i(a))},a.d2c=a.r2l=i,a.c2d=a.l2r=l,a.c2r=c,a.l2d=d,a.d2p=function(b,c){return a.l2p(a.d2r(b,c))},a.p2d=function(a){return d(z(a))},a.r2p=function(b){return a.l2p(i(b))},a.p2r=z,a.cleanPos=l):"date"===a.type?(a.d2r=a.r2d=h.identity,a.d2c=a.r2c=a.d2l=a.r2l=n,a.c2d=a.c2r=a.l2d=a.l2r=t,a.d2p=a.r2p=function(b,c,d){return a.l2p(n(b,0,d))},a.p2d=a.p2r=function(a,b,c){return t(z(a),b,c)},a.cleanPos=function(b){return h.cleanDate(b,p,a.calendar)}):"category"===a.type?(a.d2c=a.d2l=v,a.r2d=a.c2d=a.l2d=u,a.d2r=a.d2l_noadd=x,a.r2c=function(b){var c=x(b);return void 0!==c?c:a.fraction2r(.5)},a.l2r=a.c2r=l,a.r2l=x,a.d2p=function(b){return a.l2p(a.r2c(b))},a.p2d=function(a){return u(z(a))},a.r2p=a.d2p,a.p2r=z,a.cleanPos=function(a){return"string"==typeof a&&""!==a?a:l(a)}):"multicategory"===a.type&&(a.r2d=a.c2d=a.l2d=u,a.d2r=a.d2l_noadd=x,a.r2c=function(b){var c=x(b);return void 0!==c?c:a.fraction2r(.5)},a.r2c_just_indices=w,a.l2r=a.c2r=l,a.r2l=x,a.d2p=function(b){return a.l2p(a.r2c(b))},a.p2d=function(a){return u(z(a))},a.r2p=a.d2p,a.p2r=z,a.cleanPos=function(a){return Array.isArray(a)||"string"==typeof a&&""!==a?a:l(a)},a.setupMultiCategory=function(c){var d,f,g=a._traceIndices,i=b._axisMatchGroups;if(i&&i.length&&0===a._categories.length)for(d=0;d<i.length;d++){var j=i[d];if(j[A])for(var k in j)if(k!==A){var l=b[s.id2name(k)];g=g.concat(l._traceIndices)}}var n=[[0,{}],[0,{}]],o=[];for(d=0;d<g.length;d++){var p=c[g[d]];if(B in p){var q=p[B],r=p._length||h.minRowLength(q);if(m(q[0])&&m(q[1]))for(f=0;f<r;f++){var t=q[0][f],u=q[1][f];e(t)&&e(u)&&(o.push([t,u]),t in n[0][1]||(n[0][1][t]=n[0][0]++),u in n[1][1]||(n[1][1][u]=n[1][0]++))}}}for(o.sort(function(a,b){var c=n[0][1],d=c[a[0]]-c[b[0]];if(d)return d;var e=n[1][1];return e[a[1]]-e[b[1]]}),d=0;d<o.length;d++)v(o[d])}),a.fraction2r=function(b){var c=a.r2l(a.range[0]),d=a.r2l(a.range[1]);return a.l2r(c+b*(d-c))},a.r2fraction=function(b){var c=a.r2l(a.range[0]),d=a.r2l(a.range[1]);return(a.r2l(b)-c)/(d-c)},a.cleanRange=function(b,c){c||(c={}),b||(b="range");var d,e,f=h.nestedProperty(a,b).get();if(e=(e="date"===a.type?h.dfltRange(a.calendar):"y"===B?r.DFLTRANGEY:c.dfltRange||r.DFLTRANGEX).slice(),"tozero"!==a.rangemode&&"nonnegative"!==a.rangemode||(e[0]=0),f&&2===f.length)for("date"!==a.type||a.autorange||(f[0]=h.cleanDate(f[0],p,a.calendar),f[1]=h.cleanDate(f[1],p,a.calendar)),d=0;d<2;d++)if("date"===a.type){if(!h.isDateTime(f[d],a.calendar)){a[b]=e;break}if(a.r2l(f[0])===a.r2l(f[1])){var i=h.constrain(a.r2l(f[0]),h.MIN_MS+1e3,h.MAX_MS-1e3);f[0]=a.l2r(i-1e3),f[1]=a.l2r(i+1e3);break}}else{if(!g(f[d])){if(!g(f[1-d])){a[b]=e;break}f[d]=f[1-d]*(d?10:.1)}if(f[d]<-o?f[d]=-o:f[d]>o&&(f[d]=o),f[0]===f[1]){var j=Math.max(1,Math.abs(1e-6*f[0]));f[0]-=j,f[1]+=j}}else h.nestedProperty(a,b).set(e)},a.setScale=function(c){var d=b._size;if(a.overlaying){var e=s.getFromId({_fullLayout:b},a.overlaying);a.domain=e.domain}var f=c&&a._r?"_r":"range",g=a.calendar;a.cleanRange(f);var h=a.r2l(a[f][0],g),i=a.r2l(a[f][1],g);if("y"===B?(a._offset=d.t+(1-a.domain[1])*d.h,a._length=d.h*(a.domain[1]-a.domain[0]),a._m=a._length/(h-i),a._b=-a._m*i):(a._offset=d.l+a.domain[0]*d.w,a._length=d.w*(a.domain[1]-a.domain[0]),a._m=a._length/(i-h),a._b=-a._m*h),!isFinite(a._m)||!isFinite(a._b)||a._length<0)throw b._replotting=!1,new Error("Something went wrong with axis scaling")},a.makeCalcdata=function(b,c){var d,e,f,g,i=a.type,j="date"===i&&b[c+"calendar"];if(c in b){if(d=b[c],g=b._length||h.minRowLength(d),h.isTypedArray(d)&&("linear"===i||"log"===i)){if(g===d.length)return d;if(d.subarray)return d.subarray(0,g)}if("multicategory"===i)return function(a,b){for(var c=new Array(b),d=0;d<b;d++){var e=(a[0]||[])[d],f=(a[1]||[])[d];c[d]=w([e,f])}return c}(d,g);for(e=new Array(g),f=0;f<g;f++)e[f]=a.d2c(d[f],0,j)}else{var k=c+"0"in b?a.d2c(b[c+"0"],0,j):0,l=b["d"+c]?Number(b["d"+c]):1;for(d=b[{x:"y",y:"x"}[c]],g=b._length||d.length,e=new Array(g),f=0;f<g;f++)e[f]=k+f*l}return e},a.isValidRange=function(b){return Array.isArray(b)&&2===b.length&&g(a.r2l(b[0]))&&g(a.r2l(b[1]))},a.isPtWithinRange=function(b,c){var d=a.c2l(b[B],null,c),e=a.r2l(a.range[0]),f=a.r2l(a.range[1]);return e<f?e<=d&&d<=f:f<=d&&d<=e},a.clearCalc=function(){var c=function(){a._categories=[],a._categoriesMap={}},d=b._axisMatchGroups;if(d&&d.length){for(var e=!1,f=0;f<d.length;f++){var g=d[f];if(g[A]){e=!0;var h=null,i=null;for(var j in g){var k=b[s.id2name(j)];if(k._categories){h=k._categories,i=k._categoriesMap;break}}h&&i?(a._categories=h,a._categoriesMap=i):c();break}}e||c()}else c();if(a._initialCategories)for(var l=0;l<a._initialCategories.length;l++)v(a._initialCategories[l])},a.sortByInitialCategories=function(){var c=[];if(a._categories=[],a._categoriesMap={},a._initialCategories)for(var d=0;d<a._initialCategories.length;d++)v(a._initialCategories[d]);c=c.concat(a._traceIndices);var e=a._matchGroup;for(var f in e)if(A!==f){var g=b[s.id2name(f)];g._categories=a._categories,g._categoriesMap=a._categoriesMap,c=c.concat(g._traceIndices)}return c};var C=b._d3locale;"date"===a.type&&(a._dateFormat=C?C.timeFormat.utc:f.time.format.utc,a._extraFormat=b._extraFormat),a._separators=b.separators,a._numFormat=C?C.numberFormat:f.format,delete a._minDtick,delete a._forceTick0}},{"../../constants/numerical":695,"../../lib":719,"./axis_ids":770,"./constants":773,d3:164,"fast-isnumeric":226}],786:[function(a,b,c){"use strict";function d(a){var b=["showexponent","showtickprefix","showticksuffix"].filter(function(b){return void 0!==a[b]});if(b.every(function(c){return a[c]===a[b[0]]})||1===b.length)return a[b[0]]}function e(a,b){function c(c,d){return f.coerce(a,b,g.tickformatstops,c,d)}c("enabled")&&(c("dtickrange"),c("value"))}var f=a("../../lib"),g=a("./layout_attributes"),h=a("../array_container_defaults");b.exports=function(a,b,c,i,j,k){k&&1!==k.pass||function(a,b,c,e,f){var g=d(a);c("tickprefix")&&c("showtickprefix",g),c("ticksuffix",f.tickSuffixDflt)&&c("showticksuffix",g)}(a,0,c,0,j),k&&2!==k.pass||function(a,b,c,i,j){var k=d(a);if(c("tickprefix")&&c("showtickprefix",k),c("ticksuffix",j.tickSuffixDflt)&&c("showticksuffix",k),c("showticklabels")){var l=j.font||{},m=b.color,n=m&&m!==g.color.dflt?m:l.color;if(f.coerceFont(c,"tickfont",{family:l.family,size:l.size,color:n}),c("tickangle"),"category"!==i){var o=c("tickformat"),p=a.tickformatstops;Array.isArray(p)&&p.length&&h(a,b,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:e}),o||"date"===i||(c("showexponent",k),c("exponentformat"),c("separatethousands"))}}}(a,b,c,i,j)}},{"../../lib":719,"../array_container_defaults":763,"./layout_attributes":779}],787:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(a,b,c,f){var g=d.coerce2(a,b,e,"ticklen"),h=d.coerce2(a,b,e,"tickwidth"),i=d.coerce2(a,b,e,"tickcolor",b.color);c("ticks",f.outerTicks||g||h||i?"outside":"")||(delete b.ticklen,delete b.tickwidth,delete b.tickcolor)}},{"../../lib":719,"./layout_attributes":779}],788:[function(a,b,c){"use strict";var d=a("./clean_ticks");b.exports=function(a,b,c,e){var f;if("auto"===(f="array"!==a.tickmode||"log"!==e&&"date"!==e?c("tickmode",Array.isArray(a.tickvals)?"array":a.dtick?"linear":"auto"):b.tickmode="auto"))c("nticks");else if("linear"===f){var g=b.dtick=d.dtick(a.dtick,e);b.tick0=d.tick0(a.tick0,e,b.calendar,g)}else"multicategory"!==e&&(void 0===c("tickvals")?b.tickmode="auto":c("ticktext"))}},{"./clean_ticks":772}],789:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../registry"),f=a("../../lib"),g=a("../../components/drawing"),h=a("./axes");b.exports=function(a,b,c,i){function j(a){var b=a.xaxis,c=a.yaxis;l._defs.select("#"+a.clipId+"> rect").call(g.setTranslate,0,0).call(g.setScale,1,1),a.plot.call(g.setTranslate,b._offset,c._offset).call(g.setScale,1,1);var d=a.plot.selectAll(".scatterlayer .trace");d.selectAll(".point").call(g.setPointGroupScale,1,1),d.selectAll(".textpoint").call(g.setTextPointsScale,1,1),d.call(g.hideOutsideRangePoints,a)}function k(b,c){var d=b.plotinfo,e=d.xaxis,i=d.yaxis,j=e._length,k=i._length,l=!!b.xr1,m=!!b.yr1,n=[];if(l){var o=f.simpleMap(b.xr0,e.r2l),p=f.simpleMap(b.xr1,e.r2l),q=o[1]-o[0],r=p[1]-p[0];n[0]=(o[0]*(1-c)+c*p[0]-o[0])/(o[1]-o[0])*j,n[2]=j*(1-c+c*r/q),e.range[0]=e.l2r(o[0]*(1-c)+c*p[0]),e.range[1]=e.l2r(o[1]*(1-c)+c*p[1])}else n[0]=0,n[2]=j;if(m){var s=f.simpleMap(b.yr0,i.r2l),t=f.simpleMap(b.yr1,i.r2l),u=s[1]-s[0],v=t[1]-t[0];n[1]=(s[1]*(1-c)+c*t[1]-s[1])/(s[0]-s[1])*k,n[3]=k*(1-c+c*v/u),i.range[0]=e.l2r(s[0]*(1-c)+c*t[0]),i.range[1]=i.l2r(s[1]*(1-c)+c*t[1])}else n[1]=0,n[3]=k;h.drawOne(a,e,{skipTitle:!0}),h.drawOne(a,i,{skipTitle:!0}),h.redrawComponents(a,[e._id,i._id]);var w=l?j/n[2]:1,x=m?k/n[3]:1,y=l?n[0]:0,z=m?n[1]:0,A=l?n[0]/n[2]*j:0,B=m?n[1]/n[3]*k:0,C=e._offset-A,D=i._offset-B;d.clipRect.call(g.setTranslate,y,z).call(g.setScale,1/w,1/x),d.plot.call(g.setTranslate,C,D).call(g.setScale,w,x),g.setPointGroupScale(d.zoomScalePts,1/w,1/x),g.setTextPointsScale(d.zoomScaleTxt,1/w,1/x)}var l=a._fullLayout;if(0!==b.length){var m,n,o,p;i&&(m=i());var q=d.ease(c.easing);return a._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(p),p=null,function(){for(var c={},d=0;d<b.length;d++){var f=b[d],g=f.plotinfo.xaxis,h=f.plotinfo.yaxis;f.xr0&&(c[g._name+".range"]=f.xr0.slice()),f.yr0&&(c[h._name+".range"]=f.yr0.slice())}return e.call("relayout",a,c).then(function(){for(var a=0;a<b.length;a++)j(b[a].plotinfo)})}()}),n=Date.now(),p=window.requestAnimationFrame(function d(){o=Date.now();for(var f=Math.min(1,(o-n)/c.duration),g=q(f),h=0;h<b.length;h++)k(b[h],g);o-n>c.duration?(function(){for(var c={},d=0;d<b.length;d++){var f=b[d],g=f.plotinfo.xaxis,h=f.plotinfo.yaxis;f.xr1&&(c[g._name+".range"]=f.xr1.slice()),f.yr1&&(c[h._name+".range"]=f.yr1.slice())}m&&m(),e.call("relayout",a,c).then(function(){for(var a=0;a<b.length;a++)j(b[a].plotinfo)})}(),p=window.cancelAnimationFrame(d)):p=window.requestAnimationFrame(d)}),Promise.resolve()}h.redrawComponents(a)}},{"../../components/drawing":615,"../../lib":719,"../../registry":848,"./axes":767,d3:164}],790:[function(a,b,c){"use strict";function d(a){return{v:"x",h:"y"}[a.orientation||"v"]}function e(a,b){var c=d(a),e=f(a,"box-violin"),g=f(a._fullInput||{},"candlestick");return e&&!g&&b===c&&void 0===a[c]&&void 0===a[c+"0"]}var f=a("../../registry").traceIs,g=a("./axis_autotype");b.exports=function(a,b,c,h){"-"===c("type",(h.splomStash||{}).type)&&(function(a,b){if("-"===a.type){var c=a._id,h=c.charAt(0);-1!==c.indexOf("scene")&&(c=h);var i=function(a,b,c){for(var d=0;d<a.length;d++){var f=a[d];if("splom"===f.type&&f._length>0&&(f["_"+c+"axes"]||{})[b])return f;if((f[c+"axis"]||c)===b){if(e(f,c))return f;if((f[c]||[]).length||f[c+"0"])return f}}}(b,c,h);if(i){if("histogram"===i.type&&h==={v:"y",h:"x"}[i.orientation||"v"])return void(a.type="linear");var j,k=h+"calendar",l=i[k],m={noMultiCategory:!f(i,"cartesian")||f(i,"noMultiCategory")};if(e(i,h)){var n=d(i),o=[];for(j=0;j<b.length;j++){var p=b[j];f(p,"box-violin")&&(p[h+"axis"]||h)===c&&(void 0!==p[n]?o.push(p[n][0]):void 0!==p.name?o.push(p.name):o.push("text"),p[k]!==l&&(l=void 0))}a.type=g(o,l,m)}else if("splom"===i.type){var q=i.dimensions,r=q[i._axesDim[c]];r.visible&&(a.type=g(r.values,l,m))}else a.type=g(i[h]||[i[h+"0"]],l,m)}}}(b,h.data),"-"===b.type?b.type="linear":a.type=b.type)}},{"../../registry":848,"./axis_autotype":768}],791:[function(a,b,c){"use strict";function d(a,b,c){var d,e,f,g=!1;if("data"===b.type)d=a._fullData[null!==b.traces?b.traces[0]:0];else{if("layout"!==b.type)return!1;d=a._fullLayout}return e=i.nestedProperty(d,b.prop).get(),(f=c[b.type]=c[b.type]||{}).hasOwnProperty(b.prop)&&f[b.prop]!==e&&(g=!0),f[b.prop]=e,{changed:g,value:e}}function e(a,b){var c=[],d=b[0],e={};if("string"==typeof d)e[d]=b[1];else{if(!i.isPlainObject(d))return c;e=d}return g(e,function(a,b,d){c.push({type:"layout",prop:a,value:d})},"",0),c}function f(a,b){var c,d,e,f,h=[];if(d=b[0],e=b[1],c=b[2],f={},"string"==typeof d)f[d]=e;else{if(!i.isPlainObject(d))return h;f=d,void 0===c&&(c=e)}return void 0===c&&(c=null),g(f,function(b,d,e){var f,g;if(Array.isArray(e)){g=e.slice();var i=Math.min(g.length,a.data.length);c&&(i=Math.min(i,c.length)),f=[];for(var j=0;j<i;j++)f[j]=c?c[j]:j}else g=e,f=c?c.slice():null;if(null===f)Array.isArray(g)&&(g=g[0]);else if(Array.isArray(f)){if(!Array.isArray(g)){var k=g;g=[];for(var l=0;l<f.length;l++)g[l]=k}g.length=Math.min(f.length,g.length)}h.push({type:"data",prop:b,traces:f,value:g})},"",0),h}function g(a,b,c,d){Object.keys(a).forEach(function(e){var f=a[e];if("_"!==e[0]){var h=c+(d>0?".":"")+e;i.isPlainObject(f)?g(f,b,h,d+1):b(h,e,f)}})}var h=a("../registry"),i=a("../lib");c.manageCommandObserver=function(a,b,e,f){var g={},h=!0;b&&b._commandObserver&&(g=b._commandObserver),g.cache||(g.cache={}),g.lookupTable={};var j=c.hasSimpleAPICommandBindings(a,e,g.lookupTable);if(b&&b._commandObserver){if(j)return g;if(b._commandObserver.remove)return b._commandObserver.remove(),b._commandObserver=null,g}if(j){d(a,j,g.cache),g.check=function(){if(h){var b=d(a,j,g.cache);return b.changed&&f&&void 0!==g.lookupTable[b.value]&&(g.disable(),Promise.resolve(f({value:b.value,type:j.type,prop:j.prop,traces:j.traces,index:g.lookupTable[b.value]})).then(g.enable,g.enable)),b.changed}};for(var k=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],l=0;l<k.length;l++)a._internalOn(k[l],g.check);g.remove=function(){for(var b=0;b<k.length;b++)a._removeInternalListener(k[b],g.check)}}else i.log("Unable to automatically bind plot updates to API command"),g.lookupTable={},g.remove=function(){};return g.disable=function(){h=!1},g.enable=function(){h=!0},b&&(b._commandObserver=g),g},c.hasSimpleAPICommandBindings=function(a,b,d){var e,f,g=b.length;for(e=0;e<g;e++){var h,i=b[e],j=i.method,k=i.args;if(Array.isArray(k)||(k=[]),!j)return!1;var l=c.computeAPICommandBindings(a,j,k);if(1!==l.length)return!1;if(f){if((h=l[0]).type!==f.type)return!1;if(h.prop!==f.prop)return!1;if(Array.isArray(f.traces)){if(!Array.isArray(h.traces))return!1;h.traces.sort();for(var m=0;m<f.traces.length;m++)if(f.traces[m]!==h.traces[m])return!1}else if(h.prop!==f.prop)return!1}else f=l[0],Array.isArray(f.traces)&&f.traces.sort();var n=(h=l[0]).value;if(Array.isArray(n)){if(1!==n.length)return!1;n=n[0]}d&&(d[n]=e)}return f},c.executeAPICommand=function(a,b,c){if("skip"===b)return Promise.resolve();var d=h.apiMethodRegistry[b],e=[a];Array.isArray(c)||(c=[]);for(var f=0;f<c.length;f++)e.push(c[f]);return d.apply(null,e).catch(function(a){return i.warn("API call to Plotly."+b+" rejected.",a),Promise.reject(a)})},c.computeAPICommandBindings=function(a,b,c){var d;switch(Array.isArray(c)||(c=[]),b){case"restyle":d=f(a,c);break;case"relayout":d=e(a,c);break;case"update":d=f(a,[c[0],c[2]]).concat(e(a,[c[1]]));break;case"animate":d=function(a,b){return Array.isArray(b[0])&&1===b[0].length&&-1!==["string","number"].indexOf(typeof b[0][0])?[{type:"layout",prop:"_currentFrame",value:b[0][0].toString()}]:[]}(0,c);break;default:d=[]}return d}},{"../lib":719,"../registry":848}],792:[function(a,b,c){"use strict";var d=a("../lib/extend").extendFlat;c.attributes=function(a,b){b=b||{};var c={valType:"info_array",editType:(a=a||{}).editType,items:[{valType:"number",min:0,max:1,editType:a.editType},{valType:"number",min:0,max:1,editType:a.editType}],dflt:[0,1]},e=(a.name&&a.name,a.trace,b.description&&b.description,{x:d({},c,{}),y:d({},c,{}),editType:a.editType});return a.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:a.editType},e.column={valType:"integer",min:0,dflt:0,editType:a.editType}),e},c.defaults=function(a,b,c,d){var e=d&&d.x||[0,1],f=d&&d.y||[0,1],g=b.grid;if(g){var h=c("domain.column");void 0!==h&&(h<g.columns?e=g._domains.x[h]:delete a.domain.column);var i=c("domain.row");void 0!==i&&(i<g.rows?f=g._domains.y[i]:delete a.domain.row)}c("domain.x",e),c("domain.y",f)}},{"../lib/extend":710}],793:[function(a,b,c){"use strict";b.exports=function(a){var b=a.editType,c=a.colorEditType;void 0===c&&(c=b);var d={family:{valType:"string",noBlank:!0,strict:!0,editType:b},size:{valType:"number",min:1,editType:b},color:{valType:"color",editType:c},editType:b};return a.arrayOk&&(d.family.arrayOk=!0,d.size.arrayOk=!0,d.color.arrayOk=!0),d}},{}],794:[function(a,b,c){"use strict";b.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],795:[function(a,b,c){"use strict";c.projNames={equirectangular:"equirectangular",mercator:"mercator",orthographic:"orthographic","natural earth":"naturalEarth",kavrayskiy7:"kavrayskiy7",miller:"miller",robinson:"robinson",eckert4:"eckert4","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant","conic equal area":"conicEqualArea","conic conformal":"conicConformal","conic equidistant":"conicEquidistant",gnomonic:"gnomonic",stereographic:"stereographic",mollweide:"mollweide",hammer:"hammer","transverse mercator":"transverseMercator","albers usa":"albersUsa","winkel tripel":"winkel3",aitoff:"aitoff",sinusoidal:"sinusoidal"},c.axesNames=["lonaxis","lataxis"],c.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},c.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},c.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},c.clipPad=.001,c.precision=.1,c.landColor="#F0DC82",c.waterColor="#3399FF",c.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},c.sphereSVG={type:"Sphere"},c.fillLayers={ocean:1,land:1,lakes:1},c.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},c.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],c.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],c.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],796:[function(a,b,c){"use strict";function d(a){this.id=a.id,this.graphDiv=a.graphDiv,this.container=a.container,this.topojsonURL=a.topojsonURL,this.isStatic=a.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var e=a("d3"),f=a("../../registry"),g=a("../../lib"),h=a("../../components/color"),i=a("../../components/drawing"),j=a("../../components/fx"),k=a("../plots"),l=a("../cartesian/axes"),m=a("../../components/dragelement"),n=a("../cartesian/select").prepSelect,o=a("../cartesian/select").selectOnClick,p=a("./zoom"),q=a("./constants"),r=a("../../lib/topojson_utils"),s=a("topojson-client").feature;a("./projections")(e);var t=d.prototype;b.exports=function(a){return new d(a)},t.plot=function(a,b,c){var d=this,e=b[this.id],f=!1;for(var g in q.layerNameToAdjective)if("frame"!==g&&e["show"+g]){f=!0;break}for(var h=0;h<a.length;h++)if(a[0][0].trace.locationmode){f=!0;break}if(!f)return d.update(a,b);var i=r.getTopojsonName(e);null===d.topojson||i!==d.topojsonName?(d.topojsonName=i,void 0===PlotlyGeoAssets.topojson[d.topojsonName]?c.push(d.fetchTopojson().then(function(c){PlotlyGeoAssets.topojson[d.topojsonName]=c,d.topojson=c,d.update(a,b)})):(d.topojson=PlotlyGeoAssets.topojson[d.topojsonName],d.update(a,b))):d.update(a,b)},t.fetchTopojson=function(){var a=r.getTopojsonPath(this.topojsonURL,this.topojsonName);return new Promise(function(b,c){e.json(a,function(d,e){if(d)return c(404===d.status?new Error(["plotly.js could not find topojson file at",a,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" ")):new Error(["unexpected error while fetching topojson file at",a].join(" ")));b(e)})})},t.update=function(a,b){var c=b[this.id];if(!this.updateProjection(b,c)){this.hasChoropleth=!1;for(var d=0;d<a.length;d++)if("choropleth"===a[d][0].trace.type){this.hasChoropleth=!0;break}this.viewInitial&&this.scope===c.scope||this.saveViewInitial(c),this.scope=c.scope,this.updateBaseLayers(b,c),this.updateDims(b,c),this.updateFx(b,c),k.generalUpdatePerTraceModule(this.graphDiv,this,a,c);var e=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=e.selectAll(".point"),this.dataPoints.text=e.selectAll("text"),this.dataPaths.line=e.selectAll(".js-line");var f=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=f.selectAll("path"),this.render()}},t.updateProjection=function(a,b){var c=a._size,d=b.domain,h=b.projection,i=h.rotation||{},j=b.center||{},k=this.projection=function(a){for(var b=a.projection.type,c=e.geo[q.projNames[b]](),d=a._isClipped?q.lonaxisSpan[b]/2:null,f=["center","rotate","parallels","clipExtent"],g=function(a){return a?c:[]},h=0;h<f.length;h++){var i=f[h];"function"!=typeof c[i]&&(c[i]=g)}return c.isLonLatOverEdges=function(a){if(null===c(a))return!0;if(d){var b=c.rotate();return e.geo.distance(a,[-b[0],-b[1]])>d*Math.PI/180}return!1},c.getPath=function(){return e.geo.path().projection(c)},c.getBounds=function(a){return c.getPath().bounds(a)},c.fitExtent=function(a,b){var d=a[1][0]-a[0][0],e=a[1][1]-a[0][1],f=c.clipExtent&&c.clipExtent()
;c.scale(150).translate([0,0]),f&&c.clipExtent(null);var g=c.getBounds(b),h=Math.min(d/(g[1][0]-g[0][0]),e/(g[1][1]-g[0][1])),i=+a[0][0]+(d-h*(g[1][0]+g[0][0]))/2,j=+a[0][1]+(e-h*(g[1][1]+g[0][1]))/2;return f&&c.clipExtent(f),c.scale(150*h).translate([i,j])},c.precision(q.precision),d&&c.clipAngle(d-q.clipPad),c}(b);k.center([j.lon-i.lon,j.lat-i.lat]).rotate([-i.lon,-i.lat,i.roll]).parallels(h.parallels);var l=[[c.l+c.w*d.x[0],c.t+c.h*(1-d.y[1])],[c.l+c.w*d.x[1],c.t+c.h*(1-d.y[0])]],m=b.lonaxis,n=b.lataxis,o=function(a,b){var c=q.clipPad,d=a[0]+c,e=a[1]-c,f=b[0]+c,g=b[1]-c;d>0&&e<0&&(e+=360);var h=(e-d)/4;return{type:"Polygon",coordinates:[[[d,f],[d,g],[d+h,g],[d+2*h,g],[d+3*h,g],[e,g],[e,f],[e-h,f],[e-2*h,f],[e-3*h,f],[d,f]]]}}(m.range,n.range);k.fitExtent(l,o);var p=this.bounds=k.getBounds(o),r=this.fitScale=k.scale(),s=k.translate();if(!isFinite(p[0][0])||!isFinite(p[0][1])||!isFinite(p[1][0])||!isFinite(p[1][1])||isNaN(s[0])||isNaN(s[0])){for(var t=this.graphDiv,u=["projection.rotation","center","lonaxis.range","lataxis.range"],v="Invalid geo settings, relayout'ing to default view.",w={},x=0;x<u.length;x++)w[this.id+"."+u[x]]=null;return this.viewInitial=null,g.warn(v),t._promises.push(f.call("relayout",t,w)),v}var y=this.midPt=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2];if(k.scale(h.scale*r).translate([s[0]+(y[0]-s[0]),s[1]+(y[1]-s[1])]).clipExtent(p),b._isAlbersUsa){var z=k([j.lon,j.lat]),A=k.translate();k.translate([A[0]-(z[0]-A[0]),A[1]-(z[1]-A[1])])}},t.updateBaseLayers=function(a,b){function c(a){return"lonaxis"===a||"lataxis"===a}function d(a){return Boolean(q.lineLayers[a])}function f(a){return Boolean(q.fillLayers[a])}var g=this,j=g.topojson,k=g.layers,m=g.basePaths,n=(this.hasChoropleth?q.layersForChoropleth:q.layers).filter(function(a){return d(a)||f(a)?b["show"+a]:!c(a)||b[a].showgrid}),o=g.framework.selectAll(".layer").data(n,String);o.exit().each(function(a){delete k[a],delete m[a],e.select(this).remove()}),o.enter().append("g").attr("class",function(a){return"layer "+a}).each(function(a){var b=k[a]=e.select(this);"bg"===a?g.bgRect=b.append("rect").style("pointer-events","all"):c(a)?m[a]=b.append("path").style("fill","none"):"backplot"===a?b.append("g").classed("choroplethlayer",!0):"frontplot"===a?b.append("g").classed("scatterlayer",!0):d(a)?m[a]=b.append("path").style("fill","none").style("stroke-miterlimit",2):f(a)&&(m[a]=b.append("path").style("stroke","none"))}),o.order(),o.each(function(e){var g=m[e],k=q.layerNameToAdjective[e];"frame"===e?g.datum(q.sphereSVG):d(e)||f(e)?g.datum(s(j,j.objects[e])):c(e)&&g.datum(function(a,b,c){var d,e,f,g=b[a],h=q.scopeDefaults[b.scope];"lonaxis"===a?(d=h.lonaxisRange,e=h.lataxisRange,f=function(a,b){return[a,b]}):"lataxis"===a&&(d=h.lataxisRange,e=h.lonaxisRange,f=function(a,b){return[b,a]});var i={type:"linear",range:[d[0],d[1]-1e-6],tick0:g.tick0,dtick:g.dtick};l.setConvert(i,c);var j=l.calcTicks(i);b.isScoped||"lonaxis"!==a||j.pop();for(var k=j.length,m=new Array(k),n=0;n<k;n++)for(var o=j[n].x,p=m[n]=[],r=e[0];r<e[1]+2.5;r+=2.5)p.push(f(o,r));return{type:"MultiLineString",coordinates:m}}(e,b,a)).call(h.stroke,b[e].gridcolor).call(i.dashLine,"",b[e].gridwidth),d(e)?g.call(h.stroke,b[k+"color"]).call(i.dashLine,"",b[k+"width"]):f(e)&&g.call(h.fill,b[k+"color"])})},t.updateDims=function(a,b){var c=this.bounds,d=(b.framewidth||0)/2,e=c[0][0]-d,f=c[0][1]-d,g=c[1][0]-e+d,j=c[1][1]-f+d;i.setRect(this.clipRect,e,f,g,j),this.bgRect.call(i.setRect,e,f,g,j).call(h.fill,b.bgcolor),this.xaxis._offset=e,this.xaxis._length=g,this.yaxis._offset=f,this.yaxis._length=j},t.updateFx=function(a,b){function c(a){return d.projection.invert([a[0]+d.xaxis._offset,a[1]+d.yaxis._offset])}var d=this,g=d.graphDiv,h=d.bgRect,i=a.dragmode,k=a.clickmode;if(!d.isStatic){var l;"select"===i?l=function(a,b){(a.range={})[d.id]=[c([b.xmin,b.ymin]),c([b.xmax,b.ymax])]}:"lasso"===i&&(l=function(a,b,e){(a.lassoPoints={})[d.id]=e.filtered.map(c)});var q={element:d.bgRect.node(),gd:g,plotinfo:{id:d.id,xaxis:d.xaxis,yaxis:d.yaxis,fillRangeItems:l},xaxes:[d.xaxis],yaxes:[d.yaxis],subplot:d.id,clickFn:function(b){2===b&&a._zoomlayer.selectAll(".select-outline").remove()}};"pan"===i?(h.node().onmousedown=null,h.call(p(d,b)),h.on("dblclick.zoom",function(){var a=d.viewInitial,b={};for(var c in a)b[d.id+"."+c]=a[c];f.call("_guiRelayout",g,b),g.emit("plotly_doubleclick",null)}),g._context._scrollZoom.geo||h.on("wheel.zoom",null)):"select"!==i&&"lasso"!==i||(h.on(".zoom",null),q.prepFn=function(a,b,c){n(a,b,c,q,i)},m.init(q)),h.on("mousemove",function(){var a=d.projection.invert(e.mouse(this));if(!a||isNaN(a[0])||isNaN(a[1]))return m.unhover(g,e.event);d.xaxis.p2c=function(){return a[0]},d.yaxis.p2c=function(){return a[1]},j.hover(g,e.event,d.id)}),h.on("mouseout",function(){g._dragging||m.unhover(g,e.event)}),h.on("click",function(){"select"!==i&&"lasso"!==i&&(k.indexOf("select")>-1&&o(e.event,g,[d.xaxis],[d.yaxis],d.id,q),k.indexOf("event")>-1&&j.click(g,e.event))})}},t.makeFramework=function(){var a=this,b=a.graphDiv,c=b._fullLayout,d="clip"+c._uid+a.id;a.clipDef=c._clips.append("clipPath").attr("id",d),a.clipRect=a.clipDef.append("rect"),a.framework=e.select(a.container).append("g").attr("class","geo "+a.id).call(i.setClipUrl,d,b),a.project=function(b){var c=a.projection(b);return c?[c[0]-a.xaxis._offset,c[1]-a.yaxis._offset]:[null,null]},a.xaxis={_id:"x",c2p:function(b){return a.project(b)[0]}},a.yaxis={_id:"y",c2p:function(b){return a.project(b)[1]}},a.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},l.setConvert(a.mockAxis,c)},t.saveViewInitial=function(a){var b=a.center||{},c=a.projection,d=c.rotation||{};a._isScoped?this.viewInitial={"center.lon":b.lon,"center.lat":b.lat,"projection.scale":c.scale}:a._isClipped?this.viewInitial={"projection.scale":c.scale,"projection.rotation.lon":d.lon,"projection.rotation.lat":d.lat}:this.viewInitial={"center.lon":b.lon,"center.lat":b.lat,"projection.scale":c.scale,"projection.rotation.lon":d.lon}},t.render=function(){function a(a){var b=d(a.lonlat);return b?"translate("+b[0]+","+b[1]+")":null}function b(a){return d.isLonLatOverEdges(a.lonlat)?"none":null}var c,d=this.projection,e=d.getPath();for(c in this.basePaths)this.basePaths[c].attr("d",e);for(c in this.dataPaths)this.dataPaths[c].attr("d",function(a){return e(a.geojson)});for(c in this.dataPoints)this.dataPoints[c].attr("display",b).attr("transform",a)}},{"../../components/color":594,"../../components/dragelement":612,"../../components/drawing":615,"../../components/fx":632,"../../lib":719,"../../lib/topojson_utils":746,"../../registry":848,"../cartesian/axes":767,"../cartesian/select":784,"../plots":828,"./constants":795,"./projections":800,"./zoom":801,d3:164,"topojson-client":541}],797:[function(a,b,c){"use strict";var d=a("../../plots/get_data").getSubplotCalcData,e=a("../../lib").counterRegex,f=a("./geo"),g="geo",h=e(g),i={};i[g]={valType:"subplotid",dflt:g,editType:"calc"},b.exports={attr:g,name:g,idRoot:g,idRegex:h,attrRegex:h,attributes:i,layoutAttributes:a("./layout_attributes"),supplyLayoutDefaults:a("./layout_defaults"),plot:function(a){for(var b=a._fullLayout,c=a.calcdata,e=b._subplots[g],h=0;h<e.length;h++){var i=e[h],j=d(c,g,i),k=b[i]._subplot;k||(k=f({id:i,graphDiv:a,container:b._geolayer.node(),topojsonURL:a._context.topojsonURL,staticPlot:a._context.staticPlot}),b[i]._subplot=k),k.plot(j,b,a._promises)}},updateFx:function(a){for(var b=a._fullLayout,c=b._subplots[g],d=0;d<c.length;d++){var e=b[c[d]];e._subplot.updateFx(b,e)}},clean:function(a,b,c,d){for(var e=d._subplots[g]||[],f=0;f<e.length;f++){var h=e[f],i=d[h]._subplot;!b[h]&&i&&(i.framework.remove(),i.clipDef.remove())}}}},{"../../lib":719,"../../plots/get_data":802,"./geo":796,"./layout_attributes":798,"./layout_defaults":799}],798:[function(a,b,c){"use strict";var d=a("../../components/color/attributes"),e=a("../domain").attributes,f=a("./constants"),g=a("../../plot_api/edit_types").overrideAll,h={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:d.lightLine},gridwidth:{valType:"number",min:0,dflt:1}};(b.exports=g({domain:e({name:"geo"},{}),resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:Object.keys(f.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:Object.keys(f.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:d.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:f.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:f.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:f.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:f.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:d.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:d.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:d.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:d.background},lonaxis:h,lataxis:h},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":593,"../../plot_api/edit_types":750,"../domain":792,"./constants":795}],799:[function(a,b,c){"use strict";function d(a,b,c){var d=c("resolution"),e=c("scope"),g=f.scopeDefaults[e],i=c("projection.type",g.projType),j=b._isAlbersUsa="albers usa"===i;j&&(e=b.scope="usa");var k=b._isScoped="world"!==e,l=b._isConic=-1!==i.indexOf("conic");b._isClipped=!!f.lonaxisSpan[i];for(var m=0;m<h.length;m++){var n,o=h[m],p=[30,10][m];if(k)n=g[o+"Range"];else{var q=f[o+"Span"],r=(q[i]||q["*"])/2,s=c("projection.rotation."+o.substr(0,3),g.projRotate[m]);n=[s-r,s+r]}c(o+".range",n),c(o+".tick0"),c(o+".dtick",p),c(o+".showgrid")&&(c(o+".gridcolor"),c(o+".gridwidth"))}var t=b.lonaxis.range,u=b.lataxis.range,v=t[0],w=t[1];v>0&&w<0&&(w+=360);var x,y,z,A=(v+w)/2;if(!j){var B=k?g.projRotate:[A,0,0];x=c("projection.rotation.lon",B[0]),c("projection.rotation.lat",B[1]),c("projection.rotation.roll",B[2]),c("showcoastlines",!k)&&(c("coastlinecolor"),c("coastlinewidth")),c("showocean")&&c("oceancolor")}j?(y=-96.6,z=38.7):(y=k?A:x,z=(u[0]+u[1])/2),c("center.lon",y),c("center.lat",z),l&&c("projection.parallels",g.projParallels||[0,60]),c("projection.scale"),c("showland")&&c("landcolor"),c("showlakes")&&c("lakecolor"),c("showrivers")&&(c("rivercolor"),c("riverwidth")),c("showcountries",k&&"usa"!==e)&&(c("countrycolor"),c("countrywidth")),("usa"===e||"north america"===e&&50===d)&&(c("showsubunits",!0),c("subunitcolor"),c("subunitwidth")),k||c("showframe",!0)&&(c("framecolor"),c("framewidth")),c("bgcolor")}var e=a("../subplot_defaults"),f=a("./constants"),g=a("./layout_attributes"),h=f.axesNames;b.exports=function(a,b,c){e(a,b,c,{type:"geo",attributes:g,handleDefaults:d,partition:"y"})}},{"../subplot_defaults":842,"./constants":795,"./layout_attributes":798}],800:[function(a,b,c){"use strict";b.exports=function(a){function b(a,b){return{type:"Feature",id:a.id,properties:a.properties,geometry:c(a.geometry,b)}}function c(b,d){if(!b)return null;if("GeometryCollection"===b.type)return{type:"GeometryCollection",geometries:object.geometries.map(function(a){return c(a,d)})};if(!x.hasOwnProperty(b.type))return null;var e=x[b.type];return a.geo.stream(b,d(e)),e.result()}function d(){}function e(a){return a>1?B:a<-1?-B:Math.asin(a)}function f(a){return a>1?0:a<-1?A:Math.acos(a)}function g(a,b){var c=(2+B)*Math.sin(b);b/=2;for(var d=0,e=1/0;d<10&&Math.abs(e)>y;d++){var f=Math.cos(b);b-=e=(b+Math.sin(b)*(f+2)-c)/(2*f*(1+f))}return[2/Math.sqrt(A*(4+A))*a*(1+Math.cos(b)),2*Math.sqrt(A/(4+A))*Math.sin(b)]}function h(a,b){function c(c,d){var e=G(c/b,d);return e[0]*=a,e}return arguments.length<2&&(b=a),1===b?G:b===1/0?i:(c.invert=function(c,d){var e=G.invert(c/a,d);return e[0]*=b,e},c)}function i(a,b){return[a*Math.cos(b)/Math.cos(b/=2),2*Math.sin(b)]}function j(a,b){return[3*a/(2*A)*Math.sqrt(A*A/3-b*b),b]}function k(a,b){return[a,1.25*Math.log(Math.tan(A/4+.4*b))]}function l(a){return function(b){var c,d=a*Math.sin(b),e=30;do{b-=c=(b+Math.sin(b)-d)/(1+Math.cos(b))}while(Math.abs(c)>y&&--e>0);return b/2}}function m(a,b){var c=b*b,d=c*c;return[a*(.8707-.131979*c+d*(d*(.003971*c-.001529*d)-.013791)),b*(1.007226+c*(.015085+d*(.028874*c-.044475-.005916*d)))]}function n(a,b){var c,d=Math.min(18,36*Math.abs(b)/A),e=Math.floor(d),f=d-e,g=(c=I[e])[0],h=c[1],i=(c=I[++e])[0],j=c[1],k=(c=I[Math.min(19,++e)])[0],l=c[1];return[a*(i+f*(k-g)/2+f*f*(k-2*i+g)/2),(b>0?B:-B)*(j+f*(l-h)/2+f*f*(l-2*j+h)/2)]}function o(a,b){return[a*Math.cos(b),b]}function p(a,b){var c,d=Math.cos(b),e=(c=f(d*Math.cos(a/=2)))?c/Math.sin(c):1;return[2*d*Math.sin(a)*e,Math.sin(b)*e]}function q(a,b){var c=p(a,b);return[(c[0]+a/B)/2,(c[1]+b)/2]}a.geo.project=function(a,b){var d=b.stream;if(!d)throw new Error("not yet supported");return(a&&r.hasOwnProperty(a.type)?r[a.type]:c)(a,d)};var r={Feature:b,FeatureCollection:function(a,c){return{type:"FeatureCollection",features:a.features.map(function(a){return b(a,c)})}}},s=[],t=[],u={point:function(a,b){s.push([a,b])},result:function(){var a=s.length?s.length<2?{type:"Point",coordinates:s[0]}:{type:"MultiPoint",coordinates:s}:null;return s=[],a}},v={lineStart:d,point:function(a,b){s.push([a,b])},lineEnd:function(){s.length&&(t.push(s),s=[])},result:function(){var a=t.length?t.length<2?{type:"LineString",coordinates:t[0]}:{type:"MultiLineString",coordinates:t}:null;return t=[],a}},w={polygonStart:d,lineStart:d,point:function(a,b){s.push([a,b])},lineEnd:function(){var a=s.length;if(a){do{s.push(s[0].slice())}while(++a<4);t.push(s),s=[]}},polygonEnd:d,result:function(){if(!t.length)return null;var a=[],b=[];return t.forEach(function(c){!function(a){if((b=a.length)<4)return!1;for(var b,c=0,d=a[b-1][1]*a[0][0]-a[b-1][0]*a[0][1];++c<b;)d+=a[c-1][1]*a[c][0]-a[c-1][0]*a[c][1];return d<=0}(c)?b.push(c):a.push([c])}),b.forEach(function(b){var c=b[0];a.some(function(a){if(function(a,b){for(var c=b[0],d=b[1],e=!1,f=0,g=a.length,h=g-1;f<g;h=f++){var i=a[f],j=i[0],k=i[1],l=a[h],m=l[0],n=l[1];k>d^n>d&&c<(m-j)*(d-k)/(n-k)+j&&(e=!e)}return e}(a[0],c))return a.push(b),!0})||a.push([b])}),t=[],a.length?a.length>1?{type:"MultiPolygon",coordinates:a}:{type:"Polygon",coordinates:a[0]}:null}},x={Point:u,MultiPoint:u,LineString:v,MultiLineString:v,Polygon:w,MultiPolygon:w,Sphere:w},y=1e-6,z=y*y,A=Math.PI,B=A/2,C=(Math.sqrt(A),A/180),D=180/A,E=a.geo.projection,F=a.geo.projectionMutator;a.geo.interrupt=function(b){function c(a,c){for(var d=c<0?-1:1,e=g[+(c<0)],f=0,h=e.length-1;f<h&&a>e[f][2][0];++f);var i=b(a-e[f][1][0],c);return i[0]+=b(e[f][1][0],d*c>d*e[f][0][1]?e[f][0][1]:c)[0],i}function d(a,b){for(var c,d,e,f=-1,g=a.length,h=a[0],i=[];++f<g;){d=((c=a[f])[0]-h[0])/b,e=(c[1]-h[1])/b;for(var j=0;j<b;++j)i.push([h[0]+j*d,h[1]+j*e]);h=c}return i.push(c),i}function e(a,b){return Math.abs(a[0]-b[0])<y&&Math.abs(a[1]-b[1])<y}var f,g=[[[[-A,0],[0,B],[A,0]]],[[[-A,0],[0,-B],[A,0]]]];b.invert&&(c.invert=function(a,d){for(var h=f[+(d<0)],i=g[+(d<0)],j=0,k=h.length;j<k;++j){var l=h[j];if(l[0][0]<=a&&a<l[1][0]&&l[0][1]<=d&&d<l[1][1]){var m=b.invert(a-b(i[j][1][0],0)[0],d);return m[0]+=i[j][1][0],e(c(m[0],m[1]),[a,d])?m:null}}});var h=a.geo.projection(c),i=h.stream;return h.stream=function(b){var c=h.rotate(),e=i(b),f=(h.rotate([0,0]),i(b));return h.rotate(c),e.sphere=function(){a.geo.stream(function(){for(var b=1e-6,c=[],e=0,f=g[0].length;e<f;++e){var h=g[0][e],i=180*h[0][0]/A,j=180*h[0][1]/A,k=180*h[1][1]/A,l=180*h[2][0]/A,m=180*h[2][1]/A;c.push(d([[i+b,j+b],[i+b,k-b],[l-b,k-b],[l-b,m+b]],30))}for(var e=g[1].length-1;e>=0;--e){var h=g[1][e],i=180*h[0][0]/A,j=180*h[0][1]/A,k=180*h[1][1]/A,l=180*h[2][0]/A,m=180*h[2][1]/A;c.push(d([[l-b,m-b],[l-b,k+b],[i+b,k+b],[i+b,j-b]],30))}return{type:"Polygon",coordinates:[a.merge(c)]}}(),f)},e},h.lobes=function(a){return arguments.length?(g=a.map(function(a){return a.map(function(a){return[[a[0][0]*A/180,a[0][1]*A/180],[a[1][0]*A/180,a[1][1]*A/180],[a[2][0]*A/180,a[2][1]*A/180]]})}),f=g.map(function(a){return a.map(function(a){var c,d=b(a[0][0],a[0][1])[0],e=b(a[2][0],a[2][1])[0],f=b(a[1][0],a[0][1])[1],g=b(a[1][0],a[1][1])[1];return f>g&&(c=f,f=g,g=c),[[d,f],[e,g]]})}),h):g.map(function(a){return a.map(function(a){return[[180*a[0][0]/A,180*a[0][1]/A],[180*a[1][0]/A,180*a[1][1]/A],[180*a[2][0]/A,180*a[2][1]/A]]})})},h},g.invert=function(a,b){var c=.5*b*Math.sqrt((4+A)/A),d=e(c),f=Math.cos(d);return[a/(2/Math.sqrt(A*(4+A))*(1+f)),e((d+c*(f+2))/(2+B))]},(a.geo.eckert4=function(){return E(g)}).raw=g;var G=a.geo.azimuthalEqualArea.raw;i.invert=function(a,b){var c=2*e(b/2);return[a*Math.cos(c/2)/Math.cos(c),c]},(a.geo.hammer=function(){var a=2,b=F(h),c=b(a);return c.coefficient=function(c){return arguments.length?b(a=+c):a},c}).raw=h,j.invert=function(a,b){return[2/3*A*a/Math.sqrt(A*A/3-b*b),b]},(a.geo.kavrayskiy7=function(){return E(j)}).raw=j,k.invert=function(a,b){return[a,2.5*Math.atan(Math.exp(.8*b))-.625*A]},(a.geo.miller=function(){return E(k)}).raw=k,l(A);var H=function(a,b,c){function d(c,d){return[a*c*Math.cos(d=f(d)),b*Math.sin(d)]}var f=l(c);return d.invert=function(d,f){var g=e(f/b);return[d/(a*Math.cos(g)),e((2*g+Math.sin(2*g))/c)]},d}(Math.SQRT2/B,Math.SQRT2,A);(a.geo.mollweide=function(){return E(H)}).raw=H,m.invert=function(a,b){var c,d=b,e=25;do{var f=d*d,g=f*f;d-=c=(d*(1.007226+f*(.015085+g*(.028874*f-.044475-.005916*g)))-b)/(1.007226+f*(.045255+g*(.259866*f-.311325-.005916*11*g)))}while(Math.abs(c)>y&&--e>0);return[a/(.8707+(f=d*d)*(f*(f*f*f*(.003971-.001529*f)-.013791)-.131979)),d]},(a.geo.naturalEarth=function(){return E(m)}).raw=m;var I=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];I.forEach(function(a){a[1]*=1.0144}),n.invert=function(a,b){var c=b/B,d=90*c,e=Math.min(18,Math.abs(d/5)),f=Math.max(0,Math.floor(e));do{var g=I[f][1],h=I[f+1][1],i=I[Math.min(19,f+2)][1],j=i-g,k=i-2*h+g,l=2*(Math.abs(c)-h)/j,m=k/j,n=l*(1-m*l*(1-2*m*l));if(n>=0||1===f){d=(b>=0?5:-5)*(n+e);var o,p=50;do{n=(e=Math.min(18,Math.abs(d)/5))-(f=Math.floor(e)),g=I[f][1],h=I[f+1][1],i=I[Math.min(19,f+2)][1],d-=(o=(b>=0?B:-B)*(h+n*(i-g)/2+n*n*(i-2*h+g)/2)-b)*D}while(Math.abs(o)>z&&--p>0);break}}while(--f>=0);var q=I[f][0],r=I[f+1][0],s=I[Math.min(19,f+2)][0];return[a/(r+n*(s-q)/2+n*n*(s-2*r+q)/2),d*C]},(a.geo.robinson=function(){return E(n)}).raw=n,o.invert=function(a,b){return[a/Math.cos(b),b]},(a.geo.sinusoidal=function(){return E(o)}).raw=o,p.invert=function(a,b){if(!(a*a+4*b*b>A*A+y)){var c=a,d=b,e=25;do{var g,h=Math.sin(c),i=Math.sin(c/2),j=Math.cos(c/2),k=Math.sin(d),l=Math.cos(d),m=Math.sin(2*d),n=k*k,o=l*l,p=i*i,q=1-o*j*j,r=q?f(l*j)*Math.sqrt(g=1/q):g=0,s=2*r*l*i-a,t=r*k-b,u=g*(o*p+r*l*j*n),v=g*(.5*h*m-2*r*k*i),w=.25*g*(m*i-r*k*o*h),x=g*(n*j+r*p*l),z=v*w-x*u;if(!z)break;var B=(t*v-s*x)/z,C=(s*w-t*u)/z;c-=B,d-=C}while((Math.abs(B)>y||Math.abs(C)>y)&&--e>0);return[c,d]}},(a.geo.aitoff=function(){return E(p)}).raw=p,q.invert=function(a,b){var c=a,d=b,e=25;do{var g,h=Math.cos(d),i=Math.sin(d),j=Math.sin(2*d),k=i*i,l=h*h,m=Math.sin(c),n=Math.cos(c/2),o=Math.sin(c/2),p=o*o,q=1-l*n*n,r=q?f(h*n)*Math.sqrt(g=1/q):g=0,s=.5*(2*r*h*o+c/B)-a,t=.5*(r*i+d)-b,u=.5*g*(l*p+r*h*n*k)+.5/B,v=g*(m*j/4-r*i*o),w=.125*g*(j*o-r*i*l*m),x=.5*g*(k*n+r*p*h)+.5,z=v*w-x*u,A=(t*v-s*x)/z,C=(s*w-t*u)/z;c-=A,d-=C}while((Math.abs(A)>y||Math.abs(C)>y)&&--e>0);return[c,d]},(a.geo.winkel3=function(){return E(q)}).raw=q}},{}],801:[function(a,b,c){"use strict";function d(a,b){return n.behavior.zoom().translate(b.translate()).scale(b.scale())}function e(a,b,c){function d(a,b){k[e+"."+a]=o.nestedProperty(h,a).get(),p.call("_storeDirectGUIEdit",g,i._preGUI,k);var c=o.nestedProperty(j,a);c.get()!==b&&(c.set(b),o.nestedProperty(h,a).set(b),l[e+"."+a]=b)}var e=a.id,f=a.graphDiv,g=f.layout,h=g[e],i=f._fullLayout,j=i[e],k={},l={};c(d),d("projection.scale",b.scale()/a.fitScale),f.emit("plotly_relayout",l)}function f(a,b){function c(c){var d=b.invert(a.midPt);c("center.lon",d[0]),c("center.lat",d[1])}var f=d(0,b);return f.on("zoomstart",function(){n.select(this).style(s)}).on("zoom",function(){b.scale(n.event.scale).translate(n.event.translate),a.render();var c=b.invert(a.midPt);a.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":b.scale()/a.fitScale,"geo.center.lon":c[0],"geo.center.lat":c[1]})}).on("zoomend",function(){n.select(this).style(t),e(a,b,c)}),f}function g(a,b){function c(a){return b.invert(a)}function f(c){var d=b.rotate(),e=b.invert(a.midPt);c("projection.rotation.lon",-d[0]),c("center.lon",e[0]),c("center.lat",e[1])}var g,h,i,j,k,l,m,o,p,q=d(0,b);return q.on("zoomstart",function(){n.select(this).style(s),g=n.mouse(this),h=b.rotate(),i=b.translate(),j=h,k=c(g)}).on("zoom",function(){if(l=n.mouse(this),function(a){var d=c(a);if(!d)return!0;var e=b(d);return Math.abs(e[0]-a[0])>2||Math.abs(e[1]-a[1])>2}(g))return q.scale(b.scale()),void q.translate(b.translate());b.scale(n.event.scale),b.translate([i[0],n.event.translate[1]]),k?c(l)&&(o=c(l),m=[j[0]+(o[0]-k[0]),h[1],h[2]],b.rotate(m),j=m):k=c(g=l),p=!0,a.render();var d=b.rotate(),e=b.invert(a.midPt);a.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":b.scale()/a.fitScale,"geo.center.lon":e[0],"geo.center.lat":e[1],"geo.projection.rotation.lon":-d[0]})}).on("zoomend",function(){n.select(this).style(t),p&&e(a,b,f)}),q}function h(a,b){function c(a){var c=b.rotate();a("projection.rotation.lon",-c[0]),a("projection.rotation.lat",-c[1])}var f,g={r:b.rotate(),k:b.scale()},h=d(0,b),k=function(a){for(var b=0,c=arguments.length,d=[];++b<c;)d.push(arguments[b]);var e=n.dispatch.apply(null,d);return e.of=function(b,c){return function(d){var f;try{f=d.sourceEvent=n.event,d.target=a,n.event=d,e[d.type].apply(b,c)}finally{n.event=f}}},e}(h,"zoomstart","zoom","zoomend"),o=0,p=h.on;return h.on("zoomstart",function(){n.select(this).style(s);var a,c,d,e,t,u,v,w,x,y,z,A=n.mouse(this),B=b.rotate(),C=B,D=b.translate(),E=(c=.5*(a=B)[0]*q,d=.5*a[1]*q,e=.5*a[2]*q,t=Math.sin(c),u=Math.cos(c),v=Math.sin(d),w=Math.cos(d),x=Math.sin(e),y=Math.cos(e),[u*w*y+t*v*x,t*w*y-u*v*x,u*v*y+t*w*x,u*w*x-t*v*y]);f=i(b,A),p.call(h,"zoom",function(){var a,c,d,e,h,o,p,q,s,t,u=n.mouse(this);if(b.scale(g.k=n.event.scale),f){if(i(b,u)){b.rotate(B).translate(D);var v=i(b,u),w=function(a,b){if(a&&b){var c=function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}(a,b),d=Math.sqrt(m(c,c)),e=.5*Math.acos(Math.max(-1,Math.min(1,m(a,b)))),f=Math.sin(e)/d;return d&&[Math.cos(e),c[2]*f,-c[1]*f,c[0]*f]}}(f,v),x=function(a){return[Math.atan2(2*(a[0]*a[1]+a[2]*a[3]),1-2*(a[1]*a[1]+a[2]*a[2]))*r,Math.asin(Math.max(-1,Math.min(1,2*(a[0]*a[2]-a[3]*a[1]))))*r,Math.atan2(2*(a[0]*a[3]+a[1]*a[2]),1-2*(a[2]*a[2]+a[3]*a[3]))*r]}((c=w,d=(a=E)[0],e=a[1],h=a[2],o=a[3],p=c[0],q=c[1],s=c[2],t=c[3],[d*p-e*q-h*s-o*t,d*q+e*p+h*t-o*s,d*s-e*t+h*p+o*q,d*t+e*s-h*q+o*p])),y=g.r=function(a,b,c){var d=l(b,2,a[0]);d=l(d,1,a[1]),d=l(d,0,a[2]-c[2]);var e,f,g=b[0],h=b[1],i=b[2],k=d[0],m=d[1],n=d[2],o=Math.atan2(h,g)*r,p=Math.sqrt(g*g+h*h);Math.abs(m)>p?(f=(m>0?90:-90)-o,e=0):(f=Math.asin(m/p)*r-o,e=Math.sqrt(p*p-m*m));var q=180-f-2*o,s=(Math.atan2(n,k)-Math.atan2(i,e))*r,t=(Math.atan2(n,k)-Math.atan2(i,-e))*r;return j(c[0],c[1],f,s)<=j(c[0],c[1],q,t)?[f,s,c[2]]:[q,t,c[2]]}(x,f,C);isFinite(y[0])&&isFinite(y[1])&&isFinite(y[2])||(y=C),b.rotate(y),C=y}}else f=i(b,A=u);k.of(this,arguments)({type:"zoom"})}),z=k.of(this,arguments),o++||z({type:"zoomstart"})}).on("zoomend",function(){var d;n.select(this).style(t),p.call(h,"zoom",null),d=k.of(this,arguments),--o||d({type:"zoomend"}),e(a,b,c)}).on("zoom.redraw",function(){a.render();var c=b.rotate();a.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":b.scale()/a.fitScale,"geo.projection.rotation.lon":-c[0],"geo.projection.rotation.lat":-c[1]})}),n.rebind(h,k,"on")}function i(a,b){var c=a.invert(b);return c&&isFinite(c[0])&&isFinite(c[1])&&function(a){var b=a[0]*q,c=a[1]*q,d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}(c)}function j(a,b,c,d){var e=k(c-a),f=k(d-b);return Math.sqrt(e*e+f*f)}function k(a){return(a%360+540)%360-180}function l(a,b,c){var d=c*q,e=a.slice(),f=0===b?1:0,g=2===b?1:2,h=Math.cos(d),i=Math.sin(d);return e[f]=a[f]*h-a[g]*i,e[g]=a[g]*h+a[f]*i,e}function m(a,b){for(var c=0,d=0,e=a.length;d<e;++d)c+=a[d]*b[d];return c}var n=a("d3"),o=a("../../lib"),p=a("../../registry"),q=Math.PI/180,r=180/Math.PI,s={cursor:"pointer"},t={cursor:"auto"};b.exports=function(a,b){var c=a.projection;return(b._isScoped?f:b._isClipped?h:g)(a,c)}},{"../../lib":719,"../../registry":848,d3:164}],802:[function(a,b,c){"use strict";var d=a("../registry"),e=a("./cartesian/constants").SUBPLOT_PATTERN;c.getSubplotCalcData=function(a,b,c){var e=d.subplotsRegistry[b];if(!e)return[];for(var f=e.attr,g=[],h=0;h<a.length;h++){var i=a[h];i[0].trace[f]===c&&g.push(i)}return g},c.getModuleCalcData=function(a,b){var c,e=[],f=[];if(!(c="string"==typeof b?d.getModule(b).plot:"function"==typeof b?b:b.plot))return[e,a];for(var g=0;g<a.length;g++){var h=a[g],i=h[0].trace;!0===i.visible&&0!==i._length&&(i._module.plot===c?e.push(h):f.push(h))}return[e,f]},c.getSubplotData=function(a,b,c){if(!d.subplotsRegistry[b])return[];var f,g,h,i=d.subplotsRegistry[b].attr,j=[];if("gl2d"===b){var k=c.match(e);g="x"+k[1],h="y"+k[2]}for(var l=0;l<a.length;l++)f=a[l],"gl2d"===b&&d.traceIs(f,"gl2d")?f[i[0]]===g&&f[i[1]]===h&&j.push(f):f[i]===c&&j.push(f);return j}},{"../registry":848,"./cartesian/constants":773}],803:[function(a,b,c){"use strict";function d(a,b){this.element=a,this.plot=b,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}var e=a("mouse-change"),f=a("mouse-wheel"),g=a("mouse-event-offset"),h=a("../cartesian/constants"),i=a("has-passive-events");b.exports=function(a){function b(){a.xaxis.autorange=!1,a.yaxis.autorange=!1}function c(c,d,e){function f(b,c,d){var e=Math.min(c,d),f=Math.max(c,d);e!==f?(j[b]=e,j[b+2]=f,l.dataBox=j,a.setRanges(j)):(a.selectBox.selectBox=[0,0,1,1],a.glplot.setDirty())}var g,i,j=a.calcDataBox(),m=k.viewBox,n=l.lastPos[0],o=l.lastPos[1],p=h.MINDRAG*k.pixelRatio,q=h.MINZOOM*k.pixelRatio;switch(d*=k.pixelRatio,e*=k.pixelRatio,e=m[3]-m[1]-e,a.fullLayout.dragmode){case"zoom":if(c){var r=d/(m[2]-m[0])*(j[2]-j[0])+j[0],s=e/(m[3]-m[1])*(j[3]-j[1])+j[1];l.boxInited||(l.boxStart[0]=r,l.boxStart[1]=s,l.dragStart[0]=d,l.dragStart[1]=e),l.boxEnd[0]=r,l.boxEnd[1]=s,l.boxInited=!0,l.boxEnabled||l.boxStart[0]===l.boxEnd[0]&&l.boxStart[1]===l.boxEnd[1]||(l.boxEnabled=!0);var t=Math.abs(l.dragStart[0]-d)<q,u=Math.abs(l.dragStart[1]-e)<q;if(!function(){for(var b=a.graphDiv._fullLayout._axisConstraintGroups,c=a.xaxis._id,d=a.yaxis._id,e=0;e<b.length;e++)if(-1!==b[e][c]){if(-1!==b[e][d])return!0;break}return!1}()||t&&u)t&&(l.boxEnd[0]=l.boxStart[0]),u&&(l.boxEnd[1]=l.boxStart[1]);else{g=l.boxEnd[0]-l.boxStart[0],i=l.boxEnd[1]-l.boxStart[1];var v=(j[3]-j[1])/(j[2]-j[0]);Math.abs(g*v)>Math.abs(i)?(l.boxEnd[1]=l.boxStart[1]+Math.abs(g)*v*(i>=0?1:-1),l.boxEnd[1]<j[1]?(l.boxEnd[1]=j[1],l.boxEnd[0]=l.boxStart[0]+(j[1]-l.boxStart[1])/Math.abs(v)):l.boxEnd[1]>j[3]&&(l.boxEnd[1]=j[3],l.boxEnd[0]=l.boxStart[0]+(j[3]-l.boxStart[1])/Math.abs(v))):(l.boxEnd[0]=l.boxStart[0]+Math.abs(i)/v*(g>=0?1:-1),l.boxEnd[0]<j[0]?(l.boxEnd[0]=j[0],l.boxEnd[1]=l.boxStart[1]+(j[0]-l.boxStart[0])*Math.abs(v)):l.boxEnd[0]>j[2]&&(l.boxEnd[0]=j[2],l.boxEnd[1]=l.boxStart[1]+(j[2]-l.boxStart[0])*Math.abs(v)))}}else l.boxEnabled?(g=l.boxStart[0]!==l.boxEnd[0],i=l.boxStart[1]!==l.boxEnd[1],g||i?(g&&(f(0,l.boxStart[0],l.boxEnd[0]),a.xaxis.autorange=!1),i&&(f(1,l.boxStart[1],l.boxEnd[1]),a.yaxis.autorange=!1),a.relayoutCallback()):a.glplot.setDirty(),l.boxEnabled=!1,l.boxInited=!1):l.boxInited&&(l.boxInited=!1);break;case"pan":l.boxEnabled=!1,l.boxInited=!1,c?(l.panning||(l.dragStart[0]=d,l.dragStart[1]=e),Math.abs(l.dragStart[0]-d)<p&&(d=l.dragStart[0]),Math.abs(l.dragStart[1]-e)<p&&(e=l.dragStart[1]),g=(n-d)*(j[2]-j[0])/(k.viewBox[2]-k.viewBox[0]),i=(o-e)*(j[3]-j[1])/(k.viewBox[3]-k.viewBox[1]),j[0]+=g,j[2]+=g,j[1]+=i,j[3]+=i,a.setRanges(j),l.panning=!0,l.lastInputTime=Date.now(),b(),a.cameraChanged(),a.handleAnnotations()):l.panning&&(l.panning=!1,a.relayoutCallback())}l.lastPos[0]=d,l.lastPos[1]=e}var j=a.mouseContainer,k=a.glplot,l=new d(j,k);return l.mouseListener=e(j,c),j.addEventListener("touchstart",function(a){var b=g(a.changedTouches[0],j);c(0,b[0],b[1]),c(1,b[0],b[1]),a.preventDefault()},!!i&&{passive:!1}),j.addEventListener("touchmove",function(a){a.preventDefault();var b=g(a.changedTouches[0],j);c(1,b[0],b[1]),a.preventDefault()},!!i&&{passive:!1}),j.addEventListener("touchend",function(a){c(0,l.lastPos[0],l.lastPos[1]),a.preventDefault()},!!i&&{passive:!1}),l.wheelListener=f(j,function(c,d){if(!a.scrollZoom)return!1;var e=a.calcDataBox(),f=k.viewBox,g=l.lastPos[0],h=l.lastPos[1],i=Math.exp(5*d/(f[3]-f[1])),j=g/(f[2]-f[0])*(e[2]-e[0])+e[0],m=h/(f[3]-f[1])*(e[3]-e[1])+e[1];return e[0]=(e[0]-j)*i+j,e[2]=(e[2]-j)*i+j,e[1]=(e[1]-m)*i+m,e[3]=(e[3]-m)*i+m,a.setRanges(e),l.lastInputTime=Date.now(),b(),a.cameraChanged(),a.handleAnnotations(),a.relayoutCallback(),!0},!0),l}},{"../cartesian/constants":773,"has-passive-events":412,"mouse-change":436,"mouse-event-offset":437,"mouse-wheel":439}],804:[function(a,b,c){"use strict";function d(a){this.scene=a,this.gl=a.gl,this.pixelRatio=a.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var e=a("../cartesian/axes"),f=a("../../lib/str2rgbarray"),g=d.prototype,h=["xaxis","yaxis"];g.merge=function(a){var b,c,d,e,g,i,j,k,l,m,n;for(this.titleEnable=!1,this.backgroundColor=f(a.plot_bgcolor),m=0;m<2;++m){var o=(b=h[m]).charAt(0);for(d=(c=a[this.scene[b]._name]).title.text===this.scene.fullLayout._dfltTitle[o]?"":c.title.text,n=0;n<=2;n+=2)this.labelEnable[m+n]=!1,this.labels[m+n]=d,this.labelColor[m+n]=f(c.title.font.color),this.labelFont[m+n]=c.title.font.family,this.labelSize[m+n]=c.title.font.size,this.labelPad[m+n]=this.getLabelPad(b,c),this.tickEnable[m+n]=!1,
this.tickColor[m+n]=f((c.tickfont||{}).color),this.tickAngle[m+n]="auto"===c.tickangle?0:Math.PI*-c.tickangle/180,this.tickPad[m+n]=this.getTickPad(c),this.tickMarkLength[m+n]=0,this.tickMarkWidth[m+n]=c.tickwidth||0,this.tickMarkColor[m+n]=f(c.tickcolor),this.borderLineEnable[m+n]=!1,this.borderLineColor[m+n]=f(c.linecolor),this.borderLineWidth[m+n]=c.linewidth||0;j=this.hasSharedAxis(c),g=this.hasAxisInDfltPos(b,c)&&!j,i=this.hasAxisInAltrPos(b,c)&&!j,e=c.mirror||!1,k=j?-1!==String(e).indexOf("all"):!!e,l=j?"allticks"===e:-1!==String(e).indexOf("ticks"),g?this.labelEnable[m]=!0:i&&(this.labelEnable[m+2]=!0),g?this.tickEnable[m]=c.showticklabels:i&&(this.tickEnable[m+2]=c.showticklabels),(g||k)&&(this.borderLineEnable[m]=c.showline),(i||k)&&(this.borderLineEnable[m+2]=c.showline),(g||l)&&(this.tickMarkLength[m]=this.getTickMarkLength(c)),(i||l)&&(this.tickMarkLength[m+2]=this.getTickMarkLength(c)),this.gridLineEnable[m]=c.showgrid,this.gridLineColor[m]=f(c.gridcolor),this.gridLineWidth[m]=c.gridwidth,this.zeroLineEnable[m]=c.zeroline,this.zeroLineColor[m]=f(c.zerolinecolor),this.zeroLineWidth[m]=c.zerolinewidth}},g.hasSharedAxis=function(a){var b=this.scene,c=b.fullLayout._subplots.gl2d;return 0!==e.findSubplotsWithAxis(c,a).indexOf(b.id)},g.hasAxisInDfltPos=function(a,b){var c=b.side;return"xaxis"===a?"bottom"===c:"yaxis"===a?"left"===c:void 0},g.hasAxisInAltrPos=function(a,b){var c=b.side;return"xaxis"===a?"top"===c:"yaxis"===a?"right"===c:void 0},g.getLabelPad=function(a,b){var c=b.title.font.size,d=b.showticklabels;return"xaxis"===a?"top"===b.side?c*(1.5+(d?1:0))-10:c*(1.5+(d?.5:0))-10:"yaxis"===a?"right"===b.side?10+c*(1.5+(d?1:.5)):10+c*(1.5+(d?.5:0)):void 0},g.getTickPad=function(a){return"outside"===a.ticks?10+a.ticklen:15},g.getTickMarkLength=function(a){if(!a.ticks)return 0;var b=a.ticklen;return"inside"===a.ticks?-b:b},b.exports=function(a){return new d(a)}},{"../../lib/str2rgbarray":742,"../cartesian/axes":767}],805:[function(a,b,c){"use strict";var d=a("../../plot_api/edit_types").overrideAll,e=a("./scene2d"),f=a("../layout_attributes"),g=a("../../constants/xmlns_namespaces"),h=a("../cartesian/constants"),i=a("../cartesian"),j=a("../../components/fx/layout_attributes"),k=a("../get_data").getSubplotData;c.name="gl2d",c.attr=["xaxis","yaxis"],c.idRoot=["x","y"],c.idRegex=h.idRegex,c.attrRegex=h.attrRegex,c.attributes=a("../cartesian/attributes"),c.supplyLayoutDefaults=function(a,b,c){b._has("cartesian")||i.supplyLayoutDefaults(a,b,c)},c.layoutAttrOverrides=d(i.layoutAttributes,"plot","from-root"),c.baseLayoutAttrOverrides=d({plot_bgcolor:f.plot_bgcolor,hoverlabel:j.hoverlabel},"plot","nested"),c.plot=function(a){for(var b=a._fullLayout,c=a._fullData,d=b._subplots.gl2d,f=0;f<d.length;f++){var g=d[f],h=b._plots[g],i=k(c,"gl2d",g),j=h._scene2d;void 0===j&&(j=new e({id:g,graphDiv:a,container:a.querySelector(".gl-container"),staticPlot:a._context.staticPlot,plotGlPixelRatio:a._context.plotGlPixelRatio},b),h._scene2d=j),j.plot(i,a.calcdata,b,a.layout)}},c.clean=function(a,b,c,d){for(var e=d._subplots.gl2d||[],f=0;f<e.length;f++){var g=e[f],h=d._plots[g];h._scene2d&&0===k(a,"gl2d",g).length&&(h._scene2d.destroy(),delete d._plots[g])}i.clean.apply(this,arguments)},c.drawFramework=function(a){a._context.staticPlot||i.drawFramework(a)},c.toSVG=function(a){for(var b=a._fullLayout,c=b._subplots.gl2d,d=0;d<c.length;d++){var e=b._plots[c[d]]._scene2d,f=e.toImage("png");b._glimages.append("svg:image").attr({xmlns:g.svg,"xlink:href":f,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),e.destroy()}},c.updateFx=function(a){for(var b=a._fullLayout,c=b._subplots.gl2d,d=0;d<c.length;d++)b._plots[c[d]]._scene2d.updateFx(b.dragmode)}},{"../../components/fx/layout_attributes":633,"../../constants/xmlns_namespaces":696,"../../plot_api/edit_types":750,"../cartesian":778,"../cartesian/attributes":765,"../cartesian/constants":773,"../get_data":802,"../layout_attributes":819,"./scene2d":806}],806:[function(a,b,c){"use strict";function d(a,b){this.container=a.container,this.graphDiv=a.graphDiv,this.pixelRatio=a.plotGlPixelRatio||window.devicePixelRatio,this.id=a.id,this.staticPlot=!!a.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(b),this.makeFramework(),this.stopped||(this.glplotOptions=n(this),this.glplotOptions.merge(b),this.glplot=j(this.glplotOptions),this.camera=o(this),this.traces={},this.spikes=k(this.glplot),this.selectBox=l(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}var e,f,g=a("../../registry"),h=a("../../plots/cartesian/axes"),i=a("../../components/fx"),j=a("gl-plot2d"),k=a("gl-spikes2d"),l=a("gl-select-box"),m=a("webgl-context"),n=a("./convert"),o=a("./camera"),p=a("../../lib/show_no_webgl_msg"),q=a("../cartesian/constraints"),r=q.enforce,s=q.clean,t=a("../cartesian/autorange").doAutoRange,u=["xaxis","yaxis"],v=a("../cartesian/constants").SUBPLOT_PATTERN;b.exports=d;var w=d.prototype;w.makeFramework=function(){if(this.staticPlot){if(!(f||(e=document.createElement("canvas"),f=m({canvas:e,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=e,this.gl=f}else{var a=this.container.querySelector(".gl-canvas-focus"),b=m({canvas:a,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!b)return p(this),void(this.stopped=!0);this.canvas=a,this.gl=b}var c=this.canvas;c.style.width="100%",c.style.height="100%",c.style.position="absolute",c.style.top="0px",c.style.left="0px",c.style["pointer-events"]="none",this.updateSize(c),c.className+=" user-select-none";var d=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");d.style.position="absolute",d.style.top=d.style.left="0px",d.style.width=d.style.height="100%",d.style["z-index"]=20,d.style["pointer-events"]="none";var g=this.mouseContainer=document.createElement("div");g.style.position="absolute",g.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var h=this.container;h.appendChild(d),h.appendChild(g);var i=this;g.addEventListener("mouseout",function(){i.isMouseOver=!1,i.unhover()}),g.addEventListener("mouseover",function(){i.isMouseOver=!0})},w.toImage=function(a){a||(a="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(e),this.updateSize(this.canvas);var b=this.glplot.gl,c=b.drawingBufferWidth,d=b.drawingBufferHeight;b.clearColor(1,1,1,0),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),b.bindFramebuffer(b.FRAMEBUFFER,null);var f=new Uint8Array(c*d*4);b.readPixels(0,0,c,d,b.RGBA,b.UNSIGNED_BYTE,f);for(var g=0,h=d-1;g<h;++g,--h)for(var i=0;i<c;++i)for(var j=0;j<4;++j){var k=f[4*(c*g+i)+j];f[4*(c*g+i)+j]=f[4*(c*h+i)+j],f[4*(c*h+i)+j]=k}var l=document.createElement("canvas");l.width=c,l.height=d;var m,n=l.getContext("2d"),o=n.createImageData(c,d);switch(o.data.set(f),n.putImageData(o,0,0),a){case"jpeg":m=l.toDataURL("image/jpeg");break;case"webp":m=l.toDataURL("image/webp");break;default:m=l.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(e),m},w.updateSize=function(a){a||(a=this.canvas);var b=this.pixelRatio,c=this.fullLayout,d=c.width,e=c.height,f=0|Math.ceil(b*d),g=0|Math.ceil(b*e);return a.width===f&&a.height===g||(a.width=f,a.height=g),a},w.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var a=[h.calcTicks(this.xaxis),h.calcTicks(this.yaxis)],b=0;b<2;++b)for(var c=0;c<a[b].length;++c)a[b][c].text=a[b][c].text+"";return a},w.updateRefs=function(a){this.fullLayout=a;var b=this.id.match(v),c="xaxis"+b[1],d="yaxis"+b[2];this.xaxis=this.fullLayout[c],this.yaxis=this.fullLayout[d]},w.relayoutCallback=function(){var a=this.graphDiv,b=this.xaxis,c=this.yaxis,d=a.layout,e={},f=e[b._name+".range"]=b.range.slice(),h=e[c._name+".range"]=c.range.slice();e[b._name+".autorange"]=b.autorange,e[c._name+".autorange"]=c.autorange,g.call("_storeDirectGUIEdit",a.layout,a._fullLayout._preGUI,e);var i=d[b._name];i.range=f,i.autorange=b.autorange;var j=d[c._name];j.range=h,j.autorange=c.autorange,e.lastInputTime=this.camera.lastInputTime,a.emit("plotly_relayout",e)},w.cameraChanged=function(){var a=this.camera;this.glplot.setDataBox(this.calcDataBox());var b=this.computeTickMarks();(function(a,b){for(var c=0;c<2;++c){var d=a[c],e=b[c];if(d.length!==e.length)return!0;for(var f=0;f<d.length;++f)if(d[f].x!==e[f].x)return!0}return!1})(b,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=b,this.glplotOptions.dataBox=a.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},w.handleAnnotations=function(){for(var a=this.graphDiv,b=this.fullLayout.annotations,c=0;c<b.length;c++){var d=b[c];d.xref===this.xaxis._id&&d.yref===this.yaxis._id&&g.getComponentMethod("annotations","drawOne")(a,c)}},w.destroy=function(){if(this.glplot){var a=this.traces;a&&Object.keys(a).map(function(b){a[b].dispose(),delete a[b]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},w.plot=function(a,b,c){var d=this.glplot;this.updateRefs(c),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(a,b),this.updateFx(c.dragmode);var e=c.width,f=c.height;this.updateSize(this.canvas);var g=this.glplotOptions;g.merge(c),g.screenBox=[0,0,e,f];var h={_fullLayout:{_axisConstraintGroups:this.graphDiv._fullLayout._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis}};s(h,this.xaxis),s(h,this.yaxis);var i,j,k=c._size,l=this.xaxis.domain,m=this.yaxis.domain;for(g.viewBox=[k.l+l[0]*k.w,k.b+m[0]*k.h,e-k.r-(1-l[1])*k.w,f-k.t-(1-m[1])*k.h],this.mouseContainer.style.width=k.w*(l[1]-l[0])+"px",this.mouseContainer.style.height=k.h*(m[1]-m[0])+"px",this.mouseContainer.height=k.h*(m[1]-m[0]),this.mouseContainer.style.left=k.l+l[0]*k.w+"px",this.mouseContainer.style.top=k.t+(1-m[1])*k.h+"px",j=0;j<2;++j)(i=this[u[j]])._length=g.viewBox[j+2]-g.viewBox[j],t(this.graphDiv,i),i.setScale();r(h),g.ticks=this.computeTickMarks(),g.dataBox=this.calcDataBox(),g.merge(c),d.update(g),this.glplot.draw()},w.calcDataBox=function(){var a=this.xaxis,b=this.yaxis,c=a.range,d=b.range,e=a.r2l,f=b.r2l;return[e(c[0]),f(d[0]),e(c[1]),f(d[1])]},w.setRanges=function(a){var b=this.xaxis,c=this.yaxis,d=b.l2r,e=c.l2r;b.range=[d(a[0]),d(a[2])],c.range=[e(a[1]),e(a[3])]},w.updateTraces=function(a,b){var c,d,e,f=Object.keys(this.traces);this.fullData=a;a:for(c=0;c<f.length;c++){var g=f[c],h=this.traces[g];for(d=0;d<a.length;d++)if((e=a[d]).uid===g&&e.type===h.type)continue a;h.dispose(),delete this.traces[g]}for(c=0;c<a.length;c++){e=a[c];var i=b[c],j=this.traces[e.uid];j?j.update(e,i):(j=e._module.plot(this,e,i),this.traces[e.uid]=j)}this.glplot.objects.sort(function(a,b){return a._trace.index-b._trace.index})},w.updateFx=function(a){"lasso"===a||"select"===a?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor="pan"===a?"move":"zoom"===a?"crosshair":null},w.emitPointAction=function(a,b){for(var c,d=a.trace.uid,e=a.pointIndex,f=0;f<this.fullData.length;f++)this.fullData[f].uid===d&&(c=this.fullData[f]);var g={x:a.traceCoord[0],y:a.traceCoord[1],curveNumber:c.index,pointNumber:e,data:c._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};i.appendArrayPointValue(g,c,e),this.graphDiv.emit(b,{points:[g]})},w.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var a=this.glplot,b=this.camera,c=b.mouseListener,d=1===this.lastButtonState&&0===c.buttons,e=this.fullLayout;this.lastButtonState=c.buttons,this.cameraChanged();var f,g=c.x*a.pixelRatio,h=this.canvas.height-a.pixelRatio*c.y;if(b.boxEnabled&&"zoom"===e.dragmode){this.selectBox.enabled=!0;for(var j=this.selectBox.selectBox=[Math.min(b.boxStart[0],b.boxEnd[0]),Math.min(b.boxStart[1],b.boxEnd[1]),Math.max(b.boxStart[0],b.boxEnd[0]),Math.max(b.boxStart[1],b.boxEnd[1])],k=0;k<2;k++)b.boxStart[k]===b.boxEnd[k]&&(j[k]=a.dataBox[k],j[k+2]=a.dataBox[k+2]);a.setDirty()}else if(!b.panning&&this.isMouseOver){this.selectBox.enabled=!1;var l=e._size,m=this.xaxis.domain,n=this.yaxis.domain,o=(f=a.pick(g/a.pixelRatio+l.l+m[0]*l.w,h/a.pixelRatio-(l.t+(1-n[1])*l.h)))&&f.object._trace.handlePick(f);if(o&&d&&this.emitPointAction(o,"plotly_click"),f&&"skip"!==f.object._trace.hoverinfo&&e.hovermode&&o&&(!this.lastPickResult||this.lastPickResult.traceUid!==o.trace.uid||this.lastPickResult.dataCoord[0]!==o.dataCoord[0]||this.lastPickResult.dataCoord[1]!==o.dataCoord[1])){var p=o;this.lastPickResult={traceUid:o.trace?o.trace.uid:null,dataCoord:o.dataCoord.slice()},this.spikes.update({center:f.dataCoord}),p.screenCoord=[((a.viewBox[2]-a.viewBox[0])*(f.dataCoord[0]-a.dataBox[0])/(a.dataBox[2]-a.dataBox[0])+a.viewBox[0])/a.pixelRatio,(this.canvas.height-(a.viewBox[3]-a.viewBox[1])*(f.dataCoord[1]-a.dataBox[1])/(a.dataBox[3]-a.dataBox[1])-a.viewBox[1])/a.pixelRatio],this.emitPointAction(o,"plotly_hover");var q=this.fullData[p.trace.index]||{},r=p.pointIndex,s=i.castHoverinfo(q,e,r);if(s&&"all"!==s){var t=s.split("+");-1===t.indexOf("x")&&(p.traceCoord[0]=void 0),-1===t.indexOf("y")&&(p.traceCoord[1]=void 0),-1===t.indexOf("z")&&(p.traceCoord[2]=void 0),-1===t.indexOf("text")&&(p.textLabel=void 0),-1===t.indexOf("name")&&(p.name=void 0)}i.loneHover({x:p.screenCoord[0],y:p.screenCoord[1],xLabel:this.hoverFormatter("xaxis",p.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",p.traceCoord[1]),zLabel:p.traceCoord[2],text:p.textLabel,name:p.name,color:i.castHoverOption(q,r,"bgcolor")||p.color,borderColor:i.castHoverOption(q,r,"bordercolor"),fontFamily:i.castHoverOption(q,r,"font.family"),fontSize:i.castHoverOption(q,r,"font.size"),fontColor:i.castHoverOption(q,r,"font.color"),nameLength:i.castHoverOption(q,r,"namelength"),textAlign:i.castHoverOption(q,r,"align")},{container:this.svgContainer,gd:this.graphDiv})}}f||this.unhover(),a.draw()}},w.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),i.loneUnhover(this.svgContainer))},w.hoverFormatter=function(a,b){if(void 0!==b){var c=this[a];return h.tickText(c,c.c2l(b),"hover").text}}},{"../../components/fx":632,"../../lib/show_no_webgl_msg":740,"../../plots/cartesian/axes":767,"../../registry":848,"../cartesian/autorange":766,"../cartesian/constants":773,"../cartesian/constraints":774,"./camera":803,"./convert":804,"gl-plot2d":288,"gl-select-box":300,"gl-spikes2d":309,"webgl-context":557}],807:[function(a,b,c){"use strict";var d=a("../../plot_api/edit_types").overrideAll,e=a("../../components/fx/layout_attributes"),f=a("./scene"),g=a("../get_data").getSubplotData,h=a("../../lib"),i=a("../../constants/xmlns_namespaces");c.name="gl3d",c.attr="scene",c.idRoot="scene",c.idRegex=c.attrRegex=h.counterRegex("scene"),c.attributes=a("./layout/attributes"),c.layoutAttributes=a("./layout/layout_attributes"),c.baseLayoutAttrOverrides=d({hoverlabel:e.hoverlabel},"plot","nested"),c.supplyLayoutDefaults=a("./layout/defaults"),c.plot=function(a){for(var b=a._fullLayout,c=a._fullData,d=b._subplots.gl3d,e=0;e<d.length;e++){var h=d[e],i=g(c,"gl3d",h),j=b[h],k=j.camera,l=j._scene;l||(l=new f({id:h,graphDiv:a,container:a.querySelector(".gl-container"),staticPlot:a._context.staticPlot,plotGlPixelRatio:a._context.plotGlPixelRatio,camera:k},b),j._scene=l),l.viewInitial||(l.viewInitial={up:{x:k.up.x,y:k.up.y,z:k.up.z},eye:{x:k.eye.x,y:k.eye.y,z:k.eye.z},center:{x:k.center.x,y:k.center.y,z:k.center.z}}),l.plot(i,b,a.layout)}},c.clean=function(a,b,c,d){for(var e=d._subplots.gl3d||[],f=0;f<e.length;f++){var g=e[f];!b[g]&&d[g]._scene&&(d[g]._scene.destroy(),d._infolayer&&d._infolayer.selectAll(".annotation-"+g).remove())}},c.toSVG=function(a){for(var b=a._fullLayout,c=b._subplots.gl3d,d=b._size,e=0;e<c.length;e++){var f=b[c[e]],g=f.domain,h=f._scene,j=h.toImage("png");b._glimages.append("svg:image").attr({xmlns:i.svg,"xlink:href":j,x:d.l+d.w*g.x[0],y:d.t+d.h*(1-g.y[1]),width:d.w*(g.x[1]-g.x[0]),height:d.h*(g.y[1]-g.y[0]),preserveAspectRatio:"none"}),h.destroy()}},c.cleanId=function(a){if(a.match(/^scene[0-9]*$/)){var b=a.substr(5);return"1"===b&&(b=""),"scene"+b}},c.updateFx=function(a){for(var b=a._fullLayout,c=b._subplots.gl3d,d=0;d<c.length;d++)b[c[d]]._scene.updateFx(b.dragmode,b.hovermode)}},{"../../components/fx/layout_attributes":633,"../../constants/xmlns_namespaces":696,"../../lib":719,"../../plot_api/edit_types":750,"../get_data":802,"./layout/attributes":808,"./layout/defaults":812,"./layout/layout_attributes":813,"./scene":817}],808:[function(a,b,c){"use strict";b.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],809:[function(a,b,c){"use strict";var d=a("../../../components/color"),e=a("../../cartesian/layout_attributes"),f=a("../../../lib/extend").extendFlat,g=a("../../../plot_api/edit_types").overrideAll;b.exports=g({visible:e.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:d.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:e.color,categoryorder:e.categoryorder,categoryarray:e.categoryarray,title:e.title,type:f({},e.type,{values:["-","linear","log","date","category"]}),autorange:e.autorange,rangemode:e.rangemode,range:f({},e.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:e.tickmode,nticks:e.nticks,tick0:e.tick0,dtick:e.dtick,tickvals:e.tickvals,ticktext:e.ticktext,ticks:e.ticks,mirror:e.mirror,ticklen:e.ticklen,tickwidth:e.tickwidth,tickcolor:e.tickcolor,showticklabels:e.showticklabels,tickfont:e.tickfont,tickangle:e.tickangle,tickprefix:e.tickprefix,showtickprefix:e.showtickprefix,ticksuffix:e.ticksuffix,showticksuffix:e.showticksuffix,showexponent:e.showexponent,exponentformat:e.exponentformat,separatethousands:e.separatethousands,tickformat:e.tickformat,tickformatstops:e.tickformatstops,hoverformat:e.hoverformat,showline:e.showline,linecolor:e.linecolor,linewidth:e.linewidth,showgrid:e.showgrid,gridcolor:f({},e.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:e.gridwidth,zeroline:e.zeroline,zerolinecolor:e.zerolinecolor,zerolinewidth:e.zerolinewidth,_deprecated:{title:e._deprecated.title,titlefont:e._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":594,"../../../lib/extend":710,"../../../plot_api/edit_types":750,"../../cartesian/layout_attributes":779}],810:[function(a,b,c){"use strict";var d=a("tinycolor2").mix,e=a("../../../lib"),f=a("../../../plot_api/plot_template"),g=a("./axis_attributes"),h=a("../../cartesian/type_defaults"),i=a("../../cartesian/axis_defaults"),j=["xaxis","yaxis","zaxis"];b.exports=function(a,b,c){function k(a,b){return e.coerce(l,m,g,a,b)}for(var l,m,n=0;n<j.length;n++){var o=j[n];l=a[o]||{},(m=f.newContainer(b,o))._id=o[0]+c.scene,m._name=o,h(l,m,k,c),i(l,m,k,{font:c.font,letter:o[0],data:c.data,showGrid:!0,noTickson:!0,bgColor:c.bgColor,calendar:c.calendar},c.fullLayout),k("gridcolor",d(m.color,c.bgColor,13600/187).toRgbString()),k("title.text",o[0]),m.setScale=e.noop,k("showspikes")&&(k("spikesides"),k("spikethickness"),k("spikecolor",m.color)),k("showaxeslabels"),k("showbackground")&&k("backgroundcolor")}}},{"../../../lib":719,"../../../plot_api/plot_template":757,"../../cartesian/axis_defaults":769,"../../cartesian/type_defaults":790,"./axis_attributes":809,tinycolor2:538}],811:[function(a,b,c){"use strict";function d(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}var e=a("../../../lib/str2rgbarray"),f=a("../../../lib"),g=["xaxis","yaxis","zaxis"];d.prototype.merge=function(a,b){for(var c=0;c<3;++c){var d=b[g[c]];d.visible?(this.labels[c]=a._meta?f.templateString(d.title.text,a._meta):d.title.text,"font"in d.title&&(d.title.font.color&&(this.labelColor[c]=e(d.title.font.color)),d.title.font.family&&(this.labelFont[c]=d.title.font.family),d.title.font.size&&(this.labelSize[c]=d.title.font.size)),"showline"in d&&(this.lineEnable[c]=d.showline),"linecolor"in d&&(this.lineColor[c]=e(d.linecolor)),"linewidth"in d&&(this.lineWidth[c]=d.linewidth),"showgrid"in d&&(this.gridEnable[c]=d.showgrid),"gridcolor"in d&&(this.gridColor[c]=e(d.gridcolor)),"gridwidth"in d&&(this.gridWidth[c]=d.gridwidth),"log"===d.type?this.zeroEnable[c]=!1:"zeroline"in d&&(this.zeroEnable[c]=d.zeroline),"zerolinecolor"in d&&(this.zeroLineColor[c]=e(d.zerolinecolor)),"zerolinewidth"in d&&(this.zeroLineWidth[c]=d.zerolinewidth),"ticks"in d&&d.ticks?this.lineTickEnable[c]=!0:this.lineTickEnable[c]=!1,"ticklen"in d&&(this.lineTickLength[c]=this._defaultLineTickLength[c]=d.ticklen),"tickcolor"in d&&(this.lineTickColor[c]=e(d.tickcolor)),"tickwidth"in d&&(this.lineTickWidth[c]=d.tickwidth),"tickangle"in d&&(this.tickAngle[c]="auto"===d.tickangle?-3600:Math.PI*-d.tickangle/180),"showticklabels"in d&&(this.tickEnable[c]=d.showticklabels),"tickfont"in d&&(d.tickfont.color&&(this.tickColor[c]=e(d.tickfont.color)),d.tickfont.family&&(this.tickFont[c]=d.tickfont.family),d.tickfont.size&&(this.tickSize[c]=d.tickfont.size)),"mirror"in d?-1!==["ticks","all","allticks"].indexOf(d.mirror)?(this.lineTickMirror[c]=!0,this.lineMirror[c]=!0):!0===d.mirror?(this.lineTickMirror[c]=!1,this.lineMirror[c]=!0):(this.lineTickMirror[c]=!1,this.lineMirror[c]=!1):this.lineMirror[c]=!1,"showbackground"in d&&!1!==d.showbackground?(this.backgroundEnable[c]=!0,this.backgroundColor[c]=e(d.backgroundcolor)):this.backgroundEnable[c]=!1):(this.tickEnable[c]=!1,this.labelEnable[c]=!1,this.lineEnable[c]=!1,this.lineTickEnable[c]=!1,this.gridEnable[c]=!1,this.zeroEnable[c]=!1,this.backgroundEnable[c]=!1)}},b.exports=function(a,b){var c=new d;return c.merge(a,b),c}},{"../../../lib":719,"../../../lib/str2rgbarray":742}],812:[function(a,b,c){"use strict";function d(a,b,c,d){for(var e=c("bgcolor"),h=f.combine(e,d.paper_bgcolor),j=["up","center","eye"],m=0;m<j.length;m++)c("camera."+j[m]+".x"),c("camera."+j[m]+".y"),c("camera."+j[m]+".z");c("camera.projection.type");var n=!!c("aspectratio.x")&&!!c("aspectratio.y")&&!!c("aspectratio.z"),o=c("aspectmode",n?"manual":"auto");n||(a.aspectratio=b.aspectratio={x:1,y:1,z:1},"manual"===o&&(b.aspectmode="auto"),a.aspectmode=b.aspectmode);var p=k(d.fullData,l,d.id);i(a,b,{font:d.font,scene:d.id,data:p,bgColor:h,calendar:d.calendar,fullLayout:d.fullLayout}),g.getComponentMethod("annotations3d","handleDefaults")(a,b,d);var q=d.getDfltFromLayout("dragmode");if(!1!==q&&!q)if(q="orbit",a.camera&&a.camera.up){var r=a.camera.up.x,s=a.camera.up.y,t=a.camera.up.z;0!==t&&(r&&s&&t?t/Math.sqrt(r*r+s*s+t*t)>.999&&(q="turntable"):q="turntable")}else q="turntable";c("dragmode",q),c("hovermode",d.getDfltFromLayout("hovermode"))}var e=a("../../../lib"),f=a("../../../components/color"),g=a("../../../registry"),h=a("../../subplot_defaults"),i=a("./axis_defaults"),j=a("./layout_attributes"),k=a("../../get_data").getSubplotData,l="gl3d";b.exports=function(a,b,c){var f=b._basePlotModules.length>1;h(a,b,c,{type:l,attributes:j,handleDefaults:d,fullLayout:b,font:b.font,fullData:c,getDfltFromLayout:function(b){if(!f)return e.validate(a[b],j[b])?a[b]:void 0},paper_bgcolor:b.paper_bgcolor,calendar:b.calendar})}},{"../../../components/color":594,"../../../lib":719,"../../../registry":848,"../../get_data":802,"../../subplot_defaults":842,"./axis_defaults":810,"./layout_attributes":813}],813:[function(a,b,c){"use strict";function d(a,b,c){return{x:{valType:"number",dflt:a,editType:"camera"},y:{valType:"number",dflt:b,editType:"camera"},z:{valType:"number",dflt:c,editType:"camera"},editType:"camera"}}var e=a("./axis_attributes"),f=a("../../domain").attributes,g=a("../../../lib/extend").extendFlat,h=a("../../../lib").counterRegex;b.exports={_arrayAttrRegexps:[h("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:g(d(0,0,1),{}),center:g(d(0,0,0),{}),eye:g(d(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:f({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:e,yaxis:e,zaxis:e,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":719,"../../../lib/extend":710,"../../domain":792,"./axis_attributes":809}],814:[function(a,b,c){"use strict";function d(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}var e=a("../../../lib/str2rgbarray"),f=["xaxis","yaxis","zaxis"];d.prototype.merge=function(a){for(var b=0;b<3;++b){var c=a[f[b]];c.visible?(this.enabled[b]=c.showspikes,this.colors[b]=e(c.spikecolor),this.drawSides[b]=c.spikesides,this.lineWidth[b]=c.spikethickness):(this.enabled[b]=!1,this.drawSides[b]=!1)}},b.exports=function(a){var b=new d;return b.merge(a),b}},{"../../../lib/str2rgbarray":742}],815:[function(a,b,c){"use strict";b.exports=function(a){for(var b=a.axesOptions,c=a.glplot.axesPixels,h=a.fullSceneLayout,i=[[],[],[]],j=0;j<3;++j){var k=h[f[j]];if(k._length=(c[j].hi-c[j].lo)*c[j].pixelsPerDataUnit/a.dataScale[j],Math.abs(k._length)===1/0||isNaN(k._length))i[j]=[];else{k._input_range=k.range.slice(),k.range[0]=c[j].lo/a.dataScale[j],k.range[1]=c[j].hi/a.dataScale[j],k._m=1/(a.dataScale[j]*c[j].pixelsPerDataUnit),k.range[0]===k.range[1]&&(k.range[0]-=1,k.range[1]+=1);var l=k.tickmode;if("auto"===k.tickmode){k.tickmode="linear";var m=k.nticks||e.constrain(k._length/40,4,9);d.autoTicks(k,Math.abs(k.range[1]-k.range[0])/m)}for(var n=d.calcTicks(k),o=0;o<n.length;++o)n[o].x=n[o].x*a.dataScale[j],"date"===k.type&&(n[o].text=n[o].text.replace(/\<br\>/g," "));i[j]=n,k.tickmode=l}}b.ticks=i;for(var j=0;j<3;++j){g[j]=.5*(a.glplot.bounds[0][j]+a.glplot.bounds[1][j]);for(var o=0;o<2;++o)b.bounds[o][j]=a.glplot.bounds[o][j]}a.contourLevels=function(a){for(var b=new Array(3),c=0;c<3;++c){for(var d=a[c],e=new Array(d.length),f=0;f<d.length;++f)e[f]=d[f].x;b[c]=e}return b}(i)};var d=a("../../cartesian/axes"),e=a("../../../lib"),f=["xaxis","yaxis","zaxis"],g=[0,0,0]},{"../../../lib":719,"../../cartesian/axes":767}],816:[function(a,b,c){"use strict";function d(a,b){var c,d,e=[0,0,0,0];for(c=0;c<4;++c)for(d=0;d<4;++d)e[d]+=a[4*c+d]*b[c];return e}b.exports=function(a,b){return d(a.projection,d(a.view,d(a.model,[b[0],b[1],b[2],1])))}},{}],817:[function(a,b,c){"use strict";function d(a,b,c,d){if(a.initializeGLCamera(),!function(a,b,c,d,e){var f={canvas:d,gl:e,container:a.container,axes:a.axesOptions,spikes:a.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:b,pixelRatio:c};if(a.staticMode){if(!(i||(h=document.createElement("canvas"),i=l({canvas:h,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");f.pixelRatio=a.pixelRatio,f.gl=i,f.canvas=h}var g=0;try{a.glplot=k(f)}catch(b){g++;try{a.glplot=k(f)}catch(a){g++}}return g<2}(a,a.camera,b,c,d))return s(a);var e=a.graphDiv,f=function(a){if(!1!==a.fullSceneLayout.dragmode){var b={};b[a.id+".camera"]=g(a.camera),a.saveCamera(e.layout),a.graphDiv.emit("plotly_relayout",b)}};return a.glplot.canvas.addEventListener("mouseup",function(){f(a)}),a.glplot.canvas.addEventListener("wheel",function(){e._context._scrollZoom.gl3d&&f(a)},!!m&&{passive:!1}),a.glplot.canvas.addEventListener("mousemove",function(){if(!1!==a.fullSceneLayout.dragmode&&0!==a.camera.mouseListener.buttons){var b={};b[a.id+".camera"]=g(a.camera),a.graphDiv.emit("plotly_relayouting",b)}}),a.staticMode||a.glplot.canvas.addEventListener("webglcontextlost",function(b){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:b,layer:a.id})},!1),a.glplot.camera=a.camera,a.glplot.oncontextloss=function(){a.recoverContext()},a.glplot.onrender=function(a){function b(b,c){var d=a.fullSceneLayout[b];return p.tickText(d,d.d2l(c),"hover").text}var c,d=a.graphDiv,e=a.svgContainer,f=a.container.getBoundingClientRect(),g=f.width,h=f.height;e.setAttributeNS(null,"viewBox","0 0 "+g+" "+h),e.setAttributeNS(null,"width",g),e.setAttributeNS(null,"height",h),w(a),a.glplot.axes.update(a.axesOptions);for(var i,j=Object.keys(a.traces),k=null,l=a.glplot.selection,m=0;m<j.length;++m)"skip"!==(c=a.traces[j[m]]).data.hoverinfo&&c.handlePick(l)&&(k=c),c.setContourLevels&&c.setContourLevels();if(null!==k){var n=t(a.glplot.cameraParams,l.dataCoordinate);c=k.data;var r,s=d._fullData[c.index],u=l.index,v={xLabel:b("xaxis",l.traceCoordinate[0]),yLabel:b("yaxis",l.traceCoordinate[1]),zLabel:b("zaxis",l.traceCoordinate[2])},x=q.castHoverinfo(s,a.fullLayout,u),y=(x||"").split("+"),z=x&&"all"===x;s.hovertemplate||z||(-1===y.indexOf("x")&&(v.xLabel=void 0),-1===y.indexOf("y")&&(v.yLabel=void 0),-1===y.indexOf("z")&&(v.zLabel=void 0),-1===y.indexOf("text")&&(l.textLabel=void 0),-1===y.indexOf("name")&&(k.name=void 0));var A=[];"cone"===c.type||"streamtube"===c.type?(v.uLabel=b("xaxis",l.traceCoordinate[3]),(z||-1!==y.indexOf("u"))&&A.push("u: "+v.uLabel),v.vLabel=b("yaxis",l.traceCoordinate[4]),(z||-1!==y.indexOf("v"))&&A.push("v: "+v.vLabel),v.wLabel=b("zaxis",l.traceCoordinate[5]),(z||-1!==y.indexOf("w"))&&A.push("w: "+v.wLabel),v.normLabel=l.traceCoordinate[6].toPrecision(3),(z||-1!==y.indexOf("norm"))&&A.push("norm: "+v.normLabel),"streamtube"===c.type&&(v.divergenceLabel=l.traceCoordinate[7].toPrecision(3),(z||-1!==y.indexOf("divergence"))&&A.push("divergence: "+v.divergenceLabel)),l.textLabel&&A.push(l.textLabel),
r=A.join("<br>")):"isosurface"===c.type||"volume"===c.type?(v.valueLabel=p.tickText(a.mockAxis,a.mockAxis.d2l(l.traceCoordinate[3]),"hover").text,A.push("value: "+v.valueLabel),l.textLabel&&A.push(l.textLabel),r=A.join("<br>")):r=l.textLabel;var B={x:l.traceCoordinate[0],y:l.traceCoordinate[1],z:l.traceCoordinate[2],data:s._input,fullData:s,curveNumber:s.index,pointNumber:u};q.appendArrayPointValue(B,s,u),c._module.eventData&&(B=s._module.eventData(B,l,s,{},u));var C={points:[B]};a.fullSceneLayout.hovermode&&q.loneHover({trace:s,x:(.5+.5*n[0]/n[3])*g,y:(.5-.5*n[1]/n[3])*h,xLabel:v.xLabel,yLabel:v.yLabel,zLabel:v.zLabel,text:r,name:k.name,color:q.castHoverOption(s,u,"bgcolor")||k.color,borderColor:q.castHoverOption(s,u,"bordercolor"),fontFamily:q.castHoverOption(s,u,"font.family"),fontSize:q.castHoverOption(s,u,"font.size"),fontColor:q.castHoverOption(s,u,"font.color"),nameLength:q.castHoverOption(s,u,"namelength"),textAlign:q.castHoverOption(s,u,"align"),hovertemplate:o.castOption(s,u,"hovertemplate"),hovertemplateLabels:o.extendFlat({},B,v),eventData:[B]},{container:e,gd:d}),l.buttons&&l.distance<5?d.emit("plotly_click",C):d.emit("plotly_hover",C),i=C}else q.loneUnhover(e),d.emit("plotly_unhover",i);a.drawAnnotations(a)}.bind(null,a),a.traces={},a.make4thDimension(),!0}function e(a,b){var c=document.createElement("div"),e=a.container;this.graphDiv=a.graphDiv;var f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.style.position="absolute",f.style.top=f.style.left="0px",f.style.width=f.style.height="100%",f.style["z-index"]=20,f.style["pointer-events"]="none",c.appendChild(f),this.svgContainer=f,c.id=a.id,c.style.position="absolute",c.style.top=c.style.left="0px",c.style.width=c.style.height="100%",e.appendChild(c),this.fullLayout=b,this.id=a.id||"scene",this.fullSceneLayout=b[this.id],this.plotArgs=[[],{},{}],this.axesOptions=u(b,b[this.id]),this.spikeOptions=v(b[this.id]),this.container=c,this.staticMode=!!a.staticPlot,this.pixelRatio=this.pixelRatio||a.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=n.getComponentMethod("annotations3d","convert"),this.drawAnnotations=n.getComponentMethod("annotations3d","draw"),d(this,this.pixelRatio)}function f(a,b,c){for(var d=a.fullSceneLayout,e=0;e<3;e++){var f=y[e],g=f.charAt(0),h=d[f],i=b[g],j=b[g+"calendar"],k=b["_"+g+"length"];if(o.isArrayOrTypedArray(i))for(var l,m=0;m<(k||i.length);m++)if(o.isArrayOrTypedArray(i[m]))for(var n=0;n<i[m].length;++n)l=h.d2l(i[m][n],0,j),!isNaN(l)&&isFinite(l)&&(c[0][e]=Math.min(c[0][e],l),c[1][e]=Math.max(c[1][e],l));else l=h.d2l(i[m],0,j),!isNaN(l)&&isFinite(l)&&(c[0][e]=Math.min(c[0][e],l),c[1][e]=Math.max(c[1][e],l));else c[0][e]=Math.min(c[0][e],0),c[1][e]=Math.max(c[1][e],k-1)}}function g(a){return{up:{x:a.up[0],y:a.up[1],z:a.up[2]},center:{x:a.center[0],y:a.center[1],z:a.center[2]},eye:{x:a.eye[0],y:a.eye[1],z:a.eye[2]},projection:{type:!0===a._ortho?"orthographic":"perspective"}}}var h,i,j=a("gl-plot3d").createCamera,k=a("gl-plot3d").createScene,l=a("webgl-context"),m=a("has-passive-events"),n=a("../../registry"),o=a("../../lib"),p=a("../../plots/cartesian/axes"),q=a("../../components/fx"),r=a("../../lib/str2rgbarray"),s=a("../../lib/show_no_webgl_msg"),t=a("./project"),u=a("./layout/convert"),v=a("./layout/spikes"),w=a("./layout/tick_marks"),x=e.prototype;x.initializeGLCamera=function(){var a=this.fullSceneLayout.camera,b="orthographic"===a.projection.type;this.camera=j(this.container,{center:[a.center.x,a.center.y,a.center.z],eye:[a.eye.x,a.eye.y,a.eye.z],up:[a.up.x,a.up.y,a.up.z],_ortho:b,zoomMin:.01,zoomMax:100,mode:"orbit"})},x.recoverContext=function(){var a=this,b=this.glplot.gl,c=this.glplot.canvas,e=this.glplot.camera,f=this.glplot.pixelRatio;this.glplot.dispose(),requestAnimationFrame(function g(){b.isContextLost()?requestAnimationFrame(g):d(a,e,f,c)?a.plot.apply(a,a.plotArgs):o.error("Catastrophic and unrecoverable WebGL error. Context lost.")})};var y=["xaxis","yaxis","zaxis"];x.plot=function(a,b,c){if(this.plotArgs=[a,b,c],!this.glplot.contextLost){var d,e,g,h,i,j,k=b[this.id],l=c[this.id];k.bgcolor?this.glplot.clearColor=r(k.bgcolor):this.glplot.clearColor=[0,0,0,0],this.glplot.snapToData=!0,this.fullLayout=b,this.fullSceneLayout=k,this.glplotLayout=k,this.axesOptions.merge(b,k),this.spikeOptions.merge(k),this.setCamera(k.camera),this.updateFx(k.dragmode,k.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.update({}),this.setConvert(i),a?Array.isArray(a)||(a=[a]):a=[];var m=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(g=0;g<a.length;++g)!0===(d=a[g]).visible&&0!==d._length&&f(this,d,m);!function(a,b){for(var c=a.fullSceneLayout,d=c.annotations||[],e=0;e<3;e++)for(var f=y[e],g=f.charAt(0),h=c[f],i=0;i<d.length;i++){var j=d[i];if(j.visible){var k=h.r2l(j[g]);!isNaN(k)&&isFinite(k)&&(b[0][e]=Math.min(b[0][e],k),b[1][e]=Math.max(b[1][e],k))}}}(this,m);var n=[1,1,1];for(h=0;h<3;++h)m[1][h]===m[0][h]?n[h]=1:n[h]=1/(m[1][h]-m[0][h]);for(this.dataScale=n,this.convertAnnotations(this),g=0;g<a.length;++g)!0===(d=a[g]).visible&&0!==d._length&&((e=this.traces[d.uid])?e.data.type===d.type?e.update(d):(e.dispose(),e=d._module.plot(this,d),this.traces[d.uid]=e):(e=d._module.plot(this,d),this.traces[d.uid]=e),e.name=d.name);var o=Object.keys(this.traces);a:for(g=0;g<o.length;++g){for(h=0;h<a.length;++h)if(a[h].uid===o[g]&&!0===a[h].visible&&0!==a[h]._length)continue a;(e=this.traces[o[g]]).dispose(),delete this.traces[o[g]]}this.glplot.objects.sort(function(a,b){return a._trace.data.index-b._trace.data.index});var p=[[0,0,0],[0,0,0]],q=[],s={};for(g=0;g<3;++g){if((j=(i=k[y[g]]).type)in s?(s[j].acc*=n[g],s[j].count+=1):s[j]={acc:n[g],count:1},i.autorange){p[0][g]=1/0,p[1][g]=-1/0;var t=this.glplot.objects,u=this.fullSceneLayout.annotations||[],v=i._name.charAt(0);for(h=0;h<t.length;h++){var w=t[h],x=w.bounds,z=w._trace.data._pad||0;"ErrorBars"===w.constructor.name&&i._lowerLogErrorBound?p[0][g]=Math.min(p[0][g],i._lowerLogErrorBound):p[0][g]=Math.min(p[0][g],x[0][g]/n[g]-z),p[1][g]=Math.max(p[1][g],x[1][g]/n[g]+z)}for(h=0;h<u.length;h++){var A=u[h];if(A.visible){var B=i.r2l(A[v]);p[0][g]=Math.min(p[0][g],B),p[1][g]=Math.max(p[1][g],B)}}if("rangemode"in i&&"tozero"===i.rangemode&&(p[0][g]=Math.min(p[0][g],0),p[1][g]=Math.max(p[1][g],0)),p[0][g]>p[1][g])p[0][g]=-1,p[1][g]=1;else{var C=p[1][g]-p[0][g];p[0][g]-=C/32,p[1][g]+=C/32}if("reversed"===i.autorange){var D=p[0][g];p[0][g]=p[1][g],p[1][g]=D}}else{var E=i.range;p[0][g]=i.r2l(E[0]),p[1][g]=i.r2l(E[1])}p[0][g]===p[1][g]&&(p[0][g]-=1,p[1][g]+=1),q[g]=p[1][g]-p[0][g],this.glplot.bounds[0][g]=p[0][g]*n[g],this.glplot.bounds[1][g]=p[1][g]*n[g]}var F=[1,1,1];for(g=0;g<3;++g){var G=s[j=(i=k[y[g]]).type];F[g]=Math.pow(G.acc,1/G.count)/n[g]}var H;if("auto"===k.aspectmode)H=Math.max.apply(null,F)/Math.min.apply(null,F)<=4?F:[1,1,1];else if("cube"===k.aspectmode)H=[1,1,1];else if("data"===k.aspectmode)H=F;else{if("manual"!==k.aspectmode)throw new Error("scene.js aspectRatio was not one of the enumerated types");var I=k.aspectratio;H=[I.x,I.y,I.z]}k.aspectratio.x=l.aspectratio.x=H[0],k.aspectratio.y=l.aspectratio.y=H[1],k.aspectratio.z=l.aspectratio.z=H[2],this.glplot.aspect=H;var J=k.domain||null,K=b._size||null;if(J&&K){var L=this.container.style;L.position="absolute",L.left=K.l+J.x[0]*K.w+"px",L.top=K.t+(1-J.y[1])*K.h+"px",L.width=K.w*(J.x[1]-J.x[0])+"px",L.height=K.h*(J.y[1]-J.y[0])+"px"}this.glplot.redraw()}},x.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=this.glplot.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},x.getCamera=function(){return this.glplot.camera.view.recalcMatrix(this.camera.view.lastT()),g(this.glplot.camera)},x.setCamera=function(a){var b;this.glplot.camera.lookAt.apply(this,[[(b=a).eye.x,b.eye.y,b.eye.z],[b.center.x,b.center.y,b.center.z],[b.up.x,b.up.y,b.up.z]]);var c="orthographic"===a.projection.type;if(c!==this.glplot.camera._ortho){this.glplot.redraw();var e=this.glplot.pixelRatio,f=this.glplot.clearColor;this.glplot.gl.clearColor(f[0],f[1],f[2],f[3]),this.glplot.gl.clear(this.glplot.gl.DEPTH_BUFFER_BIT|this.glplot.gl.COLOR_BUFFER_BIT),this.glplot.dispose(),d(this,e),this.glplot.camera._ortho=c}},x.saveCamera=function(a){var b=this.fullLayout,c=this.getCamera(),d=o.nestedProperty(a,this.id+".camera"),e=d.get(),f=!1;if(void 0===e)f=!0;else{for(var g=0;g<3;g++)for(var h=0;h<3;h++)if(!function(a,b,c,d){var e=["up","center","eye"],f=["x","y","z"];return b[e[c]]&&a[e[c]][f[d]]===b[e[c]][f[d]]}(c,e,g,h)){f=!0;break}(!e.projection||c.projection&&c.projection.type!==e.projection.type)&&(f=!0)}if(f){var i={};i[this.id+".camera"]=e,n.call("_storeDirectGUIEdit",a,b._preGUI,i),d.set(c),o.nestedProperty(b,this.id+".camera").set(c)}return f},x.updateFx=function(a,b){var c=this.camera;if(c)if("orbit"===a)c.mode="orbit",c.keyBindingMode="rotate";else if("turntable"===a){c.up=[0,0,1],c.mode="turntable",c.keyBindingMode="rotate";var d=this.graphDiv,e=d._fullLayout,f=this.fullSceneLayout.camera,g=f.up.x,h=f.up.y,i=f.up.z;if(i/Math.sqrt(g*g+h*h+i*i)<.999){var j=this.id+".camera.up",k={x:0,y:0,z:1},l={};l[j]=k;var m=d.layout;n.call("_storeDirectGUIEdit",m,e._preGUI,l),f.up=k,o.nestedProperty(m,j).set(k)}}else c.keyBindingMode=a;this.fullSceneLayout.hovermode=b},x.toImage=function(a){a||(a="png"),this.staticMode&&this.container.appendChild(h),this.glplot.redraw();var b=this.glplot.gl,c=b.drawingBufferWidth,d=b.drawingBufferHeight;b.bindFramebuffer(b.FRAMEBUFFER,null);var e=new Uint8Array(c*d*4);b.readPixels(0,0,c,d,b.RGBA,b.UNSIGNED_BYTE,e);for(var f=0,g=d-1;f<g;++f,--g)for(var i=0;i<c;++i)for(var j=0;j<4;++j){var k=e[4*(c*f+i)+j];e[4*(c*f+i)+j]=e[4*(c*g+i)+j],e[4*(c*g+i)+j]=k}var l=document.createElement("canvas");l.width=c,l.height=d;var m,n=l.getContext("2d"),o=n.createImageData(c,d);switch(o.data.set(e),n.putImageData(o,0,0),a){case"jpeg":m=l.toDataURL("image/jpeg");break;case"webp":m=l.toDataURL("image/webp");break;default:m=l.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(h),m},x.setConvert=function(){for(var a=0;a<3;a++){var b=this.fullSceneLayout[y[a]];p.setConvert(b,this.fullLayout),b.setScale=o.noop}},x.make4thDimension=function(){var a=this.graphDiv._fullLayout;this.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},p.setConvert(this.mockAxis,a)},b.exports=e},{"../../components/fx":632,"../../lib":719,"../../lib/show_no_webgl_msg":740,"../../lib/str2rgbarray":742,"../../plots/cartesian/axes":767,"../../registry":848,"./layout/convert":811,"./layout/spikes":814,"./layout/tick_marks":815,"./project":816,"gl-plot3d":291,"has-passive-events":412,"webgl-context":557}],818:[function(a,b,c){"use strict";b.exports=function(a,b,c,d){d=d||a.length;for(var e=new Array(d),f=0;f<d;f++)e[f]=[a[f],b[f],c[f]];return e}},{}],819:[function(a,b,c){"use strict";var d=a("./font_attributes"),e=a("./animation_attributes"),f=a("../components/color/attributes"),g=a("./pad_attributes"),h=a("../lib/extend").extendFlat,i=d({editType:"calc"});i.family.dflt='"Open Sans", verdana, arial, sans-serif',i.size.dflt=12,i.color.dflt=f.defaultLine,b.exports={font:i,title:{text:{valType:"string",editType:"layoutstyle"},font:d({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:h(g({editType:"layoutstyle"}),{}),editType:"layoutstyle"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},paper_bgcolor:{valType:"color",dflt:f.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:f.background,editType:"layoutstyle"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:f.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},modebar:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"modebar"},meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:h({},e.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:d({editType:"layoutstyle"})}}},{"../components/color/attributes":593,"../lib/extend":710,"./animation_attributes":762,"./font_attributes":793,"./pad_attributes":827}],820:[function(a,b,c){"use strict";var d={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:'<a href="http://www.openstreetmap.org/about/" target="_blank"> OpenStreetMap</a>',tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:'<a href="https://carto.com/" target="_blank"> CARTO</a>',tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:'<a href="https://carto.com/" target="_blank"> CARTO</a>',tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},e=Object.keys(d);b.exports={requiredVersion:"1.3.2",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:d,styleValuesNonMapbox:e,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.3.2."].join("\n"),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.plot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join("\n"),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",e.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join("\n"),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join("\n"),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":'content: ""; cursor: pointer; position: absolute; background-image: url(\'data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E\'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;',"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":'display:block; width: 21px; height: 21px; background-image: url(\'data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E\')'}}},{}],821:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b){var c=a.split(" "),e=c[0],f=c[1],g=d.isArrayOrTypedArray(b)?d.mean(b):b,h=.5+g/100,i=1.5+g/100,j=["",""],k=[0,0];switch(e){case"top":j[0]="top",k[1]=-i;break;case"bottom":j[0]="bottom",k[1]=i}switch(f){case"left":j[1]="right",k[0]=-h;break;case"right":j[1]="left",k[0]=h}return{anchor:j[0]&&j[1]?j.join("-"):j[0]?j[0]:j[1]?j[1]:"center",offset:k}}},{"../../lib":719}],822:[function(a,b,c){"use strict";function d(a){return"string"==typeof a&&(-1!==m.styleValuesMapbox.indexOf(a)||0===a.indexOf("mapbox://"))}var e=a("mapbox-gl"),f=a("../../lib"),g=a("../../plots/get_data").getSubplotCalcData,h=a("../../constants/xmlns_namespaces"),i=a("d3"),j=a("../../components/drawing"),k=a("../../lib/svg_text_utils"),l=a("./mapbox"),m=c.constants=a("./constants");c.name="mapbox",c.attr="subplot",c.idRoot="mapbox",c.idRegex=c.attrRegex=f.counterRegex("mapbox"),c.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},c.layoutAttributes=a("./layout_attributes"),c.supplyLayoutDefaults=a("./layout_defaults"),c.plot=function(a){var b=a._fullLayout,c=a.calcdata,h=b._subplots.mapbox;if(e.version!==m.requiredVersion)throw new Error(m.wrongVersionErrorMsg);var i=function(a,b){var c=a._fullLayout;if(""===a._context.mapboxAccessToken)return"";for(var e=[],g=[],h=!1,i=!1,j=0;j<b.length;j++){var k=c[b[j]],l=k.accesstoken;d(k.style)&&(l?f.pushUnique(e,l):(d(k._input.style)&&(f.error("Uses Mapbox map style, but did not set an access token."),h=!0),i=!0)),l&&f.pushUnique(g,l)}if(i){var n=h?m.noAccessTokenErrorMsg:m.missingStyleErrorMsg;throw new Error(n)}return e.length?(e.length>1&&f.warn(m.multipleTokensErrorMsg),e[0]):(g.length&&f.log(["Listed mapbox access token(s)",g.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(a,h);e.accessToken=i;for(var j=0;j<h.length;j++){var k=h[j],n=g(c,"mapbox",k),o=b[k],p=o._subplot;p||(p=new l(a,k),b[k]._subplot=p),p.viewInitial||(p.viewInitial={center:f.extendFlat({},o.center),zoom:o.zoom,bearing:o.bearing,pitch:o.pitch}),p.plot(n,b,a._promises)}},c.clean=function(a,b,c,d){for(var e=d._subplots.mapbox||[],f=0;f<e.length;f++){var g=e[f];!b[g]&&d[g]._subplot&&d[g]._subplot.destroy()}},c.toSVG=function(a){for(var b=a._fullLayout,c=b._subplots.mapbox,d=b._size,e=0;e<c.length;e++){var f=b[c[e]],g=f.domain,l=f._subplot.toImage("png");b._glimages.append("svg:image").attr({xmlns:h.svg,"xlink:href":l,x:d.l+d.w*g.x[0],y:d.t+d.h*(1-g.y[1]),width:d.w*(g.x[1]-g.x[0]),height:d.h*(g.y[1]-g.y[0]),preserveAspectRatio:"none"});var n=i.select(f._subplot.div);if(null!==n.select(".mapboxgl-ctrl-logo").node().offsetParent){var o=b._glimages.append("g");o.attr("transform","translate("+(d.l+d.w*g.x[0]+10)+", "+(d.t+d.h*(1-g.y[0])-31)+")"),o.append("path").attr("d",m.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),o.append("path").attr("d",m.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),o.append("path").attr("d",m.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),o.append("polygon").attr("points",m.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var p=n.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),q=b._glimages.append("g"),r=q.append("text");r.text(p).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":p});var s=j.bBox(r.node()),t=d.w*(g.x[1]-g.x[0]);if(s.width>t/2){var u=p.split("|").join("<br>");r.text(u).attr("data-unformatted",u).call(k.convertToTspans,a),s=j.bBox(r.node())}r.attr("transform","translate(-3, "+(8-s.height)+")"),q.insert("rect",".static-attribution").attr({x:-s.width-6,y:-s.height-3,width:s.width+6,height:s.height+3,fill:"rgba(255, 255, 255, 0.75)"});var v=1;s.width+6>t&&(v=t/(s.width+6));var w=[d.l+d.w*g.x[1],d.t+d.h*(1-g.y[0])];q.attr("transform","translate("+w[0]+","+w[1]+") scale("+v+")")}},c.updateFx=function(a){for(var b=a._fullLayout,c=b._subplots.mapbox,d=0;d<c.length;d++)b[c[d]]._subplot.updateFx(b)}},{"../../components/drawing":615,"../../constants/xmlns_namespaces":696,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/get_data":802,"./constants":820,"./layout_attributes":824,"./layout_defaults":825,"./mapbox":826,d3:164,"mapbox-gl":427}],823:[function(a,b,c){"use strict";function d(a,b){this.subplot=a,this.uid=a.uid+"-"+b,this.index=b,this.idSource="source-"+this.uid,this.idLayer=i.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}function e(a){if(!a.visible)return!1;var b=a.source;if(Array.isArray(b)&&b.length>0){for(var c=0;c<b.length;c++)if("string"!=typeof b[c]||0===b[c].length)return!1;return!0}return g.isPlainObject(b)||"string"==typeof b&&b.length>0}function f(a){var b={},c={};switch(a.type){case"circle":g.extendFlat(c,{"circle-radius":a.circle.radius,"circle-color":a.color,"circle-opacity":a.opacity});break;case"line":g.extendFlat(c,{"line-width":a.line.width,"line-color":a.color,"line-opacity":a.opacity,"line-dasharray":a.line.dash});break;case"fill":g.extendFlat(c,{"fill-color":a.color,"fill-outline-color":a.fill.outlinecolor,"fill-opacity":a.opacity});break;case"symbol":var d=a.symbol,e=h(d.textposition,d.iconsize);g.extendFlat(b,{"icon-image":d.icon+"-15","icon-size":d.iconsize/10,"text-field":d.text,"text-size":d.textfont.size,"text-anchor":e.anchor,"text-offset":e.offset,"symbol-placement":d.placement}),g.extendFlat(c,{"icon-color":a.color,"text-color":d.textfont.color,"text-opacity":a.opacity})}return{layout:b,paint:c}}var g=a("../../lib"),h=a("./convert_text_opts"),i=a("./constants"),j=d.prototype;j.update=function(a){this.visible?this.needsNewSource(a)?(this.removeLayer(),this.updateSource(a),this.updateLayer(a)):this.needsNewLayer(a)?this.updateLayer(a):this.updateStyle(a):(this.updateSource(a),this.updateLayer(a)),this.visible=e(a)},j.needsNewSource=function(a){return this.sourceType!==a.sourcetype||this.source!==a.source||this.layerType!==a.type},j.needsNewLayer=function(a){return this.layerType!==a.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},j.updateSource=function(a){var b=this.subplot.map;if(b.getSource(this.idSource)&&b.removeSource(this.idSource),this.sourceType=a.sourcetype,this.source=a.source,e(a)){var c=function(a){var b,c=a.sourcetype,d=a.source,e={type:c};return"geojson"===c?b="data":"vector"===c?b="string"==typeof d?"url":"tiles":"raster"===c?(b="tiles",e.tileSize=256):"image"===c&&(b="url",e.coordinates=a.coordinates),e[b]=d,a.sourceattribution&&(e.attribution=a.sourceattribution),e}(a);b.addSource(this.idSource,c)}},j.updateLayer=function(a){var b,c=this.subplot,d=f(a),g=this.subplot.belowLookup["layout-"+this.index];if("traces"===g)for(var h=c.getMapLayers(),j=0;j<h.length;j++){var k=h[j].id;if("string"==typeof k&&0===k.indexOf(i.traceLayerPrefix)){b=k;break}}else b=g;this.removeLayer(),e(a)&&c.addLayer({id:this.idLayer,source:this.idSource,"source-layer":a.sourcelayer||"",type:a.type,minzoom:a.minzoom,maxzoom:a.maxzoom,layout:d.layout,paint:d.paint},b),this.layerType=a.type,this.below=g},j.updateStyle=function(a){if(e(a)){var b=f(a);this.subplot.setOptions(this.idLayer,"setLayoutProperty",b.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",b.paint)}},j.removeLayer=function(){var a=this.subplot.map;a.getLayer(this.idLayer)&&a.removeLayer(this.idLayer)},j.dispose=function(){var a=this.subplot.map;a.getLayer(this.idLayer)&&a.removeLayer(this.idLayer),a.getSource(this.idSource)&&a.removeSource(this.idSource)},b.exports=function(a,b,c){var e=new d(a,b);return e.update(c),e}},{"../../lib":719,"./constants":820,"./convert_text_opts":821}],824:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/color").defaultLine,f=a("../domain").attributes,g=a("../font_attributes"),h=a("../../traces/scatter/attributes").textposition,i=a("../../plot_api/edit_types").overrideAll,j=a("../../plot_api/plot_template").templatedArray,k=a("./constants"),l=g({});l.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(b.exports=i({_arrayAttrRegexps:[d.counterRegex("mapbox",".layers",!0)],domain:f({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:k.styleValuesMapbox.concat(k.styleValuesNonMapbox),dflt:k.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:j("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:e},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:e}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],
dflt:"point"},textfont:l,textposition:d.extendFlat({},h,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":594,"../../lib":719,"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../../traces/scatter/attributes":1111,"../domain":792,"../font_attributes":793,"./constants":820}],825:[function(a,b,c){"use strict";function d(a,b,c,d){c("accesstoken",d.accessToken),c("style"),c("center.lon"),c("center.lat"),c("zoom"),c("bearing"),c("pitch"),h(a,b,{name:"layers",handleItemDefaults:e}),b._input=a}function e(a,b){function c(c,d){return f.coerce(a,b,i.layers,c,d)}if(c("visible")){var d,e=c("sourcetype"),g="raster"===e||"image"===e;c("source"),c("sourceattribution"),"vector"===e&&c("sourcelayer"),"image"===e&&c("coordinates"),g&&(d="raster");var h=c("type",d);g&&"raster"!==h&&(h=b.type="raster",f.log("Source types *raster* and *image* must drawn *raster* layer type.")),c("below"),c("color"),c("opacity"),c("minzoom"),c("maxzoom"),"circle"===h&&c("circle.radius"),"line"===h&&(c("line.width"),c("line.dash")),"fill"===h&&c("fill.outlinecolor"),"symbol"===h&&(c("symbol.icon"),c("symbol.iconsize"),c("symbol.text"),f.coerceFont(c,"symbol.textfont"),c("symbol.textposition"),c("symbol.placement"))}}var f=a("../../lib"),g=a("../subplot_defaults"),h=a("../array_container_defaults"),i=a("./layout_attributes");b.exports=function(a,b,c){g(a,b,c,{type:"mapbox",attributes:i,handleDefaults:d,partition:"y",accessToken:b._mapboxAccessToken})}},{"../../lib":719,"../array_container_defaults":763,"../subplot_defaults":842,"./layout_attributes":824}],826:[function(a,b,c){"use strict";function d(a,b){this.id=b,this.gd=a;var c=a._fullLayout,d=a._context;this.container=c._glcontainer.node(),this.isStatic=d.staticPlot,this.uid=c._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(c),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={}}function e(a){var b={};return k.isPlainObject(a)?(b.id=a.id,b.style=a):"string"==typeof a?(b.id=a,-1!==q.styleValuesMapbox.indexOf(a)?b.style=f(a):q.stylesNonMapbox[a]?b.style=q.stylesNonMapbox[a]:b.style=a):(b.id=q.styleValueDflt,b.style=f(q.styleValueDflt)),b.transition={duration:0,delay:0},b}function f(a){return q.styleUrlPrefix+a+"-"+q.styleUrlSuffix}function g(a){return[a.lon,a.lat]}var h=a("mapbox-gl"),i=a("d3"),j=a("../../components/fx"),k=a("../../lib"),l=a("../../registry"),m=a("../cartesian/axes"),n=a("../../components/dragelement"),o=a("../cartesian/select").prepSelect,p=a("../cartesian/select").selectOnClick,q=a("./constants"),r=a("./layers"),s=d.prototype;s.plot=function(a,b,c){var d,e=this,f=b[e.id];e.map&&f.accesstoken!==e.accessToken&&(e.map.remove(),e.map=null,e.styleObj=null,e.traceHash=[],e.layerList={}),d=e.map?new Promise(function(c,d){e.updateMap(a,b,c,d)}):new Promise(function(c,d){e.createMap(a,b,c,d)}),c.push(d)},s.createMap=function(a,b,c,d){var f=this,i=b[f.id],j=f.styleObj=e(i.style);f.accessToken=i.accesstoken;var k=f.map=new h.Map({container:f.div,style:j.style,center:g(i.center),zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,interactive:!f.isStatic,preserveDrawingBuffer:f.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new h.AttributionControl({compact:!0}));k._canvas.style.left="0px",k._canvas.style.top="0px",f.rejectOnError(d),f.isStatic||f.initFx(a,b);var l=[];l.push(new Promise(function(a){k.once("load",a)})),l=l.concat(f.fetchMapData(a,b)),Promise.all(l).then(function(){f.fillBelowLookup(a,b),f.updateData(a),f.updateLayout(b),f.resolveOnRender(c)}).catch(d)},s.fetchMapData=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c][0].trace.geojson;"string"!=typeof d||PlotlyGeoAssets[d]||(PlotlyGeoAssets[d]="pending",b.push(function(a){return new Promise(function(b,c){i.json(a,function(d,e){if(d){delete PlotlyGeoAssets[a];var f=404===d.status?'GeoJSON at URL "'+a+'" does not exist.':"Unexpected error while fetching from "+a;return c(new Error(f))}PlotlyGeoAssets[a]=e,b(e)})})}(d)))}return b},s.updateMap=function(a,b,c,d){var f=this,g=f.map,h=b[this.id];f.rejectOnError(d);var i=[],j=e(h.style);f.styleObj.id!==j.id&&(f.styleObj=j,g.setStyle(j.style),f.traceHash={},i.push(new Promise(function(a){g.once("styledata",a)}))),i=i.concat(f.fetchMapData(a,b)),Promise.all(i).then(function(){f.fillBelowLookup(a,b),f.updateData(a),f.updateLayout(b),f.resolveOnRender(c)}).catch(d)},s.fillBelowLookup=function(a,b){var c,d,e=b[this.id].layers,f=this.belowLookup={},g=!1;for(c=0;c<a.length;c++){var h=a[c][0].trace,i=h._module;"string"==typeof h.below?d=h.below:i.getBelow&&(d=i.getBelow(h,this)),""===d&&(g=!0),f["trace-"+h.uid]=d||""}for(c=0;c<e.length;c++){var j=e[c];d="string"==typeof j.below?j.below:g?"traces":"",f["layout-"+c]=d}var k,l,m={};for(k in f)m[d=f[k]]?m[d].push(k):m[d]=[k];for(d in m){var n=m[d];if(n.length>1)for(c=0;c<n.length;c++)0===(k=n[c]).indexOf("trace-")?(l=k.split("trace-")[1],this.traceHash[l]&&(this.traceHash[l].below=null)):0===k.indexOf("layout-")&&(l=k.split("layout-")[1],this.layerList[l]&&(this.layerList[l].below=null))}};var t={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};s.updateData=function(a){var b,c,d,e,f=this.traceHash,g=a.slice().sort(function(a,b){return t[a[0].trace.type]-t[b[0].trace.type]});for(d=0;d<g.length;d++){var h=g[d];(b=f[(c=h[0].trace).uid])?b.update(h):c._module&&(f[c.uid]=c._module.plot(this,h))}var i=Object.keys(f);a:for(d=0;d<i.length;d++){var j=i[d];for(e=0;e<a.length;e++)if(j===(c=a[e][0].trace).uid)continue a;(b=f[j]).dispose(),delete f[j]}},s.updateLayout=function(a){var b=this.map,c=a[this.id];b.setCenter(g(c.center)),b.setZoom(c.zoom),b.setBearing(c.bearing),b.setPitch(c.pitch),this.updateLayers(a),this.updateFramework(a),this.updateFx(a),this.map.resize(),this.gd._context._scrollZoom.mapbox?b.scrollZoom.enable():b.scrollZoom.disable()},s.resolveOnRender=function(a){var b=this.map;b.on("render",function c(){b.loaded()&&(b.off("render",c),setTimeout(a,10))})},s.rejectOnError=function(a){function b(){a(new Error(q.mapOnErrorMsg))}var c=this.map;c.once("error",b),c.once("style.error",b),c.once("source.error",b),c.once("tile.error",b),c.once("layer.error",b)},s.createFramework=function(a){var b=this,c=b.div=document.createElement("div");c.id=b.uid,c.style.position="absolute",b.container.appendChild(c),b.xaxis={_id:"x",c2p:function(a){return b.project(a).x}},b.yaxis={_id:"y",c2p:function(a){return b.project(a).y}},b.updateFramework(a),b.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},m.setConvert(b.mockAxis,a)},s.initFx=function(a,b){function c(){j.loneUnhover(b._hoverlayer)}function d(){var a=e.getView();f.emit("plotly_relayouting",e.getViewEdits(a))}var e=this,f=e.gd,h=e.map,i=!1;h.on("moveend",function(a){if(e.map){var b=f._fullLayout;if(a.originalEvent||i){var c=b[e.id];l.call("_storeDirectGUIEdit",f.layout,b._preGUI,e.getViewEdits(c));var d=e.getView();c._input.center=c.center=d.center,c._input.zoom=c.zoom=d.zoom,c._input.bearing=c.bearing=d.bearing,c._input.pitch=c.pitch=d.pitch,f.emit("plotly_relayout",e.getViewEdits(d))}i=!1,b._rehover&&b._rehover()}}),h.on("wheel",function(){i=!0}),h.on("mousemove",function(a){var b=e.div.getBoundingClientRect();a.clientX=a.point.x+b.left,a.clientY=a.point.y+b.top,a.target.getBoundingClientRect=function(){return b},e.xaxis.p2c=function(){return a.lngLat.lng},e.yaxis.p2c=function(){return a.lngLat.lat},f._fullLayout._rehover=function(){f._fullLayout._hoversubplot===e.id&&j.hover(f,a,e.id)},j.hover(f,a,e.id),f._fullLayout._hoversubplot=e.id}),h.on("dragstart",c),h.on("zoomstart",c),h.on("mouseout",function(){f._fullLayout._hoversubplot=null}),h.on("drag",d),h.on("zoom",d),h.on("dblclick",function(){var a=f._fullLayout[e.id];l.call("_storeDirectGUIEdit",f.layout,f._fullLayout._preGUI,e.getViewEdits(a));var b=e.viewInitial;h.setCenter(g(b.center)),h.setZoom(b.zoom),h.setBearing(b.bearing),h.setPitch(b.pitch);var c=e.getView();a._input.center=a.center=c.center,a._input.zoom=a.zoom=c.zoom,a._input.bearing=a.bearing=c.bearing,a._input.pitch=a.pitch=c.pitch,f.emit("plotly_doubleclick",null),f.emit("plotly_relayout",e.getViewEdits(c))}),e.clearSelect=function(){f._fullLayout._zoomlayer.selectAll(".select-outline").remove()},e.onClickInPanFn=function(a){return function(b){var c=f._fullLayout.clickmode;c.indexOf("select")>-1&&p(b.originalEvent,f,[e.xaxis],[e.yaxis],e.id,a),c.indexOf("event")>-1&&j.click(f,b.originalEvent)}}},s.updateFx=function(a){function b(a){var b=c.map.unproject(a);return[b.lng,b.lat]}var c=this,d=c.map,e=c.gd;if(!c.isStatic){var f,g=a.dragmode;f="select"===g?function(a,d){(a.range={})[c.id]=[b([d.xmin,d.ymin]),b([d.xmax,d.ymax])]}:function(a,d,e){(a.lassoPoints={})[c.id]=e.filtered.map(b)};var h=c.dragOptions;c.dragOptions=k.extendDeep(h||{},{element:c.div,gd:e,plotinfo:{id:c.id,xaxis:c.xaxis,yaxis:c.yaxis,fillRangeItems:f},xaxes:[c.xaxis],yaxes:[c.yaxis],subplot:c.id}),d.off("click",c.onClickInPanHandler),"select"===g||"lasso"===g?(d.dragPan.disable(),d.on("zoomstart",c.clearSelect),c.dragOptions.prepFn=function(a,b,d){o(a,b,d,c.dragOptions,g)},n.init(c.dragOptions)):(d.dragPan.enable(),d.off("zoomstart",c.clearSelect),c.div.onmousedown=null,c.onClickInPanHandler=c.onClickInPanFn(c.dragOptions),d.on("click",c.onClickInPanHandler))}},s.updateFramework=function(a){var b=a[this.id].domain,c=a._size,d=this.div.style;d.width=c.w*(b.x[1]-b.x[0])+"px",d.height=c.h*(b.y[1]-b.y[0])+"px",d.left=c.l+b.x[0]*c.w+"px",d.top=c.t+(1-b.y[1])*c.h+"px",this.xaxis._offset=c.l+b.x[0]*c.w,this.xaxis._length=c.w*(b.x[1]-b.x[0]),this.yaxis._offset=c.t+(1-b.y[1])*c.h,this.yaxis._length=c.h*(b.y[1]-b.y[0])},s.updateLayers=function(a){var b,c=a[this.id].layers,d=this.layerList;if(c.length!==d.length){for(b=0;b<d.length;b++)d[b].dispose();for(d=this.layerList=[],b=0;b<c.length;b++)d.push(r(this,b,c[b]))}else for(b=0;b<c.length;b++)d[b].update(c[b])},s.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},s.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},s.setOptions=function(a,b,c){for(var d in c)this.map[b](a,d,c[d])},s.getMapLayers=function(){return this.map.getStyle().layers},s.addLayer=function(a,b){var c=this.map;if("string"==typeof b){if(""===b)return void c.addLayer(a,b);for(var d=this.getMapLayers(),e=0;e<d.length;e++)if(b===d[e].id)return void c.addLayer(a,b);k.warn(["Trying to add layer with *below* value",b,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}c.addLayer(a)},s.project=function(a){return this.map.project(new h.LngLat(a[0],a[1]))},s.getView=function(){var a=this.map,b=a.getCenter();return{center:{lon:b.lng,lat:b.lat},zoom:a.getZoom(),bearing:a.getBearing(),pitch:a.getPitch()}},s.getViewEdits=function(a){for(var b=this.id,c=["center","zoom","bearing","pitch"],d={},e=0;e<c.length;e++){var f=c[e];d[b+"."+f]=a[f]}return d},b.exports=d},{"../../components/dragelement":612,"../../components/fx":632,"../../lib":719,"../../registry":848,"../cartesian/axes":767,"../cartesian/select":784,"./constants":820,"./layers":823,d3:164,"mapbox-gl":427}],827:[function(a,b,c){"use strict";b.exports=function(a){var b=a.editType;return{t:{valType:"number",dflt:0,editType:b},r:{valType:"number",dflt:0,editType:b},b:{valType:"number",dflt:0,editType:b},l:{valType:"number",dflt:0,editType:b},editType:b}}},{}],828:[function(a,b,c){"use strict";function d(a,b){function c(a){for(var c=!0,d=0;d<b.length;d++){var g=b[d];f[g]||(a[g]?f[g]=a[g]:c=!1)}c&&(e=!0)}for(var d=a._context.locale,e=!1,f={},g=0;g<2;g++){for(var h=a._context.locales,i=0;i<2;i++){var j=(h[d]||{}).format;if(j&&(c(j),e))break;h=n.localeRegistry}var k=d.split("-")[0];if(e||k===d)break;d=k}return e||c(n.localeRegistry.en.format),f}function e(a,b){var c={_fullLayout:b},d="x"===a._id.charAt(0),e=a._mainAxis._anchorAxis,f="",g="",h="";if(e&&(h=e._mainAxis._id,f=d?a._id+h:h+a._id),!f||!b._plots[f]){f="";for(var i=a._counterAxes,j=0;j<i.length;j++){var k=i[j],l=d?a._id+k:k+a._id;g||(g=l);var m=t.getFromId(c,k);if(h&&m.overlaying===h){f=l;break}}}return f||g}function f(a){var b=a.transforms;if(Array.isArray(b)&&b.length)for(var c=0;c<b.length;c++){var d=b[c],e=d._module||A[d.type];if(e&&e.makesData)return!0}return!1}function g(a,b,c,d){for(var e=a.transforms,f=[a],g=0;g<e.length;g++){var h=e[g],i=A[h.type];i&&i.transform&&(f=i.transform(f,{transform:h,fullTrace:a,fullData:b,layout:c,fullLayout:d,transformIndex:g}))}return f}function h(a){var b=a.margin;if(!a._size){var c=a._size={l:Math.round(b.l),r:Math.round(b.r),t:Math.round(b.t),b:Math.round(b.b),p:Math.round(b.pad)};c.w=Math.round(a.width)-c.l-c.r,c.h=Math.round(a.height)-c.t-c.b}a._pushmargin||(a._pushmargin={}),a._pushmarginIds||(a._pushmarginIds={})}function i(a,b,c){var d=!1,e=[z.previousPromises,function(){if(a._transitionData)return a._transitioning=!1,function(a){var b=Promise.resolve();if(!a)return b;for(;a.length;)b=b.then(a.shift());return b}(a._transitionData._interruptCallbacks)},c.prepareFn,z.rehover,function(){return a.emit("plotly_transitioning",[]),new Promise(function(e){function f(){return g++,function(){var b;h++,d||h!==g||(b=e,a._transitionData&&(function(a){if(a)for(;a.length;)a.shift()}(a._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(c.redraw)return n.call("redraw",a)}).then(function(){a._transitioning=!1,a._transitioningWithDuration=!1,a.emit("plotly_transitioned",[])}).then(b)))}}a._transitioning=!0,b.duration>0&&(a._transitioningWithDuration=!0),a._transitionData._interruptCallbacks.push(function(){d=!0}),c.redraw&&a._transitionData._interruptCallbacks.push(function(){return n.call("redraw",a)}),a._transitionData._interruptCallbacks.push(function(){a.emit("plotly_transitioninterrupted",[])});var g=0,h=0;c.runFn(f),setTimeout(f())})}],f=q.syncOrAsync(e,a);return f&&f.then||(f=Promise.resolve()),f.then(function(){return a})}function j(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.clearCalc(),"multicategory"===d.type&&d.setupMultiCategory(b)}}function k(a){var b,c,d,e=a._fullLayout,f=e._visibleModules,g={};for(c=0;c<f.length;c++){var h=f[c],i=h.crossTraceCalc;if(i){var j=h.basePlotModule.name;g[j]?q.pushUnique(g[j],i):g[j]=[i]}}for(d in g){var k=g[d],l=e._subplots[d];if(Array.isArray(l))for(b=0;b<l.length;b++){var m=l[b],n="cartesian"===d?e._plots[m]:e[m];for(c=0;c<k.length;c++)k[c](a,n,m)}else for(c=0;c<k.length;c++)k[c](a)}}var l=a("d3"),m=a("fast-isnumeric"),n=a("../registry"),o=a("../plot_api/plot_schema"),p=a("../plot_api/plot_template"),q=a("../lib"),r=a("../components/color"),s=a("../constants/numerical").BADNUM,t=a("./cartesian/axis_ids"),u=a("./animation_attributes"),v=a("./frame_attributes"),w=a("../plots/get_data").getModuleCalcData,x=q.relinkPrivateKeys,y=q._,z=b.exports={};q.extendFlat(z,n),z.attributes=a("./attributes"),z.attributes.type.values=z.allTypes,z.fontAttrs=a("./font_attributes"),z.layoutAttributes=a("./layout_attributes"),z.fontWeight="normal";var A=z.transformsRegistry,B=a("./command");z.executeAPICommand=B.executeAPICommand,z.computeAPICommandBindings=B.computeAPICommandBindings,z.manageCommandObserver=B.manageCommandObserver,z.hasSimpleAPICommandBindings=B.hasSimpleAPICommandBindings,z.redrawText=function(a){var b=(a=q.getGraphDiv(a))._fullLayout||{};if(b._has&&b._has("polar")||!a.data||!a.data[0]||!a.data[0].r)return new Promise(function(b){setTimeout(function(){n.getComponentMethod("annotations","draw")(a),n.getComponentMethod("legend","draw")(a),n.getComponentMethod("colorbar","draw")(a),b(z.previousPromises(a))},300)})},z.resize=function(a){return a=q.getGraphDiv(a),new Promise(function(b,c){a&&!q.isHidden(a)||c(new Error("Resize must be passed a displayed plot div element.")),a._redrawTimer&&clearTimeout(a._redrawTimer),a._redrawTimer=setTimeout(function(){if(!a.layout||a.layout.width&&a.layout.height||q.isHidden(a))b(a);else{delete a.layout.width,delete a.layout.height;var c=a.changed;a.autoplay=!0,n.call("relayout",a,{autosize:!0}).then(function(){a.changed=c,b(a)})}},100)})},z.previousPromises=function(a){if((a._promises||[]).length)return Promise.all(a._promises).then(function(){a._promises=[]})},z.addLinks=function(a){if(a._context.showLink||a._context.showSources){var b=a._fullLayout,c=q.ensureSingle(b._paper,"text","js-plot-link-container",function(a){a.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:r.defaultLine,"pointer-events":"all"}).each(function(){var a=l.select(this);a.append("tspan").classed("js-link-to-tool",!0),a.append("tspan").classed("js-link-spacer",!0),a.append("tspan").classed("js-sourcelinks",!0)})}),d=c.node(),e={y:b._paper.attr("height")-9};document.body.contains(d)&&d.getComputedTextLength()>=b.width-20?(e["text-anchor"]="start",e.x=5):(e["text-anchor"]="end",e.x=b._paper.attr("width")-7),c.attr(e);var f=c.select(".js-link-to-tool"),g=c.select(".js-link-spacer"),h=c.select(".js-sourcelinks");a._context.showSources&&a._context.showSources(a),a._context.showLink&&function(a,b){b.text("");var c=b.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(a._context.linkText+" "+String.fromCharCode(187));if(a._context.sendData)c.on("click",function(){z.sendDataToCloud(a)});else{var d=window.location.pathname.split("/"),e=window.location.search;c.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+d[2].split(".")[0]+"/"+d[1]+e})}}(a,f),g.text(f.text()&&h.text()?" - ":"")}},z.sendDataToCloud=function(a){a.emit("plotly_beforeexport");var b=(window.PLOTLYENV||{}).BASE_URL||a._context.plotlyServerURL,c=l.select(a).append("div").attr("id","hiddenform").style("display","none"),d=c.append("form").attr({action:b+"/external",method:"post",target:"_blank"});return d.append("input").attr({type:"text",name:"data"}).node().value=z.graphJson(a,!1,"keepdata"),d.node().submit(),c.remove(),a.emit("plotly_afterexport"),!1};var C=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],D=["year","month","dayMonth","dayMonthYear"];z.supplyDefaults=function(a,b){var c=b&&b.skipUpdateCalc,e=a._fullLayout||{};if(e._skipDefaults)delete e._skipDefaults;else{var f,g=a._fullLayout={},i=a.layout||{},j=a._fullData||[],k=a._fullData=[],m=a.data||[],o=a.calcdata||[],p=a._context||{};a._transitionData||z.createTransitionData(a),g._dfltTitle={plot:y(a,"Click to enter Plot title"),x:y(a,"Click to enter X axis title"),y:y(a,"Click to enter Y axis title"),colorbar:y(a,"Click to enter Colorscale title"),annotation:y(a,"new text")},g._traceWord=y(a,"trace");var r=d(a,C);if(g._mapboxAccessToken=p.mapboxAccessToken,e._initialAutoSizeIsDone){var s=e.width,t=e.height;z.supplyLayoutGlobalDefaults(i,g,r),i.width||(g.width=s),i.height||(g.height=t),z.sanitizeMargins(g)}else{z.supplyLayoutGlobalDefaults(i,g,r);var u=!i.width||!i.height,v=g.autosize,w=p.autosizable;u&&(v||w)?z.plotAutoSize(a,i,g):u&&z.sanitizeMargins(g),!v&&u&&(i.width=g.width,i.height=g.height)}g._d3locale=function(a,b){return a.decimal=b.charAt(0),a.thousands=b.charAt(1),l.locale(a)}(r,g.separators),g._extraFormat=d(a,D),g._initialAutoSizeIsDone=!0,g._dataLength=m.length,g._modules=[],g._visibleModules=[],g._basePlotModules=[];var A=g._subplots=function(){var a,b,c=n.collectableSubplotTypes,d={};if(!c){c=[];var e=n.subplotsRegistry;for(var f in e){var g=e[f],h=g.attr;if(h&&(c.push(f),Array.isArray(h)))for(b=0;b<h.length;b++)q.pushUnique(c,h[b])}}for(a=0;a<c.length;a++)d[c[a]]=[];return d}(),B=g._splomAxes={x:{},y:{}},E=g._splomSubplots={};g._splomGridDflt={},g._scatterStackOpts={},g._firstScatter={},g._alignmentOpts={},g._colorAxes={},g._requestRangeslider={},g._traceUids=function(a,b){function c(a,b){k[b]=a,l[a]=1}function d(a,b){if(a&&"string"==typeof a&&!l[a])return c(a,b),!0}var e,f,g=b.length,h=[];for(e=0;e<a.length;e++){var i=a[e]._fullInput;i!==f&&h.push(i),f=i}var j=h.length,k=new Array(g),l={};for(e=0;e<g;e++){var m=b[e].uid;"number"==typeof m&&(m=String(m)),d(m,e)||e<j&&d(h[e].uid,e)||c(q.randstr(l),e)}return k}(j,m),g._globalTransforms=(a._context||{}).globalTransforms,z.supplyDataDefaults(m,k,i,g);var F=Object.keys(B.x),G=Object.keys(B.y);if(F.length>1&&G.length>1){for(n.getComponentMethod("grid","sizeDefaults")(i,g),f=0;f<F.length;f++)q.pushUnique(A.xaxis,F[f]);for(f=0;f<G.length;f++)q.pushUnique(A.yaxis,G[f]);for(var H in E)q.pushUnique(A.cartesian,H)}if(g._has=z._hasPlotType.bind(g),j.length===k.length)for(f=0;f<k.length;f++)x(k[f],j[f]);z.supplyLayoutModuleDefaults(i,g,k,a._transitionData);var I=g._visibleModules,J=[];for(f=0;f<I.length;f++){var K=I[f].crossTraceDefaults;K&&q.pushUnique(J,K)}for(f=0;f<J.length;f++)J[f](k,g);g._hasOnlyLargeSploms=1===g._basePlotModules.length&&"splom"===g._basePlotModules[0].name&&F.length>15&&G.length>15&&0===g.shapes.length&&0===g.images.length,g._hasCartesian=g._has("cartesian"),g._hasGeo=g._has("geo"),g._hasGL3D=g._has("gl3d"),g._hasGL2D=g._has("gl2d"),g._hasTernary=g._has("ternary"),g._hasPie=g._has("pie"),z.linkSubplots(k,g,j,e),z.cleanPlot(k,g,j,e),e._zoomlayer&&!a._dragging&&e._zoomlayer.selectAll(".select-outline").remove(),function(a,b){var c,d=[];b.meta&&(c=b._meta={meta:b.meta,layout:{meta:b.meta}});for(var e=0;e<a.length;e++){var f=a[e];f.meta?d[f.index]=f._meta={meta:f.meta}:b.meta&&(f._meta={meta:b.meta}),b.meta&&(f._meta.layout={meta:b.meta})}d.length&&(c||(c=b._meta={}),c.data=d)}(k,g),x(g,e),n.getComponentMethod("colorscale","crossTraceDefaults")(k,g),g._preGUI||(g._preGUI={}),g._tracePreGUI||(g._tracePreGUI={});var L,M=g._tracePreGUI,N={};for(L in M)N[L]="old";for(f=0;f<k.length;f++)N[L=k[f]._fullInput.uid]||(M[L]={}),N[L]="new";for(L in N)"old"===N[L]&&delete M[L];h(g),n.getComponentMethod("rangeslider","makeData")(g),c||o.length!==k.length||z.supplyDefaultsUpdateCalc(o,k)}},z.supplyDefaultsUpdateCalc=function(a,b){for(var c=0;c<b.length;c++){var d=b[c],e=(a[c]||[])[0];if(e&&e.trace){var f=e.trace;if(f._hasCalcTransform){var g,h,i,j=f._arrayAttrs;for(g=0;g<j.length;g++)h=j[g],i=q.nestedProperty(f,h).get().slice(),q.nestedProperty(d,h).set(i)}e.trace=d}}},z.createTransitionData=function(a){a._transitionData||(a._transitionData={}),a._transitionData._frames||(a._transitionData._frames=[]),a._transitionData._frameHash||(a._transitionData._frameHash={}),a._transitionData._counter||(a._transitionData._counter=0),a._transitionData._interruptCallbacks||(a._transitionData._interruptCallbacks=[])},z._hasPlotType=function(a){var b,c=this._basePlotModules||[];for(b=0;b<c.length;b++)if(c[b].name===a)return!0;var d=this._modules||[];for(b=0;b<d.length;b++){var e=d[b].name;if(e===a)return!0;var f=n.modules[e];if(f&&f.categories[a])return!0}return!1},z.cleanPlot=function(a,b,c,d){var e,f,g=d._basePlotModules||[];for(e=0;e<g.length;e++){var h=g[e];h.clean&&h.clean(a,b,c,d)}var i=d._has&&d._has("gl"),j=b._has&&b._has("gl");i&&!j&&void 0!==d._glcontainer&&(d._glcontainer.selectAll(".gl-canvas").remove(),d._glcontainer.selectAll(".no-webgl").remove(),d._glcanvas=null);var k=!!d._infolayer;a:for(e=0;e<c.length;e++){var l=c[e].uid;for(f=0;f<a.length;f++)if(l===a[f].uid)continue a;k&&d._infolayer.select(".cb"+l).remove()}},z.linkSubplots=function(a,b,c,d){var f,g,h=d._plots||{},i=b._plots={},j=b._subplots,k={_fullData:a,_fullLayout:b},l=j.cartesian.concat(j.gl2d||[]);for(f=0;f<l.length;f++){var m,o=l[f],p=h[o],r=t.getFromId(k,o,"x"),s=t.getFromId(k,o,"y");for(p?m=i[o]=p:(m=i[o]={}).id=o,r._counterAxes.push(s._id),s._counterAxes.push(r._id),r._subplotsWith.push(o),s._subplotsWith.push(o),m.xaxis=r,m.yaxis=s,m._hasClipOnAxisFalse=!1,g=0;g<a.length;g++){var u=a[g];if(u.xaxis===m.xaxis._id&&u.yaxis===m.yaxis._id&&!1===u.cliponaxis){m._hasClipOnAxisFalse=!0;break}}}var v,w=t.list(k,null,!0);for(f=0;f<w.length;f++){var x=null;(v=w[f]).overlaying&&(x=t.getFromId(k,v.overlaying))&&x.overlaying&&(v.overlaying=!1,x=null),v._mainAxis=x||v,x&&(v.domain=x.domain.slice()),v._anchorAxis="free"===v.anchor?null:t.getFromId(k,v.anchor)}for(f=0;f<w.length;f++)if((v=w[f])._counterAxes.sort(t.idSort),v._subplotsWith.sort(q.subplotSort),v._mainSubplot=e(v,b),v._counterAxes.length&&(v.spikemode&&-1!==v.spikemode.indexOf("across")||v.automargin&&v.mirror||n.getComponentMethod("rangeslider","isVisible")(v))){var y=1,z=0;for(g=0;g<v._counterAxes.length;g++){var A=t.getFromId(k,v._counterAxes[g]);y=Math.min(y,A.domain[0]),z=Math.max(z,A.domain[1])}y<z&&(v._counterDomainMin=y,v._counterDomainMax=z)}},z.clearExpandedTraceDefaultColors=function(a){var b,c,d;for(c=[],(b=a._module._colorAttrs)||(a._module._colorAttrs=b=[],o.crawl(a._module.attributes,function(a,d,e,f){c[f]=d,c.length=f+1,"color"===a.valType&&void 0===a.dflt&&b.push(c.join("."))})),d=0;d<b.length;d++)q.nestedProperty(a,"_input."+b[d]).get()||q.nestedProperty(a,b[d]).set(null)},z.supplyDataDefaults=function(a,b,c,d){function e(a){b.push(a);var c=a._module;c&&(q.pushUnique(j,c),!0===a.visible&&q.pushUnique(k,c),q.pushUnique(l,a._module.basePlotModule),m++,!1!==a._input.visible&&o++)}var f,h,i,j=d._modules,k=d._visibleModules,l=d._basePlotModules,m=0,o=0;d._transformModules=[];var r={},s=[],t=(c.template||{}).data||{},u=p.traceTemplater(t);for(f=0;f<a.length;f++){if(i=a[f],(h=u.newTrace(i)).uid=d._traceUids[f],z.supplyTraceDefaults(i,h,o,d,f),h.index=f,h._input=i,h._expandedIndex=m,h.transforms&&h.transforms.length)for(var v=!1!==i.visible&&!1===h.visible,w=g(h,b,c,d),y=0;y<w.length;y++){var A=w[y],B={_template:h._template,type:h.type,uid:h.uid+y};v&&!1===A.visible&&delete A.visible,z.supplyTraceDefaults(A,B,m,d,f),x(B,A),B.index=f,B._input=i,B._fullInput=h,B._expandedIndex=m,B._expandedInput=A,e(B)}else h._fullInput=h,h._expandedInput=h,e(h);n.traceIs(h,"carpetAxis")&&(r[h.carpet]=h),n.traceIs(h,"carpetDependent")&&s.push(f)}for(f=0;f<s.length;f++)if((h=b[s[f]]).visible){var C=r[h.carpet];h._carpet=C,C&&C.visible?(h.xaxis=C.xaxis,h.yaxis=C.yaxis):h.visible=!1}},z.supplyAnimationDefaults=function(a){function b(b,c){return q.coerce(a||{},d,u,b,c)}var c;a=a||{};var d={};if(b("mode"),b("direction"),b("fromcurrent"),Array.isArray(a.frame))for(d.frame=[],c=0;c<a.frame.length;c++)d.frame[c]=z.supplyAnimationFrameDefaults(a.frame[c]||{});else d.frame=z.supplyAnimationFrameDefaults(a.frame||{});if(Array.isArray(a.transition))for(d.transition=[],c=0;c<a.transition.length;c++)d.transition[c]=z.supplyAnimationTransitionDefaults(a.transition[c]||{});else d.transition=z.supplyAnimationTransitionDefaults(a.transition||{});return d},z.supplyAnimationFrameDefaults=function(a){function b(b,d){return q.coerce(a||{},c,u.frame,b,d)}var c={};return b("duration"),b("redraw"),c},z.supplyAnimationTransitionDefaults=function(a){function b(b,d){return q.coerce(a||{},c,u.transition,b,d)}var c={};return b("duration"),b("easing"),c},z.supplyFrameDefaults=function(a){function b(b,d){return q.coerce(a,c,v,b,d)}var c={};return b("group"),b("name"),b("traces"),b("baseframe"),b("data"),b("layout"),c},z.supplyTraceDefaults=function(a,b,c,d,e){function f(c,d){return q.coerce(a,b,z.attributes,c,d)}var g,h=d.colorway||r.defaults,i=h[c%h.length],j=f("visible");f("type"),f("name",d._traceWord+" "+e),f("uirevision",d.uirevision);var k=z.getModule(b);if(b._module=k,k){var l=k.basePlotModule,m=l.attr,o=l.attributes;if(m&&o){var p=d._subplots,s="";if("gl2d"!==l.name||j){if(Array.isArray(m))for(g=0;g<m.length;g++){var t=m[g],u=q.coerce(a,b,o,t);p[t]&&q.pushUnique(p[t],u),s+=u}else s=q.coerce(a,b,o,m);p[l.name]&&q.pushUnique(p[l.name],s)}}}return j&&(f("customdata"),f("ids"),f("meta"),n.traceIs(b,"showLegend")?(b._dfltShowLegend=!0,f("showlegend"),f("legendgroup")):b._dfltShowLegend=!1,k&&k.supplyDefaults(a,b,i,d),n.traceIs(b,"noOpacity")||f("opacity"),n.traceIs(b,"notLegendIsolatable")&&(b.visible=!!b.visible),n.traceIs(b,"noHover")||(b.hovertemplate||q.coerceHoverinfo(a,b,d),"parcats"!==b.type&&n.getComponentMethod("fx","supplyDefaults")(a,b,i,d)),k&&k.selectPoints&&f("selectedpoints"),z.supplyTransformDefaults(a,b,d)),b},z.hasMakesDataTransform=f,z.supplyTransformDefaults=function(a,b,c){if(b._length||f(a)){var d=c._globalTransforms||[],e=c._transformModules||[];if(Array.isArray(a.transforms)||0!==d.length)for(var g=a.transforms||[],h=d.concat(g),i=b.transforms=[],j=0;j<h.length;j++){var k,l=h[j],m=l.type,n=A[m],o=!(l._module&&l._module===n),p=n&&"function"==typeof n.transform;n||q.warn("Unrecognized transform type "+m+"."),n&&n.supplyDefaults&&(o||p)?((k=n.supplyDefaults(l,b,c,a)).type=m,k._module=n,q.pushUnique(e,n)):k=q.extendFlat({},l),i.push(k)}}},z.supplyLayoutGlobalDefaults=function(a,b,c){function d(c,d){return q.coerce(a,b,z.layoutAttributes,c,d)}var e=a.template;q.isPlainObject(e)&&(b.template=e,b._template=e.layout,b._dataTemplate=e.data);var f=q.coerceFont(d,"font");d("title.text",b._dfltTitle.plot),q.coerceFont(d,"title.font",{family:f.family,size:Math.round(1.4*f.size),color:f.color}),d("title.xref"),d("title.yref"),d("title.x"),d("title.y"),d("title.xanchor"),d("title.yanchor"),d("title.pad.t"),d("title.pad.r"),d("title.pad.b"),d("title.pad.l"),d("autosize",!(a.width&&a.height)),d("width"),d("height"),d("margin.l"),d("margin.r"),d("margin.t"),d("margin.b"),d("margin.pad"),d("margin.autoexpand"),a.width&&a.height&&z.sanitizeMargins(b),n.getComponentMethod("grid","sizeDefaults")(a,b),d("paper_bgcolor"),d("separators",c.decimal+c.thousands),d("hidesources"),d("colorway"),d("datarevision");var g=d("uirevision");d("editrevision",g),d("selectionrevision",g),d("modebar.orientation"),d("modebar.bgcolor",r.addOpacity(b.paper_bgcolor,.5));var h=r.contrast(r.rgb(b.modebar.bgcolor));d("modebar.color",r.addOpacity(h,.3)),d("modebar.activecolor",r.addOpacity(h,.7)),d("modebar.uirevision",g),d("meta"),q.isPlainObject(a.transition)&&(d("transition.duration"),d("transition.easing"),d("transition.ordering")),n.getComponentMethod("calendars","handleDefaults")(a,b,"calendar"),n.getComponentMethod("fx","supplyLayoutGlobalDefaults")(a,b,d)},z.plotAutoSize=function(a,b,c){var d,e,f=a._context||{},g=f.frameMargins,h=q.isPlotDiv(a);if(h&&a.emit("plotly_autosize"),f.fillFrame)d=window.innerWidth,e=window.innerHeight,document.body.style.overflow="hidden";else{var i=h?window.getComputedStyle(a):{};if(d=parseFloat(i.width)||parseFloat(i.maxWidth)||c.width,e=parseFloat(i.height)||parseFloat(i.maxHeight)||c.height,m(g)&&g>0){var j=1-2*g;d=Math.round(j*d),e=Math.round(j*e)}}var k=z.layoutAttributes.width.min,l=z.layoutAttributes.height.min;d<k&&(d=k),e<l&&(e=l);var n=!b.width&&Math.abs(c.width-d)>1,o=!b.height&&Math.abs(c.height-e)>1;(o||n)&&(n&&(c.width=d),o&&(c.height=e)),a._initialAutoSize||(a._initialAutoSize={width:d,height:e}),z.sanitizeMargins(c)},z.supplyLayoutModuleDefaults=function(a,b,c,d){var e,f,g,h=n.componentsRegistry,i=b._basePlotModules,j=n.subplotsRegistry.cartesian;for(e in h)(g=h[e]).includeBasePlot&&g.includeBasePlot(a,b);for(var k in i.length||i.push(j),b._has("cartesian")&&(n.getComponentMethod("grid","contentDefaults")(a,b),j.finalizeSubplots(a,b)),b._subplots)b._subplots[k].sort(q.subplotSort);for(f=0;f<i.length;f++)(g=i[f]).supplyLayoutDefaults&&g.supplyLayoutDefaults(a,b,c);var l=b._modules;for(f=0;f<l.length;f++)(g=l[f]).supplyLayoutDefaults&&g.supplyLayoutDefaults(a,b,c);var m=b._transformModules;for(f=0;f<m.length;f++)(g=m[f]).supplyLayoutDefaults&&g.supplyLayoutDefaults(a,b,c,d);for(e in h)(g=h[e]).supplyLayoutDefaults&&g.supplyLayoutDefaults(a,b,c)},z.purge=function(a){var b=a._fullLayout||{};void 0!==b._glcontainer&&(b._glcontainer.selectAll(".gl-canvas").remove(),b._glcontainer.remove(),b._glcanvas=null),b._modeBar&&b._modeBar.destroy(),a._transitionData&&(a._transitionData._interruptCallbacks&&(a._transitionData._interruptCallbacks.length=0),a._transitionData._animationRaf&&window.cancelAnimationFrame(a._transitionData._animationRaf)),q.clearThrottle(),q.clearResponsive(a),delete a.data,delete a.layout,delete a._fullData,delete a._fullLayout,delete a.calcdata,delete a.framework,delete a.empty,delete a.fid,delete a.undoqueue,delete a.undonum,
delete a.autoplay,delete a.changed,delete a._promises,delete a._redrawTimer,delete a._hmlumcount,delete a._hmpixcount,delete a._transitionData,delete a._transitioning,delete a._initialAutoSize,delete a._transitioningWithDuration,delete a._dragging,delete a._dragged,delete a._dragdata,delete a._hoverdata,delete a._snapshotInProgress,delete a._editing,delete a._mouseDownTime,delete a._legendMouseDownTime,a.removeAllListeners&&a.removeAllListeners()},z.style=function(a){var b,c=a._fullLayout._visibleModules,d=[];for(b=0;b<c.length;b++){var e=c[b];e.style&&q.pushUnique(d,e.style)}for(b=0;b<d.length;b++)d[b](a)},z.sanitizeMargins=function(a){if(a&&a.margin){var b,c=a.width,d=a.height,e=a.margin,f=c-(e.l+e.r),g=d-(e.t+e.b);f<0&&(b=(c-1)/(e.l+e.r),e.l=Math.floor(b*e.l),e.r=Math.floor(b*e.r)),g<0&&(b=(d-1)/(e.t+e.b),e.t=Math.floor(b*e.t),e.b=Math.floor(b*e.b))}},z.clearAutoMarginIds=function(a){a._fullLayout._pushmarginIds={}},z.allowAutoMargin=function(a,b){a._fullLayout._pushmarginIds[b]=1},z.autoMargin=function(a,b,c){var d=a._fullLayout,e=d._pushmargin,f=d._pushmarginIds;if(!1!==d.margin.autoexpand){if(c){var g=c.pad;if(void 0===g){var h=d.margin;g=Math.min(12,h.l,h.r,h.t,h.b)}c.l+c.r>.5*d.width&&(q.log("Margin push",b,"is too big in x, dropping"),c.l=c.r=0),c.b+c.t>.5*d.height&&(q.log("Margin push",b,"is too big in y, dropping"),c.b=c.t=0);var i=void 0!==c.xl?c.xl:c.x,j=void 0!==c.xr?c.xr:c.x,k=void 0!==c.yt?c.yt:c.y,l=void 0!==c.yb?c.yb:c.y;e[b]={l:{val:i,size:c.l+g},r:{val:j,size:c.r+g},b:{val:l,size:c.b+g},t:{val:k,size:c.t+g}},f[b]=1}else delete e[b],delete f[b];if(!d._replotting)return z.doAutoMargin(a)}},z.doAutoMargin=function(a){var b=a._fullLayout;b._size||(b._size={}),h(b);var c=b._size,d=b.margin,e=q.extendFlat({},c),f=d.l,g=d.r,i=d.t,j=d.b,k=b.width,l=b.height,o=b._pushmargin,p=b._pushmarginIds;if(!1!==b.margin.autoexpand){for(var r in o)p[r]||delete o[r];for(var s in o.base={l:{val:0,size:f},r:{val:1,size:g},t:{val:1,size:i},b:{val:0,size:j}},o){var t=o[s].l||{},u=o[s].b||{},v=t.val,w=t.size,x=u.val,y=u.size;for(var A in o){if(m(w)&&o[A].r){var B=o[A].r.val,C=o[A].r.size;if(B>v){var D=(w*B+(C-k)*v)/(B-v),E=(C*(1-v)+(w-k)*(1-B))/(B-v);D>=0&&E>=0&&k-(D+E)>0&&D+E>f+g&&(f=D,g=E)}}if(m(y)&&o[A].t){var F=o[A].t.val,G=o[A].t.size;if(F>x){var H=(y*F+(G-l)*x)/(F-x),I=(G*(1-x)+(y-l)*(1-F))/(F-x);H>=0&&I>=0&&l-(I+H)>0&&H+I>j+i&&(j=H,i=I)}}}}}if(c.l=Math.round(f),c.r=Math.round(g),c.t=Math.round(i),c.b=Math.round(j),c.p=Math.round(d.pad),c.w=Math.round(k)-c.l-c.r,c.h=Math.round(l)-c.t-c.b,!b._replotting&&z.didMarginChange(e,c)){"_redrawFromAutoMarginCount"in b?b._redrawFromAutoMarginCount++:b._redrawFromAutoMarginCount=1;var J=3*(1+Object.keys(p).length);if(b._redrawFromAutoMarginCount<J)return n.call("plot",a);q.warn("Too many auto-margin redraws.")}};var E=["l","r","t","b","p","w","h"];z.didMarginChange=function(a,b){for(var c=0;c<E.length;c++){var d=E[c],e=a[d],f=b[d];if(!m(e)||Math.abs(f-e)>1)return!0}return!1},z.graphJson=function(a,b,c,d,e){function f(a){if("function"==typeof a)return null;if(q.isPlainObject(a)){var b,d,e={};for(b in a)if("function"!=typeof a[b]&&-1===["_","["].indexOf(b.charAt(0))){if("keepdata"===c){if("src"===b.substr(b.length-3))continue}else if("keepstream"===c){if("string"==typeof(d=a[b+"src"])&&d.indexOf(":")>0&&!q.isPlainObject(a.stream))continue}else if("keepall"!==c&&"string"==typeof(d=a[b+"src"])&&d.indexOf(":")>0)continue;e[b]=f(a[b])}return e}return Array.isArray(a)?a.map(f):q.isTypedArray(a)?q.simpleMap(a,q.identity):q.isJSDate(a)?q.ms2DateTimeLocal(+a):a}(e&&b&&!a._fullData||e&&!b&&!a._fullLayout)&&z.supplyDefaults(a);var g=e?a._fullData:a.data,h=e?a._fullLayout:a.layout,i=(a._transitionData||{})._frames,j={data:(g||[]).map(function(a){var c=f(a);return b&&delete c.fit,c})};return b||(j.layout=f(h)),a.framework&&a.framework.isPolar&&(j=a.framework.getConfig()),i&&(j.frames=f(i)),"object"===d?j:JSON.stringify(j)},z.modifyFrames=function(a,b){var c,d,e,f=a._transitionData._frames,g=a._transitionData._frameHash;for(c=0;c<b.length;c++)switch((d=b[c]).type){case"replace":e=d.value;var h=(f[d.index]||{}).name,i=e.name;f[d.index]=g[i]=e,i!==h&&(delete g[h],g[i]=e);break;case"insert":g[(e=d.value).name]=e,f.splice(d.index,0,e);break;case"delete":delete g[(e=f[d.index]).name],f.splice(d.index,1)}return Promise.resolve()},z.computeFrame=function(a,b){var c,d,e,f,g=a._transitionData._frameHash;if(!b)throw new Error("computeFrame must be given a string frame name");var h=g[b.toString()];if(!h)return!1;for(var i=[h],j=[h.name];h.baseframe&&(h=g[h.baseframe.toString()])&&-1===j.indexOf(h.name);)i.push(h),j.push(h.name);for(var k={};h=i.pop();)if(h.layout&&(k.layout=z.extendLayout(k.layout,h.layout)),h.data){if(k.data||(k.data=[]),!(d=h.traces))for(d=[],c=0;c<h.data.length;c++)d[c]=c;for(k.traces||(k.traces=[]),c=0;c<h.data.length;c++)null!=(e=d[c])&&(-1===(f=k.traces.indexOf(e))&&(f=k.data.length,k.traces[f]=e),k.data[f]=z.extendTrace(k.data[f],h.data[c]))}return k},z.recomputeFrameHash=function(a){for(var b=a._transitionData._frameHash={},c=a._transitionData._frames,d=0;d<c.length;d++){var e=c[d];e&&e.name&&(b[e.name]=e)}},z.extendObjectWithContainers=function(a,b,c){var d,e,f,g,h,i,j,k=q.extendDeepNoArrays({},b||{}),l=q.expandObjectPaths(k),m={};if(c&&c.length)for(f=0;f<c.length;f++)void 0===(e=(d=q.nestedProperty(l,c[f])).get())?q.nestedProperty(m,c[f]).set(null):(d.set(null),q.nestedProperty(m,c[f]).set(e));if(a=q.extendDeepNoArrays(a||{},l),c&&c.length)for(f=0;f<c.length;f++)if(i=q.nestedProperty(m,c[f]).get()){for(j=(h=q.nestedProperty(a,c[f])).get(),Array.isArray(j)||(j=[],h.set(j)),g=0;g<i.length;g++){var n=i[g];j[g]=null===n?null:z.extendObjectWithContainers(j[g],n)}h.set(j)}return a},z.dataArrayContainers=["transforms","dimensions"],z.layoutArrayContainers=n.layoutArrayContainers,z.extendTrace=function(a,b){return z.extendObjectWithContainers(a,b,z.dataArrayContainers)},z.extendLayout=function(a,b){return z.extendObjectWithContainers(a,b,z.layoutArrayContainers)},z.transition=function(a,b,c,d,e,f){var g={redraw:e.redraw},h={},j=[];return g.prepareFn=function(){for(var e=Array.isArray(b)?b.length:0,f=d.slice(0,e),g=0;g<f.length;g++){var i=f[g],k=a._fullData[i]._module;if(k){if(k.animatable){var l=k.basePlotModule.name;h[l]||(h[l]=[]),h[l].push(i)}a.data[f[g]]=z.extendTrace(a.data[f[g]],b[g])}}var m=q.expandObjectPaths(q.extendDeepNoArrays({},c)),n=/^[xy]axis[0-9]*$/;for(var o in m)n.test(o)&&delete m[o].range;z.extendLayout(a.layout,m),delete a.calcdata,z.supplyDefaults(a),z.doCalcdata(a);var p=q.expandObjectPaths(c);if(p){var r=a._fullLayout._plots;for(var s in r){var t=r[s],u=t.xaxis,v=t.yaxis,w=u.range.slice(),x=v.range.slice(),y=null,A=null,B=null,C=null;Array.isArray(p[u._name+".range"])?y=p[u._name+".range"].slice():Array.isArray((p[u._name]||{}).range)&&(y=p[u._name].range.slice()),Array.isArray(p[v._name+".range"])?A=p[v._name+".range"].slice():Array.isArray((p[v._name]||{}).range)&&(A=p[v._name].range.slice()),w&&y&&(u.r2l(w[0])!==u.r2l(y[0])||u.r2l(w[1])!==u.r2l(y[1]))&&(B={xr0:w,xr1:y}),x&&A&&(v.r2l(x[0])!==v.r2l(A[0])||v.r2l(x[1])!==v.r2l(A[1]))&&(C={yr0:x,yr1:A}),(B||C)&&j.push(q.extendFlat({plotinfo:t},B,C))}}return Promise.resolve()},g.runFn=function(b){var d,e,g=a._fullLayout._basePlotModules,i=j.length;if(c)for(e=0;e<g.length;e++)g[e].transitionAxes&&g[e].transitionAxes(a,j,f,b);for(var k in i?((d=q.extendFlat({},f)).duration=0,delete h.cartesian):d=f,h){var l=h[k];a._fullData[l[0]]._module.basePlotModule.plot(a,l,d,b)}},i(a,f,g)},z.transitionFromReact=function(a,b,c,d){var e=a._fullLayout,f=e.transition,g={},h=[];return g.prepareFn=function(){var a=e._plots;for(var f in g.redraw=!1,"some"===b.anim&&(g.redraw=!0),"some"===c.anim&&(g.redraw=!0),a){var i=a[f],j=i.xaxis,k=i.yaxis,l=d[j._name].range.slice(),m=d[k._name].range.slice(),n=j.range.slice(),o=k.range.slice();j.setScale(),k.setScale();var p=null,r=null;j.r2l(l[0])===j.r2l(n[0])&&j.r2l(l[1])===j.r2l(n[1])||(p={xr0:l,xr1:n}),k.r2l(m[0])===k.r2l(o[0])&&k.r2l(m[1])===k.r2l(o[1])||(r={yr0:m,yr1:o}),(p||r)&&h.push(q.extendFlat({plotinfo:i},p,r))}return Promise.resolve()},g.runFn=function(c){function d(){for(var b=0;b<l.length;b++)l[b].transitionAxes&&l[b].transitionAxes(a,h,g,c)}function e(){for(var b=0;b<l.length;b++)l[b].plot(a,j,i,c)}for(var g,i,j,k=a._fullData,l=a._fullLayout._basePlotModules,m=[],n=0;n<k.length;n++)m.push(n);h.length&&b.anim?"traces first"===f.ordering?(g=q.extendFlat({},f,{duration:0}),j=m,i=f,e(),setTimeout(d,f.duration)):(g=f,j=null,i=q.extendFlat({},f,{duration:0}),d(),e()):h.length?(g=f,d()):b.anim&&(j=m,i=f,e())},i(a,f,g)},z.doCalcdata=function(a,b){function c(b,c){if(d=i[b],!!(e=d._module).isContainer===c){var f=[];if(!0===d.visible&&0!==d._length){delete d._indexToPoints;var h=d.transforms||[];for(g=h.length-1;g>=0;g--)if(h[g].enabled){d._indexToPoints=h[g]._indexToPoints;break}e&&e.calc&&(f=e.calc(a,d))}Array.isArray(f)&&f[0]||(f=[{x:s,y:s}]),f[0].t||(f[0].t={}),f[0].trace=d,m[b]=f}}var d,e,f,g,h=t.list(a),i=a._fullData,l=a._fullLayout,m=new Array(i.length),p=(a.calcdata||[]).slice();for(a.calcdata=m,l._numBoxes=0,l._numViolins=0,l._violinScaleGroupStats={},a._hmpixcount=0,a._hmlumcount=0,l._piecolormap={},l._sunburstcolormap={},l._treemapcolormap={},l._funnelareacolormap={},f=0;f<i.length;f++)Array.isArray(b)&&-1===b.indexOf(f)&&(m[f]=p[f]);for(f=0;f<i.length;f++)(d=i[f])._arrayAttrs=o.findArrayAttributes(d),d._extremes={};var r=l._subplots.polar||[];for(f=0;f<r.length;f++)h.push(l[r[f]].radialaxis,l[r[f]].angularaxis);var u=!1;for(j(h,i),f=0;f<i.length;f++)c(f,!0);for(f=0;f<i.length;f++)!function(b){if(d=i[b],e=d._module,!0===d.visible&&d.transforms){if(e&&e.calc){var c=e.calc(a,d);c[0]&&c[0].t&&c[0].t._scene&&delete c[0].t._scene.dirty}for(g=0;g<d.transforms.length;g++){var f=d.transforms[g];(e=A[f.type])&&e.calcTransform&&(d._hasCalcTransform=!0,u=!0,e.calcTransform(a,d,f))}}}(f);for(u&&j(h,i),f=0;f<i.length;f++)c(f,!0);for(f=0;f<i.length;f++)c(f,!1);k(a);var v=function(a,b){var c,d,e,f,g,h=[],i={min:function(a){return q.aggNums(Math.min,null,a)},max:function(a){return q.aggNums(Math.max,null,a)},sum:function(a){return q.aggNums(function(a,b){return a+b},null,a)},total:function(a){return q.aggNums(function(a,b){return a+b},null,a)},mean:function(a){return q.mean(a)},median:function(a){return q.median(a)}};for(c=0;c<a.length;c++){var j=a[c];if("category"===j.type){var k=j.categoryorder.match(F);if(k){var l=k[1],m=k[2],o=[];for(d=0;d<j._categories.length;d++)o.push([j._categories[d],[]]);for(d=0;d<j._traceIndices.length;d++){var p=j._traceIndices[d],r=b._fullData[p],s=j._id.charAt(0);if(!0===r.visible){var u=r.type;n.traceIs(r,"histogram")&&(delete r._xautoBinFinished,delete r._yautoBinFinished);var v=b.calcdata[p];for(e=0;e<v.length;e++){var w,x,y,z=v[e];if("splom"===u){var A=r._axesDim[j._id];if("y"===s){var B=r._diag[A][0];B&&(j=b._fullLayout[t.id2name(B)])}var C=z.trace.dimensions[A].values;for(f=0;f<C.length;f++)for(w=C[f],x=j._categoriesMap[w],g=0;g<z.trace.dimensions.length;g++)if(g!==A){var D=z.trace.dimensions[g];o[x][1].push(D.values[f])}}else if("scattergl"===u){for(f=0;f<z.t.x.length;f++)"x"===s&&(w=z.t.x[f],x=w,y=z.t.y[f]),"y"===s&&(w=z.t.y[f],x=w,y=z.t.x[f]),o[x][1].push(y);z.t&&z.t._scene&&delete z.t._scene.dirty}else if(z.hasOwnProperty("z")){y=z.z;var E=function(a,c,d){var e=c._id.charAt(0);if("histogram2dcontour"===a){var f=c._counterAxes[0],g=t.getFromId(b,f),h="x"===e||"x"===f&&"category"===g.type,i="y"===e||"y"===f&&"category"===g.type;return function(a,b){return 0===a||0===b?-1:h&&a===d[b].length-1?-1:i&&b===d.length-1?-1:("y"===e?b:a)-1}}return function(a,b){return"y"===e?b:a}}(r.type,j,y);for(f=0;f<y.length;f++)for(g=0;g<y[f].length;g++)(x=E(g,f))+1&&o[x][1].push(y[f][g])}else for("x"===s?(w=z.p+1?z.p:z.x,y=z.s||z.v||z.y):"y"===s&&(w=z.p+1?z.p:z.y,y=z.s||z.v||z.x),Array.isArray(y)||(y=[y]),f=0;f<y.length;f++)o[w][1].push(y[f])}}}j._categoriesValue=o;var G=[];for(d=0;d<o.length;d++)G.push([o[d][0],i[l](o[d][1])]);G.sort(function(a,b){return a[1]-b[1]}),j._categoriesAggregatedValue=G,j._initialCategories=G.map(function(a){return a[0]}),"descending"===m&&j._initialCategories.reverse(),h=h.concat(j.sortByInitialCategories())}}}return h}(h,a);if(v.length){for(l._numBoxes=0,l._numViolins=0,f=0;f<v.length;f++)c(v[f],!0);for(f=0;f<v.length;f++)c(v[f],!1);k(a)}n.getComponentMethod("fx","calc")(a),n.getComponentMethod("errorbars","calc")(a)};var F=/(total|sum|min|max|mean|median) (ascending|descending)/;z.rehover=function(a){a._fullLayout._rehover&&a._fullLayout._rehover()},z.redrag=function(a){a._fullLayout._redrag&&a._fullLayout._redrag()},z.generalUpdatePerTraceModule=function(a,b,c,d){var e,f=b.traceHash,g={};for(e=0;e<c.length;e++){var h=c[e],i=h[0].trace;i.visible&&(g[i.type]=g[i.type]||[],g[i.type].push(h))}for(var j in f)if(!g[j]){var k=f[j][0];k[0].trace.visible=!1,g[j]=[k]}for(var l in g){var m=g[l];m[0][0].trace._module.plot(a,b,q.filterVisible(m),d)}b.traceHash=g},z.plotBasePlot=function(a,b,c,d,e){var f=n.getModule(a),g=w(b.calcdata,f)[0];f.plot(b,g,d,e)},z.cleanBasePlot=function(a,b,c,d,e){var f=e._has&&e._has(a),g=c._has&&c._has(a);f&&!g&&e["_"+a+"layer"].selectAll("g.trace").remove()}},{"../components/color":594,"../constants/numerical":695,"../lib":719,"../plot_api/plot_schema":756,"../plot_api/plot_template":757,"../plots/get_data":802,"../registry":848,"./animation_attributes":762,"./attributes":764,"./cartesian/axis_ids":770,"./command":791,"./font_attributes":793,"./frame_attributes":794,"./layout_attributes":819,d3:164,"fast-isnumeric":226}],829:[function(a,b,c){"use strict";b.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],830:[function(a,b,c){"use strict";function d(a,b,c,d){var e,g,h=d[0],i=d[1],j=f(Math.sin(b)-Math.sin(a)),k=f(Math.cos(b)-Math.cos(a)),l=Math.tan(c),m=f(1/l),n=j/k,o=i-n*h;return m?j&&k?g=l*(e=o/(l-n)):k?(e=i*m,g=i):(e=h,g=h*l):j&&k?(e=0,g=o):k?(e=0,g=i):e=g=NaN,[e,g]}function e(a,b,c,e){return h.isFullCircle([b,c])?function(a,b){var c,d=b.length,e=new Array(d+1);for(c=0;c<d;c++){var f=b[c];e[c]=[a*Math.cos(f),a*Math.sin(f)]}return e[c]=e[0].slice(),e}(a,e):function(a,b,c,e){function f(b){return[a*Math.cos(b),a*Math.sin(b)]}function g(a,b,c){return d(a,b,c,f(a))}function i(a){return h.mod(a,p)}function l(a){return k(a,[b,c])}var n,o,p=e.length,q=[],r=j(e,function(a){return l(a)?m(a,b):1/0}),s=g(e[r],e[i(r-1)],b);for(q.push(s),n=r,o=0;o<p;n++,o++){var t=e[i(n)];if(!l(t))break;q.push(f(t))}var u=j(e,function(a){return l(a)?m(a,c):1/0}),v=g(e[u],e[i(u+1)],c);return q.push(v),q.push([0,0]),q.push(q[0].slice()),q}(a,b,c,e)}function f(a){return Math.abs(a)>1e-10?a:0}function g(a,b,c){b=b||0,c=c||0;for(var d=a.length,e=new Array(d),f=0;f<d;f++){var g=a[f];e[f]=[b+g[0],c-g[1]]}return e}var h=a("../../lib"),i=a("../../lib/polygon").tester,j=h.findIndexOfMin,k=h.isAngleInsideSector,l=h.angleDelta,m=h.angleDist;b.exports={isPtInsidePolygon:function(a,b,c,d,f){if(!k(b,d))return!1;var g,h;c[0]<c[1]?(g=c[0],h=c[1]):(g=c[1],h=c[0]);var j=i(e(g,d[0],d[1],f)),l=i(e(h,d[0],d[1],f)),m=[a*Math.cos(b),a*Math.sin(b)];return l.contains(m)&&!j.contains(m)},findPolygonOffset:function(a,b,c,d){for(var f=1/0,g=1/0,h=e(a,b,c,d),i=0;i<h.length;i++){var j=h[i];f=Math.min(f,j[0]),g=Math.min(g,-j[1])}return[f,g]},findEnclosingVertexAngles:function(a,b){var c=j(b,function(b){var c=l(b,a);return c>0?c:1/0}),d=h.mod(c+1,b.length);return[b[c],b[d]]},findIntersectionXY:d,findXYatLength:function(a,b,c,d){var e=-b*c,f=b*b+1,g=2*(b*e-c),h=e*e+c*c-a*a,i=Math.sqrt(g*g-4*f*h),j=(-g+i)/(2*f),k=(-g-i)/(2*f);return[[j,b*j+e+d],[k,b*k+e+d]]},clampTiny:f,pathPolygon:function(a,b,c,d,f,h){return"M"+g(e(a,b,c,d),f,h).join("L")},pathPolygonAnnulus:function(a,b,c,d,f,h,i){var j,k;a<b?(j=a,k=b):(j=b,k=a);var l=g(e(j,c,d,f),h,i);return"M"+g(e(k,c,d,f),h,i).reverse().join("L")+"M"+l.join("L")}}},{"../../lib":719,"../../lib/polygon":731}],831:[function(a,b,c){"use strict";var d=a("../get_data").getSubplotCalcData,e=a("../../lib").counterRegex,f=a("./polar"),g=a("./constants"),h=g.attr,i=g.name,j=e(i),k={};k[h]={valType:"subplotid",dflt:i,editType:"calc"},b.exports={attr:h,name:i,idRoot:i,idRegex:j,attrRegex:j,attributes:k,layoutAttributes:a("./layout_attributes"),supplyLayoutDefaults:a("./layout_defaults"),plot:function(a){for(var b=a._fullLayout,c=a.calcdata,e=b._subplots[i],g=0;g<e.length;g++){var h=e[g],j=d(c,i,h),k=b[h]._subplot;k||(k=f(a,h),b[h]._subplot=k),k.plot(j,b,a._promises)}},clean:function(a,b,c,d){for(var e=d._subplots[i]||[],f=d._has&&d._has("gl"),g=b._has&&b._has("gl"),h=f&&!g,j=0;j<e.length;j++){var k=e[j],l=d[k]._subplot;if(!b[k]&&l)for(var m in l.framework.remove(),l.layers["radial-axis-title"].remove(),l.clipPaths)l.clipPaths[m].remove();h&&l._scene&&(l._scene.destroy(),l._scene=null)}},toSVG:a("../cartesian").toSVG}},{"../../lib":719,"../cartesian":778,"../get_data":802,"./constants":829,"./layout_attributes":832,"./layout_defaults":833,"./polar":840}],832:[function(a,b,c){"use strict";var d=a("../../components/color/attributes"),e=a("../cartesian/layout_attributes"),f=a("../domain").attributes,g=a("../../lib").extendFlat,h=a("../../plot_api/edit_types").overrideAll,i=h({color:e.color,showline:g({},e.showline,{dflt:!0}),linecolor:e.linecolor,linewidth:e.linewidth,showgrid:g({},e.showgrid,{dflt:!0}),gridcolor:e.gridcolor,gridwidth:e.gridwidth},"plot","from-root"),j=h({tickmode:e.tickmode,nticks:e.nticks,tick0:e.tick0,dtick:e.dtick,tickvals:e.tickvals,ticktext:e.ticktext,ticks:e.ticks,ticklen:e.ticklen,tickwidth:e.tickwidth,tickcolor:e.tickcolor,showticklabels:e.showticklabels,showtickprefix:e.showtickprefix,tickprefix:e.tickprefix,showticksuffix:e.showticksuffix,ticksuffix:e.ticksuffix,showexponent:e.showexponent,exponentformat:e.exponentformat,separatethousands:e.separatethousands,tickfont:e.tickfont,tickangle:e.tickangle,tickformat:e.tickformat,tickformatstops:e.tickformatstops,layer:e.layer},"plot","from-root"),k={visible:g({},e.visible,{dflt:!0}),type:g({},e.type,{values:["-","linear","log","date","category"]}),autorange:g({},e.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:g({},e.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:e.categoryorder,categoryarray:e.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:h(e.title,"plot","from-root"),hoverformat:e.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:e._deprecated.title,titlefont:e._deprecated.titlefont}};k.title.text.dflt="",g(k,i,j);var l={visible:g({},e.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},categoryorder:e.categoryorder,categoryarray:e.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:e.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};g(l,i,j),b.exports={domain:f({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:d.background},radialaxis:k,angularaxis:l,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":593,"../../lib":719,"../../plot_api/edit_types":750,"../cartesian/layout_attributes":779,"../domain":792}],833:[function(a,b,c){"use strict";function d(a,b,c,d){function i(a,b){return c(v+"."+a,b)}var p=c("bgcolor");d.bgColor=g.combine(p,d.paper_bgcolor);var u=c("sector");c("hole");for(var v,w=j(d.fullData,s.name,d.id),x=d.layoutOut,y=0;y<t.length;y++){v=t[y],f.isPlainObject(a[v])||(a[v]={});var z=a[v],A=h.newContainer(b,v);A._id=A._name=v,A._attr=d.id+"."+v,A._traceIndices=w.map(function(a){return a._expandedIndex});var B=s.axisName2dataArray[v],C=e(z,A,i,w,B);n(z,A,i,{axData:w,dataAttr:B});var D,E,F=i("visible");switch(r(A,b,x),i("uirevision",b.uirevision),F&&(E=(D=i("color"))===z.color?D:d.font.color),A._m=1,v){case"radialaxis":var G=i("autorange",!A.isValidRange(z.range));z.autorange=G,!G||"linear"!==C&&"-"!==C||i("rangemode"),"reversed"===G&&(A._m=-1),i("range"),A.cleanRange("range",{dfltRange:[0,1]}),F&&(i("side"),i("angle",u[0]),i("title.text"),f.coerceFont(i,"title.font",{family:d.font.family,size:Math.round(1.2*d.font.size),color:E}));break;case"angularaxis":if("date"===C){f.log("Polar plots do not support date angular axes yet.");for(var H=0;H<w.length;H++)w[H].visible=!1;C=z.type=A.type="linear"}i("linear"===C?"thetaunit":"period");i("rotation",{counterclockwise:0,clockwise:90}[i("direction")])}F&&(k(z,A,i,A.type),m(z,A,i,A.type,{tickSuffixDflt:"degrees"===A.thetaunit?"":void 0}),l(z,A,i,{outerTicks:!0}),i("showticklabels")&&(f.coerceFont(i,"tickfont",{family:d.font.family,size:d.font.size,color:E}),i("tickangle"),i("tickformat")),o(z,A,i,{dfltColor:D,bgColor:d.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:q[v]}),i("layer")),"category"!==C&&i("hoverformat"),A._input=z}"category"===b.angularaxis.type&&c("gridshape")}function e(a,b,c,d,e){if("-"===c("type")){for(var f,g=0;g<d.length;g++)if(d[g].visible){f=d[g];break}f&&f[e]&&(b.type=p(f[e],"gregorian")),"-"===b.type?b.type="linear":a.type=b.type}return b.type}var f=a("../../lib"),g=a("../../components/color"),h=a("../../plot_api/plot_template"),i=a("../subplot_defaults"),j=a("../get_data").getSubplotData,k=a("../cartesian/tick_value_defaults"),l=a("../cartesian/tick_mark_defaults"),m=a("../cartesian/tick_label_defaults"),n=a("../cartesian/category_order_defaults"),o=a("../cartesian/line_grid_defaults"),p=a("../cartesian/axis_autotype"),q=a("./layout_attributes"),r=a("./set_convert"),s=a("./constants"),t=s.axisNames;b.exports=function(a,b,c){i(a,b,c,{type:s.name,attributes:q,handleDefaults:d,font:b.font,paper_bgcolor:b.paper_bgcolor,fullData:c,layoutOut:b})}},{"../../components/color":594,"../../lib":719,"../../plot_api/plot_template":757,"../cartesian/axis_autotype":768,"../cartesian/category_order_defaults":771,"../cartesian/line_grid_defaults":781,"../cartesian/tick_label_defaults":786,"../cartesian/tick_mark_defaults":787,"../cartesian/tick_value_defaults":788,"../get_data":802,"../subplot_defaults":842,"./constants":829,"./layout_attributes":832,"./set_convert":841}],834:[function(a,b,c){"use strict";var d=a("../../../traces/scatter/attributes"),e=d.marker,f=a("../../../lib/extend").extendFlat;["Area traces are deprecated!","Please switch to the *barpolar* trace type."].join(" "),b.exports={r:f({},d.r,{}),t:f({},d.t,{}),marker:{color:f({},e.color,{}),size:f({},e.size,{}),symbol:f({},e.symbol,{}),opacity:f({},e.opacity,{}),editType:"calc"}}},{"../../../lib/extend":710,"../../../traces/scatter/attributes":1111}],835:[function(a,b,c){"use strict";function d(a,b){return f({},b,{showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number",description:h},visible:{valType:"boolean"}})}var e=a("../../cartesian/layout_attributes"),f=a("../../../lib/extend").extendFlat,g=a("../../../plot_api/edit_types").overrideAll,h=["Legacy polar charts are deprecated!","Please switch to *polar* subplots."].join(" "),i=f({},e.domain,{});b.exports=g({radialaxis:d(0,{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:i,orientation:{valType:"number"}}),angularaxis:d(0,{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:i}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}},"plot","nested")},{"../../../lib/extend":710,"../../../plot_api/edit_types":750,"../../cartesian/layout_attributes":779}],836:[function(a,b,c){"use strict";(b.exports=a("./micropolar")).manager=a("./micropolar_manager")},{"./micropolar":837,"./micropolar_manager":838}],837:[function(a,b,c){var d=a("d3"),e=a("../../../lib").extendDeepAll,f=a("../../../constants/alignment").MID_SHIFT,g=b.exports={version:"0.2.2"};g.Axis=function(){var a,b,c,h,i={data:[],layout:{}},j={},k={},l=d.dispatch("hover"),m={};return m.render=function(j){return function(j){b=j||b;var l=i.data,m=i.layout;("string"==typeof b||b.nodeName)&&(b=d.select(b)),b.datum(l).each(function(b,i){function j(a,b){return h(a)%360+m.orientation}var l=b.slice();k={data:g.util.cloneJson(l),layout:g.util.cloneJson(m)};var n=0;l.forEach(function(a,b){a.color||(a.color=m.defaultColorRange[n],n=(n+1)%m.defaultColorRange.length),a.strokeColor||(a.strokeColor="LinePlot"===a.geometry?a.color:d.rgb(a.color).darker().toString()),k.data[b].color=a.color,k.data[b].strokeColor=a.strokeColor,k.data[b].strokeDash=a.strokeDash,k.data[b].strokeSize=a.strokeSize});var o=l.filter(function(a,b){var c=a.visible;return void 0===c||!0===c}),p=!1,q=o.map(function(a,b){return p=p||void 0!==a.groupId,a});if(p){var r=d.nest().key(function(a,b){return void 0!==a.groupId?a.groupId:"unstacked"}).entries(q),s=[],t=r.map(function(a,b){if("unstacked"===a.key)return a.values;var c=a.values[0].r.map(function(a,b){return 0});return a.values.forEach(function(a,b,d){a.yStack=[c],s.push(c),c=g.util.sumArrays(a.r,c)}),a.values});o=d.merge(t)}o.forEach(function(a,b){a.t=Array.isArray(a.t[0])?a.t:[a.t],a.r=Array.isArray(a.r[0])?a.r:[a.r]});var u=Math.min(m.width-m.margin.left-m.margin.right,m.height-m.margin.top-m.margin.bottom)/2;u=Math.max(10,u);var v,w=[m.margin.left+u,m.margin.top+u];v=p?[0,d.max(g.util.sumArrays(g.util.arrayLast(o).r[0],g.util.arrayLast(s)))]:d.extent(g.util.flattenArray(o.map(function(a,b){return a.r}))),m.radialAxis.domain!=g.DATAEXTENT&&(v[0]=0),c=d.scale.linear().domain(m.radialAxis.domain!=g.DATAEXTENT&&m.radialAxis.domain?m.radialAxis.domain:v).range([0,u]),k.layout.radialAxis.domain=c.domain();var x,y=g.util.flattenArray(o.map(function(a,b){return a.t})),z="string"==typeof y[0];z&&(y=g.util.deduplicate(y),x=y.slice(),y=d.range(y.length),o=o.map(function(a,b){var c=a;return a.t=[y],p&&(c.yStack=a.yStack),c}));var A=o.filter(function(a,b){return"LinePlot"===a.geometry||"DotPlot"===a.geometry}).length===o.length,B=null===m.needsEndSpacing?z||!A:m.needsEndSpacing,C=m.angularAxis.domain&&m.angularAxis.domain!=g.DATAEXTENT&&!z&&m.angularAxis.domain[0]>=0?m.angularAxis.domain:d.extent(y),D=Math.abs(y[1]-y[0]);A&&!z&&(D=0);var E=C.slice();B&&z&&(E[1]+=D);var F=m.angularAxis.ticksCount||4;F>8&&(F=F/(F/8)+F%8),m.angularAxis.ticksStep&&(F=(E[1]-E[0])/F);var G=m.angularAxis.ticksStep||(E[1]-E[0])/(F*(m.minorTicks+1));x&&(G=Math.max(Math.round(G),1)),E[2]||(E[2]=G);var H=d.range.apply(this,E);if(H=H.map(function(a,b){return parseFloat(a.toPrecision(12))}),h=d.scale.linear().domain(E.slice(0,2)).range("clockwise"===m.direction?[0,360]:[360,0]),k.layout.angularAxis.domain=h.domain(),k.layout.angularAxis.endPadding=B?D:0,void 0===(a=d.select(this).select("svg.chart-root"))||a.empty()){var I=(new DOMParser).parseFromString("<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>","application/xml"),J=this.appendChild(this.ownerDocument.importNode(I.documentElement,!0));a=d.select(J)}a.select(".guides-group").style({"pointer-events":"none"}),a.select(".angular.axis-group").style({"pointer-events":"none"}),a.select(".radial.axis-group").style({"pointer-events":"none"});var K,L=a.select(".chart-group"),M={fill:"none",stroke:m.tickColor},N={"font-size":m.font.size,"font-family":m.font.family,fill:m.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(a,b){return" "+a+" 0 "+m.font.outlineColor}).join(",")};if(m.showLegend){K=a.select(".legend-group").attr({transform:"translate("+[u,m.margin.top]+")"}).style({display:"block"});var O=o.map(function(a,b){var c=g.util.cloneJson(a);return c.symbol="DotPlot"===a.geometry?a.dotType||"circle":"LinePlot"!=a.geometry?"square":"line",c.visibleInLegend=void 0===a.visibleInLegend||a.visibleInLegend,c.color="LinePlot"===a.geometry?a.strokeColor:a.color,c});g.Legend().config({data:o.map(function(a,b){return a.name||"Element"+b}),legendConfig:e({},g.Legend.defaultConfig().legendConfig,{container:K,elements:O,reverseOrder:m.legend.reverseOrder})})();var P=K.node().getBBox();u=Math.min(m.width-P.width-m.margin.left-m.margin.right,m.height-m.margin.top-m.margin.bottom)/2,u=Math.max(10,u),w=[m.margin.left+u,m.margin.top+u],c.range([0,u]),k.layout.radialAxis.domain=c.domain(),K.attr("transform","translate("+[w[0]+u,w[1]-u]+")")}else K=a.select(".legend-group").style({display:"none"});a.attr({width:m.width,height:m.height}).style({opacity:m.opacity}),L.attr("transform","translate("+w+")").style({cursor:"crosshair"});var Q=[(m.width-(m.margin.left+m.margin.right+2*u+(P?P.width:0)))/2,(m.height-(m.margin.top+m.margin.bottom+2*u))/2];if(Q[0]=Math.max(0,Q[0]),Q[1]=Math.max(0,Q[1]),a.select(".outer-group").attr("transform","translate("+Q+")"),m.title&&m.title.text){var R=a.select("g.title-group text").style(N).text(m.title.text),S=R.node().getBBox();R.attr({x:w[0]-S.width/2,y:w[1]-u-20})}var T=a.select(".radial.axis-group");if(m.radialAxis.gridLinesVisible){var U=T.selectAll("circle.grid-circle").data(c.ticks(5));U.enter().append("circle").attr({class:"grid-circle"}).style(M),U.attr("r",c),U.exit().remove()}T.select("circle.outside-circle").attr({r:u}).style(M);var V=a.select("circle.background-circle").attr({r:u}).style({fill:m.backgroundColor,stroke:m.stroke});if(m.radialAxis.visible){var W=d.svg.axis().scale(c).ticks(5).tickSize(5);T.call(W).attr({transform:"rotate("+m.radialAxis.orientation+")"}),T.selectAll(".domain").style(M),T.selectAll("g>text").text(function(a,b){return this.textContent+m.radialAxis.ticksSuffix}).style(N).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(a,b){return"horizontal"===m.radialAxis.tickOrientation?"rotate("+-m.radialAxis.orientation+") translate("+[0,N["font-size"]]+")":"translate("+[0,N["font-size"]]+")"}}),T.selectAll("g>line").style({stroke:"black"})}var X=a.select(".angular.axis-group").selectAll("g.angular-tick").data(H),Y=X.enter().append("g").classed("angular-tick",!0);X.attr({transform:function(a,b){return"rotate("+j(a)+")"}}).style({display:m.angularAxis.visible?"block":"none"}),X.exit().remove(),Y.append("line").classed("grid-line",!0).classed("major",function(a,b){return b%(m.minorTicks+1)==0}).classed("minor",function(a,b){return!(b%(m.minorTicks+1)==0)}).style(M),Y.selectAll(".minor").style({stroke:m.minorTickColor}),X.select("line.grid-line").attr({
x1:m.tickLength?u-m.tickLength:0,x2:u}).style({display:m.angularAxis.gridLinesVisible?"block":"none"}),Y.append("text").classed("axis-text",!0).style(N);var Z=X.select("text.axis-text").attr({x:u+m.labelOffset,dy:f+"em",transform:function(a,b){var c=j(a),d=u+m.labelOffset,e=m.angularAxis.tickOrientation;return"horizontal"==e?"rotate("+-c+" "+d+" 0)":"radial"==e?c<270&&c>90?"rotate(180 "+d+" 0)":null:"rotate("+(c<=180&&c>0?-90:90)+" "+d+" 0)"}}).style({"text-anchor":"middle",display:m.angularAxis.labelsVisible?"block":"none"}).text(function(a,b){return b%(m.minorTicks+1)!=0?"":x?x[a]+m.angularAxis.ticksSuffix:a+m.angularAxis.ticksSuffix}).style(N);m.angularAxis.rewriteTicks&&Z.text(function(a,b){return b%(m.minorTicks+1)!=0?"":m.angularAxis.rewriteTicks(this.textContent,b)});var $=d.max(L.selectAll(".angular-tick text")[0].map(function(a,b){return a.getCTM().e+a.getBBox().width}));K.attr({transform:"translate("+[u+$,m.margin.top]+")"});var _=a.select("g.geometry-group").selectAll("g").size()>0,aa=a.select("g.geometry-group").selectAll("g.geometry").data(o);if(aa.enter().append("g").attr({class:function(a,b){return"geometry geometry"+b}}),aa.exit().remove(),o[0]||_){var ba=[];o.forEach(function(a,b){var d={};d.radialScale=c,d.angularScale=h,d.container=aa.filter(function(a,c){return c==b}),d.geometry=a.geometry,d.orientation=m.orientation,d.direction=m.direction,d.index=b,ba.push({data:a,geometryConfig:d})});var ca=d.nest().key(function(a,b){return void 0!==a.data.groupId||"unstacked"}).entries(ba),da=[];ca.forEach(function(a,b){"unstacked"===a.key?da=da.concat(a.values.map(function(a,b){return[a]})):da.push(a.values)}),da.forEach(function(a,b){var c;c=Array.isArray(a)?a[0].geometryConfig.geometry:a.geometryConfig.geometry;var d=a.map(function(a,b){return e(g[c].defaultConfig(),a)});g[c]().config(d)()})}var ea,fa,ga=a.select(".guides-group"),ha=a.select(".tooltips-group"),ia=g.tooltipPanel().config({container:ha,fontSize:8})(),ja=g.tooltipPanel().config({container:ha,fontSize:8})(),ka=g.tooltipPanel().config({container:ha,hasTick:!0})();if(!z){var la=ga.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});L.on("mousemove.angular-guide",function(a,b){var c=g.util.getMousePos(V).angle;la.attr({x2:-u,transform:"rotate("+c+")"}).style({opacity:.5});var d=(c+180+360-m.orientation)%360;ea=h.invert(d);var e=g.util.convertToCartesian(u+12,c+180);ia.text(g.util.round(ea)).move([e[0]+w[0],e[1]+w[1]])}).on("mouseout.angular-guide",function(a,b){ga.select("line").style({opacity:0})})}var ma=ga.select("circle").style({stroke:"grey",fill:"none"});L.on("mousemove.radial-guide",function(a,b){var d=g.util.getMousePos(V).radius;ma.attr({r:d}).style({opacity:.5}),fa=c.invert(g.util.getMousePos(V).radius);var e=g.util.convertToCartesian(d,m.radialAxis.orientation);ja.text(g.util.round(fa)).move([e[0]+w[0],e[1]+w[1]])}).on("mouseout.radial-guide",function(a,b){ma.style({opacity:0}),ka.hide(),ia.hide(),ja.hide()}),a.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(b,c){var e=d.select(this),f=this.style.fill,h="black",i=this.style.opacity||1;if(e.attr({"data-opacity":i}),f&&"none"!==f){e.attr({"data-fill":f}),h=d.hsl(f).darker().toString(),e.style({fill:h,opacity:1});var j={t:g.util.round(b[0]),r:g.util.round(b[1])};z&&(j.t=x[b[0]]);var k="t: "+j.t+", r: "+j.r,l=this.getBoundingClientRect(),m=a.node().getBoundingClientRect(),n=[l.left+l.width/2-Q[0]-m.left,l.top+l.height/2-Q[1]-m.top];ka.config({color:h}).text(k),ka.move(n)}else f=this.style.stroke||"black",e.attr({"data-stroke":f}),h=d.hsl(f).darker().toString(),e.style({stroke:h,opacity:1})}).on("mousemove.tooltip",function(a,b){if(0!=d.event.which)return!1;d.select(this).attr("data-fill")&&ka.show()}).on("mouseout.tooltip",function(a,b){ka.hide();var c=d.select(this),e=c.attr("data-fill");e?c.style({fill:e,opacity:c.attr("data-opacity")}):c.style({stroke:c.attr("data-stroke"),opacity:c.attr("data-opacity")})})})}(j),this},m.config=function(a){if(!arguments.length)return i;var b=g.util.cloneJson(a);return b.data.forEach(function(a,b){i.data[b]||(i.data[b]={}),e(i.data[b],g.Axis.defaultConfig().data[0]),e(i.data[b],a)}),e(i.layout,g.Axis.defaultConfig().layout),e(i.layout,b.layout),this},m.getLiveConfig=function(){return k},m.getinputConfig=function(){return j},m.radialScale=function(a){return c},m.angularScale=function(a){return h},m.svg=function(){return a},d.rebind(m,l,"on"),m},g.Axis.defaultConfig=function(a,b){return{data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:!0,opacity:1}],layout:{defaultColorRange:d.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:!0,gridLinesVisible:!0,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:!0,gridLinesVisible:!0,labelsVisible:!0,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:!0,legend:{reverseOrder:!1},opacity:1}}},g.util={},g.DATAEXTENT="dataExtent",g.AREA="AreaChart",g.LINE="LinePlot",g.DOT="DotPlot",g.BAR="BarChart",g.util._override=function(a,b){for(var c in a)c in b&&(b[c]=a[c])},g.util._extend=function(a,b){for(var c in a)b[c]=a[c]},g.util._rndSnd=function(){return 2*Math.random()-1+(2*Math.random()-1)+(2*Math.random()-1)},g.util.dataFromEquation2=function(a,b){var c=b||6;return d.range(0,360+c,c).map(function(b,c){var d=b*Math.PI/180;return[b,a(d)]})},g.util.dataFromEquation=function(a,b,c){var e=b||6,f=[],g=[];d.range(0,360+e,e).forEach(function(b,c){var d=b*Math.PI/180,e=a(d);f.push(b),g.push(e)});var h={t:f,r:g};return c&&(h.name=c),h},g.util.ensureArray=function(a,b){if(void 0===a)return null;var c=[].concat(a);return d.range(b).map(function(a,b){return c[b]||c[0]})},g.util.fillArrays=function(a,b,c){return b.forEach(function(b,d){a[b]=g.util.ensureArray(a[b],c)}),a},g.util.cloneJson=function(a){return JSON.parse(JSON.stringify(a))},g.util.validateKeys=function(a,b){"string"==typeof b&&(b=b.split("."));var c=b.shift();return a[c]&&(!b.length||objHasKeys(a[c],b))},g.util.sumArrays=function(a,b){return d.zip(a,b).map(function(a,b){return d.sum(a)})},g.util.arrayLast=function(a){return a[a.length-1]},g.util.arrayEqual=function(a,b){for(var c=Math.max(a.length,b.length,1);c-- >=0&&a[c]===b[c];);return-2===c},g.util.flattenArray=function(a){for(var b=[];!g.util.arrayEqual(b,a);)b=a,a=[].concat.apply([],a);return a},g.util.deduplicate=function(a){return a.filter(function(a,b,c){return c.indexOf(a)==b})},g.util.convertToCartesian=function(a,b){var c=b*Math.PI/180;return[a*Math.cos(c),a*Math.sin(c)]},g.util.round=function(a,b){var c=b||2,d=Math.pow(10,c);return Math.round(a*d)/d},g.util.getMousePos=function(a){var b=d.mouse(a.node()),c=b[0],e=b[1],f={};return f.x=c,f.y=e,f.pos=b,f.angle=180*(Math.atan2(e,c)+Math.PI)/Math.PI,f.radius=Math.sqrt(c*c+e*e),f},g.util.duplicatesCount=function(a){for(var b,c={},d={},e=0,f=a.length;e<f;e++)(b=a[e])in c?(c[b]++,d[b]=c[b]):c[b]=1;return d},g.util.duplicates=function(a){return Object.keys(g.util.duplicatesCount(a))},g.util.translator=function(a,b,c,d){if(d){var e=c.slice();c=b,b=e}var f=b.reduce(function(a,b){if(void 0!==a)return a[b]},a);void 0!==f&&(b.reduce(function(a,c,d){if(void 0!==a)return d===b.length-1&&delete a[c],a[c]},a),c.reduce(function(a,b,d){return void 0===a[b]&&(a[b]={}),d===c.length-1&&(a[b]=f),a[b]},a))},g.PolyChart=function(){function a(){var a=b[0].geometryConfig,c=a.container;"string"==typeof c&&(c=d.select(c)),c.datum(b).each(function(b,c){var e=!!b[0].data.yStack,g=b.map(function(a,b){return e?d.zip(a.data.t[0],a.data.r[0],a.data.yStack[0]):d.zip(a.data.t[0],a.data.r[0])}),h=a.angularScale,i=a.radialScale.domain()[0],j={bar:function(c,e,f){var g=b[f].data,i=a.radialScale(c[1])-a.radialScale(0),j=a.radialScale(c[2]||0),k=g.barWidth;d.select(this).attr({class:"mark bar",d:"M"+[[i+j,-k/2],[i+j,k/2],[j,k/2],[j,-k/2]].join("L")+"Z",transform:function(b,c){return"rotate("+(a.orientation+h(b[0]))+")"}})}};j.dot=function(c,e,f){var g=c[2]?[c[0],c[1]+c[2]]:c,h=d.svg.symbol().size(b[f].data.dotSize).type(b[f].data.dotType)(c,e);d.select(this).attr({class:"mark dot",d:h,transform:function(b,c){var d,e,f,h=(d=function(b,c){return{r:a.radialScale(b[1]),t:(a.angularScale(b[0])+a.orientation)*Math.PI/180}}(g),e=d.r*Math.cos(d.t),f=d.r*Math.sin(d.t),{x:e,y:f});return"translate("+[h.x,h.y]+")"}})};var k=d.svg.line.radial().interpolate(b[0].data.lineInterpolation).radius(function(b){return a.radialScale(b[1])}).angle(function(b){return a.angularScale(b[0])*Math.PI/180});j.line=function(c,e,f){var h=c[2]?g[f].map(function(a,b){return[a[0],a[1]+a[2]]}):g[f];if(d.select(this).each(j.dot).style({opacity:function(a,c){return+b[f].data.dotVisible},fill:o.stroke(c,e,f)}).attr({class:"mark dot"}),!(e>0)){var i=d.select(this.parentNode).selectAll("path.line").data([0]);i.enter().insert("path"),i.attr({class:"line",d:k(h),transform:function(b,c){return"rotate("+(a.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(a,b){return o.fill(c,e,f)},"fill-opacity":0,stroke:function(a,b){return o.stroke(c,e,f)},"stroke-width":function(a,b){return o["stroke-width"](c,e,f)},"stroke-dasharray":function(a,b){return o["stroke-dasharray"](c,e,f)},opacity:function(a,b){return o.opacity(c,e,f)},display:function(a,b){return o.display(c,e,f)}})}};var l=a.angularScale.range(),m=Math.abs(l[1]-l[0])/g[0].length*Math.PI/180,n=d.svg.arc().startAngle(function(a){return-m/2}).endAngle(function(a){return m/2}).innerRadius(function(b){return a.radialScale(i+(b[2]||0))}).outerRadius(function(b){return a.radialScale(i+(b[2]||0))+a.radialScale(b[1])});j.arc=function(b,c,e){d.select(this).attr({class:"mark arc",d:n,transform:function(b,c){return"rotate("+(a.orientation+h(b[0])+90)+")"}})};var o={fill:function(a,c,d){return b[d].data.color},stroke:function(a,c,d){return b[d].data.strokeColor},"stroke-width":function(a,c,d){return b[d].data.strokeSize+"px"},"stroke-dasharray":function(a,c,d){return f[b[d].data.strokeDash]},opacity:function(a,c,d){return b[d].data.opacity},display:function(a,c,d){return void 0===b[d].data.visible||b[d].data.visible?"block":"none"}},p=d.select(this).selectAll("g.layer").data(g);p.enter().append("g").attr({class:"layer"});var q=p.selectAll("path.mark").data(function(a,b){return a});q.enter().append("path").attr({class:"mark"}),q.style(o).each(j[a.geometryType]),q.exit().remove(),p.exit().remove()})}var b=[g.PolyChart.defaultConfig()],c=d.dispatch("hover"),f={solid:"none",dash:[5,2],dot:[2,5]};return a.config=function(a){return arguments.length?(a.forEach(function(a,c){b[c]||(b[c]={}),e(b[c],g.PolyChart.defaultConfig()),e(b[c],a)}),this):b},a.getColorScale=function(){},d.rebind(a,c,"on"),a},g.PolyChart.defaultConfig=function(){return{data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:!1,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:!0,visibleInLegend:!0},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:d.scale.category20()}}},g.BarChart=function(){return g.PolyChart()},g.BarChart.defaultConfig=function(){return{geometryConfig:{geometryType:"bar"}}},g.AreaChart=function(){return g.PolyChart()},g.AreaChart.defaultConfig=function(){return{geometryConfig:{geometryType:"arc"}}},g.DotPlot=function(){return g.PolyChart()},g.DotPlot.defaultConfig=function(){return{geometryConfig:{geometryType:"dot",dotType:"circle"}}},g.LinePlot=function(){return g.PolyChart()},g.LinePlot.defaultConfig=function(){return{geometryConfig:{geometryType:"line"}}},g.Legend=function(){function a(){var c=b.legendConfig,f=b.data.map(function(a,b){return[].concat(a).map(function(a,d){var f=e({},c.elements[b]);return f.name=a,f.color=[].concat(c.elements[b].color)[d],f})}),g=d.merge(f);g=g.filter(function(a,b){return c.elements[b]&&(c.elements[b].visibleInLegend||void 0===c.elements[b].visibleInLegend)}),c.reverseOrder&&(g=g.reverse());var h=c.container;("string"==typeof h||h.nodeName)&&(h=d.select(h));var i=g.map(function(a,b){return a.color}),j=c.fontSize,k=null==c.isContinuous?"number"==typeof g[0]:c.isContinuous,l=k?c.height:j*g.length,m=h.classed("legend-group",!0).selectAll("svg").data([0]),n=m.enter().append("svg").attr({width:300,height:l+j,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});n.append("g").classed("legend-axis",!0),n.append("g").classed("legend-marks",!0);var o=d.range(g.length),p=d.scale[k?"linear":"ordinal"]().domain(o).range(i),q=d.scale[k?"linear":"ordinal"]().domain(o)[k?"range":"rangePoints"]([0,l]);if(k){var r=m.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(i);r.enter().append("stop"),r.attr({offset:function(a,b){return b/(i.length-1)*100+"%"}}).style({"stop-color":function(a,b){return a}}),m.append("rect").classed("legend-mark",!0).attr({height:c.height,width:c.colorBandWidth,fill:"url(#grad1)"})}else{var s=m.select(".legend-marks").selectAll("path.legend-mark").data(g);s.enter().append("path").classed("legend-mark",!0),s.attr({transform:function(a,b){return"translate("+[j/2,q(b)+j/2]+")"},d:function(a,b){var c,e,f,g=a.symbol;return f=3*(e=j),"line"===(c=g)?"M"+[[-e/2,-e/12],[e/2,-e/12],[e/2,e/12],[-e/2,e/12]]+"Z":-1!=d.svg.symbolTypes.indexOf(c)?d.svg.symbol().type(c).size(f)():d.svg.symbol().type("square").size(f)()},fill:function(a,b){return p(b)}}),s.exit().remove()}var t=d.svg.axis().scale(q).orient("right"),u=m.select("g.legend-axis").attr({transform:"translate("+[k?c.colorBandWidth:j,j/2]+")"}).call(t);return u.selectAll(".domain").style({fill:"none",stroke:"none"}),u.selectAll("line").style({fill:"none",stroke:k?c.textColor:"none"}),u.selectAll("text").style({fill:c.textColor,"font-size":c.fontSize}).text(function(a,b){return g[b].name}),a}var b=g.Legend.defaultConfig(),c=d.dispatch("hover");return a.config=function(a){return arguments.length?(e(b,a),this):b},d.rebind(a,c,"on"),a},g.Legend.defaultConfig=function(a,b){return{data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:!1}}},g.tooltipPanel=function(){var a,b,c,f={container:null,hasTick:!1,fontSize:12,color:"white",padding:5},h="tooltip-"+g.tooltipPanel.uid++,i=10,j=function(){var d=(a=f.container.selectAll("g."+h).data([0])).enter().append("g").classed(h,!0).style({"pointer-events":"none",display:"none"});return c=d.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"}),b=d.append("text").attr({dx:f.padding+i,dy:.3*+f.fontSize}),j};return j.text=function(e){var g=d.hsl(f.color).l,h=g>=.5?"#aaa":"white",k=g>=.5?"black":"white",l=e||"";b.style({fill:k,"font-size":f.fontSize+"px"}).text(l);var m=f.padding,n=b.node().getBBox(),o={fill:f.color,stroke:h,"stroke-width":"2px"},p=n.width+2*m+i,q=n.height+2*m;return c.attr({d:"M"+[[i,-q/2],[i,-q/4],[f.hasTick?0:i,0],[i,q/4],[i,q/2],[p,q/2],[p,-q/2]].join("L")+"Z"}).style(o),a.attr({transform:"translate("+[i,-q/2+2*m]+")"}),a.style({display:"block"}),j},j.move=function(b){if(a)return a.attr({transform:"translate("+[b[0],b[1]]+")"}).style({display:"block"}),j},j.hide=function(){if(a)return a.style({display:"none"}),j},j.show=function(){if(a)return a.style({display:"block"}),j},j.config=function(a){return e(f,a),j},j},g.tooltipPanel.uid=1,g.adapter={},g.adapter.plotly=function(){return{convert:function(a,b){var c={};if(a.data&&(c.data=a.data.map(function(a,c){var d=e({},a);return[[d,["marker","color"],["color"]],[d,["marker","opacity"],["opacity"]],[d,["marker","line","color"],["strokeColor"]],[d,["marker","line","dash"],["strokeDash"]],[d,["marker","line","width"],["strokeSize"]],[d,["marker","symbol"],["dotType"]],[d,["marker","size"],["dotSize"]],[d,["marker","barWidth"],["barWidth"]],[d,["line","interpolation"],["lineInterpolation"]],[d,["showlegend"],["visibleInLegend"]]].forEach(function(a,c){g.util.translator.apply(null,a.concat(b))}),b||delete d.marker,b&&delete d.groupId,b?("LinePlot"===d.geometry?(d.type="scatter",!0===d.dotVisible?(delete d.dotVisible,d.mode="lines+markers"):d.mode="lines"):"DotPlot"===d.geometry?(d.type="scatter",d.mode="markers"):"AreaChart"===d.geometry?d.type="area":"BarChart"===d.geometry&&(d.type="bar"),delete d.geometry):("scatter"===d.type?"lines"===d.mode?d.geometry="LinePlot":"markers"===d.mode?d.geometry="DotPlot":"lines+markers"===d.mode&&(d.geometry="LinePlot",d.dotVisible=!0):"area"===d.type?d.geometry="AreaChart":"bar"===d.type&&(d.geometry="BarChart"),delete d.mode,delete d.type),d}),!b&&a.layout&&"stack"===a.layout.barmode)){var f=g.util.duplicates(c.data.map(function(a,b){return a.geometry}));c.data.forEach(function(a,b){var d=f.indexOf(a.geometry);-1!=d&&(c.data[b].groupId=d)})}if(a.layout){var h=e({},a.layout);if([[h,["plot_bgcolor"],["backgroundColor"]],[h,["showlegend"],["showLegend"]],[h,["radialaxis"],["radialAxis"]],[h,["angularaxis"],["angularAxis"]],[h.angularaxis,["showline"],["gridLinesVisible"]],[h.angularaxis,["showticklabels"],["labelsVisible"]],[h.angularaxis,["nticks"],["ticksCount"]],[h.angularaxis,["tickorientation"],["tickOrientation"]],[h.angularaxis,["ticksuffix"],["ticksSuffix"]],[h.angularaxis,["range"],["domain"]],[h.angularaxis,["endpadding"],["endPadding"]],[h.radialaxis,["showline"],["gridLinesVisible"]],[h.radialaxis,["tickorientation"],["tickOrientation"]],[h.radialaxis,["ticksuffix"],["ticksSuffix"]],[h.radialaxis,["range"],["domain"]],[h.angularAxis,["showline"],["gridLinesVisible"]],[h.angularAxis,["showticklabels"],["labelsVisible"]],[h.angularAxis,["nticks"],["ticksCount"]],[h.angularAxis,["tickorientation"],["tickOrientation"]],[h.angularAxis,["ticksuffix"],["ticksSuffix"]],[h.angularAxis,["range"],["domain"]],[h.angularAxis,["endpadding"],["endPadding"]],[h.radialAxis,["showline"],["gridLinesVisible"]],[h.radialAxis,["tickorientation"],["tickOrientation"]],[h.radialAxis,["ticksuffix"],["ticksSuffix"]],[h.radialAxis,["range"],["domain"]],[h.font,["outlinecolor"],["outlineColor"]],[h.legend,["traceorder"],["reverseOrder"]],[h,["labeloffset"],["labelOffset"]],[h,["defaultcolorrange"],["defaultColorRange"]]].forEach(function(a,c){g.util.translator.apply(null,a.concat(b))}),b?(void 0!==h.tickLength&&(h.angularaxis.ticklen=h.tickLength,delete h.tickLength),h.tickColor&&(h.angularaxis.tickcolor=h.tickColor,delete h.tickColor)):(h.angularAxis&&void 0!==h.angularAxis.ticklen&&(h.tickLength=h.angularAxis.ticklen),h.angularAxis&&void 0!==h.angularAxis.tickcolor&&(h.tickColor=h.angularAxis.tickcolor)),h.legend&&"boolean"!=typeof h.legend.reverseOrder&&(h.legend.reverseOrder="normal"!=h.legend.reverseOrder),h.legend&&"boolean"==typeof h.legend.traceorder&&(h.legend.traceorder=h.legend.traceorder?"reversed":"normal",delete h.legend.reverseOrder),h.margin&&void 0!==h.margin.t){var i=["t","r","b","l","pad"],j=["top","right","bottom","left","pad"],k={};d.entries(h.margin).forEach(function(a,b){k[j[i.indexOf(a.key)]]=a.value}),h.margin=k}b&&(delete h.needsEndSpacing,delete h.minorTickColor,delete h.minorTicks,delete h.angularaxis.ticksCount,delete h.angularaxis.ticksCount,delete h.angularaxis.ticksStep,delete h.angularaxis.rewriteTicks,delete h.angularaxis.nticks,delete h.radialaxis.ticksCount,delete h.radialaxis.ticksCount,delete h.radialaxis.ticksStep,delete h.radialaxis.rewriteTicks,delete h.radialaxis.nticks),c.layout=h}return c}}}},{"../../../constants/alignment":688,"../../../lib":719,d3:164}],838:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../../lib"),f=a("../../../components/color"),g=a("./micropolar"),h=a("./undo_manager"),i=e.extendDeepAll,j=b.exports={};j.framework=function(a){function b(b,e){return e&&(l=e),d.select(d.select(l).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove(),c=c?i(c,b):b,f||(f=g.Axis()),k=g.adapter.plotly().convert(c),f.config(k).render(l),a.data=c.data,a.layout=c.layout,j.fillLayout(a),c}var c,e,f,k,l,m=new h;return b.isPolar=!0,b.svg=function(){return f.svg()},b.getConfig=function(){return c},b.getLiveConfig=function(){return g.adapter.plotly().convert(f.getLiveConfig(),!0)},b.getLiveScales=function(){return{t:f.angularScale(),r:f.radialScale()}},b.setUndoPoint=function(){var a,b,d=this,f=g.util.cloneJson(c);a=f,b=e,m.add({undo:function(){b&&d(b)},redo:function(){d(a)}}),e=g.util.cloneJson(f)},b.undo=function(){m.undo()},b.redo=function(){m.redo()},b},j.fillLayout=function(a){var b=d.select(a).selectAll(".plot-container"),c=b.selectAll(".svg-container"),e=a.framework&&a.framework.svg&&a.framework.svg(),g={width:800,height:600,paper_bgcolor:f.background,_container:b,_paperdiv:c,_paper:e};a._fullLayout=i(g,a.layout)}},{"../../../components/color":594,"../../../lib":719,"./micropolar":837,"./undo_manager":839,d3:164}],839:[function(a,b,c){"use strict";b.exports=function(){function a(a,b){return a?(e=!0,a[b](),e=!1,this):this}var b,c=[],d=-1,e=!1;return{add:function(a){return e?this:(c.splice(d+1,c.length-d),c.push(a),d=c.length-1,this)},setCallback:function(a){b=a},undo:function(){var e=c[d];return e?(a(e,"undo"),d-=1,b&&b(e.undo),this):this},redo:function(){var e=c[d+1];return e?(a(e,"redo"),d+=1,b&&b(e.redo),this):this},clear:function(){c=[],d=-1},hasUndo:function(){return-1!==d},hasRedo:function(){return d<c.length-1},getCommands:function(){return c},getPreviousCommand:function(){return c[d-1]},getIndex:function(){return d}}}},{}],840:[function(a,b,c){"use strict";function d(a,b){this.id=b,this.gd=a,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var c=a._fullLayout,d="clip"+c._uid+b;this.clipIds.forTraces=d+"-for-traces",this.clipPaths.forTraces=c._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=c._polarlayer.append("g").attr("class",b),this.radialTickLayout=null,this.angularTickLayout=null}function e(a){var b=a.ticks+String(a.ticklen)+String(a.showticklabels);return"side"in a&&(b+=a.side),b}function f(a,b){return b[m.findIndexOfMin(b,function(b){return m.angleDist(a,b)})]}function g(a,b,c){return b?(a.attr("display",null),a.attr(c)):a&&a.attr("display","none"),a}function h(a,b){return"translate("+a+","+b+")"}function i(a){return"rotate("+a+")"}var j=a("d3"),k=a("tinycolor2"),l=a("../../registry"),m=a("../../lib"),n=a("../../components/color"),o=a("../../components/drawing"),p=a("../plots"),q=a("../../plots/cartesian/axes"),r=a("../cartesian/set_convert"),s=a("./set_convert"),t=a("../cartesian/autorange").doAutoRange,u=a("../cartesian/dragbox"),v=a("../../components/dragelement"),w=a("../../components/fx"),x=a("../../components/titles"),y=a("../cartesian/select").prepSelect,z=a("../cartesian/select").selectOnClick,A=a("../cartesian/select").clearSelect,B=a("../../lib/setcursor"),C=a("../../lib/clear_gl_canvases"),D=a("../../plot_api/subroutines").redrawReglTraces,E=a("../../constants/alignment").MID_SHIFT,F=a("./constants"),G=a("./helpers"),H=m._,I=m.mod,J=m.deg2rad,K=m.rad2deg,L=d.prototype;b.exports=function(a,b){return new d(a,b)},L.plot=function(a,b){var c=b[this.id];this._hasClipOnAxisFalse=!1;for(var d=0;d<a.length;d++)if(!1===a[d][0].trace.cliponaxis){this._hasClipOnAxisFalse=!0;break}this.updateLayers(b,c),this.updateLayout(b,c),p.generalUpdatePerTraceModule(this.gd,this,a,c),this.updateFx(b,c)},L.updateLayers=function(a,b){var c=this.layers,d=b.radialaxis,e=b.angularaxis,f=F.layerNames,g=f.indexOf("frontplot"),h=f.slice(0,g),i="below traces"===e.layer,k="below traces"===d.layer;i&&h.push("angular-line"),k&&h.push("radial-line"),i&&h.push("angular-axis"),k&&h.push("radial-axis"),h.push("frontplot"),i||h.push("angular-line"),k||h.push("radial-line"),i||h.push("angular-axis"),k||h.push("radial-axis");var l=this.framework.selectAll(".polarsublayer").data(h,String);l.enter().append("g").attr("class",function(a){return"polarsublayer "+a}).each(function(a){var b=c[a]=j.select(this);switch(a){case"frontplot":b.append("g").classed("barlayer",!0),b.append("g").classed("scatterlayer",!0);break;case"backplot":b.append("g").classed("maplayer",!0);break;case"plotbg":c.bg=b.append("path");break;case"radial-grid":case"angular-grid":b.style("fill","none");break;case"radial-line":b.append("line").style("fill","none");break;case"angular-line":b.append("path").style("fill","none")}}),l.order()},L.updateLayout=function(a,b){var c=this.layers,d=a._size,e=b.radialaxis,f=b.angularaxis,g=b.domain.x,i=b.domain.y;this.xOffset=d.l+d.w*g[0],this.yOffset=d.t+d.h*(1-i[1]);var j=this.xLength=d.w*(g[1]-g[0]),k=this.yLength=d.h*(i[1]-i[0]),l=b.sector;this.sectorInRad=l.map(J);var m,p,q,r,s,t=this.sectorBBox=function(a){var b,c,d,e,f=a[0],g=a[1]-f,h=I(f,360),i=h+g,j=Math.cos(J(h)),k=Math.sin(J(h)),l=Math.cos(J(i)),m=Math.sin(J(i));return e=h<=90&&i>=90||h>90&&i>=450?1:k<=0&&m<=0?0:Math.max(k,m),b=h<=180&&i>=180||h>180&&i>=540?-1:j>=0&&l>=0?0:Math.min(j,l),c=h<=270&&i>=270||h>270&&i>=630?-1:k>=0&&m>=0?0:Math.min(k,m),d=i>=360?1:j<=0&&l<=0?0:Math.max(j,l),[b,c,d,e]}(l),u=t[2]-t[0],v=t[3]-t[1],w=k/j,x=Math.abs(v/u);w>x?(m=j,s=(k-(p=j*x))/d.h/2,q=[g[0],g[1]],r=[i[0]+s,i[1]-s]):(p=k,s=(j-(m=k/x))/d.w/2,q=[g[0]+s,g[1]-s],r=[i[0],i[1]]),this.xLength2=m,this.yLength2=p,this.xDomain2=q,this.yDomain2=r;var y=this.xOffset2=d.l+d.w*q[0],z=this.yOffset2=d.t+d.h*(1-r[1]),A=this.radius=m/u,B=this.innerRadius=b.hole*A,C=this.cx=y-A*t[0],D=this.cy=z+A*t[3],E=this.cxx=C-y,F=this.cyy=D-z;this.radialAxis=this.mockAxis(a,b,e,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[e.side],domain:[B/d.w,A/d.w]}),this.angularAxis=this.mockAxis(a,b,f,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(a,b),this.updateAngularAxis(a,b),this.updateRadialAxis(a,b),this.updateRadialAxisTitle(a,b),this.xaxis=this.mockCartesianAxis(a,b,{_id:"x",domain:q}),this.yaxis=this.mockCartesianAxis(a,b,{_id:"y",domain:r});var G=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",G).attr("transform",h(E,F)),c.frontplot.attr("transform",h(y,z)).call(o.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),c.bg.attr("d",G).attr("transform",h(C,D)).call(n.fill,b.bgcolor)},L.mockAxis=function(a,b,c,d){var e=m.extendFlat({},c,d);return s(e,b,a),e},L.mockCartesianAxis=function(a,b,c){var d=this,e=c._id,f=m.extendFlat({type:"linear"},c);r(f,a);var g={x:[0,2],y:[1,3]};return f.setRange=function(){var a=d.sectorBBox,c=g[e],h=d.radialAxis._rl,i=(h[1]-h[0])/(1-b.hole);f.range=[a[c[0]]*i,a[c[1]]*i]},f.isPtWithinRange="x"===e?function(a){return d.isPtInside(a)}:function(){return!0},f.setRange(),f.setScale(),f},L.doAutoRange=function(a,b){var c=this.gd,d=this.radialAxis,e=b.radialaxis;d.setScale(),t(c,d);var f=d.range;e.range=f.slice(),e._input.range=f.slice(),d._rl=[d.r2l(f[0],null,"gregorian"),d.r2l(f[1],null,"gregorian")]},L.updateRadialAxis=function(a,b){var c=this,d=c.gd,j=c.layers,k=c.radius,l=c.innerRadius,o=c.cx,p=c.cy,r=b.radialaxis,s=I(b.sector[0],360),t=c.radialAxis,u=l<k;c.fillViewInitialKey("radialaxis.angle",r.angle),c.fillViewInitialKey("radialaxis.range",t.range.slice()),t.setGeometry(),"auto"===t.tickangle&&s>90&&s<=270&&(t.tickangle=180);var v=function(a){return"translate("+(t.l2p(a.x)+l)+",0)"},w=e(r);if(c.radialTickLayout!==w&&(j["radial-axis"].selectAll(".xtick").remove(),c.radialTickLayout=w),u){t.setScale();var x=q.calcTicks(t),y=q.clipEnds(t,x),z=q.getTickSigns(t)[2];q.drawTicks(d,t,{vals:x,layer:j["radial-axis"],path:q.makeTickPath(t,0,z),transFn:v,crisp:!1}),q.drawGrid(d,t,{vals:y,layer:j["radial-grid"],path:function(a){return c.pathArc(t.r2p(a.x)+l)},transFn:m.noop,crisp:!1}),q.drawLabels(d,t,{vals:x,layer:j["radial-axis"],transFn:v,labelFns:q.makeLabelFns(t,0)})}var A=c.radialAxisAngle=c.vangles?K(f(J(r.angle),c.vangles)):r.angle,B=h(o,p),C=B+i(-A);g(j["radial-axis"],u&&(r.showticklabels||r.ticks),{transform:C}),g(j["radial-grid"],u&&r.showgrid,{transform:B}),g(j["radial-line"].select("line"),u&&r.showline,{x1:l,y1:0,x2:k,y2:0,transform:C}).attr("stroke-width",r.linewidth).call(n.stroke,r.linecolor)},L.updateRadialAxisTitle=function(a,b,c){var d=this.gd,e=this.radius,f=this.cx,g=this.cy,h=b.radialaxis,i=this.id+"title",j=void 0!==c?c:this.radialAxisAngle,k=J(j),l=Math.cos(k),m=Math.sin(k),n=0;if(h.title){var p=o.bBox(this.layers["radial-axis"].node()).height,q=h.title.font.size;n="counterclockwise"===h.side?-p-.4*q:p+.8*q}this.layers["radial-axis-title"]=x.draw(d,i,{propContainer:h,propName:this.id+".radialaxis.title",placeholder:H(d,"Click to enter radial axis title"),attributes:{x:f+e/2*l+n*m,y:g-e/2*m+n*l,"text-anchor":"middle"},transform:{rotate:-j}})},L.updateAngularAxis=function(a,b){var c=this,d=c.gd,f=c.layers,j=c.radius,k=c.innerRadius,l=c.cx,o=c.cy,p=b.angularaxis,r=c.angularAxis;c.fillViewInitialKey("angularaxis.rotation",p.rotation),r.setGeometry(),r.setScale();var s=function(a){return r.t2g(a.x)};"linear"===r.type&&"radians"===r.thetaunit&&(r.tick0=K(r.tick0),r.dtick=K(r.dtick));var t=function(a){return h(l+j*Math.cos(a),o-j*Math.sin(a))},u=q.makeLabelFns(r,0).labelStandoff,v={xFn:function(a){var b=s(a);return Math.cos(b)*u},yFn:function(a){var b=s(a),c=Math.sin(b)>0?.2:1;return-Math.sin(b)*(u+a.fontSize*c)+Math.abs(Math.cos(b))*(a.fontSize*E)},anchorFn:function(a){var b=s(a),c=Math.cos(b);return Math.abs(c)<.1?"middle":c>0?"start":"end"},heightFn:function(a,b,c){var d=s(a);return-.5*(1+Math.sin(d))*c}},w=e(p);c.angularTickLayout!==w&&(f["angular-axis"].selectAll("."+r._id+"tick").remove(),c.angularTickLayout=w);var x,y=q.calcTicks(r);if("linear"===b.gridshape?(x=y.map(s),m.angleDelta(x[0],x[1])<0&&(x=x.slice().reverse())):x=null,c.vangles=x,"category"===r.type&&(y=y.filter(function(a){return m.isAngleInsideSector(s(a),c.sectorInRad)})),r.visible){var z="inside"===r.ticks?-1:1,A=(r.linewidth||1)/2;q.drawTicks(d,r,{vals:y,layer:f["angular-axis"],path:"M"+z*A+",0h"+z*r.ticklen,transFn:function(a){var b=s(a);return t(b)+i(-K(b))},crisp:!1}),q.drawGrid(d,r,{vals:y,layer:f["angular-grid"],path:function(a){var b=s(a),c=Math.cos(b),d=Math.sin(b);return"M"+[l+k*c,o-k*d]+"L"+[l+j*c,o-j*d]},transFn:m.noop,crisp:!1}),q.drawLabels(d,r,{vals:y,layer:f["angular-axis"],repositionOnUpdate:!0,transFn:function(a){return t(s(a))},labelFns:v})}g(f["angular-line"].select("path"),p.showline,{d:c.pathSubplot(),transform:h(l,o)}).attr("stroke-width",p.linewidth).call(n.stroke,p.linecolor)},L.updateFx=function(a,b){this.gd._context.staticPlot||(this.updateAngularDrag(a),this.updateRadialDrag(a,b,0),this.updateRadialDrag(a,b,1),this.updateMainDrag(a))},L.updateMainDrag=function(a){function b(a,b){return Math.sqrt(a*a+b*b)}function c(a,c){return b(a-L,c-M)}function d(a,b){return Math.atan2(M-b,a-L)}function e(a,b){return[a*Math.cos(b),a*Math.sin(-b)]}function f(a,b){if(0===a)return t.pathSector(2*T);var c=U/a,d=b-c,f=b+c,g=Math.max(0,Math.min(a,H)),h=g-T,i=g+T;return"M"+e(h,d)+"A"+[h,h]+" 0,0,0 "+e(h,f)+"L"+e(i,f)+"A"+[i,i]+" 0,0,1 "+e(i,d)+"Z"}function g(a,b,c){if(0===a)return t.pathSector(2*T);var d,f,g=e(a,b),h=e(a,c),i=Q((g[0]+h[0])/2),j=Q((g[1]+h[1])/2);if(i&&j){var k=j/i,l=-1/k,m=R(T,k,i,j);d=R(U,l,m[0][0],m[0][1]),f=R(U,l,m[1][0],m[1][1])}else{var n,o;j?(n=U,o=T):(n=T,o=U),d=[[i-n,j-o],[i+n,j-o]],f=[[i-n,j+o],[i+n,j+o]]}return"M"+d.join("L")+"L"+f.reverse().join("L")+"Z"}function i(a,b){return b=Math.max(Math.min(b,H),I),
a<E?a=0:H-a<E?a=H:b<E?b=0:H-b<E&&(b=H),Math.abs(b-a)>D?(a<b?(Y=a,Z=b):(Y=b,Z=a),!0):(Y=null,Z=null,!1)}function m(a,b){a=a||$,b=b||"M0,0Z",ba.attr("d",a),ca.attr("d",b),u.transitionZoombox(ba,ca,_,aa),_=!0;var c={};r(c),x.emit("plotly_relayouting",c)}function n(a,b){var e,g,h=W+a,j=X+b,k=c(W,X),l=Math.min(c(h,j),H),n=d(W,X);i(k,l)&&(e=$+t.pathSector(Z),Y&&(e+=t.pathSector(Y)),g=f(Y,n)+f(Z,n)),m(e,g)}function o(a,c,d,e){var f=G.findIntersectionXY(d,e,d,[a-L,M-c]);return b(f[0],f[1])}function p(a,b){var c,e,f=W+a,h=X+b,j=d(W,X),k=d(f,h),l=S(j,O),n=S(k,O);i(o(W,X,l[0],l[1]),Math.min(o(f,h,n[0],n[1]),H))&&(c=$+t.pathSector(Z),Y&&(c+=t.pathSector(Y)),e=[g(Y,l[0],l[1]),g(Z,l[0],l[1])].join(" ")),m(c,e)}function q(){if(u.removeZoombox(x),null!==Y&&null!==Z){var a={};r(a),u.showDoubleClickNotifier(x),l.call("_guiRelayout",x,a)}}function r(a){var b=P._rl,c=(b[1]-b[0])/(1-I/H)/H,d=[b[0]+(Y-I)*c,b[0]+(Z-I)*c];a[t.id+".radialaxis.range"]=d}function s(a,b){var c=x._fullLayout.clickmode;if(u.removeZoombox(x),2===a){var d={};for(var e in t.viewInitial)d[t.id+"."+e]=t.viewInitial[e];x.emit("plotly_doubleclick",null),l.call("_guiRelayout",x,d)}c.indexOf("select")>-1&&1===a&&z(b,x,[t.xaxis],[t.yaxis],t.id,da),c.indexOf("event")>-1&&w.click(x,b,t.id)}var t=this,x=t.gd,B=t.layers,C=a._zoomlayer,D=F.MINZOOM,E=F.OFFEDGE,H=t.radius,I=t.innerRadius,J=t.cx,K=t.cy,L=t.cxx,M=t.cyy,N=t.sectorInRad,O=t.vangles,P=t.radialAxis,Q=G.clampTiny,R=G.findXYatLength,S=G.findEnclosingVertexAngles,T=F.cornerHalfWidth,U=F.cornerLen/2,V=u.makeDragger(B,"path","maindrag","crosshair");j.select(V).attr("d",t.pathSubplot()).attr("transform",h(J,K));var W,X,Y,Z,$,_,aa,ba,ca,da={element:V,gd:x,subplot:t.id,plotinfo:{id:t.id,xaxis:t.xaxis,yaxis:t.yaxis},xaxes:[t.xaxis],yaxes:[t.yaxis]};da.prepFn=function(a,b,c){var d=x._fullLayout.dragmode,e=V.getBoundingClientRect();if(W=b-e.left,X=c-e.top,O){var f=G.findPolygonOffset(H,N[0],N[1],O);W+=L+f[0],X+=M+f[1]}switch(d){case"zoom":da.moveFn=O?p:n,da.clickFn=s,da.doneFn=q,function(){Y=null,Z=null,$=t.pathSubplot(),_=!1;var a=x._fullLayout[t.id];aa=k(a.bgcolor).getLuminance(),(ba=u.makeZoombox(C,aa,J,K,$)).attr("fill-rule","evenodd"),ca=u.makeCorners(C,J,K),A(x)}();break;case"select":case"lasso":y(a,b,c,da,d)}},V.onmousemove=function(a){w.hover(x,a,t.id),x._fullLayout._lasthover=V,x._fullLayout._hoversubplot=t.id},V.onmouseout=function(a){x._dragging||v.unhover(x,a)},v.init(da)},L.updateRadialDrag=function(a,b,c){function d(a,b){if(P)P(a,b);else{var d=[a,-b],e=[Math.cos(H),Math.sin(H)],f=Math.abs(m.dot(d,e)/Math.sqrt(m.dot(d,d)));isNaN(f)||(P=f<.5?k:n)}var g={};!function(a){null!==Q?a[o.id+".radialaxis.angle"]=Q:null!==R&&(a[o.id+".radialaxis.range["+c+"]"]=R)}(g),p.emit("plotly_relayouting",g)}function e(){null!==Q?l.call("_guiRelayout",p,o.id+".radialaxis.angle",Q):null!==R&&l.call("_guiRelayout",p,o.id+".radialaxis.range["+c+"]",R)}function k(a,b){if(0!==c){var d=B+a,e=E+b;Q=Math.atan2(w-e,d-t),o.vangles&&(Q=f(Q,o.vangles)),Q=K(Q);var g=h(t,w)+i(-Q);q["radial-axis"].attr("transform",g),q["radial-line"].select("line").attr("transform",g);var j=o.gd._fullLayout,k=j[o.id];o.updateRadialAxisTitle(j,k,Q)}}function n(a,b){var d=m.dot([a,-b],[Math.cos(H),Math.sin(H)]);if(R=N-O*d,O>0==(c?R>L:R<M)){var e=p._fullLayout,f=e[o.id];x.range[c]=R,x._rl[c]=R,o.updateRadialAxis(e,f),o.xaxis.setRange(),o.xaxis.setScale(),o.yaxis.setRange(),o.yaxis.setScale();var g=!1;for(var h in o.traceHash){var i=o.traceHash[h],j=m.filterVisible(i);i[0][0].trace._module.plot(p,o,j,f),l.traceIs(h,"gl")&&j.length&&(g=!0)}g&&(C(p),D(p))}else R=null}var o=this,p=o.gd,q=o.layers,r=o.radius,s=o.innerRadius,t=o.cx,w=o.cy,x=o.radialAxis,y=F.radialDragBoxSize,z=y/2;if(x.visible){var B,E,G,H=J(o.radialAxisAngle),I=x._rl,L=I[0],M=I[1],N=I[c],O=.75*(I[1]-I[0])/(1-b.hole)/r;c?(B=t+(r+z)*Math.cos(H),E=w-(r+z)*Math.sin(H),G="radialdrag"):(B=t+(s-z)*Math.cos(H),E=w-(s-z)*Math.sin(H),G="radialdrag-inner");var P,Q,R,S=u.makeRectDragger(q,G,"crosshair",-z,-z,y,y),T={element:S,gd:p};g(j.select(S),x.visible&&s<r,{transform:h(B,E)}),T.prepFn=function(){P=null,Q=null,R=null,T.moveFn=d,T.doneFn=e,A(p)},T.clampFn=function(a,b){return Math.sqrt(a*a+b*b)<F.MINDRAG&&(a=0,b=0),[a,b]},v.init(T)}},L.updateAngularDrag=function(a){function b(a,b){return Math.atan2(t+w-b,a-s-w)}function c(a,c){var e=f.gd._fullLayout,n=e[f.id],u=b(z+a,E+c),v=K(u-J);if(H=G+v,k.frontplot.attr("transform",h(f.xOffset2,f.yOffset2)+i([-v,s,t])),f.vangles){I=f.radialAxisAngle+v;var w=h(q,r)+i(-v),x=h(q,r)+i(-I);k.bg.attr("transform",w),k["radial-grid"].attr("transform",w),k["radial-axis"].attr("transform",x),k["radial-line"].select("line").attr("transform",x),f.updateRadialAxisTitle(e,n,I)}else f.clipPaths.forTraces.select("path").attr("transform",h(s,t)+i(v));M.each(function(){var a=j.select(this),b=o.getTranslate(a);a.attr("transform",h(b.x,b.y)+i([v]))}),N.each(function(){var a=j.select(this),b=a.select("text"),c=o.getTranslate(a);a.attr("transform",i([v,b.attr("x"),b.attr("y")])+h(c.x,c.y))}),p.rotation=m.modHalf(H,360),f.updateAngularAxis(e,n),f._hasClipOnAxisFalse&&!m.isFullCircle(f.sectorInRad)&&L.call(o.hideOutsideRangePoints,f);var y=!1;for(var A in f.traceHash)if(l.traceIs(A,"gl")){var B=f.traceHash[A],F=m.filterVisible(B);B[0][0].trace._module.plot(g,f,F,n),F.length&&(y=!0)}y&&(C(g),D(g));var O={};d(O),g.emit("plotly_relayouting",O)}function d(a){a[f.id+".angularaxis.rotation"]=H,f.vangles&&(a[f.id+".radialaxis.angle"]=I)}function e(){N.select("text").attr("transform",null);var a={};d(a),l.call("_guiRelayout",g,a)}var f=this,g=f.gd,k=f.layers,n=f.radius,p=f.angularAxis,q=f.cx,r=f.cy,s=f.cxx,t=f.cyy,w=F.angularDragBoxSize,x=u.makeDragger(k,"path","angulardrag","move"),y={element:x,gd:g};j.select(x).attr("d",f.pathAnnulus(n,n+w)).attr("transform",h(q,r)).call(B,"move");var z,E,G,H,I,J,L=k.frontplot.select(".scatterlayer").selectAll(".trace"),M=L.selectAll(".point"),N=L.selectAll(".textpoint");y.prepFn=function(d,h,i){var j=a[f.id];G=j.angularaxis.rotation;var k=x.getBoundingClientRect();z=h-k.left,E=i-k.top,J=b(z,E),y.moveFn=c,y.doneFn=e,A(g)},f.vangles&&!m.isFullCircle(f.sectorInRad)&&(y.prepFn=m.noop,B(j.select(x),null)),v.init(y)},L.isPtInside=function(a){var b=this.sectorInRad,c=this.vangles,d=this.angularAxis.c2g(a.theta),e=this.radialAxis,f=e.c2l(a.r),g=e._rl;return(c?G.isPtInsidePolygon:m.isPtInsideSector)(f,d,g,b,c)},L.pathArc=function(a){var b=this.sectorInRad,c=this.vangles;return(c?G.pathPolygon:m.pathArc)(a,b[0],b[1],c)},L.pathSector=function(a){var b=this.sectorInRad,c=this.vangles;return(c?G.pathPolygon:m.pathSector)(a,b[0],b[1],c)},L.pathAnnulus=function(a,b){var c=this.sectorInRad,d=this.vangles;return(d?G.pathPolygonAnnulus:m.pathAnnulus)(a,b,c[0],c[1],d)},L.pathSubplot=function(){var a=this.innerRadius,b=this.radius;return a?this.pathAnnulus(a,b):this.pathSector(b)},L.fillViewInitialKey=function(a,b){a in this.viewInitial||(this.viewInitial[a]=b)}},{"../../components/color":594,"../../components/dragelement":612,"../../components/drawing":615,"../../components/fx":632,"../../components/titles":681,"../../constants/alignment":688,"../../lib":719,"../../lib/clear_gl_canvases":704,"../../lib/setcursor":739,"../../plot_api/subroutines":758,"../../plots/cartesian/axes":767,"../../registry":848,"../cartesian/autorange":766,"../cartesian/dragbox":775,"../cartesian/select":784,"../cartesian/set_convert":785,"../plots":828,"./constants":829,"./helpers":830,"./set_convert":841,d3:164,tinycolor2:538}],841:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../cartesian/set_convert"),f=d.deg2rad,g=d.rad2deg;b.exports=function(a,b,c){switch(e(a,c),a._id){case"x":case"radialaxis":!function(a,b){var c=b._subplot;a.setGeometry=function(){var b=a._rl[0],d=a._rl[1],e=c.innerRadius,f=(c.radius-e)/(d-b),g=e/f,h=b>d?function(a){return a<=0}:function(a){return a>=0};a.c2g=function(c){var d=a.c2l(c)-b;return(h(d)?d:0)+g},a.g2c=function(c){return a.l2c(c+b-g)},a.g2p=function(a){return a*f},a.c2p=function(b){return a.g2p(a.c2g(b))}}}(a,b);break;case"angularaxis":!function(a,b){var c=a.type;if("linear"===c){var e=a.d2c,h=a.c2d;a.d2c=function(a,b){return function(a,b){return"degrees"===b?f(a):a}(e(a),b)},a.c2d=function(a,b){return h(function(a,b){return"degrees"===b?g(a):a}(a,b))}}a.makeCalcdata=function(b,e){var f,g,h=b[e],i=b._length,j=function(c){return a.d2c(c,b.thetaunit)};if(h){if(d.isTypedArray(h)&&"linear"===c){if(i===h.length)return h;if(h.subarray)return h.subarray(0,i)}for(f=new Array(i),g=0;g<i;g++)f[g]=j(h[g])}else{var k=e+"0",l="d"+e,m=k in b?j(b[k]):0,n=b[l]?j(b[l]):(a.period||2*Math.PI)/i;for(f=new Array(i),g=0;g<i;g++)f[g]=m+g*n}return f},a.setGeometry=function(){var e,h,i,j,k=b.sector,l=k.map(f),m={clockwise:-1,counterclockwise:1}[a.direction],n=f(a.rotation),o=function(a){return m*a+n},p=function(a){return(a-n)/m};switch(c){case"linear":h=e=d.identity,j=f,i=g,a.range=d.isFullCircle(l)?[k[0],k[0]+360]:l.map(p).map(g);break;case"category":var q=a._categories.length,r=a.period?Math.max(a.period,q):q;0===r&&(r=1),h=j=function(a){return 2*a*Math.PI/r},e=i=function(a){return a*r/Math.PI/2},a.range=[0,r]}a.c2g=function(a){return o(h(a))},a.g2c=function(a){return e(p(a))},a.t2g=function(a){return o(j(a))},a.g2t=function(a){return i(p(a))}}}(a,b)}}},{"../../lib":719,"../cartesian/set_convert":785}],842:[function(a,b,c){"use strict";var d=a("../lib"),e=a("../plot_api/plot_template"),f=a("./domain").defaults;b.exports=function(a,b,c,g){function h(a,b){return d.coerce(i,j,l,a,b)}for(var i,j,k=g.type,l=g.attributes,m=g.handleDefaults,n=g.partition||"x",o=b._subplots[k],p=o.length,q=p&&o[0].replace(/\d+$/,""),r=0;r<p;r++){var s=o[r];i=a[s]?a[s]:a[s]={},j=e.newContainer(b,s,q),h("uirevision",b.uirevision);var t={};t[n]=[r/p,(r+1)/p],f(j,b,h,t),g.id=s,m(i,j,h,g)}}},{"../lib":719,"../plot_api/plot_template":757,"./domain":792}],843:[function(a,b,c){"use strict";function d(a){var b=a.description?" "+a.description:"",c=a.keys||[];if(c.length>0){for(var d=[],e=0;e<c.length;e++)d[e]="`"+c[e]+"`";b+="Finally, the template string has access to ",b=1===c.length?"variable "+d[0]:"variables "+d.slice(0,-1).join(", ")+" and "+d.slice(-1)+"."}return b}['Variables are inserted using %{variable}, for example "y: %{y}".','Numbers are formatted using d3-format\'s syntax %{variable:d3-format}, for example "Price: %{y:$.2f}".',a("../constants/docs").FORMAT_LINK,"for details on the formatting syntax.",'Dates are formatted using d3-time-format\'s syntax %{variable|d3-time-format}, for example "Day: %{2019-01-01|%A}".',a("../constants/docs").DATE_FORMAT_LINK,"for details on the date formatting syntax."].join(" "),c.hovertemplateAttrs=function(a,b){a=a||{},d(b=b||{});var c={valType:"string",dflt:"",editType:a.editType||"none"};return!1!==a.arrayOk&&(c.arrayOk=!0),c},c.texttemplateAttrs=function(a,b){a=a||{},d(b=b||{});var c={valType:"string",dflt:"",editType:a.editType||"calc"};return!1!==a.arrayOk&&(c.arrayOk=!0),c}},{"../constants/docs":690}],844:[function(a,b,c){"use strict";var d=a("./ternary"),e=a("../../plots/get_data").getSubplotCalcData,f=a("../../lib").counterRegex;c.name="ternary";var g=c.attr="subplot";c.idRoot="ternary",c.idRegex=c.attrRegex=f("ternary"),(c.attributes={})[g]={valType:"subplotid",dflt:"ternary",editType:"calc"},c.layoutAttributes=a("./layout_attributes"),c.supplyLayoutDefaults=a("./layout_defaults"),c.plot=function(a){for(var b=a._fullLayout,c=a.calcdata,f=b._subplots.ternary,g=0;g<f.length;g++){var h=f[g],i=e(c,"ternary",h),j=b[h]._subplot;j||(j=new d({id:h,graphDiv:a,container:b._ternarylayer.node()},b),b[h]._subplot=j),j.plot(i,b,a._promises)}},c.clean=function(a,b,c,d){for(var e=d._subplots.ternary||[],f=0;f<e.length;f++){var g=e[f],h=d[g]._subplot;!b[g]&&h&&(h.plotContainer.remove(),h.clipDef.remove(),h.clipDefRelative.remove(),h.layers["a-title"].remove(),h.layers["b-title"].remove(),h.layers["c-title"].remove())}}},{"../../lib":719,"../../plots/get_data":802,"./layout_attributes":845,"./layout_defaults":846,"./ternary":847}],845:[function(a,b,c){"use strict";var d=a("../../components/color/attributes"),e=a("../domain").attributes,f=a("../cartesian/layout_attributes"),g=a("../../plot_api/edit_types").overrideAll,h=a("../../lib/extend").extendFlat,i={title:f.title,color:f.color,tickmode:f.tickmode,nticks:h({},f.nticks,{dflt:6,min:1}),tick0:f.tick0,dtick:f.dtick,tickvals:f.tickvals,ticktext:f.ticktext,ticks:f.ticks,ticklen:f.ticklen,tickwidth:f.tickwidth,tickcolor:f.tickcolor,showticklabels:f.showticklabels,showtickprefix:f.showtickprefix,tickprefix:f.tickprefix,showticksuffix:f.showticksuffix,ticksuffix:f.ticksuffix,showexponent:f.showexponent,exponentformat:f.exponentformat,separatethousands:f.separatethousands,tickfont:f.tickfont,tickangle:f.tickangle,tickformat:f.tickformat,tickformatstops:f.tickformatstops,hoverformat:f.hoverformat,showline:h({},f.showline,{dflt:!0}),linecolor:f.linecolor,linewidth:f.linewidth,showgrid:h({},f.showgrid,{dflt:!0}),gridcolor:f.gridcolor,gridwidth:f.gridwidth,layer:f.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:f._deprecated.title,titlefont:f._deprecated.titlefont}},j=b.exports=g({domain:e({name:"ternary"}),bgcolor:{valType:"color",dflt:d.background},sum:{valType:"number",dflt:1,min:0},aaxis:i,baxis:i,caxis:i},"plot","from-root");j.uirevision={valType:"any",editType:"none"},j.aaxis.uirevision=j.baxis.uirevision=j.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":593,"../../lib/extend":710,"../../plot_api/edit_types":750,"../cartesian/layout_attributes":779,"../domain":792}],846:[function(a,b,c){"use strict";function d(a,b,c,d){var h,i,j,k=c("bgcolor"),l=c("sum");d.bgColor=f.combine(k,d.paper_bgcolor);for(var m=0;m<o.length;m++)i=a[h=o[m]]||{},(j=g.newContainer(b,h))._name=h,e(i,j,d,b);var n=b.aaxis,p=b.baxis,q=b.caxis;n.min+p.min+q.min>=l&&(n.min=0,p.min=0,q.min=0,a.aaxis&&delete a.aaxis.min,a.baxis&&delete a.baxis.min,a.caxis&&delete a.caxis.min)}function e(a,b,c,d){function e(c,d){return h.coerce(a,b,f,c,d)}var f=n[b._name];e("uirevision",d.uirevision),b.type="linear";var g=e("color"),i=g!==f.color.dflt?g:c.font.color,o=b._name.charAt(0).toUpperCase(),p="Component "+o,q=e("title.text",p);b._hovertitle=q===p?q:o,h.coerceFont(e,"title.font",{family:c.font.family,size:Math.round(1.2*c.font.size),color:i}),e("min"),l(a,b,e,"linear"),j(a,b,e,"linear",{}),k(a,b,e,{outerTicks:!0}),e("showticklabels")&&(h.coerceFont(e,"tickfont",{family:c.font.family,size:c.font.size,color:i}),e("tickangle"),e("tickformat")),m(a,b,e,{dfltColor:g,bgColor:c.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:f}),e("hoverformat"),e("layer")}var f=a("../../components/color"),g=a("../../plot_api/plot_template"),h=a("../../lib"),i=a("../subplot_defaults"),j=a("../cartesian/tick_label_defaults"),k=a("../cartesian/tick_mark_defaults"),l=a("../cartesian/tick_value_defaults"),m=a("../cartesian/line_grid_defaults"),n=a("./layout_attributes"),o=["aaxis","baxis","caxis"];b.exports=function(a,b,c){i(a,b,c,{type:"ternary",attributes:n,handleDefaults:d,font:b.font,paper_bgcolor:b.paper_bgcolor})}},{"../../components/color":594,"../../lib":719,"../../plot_api/plot_template":757,"../cartesian/line_grid_defaults":781,"../cartesian/tick_label_defaults":786,"../cartesian/tick_mark_defaults":787,"../cartesian/tick_value_defaults":788,"../subplot_defaults":842,"./layout_attributes":845}],847:[function(a,b,c){"use strict";function d(a,b){this.id=a.id,this.graphDiv=a.graphDiv,this.init(b),this.makeFramework(b),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}function e(a){f.select(a).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}var f=a("d3"),g=a("tinycolor2"),h=a("../../registry"),i=a("../../lib"),j=i._,k=a("../../components/color"),l=a("../../components/drawing"),m=a("../cartesian/set_convert"),n=a("../../lib/extend").extendFlat,o=a("../plots"),p=a("../cartesian/axes"),q=a("../../components/dragelement"),r=a("../../components/fx"),s=a("../../components/titles"),t=a("../cartesian/select").prepSelect,u=a("../cartesian/select").selectOnClick,v=a("../cartesian/select").clearSelect,w=a("../cartesian/constants");b.exports=d;var x=d.prototype;x.init=function(a){this.container=a._ternarylayer,this.defs=a._defs,this.layoutId=a._uid,this.traceHash={},this.layers={}},x.plot=function(a,b){var c=b[this.id],d=b._size;this._hasClipOnAxisFalse=!1;for(var e=0;e<a.length;e++)if(!1===a[e][0].trace.cliponaxis){this._hasClipOnAxisFalse=!0;break}this.updateLayers(c),this.adjustLayout(c,d),o.generalUpdatePerTraceModule(this.graphDiv,this,a,c),this.layers.plotbg.select("path").call(k.fill,c.bgcolor)},x.makeFramework=function(a){var b=this.graphDiv,c=a[this.id],d=this.clipId="clip"+this.layoutId+this.id,e=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=i.ensureSingleById(a._clips,"clipPath",d,function(a){a.append("path").attr("d","M0,0Z")}),this.clipDefRelative=i.ensureSingleById(a._clips,"clipPath",e,function(a){a.append("path").attr("d","M0,0Z")}),this.plotContainer=i.ensureSingle(this.container,"g",this.id),this.updateLayers(c),l.setClipUrl(this.layers.backplot,d,b),l.setClipUrl(this.layers.grids,d,b)},x.updateLayers=function(a){var b=this.layers,c=["draglayer","plotbg","backplot","grids"];"below traces"===a.aaxis.layer&&c.push("aaxis","aline"),"below traces"===a.baxis.layer&&c.push("baxis","bline"),"below traces"===a.caxis.layer&&c.push("caxis","cline"),c.push("frontplot"),"above traces"===a.aaxis.layer&&c.push("aaxis","aline"),"above traces"===a.baxis.layer&&c.push("baxis","bline"),"above traces"===a.caxis.layer&&c.push("caxis","cline");var d=this.plotContainer.selectAll("g.toplevel").data(c,String),e=["agrid","bgrid","cgrid"];d.enter().append("g").attr("class",function(a){return"toplevel "+a}).each(function(a){var c=f.select(this);b[a]=c,"frontplot"===a?c.append("g").classed("scatterlayer",!0):"backplot"===a?c.append("g").classed("maplayer",!0):"plotbg"===a?c.append("path").attr("d","M0,0Z"):"aline"===a||"bline"===a||"cline"===a?c.append("path"):"grids"===a&&e.forEach(function(a){b[a]=c.append("g").classed("grid "+a,!0)})}),d.order()};var y=Math.sqrt(4/3);x.adjustLayout=function(a,b){var c,d,e,f,g,h,i=this,j=a.domain,o=(j.x[0]+j.x[1])/2,p=(j.y[0]+j.y[1])/2,q=j.x[1]-j.x[0],r=j.y[1]-j.y[0],s=q*b.w,t=r*b.h,u=a.sum,v=a.aaxis.min,w=a.baxis.min,x=a.caxis.min;s>y*t?e=(f=t)*y:f=(e=s)/y,g=q*e/s,h=r*f/t,c=b.l+b.w*o-e/2,d=b.t+b.h*(1-p)-f/2,i.x0=c,i.y0=d,i.w=e,i.h=f,i.sum=u,i.xaxis={type:"linear",range:[v+2*x-u,u-v-2*w],domain:[o-g/2,o+g/2],_id:"x"},m(i.xaxis,i.graphDiv._fullLayout),i.xaxis.setScale(),i.xaxis.isPtWithinRange=function(a){return a.a>=i.aaxis.range[0]&&a.a<=i.aaxis.range[1]&&a.b>=i.baxis.range[1]&&a.b<=i.baxis.range[0]&&a.c>=i.caxis.range[1]&&a.c<=i.caxis.range[0]},i.yaxis={type:"linear",range:[v,u-w-x],domain:[p-h/2,p+h/2],_id:"y"},m(i.yaxis,i.graphDiv._fullLayout),i.yaxis.setScale(),i.yaxis.isPtWithinRange=function(){return!0};var z=i.yaxis.domain[0],A=i.aaxis=n({},a.aaxis,{range:[v,u-w-x],side:"left",tickangle:(+a.aaxis.tickangle||0)-30,domain:[z,z+h*y],anchor:"free",position:0,_id:"y",_length:e});m(A,i.graphDiv._fullLayout),A.setScale();var B=i.baxis=n({},a.baxis,{range:[u-v-x,w],side:"bottom",domain:i.xaxis.domain,anchor:"free",position:0,_id:"x",_length:e});m(B,i.graphDiv._fullLayout),B.setScale();var C=i.caxis=n({},a.caxis,{range:[u-v-w,x],side:"right",tickangle:(+a.caxis.tickangle||0)+30,domain:[z,z+h*y],anchor:"free",position:0,_id:"y",_length:e});m(C,i.graphDiv._fullLayout),C.setScale();var D="M"+c+","+(d+f)+"h"+e+"l-"+e/2+",-"+f+"Z";i.clipDef.select("path").attr("d",D),i.layers.plotbg.select("path").attr("d",D);var E="M0,"+f+"h"+e+"l-"+e/2+",-"+f+"Z";i.clipDefRelative.select("path").attr("d",E);var F="translate("+c+","+d+")";i.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",F),i.clipDefRelative.select("path").attr("transform",null);var G="translate("+(c-B._offset)+","+(d+f)+")";i.layers.baxis.attr("transform",G),i.layers.bgrid.attr("transform",G);var H="translate("+(c+e/2)+","+d+")rotate(30)translate(0,"+-A._offset+")";i.layers.aaxis.attr("transform",H),i.layers.agrid.attr("transform",H);var I="translate("+(c+e/2)+","+d+")rotate(-30)translate(0,"+-C._offset+")";i.layers.caxis.attr("transform",I),i.layers.cgrid.attr("transform",I),i.drawAxes(!0),i.layers.aline.select("path").attr("d",A.showline?"M"+c+","+(d+f)+"l"+e/2+",-"+f:"M0,0").call(k.stroke,A.linecolor||"#000").style("stroke-width",(A.linewidth||0)+"px"),i.layers.bline.select("path").attr("d",B.showline?"M"+c+","+(d+f)+"h"+e:"M0,0").call(k.stroke,B.linecolor||"#000").style("stroke-width",(B.linewidth||0)+"px"),i.layers.cline.select("path").attr("d",C.showline?"M"+(c+e/2)+","+d+"l"+e/2+","+f:"M0,0").call(k.stroke,C.linecolor||"#000").style("stroke-width",(C.linewidth||0)+"px"),i.graphDiv._context.staticPlot||i.initInteractions(),l.setClipUrl(i.layers.frontplot,i._hasClipOnAxisFalse?null:i.clipId,i.graphDiv)},x.drawAxes=function(a){var b=this.graphDiv,c=this.id.substr(7)+"title",d=this.layers,e=this.aaxis,f=this.baxis,g=this.caxis;if(this.drawAx(e),this.drawAx(f),this.drawAx(g),a){var h=Math.max(e.showticklabels?e.tickfont.size/2:0,(g.showticklabels?.75*g.tickfont.size:0)+("outside"===g.ticks?.87*g.ticklen:0)),i=(f.showticklabels?f.tickfont.size:0)+("outside"===f.ticks?f.ticklen:0)+3;d["a-title"]=s.draw(b,"a"+c,{propContainer:e,propName:this.id+".aaxis.title",placeholder:j(b,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-e.title.font.size/3-h,"text-anchor":"middle"}}),d["b-title"]=s.draw(b,"b"+c,{propContainer:f,propName:this.id+".baxis.title",placeholder:j(b,"Click to enter Component B title"),attributes:{x:this.x0-i,y:this.y0+this.h+.83*f.title.font.size+i,"text-anchor":"middle"}}),d["c-title"]=s.draw(b,"c"+c,{propContainer:g,propName:this.id+".caxis.title",placeholder:j(b,"Click to enter Component C title"),attributes:{x:this.x0+this.w+i,y:this.y0+this.h+.83*g.title.font.size+i,"text-anchor":"middle"}})}},x.drawAx=function(a){var b,c=this.graphDiv,d=a._name,e=d.charAt(0),f=a._id,g=this.layers[d],h=e+"tickLayout",j=(b=a).ticks+String(b.ticklen)+String(b.showticklabels);this[h]!==j&&(g.selectAll("."+f+"tick").remove(),this[h]=j),a.setScale();var k=p.calcTicks(a),l=p.clipEnds(a,k),m=p.makeTransFn(a),n=p.getTickSigns(a)[2],o=i.deg2rad(30),q=n*(a.linewidth||1)/2,r=n*a.ticklen,s=this.w,t=this.h,u="b"===e?"M0,"+q+"l"+Math.sin(o)*r+","+Math.cos(o)*r:"M"+q+",0l"+Math.cos(o)*r+","+-Math.sin(o)*r,v={a:"M0,0l"+t+",-"+s/2,b:"M0,0l-"+s/2+",-"+t,c:"M0,0l-"+t+","+s/2}[e];p.drawTicks(c,a,{vals:"inside"===a.ticks?l:k,layer:g,path:u,transFn:m,crisp:!1}),p.drawGrid(c,a,{vals:l,layer:this.layers[e+"grid"],path:v,transFn:m,crisp:!1}),p.drawLabels(c,a,{vals:k,layer:g,transFn:m,labelFns:p.makeLabelFns(a,0,30)})};var z=w.MINZOOM/2+.87,A="m-0.87,.5h"+z+"v3h-"+(z+5.2)+"l"+(z/2+2.6)+",-"+(.87*z+4.5)+"l2.6,1.5l-"+z/2+","+.87*z+"Z",B="m0.87,.5h-"+z+"v3h"+(z+5.2)+"l-"+(z/2+2.6)+",-"+(.87*z+4.5)+"l-2.6,1.5l"+z/2+","+.87*z+"Z",C="m0,1l"+z/2+","+.87*z+"l2.6,-1.5l-"+(z/2+2.6)+",-"+(.87*z+4.5)+"l-"+(z/2+2.6)+","+(.87*z+4.5)+"l2.6,1.5l"+z/2+",-"+.87*z+"Z",D=!0;x.initInteractions=function(){function a(a){var b={};return b[L.id+".aaxis.min"]=a.a,b[L.id+".baxis.min"]=a.b,b[L.id+".caxis.min"]=a.c,b}function b(b,c){var d=N._fullLayout.clickmode;e(N),2===b&&(N.emit("plotly_doubleclick",null),h.call("_guiRelayout",N,a({a:0,b:0,c:0}))),d.indexOf("select")>-1&&1===b&&u(c,N,[L.xaxis],[L.yaxis],L.id,P),d.indexOf("event")>-1&&r.click(N,c,L.id)}function c(a,b){return 1-b/L.h}function d(a,b){return 1-(a+(L.h-b)/Math.sqrt(3))/L.w}function f(a,b){return(a-(L.h-b)/Math.sqrt(3))/L.w}function m(b,e){var g=s+b,h=x+e,i=Math.max(0,Math.min(1,c(0,x),c(0,h))),j=Math.max(0,Math.min(1,d(s,x),d(g,h))),k=Math.max(0,Math.min(1,f(s,x),f(g,h))),l=(i/2+k)*L.w,m=(1-i/2-j)*L.w,n=(l+m)/2,o=m-l,p=(1-i)*L.h,q=p-o/y;o<w.MINZOOM?(F=z,J.attr("d",H),K.attr("d","M0,0Z")):(F={a:z.a+i*E,b:z.b+j*E,c:z.c+k*E},J.attr("d",H+"M"+l+","+p+"H"+m+"L"+n+","+q+"L"+l+","+p+"Z"),K.attr("d","M"+s+","+x+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+l+","+p+A+"M"+m+","+p+B+"M"+n+","+q+C)),I||(J.transition().style("fill",G>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),K.transition().style("opacity",1).duration(200),I=!0),N.emit("plotly_relayouting",a(F))}function n(){e(N),F!==z&&(h.call("_guiRelayout",N,a(F)),D&&N.data&&N._context.showTips&&(i.notifier(j(N,"Double-click to zoom back out"),"long"),D=!1))}function o(b,c){var d=b/L.xaxis._m,e=c/L.yaxis._m,f=[(F={a:z.a-e,b:z.b+(d+e)/2,c:z.c-(d-e)/2}).a,F.b,F.c].sort(),g=f.indexOf(F.a),h=f.indexOf(F.b),i=f.indexOf(F.c);f[0]<0&&(f[1]+f[0]/2<0?(f[2]+=f[0]+f[1],f[0]=f[1]=0):(f[2]+=f[0]/2,f[1]+=f[0]/2,f[0]=0),F={a:f[g],b:f[h],c:f[i]},c=(z.a-F.a)*L.yaxis._m,b=(z.c-F.c-z.b+F.b)*L.xaxis._m);var j="translate("+(L.x0+b)+","+(L.y0+c)+")";L.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",j);var k="translate("+-b+","+-c+")";L.clipDefRelative.select("path").attr("transform",k),L.aaxis.range=[F.a,L.sum-F.b-F.c],L.baxis.range=[L.sum-F.a-F.c,F.b],L.caxis.range=[L.sum-F.a-F.b,F.c],L.drawAxes(!1),L._hasClipOnAxisFalse&&L.plotContainer.select(".scatterlayer").selectAll(".trace").call(l.hideOutsideRangePoints,L),N.emit("plotly_relayouting",a(F))}function p(){h.call("_guiRelayout",N,a(F))}var s,x,z,E,F,G,H,I,J,K,L=this,M=L.layers.plotbg.select("path").node(),N=L.graphDiv,O=N._fullLayout._zoomlayer,P={element:M,gd:N,plotinfo:{id:L.id,xaxis:L.xaxis,yaxis:L.yaxis},subplot:L.id,prepFn:function(a,c,d){P.xaxes=[L.xaxis],P.yaxes=[L.yaxis];var e=N._fullLayout.dragmode;P.minDrag="lasso"===e?1:void 0,"zoom"===e?(P.moveFn=m,P.clickFn=b,P.doneFn=n,function(a,b,c){var d=M.getBoundingClientRect();s=b-d.left,x=c-d.top,z={a:L.aaxis.range[0],b:L.baxis.range[1],c:L.caxis.range[1]},F=z,E=L.aaxis.range[1]-z.a,G=g(L.graphDiv._fullLayout[L.id].bgcolor).getLuminance(),H="M0,"+L.h+"L"+L.w/2+", 0L"+L.w+","+L.h+"Z",I=!1,J=O.append("path").attr("class","zoombox").attr("transform","translate("+L.x0+", "+L.y0+")").style({fill:G>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",H),K=O.append("path").attr("class","zoombox-corners").attr("transform","translate("+L.x0+", "+L.y0+")").style({fill:k.background,stroke:k.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),v(N)}(0,c,d)):"pan"===e?(P.moveFn=o,P.clickFn=b,P.doneFn=p,z={a:L.aaxis.range[0],b:L.baxis.range[1],c:L.caxis.range[1]},F=z,v(N)):"select"!==e&&"lasso"!==e||t(a,c,d,P,e)}};M.onmousemove=function(a){r.hover(N,a,L.id),N._fullLayout._lasthover=M,N._fullLayout._hoversubplot=L.id},M.onmouseout=function(a){N._dragging||q.unhover(N,a)},q.init(P)}},{"../../components/color":594,"../../components/dragelement":612,"../../components/drawing":615,"../../components/fx":632,"../../components/titles":681,"../../lib":719,"../../lib/extend":710,"../../registry":848,"../cartesian/axes":767,"../cartesian/constants":773,"../cartesian/select":784,"../cartesian/set_convert":785,"../plots":828,d3:164,tinycolor2:538}],848:[function(a,b,c){"use strict";function d(a){var b=a.name,d=a.categories,e=a.meta;if(c.modules[b])m.log("Type "+b+" already registered");else{c.subplotsRegistry[a.basePlotModule.name]||function(a){var b=a.name;if(c.subplotsRegistry[b])return void m.log("Plot type "+b+" already registered.");for(var d in h(a),c.subplotsRegistry[b]=a,c.componentsRegistry)k(d,a.name)}(a.basePlotModule);for(var f={},g=0;g<d.length;g++)f[d[g]]=!0,c.allCategories[d[g]]=!0;for(var j in c.modules[b]={_module:a,categories:f},e&&Object.keys(e).length&&(c.modules[b].meta=e),c.allTypes.push(b),c.componentsRegistry)i(j,b);a.layoutAttributes&&u(c.traceLayoutAttributes,a.layoutAttributes);var l=a.basePlotModule,n=l.name;if("mapbox"===n){var o=l.constants.styleRules;for(var p in o)q(".js-plotly-plot .plotly .mapboxgl-"+p,o[p])}"geo"!==n&&"mapbox"!==n||void 0===typeof window||void 0!==window.PlotlyGeoAssets||(window.PlotlyGeoAssets={topojson:{}})}}function e(a){if("string"!=typeof a.name)throw new Error("Component module *name* must be a string.");var b=a.name;for(var d in c.componentsRegistry[b]=a,a.layoutAttributes&&(a.layoutAttributes._isLinkedToArray&&o(c.layoutArrayContainers,b),h(a)),c.modules)i(b,d);for(var e in c.subplotsRegistry)k(b,e);for(var f in c.transformsRegistry)j(b,f);a.schema&&a.schema.layout&&v(t,a.schema.layout)}function f(a){if("string"!=typeof a.name)throw new Error("Transform module *name* must be a string.");var b="Transform module "+a.name,d="function"==typeof a.transform,e="function"==typeof a.calcTransform;if(!d&&!e)throw new Error(b+" is missing a *transform* or *calcTransform* method.");for(var f in d&&e&&m.log([b+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),p(a.attributes)||m.log(b+" registered without an *attributes* object."),"function"!=typeof a.supplyDefaults&&m.log(b+" registered without a *supplyDefaults* method."),c.transformsRegistry[a.name]=a,c.componentsRegistry)j(f,a.name)}function g(a){var b=a.name,d=b.split("-")[0],e=a.dictionary,f=a.format,g=e&&Object.keys(e).length,h=f&&Object.keys(f).length,i=c.localeRegistry,j=i[b];if(j||(i[b]=j={}),d!==b){var k=i[d];k||(i[d]=k={}),g&&k.dictionary===j.dictionary&&(k.dictionary=e),h&&k.format===j.format&&(k.format=f)}g&&(j.dictionary=e),h&&(j.format=f)}function h(a){if(a.layoutAttributes){var b=a.layoutAttributes._arrayAttrRegexps;if(b)for(var d=0;d<b.length;d++)o(c.layoutArrayRegexes,b[d])}}function i(a,b){var d=c.componentsRegistry[a].schema;if(d&&d.traces){var e=d.traces[b];e&&v(c.modules[b]._module.attributes,e)}}function j(a,b){var d=c.componentsRegistry[a].schema;if(d&&d.transforms){var e=d.transforms[b];e&&v(c.transformsRegistry[b].attributes,e)}}function k(a,b){var d=c.componentsRegistry[a].schema;if(d&&d.subplots){var e=c.subplotsRegistry[b],f=e.layoutAttributes,g="subplot"===e.attr?e.name:e.attr;Array.isArray(g)&&(g=g[0]);var h=d.subplots[g];f&&h&&v(f,h)}}function l(a){return"object"==typeof a&&(a=a.type),a}var m=a("./lib/loggers"),n=a("./lib/noop"),o=a("./lib/push_unique"),p=a("./lib/is_plain_object"),q=a("./lib/dom").addStyleRule,r=a("./lib/extend"),s=a("./plots/attributes"),t=a("./plots/layout_attributes"),u=r.extendFlat,v=r.extendDeepAll;c.modules={},c.allCategories={},c.allTypes=[],c.subplotsRegistry={},c.transformsRegistry={},c.componentsRegistry={},c.layoutArrayContainers=[],c.layoutArrayRegexes=[],c.traceLayoutAttributes={},c.localeRegistry={},c.apiMethodRegistry={},c.collectableSubplotTypes=null,c.register=function(a){if(c.collectableSubplotTypes=null,!a)throw new Error("No argument passed to Plotly.register.");a&&!Array.isArray(a)&&(a=[a]);for(var b=0;b<a.length;b++){var h=a[b];if(!h)throw new Error("Invalid module was attempted to be registered!");switch(h.moduleType){case"trace":d(h);break;case"transform":f(h);break;case"component":e(h);break;case"locale":g(h);break;case"apiMethod":var i=h.name;c.apiMethodRegistry[i]=h.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},c.getModule=function(a){var b=c.modules[l(a)];return!!b&&b._module},c.traceIs=function(a,b){if("various"===(a=l(a)))return!1;var d=c.modules[a];return d||(a&&"area"!==a&&m.log("Unrecognized trace type "+a+"."),d=c.modules[s.type.dflt]),!!d.categories[b]},c.getTransformIndices=function(a,b){for(var c=[],d=a.transforms||[],e=0;e<d.length;e++)d[e].type===b&&c.push(e);return c},c.hasTransform=function(a,b){for(var c=a.transforms||[],d=0;d<c.length;d++)if(c[d].type===b)return!0;return!1},c.getComponentMethod=function(a,b){var d=c.componentsRegistry[a];return d&&d[b]||n},c.call=function(){var a=arguments[0],b=[].slice.call(arguments,1);return c.apiMethodRegistry[a].apply(null,b)}},{"./lib/dom":708,"./lib/extend":710,"./lib/is_plain_object":720,"./lib/loggers":723,"./lib/noop":728,"./lib/push_unique":733,"./plots/attributes":764,"./plots/layout_attributes":819}],849:[function(a,b,c){"use strict";function d(a){var b;switch(a){
case"themes__thumb":b={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":b={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:b={}}return b}var e=a("../registry"),f=a("../lib"),g=f.extendFlat,h=f.extendDeep;b.exports=function(a,b){var c;a.framework&&a.framework.isPolar&&(a=a.framework.getConfig());var f,i=a.data,j=a.layout,k=h([],i),l=h({},j,d(b.tileClass)),m=a._context||{};if(b.width&&(l.width=b.width),b.height&&(l.height=b.height),"thumbnail"===b.tileClass||"themes__thumb"===b.tileClass){l.annotations=[];var n=Object.keys(l);for(c=0;c<n.length;c++)f=n[c],["xaxis","yaxis","zaxis"].indexOf(f.slice(0,5))>-1&&(l[n[c]].title={text:""});for(c=0;c<k.length;c++){var o=k[c];o.showscale=!1,o.marker&&(o.marker.showscale=!1),e.traceIs(o,"pie-like")&&(o.textposition="none")}}if(Array.isArray(b.annotations))for(c=0;c<b.annotations.length;c++)l.annotations.push(b.annotations[c]);var p=Object.keys(l).filter(function(a){return a.match(/^scene\d*$/)});if(p.length){var q={};for("thumbnail"===b.tileClass&&(q={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),c=0;c<p.length;c++){var r=l[p[c]];r.xaxis||(r.xaxis={}),r.yaxis||(r.yaxis={}),r.zaxis||(r.zaxis={}),g(r.xaxis,q),g(r.yaxis,q),g(r.zaxis,q),r._scene=null}}var s=document.createElement("div");b.tileClass&&(s.className=b.tileClass);var t={gd:s,td:s,layout:l,data:k,config:{staticPlot:void 0===b.staticPlot||b.staticPlot,plotGlPixelRatio:void 0===b.plotGlPixelRatio?2:b.plotGlPixelRatio,displaylogo:b.displaylogo||!1,showLink:b.showLink||!1,showTips:b.showTips||!1,mapboxAccessToken:m.mapboxAccessToken}};return"transparent"!==b.setBackground&&(t.config.setBackground=b.setBackground||"opaque"),t.gd.defaultLayout=d(b.tileClass),t}},{"../lib":719,"../registry":848}],850:[function(a,b,c){"use strict";var d=a("../lib"),e=a("../plot_api/to_image"),f=a("./filesaver"),g=a("./helpers");b.exports=function(a,b){var c;return d.isPlainObject(a)||(c=d.getGraphDiv(a)),(b=b||{}).format=b.format||"png",b.imageDataOnly=!0,new Promise(function(h,i){c&&c._snapshotInProgress&&i(new Error("Snapshotting already in progress.")),d.isIE()&&"svg"!==b.format&&i(new Error(g.MSG_IE_BAD_FORMAT)),c&&(c._snapshotInProgress=!0);var j=e(a,b),k=b.filename||a.fn||"newplot";k+="."+b.format,j.then(function(a){return c&&(c._snapshotInProgress=!1),f(a,k,b.format)}).then(function(a){h(a)}).catch(function(a){c&&(c._snapshotInProgress=!1),i(a)})})}},{"../lib":719,"../plot_api/to_image":760,"./filesaver":851,"./helpers":852}],851:[function(a,b,c){"use strict";var d=a("../lib"),e=a("./helpers");b.exports=function(a,b,c){var f=document.createElement("a"),g="download"in f;return new Promise(function(h,i){var j,k;if(d.isIE9orBelow()&&i(new Error("IE < 10 unsupported")),d.isSafari()){var l="svg"===c?",":";base64,";return e.octetStream(l+encodeURIComponent(a)),h(b)}return d.isIE()?(j=e.createBlob(a,"svg"),window.navigator.msSaveBlob(j,b),j=null,h(b)):g?(j=e.createBlob(a,c),k=e.createObjectURL(j),f.href=k,f.download=b,document.body.appendChild(f),f.click(),document.body.removeChild(f),e.revokeObjectURL(k),j=null,h(b)):void i(new Error("download error"))})}},{"../lib":719,"./helpers":852}],852:[function(a,b,c){"use strict";var d=a("../registry");c.getDelay=function(a){return a._has&&(a._has("gl3d")||a._has("gl2d")||a._has("mapbox"))?500:0},c.getRedrawFunc=function(a){return function(){var b=a._fullLayout||{};!(b._has&&b._has("polar"))&&a.data&&a.data[0]&&a.data[0].r||d.getComponentMethod("colorbar","draw")(a)}},c.encodeSVG=function(a){return"data:image/svg+xml,"+encodeURIComponent(a)};var e=window.URL||window.webkitURL;c.createObjectURL=function(a){return e.createObjectURL(a)},c.revokeObjectURL=function(a){return e.revokeObjectURL(a)},c.createBlob=function(a,b){if("svg"===b)return new window.Blob([a],{type:"image/svg+xml;charset=utf-8"});var c=function(a){for(var b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c),e=0;e<b;e++)d[e]=a.charCodeAt(e);return c}(window.atob(a));return new window.Blob([c],{type:"image/"+b})},c.octetStream=function(a){document.location.href="data:application/octet-stream"+a},c.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,c.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":848}],853:[function(a,b,c){"use strict";var d=a("./helpers"),e={getDelay:d.getDelay,getRedrawFunc:d.getRedrawFunc,clone:a("./cloneplot"),toSVG:a("./tosvg"),svgToImg:a("./svgtoimg"),toImage:a("./toimage"),downloadImage:a("./download")};b.exports=e},{"./cloneplot":849,"./download":850,"./helpers":852,"./svgtoimg":854,"./toimage":855,"./tosvg":856}],854:[function(a,b,c){"use strict";var d=a("../lib"),e=a("events").EventEmitter,f=a("./helpers");b.exports=function(a){var b=a.emitter||new e,c=new Promise(function(e,g){var h=window.Image,i=a.svg,j=a.format||"png";if(d.isIE()&&"svg"!==j){var k=new Error(f.MSG_IE_BAD_FORMAT);return g(k),a.promise?c:b.emit("error",k)}var l,m,n=a.canvas,o=a.scale||1,p=a.width||300,q=a.height||150,r=o*p,s=o*q,t=n.getContext("2d"),u=new h;"svg"===j||d.isIE9orBelow()||d.isSafari()?m=f.encodeSVG(i):(l=f.createBlob(i,"svg"),m=f.createObjectURL(l)),n.width=r,n.height=s,u.onload=function(){var c;switch(l=null,f.revokeObjectURL(m),"svg"!==j&&t.drawImage(u,0,0,r,s),j){case"jpeg":c=n.toDataURL("image/jpeg");break;case"png":c=n.toDataURL("image/png");break;case"webp":c=n.toDataURL("image/webp");break;case"svg":c=m;break;default:var d="Image format is not jpeg, png, svg or webp.";if(g(new Error(d)),!a.promise)return b.emit("error",d)}e(c),a.promise||b.emit("success",c)},u.onerror=function(c){if(l=null,f.revokeObjectURL(m),g(c),!a.promise)return b.emit("error",c)},u.src=m});return a.promise?c:b}},{"../lib":719,"./helpers":852,events:105}],855:[function(a,b,c){"use strict";var d=a("events").EventEmitter,e=a("../registry"),f=a("../lib"),g=a("./helpers"),h=a("./cloneplot"),i=a("./tosvg"),j=a("./svgtoimg");b.exports=function(a,b){var c=new d,k=h(a,{format:"png"}),l=k.gd;l.style.position="absolute",l.style.left="-5000px",document.body.appendChild(l);var m=g.getRedrawFunc(l);return e.call("plot",l,k.data,k.layout,k.config).then(m).then(function(){var a=g.getDelay(l._fullLayout);setTimeout(function(){var a=i(l),d=document.createElement("canvas");d.id=f.randstr(),(c=j({format:b.format,width:l._fullLayout.width,height:l._fullLayout.height,canvas:d,emitter:c,svg:a})).clean=function(){l&&document.body.removeChild(l)}},a)}).catch(function(a){c.emit("error",a)}),c}},{"../lib":719,"../registry":848,"./cloneplot":849,"./helpers":852,"./svgtoimg":854,"./tosvg":856,events:105}],856:[function(a,b,c){"use strict";var d=a("d3"),e=a("../lib"),f=a("../components/drawing"),g=a("../components/color"),h=a("../constants/xmlns_namespaces"),i=/"/g,j=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");b.exports=function(a,b,c){var k,l=a._fullLayout,m=l._paper,n=l._toppaper,o=l.width,p=l.height;m.insert("rect",":first-child").call(f.setRect,0,0,o,p).call(g.fill,l.paper_bgcolor);var q=l._basePlotModules||[];for(k=0;k<q.length;k++){var r=q[k];r.toSVG&&r.toSVG(a)}if(n){var s=n.node().childNodes,t=Array.prototype.slice.call(s);for(k=0;k<t.length;k++){var u=t[k];u.childNodes.length&&m.node().appendChild(u)}}l._draggers&&l._draggers.remove(),m.node().style.background="",m.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var a=d.select(this);if("hidden"!==this.style.visibility&&"none"!==this.style.display){a.style({visibility:null,display:null});var b=this.style.fontFamily;b&&-1!==b.indexOf('"')&&a.style("font-family",b.replace(i,"TOBESTRIPPED"))}else a.remove()}),m.selectAll(".point, .scatterpts, .legendfill>path, .legendlines>path, .cbfill").each(function(){var a=d.select(this),b=this.style.fill;b&&-1!==b.indexOf("url(")&&a.style("fill",b.replace(i,"TOBESTRIPPED"));var c=this.style.stroke;c&&-1!==c.indexOf("url(")&&a.style("stroke",c.replace(i,"TOBESTRIPPED"))}),"pdf"!==b&&"eps"!==b||m.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),m.node().setAttributeNS(h.xmlns,"xmlns",h.svg),m.node().setAttributeNS(h.xmlns,"xmlns:xlink",h.xlink),"svg"===b&&c&&(m.attr("width",c*o),m.attr("height",c*p),m.attr("viewBox","0 0 "+o+" "+p));var v=(new window.XMLSerializer).serializeToString(m.node());return v=function(a){var b=d.select("body").append("div").style({display:"none"}).html(""),c=a.replace(/(&[^;]*;)/gi,function(a){return"&lt;"===a?"&#60;":"&rt;"===a?"&#62;":-1!==a.indexOf("<")||-1!==a.indexOf(">")?"":b.html(a).text()});return b.remove(),c}(v),v=(v=v.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(j,"'"),e.isIE()&&(v=(v=(v=v.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),v}},{"../components/color":594,"../components/drawing":615,"../constants/xmlns_namespaces":696,"../lib":719,d3:164}],857:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b){for(var c=0;c<a.length;c++)a[c].i=c;d.mergeArray(b.text,a,"tx"),d.mergeArray(b.hovertext,a,"htx");var e=b.marker;if(e){d.mergeArray(e.opacity,a,"mo",!0),d.mergeArray(e.color,a,"mc");var f=e.line;f&&(d.mergeArray(f.color,a,"mlc"),d.mergeArrayCastPositive(f.width,a,"mlw"))}}},{"../../lib":719}],858:[function(a,b,c){"use strict";var d=a("../scatter/attributes"),e=a("../../plots/template_attributes").hovertemplateAttrs,f=a("../../plots/template_attributes").texttemplateAttrs,g=a("../../components/colorscale/attributes"),h=a("../../plots/font_attributes"),i=a("./constants"),j=a("../../lib/extend").extendFlat,k=h({editType:"calc",arrayOk:!0,colorEditType:"style"}),l=j({},d.marker.line.width,{dflt:0}),m=j({width:l,editType:"calc"},g("marker.line")),n=j({line:m,editType:"calc"},g("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"}});b.exports={x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,text:d.text,texttemplate:f({editType:"plot"},{keys:i.eventDataKeys}),hovertext:d.hovertext,hovertemplate:e({},{keys:i.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"none",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:j({},k,{}),insidetextfont:j({},k,{}),outsidetextfont:j({},k,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:j({},d.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:n,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:d.selected.marker.opacity,color:d.selected.marker.color,editType:"style"},textfont:d.selected.textfont,editType:"style"},unselected:{marker:{opacity:d.unselected.marker.opacity,color:d.unselected.marker.color,editType:"style"},textfont:d.unselected.textfont,editType:"style"},r:d.r,t:d.t,_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/font_attributes":793,"../../plots/template_attributes":843,"../scatter/attributes":1111,"./constants":860}],859:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../../components/colorscale/helpers").hasColorscale,f=a("../../components/colorscale/calc"),g=a("./arrays_to_calcdata"),h=a("../scatter/calc_selection");b.exports=function(a,b){var c,i,j=d.getFromId(a,b.xaxis||"x"),k=d.getFromId(a,b.yaxis||"y");"h"===b.orientation?(c=j.makeCalcdata(b,"x"),i=k.makeCalcdata(b,"y")):(c=k.makeCalcdata(b,"y"),i=j.makeCalcdata(b,"x"));for(var l=Math.min(i.length,c.length),m=new Array(l),n=0;n<l;n++)m[n]={p:i[n],s:c[n]},b.ids&&(m[n].id=String(b.ids[n]));return e(b,"marker")&&f(a,b,{vals:b.marker.color,containerStr:"marker",cLetter:"c"}),e(b,"marker.line")&&f(a,b,{vals:b.marker.line.color,containerStr:"marker.line",cLetter:"c"}),g(m,b),h(m,b),m}},{"../../components/colorscale/calc":602,"../../components/colorscale/helpers":605,"../../plots/cartesian/axes":767,"../scatter/calc_selection":1113,"./arrays_to_calcdata":857}],860:[function(a,b,c){"use strict";b.exports={TEXTPAD:3,eventDataKeys:[]}},{}],861:[function(a,b,c){"use strict";function d(a,b,c,d,q){if(d.length){var u,v,w,x;switch(function(a,b){var c,d;for(c=0;c<b.length;c++){var e,f=b[c],g=f[0].trace,h="funnel"===g.type?g._base:g.base,i="h"===g.orientation?g.xcalendar:g.ycalendar,j="category"===a.type||"multicategory"===a.type?function(){return null}:a.d2c;if(o(h)){for(d=0;d<Math.min(h.length,f.length);d++)e=j(h[d],0,i),n(e)?(f[d].b=+e,f[d].hasB=1):f[d].b=0;for(;d<f.length;d++)f[d].b=0}else{e=j(h,0,i);var k=n(e);for(e=k?e:0,d=0;d<f.length;d++)f[d].b=e,k&&(f[d].hasB=1)}}}(c,d),q.mode){case"overlay":e(b,c,d,q);break;case"group":for(u=[],v=[],w=0;w<d.length;w++)void 0===(x=d[w])[0].trace.offset?v.push(x):u.push(x);v.length&&function(a,b,c,d,e){var f=new t(d,{sepNegVal:!1,overlapNoMerge:!e.norm});(function(a,b,c,d){for(var e=a._fullLayout,f=c.positions,j=c.distinctPositions,k=c.minDiff,l=c.traces,m=l.length,n=f.length!==j.length,o=k*(1-d.gap),p=s(e,b._id)+l[0][0].trace.orientation,q=e._alignmentOpts[p]||{},r=0;r<m;r++){var t,u,v=l[r],w=v[0].trace,x=q[w.alignmentgroup]||{},y=Object.keys(x.offsetGroups||{}).length,z=(t=y?o/y:n?o/m:o)*(1-(d.groupgap||0));u=y?((2*w._offsetIndex+1-y)*t-z)/2:n?((2*r+1-m)*t-z)/2:-z/2;var A=v[0].t;A.barwidth=z,A.poffset=u,A.bargroupwidth=o,A.bardelta=k}c.binWidth=l[0][0].t.barwidth/100,g(c),h(b,c),i(b,c,n)})(a,b,f,e),function(a){for(var b=a.traces,c=0;c<b.length;c++){var d=b[c];if(void 0===d[0].trace.base)for(var e=new t([d],{sepNegVal:!0,overlapNoMerge:!0}),f=0;f<d.length;f++){var g=d[f];if(g.p!==p){var h=e.put(g.p,g.b+g.s);h&&(g.b=h)}}}}(f),e.norm?(k(f),l(c,f,e)):j(c,f)}(a,b,c,v,q),u.length&&e(b,c,u,q);break;case"stack":case"relative":for(u=[],v=[],w=0;w<d.length;w++)void 0===(x=d[w])[0].trace.base?v.push(x):u.push(x);v.length&&function(a,b,c,d,e){var g=new t(d,{sepNegVal:"relative"===e.mode,overlapNoMerge:!(e.norm||"stack"===e.mode||"relative"===e.mode)});f(b,g,e),function(a,b,c){var d,e,f,g,h,i,j=m(a),k=b.traces;for(g=0;g<k.length;g++)if(d=k[g],"funnel"===(e=d[0].trace).type)for(h=0;h<d.length;h++)(i=d[h]).s!==p&&b.put(i.p,-.5*i.s);for(g=0;g<k.length;g++){d=k[g],e=d[0].trace,f="funnel"===e.type;var l=[];for(h=0;h<d.length;h++)if((i=d[h]).s!==p){var n;n=f?i.s:i.s+i.b;var o=b.put(i.p,n),q=o+n;i.b=o,i[j]=q,c.norm||(l.push(q),i.hasB&&l.push(o))}c.norm||(e._extremes[a._id]=r.findExtremes(a,l,{tozero:!0,padded:!0}))}}(c,g,e);for(var h=0;h<d.length;h++)for(var i=d[h],j=0;j<i.length;j++){var k=i[j];if(k.s!==p){var n=k.b+k.s===g.get(k.p,k.s);n&&(k._outmost=!0)}}e.norm&&l(c,g,e)}(0,b,c,v,q),u.length&&e(b,c,u,q)}!function(a,b){var c,d,e,f=m(b),g={},h=1/0,i=-1/0;for(c=0;c<a.length;c++)for(e=a[c],d=0;d<e.length;d++){var j=e[d].p;n(j)&&(h=Math.min(h,j),i=Math.max(i,j))}var k=1e4/(i-h),l=g.round=function(a){return String(Math.round(k*(a-h)))};for(c=0;c<a.length;c++){(e=a[c])[0].t.extents=g;var o=e[0].t.poffset,p=Array.isArray(o);for(d=0;d<e.length;d++){var q=e[d],r=q[f]-q.w/2;if(n(r)){var s=q[f]+q.w/2,t=l(q.p);g[t]?g[t]=[Math.min(r,g[t][0]),Math.max(s,g[t][1])]:g[t]=[r,s]}q.p0=q.p+(p?o[d]:o),q.p1=q.p0+q.w,q.s0=q.b,q.s1=q.s0+q.s}}}(d,b)}}function e(a,b,c,d){for(var e=0;e<c.length;e++){var g=c[e],h=new t([g],{sepNegVal:!1,overlapNoMerge:!d.norm});f(a,h,d),d.norm?(k(h),l(b,h,d)):j(b,h)}}function f(a,b,c){for(var d=b.minDiff,e=b.traces,f=d*(1-c.gap),j=f*(1-(c.groupgap||0)),k=-j/2,l=0;l<e.length;l++){var m=e[l][0].t;m.barwidth=j,m.poffset=k,m.bargroupwidth=f,m.bardelta=d}b.binWidth=e[0][0].t.barwidth/100,g(b),h(a,b),i(a,b)}function g(a){var b,c,d=a.traces;for(b=0;b<d.length;b++){var e,f=d[b],g=f[0],h=g.trace,i=g.t,j=h._offset||h.offset,k=i.poffset;if(o(j)){for(e=Array.prototype.slice.call(j,0,f.length),c=0;c<e.length;c++)n(e[c])||(e[c]=k);for(c=e.length;c<f.length;c++)e.push(k);i.poffset=e}else void 0!==j&&(i.poffset=j);var l=h._width||h.width,m=i.barwidth;if(o(l)){var p=Array.prototype.slice.call(l,0,f.length);for(c=0;c<p.length;c++)n(p[c])||(p[c]=m);for(c=p.length;c<f.length;c++)p.push(m);if(i.barwidth=p,void 0===j){for(e=[],c=0;c<f.length;c++)e.push(k+(m-p[c])/2);i.poffset=e}}else void 0!==l&&(i.barwidth=l,void 0===j&&(i.poffset=k+(m-l)/2))}}function h(a,b){for(var c=b.traces,d=m(a),e=0;e<c.length;e++)for(var f=c[e],g=f[0].t,h=g.poffset,i=Array.isArray(h),j=g.barwidth,k=Array.isArray(j),l=0;l<f.length;l++){var n=f[l],o=n.w=k?j[l]:j;n[d]=n.p+(i?h[l]:h)+o/2}}function i(a,b,c){var d=b.traces,e=b.minDiff/2;r.minDtick(a,b.minDiff,b.distinctPositions[0],c);for(var f=0;f<d.length;f++){var g,h,i,j,k=d[f],l=k[0],m=l.trace,n=[];for(j=0;j<k.length;j++)h=(g=k[j]).p-e,i=g.p+e,n.push(h,i);if(m.width||m.offset){var o=l.t,p=o.poffset,q=o.barwidth,s=Array.isArray(p),t=Array.isArray(q);for(j=0;j<k.length;j++){g=k[j];var u=s?p[j]:p,v=t?q[j]:q;i=(h=g.p+u)+v,n.push(h,i)}}m._extremes[a._id]=r.findExtremes(a,n,{padded:!1})}}function j(a,b){for(var c=b.traces,d=m(a),e=0;e<c.length;e++){for(var f=c[e],g=f[0].trace,h=[],i=!0,j=0;j<f.length;j++){var k=f[j],l=k.b,n=l+k.s;k[d]=n,h.push(n),k.hasB&&h.push(l),k.hasB&&k.b>0&&k.s>0||(i=!1)}g._extremes[a._id]=r.findExtremes(a,h,{tozero:!i,padded:!0})}}function k(a){for(var b=a.traces,c=0;c<b.length;c++)for(var d=b[c],e=0;e<d.length;e++){var f=d[e];f.s!==p&&a.put(f.p,f.b+f.s)}}function l(a,b,c){function d(b){return n(a.c2l(b))&&(b<i-h||b>j+h||!n(i))}for(var e=b.traces,f=m(a),g="fraction"===c.norm?1:100,h=g/1e9,i=a.l2c(a.c2l(0)),j="stack"===c.mode?g:i,k=0;k<e.length;k++){for(var l=e[k],o=l[0].trace,q=[],s=!0,t=!1,u=0;u<l.length;u++){var v=l[u];if(v.s!==p){var w=Math.abs(g/b.get(v.p,v.s));v.b*=w,v.s*=w;var x=v.b,y=x+v.s;v[f]=y,q.push(y),t=t||d(y),v.hasB&&(q.push(x),t=t||d(x)),v.hasB&&v.b>0&&v.s>0||(s=!1)}}o._extremes[a._id]=r.findExtremes(a,q,{tozero:!s,padded:t})}}function m(a){return a._id.charAt(0)}var n=a("fast-isnumeric"),o=a("../../lib").isArrayOrTypedArray,p=a("../../constants/numerical").BADNUM,q=a("../../registry"),r=a("../../plots/cartesian/axes"),s=a("../../plots/cartesian/axis_ids").getAxisGroup,t=a("./sieve.js");b.exports={crossTraceCalc:function(a,b){for(var c=b.xaxis,e=b.yaxis,f=a._fullLayout,g=a._fullData,h=a.calcdata,i=[],j=[],k=0;k<g.length;k++){var l=g[k];!0===l.visible&&q.traceIs(l,"bar")&&l.xaxis===c._id&&l.yaxis===e._id&&("h"===l.orientation?i.push(h[k]):j.push(h[k]))}var m={mode:f.barmode,norm:f.barnorm,gap:f.bargap,groupgap:f.bargroupgap};d(a,c,e,j,m),d(a,e,c,i,m)},setGroupPositions:d}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767,"../../plots/cartesian/axis_ids":770,"../../registry":848,"./sieve.js":870,"fast-isnumeric":226}],862:[function(a,b,c){"use strict";function d(a,b,c,d){var e=b.orientation,f=b[{v:"x",h:"y"}[e]+"axis"],g=k(c,f)+e,h=c._alignmentOpts||{},i=d("alignmentgroup"),j=h[g];j||(j=h[g]={});var l=j[i];l?l.traces.push(b):l=j[i]={traces:[b],alignmentIndex:Object.keys(j).length,offsetGroups:{}};var m=d("offsetgroup"),n=l.offsetGroups,o=n[m];m&&(o||(o=n[m]={offsetIndex:Object.keys(n).length}),b._offsetIndex=o.offsetIndex)}function e(a,b,c,d,e,g){var h=!(!1===(g=g||{}).moduleHasSelected),i=!(!1===g.moduleHasUnselected),j=!(!1===g.moduleHasConstrain),k=!(!1===g.moduleHasCliponaxis),l=!(!1===g.moduleHasTextangle),n=!(!1===g.moduleHasInsideanchor),o=Array.isArray(e)||"auto"===e,p=o||"inside"===e,q=o||"outside"===e;if(p||q){var r=m(d,"textfont",c.font),s=f.extendFlat({},r);!(a.textfont&&a.textfont.color)&&delete s.color,m(d,"insidetextfont",s),q&&m(d,"outsidetextfont",r),h&&d("selected.textfont.color"),i&&d("unselected.textfont.color"),j&&d("constraintext"),k&&d("cliponaxis"),l&&d("textangle"),d("texttemplate")}p&&n&&d("insidetextanchor")}var f=a("../../lib"),g=a("../../components/color"),h=a("../../registry"),i=a("../scatter/xy_defaults"),j=a("./style_defaults"),k=a("../../plots/cartesian/axis_ids").getAxisGroup,l=a("./attributes"),m=f.coerceFont;b.exports={supplyDefaults:function(a,b,c,d){function k(c,d){return f.coerce(a,b,l,c,d)}if(i(a,b,d,k)){k("orientation",b.x&&!b.y?"h":"v"),k("base"),k("offset"),k("width"),k("text"),k("hovertext"),k("hovertemplate");var m=k("textposition");e(a,0,d,k,m,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),j(a,b,k,c,d);var n=(b.marker.line||{}).color,o=h.getComponentMethod("errorbars","supplyDefaults");o(a,b,n||g.defaultLine,{axis:"y"}),o(a,b,n||g.defaultLine,{axis:"x",inherit:"y"}),f.coerceSelectionMarkerOpacity(b,k)}else b.visible=!1},crossTraceDefaults:function(a,b){function c(a){return f.coerce(e._input,e,l,a)}var e;if("group"===b.barmode)for(var g=0;g<a.length;g++)"bar"===(e=a[g]).type&&(e._input,d(0,e,b,c))},handleGroupingDefaults:d,handleText:e}},{"../../components/color":594,"../../lib":719,"../../plots/cartesian/axis_ids":770,"../../registry":848,"../scatter/xy_defaults":1136,"./attributes":858,"./style_defaults":872}],863:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("tinycolor2"),f=a("../../lib").isArrayOrTypedArray;c.coerceString=function(a,b,c){if("string"==typeof b){if(b||!a.noBlank)return b}else if(("number"==typeof b||!0===b)&&!a.strict)return String(b);return void 0!==c?c:a.dflt},c.coerceNumber=function(a,b,c){if(d(b)){b=+b;var e=a.min,f=a.max;if(!(void 0!==e&&b<e||void 0!==f&&b>f))return b}return void 0!==c?c:a.dflt},c.coerceColor=function(a,b,c){return e(b).isValid()?b:void 0!==c?c:a.dflt},c.coerceEnumerated=function(a,b,c){return a.coerceNumber&&(b=+b),-1!==a.values.indexOf(b)?b:void 0!==c?c:a.dflt},c.getValue=function(a,b){var c;return Array.isArray(a)?b<a.length&&(c=a[b]):c=a,c},c.getLineWidth=function(a,b){return 0<b.mlw?b.mlw:f(a.marker.line.width)?0:a.marker.line.width}},{"../../lib":719,"fast-isnumeric":226,tinycolor2:538}],864:[function(a,b,c){"use strict";function d(a,b,c,d){function e(a){return a[n]-a.w/2}function g(a){return a[n]+a.w/2}function h(a,b){return f.inbox(a-l,b-l,x+Math.min(1,Math.abs(b-a)/r)-1)}function j(a){return h(z(a),A(a))}function k(a){var b=m,c=a.b,d=a[o];return w&&(d+=Math.abs(a.rawS||0)),f.inbox(c-b,d-b,x+(d-b)/(d-c)-1)}var l,m,n,o,p,q,r,s=a.cd,t=s[0].trace,u=s[0].t,v="closest"===d,w="waterfall"===t.type,x=a.maxHoverDistance,y=a.maxSpikeDistance,z=v?e:function(a){return Math.min(e(a),a.p-u.bardelta/2)},A=v?g:function(a){return Math.max(g(a),a.p+u.bardelta/2)};"h"===t.orientation?(l=c,m=b,n="y",o="x",p=k,q=j):(l=b,m=c,n="x",o="y",q=k,p=j);var B=a[n+"a"],C=a[o+"a"];r=Math.abs(B.r2c(B.range[1])-B.r2c(B.range[0]));var D=f.getDistanceFunction(d,p,q,function(a){return(p(a)+q(a))/2});if(f.getClosest(s,D,a),!1!==a.index){v||(z=function(a){return Math.min(e(a),a.p-u.bargroupwidth/2)},A=function(a){return Math.max(g(a),a.p+u.bargroupwidth/2)});var E=s[a.index],F=t.base?E.b+E.s:E.s;a[o+"0"]=a[o+"1"]=C.c2p(E[o],!0),a[o+"LabelVal"]=F;var G=u.extents[u.extents.round(E.p)];return a[n+"0"]=B.c2p(v?z(E):G[0],!0),a[n+"1"]=B.c2p(v?A(E):G[1],!0),a[n+"LabelVal"]=E.p,a.spikeDistance=(k(E)+function(a){return h(e(a),g(a))}(E))/2+y-x,a[n+"Spike"]=B.c2p(E.p,!0),i(E,t,a),a.hovertemplate=t.hovertemplate,a}}function e(a,b){var c=b.mcc||a.marker.color,d=b.mlcc||a.marker.line.color,e=j(a,b);return h.opacity(c)?c:h.opacity(d)&&e?d:void 0}var f=a("../../components/fx"),g=a("../../registry"),h=a("../../components/color"),i=a("../../lib").fillText,j=a("./helpers").getLineWidth;b.exports={hoverPoints:function(a,b,c,f){var h=d(a,b,c,f);if(h){var i=h.cd,j=i[0].trace,k=i[h.index];return h.color=e(j,k),g.getComponentMethod("errorbars","hoverInfo")(k,j,h),[h]}},hoverOnBars:d,getTraceColor:e}},{"../../components/color":594,"../../components/fx":632,"../../lib":719,"../../registry":848,"./helpers":863}],865:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults").supplyDefaults,crossTraceDefaults:a("./defaults").crossTraceDefaults,supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc"),crossTraceCalc:a("./cross_trace_calc").crossTraceCalc,colorbar:a("../scatter/marker_colorbar"),arraysToCalcdata:a("./arrays_to_calcdata"),plot:a("./plot").plot,style:a("./style").style,styleOnSelect:a("./style").styleOnSelect,hoverPoints:a("./hover").hoverPoints,selectPoints:a("./select"),moduleType:"trace",name:"bar",basePlotModule:a("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":778,"../scatter/marker_colorbar":1128,"./arrays_to_calcdata":857,"./attributes":858,"./calc":859,"./cross_trace_calc":861,"./defaults":862,"./hover":864,"./layout_attributes":866,"./layout_defaults":867,"./plot":868,"./select":869,"./style":871}],866:[function(a,b,c){"use strict";b.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],867:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../plots/cartesian/axes"),f=a("../../lib"),g=a("./layout_attributes");b.exports=function(a,b,c){function h(c,d){return f.coerce(a,b,g,c,d)}for(var i=!1,j=!1,k=!1,l={},m=h("barmode"),n=0;n<c.length;n++){var o=c[n];if(d.traceIs(o,"bar")&&o.visible){if(i=!0,"group"===m){var p=o.xaxis+o.yaxis;l[p]&&(k=!0),l[p]=!0}o.visible&&"histogram"===o.type&&"category"!==e.getFromId({_fullLayout:b},o["v"===o.orientation?"xaxis":"yaxis"]).type&&(j=!0)}}i?("overlay"!==m&&h("barnorm"),h("bargap",j&&!k?0:.2),h("bargroupgap")):delete b.barmode}},{"../../lib":719,"../../plots/cartesian/axes":767,"../../registry":848,"./layout_attributes":866}],868:[function(a,b,c){"use strict";function d(a){return a.id}function e(a){if(a.ids)return d}function f(a,b){return a<b?1:-1}function g(a,b,c){var d;return h(b)?(c&&(d=c()),a.transition().duration(b.duration).ease(b.easing).each("end",function(){d&&d()}).each("interrupt",function(){d&&d()})):a}function h(a){return a&&a.duration>0}function i(a){return"auto"===a?0:a}function j(a,b,c,d,e,g){var h=!!g.isHorizontal,j=!!g.constrained,k=g.angle||0,l=g.anchor||0,m=e.width,n=e.height,o=Math.abs(b-a),p=Math.abs(d-c),q=o>2*A&&p>2*A?A:0;o-=2*q,p-=2*q;var r=!1;if(!("auto"===k)||m<=o&&n<=p||!(m>o||n>p)||(m>p||n>o)&&m<n==o<p||(r=!0),r){var s=p;p=o,o=s}var t=i(k),u=Math.abs(Math.sin(Math.PI/180*t)),v=Math.abs(Math.cos(Math.PI/180*t)),w=Math.max(o*v,p*u),x=Math.max(o*u,p*v),y=j?Math.min(w/m,x/n):Math.max(v,u);y=Math.min(1,y);var z=(a+b)/2,B=(c+d)/2;return"middle"!==l&&(q+=.5*(y*(h!==r?n:m)*u+y*(h!==r?m:n)*v),h?(q*=f(a,b),z="start"===l?a+q:b-q):(q*=f(c,d),B="start"===l?c+q:d-q)),r&&(t+=90),{textX:(e.left+e.right)/2,textY:(e.top+e.bottom)/2,targetX:z,targetY:B,scale:y,rotate:t}}function k(a,b,c,d,e,g){var h,j=!!g.isHorizontal,k=!!g.constrained,l=g.angle||0,m=e.width,n=e.height,o=Math.abs(b-a),p=Math.abs(d-c);h=j?p>2*A?A:0:o>2*A?A:0;var q=1;k&&(q=j?Math.min(1,p/n):Math.min(1,o/m));var r=i(l);h+=.5*(q*(j?n:m)*Math.abs(Math.sin(Math.PI/180*r))+q*(j?m:n)*Math.abs(Math.cos(Math.PI/180*r)));var s=(a+b)/2,t=(c+d)/2;return j?s=b-h*f(b,a):t=d+h*f(c,d),{textX:(e.left+e.right)/2,textY:(e.top+e.bottom)/2,targetX:s,targetY:t,scale:q,rotate:r}}var l=a("d3"),m=a("fast-isnumeric"),n=a("../../lib"),o=a("../../lib/svg_text_utils"),p=a("../../components/color"),q=a("../../components/drawing"),r=a("../../registry"),s=a("../../plots/cartesian/axes").tickText,t=a("./style"),u=a("./helpers"),v=a("./constants"),w=a("./attributes"),x=w.text,y=w.textposition,z=a("../../components/fx/helpers").appendArrayPointValue,A=v.TEXTPAD;b.exports={plot:function(a,b,c,d,i,v){var w=b.xaxis,B=b.yaxis,C=a._fullLayout;i||(i={mode:C.barmode,norm:C.barmode,gap:C.bargap,groupgap:C.bargroupgap});var D=n.makeTraceGroups(d,c,"trace bars").each(function(c){var d=l.select(this),r=c[0].trace,C="waterfall"===r.type,D="funnel"===r.type,E="bar"===r.type||D,F=0;C&&r.connector.visible&&"between"===r.connector.mode&&(F=r.connector.line.width/2);var G="h"===r.orientation,H=n.ensureSingle(d,"g","points"),I=e(r),J=H.selectAll("g.point").data(n.identity,I);J.enter().append("g").classed("point",!0),J.exit().remove(),J.each(function(d,e){function C(a){return 0===i.gap&&0===i.groupgap?l.round(Math.round(a)-Q,2):a}var D,H,I=l.select(this),J=function(a,b,c,d){var e=[],f=[],g=d?b:c,h=d?c:b;return e[0]=g.c2p(a.s0,!0),f[0]=h.c2p(a.p0,!0),e[1]=g.c2p(a.s1,!0),f[1]=h.c2p(a.p1,!0),d?[e,f]:[f,e]}(d,w,B,G),K=J[0][0],L=J[0][1],M=J[1][0],N=J[1][1],O=!(K!==L&&M!==N&&m(K)&&m(L)&&m(M)&&m(N));if(O&&E&&u.getLineWidth(r,d)&&(G?L-K==0:N-M==0)&&(O=!1),d.isBlank=O,O&&G&&(L=K),O&&!G&&(N=M),F&&!O&&(G?(K-=f(K,L)*F,L+=f(K,L)*F):(M-=f(M,N)*F,N+=f(M,N)*F)),"waterfall"===r.type){if(!O){var P=r[d.dir].marker;D=P.line.width,H=P.color}}else D=u.getLineWidth(r,d),H=d.mc||r.marker.color;var Q=l.round(D/2%1,2);if(!a._context.staticPlot){var R=p.opacity(H)<1||D>.01?C:function(a,b){return Math.abs(a-b)>=2?C(a):a>b?Math.ceil(a):Math.floor(a)};K=R(K,L),L=R(L,K),M=R(M,N),N=R(N,M)}var S=g(n.ensureSingle(I,"path"),i,v);if(S.style("vector-effect","non-scaling-stroke").attr("d","M"+K+","+M+"V"+N+"H"+L+"V"+M+"Z").call(q.setClipUrl,b.layerClipId,a),h(i)){var T=q.makePointStyleFns(r);q.singlePointStyle(d,S,r,T,a)}!function(a,b,c,d,e,f,h,i,l,m,p){function r(b,c,d){return n.ensureSingle(b,"text").text(c).attr({class:"bartext bartext-"+v,"text-anchor":"middle","data-notex":1}).call(q.font,d).call(o.convertToTspans,a)}var v,w=b.xaxis,B=b.yaxis,C=a._fullLayout,D=d[0].trace,E="h"===D.orientation,F=function(a,b,c,d,e){var f,g=b[0].trace;return f=g.texttemplate?function(a,b,c,d,e){function f(a){return s(j?d:e,+a,!0).text}var g=b[0].trace,h=n.castOption(g,c,"texttemplate");if(!h)return"";var i,j="h"===g.orientation,k="waterfall"===g.type,l="funnel"===g.type,m=b[c],o={};o.label=m.p,o.labelLabel=(i=m.p,s(j?e:d,i,!0).text);var p=n.castOption(g,m.i,"text");(0===p||p)&&(o.text=p),o.value=m.s,o.valueLabel=f(m.s);var q={};z(q,g,m.i),k&&(o.delta=+m.rawS||m.s,o.deltaLabel=f(o.delta),o.final=m.v,o.finalLabel=f(o.final),o.initial=o.final-o.delta,o.initialLabel=f(o.initial)),l&&(o.value=m.s,o.valueLabel=f(o.value),o.percentInitial=m.begR,o.percentInitialLabel=n.formatPercent(m.begR),o.percentPrevious=m.difR,o.percentPreviousLabel=n.formatPercent(m.difR),o.percentTotal=m.sumR,o.percenTotalLabel=n.formatPercent(m.sumR));var r=n.castOption(g,m.i,"customdata");return r&&(o.customdata=r),n.texttemplateString(h,o,a._d3locale,q,o,g._meta||{})}(a,b,c,d,e):g.textinfo?function(a,b,c,d){function e(a){return s(i?c:d,+a,!0).text}var f,g,h=a[0].trace,i="h"===h.orientation,j="waterfall"===h.type,k="funnel"===h.type,l=h.textinfo,m=a[b],o=l.split("+"),p=[],q=function(a){return-1!==o.indexOf(a)};if(q("label")&&p.push((g=a[b].p,s(i?d:c,g,!0).text)),q("text")&&(0===(f=n.castOption(h,m.i,"text"))||f)&&p.push(f),j){var r=+m.rawS||m.s,t=m.v,u=t-r;q("initial")&&p.push(e(u)),q("delta")&&p.push(e(r)),q("final")&&p.push(e(t))}if(k){q("value")&&p.push(e(m.s));var v=0;q("percent initial")&&v++,q("percent previous")&&v++,q("percent total")&&v++;var w=v>1;q("percent initial")&&(f=n.formatPercent(m.begR),w&&(f+=" of initial"),p.push(f)),q("percent previous")&&(f=n.formatPercent(m.difR),w&&(f+=" of previous"),p.push(f)),q("percent total")&&(f=n.formatPercent(m.sumR),w&&(f+=" of total"),p.push(f))}return p.join("<br>")}(b,c,d,e):u.getValue(g.text,c),u.coerceString(x,f)}(C,d,e,w,B);v=function(a,b){var c=u.getValue(a.textposition,b);return u.coerceEnumerated(y,c)}(D,e)
;var G="stack"===m.mode||"relative"===m.mode,H=d[e],I=!G||H._outmost;if(F&&"none"!==v&&(!H.isBlank&&f!==h&&i!==l||"auto"!==v&&"inside"!==v)){var J=C.font,K=t.getBarColor(d[e],D),L=t.getInsideTextFont(D,e,J,K),M=t.getOutsideTextFont(D,e,J),N=c.datum();E?"log"===w.type&&N.s0<=0&&(f=w.range[0]<w.range[1]?0:w._length):"log"===B.type&&N.s0<=0&&(i=B.range[0]<B.range[1]?B._length:0);var O,P,Q,R,S,T,U=Math.abs(h-f)-2*A,V=Math.abs(l-i)-2*A;if("outside"===v&&(I||H.hasB||(v="inside")),"auto"===v)if(I){v="inside",O=r(c,F,L),P=q.bBox(O.node()),Q=P.width,R=P.height;var W=Q>0&&R>0,X=Q<=U&&R<=V,Y=Q<=V&&R<=U,Z=E?U>=Q*(V/R):V>=R*(U/Q);W&&(X||Y||Z)?v="inside":(v="outside",O.remove(),O=null)}else v="inside";if(!O){var $=(O=r(c,F,"outside"===v?M:L)).attr("transform");if(O.attr("transform",""),P=q.bBox(O.node()),Q=P.width,R=P.height,O.attr("transform",$),Q<=0||R<=0)return void O.remove()}"outside"===v?(T="both"===D.constraintext||"outside"===D.constraintext,S=n.getTextTransform(k(f,h,i,l,P,{isHorizontal:E,constrained:T,angle:D.textangle}))):(T="both"===D.constraintext||"inside"===D.constraintext,S=n.getTextTransform(j(f,h,i,l,P,{isHorizontal:E,constrained:T,angle:D.textangle,anchor:D.insidetextanchor}))),g(O,m,p).attr("transform",S)}else c.select("text").remove()}(a,b,I,c,e,K,L,M,N,i,v),b.layerClipId&&q.hideOutsideRangePoint(d,I.select("text"),w,B,r.xcalendar,r.ycalendar)});var K=!1===r.cliponaxis;q.setClipUrl(d,K?null:b.layerClipId,a)});r.getComponentMethod("errorbars","plot")(a,D,b,i)},toMoveInsideBar:j,toMoveOutsideBar:k}},{"../../components/color":594,"../../components/drawing":615,"../../components/fx/helpers":629,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"../../registry":848,"./attributes":858,"./constants":860,"./helpers":863,"./style":871,d3:164,"fast-isnumeric":226}],869:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=b.c2p(d?a.s0:a.p0,!0),g=b.c2p(d?a.s1:a.p1,!0),h=c.c2p(d?a.p0:a.s0,!0),i=c.c2p(d?a.p1:a.s1,!0);return e?[(f+g)/2,(h+i)/2]:d?[g,(h+i)/2]:[(f+g)/2,i]}b.exports=function(a,b){var c,e=a.cd,f=a.xaxis,g=a.yaxis,h=e[0].trace,i="funnel"===h.type,j="h"===h.orientation,k=[];if(!1===b)for(c=0;c<e.length;c++)e[c].selected=0;else for(c=0;c<e.length;c++){var l=e[c],m="ct"in l?l.ct:d(l,f,g,j,i);b.contains(m,!1,c,a)?(k.push({pointNumber:c,x:f.c2d(l.x),y:g.c2d(l.y)}),l.selected=1):l.selected=0}return k}},{}],870:[function(a,b,c){"use strict";function d(a,b){this.traces=a,this.sepNegVal=b.sepNegVal,this.overlapNoMerge=b.overlapNoMerge;for(var c=1/0,d=[],g=0;g<a.length;g++){for(var h=a[g],i=0;i<h.length;i++){var j=h[i];j.p!==f&&d.push(j.p)}h[0]&&h[0].width1&&(c=Math.min(h[0].width1,c))}this.positions=d;var k=e(d);this.distinctPositions=k.vals,1===k.vals.length&&c!==1/0?this.minDiff=c:this.minDiff=Math.min(k.minDiff,c),this.binWidth=this.minDiff,this.bins={}}b.exports=d;var e=a("../../lib").distinctVals,f=a("../../constants/numerical").BADNUM;d.prototype.put=function(a,b){var c=this.getLabel(a,b),d=this.bins[c]||0;return this.bins[c]=d+b,d},d.prototype.get=function(a,b){var c=this.getLabel(a,b);return this.bins[c]||0},d.prototype.getLabel=function(a,b){return(b<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?a:Math.round(a/this.binWidth))}},{"../../constants/numerical":695,"../../lib":719}],871:[function(a,b,c){"use strict";function d(a,b,c){n.pointStyle(a.selectAll("path"),b,c),e(a,b,c)}function e(a,b,c){a.selectAll("text").each(function(a){var d=l.select(this),e=f(d,a,b,c);n.font(d,e)})}function f(a,b,c,d){var e=d._fullLayout.font,f=c.textfont;if(a.classed("bartext-inside")){var g=k(b,c);f=h(c,b.i,e,g)}else a.classed("bartext-outside")&&(f=i(c,b.i,e));return f}function g(a,b,c){return j(r,a.textfont,b,c)}function h(a,b,c,d){var e=g(a,b,c);return(void 0===a._input.textfont||void 0===a._input.textfont.color||Array.isArray(a.textfont.color)&&void 0===a.textfont.color[b])&&(e={color:m.contrast(d),family:e.family,size:e.size}),j(s,a.insidetextfont,b,e)}function i(a,b,c){var d=g(a,b,c);return j(t,a.outsidetextfont,b,d)}function j(a,b,c,d){b=b||{};var e=u.getValue(b.family,c),f=u.getValue(b.size,c),g=u.getValue(b.color,c);return{family:u.coerceString(a.family,e,d.family),size:u.coerceNumber(a.size,f,d.size),color:u.coerceColor(a.color,g,d.color)}}function k(a,b){return"waterfall"===b.type?b[a.dir].marker.color:a.mc||b.marker.color}var l=a("d3"),m=a("../../components/color"),n=a("../../components/drawing"),o=a("../../lib"),p=a("../../registry"),q=a("./attributes"),r=q.textfont,s=q.insidetextfont,t=q.outsidetextfont,u=a("./helpers");b.exports={style:function(a){var b=l.select(a).selectAll("g.barlayer").selectAll("g.trace"),c=b.size(),e=a._fullLayout;b.style("opacity",function(a){return a[0].trace.opacity}).each(function(a){("stack"===e.barmode&&c>1||0===e.bargap&&0===e.bargroupgap&&!a[0].trace.marker.line.width)&&l.select(this).attr("shape-rendering","crispEdges")}),b.selectAll("g.points").each(function(b){d(l.select(this),b[0].trace,a)}),p.getComponentMethod("errorbars","style")(b)},styleTextPoints:e,styleOnSelect:function(a,b,c){var e=b[0].trace;e.selectedpoints?function(a,b,c){n.selectedPointStyle(a.selectAll("path"),b),function(a,b,c){a.each(function(a){var d,e=l.select(this);if(a.selected){d=o.extendFlat({},f(e,a,b,c));var g=b.selected.textfont&&b.selected.textfont.color;g&&(d.color=g),n.font(e,d)}else n.selectedTextStyle(e,b)})}(a.selectAll("text"),b,c)}(c,e,a):(d(c,e,a),p.getComponentMethod("errorbars","style")(c))},getInsideTextFont:h,getOutsideTextFont:i,getBarColor:k}},{"../../components/color":594,"../../components/drawing":615,"../../lib":719,"../../registry":848,"./attributes":858,"./helpers":863,d3:164}],872:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("../../components/colorscale/helpers").hasColorscale,f=a("../../components/colorscale/defaults");b.exports=function(a,b,c,g,h){c("marker.color",g),e(a,"marker")&&f(a,b,h,c,{prefix:"marker.",cLetter:"c"}),c("marker.line.color",d.defaultLine),e(a,"marker.line")&&f(a,b,h,c,{prefix:"marker.line.",cLetter:"c"}),c("marker.line.width"),c("marker.opacity"),c("selected.marker.color"),c("unselected.marker.color")}},{"../../components/color":594,"../../components/colorscale/defaults":604,"../../components/colorscale/helpers":605}],873:[function(a,b,c){"use strict";var d=a("../../plots/template_attributes").hovertemplateAttrs,e=a("../../lib/extend").extendFlat,f=a("../scatterpolar/attributes"),g=a("../bar/attributes");b.exports={r:f.r,theta:f.theta,r0:f.r0,dr:f.dr,theta0:f.theta0,dtheta:f.dtheta,thetaunit:f.thetaunit,base:e({},g.base,{}),offset:e({},g.offset,{}),width:e({},g.width,{}),text:e({},g.text,{}),hovertext:e({},g.hovertext,{}),marker:g.marker,hoverinfo:f.hoverinfo,hovertemplate:d(),selected:g.selected,unselected:g.unselected}},{"../../lib/extend":710,"../../plots/template_attributes":843,"../bar/attributes":858,"../scatterpolar/attributes":1178}],874:[function(a,b,c){"use strict";var d=a("../../components/colorscale/helpers").hasColorscale,e=a("../../components/colorscale/calc"),f=a("../bar/arrays_to_calcdata"),g=a("../bar/cross_trace_calc").setGroupPositions,h=a("../scatter/calc_selection"),i=a("../../registry").traceIs,j=a("../../lib").extendFlat;b.exports={calc:function(a,b){function c(a){var c=b[a];void 0!==c&&(b["_"+a]=Array.isArray(c)?k.makeCalcdata(b,a):k.d2c(c,b.thetaunit))}for(var g=a._fullLayout,i=b.subplot,j=g[i].radialaxis,k=g[i].angularaxis,l=j.makeCalcdata(b,"r"),m=k.makeCalcdata(b,"theta"),n=b._length,o=new Array(n),p=l,q=m,r=0;r<n;r++)o[r]={p:q[r],s:p[r]};return"linear"===k.type&&(c("width"),c("offset")),d(b,"marker")&&e(a,b,{vals:b.marker.color,containerStr:"marker",cLetter:"c"}),d(b,"marker.line")&&e(a,b,{vals:b.marker.line.color,containerStr:"marker.line",cLetter:"c"}),f(o,b),h(o,b),o},crossTraceCalc:function(a,b,c){for(var d=a.calcdata,e=[],f=0;f<d.length;f++){var h=d[f],k=h[0].trace;!0===k.visible&&i(k,"bar")&&k.subplot===c&&e.push(h)}var l=j({},b.radialaxis,{_id:"x"}),m=b.angularaxis;g(a,m,l,e,{mode:b.barmode,norm:b.barnorm,gap:b.bargap,groupgap:b.bargroupgap})}}},{"../../components/colorscale/calc":602,"../../components/colorscale/helpers":605,"../../lib":719,"../../registry":848,"../bar/arrays_to_calcdata":857,"../bar/cross_trace_calc":861,"../scatter/calc_selection":1113}],875:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatterpolar/defaults").handleRThetaDefaults,f=a("../bar/style_defaults"),g=a("./attributes");b.exports=function(a,b,c,h){function i(c,e){return d.coerce(a,b,g,c,e)}e(a,b,h,i)?(i("thetaunit"),i("base"),i("offset"),i("width"),i("text"),i("hovertext"),i("hovertemplate"),f(a,b,i,c,h),d.coerceSelectionMarkerOpacity(b,i)):b.visible=!1}},{"../../lib":719,"../bar/style_defaults":872,"../scatterpolar/defaults":1180,"./attributes":873}],876:[function(a,b,c){"use strict";var d=a("../../components/fx"),e=a("../../lib"),f=a("../bar/hover").getTraceColor,g=e.fillText,h=a("../scatterpolar/hover").makeHoverPointText,i=a("../../plots/polar/helpers").isPtInsidePolygon;b.exports=function(a,b,c){var j=a.cd,k=j[0].trace,l=a.subplot,m=l.radialAxis,n=l.angularAxis,o=l.vangles,p=o?i:e.isPtInsideSector,q=a.maxHoverDistance,r=n._period||2*Math.PI,s=Math.abs(m.g2p(Math.sqrt(b*b+c*c))),t=Math.atan2(c,b);if(m.range[0]>m.range[1]&&(t+=Math.PI),d.getClosest(j,function(a){return p(s,t,[a.rp0,a.rp1],[a.thetag0,a.thetag1],o)?q+Math.min(1,Math.abs(a.thetag1-a.thetag0)/r)-1+(a.rp1-s)/(a.rp1-a.rp0)-1:1/0},a),!1!==a.index){var u=j[a.index];a.x0=a.x1=u.ct[0],a.y0=a.y1=u.ct[1];var v=e.extendFlat({},u,{r:u.s,theta:u.p});return g(u,k,a),h(v,k,l,a),a.hovertemplate=k.hovertemplate,a.color=f(k,u),a.xLabelVal=a.yLabelVal=void 0,u.s<0&&(a.idealAlign="left"),[a]}}},{"../../components/fx":632,"../../lib":719,"../../plots/polar/helpers":830,"../bar/hover":864,"../scatterpolar/hover":1181}],877:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"barpolar",basePlotModule:a("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc").calc,crossTraceCalc:a("./calc").crossTraceCalc,plot:a("./plot"),colorbar:a("../scatter/marker_colorbar"),style:a("../bar/style").style,styleOnSelect:a("../bar/style").styleOnSelect,hoverPoints:a("./hover"),selectPoints:a("../bar/select"),meta:{}}},{"../../plots/polar":831,"../bar/select":869,"../bar/style":871,"../scatter/marker_colorbar":1128,"./attributes":873,"./calc":874,"./defaults":875,"./hover":876,"./layout_attributes":878,"./layout_defaults":879,"./plot":880}],878:[function(a,b,c){"use strict";b.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],879:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(a,b,c){function f(c,f){return d.coerce(a[g]||{},b[g],e,c,f)}for(var g,h={},i=0;i<c.length;i++){var j=c[i];"barpolar"===j.type&&!0===j.visible&&(h[g=j.subplot]||(f("barmode"),f("bargap"),h[g]=1))}}},{"../../lib":719,"./layout_attributes":878}],880:[function(a,b,c){"use strict";var d=a("d3"),e=a("fast-isnumeric"),f=a("../../lib"),g=a("../../components/drawing"),h=a("../../plots/polar/helpers");b.exports=function(a,b,c){var i=b.xaxis,j=b.yaxis,k=b.radialAxis,l=b.angularAxis,m=function(a){var b=a.cxx,c=a.cyy;return a.vangles?function(d,e,g,i){var j,k;f.angleDelta(g,i)>0?(j=g,k=i):(j=i,k=g);var l=h.findEnclosingVertexAngles(j,a.vangles)[0],m=h.findEnclosingVertexAngles(k,a.vangles)[1],n=[l,(j+k)/2,m];return h.pathPolygonAnnulus(d,e,j,k,n,b,c)}:function(a,d,e,g){return f.pathAnnulus(a,d,e,g,b,c)}}(b),n=b.layers.frontplot.select("g.barlayer");f.makeTraceGroups(n,c,"trace bars").each(function(){var c=d.select(this),h=f.ensureSingle(c,"g","points").selectAll("g.point").data(f.identity);h.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),h.exit().remove(),h.each(function(a){var b,c=d.select(this),g=a.rp0=k.c2p(a.s0),h=a.rp1=k.c2p(a.s1),n=a.thetag0=l.c2g(a.p0),o=a.thetag1=l.c2g(a.p1);if(e(g)&&e(h)&&e(n)&&e(o)&&g!==h&&n!==o){var p=k.c2g(a.s1),q=(n+o)/2;a.ct=[i.c2p(p*Math.cos(q)),j.c2p(p*Math.sin(q))],b=m(g,h,n,o)}else b="M0,0Z";f.ensureSingle(c,"path").attr("d",b)}),g.setClipUrl(c,b._hasClipOnAxisFalse?b.clipIds.forTraces:null,a)})}},{"../../components/drawing":615,"../../lib":719,"../../plots/polar/helpers":830,d3:164,"fast-isnumeric":226}],881:[function(a,b,c){"use strict";var d=a("../scatter/attributes"),e=a("../bar/attributes"),f=a("../../components/color/attributes"),g=a("../../plots/template_attributes").hovertemplateAttrs,h=a("../../lib/extend").extendFlat,i=d.marker,j=i.line;b.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},name:{valType:"string",editType:"calc+clearAxisTypes"},text:h({},d.text,{}),hovertext:h({},d.hovertext,{}),hovertemplate:g({}),whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],dflt:"outliers",editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],dflt:!1,editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:h({},i.symbol,{arrayOk:!1,editType:"plot"}),opacity:h({},i.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:h({},i.size,{arrayOk:!1,editType:"calc"}),color:h({},i.color,{arrayOk:!1,editType:"style"}),line:{color:h({},j.color,{arrayOk:!1,dflt:f.defaultLine,editType:"style"}),width:h({},j.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:d.fillcolor,offsetgroup:e.offsetgroup,alignmentgroup:e.alignmentgroup,selected:{marker:d.selected.marker,editType:"style"},unselected:{marker:d.unselected.marker,editType:"style"},hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":593,"../../lib/extend":710,"../../plots/template_attributes":843,"../bar/attributes":858,"../scatter/attributes":1111}],882:[function(a,b,c){"use strict";function d(a,b,c){var d={text:"tx",hovertext:"htx"};for(var e in d)Array.isArray(b[e])&&(a[d[e]]=b[e][c])}function e(a,b){return a.v-b.v}function f(a){return a.v}var g=a("fast-isnumeric"),h=a("../../lib"),i=h._,j=a("../../plots/cartesian/axes");b.exports=function(a,b){var c,k,l,m,n,o=a._fullLayout,p=j.getFromId(a,b.xaxis||"x"),q=j.getFromId(a,b.yaxis||"y"),r=[],s="violin"===b.type?"_numViolins":"_numBoxes";"h"===b.orientation?(k=p,l="x",m=q,n="y"):(k=q,l="y",m=p,n="x");var t,u=k.makeCalcdata(b,l),v=function(a,b,c,d,e){if(b in a)return c.makeCalcdata(a,b);var f;f=b+"0"in a?a[b+"0"]:"name"in a&&("category"===c.type||g(a.name)&&-1!==["linear","log"].indexOf(c.type)||h.isDateTime(a.name)&&"date"===c.type)?a.name:e;var i="multicategory"===c.type?c.r2c_just_indices(f):c.d2c(f,0,a[b+"calendar"]);return d.map(function(){return i})}(b,n,m,u,o[s]),w=h.distinctVals(v),x=w.vals,y=w.minDiff/2,z=function(a,b){for(var c=a.length,d=new Array(c+1),e=0;e<c;e++)d[e]=a[e]-b;return d[c]=a[c-1]+b,d}(x,y),A=x.length,B=function(a){for(var b=new Array(a),c=0;c<a;c++)b[c]=[];return b}(A);for(c=0;c<b._length;c++){var C=u[c];if(g(C)){var D=h.findBin(v[c],z);if(D>=0&&D<A){var E={v:C,i:c};d(E,b,c),B[D].push(E)}}}var F="all"===(b.boxpoints||b.points)?h.identity:function(a){return a.v<t.lf||a.v>t.uf};for(c=0;c<A;c++)if(B[c].length>0){var G=B[c].sort(e),H=G.map(f),I=H.length;(t={}).pos=x[c],t.pts=G,t[n]=t.pos,t[l]=t.pts.map(function(a){return a.v}),t.min=H[0],t.max=H[I-1],t.mean=h.mean(H,I),t.sd=h.stdev(H,I,t.mean),t.q1=h.interp(H,.25),t.med=h.interp(H,.5),t.q3=h.interp(H,.75),t.lf=Math.min(t.q1,H[Math.min(h.findBin(2.5*t.q1-1.5*t.q3,H,!0)+1,I-1)]),t.uf=Math.max(t.q3,H[Math.max(h.findBin(2.5*t.q3-1.5*t.q1,H),0)]),t.lo=4*t.q1-3*t.q3,t.uo=4*t.q3-3*t.q1;var J=1.57*(t.q3-t.q1)/Math.sqrt(I);t.ln=t.med-J,t.un=t.med+J,t.pts2=G.filter(F),r.push(t)}!function(a,b){if(h.isArrayOrTypedArray(b.selectedpoints))for(var c=0;c<a.length;c++){for(var d=a[c].pts||[],e={},f=0;f<d.length;f++)e[d[f].i]=f;h.tagSelected(d,b,e)}}(r,b);var K=j.findExtremes(k,u,{padded:!0});return b._extremes[k._id]=K,r.length>0?(r[0].t={num:o[s],dPos:y,posLetter:n,valLetter:l,labels:{med:i(a,"median:"),min:i(a,"min:"),q1:i(a,"q1:"),q3:i(a,"q3:"),max:i(a,"max:"),mean:"sd"===b.boxmean?i(a,"mean  :"):i(a,"mean:"),lf:i(a,"lower fence:"),uf:i(a,"upper fence:")}},o[s]++,r):[{t:{empty:!0}}]}},{"../../lib":719,"../../plots/cartesian/axes":767,"fast-isnumeric":226}],883:[function(a,b,c){"use strict";function d(a,b,c,d){var h,i,j,k=b.calcdata,l=b._fullLayout,m=d._id,n=m.charAt(0),o=[],p=0;for(h=0;h<c.length;h++)for(j=k[c[h]],i=0;i<j.length;i++)o.push(j[i].pos),p+=(j[i].pts2||[]).length;if(o.length){var q=f.distinctVals(o),r=q.minDiff/2;e.minDtick(d,q.minDiff,q.vals[0],!0);var s=l["violin"===a?"_numViolins":"_numBoxes"],t="group"===l[a+"mode"]&&s>1,u=1-l[a+"gap"],v=1-l[a+"groupgap"];for(h=0;h<c.length;h++){var w,x,y,z,A,B,C=(j=k[c[h]])[0].trace,D=j[0].t,E=C.width,F=C.side;if(E)w=x=z=E/2,y=0;else if(w=r,t){var G=g(l,d._id)+C.orientation,H=(l._alignmentOpts[G]||{})[C.alignmentgroup]||{},I=Object.keys(H.offsetGroups||{}).length,J=I||s;x=w*u*v/J,y=2*w*(((I?C._offsetIndex:D.num)+.5)/J-.5)*u,z=w*u/J}else x=w*u*v,y=0,z=w;D.dPos=w,D.bPos=y,D.bdPos=x,D.wHover=z;var K,L,M,N,O,P,Q=y+x,R=Boolean(E);if("positive"===F?(A=w*(E?1:.5),K=Q,B=K=y):"negative"===F?(A=K=y,B=w*(E?1:.5),L=Q):(A=B=w,K=L=Q),(C.boxpoints||C.points)&&p>0){var S=C.pointpos,T=C.jitter,U=C.marker.size/2,V=0;S+T>=0&&((V=Q*(S+T))>A?(R=!0,O=U,M=V):V>K&&(O=U,M=A)),V<=A&&(M=A);var W=0;S-T<=0&&((W=-Q*(S-T))>B?(R=!0,P=U,N=W):W>L&&(P=U,N=B)),W<=B&&(N=B)}else M=A,N=B;var X=new Array(j.length);for(i=0;i<j.length;i++)X[i]=j[i].pos;C._extremes[m]=e.findExtremes(d,X,{padded:R,vpadminus:N,vpadplus:M,ppadminus:{x:P,y:O}[n],ppadplus:{x:O,y:P}[n]})}}}var e=a("../../plots/cartesian/axes"),f=a("../../lib"),g=a("../../plots/cartesian/axis_ids").getAxisGroup,h=["v","h"];b.exports={crossTraceCalc:function(a,b){for(var c=a.calcdata,e=b.xaxis,f=b.yaxis,g=0;g<h.length;g++){for(var i=h[g],j="h"===i?f:e,k=[],l=0;l<c.length;l++){var m=c[l],n=m[0].t,o=m[0].trace;!0!==o.visible||"box"!==o.type&&"candlestick"!==o.type||n.empty||(o.orientation||"v")!==i||o.xaxis!==e._id||o.yaxis!==f._id||k.push(l)}d("box",a,k,j)}},setPositionOffset:d}},{"../../lib":719,"../../plots/cartesian/axes":767,"../../plots/cartesian/axis_ids":770}],884:[function(a,b,c){"use strict";function d(a,b,c,d){var e,h,i=c("y"),j=c("x"),k=j&&j.length;if(i&&i.length)e="v",k?h=Math.min(f.minRowLength(j),f.minRowLength(i)):(c("x0"),h=f.minRowLength(i));else{if(!k)return void(b.visible=!1);e="h",c("y0"),h=f.minRowLength(j)}b._length=h,g.getComponentMethod("calendars","handleTraceDefaults")(a,b,["x","y"],d),c("orientation",e)}function e(a,b,c,d){var e=d.prefix,g=f.coerce2(a,b,j,"marker.outliercolor"),h=c("marker.line.outliercolor"),i=c(e+"points",g||h?"suspectedoutliers":void 0);i?(c("jitter","all"===i?.3:0),c("pointpos","all"===i?-1.5:0),c("marker.symbol"),c("marker.opacity"),c("marker.size"),c("marker.color",b.line.color),c("marker.line.color"),c("marker.line.width"),"suspectedoutliers"===i&&(c("marker.line.outliercolor",b.marker.color),c("marker.line.outlierwidth")),c("selected.marker.color"),c("unselected.marker.color"),c("selected.marker.size"),c("unselected.marker.size"),c("text"),c("hovertext")):delete b.marker;var k=c("hoveron");"all"!==k&&-1===k.indexOf("points")||c("hovertemplate"),f.coerceSelectionMarkerOpacity(b,c)}var f=a("../../lib"),g=a("../../registry"),h=a("../../components/color"),i=a("../bar/defaults").handleGroupingDefaults,j=a("./attributes");b.exports={supplyDefaults:function(a,b,c,g){function i(c,d){return f.coerce(a,b,j,c,d)}d(a,b,i,g),!1!==b.visible&&(i("line.color",(a.marker||{}).color||c),i("line.width"),i("fillcolor",h.addOpacity(b.line.color,.5)),i("whiskerwidth"),i("boxmean"),i("width"),i("notched",void 0!==a.notchwidth)&&i("notchwidth"),e(a,b,i,{prefix:"box"}))},crossTraceDefaults:function(a,b){function c(a){return f.coerce(e._input,e,j,a)}for(var d,e,g=0;g<a.length;g++){var h=(e=a[g]).type;"box"!==h&&"violin"!==h||(d=e._input,"group"===b[h+"mode"]&&i(d,e,b,c))}},handleSampleDefaults:d,handlePointsDefaults:e}},{"../../components/color":594,"../../lib":719,"../../registry":848,"../bar/defaults":862,"./attributes":881}],885:[function(a,b,c){"use strict";b.exports=function(a,b){return b.hoverOnBox&&(a.hoverOnBox=b.hoverOnBox),"xVal"in b&&(a.x=b.xVal),"yVal"in b&&(a.y=b.yVal),b.xa&&(a.xaxis=b.xa),b.ya&&(a.yaxis=b.ya),a}},{}],886:[function(a,b,c){"use strict";function d(a,b,c,d){function e(a){return(p(a)+q(a))/2}var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=a.cd,y=a.xa,z=a.ya,A=x[0].trace,B=x[0].t,C="violin"===A.type,D=[],E=B.bdPos,F=B.wHover,G=function(a){return a.pos+B.bPos-o};C&&"both"!==A.side?("positive"===A.side&&(r=function(a){var b=G(a);return h.inbox(b,b+F,s)},u=E,v=0),"negative"===A.side&&(r=function(a){var b=G(a);return h.inbox(b-F,b,s)},u=0,v=E)):(r=function(a){var b=G(a);return h.inbox(b-F,b+F,s)},u=v=E),w=C?function(a){return h.inbox(a.span[0]-n,a.span[1]-n,s)}:function(a){return h.inbox(a.min-n,a.max-n,s)},"h"===A.orientation?(n=b,o=c,p=w,q=r,j="y",l=z,k="x",m=y):(n=c,o=b,p=r,q=w,j="x",l=y,k="y",m=z);var H=Math.min(1,E/Math.abs(l.r2c(l.range[1])-l.r2c(l.range[0])));s=a.maxHoverDistance-H,t=a.maxSpikeDistance-H;var I=h.getDistanceFunction(d,p,q,e);if(h.getClosest(x,I,a),!1===a.index)return[];var J=x[a.index],K=A.line.color,L=(A.marker||{}).color;i.opacity(K)&&A.line.width?a.color=K:i.opacity(L)&&A.boxpoints?a.color=L:a.color=A.fillcolor,a[j+"0"]=l.c2p(J.pos+B.bPos-v,!0),a[j+"1"]=l.c2p(J.pos+B.bPos+u,!0),a[j+"LabelVal"]=J.pos;var M=j+"Spike";a.spikeDistance=e(J)*t/s,a[M]=l.c2p(J.pos,!0);var N={},O=["med","q1","q3","min","max"];(A.boxmean||(A.meanline||{}).visible)&&O.push("mean"),(A.boxpoints||A.points)&&O.push("lf","uf");for(var P=0;P<O.length;P++){var Q=O[P];if(Q in J&&!(J[Q]in N)){N[J[Q]]=!0;var R=J[Q],S=m.c2p(R,!0),T=g.extendFlat({},a);T.attr=Q,T[k+"0"]=T[k+"1"]=S,T[k+"LabelVal"]=R,T[k+"Label"]=(B.labels?B.labels[Q]+" ":"")+f.hoverLabelText(m,R),T.hoverOnBox=!0,"mean"===Q&&"sd"in J&&"sd"===A.boxmean&&(T[k+"err"]=J.sd),a.name="",a.spikeDistance=void 0,a[M]=void 0,T.hovertemplate=!1,D.push(T)}}return D}function e(a,b,c){for(var d,e,f,i=a.cd,k=a.xa,l=a.ya,m=i[0].trace,n=k.c2p(b),o=l.c2p(c),p=h.quadrature(function(a){var b=Math.max(3,a.mrc||0);return Math.max(Math.abs(k.c2p(a.x)-n)-b,1-3/b)},function(a){var b=Math.max(3,a.mrc||0);return Math.max(Math.abs(l.c2p(a.y)-o)-b,1-3/b)}),q=!1,r=0;r<i.length;r++){e=i[r];for(var s=0;s<(e.pts||[]).length;s++){var t=p(f=e.pts[s]);t<=a.distance&&(a.distance=t,q=[r,s])}}if(!q)return!1;f=(e=i[q[0]]).pts[q[1]];var u,v=k.c2p(f.x,!0),w=l.c2p(f.y,!0),x=f.mrc||1;return d=g.extendFlat({},a,{index:f.i,color:(m.marker||{}).color,name:m.name,x0:v-x,x1:v+x,y0:w-x,y1:w+x,spikeDistance:a.distance,hovertemplate:m.hovertemplate}),"h"===m.orientation?(u=l,d.xLabelVal=f.x,d.yLabelVal=e.pos):(u=k,d.xLabelVal=e.pos,d.yLabelVal=f.y),d[u._id.charAt(0)+"Spike"]=u.c2p(e.pos,!0),j(f,m,d),d}var f=a("../../plots/cartesian/axes"),g=a("../../lib"),h=a("../../components/fx"),i=a("../../components/color"),j=g.fillText;b.exports={hoverPoints:function(a,b,c,f){var g,h=a.cd[0].trace.hoveron,i=[];return-1!==h.indexOf("boxes")&&(i=i.concat(d(a,b,c,f))),-1!==h.indexOf("points")&&(g=e(a,b,c)),"closest"===f?g?[g]:i:g?(i.push(g),i):i},hoverOnBoxes:d,hoverOnPoints:e}},{"../../components/color":594,"../../components/fx":632,"../../lib":719,"../../plots/cartesian/axes":767}],887:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults").supplyDefaults,crossTraceDefaults:a("./defaults").crossTraceDefaults,supplyLayoutDefaults:a("./layout_defaults").supplyLayoutDefaults,calc:a("./calc"),crossTraceCalc:a("./cross_trace_calc").crossTraceCalc,plot:a("./plot").plot,style:a("./style").style,styleOnSelect:a("./style").styleOnSelect,hoverPoints:a("./hover").hoverPoints,eventData:a("./event_data"),selectPoints:a("./select"),moduleType:"trace",name:"box",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"./attributes":881,"./calc":882,"./cross_trace_calc":883,"./defaults":884,"./event_data":885,"./hover":886,"./layout_attributes":888,"./layout_defaults":889,"./plot":890,"./select":891,"./style":892}],888:[function(a,b,c){"use strict";b.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],889:[function(a,b,c){"use strict";function d(a,b,c,d,f){for(var g=f+"Layout",h=!1,i=0;i<c.length;i++){var j=c[i];if(e.traceIs(j,g)){h=!0;break}}h&&(d(f+"mode"),d(f+"gap"),d(f+"groupgap"))}var e=a("../../registry"),f=a("../../lib"),g=a("./layout_attributes");b.exports={supplyLayoutDefaults:function(a,b,c){d(0,0,c,function(c,d){return f.coerce(a,b,g,c,d)},"box")},_supply:d}},{"../../lib":719,"../../registry":848,"./layout_attributes":888}],890:[function(a,b,c){"use strict";function d(a,b,c,d){var e,f,i=b.pos,j=b.val,k=d.bPos,l=d.wdPos||0,m=d.bPosPxOffset||0,n=c.whiskerwidth||0,o=c.notched||!1,p=o?1-2*c.notchwidth:1;Array.isArray(d.bdPos)?(e=d.bdPos[0],f=d.bdPos[1]):(e=d.bdPos,f=d.bdPos);var q=a.selectAll("path.box").data("violin"!==c.type||c.box.visible?h.identity:[]);q.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),q.exit().remove(),q.each(function(a){if(a.empty)return"M0,0Z";var b=a.pos,d=i.c2p(b+k,!0)+m,q=i.c2p(b+k-e,!0)+m,r=i.c2p(b+k+f,!0)+m,s=i.c2p(b+k-l,!0)+m,t=i.c2p(b+k+l,!0)+m,u=i.c2p(b+k-e*p,!0)+m,v=i.c2p(b+k+f*p,!0)+m,w=j.c2p(a.q1,!0),x=j.c2p(a.q3,!0),y=h.constrain(j.c2p(a.med,!0),Math.min(w,x)+1,Math.max(w,x)-1),z=void 0===a.lf||!1===c.boxpoints,A=j.c2p(z?a.min:a.lf,!0),B=j.c2p(z?a.max:a.uf,!0),C=j.c2p(a.ln,!0),D=j.c2p(a.un,!0);"h"===c.orientation?g.select(this).attr("d","M"+y+","+u+"V"+v+"M"+w+","+q+"V"+r+(o?"H"+C+"L"+y+","+v+"L"+D+","+r:"")+"H"+x+"V"+q+(o?"H"+D+"L"+y+","+u+"L"+C+","+q:"")+"ZM"+w+","+d+"H"+A+"M"+x+","+d+"H"+B+(0===n?"":"M"+A+","+s+"V"+t+"M"+B+","+s+"V"+t)):g.select(this).attr("d","M"+u+","+y+"H"+v+"M"+q+","+w+"H"+r+(o?"V"+C+"L"+v+","+y+"L"+r+","+D:"")+"V"+x+"H"+q+(o?"V"+D+"L"+u+","+y+"L"+q+","+C:"")+"ZM"+d+","+w+"V"+A+"M"+d+","+x+"V"+B+(0===n?"":"M"+s+","+A+"H"+t+"M"+s+","+B+"H"+t))})}function e(a,b,c,d){var e=b.x,f=b.y,g=d.bdPos,l=d.bPos,m=c.boxpoints||c.points;h.seedPseudoRandom();var n=a.selectAll("g.points").data(m?function(a){return a.forEach(function(a){a.t=d,a.trace=c}),a}:[]);n.enter().append("g").attr("class","points"),n.exit().remove();var o=n.selectAll("path").data(function(a){var b,d,e=a.pts2,f=Math.max((a.max-a.min)/10,a.q3-a.q1),i=1e-9*f,n=f*k,o=[],p=0;if(c.jitter){if(0===f)for(p=1,o=new Array(e.length),b=0;b<e.length;b++)o[b]=1;else for(b=0;b<e.length;b++){var q=Math.max(0,b-j),r=e[q].v,s=Math.min(e.length-1,b+j),t=e[s].v;"all"!==m&&(e[b].v<a.lf?t=Math.min(t,a.lf):r=Math.max(r,a.uf));var u=Math.sqrt(n*(s-q)/(t-r+i))||0;u=h.constrain(Math.abs(u),0,1),o.push(u),p=Math.max(u,p)}d=2*c.jitter/(p||1)}for(b=0;b<e.length;b++){var v=e[b],w=v.v,x=c.jitter?d*o[b]*(h.pseudoRandom()-.5):0,y=a.pos+l+g*(c.pointpos+x);"h"===c.orientation?(v.y=y,v.x=w):(v.x=y,v.y=w),"suspectedoutliers"===m&&w<a.uo&&w>a.lo&&(v.so=!0)}return e});o.enter().append("path").classed("point",!0),o.exit().remove(),o.call(i.translatePoints,e,f)}function f(a,b,c,d){var e,f,i=b.pos,j=b.val,k=d.bPos,l=d.bPosPxOffset||0,m=c.boxmean||(c.meanline||{}).visible;Array.isArray(d.bdPos)?(e=d.bdPos[0],f=d.bdPos[1]):(e=d.bdPos,f=d.bdPos);var n=a.selectAll("path.mean").data("box"===c.type&&c.boxmean||"violin"===c.type&&c.box.visible&&c.meanline.visible?h.identity:[]);n.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),n.exit().remove(),n.each(function(a){var b=i.c2p(a.pos+k,!0)+l,d=i.c2p(a.pos+k-e,!0)+l,h=i.c2p(a.pos+k+f,!0)+l,n=j.c2p(a.mean,!0),o=j.c2p(a.mean-a.sd,!0),p=j.c2p(a.mean+a.sd,!0);"h"===c.orientation?g.select(this).attr("d","M"+n+","+d+"V"+h+("sd"===m?"m0,0L"+o+","+b+"L"+n+","+d+"L"+p+","+b+"Z":"")):g.select(this).attr("d","M"+d+","+n+"H"+h+("sd"===m?"m0,0L"+b+","+o+"L"+d+","+n+"L"+b+","+p+"Z":""))})}var g=a("d3"),h=a("../../lib"),i=a("../../components/drawing"),j=5,k=.01;b.exports={plot:function(a,b,c,i){var j=b.xaxis,k=b.yaxis;h.makeTraceGroups(i,c,"trace boxes").each(function(a){var b,c,h=g.select(this),i=a[0],l=i.t,m=i.trace;l.wdPos=l.bdPos*m.whiskerwidth,!0!==m.visible||l.empty?h.remove():("h"===m.orientation?(b=k,c=j):(b=j,c=k),d(h,{pos:b,val:c},m,l),e(h,{x:j,y:k},m,l),f(h,{pos:b,val:c},m,l))})},plotBoxAndWhiskers:d,plotPoints:e,plotBoxMean:f}},{"../../components/drawing":615,"../../lib":719,d3:164}],891:[function(a,b,c){"use strict";b.exports=function(a,b){var c,d,e=a.cd,f=a.xaxis,g=a.yaxis,h=[];if(!1===b)for(c=0;c<e.length;c++)for(d=0;d<(e[c].pts||[]).length;d++)e[c].pts[d].selected=0;else for(c=0;c<e.length;c++)for(d=0;d<(e[c].pts||[]).length;d++){var i=e[c].pts[d],j=f.c2p(i.x),k=g.c2p(i.y);b.contains([j,k],null,i.i,a)?(h.push({pointNumber:i.i,x:f.c2d(i.x),y:g.c2d(i.y)}),i.selected=1):i.selected=0}return h}},{}],892:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../components/color"),f=a("../../components/drawing");b.exports={style:function(a,b,c){var g=c||d.select(a).selectAll("g.trace.boxes");g.style("opacity",function(a){return a[0].trace.opacity}),g.each(function(b){function c(a,b,c,d){a.style("stroke-width",b+"px").call(e.stroke,c).call(e.fill,d)}var g=d.select(this),h=b[0].trace,i=h.line.width,j=g.selectAll("path.box");if("candlestick"===h.type)j.each(function(a){if(!a.empty){var b=d.select(this),e=h[a.dir];c(b,e.line.width,e.line.color,e.fillcolor),b.style("opacity",h.selectedpoints&&!a.selected?.3:1)}});else{c(j,i,h.line.color,h.fillcolor),g.selectAll("path.mean").style({"stroke-width":i,"stroke-dasharray":2*i+"px,"+i+"px"}).call(e.stroke,h.line.color);var k=g.selectAll("path.point");f.pointStyle(k,h,a)}})},styleOnSelect:function(a,b,c){var d=b[0].trace,e=c.selectAll("path.point");d.selectedpoints?f.selectedPointStyle(e,d):f.pointStyle(e,d,a)}}},{"../../components/color":594,"../../components/drawing":615,d3:164}],893:[function(a,b,c){"use strict";function d(a){return{line:{color:e({},g.line.color,{dflt:a}),width:g.line.width,editType:"style"},fillcolor:g.fillcolor,editType:"style"}}var e=a("../../lib").extendFlat,f=a("../ohlc/attributes"),g=a("../box/attributes");b.exports={x:f.x,open:f.open,high:f.high,low:f.low,close:f.close,line:{width:e({},g.line.width,{}),editType:"style"},increasing:d(f.increasing.line.color.dflt),decreasing:d(f.decreasing.line.color.dflt),text:f.text,hovertext:f.hovertext,whiskerwidth:e({},g.whiskerwidth,{dflt:0}),hoverlabel:f.hoverlabel}},{"../../lib":719,"../box/attributes":881,"../ohlc/attributes":1057}],894:[function(a,b,c){"use strict";function d(a,b,c,d){return{min:c,q1:Math.min(a,d),med:d,q3:Math.max(a,d),max:b}}
var e=a("../../lib"),f=a("../../plots/cartesian/axes"),g=a("../ohlc/calc").calcCommon;b.exports=function(a,b){var c=a._fullLayout,h=f.getFromId(a,b.xaxis),i=f.getFromId(a,b.yaxis),j=h.makeCalcdata(b,"x"),k=g(a,b,j,i,d);return k.length?(e.extendFlat(k[0].t,{num:c._numBoxes,dPos:e.distinctVals(j).minDiff/2,posLetter:"x",valLetter:"y"}),c._numBoxes++,k):[{t:{empty:!0}}]}},{"../../lib":719,"../../plots/cartesian/axes":767,"../ohlc/calc":1058}],895:[function(a,b,c){"use strict";function d(a,b,c,d){var e=c(d+".line.color");c(d+".line.width",b.line.width),c(d+".fillcolor",f.addOpacity(e,.5))}var e=a("../../lib"),f=a("../../components/color"),g=a("../ohlc/ohlc_defaults"),h=a("./attributes");b.exports=function(a,b,c,f){function i(c,d){return e.coerce(a,b,h,c,d)}g(a,b,i,f)?(i("line.width"),d(a,b,i,"increasing"),d(a,b,i,"decreasing"),i("text"),i("hovertext"),i("whiskerwidth"),f._requestRangeslider[b.xaxis]=!0):b.visible=!1}},{"../../components/color":594,"../../lib":719,"../ohlc/ohlc_defaults":1062,"./attributes":893}],896:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"candlestick",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:a("./attributes"),layoutAttributes:a("../box/layout_attributes"),supplyLayoutDefaults:a("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:a("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("../box/plot").plot,layerName:"boxlayer",style:a("../box/style").style,hoverPoints:a("../ohlc/hover").hoverPoints,selectPoints:a("../ohlc/select")}},{"../../plots/cartesian":778,"../box/cross_trace_calc":883,"../box/layout_attributes":888,"../box/layout_defaults":889,"../box/plot":890,"../box/style":892,"../ohlc/hover":1060,"../ohlc/select":1064,"./attributes":893,"./calc":894,"./defaults":895}],897:[function(a,b,c){"use strict";var d=a("./axis_defaults"),e=a("../../plot_api/plot_template");b.exports=function(a,b,c,f,g){f("a")||(f("da"),f("a0")),f("b")||(f("db"),f("b0")),function(a,b,c,f){["aaxis","baxis"].forEach(function(g){var h=g.charAt(0),i=a[g]||{},j=e.newContainer(b,g),k={tickfont:"x",id:h+"axis",letter:h,font:b.font,name:g,data:a[h],calendar:b.calendar,dfltColor:f,bgColor:c.paper_bgcolor,fullLayout:c};d(i,j,k),j._categories=j._categories||[],a[g]||"-"===i.type||(a[g]={type:i.type})})}(a,b,c,g)}},{"../../plot_api/plot_template":757,"./axis_defaults":902}],898:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray;b.exports=function(a){return function a(b,c){if(!d(b)||c>=10)return null;for(var e=1/0,f=-1/0,g=b.length,h=0;h<g;h++){var i=b[h];if(d(i)){var j=a(i,c+1);j&&(e=Math.min(j[0],e),f=Math.max(j[1],f))}else e=Math.min(i,e),f=Math.max(i,f)}return[e,f]}(a,0)}},{"../../lib":719}],899:[function(a,b,c){"use strict";var d=a("../../plots/font_attributes"),e=a("./axis_attributes"),f=a("../../components/color/attributes"),g=d({editType:"calc"});g.family.dflt='"Open Sans", verdana, arial, sans-serif',g.size.dflt=12,g.color.dflt=f.defaultLine,b.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:e,baxis:e,font:g,color:{valType:"color",dflt:f.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":593,"../../plots/font_attributes":793,"./axis_attributes":901}],900:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray;b.exports=function(a,b,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=d(c)?"a":"b",t=("a"===s?a.aaxis:a.baxis).smoothing,u="a"===s?a.a2i:a.b2j,v="a"===s?c:e,w="a"===s?e:c,x="a"===s?b.a.length:b.b.length,y="a"===s?b.b.length:b.a.length,z=Math.floor("a"===s?a.b2j(w):a.a2i(w)),A="a"===s?function(b){return a.evalxy([],b,z)}:function(b){return a.evalxy([],z,b)};t&&(h=Math.max(0,Math.min(y-2,z)),i=z-h,g="a"===s?function(b,c){return a.dxydi([],b,h,c,i)}:function(b,c){return a.dxydj([],h,b,i,c)});var B=u(v[0]),C=u(v[1]),D=B<C?1:-1,E=1e-8*(C-B),F=D>0?Math.floor:Math.ceil,G=D>0?Math.ceil:Math.floor,H=D>0?Math.min:Math.max,I=D>0?Math.max:Math.min,J=F(B+E),K=G(C-E),L=[[l=A(B)]];for(f=J;f*D<K*D;f+=D)j=[],p=I(B,f),r=(q=H(C,f+D))-p,k=Math.max(0,Math.min(x-2,Math.floor(.5*(p+q)))),m=A(q),t&&(n=g(k,p-k),o=g(k,q-k),j.push([l[0]+n[0]/3*r,l[1]+n[1]/3*r]),j.push([m[0]-o[0]/3*r,m[1]-o[1]/3*r])),j.push(m),L.push(j),l=m;return L}},{"../../lib":719}],901:[function(a,b,c){"use strict";var d=a("../../plots/font_attributes"),e=a("../../components/color/attributes"),f=a("../../plots/cartesian/layout_attributes"),g=a("../../plot_api/edit_types").overrideAll;a("../../constants/docs").FORMAT_LINK,a("../../constants/docs").TIME_FORMAT_LINK,b.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:d({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:d({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc"},tickformatstops:g(f.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:e.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:e.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:d({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":593,"../../constants/docs":690,"../../plot_api/edit_types":750,"../../plots/cartesian/layout_attributes":779,"../../plots/font_attributes":793}],902:[function(a,b,c){"use strict";var d=a("./attributes"),e=a("../../components/color").addOpacity,f=a("../../registry"),g=a("../../lib"),h=a("../../plots/cartesian/tick_value_defaults"),i=a("../../plots/cartesian/tick_label_defaults"),j=a("../../plots/cartesian/category_order_defaults"),k=a("../../plots/cartesian/set_convert"),l=a("../../plots/cartesian/axis_autotype");b.exports=function(a,b,c){function m(c,d){return g.coerce(a,b,q,c,d)}function n(c,d){return g.coerce2(a,b,q,c,d)}var o=c.letter,p=c.font||{},q=d[o+"axis"];c.name&&(b._name=c.name,b._id=c.name);var r=m("type");"-"===r&&(c.data&&function(a,b){if("-"===a.type){var c=a._id.charAt(0),d=a[c+"calendar"];a.type=l(b,d)}}(b,c.data),"-"===b.type?b.type="linear":r=a.type=b.type),m("smoothing"),m("cheatertype"),m("showticklabels"),m("labelprefix",o+" = "),m("labelsuffix"),m("showtickprefix"),m("showticksuffix"),m("separatethousands"),m("tickformat"),m("exponentformat"),m("showexponent"),m("categoryorder"),m("tickmode"),m("tickvals"),m("ticktext"),m("tick0"),m("dtick"),"array"===b.tickmode&&(m("arraytick0"),m("arraydtick")),m("labelpadding"),b._hovertitle=o,"date"===r&&f.getComponentMethod("calendars","handleDefaults")(a,b,"calendar",c.calendar),k(b,c.fullLayout),b.c2p=g.identity;var s=m("color",c.dfltColor),t=s===a.color?s:p.color;m("title.text")&&(g.coerceFont(m,"title.font",{family:p.family,size:Math.round(1.2*p.size),color:t}),m("title.offset")),m("tickangle"),m("autorange",!b.isValidRange(a.range))&&m("rangemode"),m("range"),b.cleanRange(),m("fixedrange"),h(a,b,m,r),i(a,b,m,r,c),j(a,b,m,{data:c.data,dataAttr:o});var u=n("gridcolor",e(s,.3)),v=n("gridwidth"),w=m("showgrid");w||(delete b.gridcolor,delete b.gridwidth);var x=n("startlinecolor",s),y=n("startlinewidth",v);m("startline",b.showgrid||!!x||!!y)||(delete b.startlinecolor,delete b.startlinewidth);var z=n("endlinecolor",s),A=n("endlinewidth",v);return m("endline",b.showgrid||!!z||!!A)||(delete b.endlinecolor,delete b.endlinewidth),w?(m("minorgridcount"),m("minorgridwidth",v),m("minorgridcolor",e(u,.06)),b.minorgridcount||(delete b.minorgridwidth,delete b.minorgridcolor)):(delete b.gridcolor,delete b.gridWidth),"none"===b.showticklabels&&(delete b.tickfont,delete b.tickangle,delete b.showexponent,delete b.exponentformat,delete b.tickformat,delete b.showticksuffix,delete b.showtickprefix),b.showticksuffix||delete b.ticksuffix,b.showtickprefix||delete b.tickprefix,m("tickmode"),b}},{"../../components/color":594,"../../lib":719,"../../plots/cartesian/axis_autotype":768,"../../plots/cartesian/category_order_defaults":771,"../../plots/cartesian/set_convert":785,"../../plots/cartesian/tick_label_defaults":786,"../../plots/cartesian/tick_value_defaults":788,"../../registry":848,"./attributes":899}],903:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../../lib").isArray1D,f=a("./cheater_basis"),g=a("./array_minmax"),h=a("./calc_gridlines"),i=a("./calc_labels"),j=a("./calc_clippath"),k=a("../heatmap/clean_2d_array"),l=a("./smooth_fill_2d_array"),m=a("../heatmap/convert_column_xyz"),n=a("./set_convert");b.exports=function(a,b){var c=d.getFromId(a,b.xaxis),o=d.getFromId(a,b.yaxis),p=b.aaxis,q=b.baxis,r=b.x,s=b.y,t=[];r&&e(r)&&t.push("x"),s&&e(s)&&t.push("y"),t.length&&m(b,p,q,"a","b",t);var u=b._a=b._a||b.a,v=b._b=b._b||b.b;r=b._x||b.x,s=b._y||b.y;var w={};if(b._cheater){var x="index"===p.cheatertype?u.length:u,y="index"===q.cheatertype?v.length:v;r=f(x,y,b.cheaterslope)}b._x=r=k(r),b._y=s=k(s),l(r,u,v),l(s,u,v),n(b),b.setScale();var z=g(r),A=g(s),B=.5*(z[1]-z[0]),C=.5*(z[1]+z[0]),D=.5*(A[1]-A[0]),E=.5*(A[1]+A[0]);return z=[C-1.3*B,C+1.3*B],A=[E-1.3*D,E+1.3*D],b._extremes[c._id]=d.findExtremes(c,z,{padded:!0}),b._extremes[o._id]=d.findExtremes(o,A,{padded:!0}),h(b,"a","b"),h(b,"b","a"),i(b,p),i(b,q),w.clipsegments=j(b._xctrl,b._yctrl,p,q),w.x=r,w.y=s,w.a=u,w.b=v,[w]}},{"../../lib":719,"../../plots/cartesian/axes":767,"../heatmap/clean_2d_array":1002,"../heatmap/convert_column_xyz":1004,"./array_minmax":898,"./calc_clippath":904,"./calc_gridlines":905,"./calc_labels":906,"./cheater_basis":908,"./set_convert":921,"./smooth_fill_2d_array":922}],904:[function(a,b,c){"use strict";b.exports=function(a,b,c,d){var e,f,g,h=[],i=!!c.smoothing,j=!!d.smoothing,k=a[0].length-1,l=a.length-1;for(e=0,f=[],g=[];e<=k;e++)f[e]=a[0][e],g[e]=b[0][e];for(h.push({x:f,y:g,bicubic:i}),e=0,f=[],g=[];e<=l;e++)f[e]=a[e][k],g[e]=b[e][k];for(h.push({x:f,y:g,bicubic:j}),e=k,f=[],g=[];e>=0;e--)f[k-e]=a[l][e],g[k-e]=b[l][e];for(h.push({x:f,y:g,bicubic:i}),e=l,f=[],g=[];e>=0;e--)f[l-e]=a[e][0],g[l-e]=b[e][0];return h.push({x:f,y:g,bicubic:j}),h}},{}],905:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../../lib/extend").extendFlat;b.exports=function(a,b,c){function f(d){var e,f,g,h,i,j,k,l,m,n,p,q,r=[],s=[],t={};if("b"===b)for(f=a.b2j(d),g=Math.floor(Math.max(0,Math.min(H-2,f))),h=f-g,t.length=H,t.crossLength=G,t.xy=function(b){return a.evalxy([],b,f)},t.dxy=function(b,c){return a.dxydi([],b,g,c,h)},e=0;e<G;e++)j=Math.min(G-2,e),k=e-j,l=a.evalxy([],e,f),B.smoothing&&e>0&&(m=a.dxydi([],e-1,g,0,h),r.push(i[0]+m[0]/3),s.push(i[1]+m[1]/3),n=a.dxydi([],e-1,g,1,h),r.push(l[0]-n[0]/3),s.push(l[1]-n[1]/3)),r.push(l[0]),s.push(l[1]),i=l;else for(e=a.a2i(d),j=Math.floor(Math.max(0,Math.min(G-2,e))),k=e-j,t.length=G,t.crossLength=H,t.xy=function(b){return a.evalxy([],e,b)},t.dxy=function(b,c){return a.dxydj([],j,b,k,c)},f=0;f<H;f++)g=Math.min(H-2,f),h=f-g,l=a.evalxy([],e,f),B.smoothing&&f>0&&(p=a.dxydj([],j,f-1,k,0),r.push(i[0]+p[0]/3),s.push(i[1]+p[1]/3),q=a.dxydj([],j,f-1,k,1),r.push(l[0]-q[0]/3),s.push(l[1]-q[1]/3)),r.push(l[0]),s.push(l[1]),i=l;return t.axisLetter=b,t.axis=w,t.crossAxis=B,t.value=d,t.constvar=c,t.index=o,t.x=r,t.y=s,t.smoothing=B.smoothing,t}function g(d){var e,f,g,h,i,j=[],k=[],l={};if(l.length=v.length,l.crossLength=A.length,"b"===b)for(g=Math.max(0,Math.min(H-2,d)),i=Math.min(1,Math.max(0,d-g)),l.xy=function(b){return a.evalxy([],b,d)},l.dxy=function(b,c){return a.dxydi([],b,g,c,i)},e=0;e<E;e++)j[e]=C[d*I][e],k[e]=D[d*I][e];else for(f=Math.max(0,Math.min(G-2,d)),h=Math.min(1,Math.max(0,d-f)),l.xy=function(b){return a.evalxy([],d,b)},l.dxy=function(b,c){return a.dxydj([],f,b,h,c)},e=0;e<F;e++)j[e]=C[e][d*I],k[e]=D[e][d*I];return l.axisLetter=b,l.axis=w,l.crossAxis=B,l.value=v[d],l.constvar=c,l.index=d,l.x=j,l.y=k,l.smoothing=B.smoothing,l}var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=a["_"+b],w=a[b+"axis"],x=w._gridlines=[],y=w._minorgridlines=[],z=w._boundarylines=[],A=a["_"+c],B=a[c+"axis"];"array"===w.tickmode&&(w.tickvals=v.slice());var C=a._xctrl,D=a._yctrl,E=C[0].length,F=C.length,G=a._a.length,H=a._b.length;d.prepTicks(w),"array"===w.tickmode&&delete w.tickvals;var I=w.smoothing?3:1;if("array"===w.tickmode){for(k=5e-15,m=(l=[Math.floor((v.length-1-w.arraytick0)/w.arraydtick*(1+k)),Math.ceil(-w.arraytick0/w.arraydtick/(1+k))].sort(function(a,b){return a-b}))[0]-1,n=l[1]+1,o=m;o<n;o++)(i=w.arraytick0+w.arraydtick*o)<0||i>v.length-1||x.push(e(g(i),{color:w.gridcolor,width:w.gridwidth}));for(o=m;o<n;o++)if(j=w.arraytick0+w.arraydtick*o,r=Math.min(j+w.arraydtick,v.length-1),!(j<0||j>v.length-1||r<0||r>v.length-1))for(s=v[j],t=v[r],h=0;h<w.minorgridcount;h++)(u=r-j)<=0||(q=s+(t-s)*(h+1)/(w.minorgridcount+1)*(w.arraydtick/u))<v[0]||q>v[v.length-1]||y.push(e(f(q),{color:w.minorgridcolor,width:w.minorgridwidth}));w.startline&&z.push(e(g(0),{color:w.startlinecolor,width:w.startlinewidth})),w.endline&&z.push(e(g(v.length-1),{color:w.endlinecolor,width:w.endlinewidth}))}else{for(k=5e-15,m=(l=[Math.floor((v[v.length-1]-w.tick0)/w.dtick*(1+k)),Math.ceil((v[0]-w.tick0)/w.dtick/(1+k))].sort(function(a,b){return a-b}))[0],n=l[1],o=m;o<=n;o++)p=w.tick0+w.dtick*o,x.push(e(f(p),{color:w.gridcolor,width:w.gridwidth}));for(o=m-1;o<n+1;o++)for(p=w.tick0+w.dtick*o,h=0;h<w.minorgridcount;h++)(q=p+w.dtick*(h+1)/(w.minorgridcount+1))<v[0]||q>v[v.length-1]||y.push(e(f(q),{color:w.minorgridcolor,width:w.minorgridwidth}));w.startline&&z.push(e(f(v[0]),{color:w.startlinecolor,width:w.startlinewidth})),w.endline&&z.push(e(f(v[v.length-1]),{color:w.endlinecolor,width:w.endlinewidth}))}}},{"../../lib/extend":710,"../../plots/cartesian/axes":767}],906:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../../lib/extend").extendFlat;b.exports=function(a,b){var c,f,g,h=b._labels=[],i=b._gridlines;for(c=0;c<i.length;c++)g=i[c],-1!==["start","both"].indexOf(b.showticklabels)&&(f=d.tickText(b,g.value),e(f,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:g.xy(0),dxy:g.dxy(0,0),axis:g.axis,length:g.crossAxis.length,font:g.axis.tickfont,isFirst:0===c,isLast:c===i.length-1}),h.push(f)),-1!==["end","both"].indexOf(b.showticklabels)&&(f=d.tickText(b,g.value),e(f,{endAnchor:!1,xy:g.xy(g.crossLength-1),dxy:g.dxy(g.crossLength-2,1),axis:g.axis,length:g.crossAxis.length,font:g.axis.tickfont,isFirst:0===c,isLast:c===i.length-1}),h.push(f))}},{"../../lib/extend":710,"../../plots/cartesian/axes":767}],907:[function(a,b,c){"use strict";b.exports=function(a,b,c,d){var e=a[0]-b[0],f=a[1]-b[1],g=c[0]-b[0],h=c[1]-b[1],i=Math.pow(e*e+f*f,.25),j=Math.pow(g*g+h*h,.25),k=(j*j*e-i*i*g)*d,l=(j*j*f-i*i*h)*d,m=j*(i+j)*3,n=i*(i+j)*3;return[[b[0]+(m&&k/m),b[1]+(m&&l/m)],[b[0]-(n&&k/n),b[1]-(n&&l/n)]]}},{}],908:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray;b.exports=function(a,b,c){var e,f,g,h,i,j,k=[],l=d(a)?a.length:a,m=d(b)?b.length:b,n=d(a)?a:null,o=d(b)?b:null;n&&(g=(n.length-1)/(n[n.length-1]-n[0])/(l-1)),o&&(h=(o.length-1)/(o[o.length-1]-o[0])/(m-1));var p=1/0,q=-1/0;for(f=0;f<m;f++)for(k[f]=[],i=o?(o[f]-o[0])*h:f/(m-1),e=0;e<l;e++)j=(n?(n[e]-n[0])*g:e/(l-1))-i*c,p=Math.min(j,p),q=Math.max(j,q),k[f][e]=j;var r=1/(q-p),s=-p*r;for(f=0;f<m;f++)for(e=0;e<l;e++)k[f][e]=r*k[f][e]+s;return k}},{"../../lib":719}],909:[function(a,b,c){"use strict";function d(a,b,c){var d=-.5*c[0]+1.5*b[0],e=-.5*c[1]+1.5*b[1];return[(2*d+a[0])/3,(2*e+a[1])/3]}var e=a("./catmull_rom"),f=a("../../lib").ensureArray;b.exports=function(a,b,c,g,h,i){var j,k,l,m,n,o,p,q,r,s,t=c[0].length,u=c.length,v=h?3*t-2:t,w=i?3*u-2:u;for(a=f(a,w),b=f(b,w),l=0;l<w;l++)a[l]=f(a[l],v),b[l]=f(b[l],v);for(k=0,m=0;k<u;k++,m+=i?3:1)for(n=a[m],o=b[m],p=c[k],q=g[k],j=0,l=0;j<t;j++,l+=h?3:1)n[l]=p[j],o[l]=q[j];if(h)for(k=0,m=0;k<u;k++,m+=i?3:1){for(j=1,l=3;j<t-1;j++,l+=3)r=e([c[k][j-1],g[k][j-1]],[c[k][j],g[k][j]],[c[k][j+1],g[k][j+1]],h),a[m][l-1]=r[0][0],b[m][l-1]=r[0][1],a[m][l+1]=r[1][0],b[m][l+1]=r[1][1];s=d([a[m][0],b[m][0]],[a[m][2],b[m][2]],[a[m][3],b[m][3]]),a[m][1]=s[0],b[m][1]=s[1],s=d([a[m][v-1],b[m][v-1]],[a[m][v-3],b[m][v-3]],[a[m][v-4],b[m][v-4]]),a[m][v-2]=s[0],b[m][v-2]=s[1]}if(i)for(l=0;l<v;l++){for(m=3;m<w-3;m+=3)r=e([a[m-3][l],b[m-3][l]],[a[m][l],b[m][l]],[a[m+3][l],b[m+3][l]],i),a[m-1][l]=r[0][0],b[m-1][l]=r[0][1],a[m+1][l]=r[1][0],b[m+1][l]=r[1][1];s=d([a[0][l],b[0][l]],[a[2][l],b[2][l]],[a[3][l],b[3][l]]),a[1][l]=s[0],b[1][l]=s[1],s=d([a[w-1][l],b[w-1][l]],[a[w-3][l],b[w-3][l]],[a[w-4][l],b[w-4][l]]),a[w-2][l]=s[0],b[w-2][l]=s[1]}if(h&&i)for(m=1;m<w;m+=(m+1)%3==0?2:1){for(l=3;l<v-3;l+=3)r=e([a[m][l-3],b[m][l-3]],[a[m][l],b[m][l]],[a[m][l+3],b[m][l+3]],h),a[m][l-1]=.5*(a[m][l-1]+r[0][0]),b[m][l-1]=.5*(b[m][l-1]+r[0][1]),a[m][l+1]=.5*(a[m][l+1]+r[1][0]),b[m][l+1]=.5*(b[m][l+1]+r[1][1]);s=d([a[m][0],b[m][0]],[a[m][2],b[m][2]],[a[m][3],b[m][3]]),a[m][1]=.5*(a[m][1]+s[0]),b[m][1]=.5*(b[m][1]+s[1]),s=d([a[m][v-1],b[m][v-1]],[a[m][v-3],b[m][v-3]],[a[m][v-4],b[m][v-4]]),a[m][v-2]=.5*(a[m][v-2]+s[0]),b[m][v-2]=.5*(b[m][v-2]+s[1])}return[a,b]}},{"../../lib":719,"./catmull_rom":907}],910:[function(a,b,c){"use strict";b.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],911:[function(a,b,c){"use strict";b.exports=function(a,b,c){return b&&c?function(b,c,d,e,f){var g,h,i,j,k,l;b||(b=[]),c*=3,d*=3;var m=e*e,n=1-e,o=n*n,p=n*e*2,q=-3*o,r=3*(o-p),s=3*(p-m),t=3*m,u=f*f,v=u*f,w=1-f,x=w*w,y=x*w;for(l=0;l<a.length;l++)g=q*(k=a[l])[d][c]+r*k[d][c+1]+s*k[d][c+2]+t*k[d][c+3],h=q*k[d+1][c]+r*k[d+1][c+1]+s*k[d+1][c+2]+t*k[d+1][c+3],i=q*k[d+2][c]+r*k[d+2][c+1]+s*k[d+2][c+2]+t*k[d+2][c+3],j=q*k[d+3][c]+r*k[d+3][c+1]+s*k[d+3][c+2]+t*k[d+3][c+3],b[l]=y*g+3*(x*f*h+w*u*i)+v*j;return b}:b?function(b,c,d,e,f){var g,h,i,j;b||(b=[]),c*=3;var k=e*e,l=1-e,m=l*l,n=l*e*2,o=-3*m,p=3*(m-n),q=3*(n-k),r=3*k,s=1-f;for(i=0;i<a.length;i++)g=o*(j=a[i])[d][c]+p*j[d][c+1]+q*j[d][c+2]+r*j[d][c+3],h=o*j[d+1][c]+p*j[d+1][c+1]+q*j[d+1][c+2]+r*j[d+1][c+3],b[i]=s*g+f*h;return b}:c?function(b,c,d,e,f){var g,h,i,j,k,l;b||(b=[]),d*=3;var m=f*f,n=m*f,o=1-f,p=o*o,q=p*o;for(k=0;k<a.length;k++)g=(l=a[k])[d][c+1]-l[d][c],h=l[d+1][c+1]-l[d+1][c],i=l[d+2][c+1]-l[d+2][c],j=l[d+3][c+1]-l[d+3][c],b[k]=q*g+3*(p*f*h+o*m*i)+n*j;return b}:function(b,c,d,e,f){var g,h,i,j;b||(b=[]);var k=1-f;for(i=0;i<a.length;i++)g=(j=a[i])[d][c+1]-j[d][c],h=j[d+1][c+1]-j[d+1][c],b[i]=k*g+f*h;return b}}},{}],912:[function(a,b,c){"use strict";b.exports=function(a,b,c){return b&&c?function(b,c,d,e,f){var g,h,i,j,k,l;b||(b=[]),c*=3,d*=3;var m=e*e,n=m*e,o=1-e,p=o*o,q=p*o,r=f*f,s=1-f,t=s*s,u=s*f*2,v=-3*t,w=3*(t-u),x=3*(u-r),y=3*r;for(l=0;l<a.length;l++)g=v*(k=a[l])[d][c]+w*k[d+1][c]+x*k[d+2][c]+y*k[d+3][c],h=v*k[d][c+1]+w*k[d+1][c+1]+x*k[d+2][c+1]+y*k[d+3][c+1],i=v*k[d][c+2]+w*k[d+1][c+2]+x*k[d+2][c+2]+y*k[d+3][c+2],j=v*k[d][c+3]+w*k[d+1][c+3]+x*k[d+2][c+3]+y*k[d+3][c+3],b[l]=q*g+3*(p*e*h+o*m*i)+n*j;return b}:b?function(b,c,d,e,f){var g,h,i,j,k,l;b||(b=[]),c*=3;var m=f*f,n=m*f,o=1-f,p=o*o,q=p*o;for(k=0;k<a.length;k++)g=(l=a[k])[d+1][c]-l[d][c],h=l[d+1][c+1]-l[d][c+1],i=l[d+1][c+2]-l[d][c+2],j=l[d+1][c+3]-l[d][c+3],b[k]=q*g+3*(p*f*h+o*m*i)+n*j;return b}:c?function(b,c,d,e,f){var g,h,i,j;b||(b=[]),d*=3;var k=1-e,l=f*f,m=1-f,n=m*m,o=m*f*2,p=-3*n,q=3*(n-o),r=3*(o-l),s=3*l;for(i=0;i<a.length;i++)g=p*(j=a[i])[d][c]+q*j[d+1][c]+r*j[d+2][c]+s*j[d+3][c],h=p*j[d][c+1]+q*j[d+1][c+1]+r*j[d+2][c+1]+s*j[d+3][c+1],b[i]=k*g+e*h;return b}:function(b,c,d,e,f){var g,h,i,j;b||(b=[]);var k=1-e;for(i=0;i<a.length;i++)g=(j=a[i])[d+1][c]-j[d][c],h=j[d+1][c+1]-j[d][c+1],b[i]=k*g+e*h;return b}}},{}],913:[function(a,b,c){"use strict";b.exports=function(a,b,c,d,e){var f=b-2,g=c-2;return d&&e?function(b,c,d){var e,h,i,j,k,l;b||(b=[]);var m=Math.max(0,Math.min(Math.floor(c),f)),n=Math.max(0,Math.min(Math.floor(d),g)),o=Math.max(0,Math.min(1,c-m)),p=Math.max(0,Math.min(1,d-n));m*=3,n*=3;var q=o*o,r=q*o,s=1-o,t=s*s,u=t*s,v=p*p,w=v*p,x=1-p,y=x*x,z=y*x;for(l=0;l<a.length;l++)e=u*(k=a[l])[n][m]+3*(t*o*k[n][m+1]+s*q*k[n][m+2])+r*k[n][m+3],h=u*k[n+1][m]+3*(t*o*k[n+1][m+1]+s*q*k[n+1][m+2])+r*k[n+1][m+3],i=u*k[n+2][m]+3*(t*o*k[n+2][m+1]+s*q*k[n+2][m+2])+r*k[n+2][m+3],j=u*k[n+3][m]+3*(t*o*k[n+3][m+1]+s*q*k[n+3][m+2])+r*k[n+3][m+3],b[l]=z*e+3*(y*p*h+x*v*i)+w*j;return b}:d?function(b,c,d){b||(b=[]);var e,h,i,j,k,l,m=Math.max(0,Math.min(Math.floor(c),f)),n=Math.max(0,Math.min(Math.floor(d),g)),o=Math.max(0,Math.min(1,c-m)),p=Math.max(0,Math.min(1,d-n));m*=3;var q=o*o,r=q*o,s=1-o,t=s*s,u=t*s,v=1-p;for(k=0;k<a.length;k++)e=v*(l=a[k])[n][m]+p*l[n+1][m],h=v*l[n][m+1]+p*l[n+1][m+1],i=v*l[n][m+2]+p*l[n+1][m+1],j=v*l[n][m+3]+p*l[n+1][m+1],b[k]=u*e+3*(t*o*h+s*q*i)+r*j;return b}:e?function(b,c,d){b||(b=[]);var e,h,i,j,k,l,m=Math.max(0,Math.min(Math.floor(c),f)),n=Math.max(0,Math.min(Math.floor(d),g)),o=Math.max(0,Math.min(1,c-m)),p=Math.max(0,Math.min(1,d-n));n*=3;var q=p*p,r=q*p,s=1-p,t=s*s,u=t*s,v=1-o;for(k=0;k<a.length;k++)e=v*(l=a[k])[n][m]+o*l[n][m+1],h=v*l[n+1][m]+o*l[n+1][m+1],i=v*l[n+2][m]+o*l[n+2][m+1],j=v*l[n+3][m]+o*l[n+3][m+1],b[k]=u*e+3*(t*p*h+s*q*i)+r*j;return b}:function(b,c,d){b||(b=[]);var e,h,i,j,k=Math.max(0,Math.min(Math.floor(c),f)),l=Math.max(0,Math.min(Math.floor(d),g)),m=Math.max(0,Math.min(1,c-k)),n=Math.max(0,Math.min(1,d-l)),o=1-n,p=1-m;for(i=0;i<a.length;i++)e=p*(j=a[i])[l][k]+m*j[l][k+1],h=p*j[l+1][k]+m*j[l+1][k+1],b[i]=o*e+n*h;return b}}},{}],914:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./xy_defaults"),f=a("./ab_defaults"),g=a("./attributes"),h=a("../../components/color/attributes");b.exports=function(a,b,c,i){function j(c,e){return d.coerce(a,b,g,c,e)}b._clipPathId="clip"+b.uid+"carpet";var k=j("color",h.defaultLine);d.coerceFont(j,"font"),j("carpet"),f(a,b,i,j,k),b.a&&b.b?(b.a.length<3&&(b.aaxis.smoothing=0),b.b.length<3&&(b.baxis.smoothing=0),e(a,b,j)||(b.visible=!1),b._cheater&&j("cheaterslope")):b.visible=!1}},{"../../components/color/attributes":593,"../../lib":719,"./ab_defaults":897,"./attributes":899,"./xy_defaults":923}],915:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),plot:a("./plot"),calc:a("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover"],meta:{}}},{"../../plots/cartesian":778,"./attributes":899,"./calc":903,"./defaults":914,"./plot":920}],916:[function(a,b,c){"use strict";b.exports=function(a,b){for(var c,d=a._fullData.length,e=0;e<d;e++){var f=a._fullData[e];if(f.index!==b.index&&"carpet"===f.type&&(c||(c=f),f.carpet===b.carpet))return f}return c}},{}],917:[function(a,b,c){"use strict";b.exports=function(a,b,c){if(0===a.length)return"";var d,e=[],f=c?3:1;for(d=0;d<a.length;d+=f)e.push(a[d]+","+b[d]),c&&d<a.length-f&&(e.push("C"),e.push([a[d+1]+","+b[d+1],a[d+2]+","+b[d+2]+" "].join(" ")));return e.join(c?"":"L")}},{}],918:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray;b.exports=function(a,b,c){var e;for(d(a)?a.length>b.length&&(a=a.slice(0,b.length)):a=[],e=0;e<b.length;e++)a[e]=c(b[e]);return a}},{"../../lib":719}],919:[function(a,b,c){"use strict";b.exports=function(a,b,c,d,e,f){var g=e[0]*a.dpdx(b),h=e[1]*a.dpdy(c),i=1,j=1;if(f){var k=Math.sqrt(e[0]*e[0]+e[1]*e[1]),l=Math.sqrt(f[0]*f[0]+f[1]*f[1]),m=(e[0]*f[0]+e[1]*f[1])/k/l;j=Math.max(0,m)}var n=180*Math.atan2(h,g)/Math.PI;return n<-90?(n+=180,i=-i):n>90&&(n-=180,i=-i),{angle:n,flip:i,p:a.c2p(d,b,c),offsetMultplier:j}}},{}],920:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){var h="const-"+e+"-lines",k=c.selectAll("."+h).data(f);k.enter().append("path").classed(h,!0).style("vector-effect","non-scaling-stroke"),k.each(function(c){var d=c,e=d.x,f=d.y,h=i([],e,a.c2p),k=i([],f,b.c2p),l="M"+j(h,k,d.smoothing);g.select(this).attr("d",l).style("stroke-width",d.width).style("stroke",d.color).style("fill","none")}),k.exit().remove()}function e(a,b,c,d,e,f,i,j){var m=f.selectAll("text."+j).data(i);m.enter().append("text").classed(j,!0);var n=0,o={};return m.each(function(e,f){var i;if("auto"===e.axis.tickangle)i=k(d,b,c,e.xy,e.dxy);else{var j=(e.axis.tickangle+180)*Math.PI/180;i=k(d,b,c,e.xy,[Math.cos(j),Math.sin(j)])}f||(o={angle:i.angle,flip:i.flip});var m=(e.endAnchor?-1:1)*i.flip,p=g.select(this).attr({"text-anchor":m>0?"start":"end","data-notex":1}).call(h.font,e.font).text(e.text).call(l.convertToTspans,a),q=h.bBox(this);p.attr("transform","translate("+i.p[0]+","+i.p[1]+") rotate("+i.angle+")translate("+e.axis.labelpadding*m+","+.3*q.height+")"),n=Math.max(n,q.width+e.axis.labelpadding)}),m.exit().remove(),o.maxExtent=n,o}function f(a,b,c,d,e,f,i,j,m,n,q){var r=[];i.title.text&&r.push(i.title.text);var s=b.selectAll("text."+q).data(r),t=n.maxExtent;s.enter().append("text").classed(q,!0),s.each(function(){var b=k(c,j,m,e,f);-1===["start","both"].indexOf(i.showticklabels)&&(t=0);var d=i.title.font.size;t+=d+i.title.offset;var q=(n.angle+(n.flip<0?180:0)-b.angle+450)%360,r=q>90&&q<270,s=g.select(this);s.text(i.title.text).call(l.convertToTspans,a),r&&(t=(-l.lineCount(s)+p)*o*d-t),s.attr("transform","translate("+b.p[0]+","+b.p[1]+") rotate("+b.angle+") translate(0,"+t+")").classed("user-select-none",!0).attr("text-anchor","middle").call(h.font,i.title.font)}),s.exit().remove()}var g=a("d3"),h=a("../../components/drawing"),i=a("./map_1d_array"),j=a("./makepath"),k=a("./orient_text"),l=a("../../lib/svg_text_utils"),m=a("../../lib"),n=a("../../constants/alignment");b.exports=function(a,b,c,h){var l=b.xaxis,n=b.yaxis,o=a._fullLayout._clips;m.makeTraceGroups(h,c,"trace").each(function(b){var c=g.select(this),h=b[0],p=h.trace,q=p.aaxis,r=p.baxis,s=m.ensureSingle(c,"g","minorlayer"),t=m.ensureSingle(c,"g","majorlayer"),u=m.ensureSingle(c,"g","boundarylayer"),v=m.ensureSingle(c,"g","labellayer");c.style("opacity",p.opacity),d(l,n,t,q,"a",q._gridlines),d(l,n,t,r,"b",r._gridlines),d(l,n,s,q,"a",q._minorgridlines),d(l,n,s,r,"b",r._minorgridlines),d(l,n,u,q,"a-boundary",q._boundarylines),d(l,n,u,r,"b-boundary",r._boundarylines);var w=e(a,l,n,p,h,v,q._labels,"a-label"),x=e(a,l,n,p,h,v,r._labels,"b-label");!function(a,b,c,d,e,g,h,i){var j,l,n,o,p=m.aggNums(Math.min,null,c.a),q=m.aggNums(Math.max,null,c.a),r=m.aggNums(Math.min,null,c.b),s=m.aggNums(Math.max,null,c.b);j=.5*(p+q),l=r,n=c.ab2xy(j,l,!0),o=c.dxyda_rough(j,l),void 0===h.angle&&m.extendFlat(h,k(c,e,g,n,c.dxydb_rough(j,l))),f(a,b,c,d,n,o,c.aaxis,e,g,h,"a-title"),j=p,l=.5*(r+s),n=c.ab2xy(j,l,!0),o=c.dxydb_rough(j,l),void 0===i.angle&&m.extendFlat(i,k(c,e,g,n,c.dxyda_rough(j,l))),f(a,b,c,d,n,o,c.baxis,e,g,i,"b-title")}(a,v,p,h,l,n,w,x),function(a,b,c,d,e){var f,g,h,k,l=c.select("#"+a._clipPathId);l.size()||(l=c.append("clipPath").classed("carpetclip",!0));var n=m.ensureSingle(l,"path","carpetboundary"),o=b.clipsegments,p=[];for(k=0;k<o.length;k++)f=o[k],g=i([],f.x,d.c2p),h=i([],f.y,e.c2p),p.push(j(g,h,f.bicubic));var q="M"+p.join("L")+"Z";l.attr("id",a._clipPathId),n.attr("d",q)}(p,h,o,l,n)})};var o=n.LINE_SPACING,p=(1-n.MID_SHIFT)/o+1},{"../../components/drawing":615,"../../constants/alignment":688,"../../lib":719,"../../lib/svg_text_utils":743,"./makepath":917,"./map_1d_array":918,"./orient_text":919,d3:164}],921:[function(a,b,c){"use strict";var d=a("./constants"),e=a("../../lib/search").findBin,f=a("./compute_control_points"),g=a("./create_spline_evaluator"),h=a("./create_i_derivative_evaluator"),i=a("./create_j_derivative_evaluator");b.exports=function(a){var b=a._a,c=a._b,j=b.length,k=c.length,l=a.aaxis,m=a.baxis,n=b[0],o=b[j-1],p=c[0],q=c[k-1],r=b[b.length-1]-b[0],s=c[c.length-1]-c[0],t=r*d.RELATIVE_CULL_TOLERANCE,u=s*d.RELATIVE_CULL_TOLERANCE;n-=t,o+=t,p-=u,q+=u,a.isVisible=function(a,b){return a>n&&a<o&&b>p&&b<q},a.isOccluded=function(a,b){return a<n||a>o||b<p||b>q},a.setScale=function(){var b=a._x,c=a._y,d=f(a._xctrl,a._yctrl,b,c,l.smoothing,m.smoothing);a._xctrl=d[0],a._yctrl=d[1],a.evalxy=g([a._xctrl,a._yctrl],j,k,l.smoothing,m.smoothing),a.dxydi=h([a._xctrl,a._yctrl],l.smoothing,m.smoothing),a.dxydj=i([a._xctrl,a._yctrl],l.smoothing,m.smoothing)},a.i2a=function(a){var c=Math.max(0,Math.floor(a[0]),j-2),d=a[0]-c;return(1-d)*b[c]+d*b[c+1]},a.j2b=function(a){var b=Math.max(0,Math.floor(a[1]),j-2),d=a[1]-b;return(1-d)*c[b]+d*c[b+1]},a.ij2ab=function(b){return[a.i2a(b[0]),a.j2b(b[1])]},a.a2i=function(a){var c=Math.max(0,Math.min(e(a,b),j-2)),d=b[c],f=b[c+1];return Math.max(0,Math.min(j-1,c+(a-d)/(f-d)))},a.b2j=function(a){var b=Math.max(0,Math.min(e(a,c),k-2)),d=c[b],f=c[b+1];return Math.max(0,Math.min(k-1,b+(a-d)/(f-d)))},a.ab2ij=function(b){return[a.a2i(b[0]),a.b2j(b[1])]},a.i2c=function(b,c){return a.evalxy([],b,c)},a.ab2xy=function(d,e,f){if(!f&&(d<b[0]||d>b[j-1]|e<c[0]||e>c[k-1]))return[!1,!1];var g=a.a2i(d),h=a.b2j(e),i=a.evalxy([],g,h);if(f){var l,m,n,o,p=0,q=0,r=[];d<b[0]?(l=0,m=0,
p=(d-b[0])/(b[1]-b[0])):d>b[j-1]?(l=j-2,m=1,p=(d-b[j-1])/(b[j-1]-b[j-2])):m=g-(l=Math.max(0,Math.min(j-2,Math.floor(g)))),e<c[0]?(n=0,o=0,q=(e-c[0])/(c[1]-c[0])):e>c[k-1]?(n=k-2,o=1,q=(e-c[k-1])/(c[k-1]-c[k-2])):o=h-(n=Math.max(0,Math.min(k-2,Math.floor(h)))),p&&(a.dxydi(r,l,n,m,o),i[0]+=r[0]*p,i[1]+=r[1]*p),q&&(a.dxydj(r,l,n,m,o),i[0]+=r[0]*q,i[1]+=r[1]*q)}return i},a.c2p=function(a,b,c){return[b.c2p(a[0]),c.c2p(a[1])]},a.p2x=function(a,b,c){return[b.p2c(a[0]),c.p2c(a[1])]},a.dadi=function(a){var c=Math.max(0,Math.min(b.length-2,a));return b[c+1]-b[c]},a.dbdj=function(a){var b=Math.max(0,Math.min(c.length-2,a));return c[b+1]-c[b]},a.dxyda=function(b,c,d,e){var f=a.dxydi(null,b,c,d,e),g=a.dadi(b,d);return[f[0]/g,f[1]/g]},a.dxydb=function(b,c,d,e){var f=a.dxydj(null,b,c,d,e),g=a.dbdj(c,e);return[f[0]/g,f[1]/g]},a.dxyda_rough=function(b,c,d){var e=r*(d||.1),f=a.ab2xy(b+e,c,!0),g=a.ab2xy(b-e,c,!0);return[.5*(f[0]-g[0])/e,.5*(f[1]-g[1])/e]},a.dxydb_rough=function(b,c,d){var e=s*(d||.1),f=a.ab2xy(b,c+e,!0),g=a.ab2xy(b,c-e,!0);return[.5*(f[0]-g[0])/e,.5*(f[1]-g[1])/e]},a.dpdx=function(a){return a._m},a.dpdy=function(a){return a._m}}},{"../../lib/search":738,"./compute_control_points":909,"./constants":910,"./create_i_derivative_evaluator":911,"./create_j_derivative_evaluator":912,"./create_spline_evaluator":913}],922:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=[],t=[],u=a[0].length,v=a.length,w=0;for(e=0;e<u;e++)for(f=0;f<v;f++)void 0===a[f][e]&&(s.push(e),t.push(f),a[f][e]=function(b,c){var d,e=0,f=0;return b>0&&void 0!==(d=a[c][b-1])&&(f++,e+=d),b<u-1&&void 0!==(d=a[c][b+1])&&(f++,e+=d),c>0&&void 0!==(d=a[c-1][b])&&(f++,e+=d),c<v-1&&void 0!==(d=a[c+1][b])&&(f++,e+=d),e/Math.max(1,f)}(e,f)),w=Math.max(w,Math.abs(a[f][e]));if(!s.length)return a;var x=0,y=0,z=s.length;do{for(x=0,g=0;g<z;g++){e=s[g],f=t[g];var A,B,C,D,E,F,G=0,H=0;0===e?(C=b[E=Math.min(u-1,2)],D=b[1],A=a[f][E],H+=(B=a[f][1])+(B-A)*(b[0]-D)/(D-C),G++):e===u-1&&(C=b[E=Math.max(0,u-3)],D=b[u-2],A=a[f][E],H+=(B=a[f][u-2])+(B-A)*(b[u-1]-D)/(D-C),G++),(0===e||e===u-1)&&f>0&&f<v-1&&(h=c[f+1]-c[f],H+=((i=c[f]-c[f-1])*a[f+1][e]+h*a[f-1][e])/(i+h),G++),0===f?(C=c[F=Math.min(v-1,2)],D=c[1],A=a[F][e],H+=(B=a[1][e])+(B-A)*(c[0]-D)/(D-C),G++):f===v-1&&(C=c[F=Math.max(0,v-3)],D=c[v-2],A=a[F][e],H+=(B=a[v-2][e])+(B-A)*(c[v-1]-D)/(D-C),G++),(0===f||f===v-1)&&e>0&&e<u-1&&(h=b[e+1]-b[e],H+=((i=b[e]-b[e-1])*a[f][e+1]+h*a[f][e-1])/(i+h),G++),G?H/=G:(j=b[e+1]-b[e],k=b[e]-b[e-1],o=(l=c[f+1]-c[f])*(m=c[f]-c[f-1])*(l+m),H=((n=j*k*(j+k))*(m*a[f+1][e]+l*a[f-1][e])+o*(k*a[f][e+1]+j*a[f][e-1]))/(o*(k+j)+n*(m+l))),x+=(q=(p=H-a[f][e])/w)*q,r=G?0:.85,a[f][e]+=p*(1+r)}x=Math.sqrt(x)}while(y++<100&&x>1e-5);return d.log("Smoother converged to",x,"after",y,"iterations"),a}},{"../../lib":719}],923:[function(a,b,c){"use strict";var d=a("../../lib").isArray1D;b.exports=function(a,b,c){var e=c("x"),f=e&&e.length,g=c("y"),h=g&&g.length;if(!f&&!h)return!1;if(b._cheater=!e,f&&!d(e)||h&&!d(g))b._length=null;else{var i=f?e.length:1/0;h&&(i=Math.min(i,g.length)),b.a&&b.a.length&&(i=Math.min(i,b.a.length)),b.b&&b.b.length&&(i=Math.min(i,b.b.length)),b._length=i}return!0}},{"../../lib":719}],924:[function(a,b,c){"use strict";var d=a("../../plots/template_attributes").hovertemplateAttrs,e=a("../scattergeo/attributes"),f=a("../../components/colorscale/attributes"),g=a("../../plots/attributes"),h=a("../../components/color/attributes").defaultLine,i=a("../../lib/extend").extendFlat,j=e.marker.line;b.exports=i({locations:{valType:"data_array",editType:"calc"},locationmode:e.locationmode,z:{valType:"data_array",editType:"calc"},text:i({},e.text,{}),hovertext:i({},e.hovertext,{}),marker:{line:{color:i({},j.color,{dflt:h}),width:i({},j.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:e.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:i({},g.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:d()},f("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":593,"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/template_attributes":843,"../scattergeo/attributes":1150}],925:[function(a,b,c){"use strict";function d(a){return a&&"string"==typeof a}var e=a("fast-isnumeric"),f=a("../../constants/numerical").BADNUM,g=a("../../components/colorscale/calc"),h=a("../scatter/arrays_to_calcdata"),i=a("../scatter/calc_selection");b.exports=function(a,b){var c,j=b._length,k=new Array(j);c=b.geojson?function(a){return d(a)||e(a)}:d;for(var l=0;l<j;l++){var m=k[l]={},n=b.locations[l],o=b.z[l];c(n)&&e(o)?(m.loc=n,m.z=o):(m.loc=null,m.z=f),m.index=l}return h(k,b),g(a,b,{vals:b.z,containerStr:"",cLetter:"z"}),i(k,b),k}},{"../../components/colorscale/calc":602,"../../constants/numerical":695,"../scatter/arrays_to_calcdata":1110,"../scatter/calc_selection":1113,"fast-isnumeric":226}],926:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/defaults"),f=a("./attributes");b.exports=function(a,b,c,g){function h(c,e){return d.coerce(a,b,f,c,e)}var i=h("locations"),j=h("z");i&&i.length&&d.isArrayOrTypedArray(j)&&j.length?(b._length=Math.min(i.length,j.length),h("locationmode"),h("text"),h("hovertext"),h("hovertemplate"),h("marker.line.width")&&h("marker.line.color"),h("marker.opacity"),e(a,b,g,h,{prefix:"",cLetter:"z"}),d.coerceSelectionMarkerOpacity(b,h)):b.visible=!1}},{"../../components/colorscale/defaults":604,"../../lib":719,"./attributes":924}],927:[function(a,b,c){"use strict";b.exports=function(a,b,c,d,e){a.location=b.location,a.z=b.z;var f=d[e];return f.fIn&&(a.properties=f.fIn.properties),a}},{}],928:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("./attributes"),f=a("../../lib").fillText;b.exports=function(a,b,c){var g,h,i,j,k=a.cd,l=k[0].trace,m=a.subplot;for(h=0;h<k.length;h++)if(j=!1,(g=k[h])._polygons){for(i=0;i<g._polygons.length;i++)g._polygons[i].contains([b,c])&&(j=!j),g._polygons[i].contains([b+360,c])&&(j=!j);if(j)break}if(j&&g)return a.x0=a.x1=a.xa.c2p(g.ct),a.y0=a.y1=a.ya.c2p(g.ct),a.index=g.index,a.location=g.loc,a.z=g.z,a.zLabel=d.tickText(m.mockAxis,m.mockAxis.c2l(g.z),"hover").text,a.hovertemplate=g.hovertemplate,function(a,b,c){if(!b.hovertemplate){var d=c.hi||b.hoverinfo,g=String(c.loc),h="all"===d?e.hoverinfo.flags:d.split("+"),i=-1!==h.indexOf("name"),j=-1!==h.indexOf("location"),k=-1!==h.indexOf("z"),l=-1!==h.indexOf("text"),m=[];!i&&j?a.nameOverride=g:(i&&(a.nameOverride=b.name),j&&m.push(g)),k&&m.push(a.zLabel),l&&f(c,b,m),a.extraText=m.join("<br>")}}(a,l,g,m.mockAxis),[a]}},{"../../lib":719,"../../plots/cartesian/axes":767,"./attributes":924}],929:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../heatmap/colorbar"),calc:a("./calc"),plot:a("./plot").plot,style:a("./style").style,styleOnSelect:a("./style").styleOnSelect,hoverPoints:a("./hover"),eventData:a("./event_data"),selectPoints:a("./select"),moduleType:"trace",name:"choropleth",basePlotModule:a("../../plots/geo"),categories:["geo","noOpacity"],meta:{}}},{"../../plots/geo":797,"../heatmap/colorbar":1003,"./attributes":924,"./calc":925,"./defaults":926,"./event_data":927,"./hover":928,"./plot":930,"./select":931,"./style":932}],930:[function(a,b,c){"use strict";function d(a,b){for(var c=a[0].trace,d=a.length,f=i(c,b),g=0;g<d;g++){var h=a[g],k=j(c.locationmode,h.loc,f);k?(h.geojson=k,h.ct=k.properties.ct,h._polygons=e(k)):h.geojson=null}}function e(a){function b(a){for(var b=0;b<a.length-1;b++)if(a[b][0]>0&&a[b+1][0]<0)return b;return null}var c,d,e,f,g=a.geometry,i=g.coordinates,j=a.id,k=[];switch(c="RUS"===j||"FJI"===j?function(a){var c;if(null===b(a))c=a;else for(c=new Array(a.length),f=0;f<a.length;f++)c[f]=[a[f][0]<0?a[f][0]+360:a[f][0],a[f][1]];k.push(h.tester(c))}:"ATA"===j?function(a){var c=b(a);if(null===c)return k.push(h.tester(a));var d=new Array(a.length+1),e=0;for(f=0;f<a.length;f++)f>c?d[e++]=[a[f][0]+360,a[f][1]]:f===c?(d[e++]=a[f],d[e++]=[a[f][0],-90]):d[e++]=a[f];var g=h.tester(d);g.pts.pop(),k.push(g)}:function(a){k.push(h.tester(a))},g.type){case"MultiPolygon":for(d=0;d<i.length;d++)for(e=0;e<i[d].length;e++)c(i[d][e]);break;case"Polygon":for(d=0;d<i.length;d++)c(i[d])}return k}var f=a("d3"),g=a("../../lib"),h=a("../../lib/polygon"),i=a("../../lib/topojson_utils").getTopojsonFeatures,j=a("../../lib/geo_location_utils").locationToFeature,k=a("./style").style;b.exports={plot:function(a,b,c){for(var e=0;e<c.length;e++)d(c[e],b.topojson);var h=b.layers.backplot.select(".choroplethlayer");g.makeTraceGroups(h,c,"trace choropleth").each(function(b){var c=f.select(this).selectAll("path.choroplethlocation").data(g.identity);c.enter().append("path").classed("choroplethlocation",!0),c.exit().remove(),k(a,b)})},feature2polygons:e}},{"../../lib":719,"../../lib/geo_location_utils":713,"../../lib/polygon":731,"../../lib/topojson_utils":746,"./style":932,d3:164}],931:[function(a,b,c){"use strict";b.exports=function(a,b){var c,d,e,f,g,h=a.cd,i=a.xaxis,j=a.yaxis,k=[];if(!1===b)for(c=0;c<h.length;c++)h[c].selected=0;else for(c=0;c<h.length;c++)(e=(d=h[c]).ct)&&(f=i.c2p(e),g=j.c2p(e),b.contains([f,g],null,c,a)?(k.push({pointNumber:c,lon:e[0],lat:e[1]}),d.selected=1):d.selected=0);return k}},{}],932:[function(a,b,c){"use strict";function d(a,b){var c=b[0].trace,d=b[0].node3.selectAll(".choroplethlocation"),i=c.marker||{},j=i.line||{},k=h.makeColorScaleFuncFromTrace(c);d.each(function(a){e.select(this).attr("fill",k(a.z)).call(f.stroke,a.mlc||j.color).call(g.dashLine,"",a.mlw||j.width||0).style("opacity",i.opacity)}),g.selectedPointStyle(d,c,a)}var e=a("d3"),f=a("../../components/color"),g=a("../../components/drawing"),h=a("../../components/colorscale");b.exports={style:function(a,b){b&&d(a,b)},styleOnSelect:function(a,b){var c=b[0].node3,e=b[0].trace;e.selectedpoints?g.selectedPointStyle(c.selectAll(".choroplethlocation"),e,a):d(a,b)}}},{"../../components/color":594,"../../components/colorscale":606,"../../components/drawing":615,d3:164}],933:[function(a,b,c){"use strict";var d=a("../choropleth/attributes"),e=a("../../components/colorscale/attributes"),f=a("../../plots/template_attributes").hovertemplateAttrs,g=a("../../lib/extend").extendFlat;b.exports=g({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},below:{valType:"string",editType:"plot"},text:d.text,hovertext:d.hovertext,marker:{line:{color:g({},d.marker.line.color,{editType:"plot"}),width:g({},d.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:g({},d.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:g({},d.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:g({},d.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:d.hoverinfo,hovertemplate:f({},{keys:["properties"]})},e("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/template_attributes":843,"../choropleth/attributes":924}],934:[function(a,b,c){"use strict";function d(a){var b,c=a[0].trace,d=c._opts;if(c.selectedpoints){for(var e=j.makeSelectedPointStyleFns(c),f=0;f<a.length;f++){var g=a[f];g.fOut&&(g.fOut.properties.mo2=e.selectedOpacityFn(g))}b={type:"identity",property:"mo2"}}else b=h.isArrayOrTypedArray(c.marker.opacity)?{type:"identity",property:"mo"}:c.marker.opacity;return h.extendFlat(d.fill.paint,{"fill-opacity":b}),h.extendFlat(d.line.paint,{"line-opacity":b}),d}var e=a("fast-isnumeric"),f=a("@turf/area"),g=a("@turf/centroid"),h=a("../../lib"),i=a("../../components/colorscale"),j=a("../../components/drawing"),k=a("../../lib/geojson_utils").makeBlank,l=a("../choropleth/plot").feature2polygons;b.exports={convert:function(a){function b(a){var b=r[a.id];if(b){var c=a.geometry;if("Polygon"===c.type||"MultiPolygon"===c.type){var d={fc:x(b.z)};u&&(d.mo=u(b)),v&&(d.mlc=v(b)),w&&(d.mlw=w(b));var e={type:"Feature",geometry:c,properties:d};b._polygons=l(e),b.ct=function(a){var b,c=a.geometry;if("MultiPolygon"===c.type)for(var d=c.coordinates,e=0,h=0;h<d.length;h++){var i={type:"Polygon",coordinates:d[h]},j=f.default(i);j>e&&(e=j,b=i)}else b=c;return g.default(b).geometry.coordinates}(e),b.fIn=a,b.fOut=e,s.push(e)}else h.log(["Location with id",b.loc,"does not have a valid GeoJSON geometry,","choroplethmapbox traces only support *Polygon* and *MultiPolygon* geometries."].join(" "))}delete r[a.id]}var c=a[0].trace,j=!0===c.visible&&0!==c._length,m={layout:{visibility:"none"},paint:{}},n={layout:{visibility:"none"},paint:{}},o=c._opts={fill:m,line:n,geojson:k()};if(!j)return o;var p="string"==typeof c.geojson?(window.PlotlyGeoAssets||{})[c.geojson]:c.geojson;if(!h.isPlainObject(p))return h.error("Oops ... something when wrong when fetching "+c.geojson),o;var q,r={},s=[];for(q=0;q<a.length;q++){var t=a[q];t.loc&&(r[t.loc]=t)}var u,v,w,x=i.makeColorScaleFuncFromTrace(c),y=c.marker,z=y.line||{};switch(h.isArrayOrTypedArray(y.opacity)&&(u=function(a){var b=a.mo;return e(b)?+h.constrain(b,0,1):0}),h.isArrayOrTypedArray(z.color)&&(v=function(a){return a.mlc}),h.isArrayOrTypedArray(z.width)&&(w=function(a){return a.mlw}),p.type){case"FeatureCollection":var A=p.features;for(q=0;q<A.length;q++)b(A[q]);break;case"Feature":b(p);break;default:return h.warn(["Invalid GeoJSON type",(p.type||"none")+",","choroplethmapbox traces only support *FeatureCollection* and *Feature* types."].join(" ")),o}for(var B in r)h.log("Location with id "+B+" does not have a matching feature");var C=u?{type:"identity",property:"mo"}:y.opacity;return h.extendFlat(m.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":C}),h.extendFlat(n.paint,{"line-color":v?{type:"identity",property:"mlc"}:z.color,"line-width":w?{type:"identity",property:"mlw"}:z.width,"line-opacity":C}),m.layout.visibility="visible",n.layout.visibility="visible",o.geojson={type:"FeatureCollection",features:s},d(a),o},convertOnSelect:d}},{"../../components/colorscale":606,"../../components/drawing":615,"../../lib":719,"../../lib/geojson_utils":714,"../choropleth/plot":930,"@turf/area":56,"@turf/centroid":57,"fast-isnumeric":226}],935:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/defaults"),f=a("./attributes");b.exports=function(a,b,c,g){function h(c,e){return d.coerce(a,b,f,c,e)}var i=h("locations"),j=h("z"),k=h("geojson");d.isArrayOrTypedArray(i)&&i.length&&d.isArrayOrTypedArray(j)&&j.length&&("string"==typeof k&&""!==k||d.isPlainObject(k))?(b._length=Math.min(i.length,j.length),h("below"),h("text"),h("hovertext"),h("hovertemplate"),h("marker.line.width")&&h("marker.line.color"),h("marker.opacity"),e(a,b,g,h,{prefix:"",cLetter:"z"}),d.coerceSelectionMarkerOpacity(b,h)):b.visible=!1}},{"../../components/colorscale/defaults":604,"../../lib":719,"./attributes":933}],936:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../heatmap/colorbar"),calc:a("../choropleth/calc"),plot:a("./plot"),hoverPoints:a("../choropleth/hover"),eventData:a("../choropleth/event_data"),selectPoints:a("../choropleth/select"),styleOnSelect:function(a,b){b&&b[0].trace._glTrace.updateOnSelect(b)},getBelow:function(a,b){for(var c=b.getMapLayers(),d=c.length-2;d>=0;d--){var e=c[d].id;if("string"==typeof e&&0===e.indexOf("water"))for(var f=d+1;f<c.length;f++)if("string"==typeof(e=c[f].id)&&-1===e.indexOf("plotly-"))return e}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:a("../../plots/mapbox"),categories:["mapbox","gl","noOpacity"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":822,"../choropleth/calc":925,"../choropleth/event_data":927,"../choropleth/hover":928,"../choropleth/select":931,"../heatmap/colorbar":1003,"./attributes":933,"./defaults":935,"./plot":937}],937:[function(a,b,c){"use strict";function d(a,b){this.subplot=a,this.uid=b,this.sourceId="source-"+b,this.layerList=[["fill",g+b+"-fill"],["line",g+b+"-line"]],this.below=null}var e=a("./convert").convert,f=a("./convert").convertOnSelect,g=a("../../plots/mapbox/constants").traceLayerPrefix,h=d.prototype;h.update=function(a){this._update(e(a))},h.updateOnSelect=function(a){this._update(f(a))},h._update=function(a){var b=this.subplot,c=this.layerList,d=b.belowLookup["trace-"+this.uid];b.map.getSource(this.sourceId).setData(a.geojson),d!==this.below&&(this._removeLayers(),this._addLayers(a,d),this.below=d);for(var e=0;e<c.length;e++){var f=c[e],g=f[0],h=f[1],i=a[g];b.setOptions(h,"setLayoutProperty",i.layout),"visible"===i.layout.visibility&&b.setOptions(h,"setPaintProperty",i.paint)}},h._addLayers=function(a,b){for(var c=this.subplot,d=this.layerList,e=this.sourceId,f=0;f<d.length;f++){var g=d[f],h=g[0],i=a[h];c.addLayer({type:h,id:g[1],source:e,layout:i.layout,paint:i.paint},b)}},h._removeLayers=function(){for(var a=this.subplot.map,b=this.layerList,c=b.length-1;c>=0;c--)a.removeLayer(b[c][1])},h.dispose=function(){var a=this.subplot.map;this._removeLayers(),a.removeSource(this.sourceId)},b.exports=function(a,b){var c=b[0].trace,f=new d(a,c.uid),g=f.sourceId,h=e(b),i=f.below=a.belowLookup["trace-"+c.uid];return a.map.addSource(g,{type:"geojson",data:h.geojson}),f._addLayers(h,i),b[0].trace._glTrace=f,f}},{"../../plots/mapbox/constants":820,"./convert":934}],938:[function(a,b,c){"use strict";var d=a("../../components/colorscale/attributes"),e=a("../../plots/template_attributes").hovertemplateAttrs,f=a("../mesh3d/attributes"),g=a("../../plots/attributes"),h=a("../../lib/extend").extendFlat,i={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:e({editType:"calc"},{keys:["norm"]})};h(i,d("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){i[a]=f[a]}),i.hoverinfo=h({},g.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),i.transforms=void 0,b.exports=i},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/template_attributes":843,"../mesh3d/attributes":1052}],939:[function(a,b,c){"use strict";var d=a("../../components/colorscale/calc");b.exports=function(a,b){for(var c=b.u,e=b.v,f=b.w,g=Math.min(b.x.length,b.y.length,b.z.length,c.length,e.length,f.length),h=-1/0,i=1/0,j=0;j<g;j++){var k=c[j],l=e[j],m=f[j],n=Math.sqrt(k*k+l*l+m*m);h=Math.max(h,n),i=Math.min(i,n)}b._len=g,b._normMax=h,d(a,b,{vals:[i,h],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":602}],940:[function(a,b,c){"use strict";function d(a,b){this.scene=a,this.uid=b,this.mesh=null,this.data=null}function e(a,b){function c(a,b){var c=d[b],f=e[m[b]];return h(a,function(a){return c.d2l(a)*f})}var d=a.fullSceneLayout,e=a.dataScale,g={};g.vectors=k(c(b.u,"xaxis"),c(b.v,"yaxis"),c(b.w,"zaxis"),b._len),g.positions=k(c(b.x,"xaxis"),c(b.y,"yaxis"),c(b.z,"zaxis"),b._len);var l=j(b);g.colormap=i(b),g.vertexIntensityBounds=[l.min/b._normMax,l.max/b._normMax],g.coneOffset=n[b.anchor],"scaled"===b.sizemode?g.coneSize=b.sizeref||.5:g.coneSize=b.sizeref&&b._normMax?b.sizeref/b._normMax:.5;var p=f(g),q=b.lightposition;return p.lightPosition=[q.x,q.y,q.z],p.ambient=b.lighting.ambient,p.diffuse=b.lighting.diffuse,p.specular=b.lighting.specular,p.roughness=b.lighting.roughness,p.fresnel=b.lighting.fresnel,p.opacity=b.opacity,b._pad=o[b.anchor]*p.vectorScale*p.coneScale*b._normMax,p}var f=a("gl-cone3d"),g=a("gl-cone3d").createConeMesh,h=a("../../lib").simpleMap,i=a("../../lib/gl_format_color").parseColorScale,j=a("../../components/colorscale").extractOpts,k=a("../../plots/gl3d/zip3"),l=d.prototype;l.handlePick=function(a){if(a.object===this.mesh){var b=a.index=a.data.index,c=this.data.x[b],d=this.data.y[b],e=this.data.z[b],f=this.data.u[b],g=this.data.v[b],h=this.data.w[b];a.traceCoordinate=[c,d,e,f,g,h,Math.sqrt(f*f+g*g+h*h)];var i=this.data.hovertext||this.data.text;return Array.isArray(i)&&void 0!==i[b]?a.textLabel=i[b]:i&&(a.textLabel=i),!0}};var m={xaxis:0,yaxis:1,zaxis:2},n={tip:1,tail:0,cm:.25,center:.5},o={tip:1,tail:1,cm:.75,center:.5};l.update=function(a){this.data=a;var b=e(this.scene,a);this.mesh.update(b)},l.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},b.exports=function(a,b){var c=a.glplot.gl,f=e(a,b),h=g(c,f),i=new d(a,b.uid);return i.mesh=h,i.data=b,h._trace=i,a.glplot.add(h),i}},{"../../components/colorscale":606,"../../lib":719,"../../lib/gl_format_color":716,"../../plots/gl3d/zip3":818,"gl-cone3d":243}],941:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/defaults"),f=a("./attributes");b.exports=function(a,b,c,g){function h(c,e){return d.coerce(a,b,f,c,e)}var i=h("u"),j=h("v"),k=h("w"),l=h("x"),m=h("y"),n=h("z");i&&i.length&&j&&j.length&&k&&k.length&&l&&l.length&&m&&m.length&&n&&n.length?(h("sizeref"),h("sizemode"),h("anchor"),h("lighting.ambient"),h("lighting.diffuse"),h("lighting.specular"),h("lighting.roughness"),h("lighting.fresnel"),h("lightposition.x"),h("lightposition.y"),h("lightposition.z"),e(a,b,g,h,{prefix:"",cLetter:"c"}),h("text"),h("hovertext"),h("hovertemplate"),b._length=null):b.visible=!1}},{"../../components/colorscale/defaults":604,"../../lib":719,"./attributes":938}],942:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"cone",basePlotModule:a("../../plots/gl3d"),categories:["gl3d"],attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:a("./calc"),plot:a("./convert"),eventData:function(a,b){return a.norm=b.traceCoordinate[6],a},meta:{}}},{"../../plots/gl3d":807,"./attributes":938,"./calc":939,"./convert":940,"./defaults":941}],943:[function(a,b,c){"use strict";var d=a("../heatmap/attributes"),e=a("../scatter/attributes"),f=a("../../components/colorscale/attributes"),g=a("../../components/drawing/attributes").dash,h=a("../../plots/font_attributes"),i=a("../../lib/extend").extendFlat,j=a("../../constants/filter_ops"),k=j.COMPARISON_OPS2,l=j.INTERVAL_OPS,m=(a("../../constants/docs").FORMAT_LINK,e.line);b.exports=i({z:d.z,x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,text:d.text,hovertext:d.hovertext,transpose:d.transpose,xtype:d.xtype,ytype:d.ytype,zhoverformat:d.zhoverformat,hovertemplate:d.hovertemplate,connectgaps:d.connectgaps,fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:h({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot"},operation:{valType:"enumerated",values:[].concat(k).concat(l),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:i({},m.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:g,smoothing:i({},m.smoothing,{}),editType:"plot"}},f("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":601,"../../components/drawing/attributes":614,"../../constants/docs":690,"../../constants/filter_ops":691,"../../lib/extend":710,"../../plots/font_attributes":793,"../heatmap/attributes":1e3,"../scatter/attributes":1111}],944:[function(a,b,c){"use strict";var d=a("../../components/colorscale"),e=a("../heatmap/calc"),f=a("./set_contours"),g=a("./end_plus");b.exports=function(a,b){var c=e(a,b),h=c[0].z;f(b,h);var i,j=b.contours,k=d.extractOpts(b);if("heatmap"===j.coloring&&k.auto&&!1===b.autocontour){var l=j.start,m=g(j),n=j.size||1,o=Math.floor((m-l)/n)+1;isFinite(n)||(n=1,o=1);var p=l-n/2;i=[p,p+o*n]}else i=h;return d.calc(a,b,{vals:i,cLetter:"z"}),c}},{"../../components/colorscale":606,"../heatmap/calc":1001,"./end_plus":954,"./set_contours":962}],945:[function(a,b,c){"use strict";b.exports=function(a,b){var c,d=a[0],e=d.z;switch(b.type){case"levels":var f=Math.min(e[0][0],e[0][1]);for(c=0;c<a.length;c++){var g=a[c];g.prefixBoundary=!g.edgepaths.length&&(f>g.level||g.starts.length&&f===g.level)}break;case"constraint":if(d.prefixBoundary=!1,d.edgepaths.length)return;var h=d.x.length,i=d.y.length,j=-1/0,k=1/0;for(c=0;c<i;c++)k=Math.min(k,e[c][0]),k=Math.min(k,e[c][h-1]),j=Math.max(j,e[c][0]),j=Math.max(j,e[c][h-1]);for(c=1;c<h-1;c++)k=Math.min(k,e[0][c]),k=Math.min(k,e[i-1][c]),j=Math.max(j,e[0][c]),j=Math.max(j,e[i-1][c]);var l,m,n=b.value;switch(b._operation){case">":n>j&&(d.prefixBoundary=!0);break;case"<":(n<k||d.starts.length&&n===k)&&(d.prefixBoundary=!0);break;case"[]":l=Math.min(n[0],n[1]),((m=Math.max(n[0],n[1]))<k||l>j||d.starts.length&&m===k)&&(d.prefixBoundary=!0);break;case"][":l=Math.min(n[0],n[1]),m=Math.max(n[0],n[1]),l<k&&m>j&&(d.prefixBoundary=!0)}}}},{}],946:[function(a,b,c){"use strict";var d=a("../../components/colorscale").extractOpts,e=a("./make_color_map"),f=a("./end_plus");b.exports={min:"zmin",max:"zmax",calc:function(a,b,c){var g=b.contours,h=b.line,i=g.size||1,j=g.coloring,k=e(b,{isColorbar:!0});if("heatmap"===j){var l=d(b);c._fillgradient=b.colorscale,c._zrange=[l.min,l.max]}else"fill"===j&&(c._fillcolor=k);c._line={color:"lines"===j?k:h.color,width:!1!==g.showlines?h.width:0,dash:h.dash},c._levels={start:g.start,end:f(g),size:i}}}},{"../../components/colorscale":606,"./end_plus":954,"./make_color_map":959}],947:[function(a,b,c){"use strict";b.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],948:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("./label_defaults"),f=a("../../components/color"),g=f.addOpacity,h=f.opacity,i=a("../../constants/filter_ops"),j=i.CONSTRAINT_REDUCTION,k=i.COMPARISON_OPS2;b.exports=function(a,b,c,f,i,l){var m,n,o,p=b.contours,q=c("contours.operation");p._operation=j[q],function(a,b){var c;-1===k.indexOf(b.operation)?(a("contours.value",[0,1]),Array.isArray(b.value)?b.value.length>2?b.value=b.value.slice(2):0===b.length?b.value=[0,1]:b.length<2?(c=parseFloat(b.value[0]),b.value=[c,c+1]):b.value=[parseFloat(b.value[0]),parseFloat(b.value[1])]:d(b.value)&&(c=parseFloat(b.value),b.value=[c,c+1])):(a("contours.value",0),d(b.value)||(Array.isArray(b.value)?b.value=parseFloat(b.value[0]):b.value=0))}(c,p),"="===q?m=p.showlines=!0:(m=c("contours.showlines"),o=c("fillcolor",g((a.line||{}).color||i,.5))),m&&(n=c("line.color",o&&h(o)?g(b.fillcolor,1):i),c("line.width",2),c("line.dash")),c("line.smoothing"),e(c,f,n,l)}},{"../../components/color":594,"../../constants/filter_ops":691,"./label_defaults":958,"fast-isnumeric":226}],949:[function(a,b,c){"use strict";function d(a,b){function c(a){return h(a)?+a:null}var d,e=Array.isArray(b);return-1!==g.COMPARISON_OPS2.indexOf(a)?d=c(e?b[0]:b):-1!==g.INTERVAL_OPS.indexOf(a)?d=e?[c(b[0]),c(b[1])]:[c(b),c(b)]:-1!==g.SET_OPS.indexOf(a)&&(d=e?b.map(c):[c(b)]),d}function e(a){return function(b){b=d(a,b);var c=Math.min(b[0],b[1]),e=Math.max(b[0],b[1]);return{start:c,end:e,size:e-c}}}function f(a){return function(b){return{start:b=d(a,b),end:1/0,size:1/0}}}var g=a("../../constants/filter_ops"),h=a("fast-isnumeric");b.exports={"[]":e("[]"),"][":e("]["),">":f(">"),"<":f("<"),"=":f("=")}},{"../../constants/filter_ops":691,"fast-isnumeric":226}],950:[function(a,b,c){"use strict";b.exports=function(a,b,c,d){var e=d("contours.start"),f=d("contours.end"),g=!1===e||!1===f,h=c("contours.size");!(g?b.autocontour=!0:c("autocontour",!1))&&h||c("ncontours")}},{}],951:[function(a,b,c){"use strict";function d(a){return e.extendFlat({},a,{edgepaths:e.extendDeep([],a.edgepaths),paths:e.extendDeep([],a.paths),starts:e.extendDeep([],a.starts)})}var e=a("../../lib");b.exports=function(a,b){var c,f,g,h=function(a){return a.reverse()},i=function(a){return a};switch(b){case"=":case"<":return a;case">":for(1!==a.length&&e.warn("Contour data invalid for the specified inequality operation."),f=a[0],c=0;c<f.edgepaths.length;c++)f.edgepaths[c]=h(f.edgepaths[c]);for(c=0;c<f.paths.length;c++)f.paths[c]=h(f.paths[c]);for(c=0;c<f.starts.length;c++)f.starts[c]=h(f.starts[c]);return a;case"][":var j=h;h=i,i=j;case"[]":for(2!==a.length&&e.warn("Contour data invalid for the specified inequality range operation."),f=d(a[0]),g=d(a[1]),c=0;c<f.edgepaths.length;c++)f.edgepaths[c]=h(f.edgepaths[c]);for(c=0;c<f.paths.length;c++)f.paths[c]=h(f.paths[c]);for(c=0;c<f.starts.length;c++)f.starts[c]=h(f.starts[c]);for(;g.edgepaths.length;)f.edgepaths.push(i(g.edgepaths.shift()));for(;g.paths.length;)f.paths.push(i(g.paths.shift()));for(;g.starts.length;)f.starts.push(i(g.starts.shift()));return[f]}}},{"../../lib":719}],952:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../heatmap/xyz_defaults"),f=a("./constraint_defaults"),g=a("./contours_defaults"),h=a("./style_defaults"),i=a("./attributes");b.exports=function(a,b,c,j){function k(c,e){return d.coerce(a,b,i,c,e)}if(e(a,b,k,j)){k("text"),k("hovertext"),k("hovertemplate");var l="constraint"===k("contours.type");k("connectgaps",d.isArray1D(b.z)),l?f(a,b,k,j,c):(g(a,b,k,function(c){return d.coerce2(a,b,i,c)}),h(a,b,k,j))}else b.visible=!1}},{"../../lib":719,"../heatmap/xyz_defaults":1014,"./attributes":943,"./constraint_defaults":948,"./contours_defaults":950,"./style_defaults":964}],953:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./constraint_mapping"),f=a("./end_plus");b.exports=function(a,b,c){for(var g="constraint"===a.type?e[a._operation](a.value):a,h=g.size,i=[],j=f(g),k=c.trace._carpetTrace,l=k?{xaxis:k.aaxis,yaxis:k.baxis,x:c.a,y:c.b}:{xaxis:b.xaxis,yaxis:b.yaxis,x:c.x,y:c.y},m=g.start;m<j;m+=h)if(i.push(d.extendFlat({level:m,crossings:{},starts:[],edgepaths:[],paths:[],z:c.z,smoothing:c.trace.line.smoothing},l)),i.length>1e3){d.warn("Too many contours, clipping at 1000",a);break}return i}},{"../../lib":719,"./constraint_mapping":949,"./end_plus":954}],954:[function(a,b,c){"use strict";b.exports=function(a){return a.end+a.size/1e6}},{}],955:[function(a,b,c){"use strict";function d(a,b,c,d){return Math.abs(a[0]-b[0])<c&&Math.abs(a[1]-b[1])<d}function e(a,b,c,e,i){
function j(a){return o[a%o.length]}var k,l=b.join(","),m=a.crossings[l],n=function(a,b,c){var d=0,e=0;return a>20&&b?208===a||1114===a?d=0===c[0]?1:-1:e=0===c[1]?1:-1:-1!==h.BOTTOMSTART.indexOf(a)?e=1:-1!==h.LEFTSTART.indexOf(a)?d=1:-1!==h.TOPSTART.indexOf(a)?e=-1:d=-1,[d,e]}(m,c,b),o=[f(a,b,[-n[0],-n[1]])],p=a.z.length,q=a.z[0].length,r=b.slice(),s=n.slice();for(k=0;k<1e4;k++){if(m>20?(m=h.CHOOSESADDLE[m][(n[0]||n[1])<0?0:1],a.crossings[l]=h.SADDLEREMAINDER[m]):delete a.crossings[l],!(n=h.NEWDELTA[m])){g.log("Found bad marching index:",m,b,a.level);break}o.push(f(a,b,n)),b[0]+=n[0],b[1]+=n[1],l=b.join(","),d(o[o.length-1],o[o.length-2],e,i)&&o.pop();var t=n[0]&&(b[0]<0||b[0]>q-2)||n[1]&&(b[1]<0||b[1]>p-2);if(b[0]===r[0]&&b[1]===r[1]&&n[0]===s[0]&&n[1]===s[1]||c&&t)break;m=a.crossings[l]}1e4===k&&g.log("Infinite loop in contour?");var u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=d(o[0],o[o.length-1],e,i),K=0,L=.2*a.smoothing,M=[],N=0;for(k=1;k<o.length;k++)F=o[k],G=o[k-1],H=F[2]-G[2],I=F[3]-G[3],K+=A=Math.sqrt(H*H+I*I),M.push(A);var O=K/M.length*L;for(k=o.length-2;k>=N;k--)if((u=M[k])<O){for(w=0,v=k-1;v>=N&&u+M[v]<O;v--)u+=M[v];if(J&&k===o.length-2)for(w=0;w<v&&u+M[w]<O;w++)u+=M[w];y=k-v+w+1,z=Math.floor((k+v+w+2)/2),x=J||k!==o.length-2?J||-1!==v?y%2?j(z):[(j(z)[0]+j(z+1)[0])/2,(j(z)[1]+j(z+1)[1])/2]:o[0]:o[o.length-1],o.splice(v+1,k-v+1,x),k=v+1,w&&(N=w),J&&(k===o.length-2?o[w]=o[o.length-1]:0===k&&(o[o.length-1]=o[0]))}for(o.splice(0,N),k=0;k<o.length;k++)o[k].length=2;if(!(o.length<2))if(J)o.pop(),a.paths.push(o);else{c||g.log("Unclosed interior contour?",a.level,r.join(","),o.join("L"));var P=!1;for(B=0;B<a.edgepaths.length;B++)if(D=a.edgepaths[B],!P&&d(D[0],o[o.length-1],e,i)){o.pop(),P=!0;var Q=!1;for(C=0;C<a.edgepaths.length;C++)if(d((E=a.edgepaths[C])[E.length-1],o[0],e,i)){Q=!0,o.shift(),a.edgepaths.splice(B,1),C===B?a.paths.push(o.concat(E)):(C>B&&C--,a.edgepaths[C]=E.concat(o,D));break}Q||(a.edgepaths[B]=o.concat(D))}for(B=0;B<a.edgepaths.length&&!P;B++)d((D=a.edgepaths[B])[D.length-1],o[0],e,i)&&(o.shift(),a.edgepaths[B]=D.concat(o),P=!0);P||a.edgepaths.push(o)}}function f(a,b,c){var d=b[0]+Math.max(c[0],0),e=b[1]+Math.max(c[1],0),f=a.z[e][d],g=a.xaxis,h=a.yaxis;if(c[1]){var i=(a.level-f)/(a.z[e][d+1]-f);return[g.c2p((1-i)*a.x[d]+i*a.x[d+1],!0),h.c2p(a.y[e],!0),d+i,e]}var j=(a.level-f)/(a.z[e+1][d]-f);return[g.c2p(a.x[d],!0),h.c2p((1-j)*a.y[e]+j*a.y[e+1],!0),d,e+j]}var g=a("../../lib"),h=a("./constants");b.exports=function(a,b,c){var d,f,h,i;for(b=b||.01,c=c||.01,f=0;f<a.length;f++){for(h=a[f],i=0;i<h.starts.length;i++)e(h,h.starts[i],"edge",b,c);for(d=0;Object.keys(h.crossings).length&&d<1e4;)d++,e(h,Object.keys(h.crossings)[0].split(",").map(Number),void 0,b,c);1e4===d&&g.log("Infinite loop in contour?")}}},{"../../lib":719,"./constants":947}],956:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("../heatmap/hover");b.exports=function(a,b,c,f,g){var h=e(a,b,c,f,g,!0);return h&&h.forEach(function(a){var b=a.trace;"constraint"===b.contours.type&&(b.fillcolor&&d.opacity(b.fillcolor)?a.color=d.addOpacity(b.fillcolor,1):b.contours.showlines&&d.opacity(b.line.color)&&(a.color=d.addOpacity(b.line.color,1)))}),h}},{"../../components/color":594,"../heatmap/hover":1007}],957:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot").plot,style:a("./style"),colorbar:a("./colorbar"),hoverPoints:a("./hover"),moduleType:"trace",name:"contour",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":778,"./attributes":943,"./calc":944,"./colorbar":946,"./defaults":952,"./hover":956,"./plot":961,"./style":963}],958:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b,c,e){if(e||(e={}),a("contours.showlabels")){var f=b.font;d.coerceFont(a,"contours.labelfont",{family:f.family,size:f.size,color:c}),a("contours.labelformat")}!1!==e.hasHover&&a("zhoverformat")}},{"../../lib":719}],959:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../components/colorscale"),f=a("./end_plus");b.exports=function(a){var b=a.contours,c=b.start,g=f(b),h=b.size||1,i=Math.floor((g-c)/h)+1,j="lines"===b.coloring?0:1,k=e.extractOpts(a);isFinite(h)||(h=1,i=1);var l,m,n=k.reversescale?e.flipScale(k.colorscale):k.colorscale,o=n.length,p=new Array(o),q=new Array(o);if("heatmap"===b.coloring){var r=k.min,s=k.max;for(m=0;m<o;m++)l=n[m],p[m]=l[0]*(s-r)+r,q[m]=l[1];var t=d.extent([r,s,b.start,b.start+h*(i-1)]),u=t[r<s?0:1],v=t[r<s?1:0];u!==r&&(p.splice(0,0,u),q.splice(0,0,q[0])),v!==s&&(p.push(v),q.push(q[q.length-1]))}else for(m=0;m<o;m++)l=n[m],p[m]=(l[0]*(i+j-1)-j/2)*h+c,q[m]=l[1];return e.makeColorScaleFunc({domain:p,range:q},{noNumericCheck:!0})}},{"../../components/colorscale":606,"./end_plus":954,d3:164}],960:[function(a,b,c){"use strict";function d(a,b){var c=(b[0][0]>a?0:1)+(b[0][1]>a?0:2)+(b[1][1]>a?0:4)+(b[1][0]>a?0:8);return 5===c||10===c?a>(b[0][0]+b[0][1]+b[1][0]+b[1][1])/4?5===c?713:1114:5===c?104:208:15===c?0:c}var e=a("./constants");b.exports=function(a){var b,c,f,g,h,i,j,k,l,m=a[0].z,n=m.length,o=m[0].length,p=2===n||2===o;for(c=0;c<n-1;c++)for(g=[],0===c&&(g=g.concat(e.BOTTOMSTART)),c===n-2&&(g=g.concat(e.TOPSTART)),b=0;b<o-1;b++)for(f=g.slice(),0===b&&(f=f.concat(e.LEFTSTART)),b===o-2&&(f=f.concat(e.RIGHTSTART)),h=b+","+c,i=[[m[c][b],m[c][b+1]],[m[c+1][b],m[c+1][b+1]]],l=0;l<a.length;l++)(j=d((k=a[l]).level,i))&&(k.crossings[h]=j,-1!==f.indexOf(j)&&(k.starts.push([b,c]),p&&-1!==f.indexOf(j,f.indexOf(j)+1)&&k.starts.push([b,c])))}},{"./constants":947}],961:[function(a,b,c){"use strict";function d(a,b){function c(a){return Math.abs(a[0]-b[2][0])<.01}for(var d,e,f,i,j,k,l,m="",n=0,o=a.edgepaths.map(function(a,b){return b}),p=!0;o.length;){for(k=h.smoothopen(a.edgepaths[n],a.smoothing),m+=p?k:k.replace(/^M/,"L"),o.splice(o.indexOf(n),1),d=a.edgepaths[n][a.edgepaths[n].length-1],i=-1,f=0;f<4;f++){if(!d){g.log("Missing end?",n,a);break}for(l=d,Math.abs(l[1]-b[0][1])<.01&&!c(d)?e=b[1]:function(a){return Math.abs(a[0]-b[0][0])<.01}(d)?e=b[0]:function(a){return Math.abs(a[1]-b[2][1])<.01}(d)?e=b[3]:c(d)&&(e=b[2]),j=0;j<a.edgepaths.length;j++){var q=a.edgepaths[j][0];Math.abs(d[0]-e[0])<.01?Math.abs(d[0]-q[0])<.01&&(q[1]-d[1])*(e[1]-q[1])>=0&&(e=q,i=j):Math.abs(d[1]-e[1])<.01?Math.abs(d[1]-q[1])<.01&&(q[0]-d[0])*(e[0]-q[0])>=0&&(e=q,i=j):g.log("endpt to newendpt is not vert. or horz.",d,e,q)}if(d=e,i>=0)break;m+="L"+e}if(i===a.edgepaths.length){g.log("unclosed perimeter path");break}n=i,(p=-1===o.indexOf(n))&&(n=o[0],m+="Z")}for(n=0;n<a.paths.length;n++)m+=h.smoothclosed(a.paths[n],a.smoothing);return m}function e(a,b,c,d){var e=b.width/2,f=b.height/2,h=a.x,i=a.y,j=a.theta,k=Math.cos(j)*e,l=Math.sin(j)*e,m=(h>d.center?d.right-h:h-d.left)/(k+Math.abs(Math.sin(j)*f)),n=(i>d.middle?d.bottom-i:i-d.top)/(Math.abs(l)+Math.cos(j)*f);if(m<1||n<1)return 1/0;var o=t.EDGECOST*(1/(m-1)+1/(n-1));o+=t.ANGLECOST*j*j;for(var p=h-k,q=i-l,r=h+k,s=i+l,u=0;u<c.length;u++){var v=c[u],w=Math.cos(v.theta)*v.width/2,x=Math.sin(v.theta)*v.width/2,y=2*g.segmentDistance(p,q,r,s,v.x-w,v.y-x,v.x+w,v.y+x)/(b.height+v.height),z=v.level===b.level,A=z?t.SAMELEVELDISTANCE:1;if(y<=A)return 1/0;o+=t.NEIGHBORCOST*(z?t.SAMELEVELFACTOR:1)/(y-A)}return o}var f=a("d3"),g=a("../../lib"),h=a("../../components/drawing"),i=a("../../components/colorscale"),j=a("../../lib/svg_text_utils"),k=a("../../plots/cartesian/axes"),l=a("../../plots/cartesian/set_convert"),m=a("../heatmap/plot"),n=a("./make_crossings"),o=a("./find_all_paths"),p=a("./empty_pathinfo"),q=a("./convert_to_constraints"),r=a("./close_boundaries"),s=a("./constants"),t=s.LABELOPTIMIZER;c.plot=function(a,b,e,i){var j=b.xaxis,k=b.yaxis;g.makeTraceGroups(i,e,"contour").each(function(e){var i=f.select(this),l=e[0],t=l.trace,u=l.x,v=l.y,w=t.contours,x=p(w,b,l),y=g.ensureSingle(i,"g","heatmapcoloring"),z=[];"heatmap"===w.coloring&&(z=[e]),m(a,b,z,y),n(x),o(x);var A=j.c2p(u[0],!0),B=j.c2p(u[u.length-1],!0),C=k.c2p(v[0],!0),D=k.c2p(v[v.length-1],!0),E=[[A,D],[B,D],[B,C],[A,C]],F=x;"constraint"===w.type&&(F=q(x,w._operation)),function(a,b,c){var d=g.ensureSingle(a,"g","contourbg").selectAll("path").data("fill"===c.coloring?[0]:[]);d.enter().append("path"),d.exit().remove(),d.attr("d","M"+b.join("L")+"Z").style("stroke","none")}(i,E,w),function(a,b,c,e){var h="fill"===e.coloring||"constraint"===e.type&&"="!==e._operation,i="M"+c.join("L")+"Z";h&&r(b,e);var j=g.ensureSingle(a,"g","contourfill").selectAll("path").data(h?b:[]);j.enter().append("path"),j.exit().remove(),j.each(function(a){var b=(a.prefixBoundary?i:"")+d(a,c);b?f.select(this).attr("d",b).style("stroke","none"):f.select(this).remove()})}(i,F,E,w),function(a,b,d,e,i){var j=g.ensureSingle(a,"g","contourlines"),k=!1!==i.showlines,l=i.showlabels,m=k&&l,n=c.createLines(j,k||l,b),o=c.createLineClip(j,m,d,e.trace.uid),p=a.selectAll("g.contourlabels").data(l?[0]:[]);if(p.exit().remove(),p.enter().append("g").classed("contourlabels",!0),l){var q=[],r=[];g.clearLocationCache();var t=c.labelFormatter(d,e),u=h.tester.append("text").attr("data-notex",1).call(h.font,i.labelfont),v=b[0].xaxis,w=b[0].yaxis,x=v._length,y=w._length,z=v.range,A=w.range,B=g.aggNums(Math.min,null,e.x),C=g.aggNums(Math.max,null,e.x),D=g.aggNums(Math.min,null,e.y),E=g.aggNums(Math.max,null,e.y),F=Math.max(v.c2p(B,!0),0),G=Math.min(v.c2p(C,!0),x),H=Math.max(w.c2p(E,!0),0),I=Math.min(w.c2p(D,!0),y),J={};z[0]<z[1]?(J.left=F,J.right=G):(J.left=G,J.right=F),A[0]<A[1]?(J.top=H,J.bottom=I):(J.top=I,J.bottom=H),J.middle=(J.top+J.bottom)/2,J.center=(J.left+J.right)/2,q.push([[J.left,J.top],[J.right,J.top],[J.right,J.bottom],[J.left,J.bottom]]);var K=Math.sqrt(x*x+y*y),L=s.LABELDISTANCE*K/Math.max(1,b.length/s.LABELINCREASE);n.each(function(a){var b=c.calcTextOpts(a.level,t,u,d);f.select(this).selectAll("path").each(function(){var a=g.getVisibleSegment(this,J,b.height/2);if(a&&!(a.len<(b.width+b.height)*s.LABELMIN))for(var d=Math.min(Math.ceil(a.len/L),s.LABELMAX),e=0;e<d;e++){var f=c.findBestTextLocation(this,a,b,r,J);if(!f)break;c.addLabelData(f,b,r,q)}})}),u.remove(),c.drawLabels(p,r,d,o,m?q:null)}l&&!k&&n.remove()}(i,x,a,l,w),function(a,b,c,e,f){var i=e.trace,j=c._fullLayout._clips,k="clip"+i.uid,l=j.selectAll("#"+k).data(i.connectgaps?[]:[0]);if(l.enter().append("clipPath").classed("contourclip",!0).attr("id",k),l.exit().remove(),!1===i.connectgaps){var m={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:b.xaxis,yaxis:b.yaxis,x:e.x,y:e.y,z:function(a){var b,c,d=a.trace._emptypoints,e=[],f=a.z.length,g=a.z[0].length,h=[];for(b=0;b<g;b++)h.push(1);for(b=0;b<f;b++)e.push(h.slice());for(b=0;b<d.length;b++)c=d[b],e[c[0]][c[1]]=0;return a.zmask=e,e}(e),smoothing:0};n([m]),o([m]),r([m],{type:"levels"});g.ensureSingle(l,"path","").attr("d",(m.prefixBoundary?"M"+f.join("L")+"Z":"")+d(m,f))}else k=null;h.setClipUrl(a,k,c)}(i,b,a,l,E)})},c.createLines=function(a,b,c){var d=c[0].smoothing,e=a.selectAll("g.contourlevel").data(b?c:[]);if(e.exit().remove(),e.enter().append("g").classed("contourlevel",!0),b){var f=e.selectAll("path.openline").data(function(a){return a.pedgepaths||a.edgepaths});f.exit().remove(),f.enter().append("path").classed("openline",!0),f.attr("d",function(a){return h.smoothopen(a,d)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var g=e.selectAll("path.closedline").data(function(a){return a.ppaths||a.paths});g.exit().remove(),g.enter().append("path").classed("closedline",!0),g.attr("d",function(a){return h.smoothclosed(a,d)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return e},c.createLineClip=function(a,b,c,d){var e=b?"clipline"+d:null,f=c._fullLayout._clips.selectAll("#"+e).data(b?[0]:[]);return f.exit().remove(),f.enter().append("clipPath").classed("contourlineclip",!0).attr("id",e),h.setClipUrl(a,e,c),f},c.labelFormatter=function(a,b){var c=a._fullLayout,d=b.trace,e=d.contours;if(e.labelformat)return c._d3locale.numberFormat(e.labelformat);var f,g=i.extractOpts(d);if(g&&g.colorbar&&g.colorbar._axis)f=g.colorbar._axis;else{if(f={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"},"constraint"===e.type){var h=e.value;Array.isArray(h)?f.range=[h[0],h[h.length-1]]:f.range=[h,h]}else f.range=[e.start,e.end],f.nticks=(e.end-e.start)/e.size;f.range[0]===f.range[1]&&(f.range[1]+=f.range[0]||1),f.nticks||(f.nticks=1e3),l(f,c),k.prepTicks(f),f._tmin=null,f._tmax=null}return function(a){return k.tickText(f,a).text}},c.calcTextOpts=function(a,b,c,d){var e=b(a);c.text(e).call(j.convertToTspans,d);var f=h.bBox(c.node(),!0);return{text:e,width:f.width,height:f.height,level:a,dy:(f.top+f.bottom)/2}},c.findBestTextLocation=function(a,b,c,d,f){var h,i,j,k,l,m=c.width;b.isClosed?(i=b.len/t.INITIALSEARCHPOINTS,h=b.min+i/2,j=b.max):(i=(b.len-m)/(t.INITIALSEARCHPOINTS+1),h=b.min+i+m/2,j=b.max-(i+m)/2);for(var n=1/0,o=0;o<t.ITERATIONS;o++){for(var p=h;p<j;p+=i){var q=g.getTextLocation(a,b.total,p,m),r=e(q,c,d,f);r<n&&(n=r,l=q,k=p)}if(n>2*t.MAXCOST)break;o&&(i/=2),j=(h=k-i/2)+1.5*i}if(n<=t.MAXCOST)return l},c.addLabelData=function(a,b,c,d){var e=b.width/2,f=b.height/2,g=a.x,h=a.y,i=a.theta,j=Math.sin(i),k=Math.cos(i),l=e*k,m=f*j,n=e*j,o=-f*k,p=[[g-l-m,h-n-o],[g+l-m,h+n-o],[g+l+m,h+n+o],[g-l+m,h-n+o]];c.push({text:b.text,x:g,y:h,dy:b.dy,theta:i,level:b.level,width:b.width,height:b.height}),d.push(p)},c.drawLabels=function(a,b,c,d,e){var h=a.selectAll("text").data(b,function(a){return a.text+","+a.x+","+a.y+","+a.theta});if(h.exit().remove(),h.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(a){var b=a.x+Math.sin(a.theta)*a.dy,d=a.y-Math.cos(a.theta)*a.dy;f.select(this).text(a.text).attr({x:b,y:d,transform:"rotate("+180*a.theta/Math.PI+" "+b+" "+d+")"}).call(j.convertToTspans,c)}),e){for(var i="",k=0;k<e.length;k++)i+="M"+e[k].join("L")+"Z";g.ensureSingle(d,"path","").attr("d",i)}}},{"../../components/colorscale":606,"../../components/drawing":615,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"../../plots/cartesian/set_convert":785,"../heatmap/plot":1011,"./close_boundaries":945,"./constants":947,"./convert_to_constraints":951,"./empty_pathinfo":953,"./find_all_paths":955,"./make_crossings":960,d3:164}],962:[function(a,b,c){"use strict";function d(a,b,c){var d={type:"linear",range:[a,b]};return e.autoTicks(d,(b-a)/(c||15)),d}var e=a("../../plots/cartesian/axes"),f=a("../../lib");b.exports=function(a,b){var c=a.contours;if(a.autocontour){var g=a.zmin,h=a.zmax;(a.zauto||void 0===g)&&(g=f.aggNums(Math.min,null,b)),(a.zauto||void 0===h)&&(h=f.aggNums(Math.max,null,b));var i=d(g,h,a.ncontours);c.size=i.dtick,c.start=e.tickFirst(i),i.range.reverse(),c.end=e.tickFirst(i),c.start===g&&(c.start+=c.size),c.end===h&&(c.end-=c.size),c.start>c.end&&(c.start=c.end=(c.start+c.end)/2),a._input.contours||(a._input.contours={}),f.extendFlat(a._input.contours,{start:c.start,end:c.end,size:c.size}),a._input.autocontour=!0}else if("constraint"!==c.type){var j,k=c.start,l=c.end,m=a._input.contours;k>l&&(c.start=m.start=l,l=c.end=m.end=k,k=c.start),c.size>0||(j=k===l?1:d(k,l,a.ncontours).dtick,m.size=c.size=j)}}},{"../../lib":719,"../../plots/cartesian/axes":767}],963:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../components/drawing"),f=a("../heatmap/style"),g=a("./make_color_map");b.exports=function(a){var b=d.select(a).selectAll("g.contour");b.style("opacity",function(a){return a[0].trace.opacity}),b.each(function(a){var b=d.select(this),c=a[0].trace,f=c.contours,h=c.line,i=f.size||1,j=f.start,k="constraint"===f.type,l=!k&&"lines"===f.coloring,m=!k&&"fill"===f.coloring,n=l||m?g(c):null;b.selectAll("g.contourlevel").each(function(a){d.select(this).selectAll("path").call(e.lineGroupStyle,h.width,l?n(a.level):h.color,h.dash)});var o=f.labelfont;if(b.selectAll("g.contourlabels text").each(function(a){e.font(d.select(this),{family:o.family,size:o.size,color:o.color||(l?n(a.level):h.color)})}),k)b.selectAll("g.contourfill path").style("fill",c.fillcolor);else if(m){var p;b.selectAll("g.contourfill path").style("fill",function(a){return void 0===p&&(p=a.level),n(a.level+.5*i)}),void 0===p&&(p=j),b.selectAll("g.contourbg path").style("fill",n(p-.5*i))}}),f(a)}},{"../../components/drawing":615,"../heatmap/style":1012,"./make_color_map":959,d3:164}],964:[function(a,b,c){"use strict";var d=a("../../components/colorscale/defaults"),e=a("./label_defaults");b.exports=function(a,b,c,f,g){var h,i=c("contours.coloring"),j="";"fill"===i&&(h=c("contours.showlines")),!1!==h&&("lines"!==i&&(j=c("line.color","#000")),c("line.width",.5),c("line.dash")),"none"!==i&&(!0!==a.showlegend&&(b.showlegend=!1),b._dfltShowLegend=!1,d(a,b,f,c,{prefix:"",cLetter:"z"})),c("line.smoothing"),e(c,f,j,g)}},{"../../components/colorscale/defaults":604,"./label_defaults":958}],965:[function(a,b,c){"use strict";var d=a("../heatmap/attributes"),e=a("../contour/attributes"),f=a("../../components/colorscale/attributes"),g=a("../../lib/extend").extendFlat,h=e.contours;b.exports=g({carpet:{valType:"string",editType:"calc"},z:d.z,a:d.x,a0:d.x0,da:d.dx,b:d.y,b0:d.y0,db:d.dy,text:d.text,hovertext:d.hovertext,transpose:d.transpose,atype:d.xtype,btype:d.ytype,fillcolor:e.fillcolor,autocontour:e.autocontour,ncontours:e.ncontours,contours:{type:h.type,start:h.start,end:h.end,size:h.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:h.showlines,showlabels:h.showlabels,labelfont:h.labelfont,labelformat:h.labelformat,operation:h.operation,value:h.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:e.line.color,width:e.line.width,dash:e.line.dash,smoothing:e.line.smoothing,editType:"plot"},transforms:void 0},f("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../contour/attributes":943,"../heatmap/attributes":1e3}],966:[function(a,b,c){"use strict";var d=a("../../components/colorscale/calc"),e=a("../../lib"),f=a("../heatmap/convert_column_xyz"),g=a("../heatmap/clean_2d_array"),h=a("../heatmap/interp2d"),i=a("../heatmap/find_empties"),j=a("../heatmap/make_bound_array"),k=a("./defaults"),l=a("../carpet/lookup_carpetid"),m=a("../contour/set_contours");b.exports=function(a,b){var c=b._carpetTrace=l(a,b);if(c&&c.visible&&"legendonly"!==c.visible){if(!b.a||!b.b){var n=a.data[c.index],o=a.data[b.index];o.a||(o.a=n.a),o.b||(o.b=n.b),k(o,b,b._defaultColor,a._fullLayout)}var p=function(a,b){var c,k,l,m,n,o,p,q=b._carpetTrace,r=q.aaxis,s=q.baxis;r._minDtick=0,s._minDtick=0,e.isArray1D(b.z)&&f(b,r,s,"a","b",["z"]),c=b._a=b._a||b.a,m=b._b=b._b||b.b,c=c?r.makeCalcdata(b,"_a"):[],m=m?s.makeCalcdata(b,"_b"):[],k=b.a0||0,l=b.da||1,n=b.b0||0,o=b.db||1,p=b._z=g(b._z||b.z,b.transpose),b._emptypoints=i(p),h(p,b._emptypoints);var t=e.maxRowLength(p),u="scaled"===b.xtype?"":c,v=j(b,u,k,l,t,r),w="scaled"===b.ytype?"":m,x=j(b,w,n,o,p.length,s),y={a:v,b:x,z:p};return"levels"===b.contours.type&&"none"!==b.contours.coloring&&d(a,b,{vals:p,containerStr:"",cLetter:"z"}),[y]}(a,b);return m(b,b._z),p}}},{"../../components/colorscale/calc":602,"../../lib":719,"../carpet/lookup_carpetid":916,"../contour/set_contours":962,"../heatmap/clean_2d_array":1002,"../heatmap/convert_column_xyz":1004,"../heatmap/find_empties":1006,"../heatmap/interp2d":1009,"../heatmap/make_bound_array":1010,"./defaults":967}],967:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../heatmap/xyz_defaults"),f=a("./attributes"),g=a("../contour/constraint_defaults"),h=a("../contour/contours_defaults"),i=a("../contour/style_defaults");b.exports=function(a,b,c,j){function k(c,e){return d.coerce(a,b,f,c,e)}if(k("carpet"),a.a&&a.b){if(!e(a,b,k,j,"a","b"))return void(b.visible=!1);k("text"),"constraint"===k("contours.type")?g(a,b,k,j,c,{hasHover:!1}):(h(a,b,k,function(c){return d.coerce2(a,b,f,c)}),i(a,b,k,j,{hasHover:!1}))}else b._defaultColor=c,b._length=null}},{"../../lib":719,"../contour/constraint_defaults":948,"../contour/contours_defaults":950,"../contour/style_defaults":964,"../heatmap/xyz_defaults":1014,"./attributes":965}],968:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../contour/colorbar"),calc:a("./calc"),plot:a("./plot"),style:a("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover"],meta:{}}},{"../../plots/cartesian":778,"../contour/colorbar":946,"../contour/style":963,"./attributes":965,"./calc":966,"./defaults":967,"./plot":969}],969:[function(a,b,c){"use strict";function d(a,b,c){var d=a.getPointAtLength(b),e=a.getPointAtLength(c),f=e.x-d.x,g=e.y-d.y,h=Math.sqrt(f*f+g*g);return[f/h,g/h]}function e(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]);return[a[0]/b,a[1]/b]}function f(a,b){var c=Math.abs(a[0]*b[0]+a[1]*b[1]);return Math.sqrt(1-c*c)/c}var g=a("d3"),h=a("../carpet/map_1d_array"),i=a("../carpet/makepath"),j=a("../../components/drawing"),k=a("../../lib"),l=a("../contour/make_crossings"),m=a("../contour/find_all_paths"),n=a("../contour/plot"),o=a("../contour/constants"),p=a("../contour/convert_to_constraints"),q=a("../contour/empty_pathinfo"),r=a("../contour/close_boundaries"),s=a("../carpet/lookup_carpetid"),t=a("../carpet/axis_aligned_line");b.exports=function(a,b,c,u){var v=b.xaxis,w=b.yaxis;k.makeTraceGroups(u,c,"contour").each(function(c){function u(a){var b=A.ab2xy(a[0],a[1],!0);return[v.c2p(b[0]),w.c2p(b[1])]}var x=g.select(this),y=c[0],z=y.trace,A=z._carpetTrace=s(a,z),B=a.calcdata[A.index][0];if(A.visible&&"legendonly"!==A.visible){var C=y.a,D=y.b,E=z.contours,F=q(E,b,y),G="constraint"===E.type,H=E._operation,I=G?"="===H?"lines":"fill":E.coloring,J=[[C[0],D[D.length-1]],[C[C.length-1],D[D.length-1]],[C[C.length-1],D[0]],[C[0],D[0]]];l(F);var K=1e-8*(C[C.length-1]-C[0]),L=1e-8*(D[D.length-1]-D[0]);m(F,K,L);var M,N,O,P,Q=F;"constraint"===E.type&&(Q=p(F,H)),function(a,b){var c,d,e,f,g,h,i,j,k;for(c=0;c<a.length;c++){for(f=a[c],g=f.pedgepaths=[],h=f.ppaths=[],d=0;d<f.edgepaths.length;d++){for(k=f.edgepaths[d],i=[],e=0;e<k.length;e++)i[e]=b(k[e]);g.push(i)}for(d=0;d<f.paths.length;d++){for(k=f.paths[d],j=[],e=0;e<k.length;e++)j[e]=b(k[e]);h.push(j)}}}(F,u);var R=[];for(P=B.clipsegments.length-1;P>=0;P--)M=B.clipsegments[P],N=h([],M.x,v.c2p),O=h([],M.y,w.c2p),N.reverse(),O.reverse(),R.push(i(N,O,M.bicubic));var S="M"+R.join("L")+"Z";!function(a,b,c,d,e,f){var g,j,l,m,n=k.ensureSingle(a,"g","contourbg").selectAll("path").data("fill"!==f||e?[]:[0]);n.enter().append("path"),n.exit().remove();var o=[];for(m=0;m<b.length;m++)g=b[m],j=h([],g.x,c.c2p),l=h([],g.y,d.c2p),o.push(i(j,l,g.bicubic));n.attr("d","M"+o.join("L")+"Z").style("stroke","none")}(x,B.clipsegments,v,w,G,I),function(a,b,c,d,e,f,h,i,l,m,n){var o="fill"===m;o&&r(e,a.contours);var p=k.ensureSingle(b,"g","contourfill").selectAll("path").data(o?e:[]);p.enter().append("path"),p.exit().remove(),p.each(function(a){var b=(a.prefixBoundary?n:"")+function(a,b,c,d,e,f,g,h){function i(a){return Math.abs(a[1]-c[0][1])<B}function l(a){return Math.abs(a[1]-c[2][1])<B}function m(a){return Math.abs(a[0]-c[0][0])<A}function n(a){return Math.abs(a[0]-c[2][0])<A}function o(a,b){var c,d,j,k,o="";for(i(a)&&!n(a)||l(a)&&!m(a)?(k=e.aaxis,j=t(e,f,[a[0],b[0]],.5*(a[1]+b[1]))):(k=e.baxis,j=t(e,f,.5*(a[0]+b[0]),[a[1],b[1]])),c=1;c<j.length;c++)for(o+=k.smoothing?"C":"L",d=0;d<j[c].length;d++){var p=j[c][d];o+=[g.c2p(p[0]),h.c2p(p[1])]+" "}return o}var p,q,r,s,u,v,w,x="",y=b.edgepaths.map(function(a,b){return b}),z=!0,A=1e-4*Math.abs(c[0][0]-c[2][0]),B=1e-4*Math.abs(c[0][1]-c[2][1]);for(p=0,q=null;y.length;){var C=b.edgepaths[p][0];for(q&&(x+=o(q,C)),w=j.smoothopen(b.edgepaths[p].map(d),b.smoothing),x+=z?w:w.replace(/^M/,"L"),y.splice(y.indexOf(p),1),q=b.edgepaths[p][b.edgepaths[p].length-1],u=-1,s=0;s<4;s++){if(!q){k.log("Missing end?",p,b);break}for(i(q)&&!n(q)?r=c[1]:m(q)?r=c[0]:l(q)?r=c[3]:n(q)&&(r=c[2]),v=0;v<b.edgepaths.length;v++){var D=b.edgepaths[v][0];Math.abs(q[0]-r[0])<A?Math.abs(q[0]-D[0])<A&&(D[1]-q[1])*(r[1]-D[1])>=0&&(r=D,u=v):Math.abs(q[1]-r[1])<B?Math.abs(q[1]-D[1])<B&&(D[0]-q[0])*(r[0]-D[0])>=0&&(r=D,u=v):k.log("endpt to newendpt is not vert. or horz.",q,r,D)}if(u>=0)break;x+=o(q,r),q=r}if(u===b.edgepaths.length){k.log("unclosed perimeter path");break}p=u,(z=-1===y.indexOf(p))&&(p=y[0],x+=o(q,r)+"Z",q=null)}for(p=0;p<b.paths.length;p++)x+=j.smoothclosed(b.paths[p].map(d),b.smoothing);return x}(0,a,f,h,i,l,c,d);b?g.select(this).attr("d",b).style("stroke","none"):g.select(this).remove()})}(z,x,v,w,Q,J,u,A,B,I,S),function(a,b,c,h,i,l,m){var p=k.ensureSingle(a,"g","contourlines"),q=!1!==i.showlines,r=i.showlabels,s=q&&r,t=n.createLines(p,q||r,b),u=n.createLineClip(p,s,c,h.trace.uid),v=a.selectAll("g.contourlabels").data(r?[0]:[]);if(v.exit().remove(),v.enter().append("g").classed("contourlabels",!0),r){var w=l.xaxis,x=l.yaxis,y=w._length,z=x._length,A=[[[0,0],[y,0],[y,z],[0,z]]],B=[];k.clearLocationCache();var C=n.labelFormatter(c,h),D=j.tester.append("text").attr("data-notex",1).call(j.font,i.labelfont),E={left:0,right:y,center:y/2,top:0,bottom:z,middle:z/2},F=Math.sqrt(y*y+z*z),G=o.LABELDISTANCE*F/Math.max(1,b.length/o.LABELINCREASE);t.each(function(a){var b=n.calcTextOpts(a.level,C,D,c);g.select(this).selectAll("path").each(function(c){var g=k.getVisibleSegment(this,E,b.height/2);if(g&&(function(a,b,c,g,h,i){function j(a,b){var c,d=0;return(Math.abs(a[0]-m)<.1||Math.abs(a[0]-n)<.1)&&(c=e(h.dxydb_rough(a[0],a[1],.1)),d=Math.max(d,i*f(b,c)/2)),(Math.abs(a[1]-o)<.1||Math.abs(a[1]-p)<.1)&&(c=e(h.dxyda_rough(a[0],a[1],.1)),d=Math.max(d,i*f(b,c)/2)),d}for(var k,l=0;l<c.pedgepaths.length;l++)b===c.pedgepaths[l]&&(k=c.edgepaths[l]);if(k){var m=h.a[0],n=h.a[h.a.length-1],o=h.b[0],p=h.b[h.b.length-1],q=d(a,0,1),r=d(a,g.total,g.total-1),s=j(k[0],q),t=g.total-j(k[k.length-1],r);g.min<s&&(g.min=s),g.max>t&&(g.max=t),g.len=g.max-g.min}}(this,c,a,g,m,b.height),!(g.len<(b.width+b.height)*o.LABELMIN)))for(var h=Math.min(Math.ceil(g.len/G),o.LABELMAX),i=0;i<h;i++){var j=n.findBestTextLocation(this,g,b,B,E);if(!j)break;n.addLabelData(j,b,B,A)}})}),D.remove(),n.drawLabels(v,B,c,u,s?A:null)}r&&!q&&t.remove()}(x,F,a,y,E,b,A),j.setClipUrl(x,A._clipPathId,a)}})}},{"../../components/drawing":615,"../../lib":719,"../carpet/axis_aligned_line":900,"../carpet/lookup_carpetid":916,"../carpet/makepath":917,"../carpet/map_1d_array":918,"../contour/close_boundaries":945,"../contour/constants":947,"../contour/convert_to_constraints":951,"../contour/empty_pathinfo":953,"../contour/find_all_paths":955,"../contour/make_crossings":960,"../contour/plot":961,d3:164}],970:[function(a,b,c){"use strict";var d=a("../../components/colorscale/attributes"),e=a("../../plots/template_attributes").hovertemplateAttrs,f=a("../../plots/attributes"),g=a("../scattermapbox/attributes"),h=a("../../lib/extend").extendFlat;b.exports=h({lon:g.lon,lat:g.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:g.text,hovertext:g.hovertext,hoverinfo:h({},f.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:e()},d("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/template_attributes":843,"../scattermapbox/attributes":1170}],971:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib").isArrayOrTypedArray,f=a("../../constants/numerical").BADNUM,g=a("../../components/colorscale/calc"),h=a("../../lib")._;b.exports=function(a,b){for(var c=b._length,i=new Array(c),j=b.z,k=e(j)&&j.length,l=0;l<c;l++){var m=i[l]={},n=b.lon[l],o=b.lat[l];if(m.lonlat=d(n)&&d(o)?[+n,+o]:[f,f],k){var p=j[l];m.z=d(p)?p:f}}return g(a,b,{vals:k?j:[0,1],containerStr:"",cLetter:"z"}),c&&(i[0].t={labels:{lat:h(a,"lat:")+" ",lon:h(a,"lon:")+" "}}),i}},{"../../components/colorscale/calc":602,"../../constants/numerical":695,"../../lib":719,"fast-isnumeric":226}],972:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib"),f=a("../../components/color"),g=a("../../components/colorscale"),h=a("../../constants/numerical").BADNUM,i=a("../../lib/geojson_utils").makeBlank;b.exports=function(a){var b=a[0].trace,c=!0===b.visible&&0!==b._length,j=b._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:i()};if(!c)return j;var k,l=[],m=b.z,n=b.radius,o=e.isArrayOrTypedArray(m)&&m.length,p=e.isArrayOrTypedArray(n);for(k=0;k<a.length;k++){var q=a[k],r=q.lonlat;if(r[0]!==h){var s={};if(o){var t=q.z;s.z=t!==h?t:0}p&&(s.r=d(n[k])&&n[k]>0?+n[k]:0),l.push({type:"Feature",geometry:{type:"Point",coordinates:r},properties:s})}}var u=g.extractOpts(b),v=u.reversescale?g.flipScale(u.colorscale):u.colorscale,w=v[0][1],x=["interpolate",["linear"],["heatmap-density"],0,f.opacity(w)<1?w:f.addOpacity(w,0)];for(k=1;k<v.length;k++)x.push(v[k][0],v[k][1]);var y=["interpolate",["linear"],["get","z"],u.min,0,u.max,1];return e.extendFlat(j.heatmap.paint,{"heatmap-weight":o?y:1/(u.max-u.min),"heatmap-color":x,"heatmap-radius":p?{type:"identity",property:"r"}:b.radius,"heatmap-opacity":b.opacity}),j.geojson={type:"FeatureCollection",features:l},j.heatmap.layout.visibility="visible",j}},{"../../components/color":594,"../../components/colorscale":606,"../../constants/numerical":695,"../../lib":719,"../../lib/geojson_utils":714,"fast-isnumeric":226}],973:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/defaults"),f=a("./attributes");b.exports=function(a,b,c,g){function h(c,e){return d.coerce(a,b,f,c,e)}var i=h("lon")||[],j=h("lat")||[],k=Math.min(i.length,j.length);k?(b._length=k,h("z"),h("radius"),h("below"),h("text"),h("hovertext"),h("hovertemplate"),e(a,b,g,h,{prefix:"",cLetter:"z"})):b.visible=!1}},{"../../components/colorscale/defaults":604,"../../lib":719,"./attributes":970}],974:[function(a,b,c){"use strict";b.exports=function(a,b){return a.lon=b.lon,a.lat=b.lat,a.z=b.z,a}},{}],975:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("../scattermapbox/hover");b.exports=function(a,b,c){var g=f(a,b,c);if(g){var h=g[0],i=h.cd,j=i[0].trace,k=i[h.index];if(delete h.color,"z"in k){var l=h.subplot.mockAxis;h.z=k.z,h.zLabel=e.tickText(l,l.c2l(k.z),"hover").text}return h.extraText=function(a,b,c){function e(a){return a+""}if(!a.hovertemplate){var f=(b.hi||a.hoverinfo).split("+"),g=-1!==f.indexOf("all"),h=-1!==f.indexOf("lon"),i=-1!==f.indexOf("lat"),j=b.lonlat,k=[];return g||h&&i?k.push("("+e(j[0])+", "+e(j[1])+")"):h?k.push(c.lon+e(j[0])):i&&k.push(c.lat+e(j[1])),(g||-1!==f.indexOf("text"))&&d.fillText(b,a,k),k.join("<br>")}}(j,k,i[0].t.labels),[h]}}},{"../../lib":719,"../../plots/cartesian/axes":767,"../scattermapbox/hover":1174}],976:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../heatmap/colorbar"),calc:a("./calc"),plot:a("./plot"),hoverPoints:a("./hover"),eventData:a("./event_data"),getBelow:function(a,b){for(var c=b.getMapLayers(),d=0;d<c.length;d++){var e=c[d],f=e.id;if("symbol"===e.type&&"string"==typeof f&&-1===f.indexOf("plotly-"))return f}},moduleType:"trace",name:"densitymapbox",basePlotModule:a("../../plots/mapbox"),categories:["mapbox","gl"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":822,"../heatmap/colorbar":1003,"./attributes":970,"./calc":971,"./defaults":973,"./event_data":974,"./hover":975,"./plot":977}],977:[function(a,b,c){"use strict";function d(a,b){this.subplot=a,this.uid=b,this.sourceId="source-"+b,this.layerList=[["heatmap",f+b+"-heatmap"]],this.below=null}var e=a("./convert"),f=a("../../plots/mapbox/constants").traceLayerPrefix,g=d.prototype;g.update=function(a){var b=this.subplot,c=this.layerList,d=e(a),f=b.belowLookup["trace-"+this.uid];b.map.getSource(this.sourceId).setData(d.geojson),
f!==this.below&&(this._removeLayers(),this._addLayers(d,f),this.below=f);for(var g=0;g<c.length;g++){var h=c[g],i=h[0],j=h[1],k=d[i];b.setOptions(j,"setLayoutProperty",k.layout),"visible"===k.layout.visibility&&b.setOptions(j,"setPaintProperty",k.paint)}},g._addLayers=function(a,b){for(var c=this.subplot,d=this.layerList,e=this.sourceId,f=0;f<d.length;f++){var g=d[f],h=g[0],i=a[h];c.addLayer({type:h,id:g[1],source:e,layout:i.layout,paint:i.paint},b)}},g._removeLayers=function(){for(var a=this.subplot.map,b=this.layerList,c=b.length-1;c>=0;c--)a.removeLayer(b[c][1])},g.dispose=function(){var a=this.subplot.map;this._removeLayers(),a.removeSource(this.sourceId)},b.exports=function(a,b){var c=b[0].trace,f=new d(a,c.uid),g=f.sourceId,h=e(b),i=f.below=a.belowLookup["trace-"+c.uid];return a.map.addSource(g,{type:"geojson",data:h.geojson}),f._addLayers(h,i),f}},{"../../plots/mapbox/constants":820,"./convert":972}],978:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b){for(var c=0;c<a.length;c++)a[c].i=c;d.mergeArray(b.text,a,"tx"),d.mergeArray(b.hovertext,a,"htx");var e=b.marker;if(e){d.mergeArray(e.opacity,a,"mo"),d.mergeArray(e.color,a,"mc");var f=e.line;f&&(d.mergeArray(f.color,a,"mlc"),d.mergeArrayCastPositive(f.width,a,"mlw"))}}},{"../../lib":719}],979:[function(a,b,c){"use strict";var d=a("../bar/attributes"),e=a("../scatter/attributes").line,f=a("../../plots/attributes"),g=a("../../plots/template_attributes").hovertemplateAttrs,h=a("../../plots/template_attributes").texttemplateAttrs,i=a("./constants"),j=a("../../lib/extend").extendFlat,k=a("../../components/color");b.exports={x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,hovertext:d.hovertext,hovertemplate:g({},{keys:i.eventDataKeys}),hoverinfo:j({},f.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:h({editType:"plot"},{keys:i.eventDataKeys.concat(["label","value"])}),text:d.text,textposition:j({},d.textposition,{dflt:"auto"}),insidetextanchor:j({},d.insidetextanchor,{dflt:"middle"}),textangle:j({},d.textangle,{dflt:0}),textfont:d.textfont,insidetextfont:d.insidetextfont,outsidetextfont:d.outsidetextfont,constraintext:d.constraintext,cliponaxis:d.cliponaxis,orientation:j({},d.orientation,{}),offset:j({},d.offset,{arrayOk:!1}),width:j({},d.width,{arrayOk:!1}),marker:d.marker,connector:{fillcolor:{valType:"color",editType:"style"},line:{color:j({},e.color,{dflt:k.defaultLine}),width:j({},e.width,{dflt:0,editType:"plot"}),dash:e.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup}},{"../../components/color":594,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/template_attributes":843,"../bar/attributes":858,"../scatter/attributes":1111,"./constants":981}],980:[function(a,b,c){"use strict";function d(a){return a===h?0:a}var e=a("../../plots/cartesian/axes"),f=a("./arrays_to_calcdata"),g=a("../scatter/calc_selection"),h=a("../../constants/numerical").BADNUM;b.exports=function(a,b){var c,i,j,k,l=e.getFromId(a,b.xaxis||"x"),m=e.getFromId(a,b.yaxis||"y");"h"===b.orientation?(c=l.makeCalcdata(b,"x"),i=m.makeCalcdata(b,"y")):(c=m.makeCalcdata(b,"y"),i=l.makeCalcdata(b,"x"));var n,o=Math.min(i.length,c.length),p=new Array(o);for(b._base=[],j=0;j<o;j++){c[j]<0&&(c[j]=h);var q=!1;c[j]!==h&&j+1<o&&c[j+1]!==h&&(q=!0),k=p[j]={p:i[j],s:c[j],cNext:q},b._base[j]=-.5*k.s,b.ids&&(k.id=String(b.ids[j])),0===j&&(p[0].vTotal=0),p[0].vTotal+=d(k.s),k.begR=d(k.s)/d(p[0].s)}for(j=0;j<o;j++)(k=p[j]).s!==h&&(k.sumR=k.s/p[0].vTotal,k.difR=void 0!==n?k.s/n:1,n=k.s);return f(p,b),g(p,b),p}},{"../../constants/numerical":695,"../../plots/cartesian/axes":767,"../scatter/calc_selection":1113,"./arrays_to_calcdata":978}],981:[function(a,b,c){"use strict";b.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],982:[function(a,b,c){"use strict";var d=a("../bar/cross_trace_calc").setGroupPositions;b.exports=function(a,b){var c,e,f=a._fullLayout,g=a._fullData,h=a.calcdata,i=b.xaxis,j=b.yaxis,k=[],l=[],m=[];for(e=0;e<g.length;e++){var n=g[e],o="h"===n.orientation;!0===n.visible&&n.xaxis===i._id&&n.yaxis===j._id&&"funnel"===n.type&&(c=h[e],o?m.push(c):l.push(c),k.push(c))}var p={mode:f.funnelmode,norm:f.funnelnorm,gap:f.funnelgap,groupgap:f.funnelgroupgap};for(d(a,i,j,l,p),d(a,j,i,m,p),e=0;e<k.length;e++){c=k[e];for(var q=0;q<c.length;q++)q+1<c.length&&(c[q].nextP0=c[q+1].p0,c[q].nextS0=c[q+1].s0,c[q].nextP1=c[q+1].p1,c[q].nextS1=c[q+1].s1)}}},{"../bar/cross_trace_calc":861}],983:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../bar/defaults").handleGroupingDefaults,f=a("../bar/defaults").handleText,g=a("../scatter/xy_defaults"),h=a("./attributes"),i=a("../../components/color");b.exports={supplyDefaults:function(a,b,c,e){function j(c,e){return d.coerce(a,b,h,c,e)}if(g(a,b,e,j)){j("orientation",b.y&&!b.x?"v":"h"),j("offset"),j("width");var k=j("text");j("hovertext"),j("hovertemplate");var l=j("textposition");f(a,b,e,j,l,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"===b.textposition||b.texttemplate||j("textinfo",Array.isArray(k)?"text+value":"value");var m=j("marker.color",c);j("marker.line.color",i.defaultLine),j("marker.line.width"),j("connector.visible")&&(j("connector.fillcolor",function(a){var b=d.isArrayOrTypedArray(a)?"#000":a;return i.addOpacity(b,.5*i.opacity(b))}(m)),j("connector.line.width")&&(j("connector.line.color"),j("connector.line.dash")))}else b.visible=!1},crossTraceDefaults:function(a,b){function c(a){return d.coerce(g._input,g,h,a)}var f,g;if("group"===b.funnelmode)for(var i=0;i<a.length;i++)f=(g=a[i])._input,e(f,g,b,c)}}},{"../../components/color":594,"../../lib":719,"../bar/defaults":862,"../scatter/xy_defaults":1136,"./attributes":979}],984:[function(a,b,c){"use strict";b.exports=function(a,b){return a.x="xVal"in b?b.xVal:b.x,a.y="yVal"in b?b.yVal:b.y,"percentInitial"in b&&(a.percentInitial=b.percentInitial),"percentPrevious"in b&&(a.percentPrevious=b.percentPrevious),"percentTotal"in b&&(a.percentTotal=b.percentTotal),b.xa&&(a.xaxis=b.xa),b.ya&&(a.yaxis=b.ya),a}},{}],985:[function(a,b,c){"use strict";var d=a("../../components/color").opacity,e=a("../bar/hover").hoverOnBars,f=a("../../lib").formatPercent;b.exports=function(a,b,c,g){var h=e(a,b,c,g);if(h){var i=h.cd,j=i[0].trace,k="h"===j.orientation,l=i[h.index];h[(k?"x":"y")+"LabelVal"]=l.s,h.percentInitial=l.begR,h.percentInitialLabel=f(l.begR,1),h.percentPrevious=l.difR,h.percentPreviousLabel=f(l.difR,1),h.percentTotal=l.sumR,h.percentTotalLabel=f(l.sumR,1);var m=l.hi||j.hoverinfo,n=[];if(m&&"none"!==m&&"skip"!==m){var o="all"===m,p=m.split("+"),q=function(a){return o||-1!==p.indexOf(a)};q("percent initial")&&n.push(h.percentInitialLabel+" of initial"),q("percent previous")&&n.push(h.percentPreviousLabel+" of previous"),q("percent total")&&n.push(h.percentTotalLabel+" of total")}return h.extraText=n.join("<br>"),h.color=function(a,b){var c=a.marker,e=b.mc||c.color,f=b.mlc||c.line.color,g=b.mlw||c.line.width;return d(e)?e:d(f)&&g?f:void 0}(j,l),[h]}}},{"../../components/color":594,"../../lib":719,"../bar/hover":864}],986:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults").supplyDefaults,crossTraceDefaults:a("./defaults").crossTraceDefaults,supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc"),crossTraceCalc:a("./cross_trace_calc"),plot:a("./plot"),style:a("./style").style,hoverPoints:a("./hover"),eventData:a("./event_data"),selectPoints:a("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:a("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"../bar/select":869,"./attributes":979,"./calc":980,"./cross_trace_calc":982,"./defaults":983,"./event_data":984,"./hover":985,"./layout_attributes":987,"./layout_defaults":988,"./plot":989,"./style":990}],987:[function(a,b,c){"use strict";b.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],988:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(a,b,c){function f(c,f){return d.coerce(a,b,e,c,f)}for(var g=!1,h=0;h<c.length;h++){var i=c[h];if(i.visible&&"funnel"===i.type){g=!0;break}}g&&(f("funnelmode"),f("funnelgap",.2),f("funnelgroupgap"))}},{"../../lib":719,"./layout_attributes":987}],989:[function(a,b,c){"use strict";function d(a,b,c,d){var e=[],f=[],g=d?b:c,h=d?c:b;return e[0]=g.c2p(a.s0,!0),f[0]=h.c2p(a.p0,!0),e[1]=g.c2p(a.s1,!0),f[1]=h.c2p(a.p1,!0),e[2]=g.c2p(a.nextS0,!0),f[2]=h.c2p(a.nextP0,!0),e[3]=g.c2p(a.nextS1,!0),f[3]=h.c2p(a.nextP1,!0),d?[e,f]:[f,e]}var e=a("d3"),f=a("../../lib"),g=a("../../components/drawing"),h=a("../bar/plot").plot;b.exports=function(a,b,c,i){var j=a._fullLayout;!function(a,b,c,h){var i=b.xaxis,j=b.yaxis;f.makeTraceGroups(h,c,"trace bars").each(function(c){var h=e.select(this),k=c[0].trace,l=f.ensureSingle(h,"g","regions");if(k.connector&&k.connector.visible){var m="h"===k.orientation,n=l.selectAll("g.region").data(f.identity);n.enter().append("g").classed("region",!0),n.exit().remove();var o=n.size();n.each(function(c,h){if(h===o-1||c.cNext){var k=d(c,i,j,m),l=k[0],n=k[1],p="";void 0!==l[3]&&void 0!==n[3]&&(p+=m?"M"+l[0]+","+n[1]+"L"+l[2]+","+n[2]+"H"+l[3]+"L"+l[1]+","+n[1]+"Z":"M"+l[1]+","+n[1]+"L"+l[2]+","+n[3]+"V"+n[2]+"L"+l[1]+","+n[0]+"Z"),f.ensureSingle(e.select(this),"path").attr("d",p).call(g.setClipUrl,b.layerClipId,a)}})}else l.remove()})}(a,b,c,i),function(a,b,c,h){var i=b.xaxis,j=b.yaxis;f.makeTraceGroups(h,c,"trace bars").each(function(c){var h=e.select(this),k=c[0].trace,l=f.ensureSingle(h,"g","lines");if(k.connector&&k.connector.visible&&k.connector.line.width){var m="h"===k.orientation,n=l.selectAll("g.line").data(f.identity);n.enter().append("g").classed("line",!0),n.exit().remove();var o=n.size();n.each(function(c,h){if(h===o-1||c.cNext){var k=d(c,i,j,m),l=k[0],n=k[1],p="";void 0!==l[3]&&void 0!==n[3]&&(m?(p+="M"+l[0]+","+n[1]+"L"+l[2]+","+n[2],p+="M"+l[1]+","+n[1]+"L"+l[3]+","+n[2]):(p+="M"+l[1]+","+n[1]+"L"+l[2]+","+n[3],p+="M"+l[1]+","+n[0]+"L"+l[2]+","+n[2])),""===p&&(p="M0,0Z"),f.ensureSingle(e.select(this),"path").attr("d",p).call(g.setClipUrl,b.layerClipId,a)}})}else l.remove()})}(a,b,c,i),h(a,b,c,i,{mode:j.funnelmode,norm:j.funnelmode,gap:j.funnelgap,groupgap:j.funnelgroupgap})}},{"../../components/drawing":615,"../../lib":719,"../bar/plot":868,d3:164}],990:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../components/drawing"),f=a("../../components/color"),g=a("../../constants/interactions").DESELECTDIM,h=a("../bar/style").styleTextPoints;b.exports={style:function(a,b,c){var i=c||d.select(a).selectAll("g.funnellayer").selectAll("g.trace");i.style("opacity",function(a){return a[0].trace.opacity}),i.each(function(b){var c=d.select(this),i=b[0].trace;c.selectAll(".point > path").each(function(a){if(!a.isBlank){var b=i.marker;d.select(this).call(f.fill,a.mc||b.color).call(f.stroke,a.mlc||b.line.color).call(e.dashLine,b.line.dash,a.mlw||b.line.width).style("opacity",i.selectedpoints&&!a.selected?g:1)}}),h(c,i,a),c.selectAll(".regions").each(function(){d.select(this).selectAll("path").style("stroke-width",0).call(f.fill,i.connector.fillcolor)}),c.selectAll(".lines").each(function(){var a=i.connector.line;e.lineGroupStyle(d.select(this).selectAll("path"),a.width,a.color,a.dash)})})}}},{"../../components/color":594,"../../components/drawing":615,"../../constants/interactions":694,"../bar/style":871,d3:164}],991:[function(a,b,c){"use strict";var d=a("../pie/attributes"),e=a("../../plots/attributes"),f=a("../../plots/domain").attributes,g=a("../../plots/template_attributes").hovertemplateAttrs,h=a("../../plots/template_attributes").texttemplateAttrs,i=a("../../lib/extend").extendFlat;b.exports={labels:d.labels,label0:d.label0,dlabel:d.dlabel,values:d.values,marker:{colors:d.marker.colors,line:{color:i({},d.marker.line.color,{dflt:null}),width:i({},d.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:d.text,hovertext:d.hovertext,scalegroup:i({},d.scalegroup,{}),textinfo:i({},d.textinfo,{flags:["label","text","value","percent"]}),texttemplate:h({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:i({},e.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:g({},{keys:["label","color","value","text","percent"]}),textposition:i({},d.textposition,{values:["inside","none"],dflt:"inside"}),textfont:d.textfont,insidetextfont:d.insidetextfont,title:{text:d.title.text,font:d.title.font,position:i({},d.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:f({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":710,"../../plots/attributes":764,"../../plots/domain":792,"../../plots/template_attributes":843,"../pie/attributes":1085}],992:[function(a,b,c){"use strict";var d=a("../../plots/plots");c.name="funnelarea",c.plot=function(a,b,e,f){d.plotBasePlot(c.name,a,b,e,f)},c.clean=function(a,b,e,f){d.cleanBasePlot(c.name,a,b,e,f)}},{"../../plots/plots":828}],993:[function(a,b,c){"use strict";var d=a("../pie/calc");b.exports={calc:function(a,b){return d.calc(a,b)},crossTraceCalc:function(a){d.crossTraceCalc(a,{type:"funnelarea"})}}},{"../pie/calc":1087}],994:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("../../plots/domain").defaults,g=a("../bar/defaults").handleText;b.exports=function(a,b,c,h){function i(c,f){return d.coerce(a,b,e,c,f)}var j,k=i("values"),l=d.isArrayOrTypedArray(k),m=i("labels");if(Array.isArray(m)?(j=m.length,l&&(j=Math.min(j,k.length))):l&&(j=k.length,i("label0"),i("dlabel")),j){b._length=j,i("marker.line.width")&&i("marker.line.color",h.paper_bgcolor),i("marker.colors"),i("scalegroup");var n,o=i("text"),p=i("texttemplate");if(p||(n=i("textinfo",Array.isArray(o)?"text+percent":"percent")),i("hovertext"),i("hovertemplate"),p||n&&"none"!==n){var q=i("textposition");g(a,b,h,i,q,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}f(b,h,i),i("title.text")&&(i("title.position"),d.coerceFont(i,"title.font",h.font)),i("aspectratio"),i("baseratio")}else b.visible=!1}},{"../../lib":719,"../../plots/domain":792,"../bar/defaults":862,"./attributes":991}],995:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"funnelarea",basePlotModule:a("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc").calc,crossTraceCalc:a("./calc").crossTraceCalc,plot:a("./plot"),style:a("./style"),styleOne:a("../pie/style_one"),meta:{}}},{"../pie/style_one":1096,"./attributes":991,"./base_plot":992,"./calc":993,"./defaults":994,"./layout_attributes":996,"./layout_defaults":997,"./plot":998,"./style":999}],996:[function(a,b,c){"use strict";var d=a("../pie/layout_attributes").hiddenlabels;b.exports={hiddenlabels:d,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":1092}],997:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(a,b){function c(c,f){return d.coerce(a,b,e,c,f)}c("hiddenlabels"),c("funnelareacolorway",b.colorway),c("extendfunnelareacolors")}},{"../../lib":719,"./layout_attributes":996}],998:[function(a,b,c){"use strict";function d(a,b){return"l"+(b[0]-a[0])+","+(b[1]-a[1])}var e=a("d3"),f=a("../../components/drawing"),g=a("../../lib"),h=a("../../lib/svg_text_utils"),i=a("../bar/plot").toMoveInsideBar,j=a("../pie/helpers"),k=a("../pie/plot"),l=k.attachFxHandlers,m=k.determineInsideTextFont,n=k.layoutAreas,o=k.prerenderTitles,p=k.positionTitleOutside;b.exports=function(a,b){var c=a._fullLayout;o(b,a),n(b,c._size),g.makeTraceGroups(c._funnelarealayer,b,"trace").each(function(b){var n=e.select(this),o=b[0],q=o.trace;!function(a){function b(){var a,b={x:a=Math.sqrt(m),y:-a};return[b.x,b.y]}if(a.length){var c=a[0],d=c.trace,e=d.aspectratio,f=d.baseratio;f>.999&&(f=.999);var g,h,i,j=Math.pow(f,2),k=c.vTotal,l=k,m=k*j/(1-j)/k,n=[];for(n.push(b()),h=a.length-1;h>-1;h--)if(!(i=a[h]).hidden){var o=i.v/l;m+=o,n.push(b())}var p=1/0,q=-1/0;for(h=0;h<n.length;h++)g=n[h],p=Math.min(p,g[1]),q=Math.max(q,g[1]);for(h=0;h<n.length;h++)n[h][1]-=(q+p)/2;var r=n[n.length-1][0],s=c.r,t=(q-p)/2,u=s/r,v=s/t*e;for(c.r=v*t,h=0;h<n.length;h++)n[h][0]*=u,n[h][1]*=v;var w=[-(g=n[0])[0],g[1]],x=[g[0],g[1]],y=0;for(h=a.length-1;h>-1;h--)if(!(i=a[h]).hidden){var z=n[y+=1][0],A=n[y][1];i.TL=[-z,A],i.TR=[z,A],i.BL=w,i.BR=x,i.pxmid=(B=i.TR,C=i.BR,[.5*(B[0]+C[0]),.5*(B[1]+C[1])]),w=i.TL,x=i.TR}var B,C}}(b),n.each(function(){var n=e.select(this).selectAll("g.slice").data(b);n.enter().append("g").classed("slice",!0),n.exit().remove(),n.each(function(c){if(c.hidden)e.select(this).selectAll("path,g").remove();else{c.pointNumber=c.i,c.curveNumber=q.index;var n=o.cx,p=o.cy,r=e.select(this),s=r.selectAll("path.surface").data([c]);s.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),r.call(l,a,b);var t="M"+(n+c.TR[0])+","+(p+c.TR[1])+d(c.TR,c.BR)+d(c.BR,c.BL)+d(c.BL,c.TL)+"Z";s.attr("d",t),k.formatSliceLabel(a,c,o);var u=j.castOption(q.textposition,c.pts),v=r.selectAll("g.slicetext").data(c.text&&"none"!==u?[0]:[]);v.enter().append("g").classed("slicetext",!0),v.exit().remove(),v.each(function(){var b=g.ensureSingle(e.select(this),"text","",function(a){a.attr("data-notex",1)});b.text(c.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(f.font,m(q,c,a._fullLayout.font)).call(h.convertToTspans,a);var d,j,k,l=f.bBox(b.node()),o=Math.min(c.BL[1],c.BR[1]),r=Math.max(c.TL[1],c.TR[1]);j=Math.max(c.TL[0],c.BL[0]),k=Math.min(c.TR[0],c.BR[0]),d=g.getTextTransform(i(j,k,o,r,l,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})),b.attr("transform","translate("+n+","+p+")"+d)})}});var r=e.select(this).selectAll("g.titletext").data(q.title.text?[0]:[]);r.enter().append("g").classed("titletext",!0),r.exit().remove(),r.each(function(){var b=g.ensureSingle(e.select(this),"text","",function(a){a.attr("data-notex",1)}),d=q.title.text;q._meta&&(d=g.templateString(d,q._meta)),b.text(d).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(f.font,q.title.font).call(h.convertToTspans,a);var i=p(o,c._size);b.attr("transform","translate("+i.x+","+i.y+")"+(i.scale<1?"scale("+i.scale+")":"")+"translate("+i.tx+","+i.ty+")")})})})}},{"../../components/drawing":615,"../../lib":719,"../../lib/svg_text_utils":743,"../bar/plot":868,"../pie/helpers":1090,"../pie/plot":1094,d3:164}],999:[function(a,b,c){"use strict";var d=a("d3"),e=a("../pie/style_one");b.exports=function(a){a._fullLayout._funnelarealayer.selectAll(".trace").each(function(a){var b=a[0].trace,c=d.select(this);c.style({opacity:b.opacity}),c.selectAll("path.surface").each(function(a){d.select(this).call(e,a,b)})})}},{"../pie/style_one":1096,d3:164}],1e3:[function(a,b,c){"use strict";var d=a("../scatter/attributes"),e=a("../../plots/template_attributes").hovertemplateAttrs,f=a("../../components/colorscale/attributes"),g=(a("../../constants/docs").FORMAT_LINK,a("../../lib/extend").extendFlat);b.exports=g({z:{valType:"data_array",editType:"calc"},x:g({},d.x,{impliedEdits:{xtype:"array"}}),x0:g({},d.x0,{impliedEdits:{xtype:"scaled"}}),dx:g({},d.dx,{impliedEdits:{xtype:"scaled"}}),y:g({},d.y,{impliedEdits:{ytype:"array"}}),y0:g({},d.y0,{impliedEdits:{ytype:"scaled"}}),dy:g({},d.dy,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},zhoverformat:{valType:"string",dflt:"",editType:"none"},hovertemplate:e()},{transforms:void 0},f("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":601,"../../constants/docs":690,"../../lib/extend":710,"../../plots/template_attributes":843,"../scatter/attributes":1111}],1001:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("../../plots/cartesian/axes"),g=a("../histogram2d/calc"),h=a("../../components/colorscale/calc"),i=a("./convert_column_xyz"),j=a("./clean_2d_array"),k=a("./interp2d"),l=a("./find_empties"),m=a("./make_bound_array");b.exports=function(a,b){function c(a){B=b._input.zsmooth=b.zsmooth=!1,e.warn('cannot use zsmooth: "fast": '+a)}var n,o,p,q,r,s,t,u,v,w=f.getFromId(a,b.xaxis||"x"),x=f.getFromId(a,b.yaxis||"y"),y=d.traceIs(b,"contour"),z=d.traceIs(b,"histogram"),A=d.traceIs(b,"gl2d"),B=y?"best":b.zsmooth;if(w._minDtick=0,x._minDtick=0,z)n=(v=g(a,b)).x,o=v.x0,p=v.dx,q=v.y,r=v.y0,s=v.dy,t=v.z;else{var C=b.z;e.isArray1D(C)?(i(b,w,x,"x","y",["z"]),n=b._x,q=b._y,C=b._z):(n=b._x=b.x?w.makeCalcdata(b,"x"):[],q=b._y=b.y?x.makeCalcdata(b,"y"):[]),o=b.x0,p=b.dx,r=b.y0,s=b.dy,t=j(C,b,w,x),(y||b.connectgaps)&&(b._emptypoints=l(t),k(t,b._emptypoints))}if("fast"===B)if("log"===w.type||"log"===x.type)c("log axis found");else if(!z){if(n.length){var D=(n[n.length-1]-n[0])/(n.length-1),E=Math.abs(D/100);for(u=0;u<n.length-1;u++)if(Math.abs(n[u+1]-n[u]-D)>E){c("x scale is not linear");break}}if(q.length&&"fast"===B){var F=(q[q.length-1]-q[0])/(q.length-1),G=Math.abs(F/100);for(u=0;u<q.length-1;u++)if(Math.abs(q[u+1]-q[u]-F)>G){c("y scale is not linear");break}}}var H=e.maxRowLength(t),I="scaled"===b.xtype?"":n,J=m(b,I,o,p,H,w),K="scaled"===b.ytype?"":q,L=m(b,K,r,s,t.length,x);A||(b._extremes[w._id]=f.findExtremes(w,J),b._extremes[x._id]=f.findExtremes(x,L));var M={x:J,y:L,z:t,text:b._text||b.text,hovertext:b._hovertext||b.hovertext};if(I&&I.length===J.length-1&&(M.xCenter=I),K&&K.length===L.length-1&&(M.yCenter=K),z&&(M.xRanges=v.xRanges,M.yRanges=v.yRanges,M.pts=v.pts),y||h(a,b,{vals:t,cLetter:"z"}),y&&b.contours&&"heatmap"===b.contours.coloring){var N={type:"contour"===b.type?"heatmap":"histogram2d",xcalendar:b.xcalendar,ycalendar:b.ycalendar};M.xfill=m(N,I,o,p,H,w),M.yfill=m(N,K,r,s,t.length,x)}return[M]}},{"../../components/colorscale/calc":602,"../../lib":719,"../../plots/cartesian/axes":767,"../../registry":848,"../histogram2d/calc":1032,"./clean_2d_array":1002,"./convert_column_xyz":1004,"./find_empties":1006,"./interp2d":1009,"./make_bound_array":1010}],1002:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib"),f=a("../../constants/numerical").BADNUM;b.exports=function(a,b,c,g){function h(a){if(b&&"carpet"!==b.type&&"contourcarpet"!==b.type&&a&&"category"===a.type&&b["_"+a._id.charAt(0)].length){var c=a._id.charAt(0),d={},g=b["_"+c+"CategoryMap"]||b[c];for(m=0;m<g.length;m++)d[g[m]]=m;return function(b){var c=d[a._categories[b]];return c+1?c:f}}return e.identity}var i,j,k,l,m,n;if(b&&b.transpose){for(i=0,m=0;m<a.length;m++)i=Math.max(i,a[m].length);if(0===i)return!1;k=function(a){return a.length},l=function(a,b,c){return(a[c]||[])[b]}}else i=a.length,k=function(a,b){return a[b].length},l=function(a,b,c){return(a[b]||[])[c]};var o=h(c),p=h(g);g&&"category"===g.type&&(i=g._categories.length);var q=new Array(i);for(m=0;m<i;m++)for(j=c&&"category"===c.type?c._categories.length:k(a,m),q[m]=new Array(j),n=0;n<j;n++)q[m][n]=function(a){if(d(a))return+a}(function(a,b,c){return b===f||c===f?f:l(a,b,c)}(a,p(m),o(n)));return q}},{"../../constants/numerical":695,"../../lib":719,"fast-isnumeric":226}],1003:[function(a,b,c){"use strict";b.exports={min:"zmin",max:"zmax"}},{}],1004:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../constants/numerical").BADNUM;b.exports=function(a,b,c,f,g,h){var i,j,k,l,m=a._length,n=b.makeCalcdata(a,f),o=c.makeCalcdata(a,g),p=a.text,q=void 0!==p&&d.isArray1D(p),r=a.hovertext,s=void 0!==r&&d.isArray1D(r),t=d.distinctVals(n),u=t.vals,v=d.distinctVals(o),w=v.vals,x=[];for(i=0;i<h.length;i++)x[i]=d.init2dArray(w.length,u.length);for(q&&(k=d.init2dArray(w.length,u.length)),s&&(l=d.init2dArray(w.length,u.length)),i=0;i<m;i++)if(n[i]!==e&&o[i]!==e){var y=d.findBin(n[i]+t.minDiff/2,u),z=d.findBin(o[i]+v.minDiff/2,w);for(j=0;j<h.length;j++){var A=a[h[j]];x[j][z][y]=A[i]}q&&(k[z][y]=p[i]),s&&(l[z][y]=r[i])}for(a["_"+f]=u,a["_"+g]=w,j=0;j<h.length;j++)a["_"+h[j]]=x[j];q&&(a._text=k),s&&(a._hovertext=l),b&&"category"===b.type&&(a["_"+f+"CategoryMap"]=u.map(function(a){return b._categories[a]})),c&&"category"===c.type&&(a["_"+g+"CategoryMap"]=w.map(function(a){return c._categories[a]}))}},{"../../constants/numerical":695,"../../lib":719}],1005:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./xyz_defaults"),f=a("./style_defaults"),g=a("../../components/colorscale/defaults"),h=a("./attributes");b.exports=function(a,b,c,i){function j(c,e){return d.coerce(a,b,h,c,e)}e(a,b,j,i)?(j("text"),j("hovertext"),j("hovertemplate"),f(a,b,j,i),j("connectgaps",d.isArray1D(b.z)&&!1!==b.zsmooth),g(a,b,i,j,{prefix:"",cLetter:"z"})):b.visible=!1}},{"../../components/colorscale/defaults":604,"../../lib":719,"./attributes":1e3,"./style_defaults":1013,"./xyz_defaults":1014}],1006:[function(a,b,c){"use strict";var d=a("../../lib").maxRowLength;b.exports=function(a){var b,c,e,f,g,h,i,j,k=[],l={},m=[],n=a[0],o=[],p=[0,0,0],q=d(a);for(c=0;c<a.length;c++)for(b=o,o=n,n=a[c+1]||[],e=0;e<q;e++)void 0===o[e]&&((h=(void 0!==o[e-1]?1:0)+(void 0!==o[e+1]?1:0)+(void 0!==b[e]?1:0)+(void 0!==n[e]?1:0))?(0===c&&h++,0===e&&h++,c===a.length-1&&h++,e===o.length-1&&h++,h<4&&(l[[c,e]]=[c,e,h]),k.push([c,e,h])):m.push([c,e]));for(;m.length;){for(i={},j=!1,g=m.length-1;g>=0;g--)(h=((l[[(c=(f=m[g])[0])-1,e=f[1]]]||p)[2]+(l[[c+1,e]]||p)[2]+(l[[c,e-1]]||p)[2]+(l[[c,e+1]]||p)[2])/20)&&(i[f]=[c,e,h],m.splice(g,1),j=!0);if(!j)throw"findEmpties iterated with no new neighbors";for(f in i)l[f]=i[f],k.push(i[f])}return k.sort(function(a,b){return b[2]-a[2]})}},{"../../lib":719}],1007:[function(a,b,c){"use strict";var d=a("../../components/fx"),e=a("../../lib"),f=a("../../plots/cartesian/axes"),g=a("../../components/colorscale").extractOpts;b.exports=function(a,b,c,h,i,j){var k,l,m,n,o=a.cd[0],p=o.trace,q=a.xa,r=a.ya,s=o.x,t=o.y,u=o.z,v=o.xCenter,w=o.yCenter,x=o.zmask,y=p.zhoverformat,z=s,A=t;if(!1!==a.index){try{m=Math.round(a.index[1]),n=Math.round(a.index[0])}catch(b){return void e.error("Error hovering on heatmap, pointNumber must be [row,col], found:",a.index)}if(m<0||m>=u[0].length||n<0||n>u.length)return}else{if(d.inbox(b-s[0],b-s[s.length-1],0)>0||d.inbox(c-t[0],c-t[t.length-1],0)>0)return;if(j){var B;for(z=[2*s[0]-s[1]],B=1;B<s.length;B++)z.push((s[B]+s[B-1])/2);for(z.push([2*s[s.length-1]-s[s.length-2]]),A=[2*t[0]-t[1]],B=1;B<t.length;B++)A.push((t[B]+t[B-1])/2);A.push([2*t[t.length-1]-t[t.length-2]])}m=Math.max(0,Math.min(z.length-2,e.findBin(b,z))),n=Math.max(0,Math.min(A.length-2,e.findBin(c,A)))}var C=q.c2p(s[m]),D=q.c2p(s[m+1]),E=r.c2p(t[n]),F=r.c2p(t[n+1]);j?(D=C,k=s[m],F=E,l=t[n]):(k=v?v[m]:(s[m]+s[m+1])/2,l=w?w[n]:(t[n]+t[n+1])/2,q&&"category"===q.type&&(k=s[m]),r&&"category"===r.type&&(l=t[n]),p.zsmooth&&(C=D=q.c2p(k),E=F=r.c2p(l)));var G,H=u[n][m];x&&!x[n][m]&&(H=void 0),Array.isArray(o.hovertext)&&Array.isArray(o.hovertext[n])?G=o.hovertext[n][m]:Array.isArray(o.text)&&Array.isArray(o.text[n])&&(G=o.text[n][m]);var I=g(p),J={type:"linear",range:[I.min,I.max],hoverformat:y,_separators:q._separators,_numFormat:q._numFormat},K=f.tickText(J,H,"hover").text;return[e.extendFlat(a,{index:[n,m],distance:a.maxHoverDistance,spikeDistance:a.maxSpikeDistance,x0:C,x1:D,y0:E,y1:F,xLabelVal:k,yLabelVal:l,zLabelVal:H,zLabel:K,text:G})]}},{"../../components/colorscale":606,"../../components/fx":632,"../../lib":719,"../../plots/cartesian/axes":767}],1008:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot"),colorbar:a("./colorbar"),style:a("./style"),hoverPoints:a("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","2dMap"],meta:{}}},{"../../plots/cartesian":778,"./attributes":1e3,"./calc":1001,"./colorbar":1003,"./defaults":1005,"./hover":1007,"./plot":1011,"./style":1012}],1009:[function(a,b,c){"use strict";function d(a){return.5-.25*Math.min(1,.5*a)}function e(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r=0;for(h=0;h<b.length;h++){for(e=(d=b[h])[0],f=d[1],o=a[e][f],n=0,m=0,i=0;i<4;i++)(k=a[e+(j=g[i])[0]])&&void 0!==(l=k[f+j[1]])&&(0===n?p=q=l:(p=Math.min(p,l),q=Math.max(q,l)),m++,n+=l);if(0===m)throw"iterateInterp2d order is wrong: no defined neighbors";a[e][f]=n/m,void 0===o?m<4&&(r=1):(a[e][f]=(1+c)*a[e][f]-c*o,q>p&&(r=Math.max(r,Math.abs(a[e][f]-o)/(q-p))))}return r}var f=a("../../lib"),g=[[-1,0],[1,0],[0,-1],[0,1]];b.exports=function(a,b){var c,g=1;for(e(a,b),c=0;c<b.length&&!(b[c][2]<4);c++);for(b=b.slice(c),c=0;c<100&&g>.01;c++)g=e(a,b,d(g));return g>.01&&f.log("interp2d didn't converge quickly",g),a}},{"../../lib":719}],1010:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib").isArrayOrTypedArray;b.exports=function(a,b,c,f,g,h){var i,j,k,l=[],m=d.traceIs(a,"contour"),n=d.traceIs(a,"histogram"),o=d.traceIs(a,"gl2d");if(e(b)&&b.length>1&&!n&&"category"!==h.type){var p=b.length;if(!(p<=g))return m?b.slice(0,g):b.slice(0,g+1);if(m||o)l=b.slice(0,g);else if(1===g)l=[b[0]-.5,b[0]+.5];else{for(l=[1.5*b[0]-.5*b[1]],k=1;k<p;k++)l.push(.5*(b[k-1]+b[k]));l.push(1.5*b[p-1]-.5*b[p-2])}if(p<g){var q=l[l.length-1],r=q-l[l.length-2];for(k=p;k<g;k++)q+=r,l.push(q)}}else{var s=a[h._id.charAt(0)+"calendar"];for(i=n?h.r2c(c,0,s):e(b)&&1===b.length?b[0]:void 0===c?0:("log"===h.type?h.d2c:h.r2c)(c,0,s),j=f||1,k=m||o?0:-.5;k<g;k++)l.push(i+j*k)}return l}},{"../../lib":719,"../../registry":848}],1011:[function(a,b,c){"use strict";function d(a,b){var c=b.length-2,d=j.constrain(j.findBin(a,b),0,c),e=b[d],f=b[d+1],g=j.constrain(d+(a-e)/(f-e)-.5,0,c),h=Math.round(g),i=Math.abs(g-h);return g&&g!==c&&i?{bin0:h,frac:i,bin1:Math.round(h+i/(g-h))}:{bin0:h,bin1:h,frac:0}}function e(a,b){var c=b.length-1,d=j.constrain(j.findBin(a,b),0,c),e=b[d],f=(a-e)/(b[d+1]-e)||0;return f<=0?{bin0:d,bin1:d,frac:0}:f<.5?{bin0:d,bin1:d+1,frac:f}:{bin0:d+1,bin1:d,frac:1-f}}function f(a,b,c){a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=Math.round(255*c[3])}var g=a("d3"),h=a("tinycolor2"),i=a("../../registry"),j=a("../../lib"),k=a("../../components/colorscale").makeColorScaleFuncFromTrace,l=a("../../constants/xmlns_namespaces");b.exports=function(a,b,c,m){var n=b.xaxis,o=b.yaxis;j.makeTraceGroups(m,c,"hm").each(function(b){function c(a,b){if(void 0!==a){var c=R(a);return c[0]=Math.round(c[0]),c[1]=Math.round(c[1]),c[2]=Math.round(c[2]),_+=b,aa+=c[0]*b,ba+=c[1]*b,ca+=c[2]*b,c}return[0,0,0,0]}var m,p,q,r,s,t,u=g.select(this),v=b[0],w=v.trace,x=v.z,y=v.x,z=v.y,A=v.xCenter,B=v.yCenter,C=i.traceIs(w,"contour"),D=C?"best":w.zsmooth,E=x.length,F=j.maxRowLength(x),G=!1,H=!1;for(t=0;void 0===m&&t<y.length-1;)m=n.c2p(y[t]),t++;for(t=y.length-1;void 0===p&&t>0;)p=n.c2p(y[t]),t--
;for(p<m&&(q=p,p=m,m=q,G=!0),t=0;void 0===r&&t<z.length-1;)r=o.c2p(z[t]),t++;for(t=z.length-1;void 0===s&&t>0;)s=o.c2p(z[t]),t--;if(s<r&&(q=r,r=s,s=q,H=!0),C&&(A=y,B=z,y=v.xfill,z=v.yfill),"fast"!==D){var I="best"===D?0:.5;m=Math.max(-I*n._length,m),p=Math.min((1+I)*n._length,p),r=Math.max(-I*o._length,r),s=Math.min((1+I)*o._length,s)}var J=Math.round(p-m),K=Math.round(s-r);if(J<=0||K<=0)u.selectAll("image").data([]).exit().remove();else{var L,M;"fast"===D?(L=F,M=E):(L=J,M=K);var N=document.createElement("canvas");N.width=L,N.height=M;var O,P,Q=N.getContext("2d"),R=k(w,{noNumericCheck:!0,returnArray:!0});"fast"===D?(O=G?function(a){return F-1-a}:j.identity,P=H?function(a){return E-1-a}:j.identity):(O=function(a){return j.constrain(Math.round(n.c2p(y[a])-m),0,J)},P=function(a){return j.constrain(Math.round(o.c2p(z[a])-r),0,K)});var S,T,U,V,W,X=P(0),Y=[X,X],Z=G?0:1,$=H?0:1,_=0,aa=0,ba=0,ca=0;if(D){var da,ea=0;try{da=new Uint8Array(J*K*4)}catch(a){da=new Array(J*K*4)}if("best"===D){var fa,ga,ha,ia=A||y,ja=B||z,ka=new Array(ia.length),la=new Array(ja.length),ma=new Array(J),na=A?e:d,oa=B?e:d;for(t=0;t<ia.length;t++)ka[t]=Math.round(n.c2p(ia[t])-m);for(t=0;t<ja.length;t++)la[t]=Math.round(o.c2p(ja[t])-r);for(t=0;t<J;t++)ma[t]=na(t,ka);for(T=0;T<K;T++)for(ga=x[(fa=oa(T,la)).bin0],ha=x[fa.bin1],t=0;t<J;t++,ea+=4)f(da,ea,W=function(a,b,d,e){var f=a[d.bin0];if(void 0===f)return c(void 0,1);var g,h=a[d.bin1],i=b[d.bin0],j=b[d.bin1],k=h-f||0,l=i-f||0;return g=void 0===h?void 0===j?0:void 0===i?2*(j-f):2*(2*j-i-f)/3:void 0===j?void 0===i?0:2*(2*f-h-i)/3:void 0===i?2*(2*j-h-f)/3:j+f-h-i,c(f+d.frac*k+e.frac*(l+d.frac*g))}(ga,ha,ma[t],fa))}else for(T=0;T<E;T++)for(V=x[T],Y=P(T),t=0;t<J;t++)W=c(V[t],1),f(da,ea=4*(Y*J+O(t)),W);var pa=Q.createImageData(J,K);try{pa.data.set(da)}catch(a){var qa=pa.data,ra=qa.length;for(T=0;T<ra;T++)qa[T]=da[T]}Q.putImageData(pa,0,0)}else{var sa=w.xgap,ta=w.ygap,ua=Math.floor(sa/2),va=Math.floor(ta/2);for(T=0;T<E;T++)if(V=x[T],Y.reverse(),Y[$]=P(T+1),Y[0]!==Y[1]&&void 0!==Y[0]&&void 0!==Y[1])for(S=[U=O(0),U],t=0;t<F;t++)S.reverse(),S[Z]=O(t+1),S[0]!==S[1]&&void 0!==S[0]&&void 0!==S[1]&&(W=c(V[t],(S[1]-S[0])*(Y[1]-Y[0])),Q.fillStyle="rgba("+W.join(",")+")",Q.fillRect(S[0]+ua,Y[0]+va,S[1]-S[0]-sa,Y[1]-Y[0]-ta))}aa=Math.round(aa/_),ba=Math.round(ba/_),ca=Math.round(ca/_);var wa=h("rgb("+aa+","+ba+","+ca+")");a._hmpixcount=(a._hmpixcount||0)+_,a._hmlumcount=(a._hmlumcount||0)+_*wa.getLuminance();var xa=u.selectAll("image").data(b);xa.enter().append("svg:image").attr({xmlns:l.svg,preserveAspectRatio:"none"}),xa.attr({height:K,width:J,x:m,y:r,"xlink:href":N.toDataURL("image/png")})}})}},{"../../components/colorscale":606,"../../constants/xmlns_namespaces":696,"../../lib":719,"../../registry":848,d3:164,tinycolor2:538}],1012:[function(a,b,c){"use strict";var d=a("d3");b.exports=function(a){d.select(a).selectAll(".hm image").style("opacity",function(a){return a.trace.opacity})}},{d3:164}],1013:[function(a,b,c){"use strict";b.exports=function(a,b,c){!1===c("zsmooth")&&(c("xgap"),c("ygap")),c("zhoverformat")}},{}],1014:[function(a,b,c){"use strict";function d(a,b){var c=b(a);return"scaled"===(c?b(a+"type","array"):"scaled")&&(b(a+"0"),b("d"+a)),c}var e=a("fast-isnumeric"),f=a("../../lib"),g=a("../../registry");b.exports=function(a,b,c,h,i,j){var k,l,m=c("z");if(i=i||"x",j=j||"y",void 0===m||!m.length)return 0;if(f.isArray1D(a.z)){k=c(i),l=c(j);var n=f.minRowLength(k),o=f.minRowLength(l);if(0===n||0===o)return 0;b._length=Math.min(n,o,m.length)}else{if(k=d(i,c),l=d(j,c),!function(a){for(var b,c=!0,d=!1,g=!1,h=0;h<a.length;h++){if(b=a[h],!f.isArrayOrTypedArray(b)){c=!1;break}b.length>0&&(d=!0);for(var i=0;i<b.length;i++)if(e(b[i])){g=!0;break}}return c&&d&&g}(m))return 0;c("transpose"),b._length=null}return g.getComponentMethod("calendars","handleTraceDefaults")(a,b,[i,j],h),!0}},{"../../lib":719,"../../registry":848,"fast-isnumeric":226}],1015:[function(a,b,c){"use strict";for(var d=a("../heatmap/attributes"),e=a("../../components/colorscale/attributes"),f=a("../../lib/extend").extendFlat,g=a("../../plot_api/edit_types").overrideAll,h=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],i={},j=0;j<h.length;j++){var k=h[j];i[k]=d[k]}f(i,e("",{cLetter:"z",autoColorDflt:!1})),b.exports=g(i,"calc","nested")},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plot_api/edit_types":750,"../heatmap/attributes":1e3}],1016:[function(a,b,c){"use strict";function d(a,b){this.scene=a,this.uid=b,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=e(a.glplot,this.options),this.heatmap._trace=this}var e=a("gl-heatmap2d"),f=a("../../plots/cartesian/axes"),g=a("../../lib/str2rgbarray"),h=d.prototype;h.handlePick=function(a){var b=this.options,c=b.shape,d=a.pointId,e=d%c[0],f=Math.floor(d/c[0]),g=d;return{trace:this,dataCoord:a.dataCoord,traceCoord:[b.x[e],b.y[f],b.z[g]],textLabel:this.textLabels[d],name:this.name,pointIndex:[f,e],hoverinfo:this.hoverinfo}},h.update=function(a,b){var c=b[0];this.index=a.index,this.name=a.name,this.hoverinfo=a.hoverinfo;var d=c.z;this.options.z=[].concat.apply([],d);var e=d[0].length,h=d.length;this.options.shape=[e,h],this.options.x=c.x,this.options.y=c.y;var i=function(a){for(var b=a.colorscale,c=a.zmin,d=a.zmax,e=b.length,f=new Array(e),h=new Array(4*e),i=0;i<e;i++){var j=b[i],k=g(j[1]);f[i]=c+j[0]*(d-c);for(var l=0;l<4;l++)h[4*i+l]=k[l]}return{colorLevels:f,colorValues:h}}(a);this.options.colorLevels=i.colorLevels,this.options.colorValues=i.colorValues,this.textLabels=[].concat.apply([],a.text),this.heatmap.update(this.options);var j=this.scene.xaxis,k=this.scene.yaxis;a._extremes[j._id]=f.findExtremes(j,c.x),a._extremes[k._id]=f.findExtremes(k,c.y)},h.dispose=function(){this.heatmap.dispose()},b.exports=function(a,b,c){var e=new d(a,b.uid);return e.update(b,c),e}},{"../../lib/str2rgbarray":742,"../../plots/cartesian/axes":767,"gl-heatmap2d":252}],1017:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("../heatmap/defaults"),colorbar:a("../heatmap/colorbar"),calc:a("../heatmap/calc"),plot:a("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:a("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":805,"../heatmap/calc":1001,"../heatmap/colorbar":1003,"../heatmap/defaults":1005,"./attributes":1015,"./convert":1016}],1018:[function(a,b,c){"use strict";var d=a("../bar/attributes"),e=a("../../plots/template_attributes").hovertemplateAttrs,f=a("./bin_attributes"),g=a("./constants"),h=a("../../lib/extend").extendFlat;b.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},text:h({},d.text,{}),hovertext:h({},d.hovertext,{}),orientation:d.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:f("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:f("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:e({},{keys:g.eventDataKeys}),marker:d.marker,offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup,selected:d.selected,unselected:d.unselected,_deprecated:{bardir:d._deprecated.bardir}}},{"../../lib/extend":710,"../../plots/template_attributes":843,"../bar/attributes":858,"./bin_attributes":1020,"./constants":1024}],1019:[function(a,b,c){"use strict";b.exports=function(a,b){for(var c=a.length,d=0,e=0;e<c;e++)b[e]?(a[e]/=b[e],d+=a[e]):a[e]=null;return d}},{}],1020:[function(a,b,c){"use strict";b.exports=function(a,b){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],1021:[function(a,b,c){"use strict";var d=a("fast-isnumeric");b.exports={count:function(a,b,c){return c[a]++,1},sum:function(a,b,c,e){var f=e[b];return d(f)?(f=Number(f),c[a]+=f,f):0},avg:function(a,b,c,e,f){var g=e[b];return d(g)&&(g=Number(g),c[a]+=g,f[a]++),0},min:function(a,b,c,e){var f=e[b];if(d(f)){if(f=Number(f),!d(c[a]))return c[a]=f,f;if(c[a]>f){var g=f-c[a];return c[a]=f,g}}return 0},max:function(a,b,c,e){var f=e[b];if(d(f)){if(f=Number(f),!d(c[a]))return c[a]=f,f;if(c[a]<f){var g=f-c[a];return c[a]=f,g}}return 0}}},{"fast-isnumeric":226}],1022:[function(a,b,c){"use strict";function d(a,b,c,d){if(a*b<=0)return 1/0;for(var g=Math.abs(b-a),h="date"===c.type,i=e(g,h),j=0;j<10;j++){var k=e(80*i,h);if(i===k)break;if(!f(k,a,b,h,c,d))break;i=k}return i}function e(a,b){return b&&a>n?a>k?a>1.1*i?i:a>1.1*j?j:k:a>l?l:a>m?m:n:Math.pow(10,Math.floor(Math.log(a)/Math.LN10))}function f(a,b,c,d,e,f){if(d&&a>k){var h=g(b,e,f),j=g(c,e,f),l=a===i?0:1;return h[l]!==j[l]}return Math.floor(c/a)-Math.floor(b/a)>.1}function g(a,b,c){var d=b.c2d(a,i,c).split("-");return""===d[0]&&(d.unshift(),d[0]="-"+d[0]),d}var h=a("../../constants/numerical"),i=h.ONEAVGYEAR,j=h.ONEAVGMONTH,k=h.ONEDAY,l=h.ONEHOUR,m=h.ONEMIN,n=h.ONESEC,o=a("../../plots/cartesian/axes").tickIncrement;b.exports=function(a,b,c,e,f){var g,h,j=-1.1*b,l=-.1*b,m=a-l,n=c[0],p=c[1],q=Math.min(d(n+l,n+m,e,f),d(p+l,p+m,e,f)),r=Math.min(d(n+j,n+l,e,f),d(p+j,p+l,e,f));if(q>r&&r<Math.abs(p-n)/4e3?(g=q,h=!1):(g=Math.min(q,r),h=!0),"date"===e.type&&g>k){var s=g===i?1:6,t=g===i?"M12":"M1";return function(b,c){var d=e.c2d(b,i,f),g=d.indexOf("-",s);g>0&&(d=d.substr(0,g));var j=e.d2c(d,0,f);if(j<b){var k=o(j,t,!1,f);(j+k)/2<b+a&&(j=k)}return c&&h?o(j,t,!0,f):j}}return function(b,c){var d=g*Math.round(b/g);return d+g/10<b&&d+.9*g<b+a&&(d+=g),c&&h&&(d-=g),d}}},{"../../constants/numerical":695,"../../plots/cartesian/axes":767}],1023:[function(a,b,c){"use strict";function d(a,b,c,i,j){function k(a,b,c){b[a+"Found"]?(b[a]=z(b[a]),null===b[a]&&(b[a]=c[a])):(q[a]=b[a]=c[a],f.nestedProperty(m[0],s+"."+a).set(c[a]))}var l,m,n,o,p,q,r,s=i+"bins",t=a._fullLayout,u=b["_"+i+"bingroup"],v=t._histogramBinOpts[u],w="overlay"===t.barmode,x=function(a){return c.r2c(a,0,o)},y=function(a){return c.c2r(a,0,o)},z="date"===c.type?function(a){return a||0===a?f.cleanDate(a,null,o):null}:function(a){return e(a)?Number(a):null};if(b["_"+i+"autoBinFinished"])delete b["_"+i+"autoBinFinished"];else{m=v.traces;var A=[],B=!0,C=!1,D=!1;for(l=0;l<m.length;l++)if((n=m[l]).visible){var E=v.dirs[l];p=n["_"+E+"pos0"]=c.makeCalcdata(n,E),A=f.concat(A,p),delete n["_"+i+"autoBinFinished"],!0===b.visible&&(B?B=!1:(delete n._autoBin,n["_"+i+"autoBinFinished"]=1),g.traceIs(n,"2dMap")&&(C=!0),"histogram2dcontour"===n.type&&(D=!0))}o=m[0][i+"calendar"];var F=h.autoBin(A,c,v.nbins,C,o,v.sizeFound&&v.size),G=m[0]._autoBin={};if(q=G[v.dirs[0]]={},D&&(v.size||(F.start=y(h.tickIncrement(x(F.start),F.size,!0,o))),void 0===v.end&&(F.end=y(h.tickIncrement(x(F.end),F.size,!1,o)))),w&&!g.traceIs(b,"2dMap")&&0===F._dataSpan&&"category"!==c.type&&"multicategory"!==c.type){if(j)return[F,p,!0];F=function(a,b,c,e,g){var h,i,j,k=a._fullLayout,l=function(a,b){for(var c=b.xaxis,d=b.yaxis,e=b.orientation,f=[],g=a._fullData,h=0;h<g.length;h++){var i=g[h];"histogram"===i.type&&!0===i.visible&&i.orientation===e&&i.xaxis===c&&i.yaxis===d&&f.push(i)}return f}(a,b),m=!1,n=1/0,o=[b];for(h=0;h<l.length;h++)if((i=l[h])===b)m=!0;else if(m){var p=d(a,i,c,e,!0),q=p[0],r=p[2];i["_"+e+"autoBinFinished"]=1,i["_"+e+"pos0"]=p[1],r?o.push(i):n=Math.min(n,q.size)}else j=k._histogramBinOpts[i["_"+e+"bingroup"]],n=Math.min(n,j.size||i[g].size);var s=new Array(o.length);for(h=0;h<o.length;h++)for(var t=o[h]["_"+e+"pos0"],u=0;u<t.length;u++)if(void 0!==t[u]){s[h]=t[u];break}for(isFinite(n)||(n=f.distinctVals(s).minDiff),h=0;h<o.length;h++){var v=(i=o[h])[e+"calendar"],w={start:c.c2r(s[h]-n/2,0,v),end:c.c2r(s[h]+n/2,0,v),size:n};i._input[g]=i[g]=w,(j=k._histogramBinOpts[i["_"+e+"bingroup"]])&&f.extendFlat(j,w)}return b[g]}(a,b,c,i,s)}(r=n.cumulative||{}).enabled&&"include"!==r.currentbin&&("decreasing"===r.direction?F.start=y(h.tickIncrement(x(F.start),F.size,!0,o)):F.end=y(h.tickIncrement(x(F.end),F.size,!1,o))),v.size=F.size,v.sizeFound||(q.size=F.size,f.nestedProperty(m[0],s+".size").set(F.size)),k("start",v,F),k("end",v,F)}p=b["_"+i+"pos0"],delete b["_"+i+"pos0"];var H=b._input[s]||{},I=f.extendFlat({},v),J=v.start,K=c.r2l(H.start),L=void 0!==K;if((v.startFound||L)&&K!==c.r2l(J)){var M=L?K:f.aggNums(Math.min,null,p),N={type:"category"===c.type||"multicategory"===c.type?"linear":c.type,r2l:c.r2l,dtick:v.size,tick0:J,calendar:o,range:[M,h.tickIncrement(M,v.size,!1,o)].map(c.l2r)},O=h.tickFirst(N);O>c.r2l(M)&&(O=h.tickIncrement(O,v.size,!0,o)),I.start=c.l2r(O),L||f.nestedProperty(b,s+".start").set(I.start)}var P=v.end,Q=c.r2l(H.end),R=void 0!==Q;if((v.endFound||R)&&Q!==c.r2l(P)){var S=R?Q:f.aggNums(Math.max,null,p);I.end=c.l2r(S),R||f.nestedProperty(b,s+".start").set(I.end)}var T="autobin"+i;return!1===b._input[T]&&(b._input[s]=f.extendFlat({},b[s]||{}),delete b._input[T],delete b[T]),[I,p]}var e=a("fast-isnumeric"),f=a("../../lib"),g=a("../../registry"),h=a("../../plots/cartesian/axes"),i=a("../bar/arrays_to_calcdata"),j=a("./bin_functions"),k=a("./norm_functions"),l=a("./average"),m=a("./bin_label_vals");b.exports={calc:function(a,b){var c,g,n,o,p=[],q=[],r=h.getFromId(a,"h"===b.orientation?b.yaxis:b.xaxis),s="h"===b.orientation?"y":"x",t={x:"y",y:"x"}[s],u=b[s+"calendar"],v=b.cumulative,w=d(a,b,r,s),x=w[0],y=w[1],z="string"==typeof x.size,A=[],B=z?A:x,C=[],D=[],E=[],F=0,G=b.histnorm,H=b.histfunc,I=-1!==G.indexOf("density");v.enabled&&I&&(G=G.replace(/ ?density$/,""),I=!1);var J,K="max"===H||"min"===H?null:0,L=j.count,M=k[G],N=!1,O=function(a){return r.r2c(a,0,u)};for(f.isArrayOrTypedArray(b[t])&&"count"!==H&&(J=b[t],N="avg"===H,L=j[H]),c=O(x.start),n=O(x.end)+(c-h.tickIncrement(c,x.size,!1,u))/1e6;c<n&&p.length<1e6&&(g=h.tickIncrement(c,x.size,!1,u),p.push((c+g)/2),q.push(K),E.push([]),A.push(c),I&&C.push(1/(g-c)),N&&D.push(0),!(g<=c));)c=g;A.push(c),z||"date"!==r.type||(B={start:O(B.start),end:O(B.end),size:B.size});var P,Q=q.length,R=!0,S=1/0,T=1/0,U={};for(c=0;c<y.length;c++){var V=y[c];(o=f.findBin(V,B))>=0&&o<Q&&(F+=L(o,c,q,J,D),R&&E[o].length&&V!==y[E[o][0]]&&(R=!1),E[o].push(c),U[c]=o,S=Math.min(S,V-A[o]),T=Math.min(T,A[o+1]-V))}R||(P=m(S,T,A,r,u)),N&&(F=l(q,D)),M&&M(q,F,C),v.enabled&&function(a,b,c){function d(b){h=a[b],a[b]/=2}function e(b){g=a[b],a[b]=h+g/2,h+=g}var f,g,h;if("half"===c)if("increasing"===b)for(d(0),f=1;f<a.length;f++)e(f);else for(d(a.length-1),f=a.length-2;f>=0;f--)e(f);else if("increasing"===b){for(f=1;f<a.length;f++)a[f]+=a[f-1];"exclude"===c&&(a.unshift(0),a.pop())}else{for(f=a.length-2;f>=0;f--)a[f]+=a[f+1];"exclude"===c&&(a.push(0),a.shift())}}(q,v.direction,v.currentbin);var W=Math.min(p.length,q.length),X=[],Y=0,Z=W-1;for(c=0;c<W;c++)if(q[c]){Y=c;break}for(c=W-1;c>=Y;c--)if(q[c]){Z=c;break}for(c=Y;c<=Z;c++)if(e(p[c])&&e(q[c])){var $={p:p[c],s:q[c],b:0};v.enabled||($.pts=E[c],R?$.ph0=$.ph1=E[c].length?y[E[c][0]]:p[c]:($.ph0=P(A[c]),$.ph1=P(A[c+1],!0))),X.push($)}return 1===X.length&&(X[0].width1=h.tickIncrement(X[0].p,x.size,!1,u)-X[0].p),i(X,b),f.isArrayOrTypedArray(b.selectedpoints)&&f.tagSelected(X,b,U),X},calcAllAutoBins:d}},{"../../lib":719,"../../plots/cartesian/axes":767,"../../registry":848,"../bar/arrays_to_calcdata":857,"./average":1019,"./bin_functions":1021,"./bin_label_vals":1022,"./norm_functions":1030,"fast-isnumeric":226}],1024:[function(a,b,c){"use strict";b.exports={eventDataKeys:["binNumber"]}},{}],1025:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axis_ids"),f=a("../../registry").traceIs,g=a("../bar/defaults").handleGroupingDefaults,h=d.nestedProperty,i=e.getAxisGroup,j=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],k=["x","y"];b.exports=function(a,b){function c(a,b){return d.coerce(n._input,n,n._module.attributes,a,b)}function l(a){return"v"===a.orientation?"x":"y"}function m(a,c,f){var g=a.uid+"__"+f;c||(c=g);var h=function(a,c){return e.getFromTrace({_fullLayout:b},a,c).type}(a,f),i=a[f+"calendar"],j=u[c],k=!0;j&&(h===j.axType&&i===j.calendar?(k=!1,j.traces.push(a),j.dirs.push(f)):(c=g,h!==j.axType&&d.warn(["Attempted to group the bins of trace",a.index,"set on a","type:"+h,"axis","with bins on","type:"+j.axType,"axis."].join(" ")),i!==j.calendar&&d.warn(["Attempted to group the bins of trace",a.index,"set with a",i,"calendar","with bins",j.calendar?"on a "+j.calendar+" calendar":"w/o a set calendar"].join(" ")))),k&&(u[c]={traces:[a],dirs:[f],axType:h,calendar:a[f+"calendar"]||""}),a["_"+f+"bingroup"]=c}var n,o,p,q,r,s,t,u=b._histogramBinOpts={},v=[],w={},x=[];for(r=0;r<a.length;r++)n=a[r],f(n,"histogram")&&(v.push(n),delete n._xautoBinFinished,delete n._yautoBinFinished,f(n,"2dMap")||g(n._input,n,b,c));var y=b._alignmentOpts||{};for(r=0;r<v.length;r++){if(n=v[r],p="",!f(n,"2dMap")){if(q=l(n),"group"===b.barmode&&n.alignmentgroup){var z=n[q+"axis"],A=i(b,z)+n.orientation;(y[A]||{})[n.alignmentgroup]&&(p=A)}p||"overlay"===b.barmode||(p=i(b,n.xaxis)+i(b,n.yaxis)+l(n))}p?(w[p]||(w[p]=[]),w[p].push(n)):x.push(n)}for(p in w)if(1!==(o=w[p]).length){var B=!1;for(r=0;r<o.length;r++){n=o[r],B=c("bingroup");break}for(p=B||p,r=0;r<o.length;r++){var C=(n=o[r])._input.bingroup;C&&C!==p&&d.warn(["Trace",n.index,"must match","within bingroup",p+".","Ignoring its bingroup:",C,"setting."].join(" ")),n.bingroup=p,m(n,p,l(n))}}else x.push(o[0]);for(r=0;r<x.length;r++){n=x[r];var D=c("bingroup");if(f(n,"2dMap"))for(t=0;t<2;t++){var E=c((q=k[t])+"bingroup",D?D+"__"+q:null);m(n,E,q)}else m(n,D,l(n))}for(p in u){var F=u[p];for(o=F.traces,s=0;s<j.length;s++){var G,H,I=j[s],J=I.name;if("nbins"!==J||!F.sizeFound){for(r=0;r<o.length;r++){if(n=o[r],q=F.dirs[r],G=I.aStr[q],void 0!==h(n._input,G).get()){F[J]=c(G),F[J+"Found"]=!0;break}(H=(n._autoBin||{})[q]||{})[J]&&h(n,G).set(H[J])}if("start"===J||"end"===J)for(;r<o.length;r++)(n=o[r])["_"+q+"bingroup"]&&c(G,(H=(n._autoBin||{})[q]||{})[J]);"nbins"!==J||F.sizeFound||F.nbinsFound||(n=o[0],F[J]=c(G))}}}}},{"../../lib":719,"../../plots/cartesian/axis_ids":770,"../../registry":848,"../bar/defaults":862}],1026:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("../../components/color"),g=a("../bar/style_defaults"),h=a("./attributes");b.exports=function(a,b,c,i){function j(c,d){return e.coerce(a,b,h,c,d)}var k=j("x"),l=j("y");j("cumulative.enabled")&&(j("cumulative.direction"),j("cumulative.currentbin")),j("text"),j("hovertext"),j("hovertemplate");var m=j("orientation",l&&!k?"h":"v"),n="v"===m?"x":"y",o="v"===m?"y":"x",p=k&&l?Math.min(e.minRowLength(k)&&e.minRowLength(l)):e.minRowLength(b[n]||[]);if(p){b._length=p,d.getComponentMethod("calendars","handleTraceDefaults")(a,b,["x","y"],i),b[o]&&j("histfunc"),j("histnorm"),j("autobin"+n),g(a,b,j,c,i),e.coerceSelectionMarkerOpacity(b,j);var q=(b.marker.line||{}).color,r=d.getComponentMethod("errorbars","supplyDefaults");r(a,b,q||f.defaultLine,{axis:"y"}),r(a,b,q||f.defaultLine,{axis:"x",inherit:"y"})}else b.visible=!1}},{"../../components/color":594,"../../lib":719,"../../registry":848,"../bar/style_defaults":872,"./attributes":1018}],1027:[function(a,b,c){"use strict";b.exports=function(a,b,c,d,e){if(a.x="xVal"in b?b.xVal:b.x,a.y="yVal"in b?b.yVal:b.y,"zLabelVal"in b&&(a.z=b.zLabelVal),b.xa&&(a.xaxis=b.xa),b.ya&&(a.yaxis=b.ya),!(c.cumulative||{}).enabled){var f,g=Array.isArray(e)?d[0].pts[e[0]][e[1]]:d[e].pts;if(a.pointNumbers=g,a.binNumber=a.pointNumber,delete a.pointNumber,delete a.pointIndex,c._indexToPoints){f=[];for(var h=0;h<g.length;h++)f=f.concat(c._indexToPoints[g[h]])}else f=g;a.pointIndices=f}return a}},{}],1028:[function(a,b,c){"use strict";var d=a("../bar/hover").hoverPoints,e=a("../../plots/cartesian/axes").hoverLabelText;b.exports=function(a,b,c,f){var g=d(a,b,c,f);if(g){var h=(a=g[0]).cd[a.index],i=a.cd[0].trace;if(!i.cumulative.enabled){var j="h"===i.orientation?"y":"x";a[j+"Label"]=e(a[j+"a"],h.ph0,h.ph1)}return i.hovermplate&&(a.hovertemplate=i.hovertemplate),g}}},{"../../plots/cartesian/axes":767,"../bar/hover":864}],1029:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("../bar/layout_attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("./cross_trace_defaults"),supplyLayoutDefaults:a("../bar/layout_defaults"),calc:a("./calc").calc,crossTraceCalc:a("../bar/cross_trace_calc").crossTraceCalc,plot:a("../bar/plot").plot,layerName:"barlayer",style:a("../bar/style").style,styleOnSelect:a("../bar/style").styleOnSelect,colorbar:a("../scatter/marker_colorbar"),hoverPoints:a("./hover"),selectPoints:a("../bar/select"),eventData:a("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:a("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":778,"../bar/cross_trace_calc":861,"../bar/layout_attributes":866,"../bar/layout_defaults":867,"../bar/plot":868,"../bar/select":869,"../bar/style":871,"../scatter/marker_colorbar":1128,"./attributes":1018,"./calc":1023,"./cross_trace_defaults":1025,"./defaults":1026,"./event_data":1027,"./hover":1028}],1030:[function(a,b,c){"use strict";b.exports={percent:function(a,b){for(var c=a.length,d=100/b,e=0;e<c;e++)a[e]*=d},probability:function(a,b){for(var c=a.length,d=0;d<c;d++)a[d]/=b},density:function(a,b,c,d){var e=a.length;d=d||1;for(var f=0;f<e;f++)a[f]*=c[f]*d},"probability density":function(a,b,c,d){var e=a.length;d&&(b/=d);for(var f=0;f<e;f++)a[f]*=c[f]/b}}},{}],1031:[function(a,b,c){"use strict";var d=a("../histogram/attributes"),e=a("../histogram/bin_attributes"),f=a("../heatmap/attributes"),g=a("../../plots/template_attributes").hovertemplateAttrs,h=a("../../components/colorscale/attributes"),i=a("../../lib/extend").extendFlat;b.exports=i({x:d.x,y:d.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:d.histnorm,histfunc:d.histfunc,nbinsx:d.nbinsx,xbins:e("x"),nbinsy:d.nbinsy,ybins:e("y"),autobinx:d.autobinx,autobiny:d.autobiny,bingroup:i({},d.bingroup,{}),xbingroup:i({},d.bingroup,{}),ybingroup:i({},d.bingroup,{}),xgap:f.xgap,ygap:f.ygap,zsmooth:f.zsmooth,zhoverformat:f.zhoverformat,hovertemplate:g({},{keys:"z"})},h("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/template_attributes":843,"../heatmap/attributes":1e3,"../histogram/attributes":1018,"../histogram/bin_attributes":1020}],1032:[function(a,b,c){"use strict";function d(a,b,c,d){var e,f=new Array(a);if(d)for(e=0;e<a;e++)f[e]=1/(b[e+1]-b[e]);else{var g=1/c;for(e=0;e<a;e++)f[e]=g}return f}function e(a,b){return{start:a(b.start),end:a(b.end),size:b.size}}function f(a,b,c,d,e,f){var g,h=a.length-1,i=new Array(h),j=l(c,d,a,e,f);for(g=0;g<h;g++){var k=(b||[])[g];i[g]=void 0===k?[j(a[g]),j(a[g+1],!0)]:[k,k]}return i}var g=a("../../lib"),h=a("../../plots/cartesian/axes"),i=a("../histogram/bin_functions"),j=a("../histogram/norm_functions"),k=a("../histogram/average"),l=a("../histogram/bin_label_vals"),m=a("../histogram/calc").calcAllAutoBins;b.exports=function(a,b){var c,l,n,o,p=h.getFromId(a,b.xaxis),q=h.getFromId(a,b.yaxis),r=b.xcalendar,s=b.ycalendar,t=function(a){return p.r2c(a,0,r)},u=function(a){return q.r2c(a,0,s)},v=m(a,b,p,"x"),w=v[0],x=v[1],y=m(a,b,q,"y"),z=y[0],A=y[1],B=b._length;x.length>B&&x.splice(B,x.length-B),A.length>B&&A.splice(B,A.length-B);var C=[],D=[],E=[],F="string"==typeof w.size,G="string"==typeof z.size,H=[],I=[],J=F?H:w,K=G?I:z,L=0,M=[],N=[],O=b.histnorm,P=b.histfunc,Q=-1!==O.indexOf("density"),R="max"===P||"min"===P?null:0,S=i.count,T=j[O],U=!1,V=[],W=[],X="z"in b?b.z:"marker"in b&&Array.isArray(b.marker.color)?b.marker.color:"";X&&"count"!==P&&(U="avg"===P,S=i[P]);var Y=w.size,Z=t(w.start),$=t(w.end)+(Z-h.tickIncrement(Z,Y,!1,r))/1e6;for(c=Z;c<$;c=h.tickIncrement(c,Y,!1,r))D.push(R),H.push(c),U&&E.push(0);H.push(c);var _,aa=D.length,ba=(c-Z)/aa,ca=(_=Z+ba/2,p.c2r(_,0,r)),da=z.size,ea=u(z.start),fa=u(z.end)+(ea-h.tickIncrement(ea,da,!1,s))/1e6;for(c=ea;c<fa;c=h.tickIncrement(c,da,!1,s)){C.push(D.slice()),I.push(c);var ga=new Array(aa);for(l=0;l<aa;l++)ga[l]=[];N.push(ga),U&&M.push(E.slice())}I.push(c);var ha=C.length,ia=(c-ea)/ha,ja=function(a){return q.c2r(a,0,s)}(ea+ia/2);Q&&(V=d(D.length,J,ba,F),W=d(C.length,K,ia,G)),F||"date"!==p.type||(J=e(t,J)),G||"date"!==q.type||(K=e(u,K));var ka=!0,la=!0,ma=new Array(aa),na=new Array(ha),oa=1/0,pa=1/0,qa=1/0,ra=1/0;for(c=0;c<B;c++){var sa=x[c],ta=A[c];n=g.findBin(sa,J),o=g.findBin(ta,K),n>=0&&n<aa&&o>=0&&o<ha&&(L+=S(n,c,C[o],X,M[o]),N[o][n].push(c),ka&&(void 0===ma[n]?ma[n]=sa:ma[n]!==sa&&(ka=!1)),la&&(void 0===na[o]?na[o]=ta:na[o]!==ta&&(la=!1)),oa=Math.min(oa,sa-H[n]),pa=Math.min(pa,H[n+1]-sa),qa=Math.min(qa,ta-I[o]),ra=Math.min(ra,I[o+1]-ta))}if(U)for(o=0;o<ha;o++)L+=k(C[o],M[o]);if(T)for(o=0;o<ha;o++)T(C[o],L,V,W[o]);return{x:x,xRanges:f(H,ka&&ma,oa,pa,p,r),x0:ca,dx:ba,y:A,yRanges:f(I,la&&na,qa,ra,q,s),y0:ja,dy:ia,z:C,pts:N}}},{"../../lib":719,"../../plots/cartesian/axes":767,"../histogram/average":1019,"../histogram/bin_functions":1021,"../histogram/bin_label_vals":1022,"../histogram/calc":1023,"../histogram/norm_functions":1030}],1033:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./sample_defaults"),f=a("../heatmap/style_defaults"),g=a("../../components/colorscale/defaults"),h=a("./attributes");b.exports=function(a,b,c,i){function j(c,e){return d.coerce(a,b,h,c,e)}e(a,b,j,i),!1!==b.visible&&(f(a,b,j,i),g(a,b,i,j,{prefix:"",cLetter:"z"}),j("hovertemplate"))}},{"../../components/colorscale/defaults":604,"../../lib":719,"../heatmap/style_defaults":1013,"./attributes":1031,"./sample_defaults":1036}],1034:[function(a,b,c){"use strict";var d=a("../heatmap/hover"),e=a("../../plots/cartesian/axes").hoverLabelText;b.exports=function(a,b,c,f,g,h){var i=d(a,b,c,f,g,h);if(i){var j=(a=i[0]).index,k=j[0],l=j[1],m=a.cd[0],n=m.xRanges[l],o=m.yRanges[k];return a.xLabel=e(a.xa,n[0],n[1]),a.yLabel=e(a.ya,o[0],o[1]),i}}},{"../../plots/cartesian/axes":767,"../heatmap/hover":1007}],1035:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("../histogram/cross_trace_defaults"),calc:a("../heatmap/calc"),plot:a("../heatmap/plot"),layerName:"heatmaplayer",colorbar:a("../heatmap/colorbar"),style:a("../heatmap/style"),hoverPoints:a("./hover"),eventData:a("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram"],meta:{}}},{"../../plots/cartesian":778,"../heatmap/calc":1001,"../heatmap/colorbar":1003,"../heatmap/plot":1011,"../heatmap/style":1012,"../histogram/cross_trace_defaults":1025,"../histogram/event_data":1027,"./attributes":1031,"./defaults":1033,"./hover":1034}],1036:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib");b.exports=function(a,b,c,f){var g=c("x"),h=c("y"),i=e.minRowLength(g),j=e.minRowLength(h);i&&j?(b._length=Math.min(i,j),d.getComponentMethod("calendars","handleTraceDefaults")(a,b,["x","y"],f),(c("z")||c("marker.color"))&&c("histfunc"),c("histnorm"),c("autobinx"),c("autobiny")):b.visible=!1}},{"../../lib":719,"../../registry":848}],1037:[function(a,b,c){"use strict";var d=a("../histogram2d/attributes"),e=a("../contour/attributes"),f=a("../../components/colorscale/attributes"),g=a("../../lib/extend").extendFlat;b.exports=g({x:d.x,y:d.y,z:d.z,marker:d.marker,histnorm:d.histnorm,histfunc:d.histfunc,nbinsx:d.nbinsx,xbins:d.xbins,nbinsy:d.nbinsy,ybins:d.ybins,autobinx:d.autobinx,autobiny:d.autobiny,bingroup:d.bingroup,xbingroup:d.xbingroup,ybingroup:d.ybingroup,autocontour:e.autocontour,ncontours:e.ncontours,contours:e.contours,line:{color:e.line.color,width:g({},e.line.width,{dflt:.5}),dash:e.line.dash,smoothing:e.line.smoothing,editType:"plot"},zhoverformat:d.zhoverformat,hovertemplate:d.hovertemplate},f("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../contour/attributes":943,"../histogram2d/attributes":1031}],1038:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../histogram2d/sample_defaults"),f=a("../contour/contours_defaults"),g=a("../contour/style_defaults"),h=a("./attributes");b.exports=function(a,b,c,i){function j(c,e){return d.coerce(a,b,h,c,e)}e(a,b,j,i),!1!==b.visible&&(f(a,b,j,function(c){return d.coerce2(a,b,h,c)}),g(a,b,j,i),j("hovertemplate"))}},{"../../lib":719,"../contour/contours_defaults":950,"../contour/style_defaults":964,"../histogram2d/sample_defaults":1036,"./attributes":1037}],1039:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("../histogram/cross_trace_defaults"),calc:a("../contour/calc"),plot:a("../contour/plot").plot,layerName:"contourlayer",style:a("../contour/style"),colorbar:a("../contour/colorbar"),hoverPoints:a("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":778,"../contour/calc":944,"../contour/colorbar":946,"../contour/hover":956,"../contour/plot":961,"../contour/style":963,"../histogram/cross_trace_defaults":1025,"./attributes":1037,"./defaults":1038}],1040:[function(a,b,c){"use strict";var d=a("../../lib/extend").extendFlat,e=a("../../lib/extend").extendDeep,f=a("../../plot_api/edit_types").overrideAll,g=a("../../plots/font_attributes"),h=a("../../components/color/attributes"),i=a("../../plots/domain").attributes,j=a("../../plots/cartesian/layout_attributes"),k=a("../../plot_api/plot_template").templatedArray,l=a("../../constants/delta.js"),m=(a("../../constants/docs").FORMAT_LINK,g({editType:"plot",colorEditType:"plot"})),n={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:h.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},o={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},p=k("step",e({},n,{range:o}));b.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:i({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:d({},m,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot"},font:d({},m,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot"},increasing:{symbol:{valType:"string",dflt:l.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",
dflt:l.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:l.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:l.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:d({},m,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:e({},n,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:h.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:f({range:o,visible:d({},j.visible,{dflt:!0}),tickmode:j.tickmode,nticks:j.nticks,tick0:j.tick0,dtick:j.dtick,tickvals:j.tickvals,ticktext:j.ticktext,ticks:d({},j.ticks,{dflt:"outside"}),ticklen:j.ticklen,tickwidth:j.tickwidth,tickcolor:j.tickcolor,showticklabels:j.showticklabels,tickfont:g({}),tickangle:j.tickangle,tickformat:j.tickformat,tickformatstops:j.tickformatstops,tickprefix:j.tickprefix,showtickprefix:j.showtickprefix,ticksuffix:j.ticksuffix,showticksuffix:j.showticksuffix,separatethousands:j.separatethousands,exponentformat:j.exponentformat,showexponent:j.showexponent,editType:"plot"},"plot"),steps:p,threshold:{line:{color:d({},n.line.color,{}),width:d({},n.line.width,{dflt:1}),editType:"plot"},thickness:d({},n.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":593,"../../constants/delta.js":689,"../../constants/docs":690,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../../plots/cartesian/layout_attributes":779,"../../plots/domain":792,"../../plots/font_attributes":793}],1041:[function(a,b,c){"use strict";var d=a("../../plots/plots");c.name="indicator",c.plot=function(a,b,e,f){d.plotBasePlot(c.name,a,b,e,f)},c.clean=function(a,b,e,f){d.cleanBasePlot(c.name,a,b,e,f)}},{"../../plots/plots":828}],1042:[function(a,b,c){"use strict";b.exports={calc:function(a,b){var c=[],d=b.value;"number"!=typeof b._lastValue&&(b._lastValue=b.value);var e=b._lastValue,f=e;return b._hasDelta&&"number"==typeof b.delta.reference&&(f=b.delta.reference),c[0]={y:d,lastY:e,delta:d-f,relativeDelta:(d-f)/f},c}}},{}],1043:[function(a,b,c){"use strict";b.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],1044:[function(a,b,c){"use strict";function d(a,b){function c(c,d){return e.coerce(a,b,f.gauge.steps,c,d)}c("color"),c("line.color"),c("line.width"),c("range"),c("thickness")}var e=a("../../lib"),f=a("./attributes"),g=a("../../plots/domain").defaults,h=a("../../plot_api/plot_template"),i=a("../../plots/array_container_defaults"),j=a("./constants.js"),k=a("../../plots/cartesian/tick_value_defaults"),l=a("../../plots/cartesian/tick_mark_defaults"),m=a("../../plots/cartesian/tick_label_defaults");b.exports={supplyDefaults:function(a,b,c,n){function o(c,d){return e.coerce(a,b,f,c,d)}function p(a,b){return e.coerce(u,v,f.gauge,a,b)}function q(a,b){return e.coerce(w,x,f.gauge.axis,a,b)}g(b,n,o),o("mode"),b._hasNumber=-1!==b.mode.indexOf("number"),b._hasDelta=-1!==b.mode.indexOf("delta"),b._hasGauge=-1!==b.mode.indexOf("gauge");var r=o("value");b._range=[0,"number"==typeof r?1.5*r:1];var s,t,u,v,w,x,y=new Array(2);if(b._hasNumber&&(o("number.valueformat"),o("number.font.color",n.font.color),o("number.font.family",n.font.family),o("number.font.size"),void 0===b.number.font.size&&(b.number.font.size=j.defaultNumberFontSize,y[0]=!0),o("number.prefix"),o("number.suffix"),s=b.number.font.size),b._hasDelta&&(o("delta.font.color",n.font.color),o("delta.font.family",n.font.family),o("delta.font.size"),void 0===b.delta.font.size&&(b.delta.font.size=(b._hasNumber?.5:1)*(s||j.defaultNumberFontSize),y[1]=!0),o("delta.reference",b.value),o("delta.relative"),o("delta.valueformat",b.delta.relative?"2%":""),o("delta.increasing.symbol"),o("delta.increasing.color"),o("delta.decreasing.symbol"),o("delta.decreasing.color"),o("delta.position"),t=b.delta.font.size),b._scaleNumbers=(!b._hasNumber||y[0])&&(!b._hasDelta||y[1])||!1,o("title.font.color",n.font.color),o("title.font.family",n.font.family),o("title.font.size",.25*(s||t||j.defaultNumberFontSize)),o("title.text"),b._hasGauge){(u=a.gauge)||(u={}),v=h.newContainer(b,"gauge"),p("shape"),(b._isBullet="bullet"===b.gauge.shape)||o("title.align","center"),(b._isAngular="angular"===b.gauge.shape)||o("align","center"),p("bgcolor",n.paper_bgcolor),p("borderwidth"),p("bordercolor"),p("bar.color"),p("bar.line.color"),p("bar.line.width"),p("bar.thickness",j.valueThickness*("bullet"===b.gauge.shape?.5:1)),i(u,v,{name:"steps",handleItemDefaults:d}),p("threshold.value"),p("threshold.thickness"),p("threshold.line.width"),p("threshold.line.color"),w={},u&&(w=u.axis||{}),x=h.newContainer(v,"axis"),q("visible"),b._range=q("range",b._range);var z={outerTicks:!0};k(w,x,q,"linear"),m(w,x,q,"linear",z),l(w,x,q,z)}else o("title.align","center"),o("align","center"),b._isAngular=b._isBullet=!1;b._length=null}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../plots/array_container_defaults":763,"../../plots/cartesian/tick_label_defaults":786,"../../plots/cartesian/tick_mark_defaults":787,"../../plots/cartesian/tick_value_defaults":788,"../../plots/domain":792,"./attributes":1040,"./constants.js":1043}],1045:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"indicator",basePlotModule:a("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:a("./attributes"),supplyDefaults:a("./defaults").supplyDefaults,calc:a("./calc").calc,plot:a("./plot"),meta:{}}},{"./attributes":1040,"./base_plot":1041,"./calc":1042,"./defaults":1044,"./plot":1046}],1046:[function(a,b,c){"use strict";function d(a){return a&&a.duration>0}function e(a){a.each(function(a){v.stroke(k.select(this),a.line.color)}).each(function(a){v.fill(k.select(this),a.color)}).style("stroke-width",function(a){return a.line.width})}function f(a,b,c){function d(a,b){return l.coerce(f,g,u,a,b)}var e=a._fullLayout,f=l.extendFlat({type:"linear",ticks:"outside",range:c,showline:!0},b),g={type:"linear",_id:"x"+b._id},h={letter:"x",font:e.font,noHover:!0,noTickson:!0};return s(f,g,d,h,e),t(f,g,d,h),g}function g(a,b){return"translate("+a+","+b+")"}function h(a,b,c){return[Math.min(b/a.width,c/a.height),a,b+"x"+c]}function i(a,b,c,d){var e=document.createElementNS("http://www.w3.org/2000/svg","text"),f=k.select(e);return f.text(a).attr("x",0).attr("y",0).attr("text-anchor",c).attr("data-unformatted",a).call(q.convertToTspans,d).call(o.font,b),o.bBox(f.node())}function j(a,b,c,d,e,f){var g="_cache"+b;a[g]&&a[g].key===e||(a[g]={key:e,value:c});var h=l.aggNums(f,null,[a[g].value,d],2);return a[g].value=h,h}var k=a("d3"),l=a("../../lib"),m=l.rad2deg,n=a("../../constants/alignment").MID_SHIFT,o=a("../../components/drawing"),p=a("./constants"),q=a("../../lib/svg_text_utils"),r=a("../../plots/cartesian/axes"),s=a("../../plots/cartesian/axis_defaults"),t=a("../../plots/cartesian/position_defaults"),u=a("../../plots/cartesian/layout_attributes"),v=a("../../components/color"),w={left:"start",center:"middle",right:"end"},x={left:0,center:.5,right:1},y=/[yzafpn\xb5mkMGTPEZY]/;b.exports=function(a,b,c,s){var t,u=a._fullLayout;d(c)&&s&&(t=s()),l.makeTraceGroups(u._indicatorlayer,b,"trace").each(function(b){var s,z,A,B,C,D=b[0].trace,E=k.select(this),F=D._hasGauge,G=D._isAngular,H=D._isBullet,I=D.domain,J={w:u._size.w*(I.x[1]-I.x[0]),h:u._size.h*(I.y[1]-I.y[0]),l:u._size.l+u._size.w*I.x[0],r:u._size.r+u._size.w*(1-I.x[1]),t:u._size.t+u._size.h*(1-I.y[1]),b:u._size.b+u._size.h*I.y[0]},K=J.l+J.w/2,L=J.t+J.h/2,M=Math.min(J.w/2,J.h),N=p.innerRadius*M,O=D.align||"center";if(z=L,F){if(G&&(s=K,z=L+M/2,A=function(a){return b=a,c=.9*N,d=Math.sqrt(b.width/2*(b.width/2)+b.height*b.height),[c/d,b,c];var b,c,d}),H){var P=p.bulletPadding,Q=1-p.bulletNumberDomainSize+P;s=J.l+(Q+(1-Q)*x[O])*J.w,A=function(a){return h(a,(p.bulletNumberDomainSize-P)*J.w,J.h)}}}else s=J.l+x[O]*J.w,A=function(a){return h(a,J.w,J.h)};!function(a,b,c,e){function h(b,c,d,e){if(!b.match("s")||d>=0==e>=0||c(d).slice(-1).match(y)||c(e).slice(-1).match(y))return c;var g=b.slice().replace("s","f").replace(/\d+/,function(a){return parseInt(a)-1}),h=f(a,{tickformat:g});return function(a){return Math.abs(a)<1?r.tickText(h,a).text:c(a)}}var m,n,p,s=c[0].trace,t=e.numbersX,u=e.numbersY,z=s.align||"center",A=w[z],B=e.transitionOpts,C=e.onComplete,D=l.ensureSingle(b,"g","numbers"),E=[];s._hasNumber&&E.push("number"),s._hasDelta&&(E.push("delta"),"left"===s.delta.position&&E.reverse());var F=D.selectAll("text").data(E);F.enter().append("text"),F.attr("text-anchor",function(){return A}).attr("class",function(a){return a}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),F.exit().remove();var G,H=s.mode+s.align;if(s._hasDelta&&(G=function(){function b(){p.text(l(j(c[0]),g)).call(v.fill,m(c[0])).call(q.convertToTspans,a)}var e=f(a,{tickformat:s.delta.valueformat},s._range);e.setScale(),r.prepTicks(e);var g=function(a){return r.tickText(e,a).text},j=function(a){return s.delta.relative?a.relativeDelta:a.delta},l=function(a,b){return 0===a||"number"!=typeof a||isNaN(a)?"-":(a>0?s.delta.increasing.symbol:s.delta.decreasing.symbol)+b(a)},m=function(a){return a.delta>=0?s.delta.increasing.color:s.delta.decreasing.color};void 0===s._deltaLastValue&&(s._deltaLastValue=j(c[0]));var p=D.select("text.delta");return p.call(o.font,s.delta.font).call(v.fill,m({delta:s._deltaLastValue})),d(B)?p.transition().duration(B.duration).ease(B.easing).tween("text",function(){var a=k.select(this),b=j(c[0]),d=s._deltaLastValue,e=h(s.delta.valueformat,g,d,b),f=k.interpolateNumber(d,b);return s._deltaLastValue=b,function(b){a.text(l(f(b),e)),a.call(v.fill,m({delta:f(b)}))}}).each("end",function(){b(),C&&C()}).each("interrupt",function(){b(),C&&C()}):b(),n=i(l(j(c[0]),g),s.delta.font,A,a),p}(),H+=s.delta.position+s.delta.font.size+s.delta.font.family+s.delta.valueformat,H+=s.delta.increasing.symbol+s.delta.decreasing.symbol,p=n),s._hasNumber&&(function(){function b(){var b="number"==typeof c[0].y?l+g(c[0].y)+j:"-";n.text(b).call(o.font,s.number.font).call(q.convertToTspans,a)}var e=f(a,{tickformat:s.number.valueformat},s._range);e.setScale(),r.prepTicks(e);var g=function(a){return r.tickText(e,a).text},j=s.number.suffix,l=s.number.prefix,n=D.select("text.number");d(B)?n.transition().duration(B.duration).ease(B.easing).each("end",function(){b(),C&&C()}).each("interrupt",function(){b(),C&&C()}).attrTween("text",function(){var a=k.select(this),b=k.interpolateNumber(c[0].lastY,c[0].y);s._lastValue=c[0].y;var d=h(s.number.valueformat,g,c[0].lastY,c[0].y);return function(c){a.text(l+d(b(c))+j)}}):b(),m=i(l+g(c[0].y)+j,s.number.font,A,a)}(),H+=s.number.font.size+s.number.font.family+s.number.valueformat+s.number.suffix+s.number.prefix,p=m),s._hasDelta&&s._hasNumber){var I,J,K=[(m.left+m.right)/2,(m.top+m.bottom)/2],L=[(n.left+n.right)/2,(n.top+n.bottom)/2],M=.75*s.delta.font.size;"left"===s.delta.position&&(I=j(s,"deltaPos",0,-1*(m.width*x[s.align]+n.width*(1-x[s.align])+M),H,Math.min),J=K[1]-L[1],p={width:m.width+n.width+M,height:Math.max(m.height,n.height),left:n.left+I,right:m.right,top:Math.min(m.top,n.top+J),bottom:Math.max(m.bottom,n.bottom+J)}),"right"===s.delta.position&&(I=j(s,"deltaPos",0,m.width*(1-x[s.align])+n.width*x[s.align]+M,H,Math.max),J=K[1]-L[1],p={width:m.width+n.width+M,height:Math.max(m.height,n.height),left:m.left,right:n.right+I,top:Math.min(m.top,n.top+J),bottom:Math.max(m.bottom,n.bottom+J)}),"bottom"===s.delta.position&&(I=null,J=n.height,p={width:Math.max(m.width,n.width),height:m.height+n.height,left:Math.min(m.left,n.left),right:Math.max(m.right,n.right),top:m.bottom-m.height,bottom:m.bottom+n.height}),"top"===s.delta.position&&(I=null,J=m.top,p={width:Math.max(m.width,n.width),height:m.height+n.height,left:Math.min(m.left,n.left),right:Math.max(m.right,n.right),top:m.bottom-m.height-n.height,bottom:m.bottom}),G.attr({dx:I,dy:J})}(s._hasNumber||s._hasDelta)&&D.attr("transform",function(){var a=e.numbersScaler(p);H+=a[2];var b,c=j(s,"numbersScale",1,a[0],H,Math.min);s._scaleNumbers||(c=1),b=s._isAngular?u-c*p.bottom:u-c*(p.top+p.bottom)/2,s._numbersTop=c*p.top+b;var d=p[z];"center"===z&&(d=(p.left+p.right)/2);var f=t-c*d;return g(f=j(s,"numbersTranslate",0,f,H,Math.max),b)+" scale("+c+")"})}(a,E,b,{numbersX:s,numbersY:z,numbersScaler:A,transitionOpts:c,onComplete:t}),F&&(B={range:D.gauge.axis.range,color:D.gauge.bgcolor,line:{color:D.gauge.bordercolor,width:0},thickness:1},C={range:D.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:D.gauge.bordercolor,width:D.gauge.borderwidth},thickness:1});var R=E.selectAll("g.angular").data(G?b:[]);R.exit().remove();var S=E.selectAll("g.angularaxis").data(G?b:[]);S.exit().remove(),G&&function(a,b,c,h){function i(a){var b=t.gauge.axis.range[0],c=t.gauge.axis.range[1],d=(a-b)/(c-b)*Math.PI-E;return d<-E?-E:d>E?E:d}function j(a){return k.svg.arc().innerRadius((w+v)/2-a/2*(v-w)).outerRadius((w+v)/2+a/2*(v-w)).startAngle(-E)}function l(a){a.attr("d",function(a){return j(a.thickness).startAngle(i(a.range[0])).endAngle(i(a.range[1]))()})}var o,p,q,s,t=c[0].trace,u=h.size,v=h.radius,w=h.innerRadius,x=h.gaugeBg,y=h.gaugeOutline,z=[u.l+u.w/2,u.t+u.h/2+v/2],A=h.gauge,B=h.layer,C=h.transitionOpts,D=h.onComplete,E=Math.PI/2;A.enter().append("g").classed("angular",!0),A.attr("transform",g(z[0],z[1])),B.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),B.selectAll("g.xangularaxistick,path,text").remove(),(o=f(a,t.gauge.axis)).type="linear",o.range=t.gauge.axis.range,o._id="xangularaxis",o.setScale();var F=function(a){return(o.range[0]-a.x)/(o.range[1]-o.range[0])*Math.PI+Math.PI},G={},H=r.makeLabelFns(o,0).labelStandoff;G.xFn=function(a){var b=F(a);return Math.cos(b)*H},G.yFn=function(a){var b=F(a),c=Math.sin(b)>0?.2:1;return-Math.sin(b)*(H+a.fontSize*c)+Math.abs(Math.cos(b))*(a.fontSize*n)},G.anchorFn=function(a){var b=F(a),c=Math.cos(b);return Math.abs(c)<.1?"middle":c>0?"start":"end"},G.heightFn=function(a,b,c){var d=F(a);return-.5*(1+Math.sin(d))*c};var I=function(a){return g(z[0]+v*Math.cos(a),z[1]-v*Math.sin(a))};if(q=function(a){return I(F(a))},p=r.calcTicks(o),s=r.getTickSigns(o)[2],o.visible){s="inside"===o.ticks?-1:1;var J=(o.linewidth||1)/2;r.drawTicks(a,o,{vals:p,layer:B,path:"M"+s*J+",0h"+s*o.ticklen,transFn:function(a){var b=F(a);return I(b)+"rotate("+-m(b)+")"}}),r.drawLabels(a,o,{vals:p,layer:B,transFn:q,labelFns:G})}var K=[x].concat(t.gauge.steps),L=A.selectAll("g.bg-arc").data(K);L.enter().append("g").classed("bg-arc",!0).append("path"),L.select("path").call(l).call(e),L.exit().remove();var M=j(t.gauge.bar.thickness),N=A.selectAll("g.value-arc").data([t.gauge.bar]);N.enter().append("g").classed("value-arc",!0).append("path");var O=N.select("path");d(C)?(O.transition().duration(C.duration).ease(C.easing).each("end",function(){D&&D()}).each("interrupt",function(){D&&D()}).attrTween("d",(P=M,Q=i(c[0].lastY),R=i(c[0].y),function(){var a=k.interpolate(Q,R);return function(b){return P.endAngle(a(b))()}})),t._lastValue=c[0].y):O.attr("d","number"==typeof c[0].y?M.endAngle(i(c[0].y)):"M0,0Z");var P,Q,R;O.call(e),N.exit().remove(),K=[];var S=t.gauge.threshold.value;S&&K.push({range:[S,S],color:t.gauge.threshold.color,line:{color:t.gauge.threshold.line.color,width:t.gauge.threshold.line.width},thickness:t.gauge.threshold.thickness});var T=A.selectAll("g.threshold-arc").data(K);T.enter().append("g").classed("threshold-arc",!0).append("path"),T.select("path").call(l).call(e),T.exit().remove();var U=A.selectAll("g.gauge-outline").data([y]);U.enter().append("g").classed("gauge-outline",!0).append("path"),U.select("path").call(l).call(e),U.exit().remove()}(a,0,b,{radius:M,innerRadius:N,gauge:R,layer:S,size:J,gaugeBg:B,gaugeOutline:C,transitionOpts:c,onComplete:t});var T=E.selectAll("g.bullet").data(H?b:[]);T.exit().remove();var U=E.selectAll("g.bulletaxis").data(H?b:[]);U.exit().remove(),H&&function(a,b,c,g){function h(a){a.attr("width",function(a){return Math.max(0,i.c2p(a.range[1])-i.c2p(a.range[0]))}).attr("x",function(a){return i.c2p(a.range[0])}).attr("y",function(a){return.5*(1-a.thickness)*z}).attr("height",function(a){return a.thickness*z})}var i,j,k,l,m,n=c[0].trace,o=g.gauge,q=g.layer,s=g.gaugeBg,t=g.gaugeOutline,u=g.size,w=n.domain,x=g.transitionOpts,y=g.onComplete;o.enter().append("g").classed("bullet",!0),o.attr("transform","translate("+u.l+", "+u.t+")"),q.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),q.selectAll("g.xbulletaxistick,path,text").remove();var z=u.h,A=n.gauge.bar.thickness*z,B=w.x[0],C=w.x[0]+(w.x[1]-w.x[0])*(n._hasNumber||n._hasDelta?1-p.bulletNumberDomainSize:1);(i=f(a,n.gauge.axis))._id="xbulletaxis",i.domain=[B,C],i.setScale(),j=r.calcTicks(i),k=r.makeTransFn(i),l=r.getTickSigns(i)[2],m=u.t+u.h,i.visible&&(r.drawTicks(a,i,{vals:"inside"===i.ticks?r.clipEnds(i,j):j,layer:q,path:r.makeTickPath(i,m,l),transFn:k}),r.drawLabels(a,i,{vals:j,layer:q,transFn:k,labelFns:r.makeLabelFns(i,m)}));var D=[s].concat(n.gauge.steps),E=o.selectAll("g.bg-bullet").data(D);E.enter().append("g").classed("bg-bullet",!0).append("rect"),E.select("rect").call(h).call(e),E.exit().remove();var F=o.selectAll("g.value-bullet").data([n.gauge.bar]);F.enter().append("g").classed("value-bullet",!0).append("rect"),F.select("rect").attr("height",A).attr("y",(z-A)/2).call(e),d(x)?F.select("rect").transition().duration(x.duration).ease(x.easing).each("end",function(){y&&y()}).each("interrupt",function(){y&&y()}).attr("width",Math.max(0,i.c2p(Math.min(n.gauge.axis.range[1],c[0].y)))):F.select("rect").attr("width","number"==typeof c[0].y?Math.max(0,i.c2p(Math.min(n.gauge.axis.range[1],c[0].y))):0),F.exit().remove();var G=c.filter(function(){return n.gauge.threshold.value}),H=o.selectAll("g.threshold-bullet").data(G);H.enter().append("g").classed("threshold-bullet",!0).append("line"),H.select("line").attr("x1",i.c2p(n.gauge.threshold.value)).attr("x2",i.c2p(n.gauge.threshold.value)).attr("y1",(1-n.gauge.threshold.thickness)/2*z).attr("y2",(1-(1-n.gauge.threshold.thickness)/2)*z).call(v.stroke,n.gauge.threshold.line.color).style("stroke-width",n.gauge.threshold.line.width),H.exit().remove();var I=o.selectAll("g.gauge-outline").data([t]);I.enter().append("g").classed("gauge-outline",!0).append("rect"),I.select("rect").call(h).call(e),I.exit().remove()}(a,0,b,{gauge:T,layer:U,size:J,gaugeBg:B,gaugeOutline:C,transitionOpts:c,onComplete:t});var V=E.selectAll("text.title").data(b);V.exit().remove(),V.enter().append("text").classed("title",!0),V.attr("text-anchor",function(){return H?w.right:w[D.title.align]}).text(D.title.text).call(o.font,D.title.font).call(q.convertToTspans,a),V.attr("transform",function(){var a,b=J.l+J.w*x[D.title.align],c=p.titlePadding,d=o.bBox(V.node());return F?(G&&(a=D.gauge.axis.visible?o.bBox(S.node()).top-c-d.bottom:J.t+J.h/2-M/2-d.bottom-c),H&&(a=z-(d.top+d.bottom)/2,b=J.l-p.bulletPadding*J.w)):a=D._numbersTop-c-d.bottom,g(b,a)})})}},{"../../components/color":594,"../../components/drawing":615,"../../constants/alignment":688,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"../../plots/cartesian/axis_defaults":769,"../../plots/cartesian/layout_attributes":779,"../../plots/cartesian/position_defaults":782,"./constants":1043,d3:164}],1047:[function(a,b,c){"use strict";var d=a("../../components/colorscale/attributes"),e=a("../../plots/template_attributes").hovertemplateAttrs,f=a("../mesh3d/attributes"),g=a("../../plots/attributes"),h=a("../../lib/extend").extendFlat,i=a("../../plot_api/edit_types").overrideAll,j=b.exports=i(h({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:e()},d("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:f.opacity,lightposition:f.lightposition,lighting:f.lighting,flatshading:f.flatshading,contour:f.contour,hoverinfo:h({},g.hoverinfo)}),"calc","nested");j.flatshading.dflt=!0,j.lighting.facenormalsepsilon.dflt=0,j.x.editType=j.y.editType=j.z.editType=j.value.editType="calc+clearAxisTypes",j.transforms=void 0},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../../plots/template_attributes":843,"../mesh3d/attributes":1052}],1048:[function(a,b,c){"use strict";var d=a("../../components/colorscale/calc");b.exports=function(a,b){b._len=Math.min(b.x.length,b.y.length,b.z.length,b.value.length);for(var c=1/0,e=-1/0,f=b.value.length,g=0;g<f;g++){var h=b.value[g];c=Math.min(c,h),e=Math.max(e,h)}b._minValues=c,b._maxValues=e,b._vMin=void 0===b.isomin||null===b.isomin?c:b.isomin,b._vMax=void 0===b.isomax||null===b.isomin?e:b.isomax,d(a,b,{vals:[b._vMin,b._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":602}],1049:[function(a,b,c){"use strict";function d(a){return h.distinctVals(a).vals}function e(a,b,c){this.scene=a,this.uid=c,this.mesh=b,this.name="",this.data=null,this.showContour=!1}function f(a){function b(a,b,c){return c+$*b+$*Z*a}function c(a,b,c){for(var d=M.length,e=I;e<d;e++)if(a===J[e]&&b===K[e]&&c===L[e])return e;return-1}function e(){I=H}function f(){J=[],K=[],L=[],M=[],H=0,e()}function g(a,b,c,d){return J.push(a),K.push(b),L.push(c),M.push(d),++H-1}function h(a,b,c){for(var d=[],e=0;e<a.length;e++)d[e]=a[e]*(1-c)+c*b[e];return d}function i(a){N=a}function j(a,b){return"all"===a||null===a||a.indexOf(b)>-1}function k(a,b){return null===a?b:a}function l(b,d,f){e();var i,j,l,m=[d],n=[f];if(N>=1)m=[d],n=[f];else if(N>0){var o=function(a,b){var c=a[0],d=a[1],e=a[2],f=function(a,b,c){for(var d=[],e=0;e<a.length;e++)d[e]=(a[e]+b[e]+c[e])/3;return d}(c,d,e),g=Math.sqrt(1-N),i=h(f,c,g),j=h(f,d,g),k=h(f,e,g),l=b[0],m=b[1],n=b[2];return{xyzv:[[c,d,j],[j,i,c],[d,e,k],[k,j,d],[e,c,i],[i,k,e]],abc:[[l,m,-1],[-1,-1,l],[m,n,-1],[-1,-1,m],[n,l,-1],[-1,-1,n]]}}(d,f);m=o.xyzv,n=o.abc}for(var p=0;p<m.length;p++){d=m[p],f=n[p];for(var q=[],r=0;r<3;r++){var s=d[r][0],t=d[r][1],u=d[r][2],v=d[r][3],w=f[r]>-1?f[r]:c(s,t,u);q[r]=w>-1?w:g(s,t,u,k(b,v))}i=q[0],j=q[1],l=q[2],a._i.push(i),a._j.push(j),a._k.push(l),++U}}function n(a,b,c,d){var e=a[3];e<c&&(e=c),e>d&&(e=d);for(var f=(a[3]-e)/(a[3]-b[3]+1e-9),g=[],h=0;h<4;h++)g[h]=(1-f)*a[h]+f*b[h];return g}function o(a,b,c){return a>=b&&a<=c}function p(a){var b=.001*(ca-ba);return a>=ba-b&&a<=ca+b}function q(b){for(var c=[],d=0;d<4;d++){var e=b[d];c.push([a.x[e],a.y[e],a.z[e],a.value[e]])}return c}function r(a,b,c,d,e,f){f||(f=1),c=[-1,-1,-1];var g=!1,h=[o(b[0][3],d,e),o(b[1][3],d,e),o(b[2][3],d,e)];if(!h[0]&&!h[1]&&!h[2])return!1;var i=function(a,b,c){return p(b[0][3])&&p(b[1][3])&&p(b[2][3])?(l(a,b,c),!0):f<da&&r(a,b,c,ba,ca,++f)};if(h[0]&&h[1]&&h[2])return i(a,b,c)||g;var j=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(f){if(h[f[0]]&&h[f[1]]&&!h[f[2]]){var k=b[f[0]],l=b[f[1]],m=b[f[2]],o=n(m,k,d,e),p=n(m,l,d,e);g=i(a,[p,o,k],[-1,-1,c[f[0]]])||g,g=i(a,[k,l,p],[c[f[0]],c[f[1]],-1])||g,j=!0}}),j?g:([[0,1,2],[1,2,0],[2,0,1]].forEach(function(f){if(h[f[0]]&&!h[f[1]]&&!h[f[2]]){var k=b[f[0]],l=b[f[1]],m=b[f[2]],o=n(l,k,d,e),p=n(m,k,d,e);g=i(a,[p,o,k],[-1,-1,c[f[0]]])||g,j=!0}}),g)}function s(a,b,c,d){var e=!1,f=q(b),g=[o(f[0][3],c,d),o(f[1][3],c,d),o(f[2][3],c,d),o(f[3][3],c,d)];if(!(g[0]||g[1]||g[2]||g[3]))return e;if(g[0]&&g[1]&&g[2]&&g[3])return T&&(e=function(a,b,c){var d=function(d,e,f){l(a,[b[d],b[e],b[f]],[c[d],c[e],c[f]])};d(0,1,2),d(3,0,1),d(2,3,0),d(1,2,3)}(a,f,b)||e),e;var h=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(i){if(g[i[0]]&&g[i[1]]&&g[i[2]]&&!g[i[3]]){var j=f[i[0]],k=f[i[1]],m=f[i[2]],o=f[i[3]];if(T)e=l(a,[j,k,m],[b[i[0]],b[i[1]],b[i[2]]])||e;else{var p=n(o,j,c,d),q=n(o,k,c,d),r=n(o,m,c,d);e=l(null,[p,q,r],[-1,-1,-1])||e}h=!0}}),h?e:([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(i){if(g[i[0]]&&g[i[1]]&&!g[i[2]]&&!g[i[3]]){var j=f[i[0]],k=f[i[1]],m=f[i[2]],o=f[i[3]],p=n(m,j,c,d),q=n(m,k,c,d),r=n(o,k,c,d),s=n(o,j,c,d);T?(e=l(a,[j,s,p],[b[i[0]],-1,-1])||e,e=l(a,[k,q,r],[b[i[1]],-1,-1])||e):e=function(a,b,c){var d=function(a,d,e){l(null,[b[a],b[d],b[e]],[c[a],c[d],c[e]])};d(0,1,2),d(2,3,0)}(0,[p,q,r,s],[-1,-1,-1,-1])||e,h=!0}}),h?e:([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(i){if(g[i[0]]&&!g[i[1]]&&!g[i[2]]&&!g[i[3]]){var j=f[i[0]],k=f[i[1]],m=f[i[2]],o=f[i[3]],p=n(k,j,c,d),q=n(m,j,c,d),r=n(o,j,c,d);T?(e=l(a,[j,p,q],[b[i[0]],-1,-1])||e,e=l(a,[j,q,r],[b[i[0]],-1,-1])||e,e=l(a,[j,r,p],[b[i[0]],-1,-1])||e):e=l(null,[p,q,r],[-1,-1,-1])||e,h=!0}}),e))}function t(a,b,c,d,e,f,g,h,i,k,l){var m=!1;return S&&(j(a,"A")&&(m=s(null,[b,c,d,f],k,l)||m),j(a,"B")&&(m=s(null,[c,d,e,i],k,l)||m),j(a,"C")&&(m=s(null,[c,f,g,i],k,l)||m),j(a,"D")&&(m=s(null,[d,f,h,i],k,l)||m),j(a,"E")&&(m=s(null,[c,d,f,i],k,l)||m)),T&&(m=s(a,[c,d,f,i],k,l)||m),m}function u(a,b,c,d,e,f,g,h){return[!0===h[0]||r(a,q([b,c,d]),[b,c,d],f,g),!0===h[1]||r(a,q([d,e,b]),[d,e,b],f,g)]}function v(a,b,c,d,e,f,g,h,i){return h?u(a,b,c,e,d,f,g,i):u(a,c,e,d,b,f,g,i)}function w(a,c,d,e,f,g,i){var j,k,l,m,n=!1,o=function(){n=r(a,[j,k,l],[-1,-1,-1],f,g)||n,n=r(a,[l,m,j],[-1,-1,-1],f,g)||n},p=i[0],s=i[1],t=i[2];return p&&(j=h(q([b(c,d-0,e-0)])[0],q([b(c-1,d-0,e-0)])[0],p),k=h(q([b(c,d-0,e-1)])[0],q([b(c-1,d-0,e-1)])[0],p),l=h(q([b(c,d-1,e-1)])[0],q([b(c-1,d-1,e-1)])[0],p),m=h(q([b(c,d-1,e-0)])[0],q([b(c-1,d-1,e-0)])[0],p),o()),s&&(j=h(q([b(c-0,d,e-0)])[0],q([b(c-0,d-1,e-0)])[0],s),k=h(q([b(c-0,d,e-1)])[0],q([b(c-0,d-1,e-1)])[0],s),l=h(q([b(c-1,d,e-1)])[0],q([b(c-1,d-1,e-1)])[0],s),m=h(q([b(c-1,d,e-0)])[0],q([b(c-1,d-1,e-0)])[0],s),o()),t&&(j=h(q([b(c-0,d-0,e)])[0],q([b(c-0,d-0,e-1)])[0],t),k=h(q([b(c-0,d-1,e)])[0],q([b(c-0,d-1,e-1)])[0],t),l=h(q([b(c-1,d-1,e)])[0],q([b(c-1,d-1,e-1)])[0],t),m=h(q([b(c-1,d-0,e)])[0],q([b(c-1,d-0,e-1)])[0],t),o()),n}function x(a,b,c,d,e,f,g,h,i,j,k,l){var m=a;return l?(S&&"even"===a&&(m=null),t(m,b,c,d,e,f,g,h,i,j,k)):(S&&"odd"===a&&(m=null),t(m,i,h,g,f,e,d,c,b,j,k))}function y(a,c,d,e,f){for(var g=[],h=0,i=0;i<c.length;i++)for(var j=c[i],k=1;k<$;k++)for(var l=1;l<Z;l++)g.push(v(a,b(j,l-1,k-1),b(j,l-1,k),b(j,l,k-1),b(j,l,k),d,e,(j+l+k)%2,f&&f[h]?f[h]:[])),h++;return g}function z(a,c,d,e,f){for(var g=[],h=0,i=0;i<c.length;i++)for(var j=c[i],k=1;k<Y;k++)for(var l=1;l<$;l++)g.push(v(a,b(k-1,j,l-1),b(k,j,l-1),b(k-1,j,l),b(k,j,l),d,e,(k+j+l)%2,f&&f[h]?f[h]:[])),h++;return g}function A(a,c,d,e,f){for(var g=[],h=0,i=0;i<c.length;i++)for(var j=c[i],k=1;k<Z;k++)for(var l=1;l<Y;l++)g.push(v(a,b(l-1,k-1,j),b(l-1,k,j),b(l,k-1,j),b(l,k,j),d,e,(l+k+j)%2,f&&f[h]?f[h]:[])),h++;return g}function B(a,c,d){for(var e=1;e<$;e++)for(var f=1;f<Z;f++)for(var g=1;g<Y;g++)x(a,b(g-1,f-1,e-1),b(g-1,f-1,e),b(g-1,f,e-1),b(g-1,f,e),b(g,f-1,e-1),b(g,f-1,e),b(g,f,e-1),b(g,f,e),c,d,(g+f+e)%2)}function C(a,b,c){S=!0,B(a,b,c),S=!1}function D(a,b,c,d,e,f){for(var g=[],h=0,i=0;i<b.length;i++)for(var j=b[i],k=1;k<$;k++)for(var l=1;l<Z;l++)g.push(w(a,j,l,k,c,d,e[i],f&&f[h]&&f[h])),h++;return g}function E(a,b,c,d,e,f){for(var g=[],h=0,i=0;i<b.length;i++)for(var j=b[i],k=1;k<Y;k++)for(var l=1;l<$;l++)g.push(w(a,k,j,l,c,d,e[i],f&&f[h]&&f[h])),h++;return g}function F(a,b,c,d,e,f){for(var g=[],h=0,i=0;i<b.length;i++)for(var j=b[i],k=1;k<Z;k++)for(var l=1;l<Y;l++)g.push(w(a,l,k,j,c,d,e[i],f&&f[h]&&f[h])),h++;return g}function G(a,b){for(var c=[],d=a;d<b;d++)c.push(d);return c}a._i=[],a._j=[],a._k=[];var H,I,J,K,L,M,N,O=a.surface.show,P=a.spaceframe.show,Q=a.surface.fill,R=a.spaceframe.fill,S=!1,T=!1,U=0,V=d(a.x.slice(0,a._len)),W=d(a.y.slice(0,a._len)),X=d(a.z.slice(0,a._len)),Y=V.length,Z=W.length,$=X.length,_=a._minValues,aa=a._maxValues,ba=a._vMin,ca=a._vMax,da=3;return function(){if(f(),function(){for(var c=0;c<Y;c++)for(var d=0;d<Z;d++)for(var e=0;e<$;e++){var f=b(c,d,e);g(a.x[f],a.y[f],a.z[f],a.value[f])}}(),P&&R&&(i(R),T=!0,B(null,ba,ca),T=!1),O&&Q){i(Q);for(var c=a.surface.pattern,d=a.surface.count,e=0;e<d;e++){var h=1===d?.5:e/(d-1),j=(1-h)*ba+h*ca,k=Math.abs(j-_)>Math.abs(j-aa)?[_,j]:[j,aa];C(c,k[0],k[1])}}var l=[[Math.min(ba,aa),Math.max(ba,aa)],[Math.min(_,ca),Math.max(_,ca)]];["x","y","z"].forEach(function(b){for(var c=[],d=0;d<l.length;d++){var e=0,f=l[d][0],g=l[d][1],h=a.slices[b];if(h.show&&h.fill){i(h.fill);var j=[],k=[],n=[];if(h.locations.length)for(var o=0;o<h.locations.length;o++){var p=m(h.locations[o],"x"===b?V:"y"===b?W:X);0===p.distRatio?j.push(p.id):p.id>0&&(k.push(p.id),"x"===b?n.push([p.distRatio,0,0]):"y"===b?n.push([0,p.distRatio,0]):n.push([0,0,p.distRatio]))}else j=G(1,"x"===b?Y-1:"y"===b?Z-1:$-1);k.length>0&&(c[e]="x"===b?D(null,k,f,g,n,c[e]):"y"===b?E(null,k,f,g,n,c[e]):F(null,k,f,g,n,c[e]),e++),j.length>0&&(c[e]="x"===b?y(null,j,f,g,c[e]):"y"===b?z(null,j,f,g,c[e]):A(null,j,f,g,c[e]),e++)}var q=a.caps[b];q.show&&q.fill&&(i(q.fill),c[e]="x"===b?y(null,[0,Y-1],f,g,c[e]):"y"===b?z(null,[0,Z-1],f,g,c[e]):A(null,[0,$-1],f,g,c[e]),e++)}}),0===U&&f(),a._x=J,a._y=K,a._z=L,a._intensity=M,a._Xs=V,a._Ys=W,a._Zs=X}(),a}var g=a("gl-mesh3d"),h=a("../../lib"),i=a("../../lib/gl_format_color").parseColorScale,j=a("../../lib/str2rgbarray"),k=a("../../components/colorscale").extractOpts,l=a("../../plots/gl3d/zip3"),m=function(a,b){for(var c=b.length-1;c>0;c--){var d=Math.min(b[c],b[c-1]),e=Math.max(b[c],b[c-1]);if(e>d&&d<a&&a<=e)return{id:c,distRatio:(e-a)/(e-d)}}return{id:0,distRatio:0}},n=e.prototype;n.handlePick=function(a){if(a.object===this.mesh){var b=a.data.index,c=this.data._x[b],d=this.data._y[b],e=this.data._z[b],f=this.data._Ys.length,g=this.data._Zs.length,h=m(c,this.data._Xs).id,i=m(d,this.data._Ys).id,j=m(e,this.data._Zs).id,k=a.index=j+g*i+g*f*h;a.traceCoordinate=[this.data._x[k],this.data._y[k],this.data._z[k],this.data.value[k]];var l=this.data.hovertext||this.data.text;return Array.isArray(l)&&void 0!==l[k]?a.textLabel=l[k]:l&&(a.textLabel=l),!0}},n.update=function(a){function b(a,b,c,d){return b.map(function(b){return a.d2l(b,0,d)*c})}var c=this.scene,d=c.fullSceneLayout;this.data=f(a);var e={positions:l(b(d.xaxis,a._x,c.dataScale[0],a.xcalendar),b(d.yaxis,a._y,c.dataScale[1],a.ycalendar),b(d.zaxis,a._z,c.dataScale[2],a.zcalendar)),cells:l(a._i,a._j,a._k),lightPosition:[a.lightposition.x,a.lightposition.y,a.lightposition.z],ambient:a.lighting.ambient,diffuse:a.lighting.diffuse,specular:a.lighting.specular,roughness:a.lighting.roughness,fresnel:a.lighting.fresnel,vertexNormalsEpsilon:a.lighting.vertexnormalsepsilon,faceNormalsEpsilon:a.lighting.facenormalsepsilon,opacity:a.opacity,contourEnable:a.contour.show,contourColor:j(a.contour.color).slice(0,3),contourWidth:a.contour.width,useFacetNormals:a.flatshading},g=k(a);e.vertexIntensity=a._intensity,e.vertexIntensityBounds=[g.min,g.max],e.colormap=i(a),this.mesh.update(e)},n.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},b.exports={findNearestOnAxis:m,
generateIsoMeshes:f,createIsosurfaceTrace:function(a,b){var c=a.glplot.gl,d=g({gl:c}),f=new e(a,d,b.uid);return d._trace=f,f.update(b),a.glplot.add(d),f}}},{"../../components/colorscale":606,"../../lib":719,"../../lib/gl_format_color":716,"../../lib/str2rgbarray":742,"../../plots/gl3d/zip3":818,"gl-mesh3d":281}],1050:[function(a,b,c){"use strict";function d(a,b,c,d,e){var g=e("isomin"),i=e("isomax");null!=i&&null!=g&&g>i&&(b.isomin=null,b.isomax=null);var j=e("x"),k=e("y"),l=e("z"),m=e("value");j&&j.length&&k&&k.length&&l&&l.length&&m&&m.length?(f.getComponentMethod("calendars","handleTraceDefaults")(a,b,["x","y","z"],d),["x","y","z"].forEach(function(a){var b="caps."+a;e(b+".show")&&e(b+".fill");var c="slices."+a;e(c+".show")&&(e(c+".fill"),e(c+".locations"))}),e("spaceframe.show")&&e("spaceframe.fill"),e("surface.show")&&(e("surface.count"),e("surface.fill"),e("surface.pattern")),e("contour.show")&&(e("contour.color"),e("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(a){e(a)}),h(a,b,d,e,{prefix:"",cLetter:"c"}),b._length=null):b.visible=!1}var e=a("../../lib"),f=a("../../registry"),g=a("./attributes"),h=a("../../components/colorscale/defaults");b.exports={supplyDefaults:function(a,b,c,f){d(a,b,0,f,function(c,d){return e.coerce(a,b,g,c,d)})},supplyIsoDefaults:d}},{"../../components/colorscale/defaults":604,"../../lib":719,"../../registry":848,"./attributes":1047}],1051:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults").supplyDefaults,calc:a("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:a("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:a("../../plots/gl3d"),categories:["gl3d"],meta:{}}},{"../../plots/gl3d":807,"./attributes":1047,"./calc":1048,"./convert":1049,"./defaults":1050}],1052:[function(a,b,c){"use strict";var d=a("../../components/colorscale/attributes"),e=a("../../plots/template_attributes").hovertemplateAttrs,f=a("../surface/attributes"),g=a("../../plots/attributes"),h=a("../../lib/extend").extendFlat;b.exports=h({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:e({editType:"calc"}),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},d("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:f.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:h({},f.contours.x.show,{}),color:f.contours.x.color,width:f.contours.x.width,editType:"calc"},lightposition:{x:h({},f.lightposition.x,{dflt:1e5}),y:h({},f.lightposition.y,{dflt:1e5}),z:h({},f.lightposition.z,{dflt:0}),editType:"calc"},lighting:h({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},f.lighting),hoverinfo:h({},g.hoverinfo,{editType:"calc"})})},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/template_attributes":843,"../surface/attributes":1225}],1053:[function(a,b,c){"use strict";var d=a("../../components/colorscale/calc");b.exports=function(a,b){b.intensity&&d(a,b,{vals:b.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":602}],1054:[function(a,b,c){"use strict";function d(a,b,c){this.scene=a,this.uid=c,this.mesh=b,this.name="",this.color="#fff",this.data=null,this.showContour=!1}function e(a){for(var b=[],c=a.length,d=0;d<c;d++)b[d]=n(a[d]);return b}function f(a,b,c,d){for(var e=[],f=b.length,g=0;g<f;g++)e[g]=a.d2l(b[g],0,d)*c;return e}function g(a){for(var b=[],c=a.length,d=0;d<c;d++)b[d]=Math.round(a[d]);return b}function h(a,b){for(var c=a.length,d=0;d<c;d++)if(a[d]<=-.5||a[d]>=b-.5)return!1;return!0}var i=a("gl-mesh3d"),j=a("delaunay-triangulate"),k=a("alpha-shape"),l=a("convex-hull"),m=a("../../lib/gl_format_color").parseColorScale,n=a("../../lib/str2rgbarray"),o=a("../../components/colorscale").extractOpts,p=a("../../plots/gl3d/zip3"),q=d.prototype;q.handlePick=function(a){if(a.object===this.mesh){var b=a.index=a.data.index;a.traceCoordinate=[this.data.x[b],this.data.y[b],this.data.z[b]];var c=this.data.hovertext||this.data.text;return Array.isArray(c)&&void 0!==c[b]?a.textLabel=c[b]:c&&(a.textLabel=c),!0}},q.update=function(a){var b=this.scene,c=b.fullSceneLayout;this.data=a;var d,i=a.x.length,q=p(f(c.xaxis,a.x,b.dataScale[0],a.xcalendar),f(c.yaxis,a.y,b.dataScale[1],a.ycalendar),f(c.zaxis,a.z,b.dataScale[2],a.zcalendar));if(a.i&&a.j&&a.k){if(a.i.length!==a.j.length||a.j.length!==a.k.length||!h(a.i,i)||!h(a.j,i)||!h(a.k,i))return;d=p(g(a.i),g(a.j),g(a.k))}else d=0===a.alphahull?l(q):a.alphahull>0?k(a.alphahull,q):function(a,b){for(var c=["x","y","z"].indexOf(a),d=[],e=b.length,f=0;f<e;f++)d[f]=[b[f][(c+1)%3],b[f][(c+2)%3]];return j(d)}(a.delaunayaxis,q);var r={positions:q,cells:d,lightPosition:[a.lightposition.x,a.lightposition.y,a.lightposition.z],ambient:a.lighting.ambient,diffuse:a.lighting.diffuse,specular:a.lighting.specular,roughness:a.lighting.roughness,fresnel:a.lighting.fresnel,vertexNormalsEpsilon:a.lighting.vertexnormalsepsilon,faceNormalsEpsilon:a.lighting.facenormalsepsilon,opacity:a.opacity,contourEnable:a.contour.show,contourColor:n(a.contour.color).slice(0,3),contourWidth:a.contour.width,useFacetNormals:a.flatshading};if(a.intensity){var s=o(a);this.color="#fff",r.vertexIntensity=a.intensity,r.vertexIntensityBounds=[s.min,s.max],r.colormap=m(a)}else a.vertexcolor?(this.color=a.vertexcolor[0],r.vertexColors=e(a.vertexcolor)):a.facecolor?(this.color=a.facecolor[0],r.cellColors=e(a.facecolor)):(this.color=a.color,r.meshColor=n(a.color));this.mesh.update(r)},q.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},b.exports=function(a,b){var c=a.glplot.gl,e=i({gl:c}),f=new d(a,e,b.uid);return e._trace=f,f.update(b),a.glplot.add(e),f}},{"../../components/colorscale":606,"../../lib/gl_format_color":716,"../../lib/str2rgbarray":742,"../../plots/gl3d/zip3":818,"alpha-shape":65,"convex-hull":131,"delaunay-triangulate":166,"gl-mesh3d":281}],1055:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("../../components/colorscale/defaults"),g=a("./attributes");b.exports=function(a,b,c,h){function i(c,d){return e.coerce(a,b,g,c,d)}function j(a){var b=a.map(function(a){var b=i(a);return b&&e.isArrayOrTypedArray(b)?b:null});return b.every(function(a){return a&&a.length===b[0].length})&&b}j(["x","y","z"])?(j(["i","j","k"]),(!b.i||b.j&&b.k)&&(!b.j||b.k&&b.i)&&(!b.k||b.i&&b.j)?(d.getComponentMethod("calendars","handleTraceDefaults")(a,b,["x","y","z"],h),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","contour.show","contour.color","contour.width","colorscale","reversescale","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(a){i(a)}),"intensity"in a?(i("intensity"),f(a,b,h,i,{prefix:"",cLetter:"c"})):(b.showscale=!1,"facecolor"in a?i("facecolor"):"vertexcolor"in a?i("vertexcolor"):i("color",c)),i("text"),i("hovertext"),i("hovertemplate"),b._length=null):b.visible=!1):b.visible=!1}},{"../../components/colorscale/defaults":604,"../../lib":719,"../../registry":848,"./attributes":1052}],1056:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:a("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:a("../../plots/gl3d"),categories:["gl3d"],meta:{}}},{"../../plots/gl3d":807,"./attributes":1052,"./calc":1053,"./convert":1054,"./defaults":1055}],1057:[function(a,b,c){"use strict";function d(a){return{line:{color:e({},l.color,{dflt:a}),width:l.width,dash:g,editType:"style"},editType:"style"}}var e=a("../../lib").extendFlat,f=a("../scatter/attributes"),g=a("../../components/drawing/attributes").dash,h=a("../../components/fx/attributes"),i=a("../../constants/delta.js"),j=i.INCREASING.COLOR,k=i.DECREASING.COLOR,l=f.line;b.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:e({},l.width,{}),dash:e({},g,{}),editType:"style"},increasing:d(j),decreasing:d(k),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:e({},h.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":614,"../../components/fx/attributes":624,"../../constants/delta.js":689,"../../lib":719,"../scatter/attributes":1111}],1058:[function(a,b,c){"use strict";function d(a,b,c,d){return{o:a,h:b,l:c,c:d}}function e(a,b,c,d,e){for(var j=d.makeCalcdata(b,"open"),k=d.makeCalcdata(b,"high"),l=d.makeCalcdata(b,"low"),m=d.makeCalcdata(b,"close"),n=Array.isArray(b.text),o=Array.isArray(b.hovertext),p=!0,q=null,r=[],s=0;s<c.length;s++){var t=c[s],u=j[s],v=k[s],w=l[s],x=m[s];if(t!==i&&u!==i&&v!==i&&w!==i&&x!==i){x===u?null!==q&&x!==q&&(p=x>q):p=x>u,q=x;var y=e(u,v,w,x);y.pos=t,y.yc=(u+x)/2,y.i=s,y.dir=p?"increasing":"decreasing",y.x=y.pos,y.y=[w,v],n&&(y.tx=b.text[s]),o&&(y.htx=b.hovertext[s]),r.push(y)}else r.push({pos:t,empty:!0})}return b._extremes[d._id]=h.findExtremes(d,f.concat(l,k),{padded:!0}),r.length&&(r[0].t={labels:{open:g(a,"open:")+" ",high:g(a,"high:")+" ",low:g(a,"low:")+" ",close:g(a,"close:")+" "}}),r}var f=a("../../lib"),g=f._,h=a("../../plots/cartesian/axes"),i=a("../../constants/numerical").BADNUM;b.exports={calc:function(a,b){var c=h.getFromId(a,b.xaxis),g=h.getFromId(a,b.yaxis),i=function(a,b,c){var d=c._minDiff;if(!d){var e,g=a._fullData,h=[];for(d=1/0,e=0;e<g.length;e++){var i=g[e];if("ohlc"===i.type&&!0===i.visible&&i.xaxis===b._id){h.push(i);var j=b.makeCalcdata(i,"x");i._xcalc=j;var k=f.distinctVals(j).minDiff;k&&isFinite(k)&&(d=Math.min(d,k))}}for(d===1/0&&(d=1),e=0;e<h.length;e++)h[e]._minDiff=d}return d*c.tickwidth}(a,c,b),j=b._minDiff;b._minDiff=null;var k=b._xcalc;b._xcalc=null;var l=e(a,b,k,g,d);return b._extremes[c._id]=h.findExtremes(c,k,{vpad:j/2}),l.length?(f.extendFlat(l[0].t,{wHover:j/2,tickLen:i}),l):[{t:{empty:!0}}]},calcCommon:e}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767}],1059:[function(a,b,c){"use strict";function d(a,b,c,d){c(d+".line.color"),c(d+".line.width",b.line.width),c(d+".line.dash",b.line.dash)}var e=a("../../lib"),f=a("./ohlc_defaults"),g=a("./attributes");b.exports=function(a,b,c,h){function i(c,d){return e.coerce(a,b,g,c,d)}f(a,b,i,h)?(i("line.width"),i("line.dash"),d(a,b,i,"increasing"),d(a,b,i,"decreasing"),i("text"),i("hovertext"),i("tickwidth"),h._requestRangeslider[b.xaxis]=!0):b.visible=!1}},{"../../lib":719,"./attributes":1057,"./ohlc_defaults":1062}],1060:[function(a,b,c){"use strict";function d(a,b,c,d){function e(a){var b=t(a);return i.inbox(b-v,b+v,h)}function f(a){var b=a[q],d=a[r];return b===d||i.inbox(b-c,d-c,h)}function g(a){return(e(a)+f(a))/2}var h,k,l=a.cd,m=a.xa,n=l[0].trace,o=l[0].t,p=n.type,q="ohlc"===p?"l":"min",r="ohlc"===p?"h":"max",s=o.bPos||0,t=function(a){return a.pos+s-b},u=o.bdPos||o.tickLen,v=o.wHover,w=Math.min(1,u/Math.abs(m.r2c(m.range[1])-m.r2c(m.range[0])));h=a.maxHoverDistance-w,k=a.maxSpikeDistance-w;var x=i.getDistanceFunction(d,e,f,g);if(i.getClosest(l,x,a),!1===a.index)return null;var y=l[a.index];if(y.empty)return null;var z=n[y.dir],A=z.line.color;return j.opacity(A)&&z.line.width?a.color=A:a.color=z.fillcolor,a.x0=m.c2p(y.pos+s-u,!0),a.x1=m.c2p(y.pos+s+u,!0),a.xLabelVal=y.pos,a.spikeDistance=g(y)*k/h,a.xSpike=m.c2p(y.pos,!0),a}function e(a,b,c,e){var f=a.cd,i=a.ya,j=f[0].trace,k=f[0].t,l=[],m=d(a,b,c,e);if(!m)return[];var n=f[m.index].hi||j.hoverinfo,o=n.split("+");if("all"!==n&&-1===o.indexOf("y"))return[];for(var p=["high","open","close","low"],q={},r=0;r<p.length;r++){var s,t=p[r],u=j[t][m.index],v=i.c2p(u,!0);u in q?(s=q[u]).yLabel+="<br>"+k.labels[t]+g.hoverLabelText(i,u):((s=h.extendFlat({},m)).y0=s.y1=v,s.yLabelVal=u,s.yLabel=k.labels[t]+g.hoverLabelText(i,u),s.name="",l.push(s),q[u]=s)}return l}function f(a,b,c,e){function f(a){return l.labels[a]+g.hoverLabelText(i,j[a][p])}var h=a.cd,i=a.ya,j=h[0].trace,l=h[0].t,n=d(a,b,c,e);if(!n)return[];var o=h[n.index],p=n.index=o.i,q=o.dir,r=o.hi||j.hoverinfo,s=r.split("+"),t="all"===r,u=t||-1!==s.indexOf("y"),v=t||-1!==s.indexOf("text"),w=u?[f("open"),f("high"),f("low"),f("close")+"  "+m[q]]:[];return v&&k(o,j,w),n.extraText=w.join("<br>"),n.y0=n.y1=i.c2p(o.yc,!0),[n]}var g=a("../../plots/cartesian/axes"),h=a("../../lib"),i=a("../../components/fx"),j=a("../../components/color"),k=a("../../lib").fillText,l=a("../../constants/delta.js"),m={increasing:l.INCREASING.SYMBOL,decreasing:l.DECREASING.SYMBOL};b.exports={hoverPoints:function(a,b,c,d){return a.cd[0].trace.hoverlabel.split?e(a,b,c,d):f(a,b,c,d)},hoverSplit:e,hoverOnPoints:f}},{"../../components/color":594,"../../components/fx":632,"../../constants/delta.js":689,"../../lib":719,"../../plots/cartesian/axes":767}],1061:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"ohlc",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc").calc,plot:a("./plot"),style:a("./style"),hoverPoints:a("./hover").hoverPoints,selectPoints:a("./select")}},{"../../plots/cartesian":778,"./attributes":1057,"./calc":1058,"./defaults":1059,"./hover":1060,"./plot":1063,"./select":1064,"./style":1065}],1062:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib");b.exports=function(a,b,c,f){var g=c("x"),h=c("open"),i=c("high"),j=c("low"),k=c("close");if(c("hoverlabel.split"),d.getComponentMethod("calendars","handleTraceDefaults")(a,b,["x"],f),h&&i&&j&&k){var l=Math.min(h.length,i.length,j.length,k.length);return g&&(l=Math.min(l,e.minRowLength(g))),b._length=l,l}}},{"../../lib":719,"../../registry":848}],1063:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../lib");b.exports=function(a,b,c,f){var g=b.xaxis,h=b.yaxis;e.makeTraceGroups(f,c,"trace ohlc").each(function(a){var b=d.select(this),c=a[0],f=c.t;if(!0!==c.trace.visible||f.empty)b.remove();else{var i=f.tickLen,j=b.selectAll("path").data(e.identity);j.enter().append("path"),j.exit().remove(),j.attr("d",function(a){if(a.empty)return"M0,0Z";var b=g.c2p(a.pos,!0),c=g.c2p(a.pos-i,!0),d=g.c2p(a.pos+i,!0);return"M"+c+","+h.c2p(a.o,!0)+"H"+b+"M"+b+","+h.c2p(a.h,!0)+"V"+h.c2p(a.l,!0)+"M"+d+","+h.c2p(a.c,!0)+"H"+b})}})}},{"../../lib":719,d3:164}],1064:[function(a,b,c){"use strict";b.exports=function(a,b){var c,d=a.cd,e=a.xaxis,f=a.yaxis,g=[],h=d[0].t.bPos||0;if(!1===b)for(c=0;c<d.length;c++)d[c].selected=0;else for(c=0;c<d.length;c++){var i=d[c];b.contains([e.c2p(i.pos+h),f.c2p(i.yc)],null,i.i,a)?(g.push({pointNumber:i.i,x:e.c2d(i.pos),y:f.c2d(i.yc)}),i.selected=1):i.selected=0}return g}},{}],1065:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../components/drawing"),f=a("../../components/color");b.exports=function(a,b,c){var g=c||d.select(a).selectAll("g.ohlclayer").selectAll("g.trace");g.style("opacity",function(a){return a[0].trace.opacity}),g.each(function(a){var b=a[0].trace;d.select(this).selectAll("path").each(function(a){if(!a.empty){var c=b[a.dir].line;d.select(this).style("fill","none").call(f.stroke,c.color).call(e.dashLine,c.dash,c.width).style("opacity",b.selectedpoints&&!a.selected?.3:1)}})})}},{"../../components/color":594,"../../components/drawing":615,d3:164}],1066:[function(a,b,c){"use strict";var d=a("../../lib/extend").extendFlat,e=a("../../plots/attributes"),f=a("../../plots/font_attributes"),g=a("../../components/colorscale/attributes"),h=a("../../plots/template_attributes").hovertemplateAttrs,i=a("../../plots/domain").attributes,j=d({editType:"calc"},g("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:h({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});b.exports={domain:i({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:d({},e.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:h({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:f({editType:"calc"}),tickfont:f({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:j,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/domain":792,"../../plots/font_attributes":793,"../../plots/template_attributes":843}],1067:[function(a,b,c){"use strict";var d=a("../../plots/get_data").getModuleCalcData,e=a("./plot");c.name="parcats",c.plot=function(a,b,c,f){var g=d(a.calcdata,"parcats");if(g.length){var h=g[0];e(a,h,c,f)}},c.clean=function(a,b,c,d){var e=d._has&&d._has("parcats"),f=b._has&&b._has("parcats");e&&!f&&d._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":802,"./plot":1072}],1068:[function(a,b,c){"use strict";function d(a,b,c){a.valueInds.push(b),a.count+=c}function e(a,b,c){return{categoryInds:a,color:b,rawColor:c,valueInds:[],count:0}}function f(a,b,c){a.valueInds.push(b),a.count+=c}var g=a("../../lib/gup").wrap,h=a("../../components/colorscale/helpers").hasColorscale,i=a("../../components/colorscale/calc"),j=a("../../lib/filter_unique.js"),k=a("../../components/drawing"),l=a("../../lib");b.exports=function(a,b){var c=l.filterVisible(b.dimensions);if(0===c.length)return[];var m,n,o,p=c.map(function(a){var b;return"trace"===a.categoryorder?b=null:"array"===a.categoryorder?b=a.categoryarray:(b=j(a.values).sort(),"category descending"===a.categoryorder&&(b=b.reverse())),function(a,b){b=null==b?[]:b.map(function(a){return a});var c={},d={},e=[];b.forEach(function(a,b){c[a]=0,d[a]=b});for(var f=0;f<a.length;f++){var g,h=a[f];void 0===c[h]?(c[h]=1,g=b.push(h)-1,d[h]=g):(c[h]++,g=d[h]),e.push(g)}return{uniqueValues:b,uniqueCounts:b.map(function(a){return c[a]}),inds:e}}(a.values,b)});m=l.isArrayOrTypedArray(b.counts)?b.counts:[b.counts],function(a){var b;if(function(a){for(var b=new Array(a.length),c=0;c<a.length;c++){if(a[c]<0||a[c]>=a.length)return!1;if(void 0!==b[a[c]])return!1;b[a[c]]=!0}return!0}(a.map(function(a){return a.displayindex})))for(b=0;b<a.length;b++)a[b]._displayindex=a[b].displayindex;else for(b=0;b<a.length;b++)a[b]._displayindex=b}(c),c.forEach(function(a,b){!function(a,b){a._categoryarray=b.uniqueValues,null===a.ticktext||void 0===a.ticktext?a._ticktext=[]:a._ticktext=a.ticktext.slice();for(var c=a._ticktext.length;c<b.uniqueValues.length;c++)a._ticktext.push(b.uniqueValues[c])}(a,p[b])});var q,r=b.line;r?(h(b,"line")&&i(a,b,{vals:b.line.color,containerStr:"line",cLetter:"c"}),q=k.tryColorscale(r)):q=l.identity;var s,t,u,v,w,x=c[0].values.length,y={},z=p.map(function(a){return a.inds});for(o=0,s=0;s<x;s++){var A=[];for(t=0;t<z.length;t++)A.push(z[t][s]);n=m[s%m.length],o+=n;var B=(u=s,v=void 0,w=void 0,l.isArrayOrTypedArray(r.color)?w=v=r.color[u%r.color.length]:v=r.color,{color:q(v),rawColor:w}),C=A+"-"+B.rawColor;void 0===y[C]&&(y[C]=e(A,B.color,B.rawColor)),f(y[C],s,n)}var D,E=c.map(function(a,b){return c=b,d=a._index,e=a._displayindex,f=a.label,{dimensionInd:c,containerInd:d,displayInd:e,dimensionLabel:f,count:o,categories:[],dragX:null};var c,d,e,f});for(s=0;s<x;s++)for(n=m[s%m.length],t=0;t<E.length;t++){var F=E[t].containerInd,G=p[t].inds[s],H=E[t].categories;if(void 0===H[G]){var I=b.dimensions[F]._categoryarray[G],J=b.dimensions[F]._ticktext[G];H[G]={dimensionInd:t,categoryInd:D=G,categoryValue:I,displayInd:D,categoryLabel:J,valueInds:[],count:0,dragY:null}}d(H[G],s,n)}return g(function(a,b,c){return{dimensions:a,paths:b,trace:void 0,maxCats:a.map(function(a){return a.categories.length}).reduce(function(a,b){return Math.max(a,b)}),count:c}}(E,y,o))}},{"../../components/colorscale/calc":602,"../../components/colorscale/helpers":605,"../../components/drawing":615,"../../lib":719,"../../lib/filter_unique.js":711,"../../lib/gup":717}],1069:[function(a,b,c){"use strict";function d(a,b){function c(c,d){return e.coerce(a,b,j.dimensions,c,d)}var d=c("values"),f=c("visible");if(d&&d.length||(f=b.visible=!1),f){c("label"),c("displayindex",b._index);var g,h=a.categoryarray,i=Array.isArray(h)&&h.length>0;i&&(g="array");var k=c("categoryorder",g);"array"===k?(c("categoryarray"),c("ticktext")):(delete a.categoryarray,delete a.ticktext),i||"array"!==k||(b.categoryorder="trace")}}var e=a("../../lib"),f=a("../../components/colorscale/helpers").hasColorscale,g=a("../../components/colorscale/defaults"),h=a("../../plots/domain").defaults,i=a("../../plots/array_container_defaults"),j=a("./attributes"),k=a("../parcoords/merge_length");b.exports=function(a,b,c,l){function m(c,d){return e.coerce(a,b,j,c,d)}var n=i(a,b,{name:"dimensions",handleItemDefaults:d}),o=function(a,b,c,d,h){h("line.shape"),h("line.hovertemplate");var i=h("line.color",d.colorway[0]);if(f(a,"line")&&e.isArrayOrTypedArray(i)){if(i.length)return h("line.colorscale"),g(a,b,d,h,{prefix:"line.",cLetter:"c"}),i.length;b.line.color=c}return 1/0}(a,b,c,l,m);h(b,l,m),Array.isArray(n)&&n.length||(b.visible=!1),k(b,n,"values",o),m("hoveron"),m("hovertemplate"),m("arrangement"),m("bundlecolors"),m("sortpaths"),m("counts");var p={family:l.font.family,size:Math.round(l.font.size),color:l.font.color};e.coerceFont(m,"labelfont",p);var q={family:l.font.family,size:Math.round(l.font.size/1.2),color:l.font.color};e.coerceFont(m,"tickfont",q)}},{"../../components/colorscale/defaults":604,"../../components/colorscale/helpers":605,"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/domain":792,"../parcoords/merge_length":1082,"./attributes":1066}],1070:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:a("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1066,"./base_plot":1067,"./calc":1068,"./defaults":1069,"./plot":1072}],1071:[function(a,b,c){"use strict";function d(a,b,c,d){var j=a.map(function(a,b,c){var d,e=c[0],f=b.margin||{l:80,r:80,t:100,b:80},g=e.trace,h=g.domain,i=b.width,j=b.height,k=Math.floor(i*(h.x[1]-h.x[0])),l=Math.floor(j*(h.y[1]-h.y[0])),m=h.x[0]*i+f.l,n=b.height-h.y[1]*b.height+f.t,o=g.line.shape;d="all"===g.hoverinfo?["count","probability"]:(g.hoverinfo||"").split("+");var p={trace:g,key:g.uid,model:e,x:m,y:n,width:k,height:l,hoveron:g.hoveron,hoverinfoItems:d,arrangement:g.arrangement,bundlecolors:g.bundlecolors,sortpaths:g.sortpaths,labelfont:g.labelfont,categorylabelfont:g.tickfont,pathShape:o,dragDimension:null,margin:f,paths:[],dimensions:[],graphDiv:a,traceSelection:null,pathSelection:null,dimensionSelection:null};return e.dimensions&&(E(p),D(p)),p}.bind(0,b,c)),k=d.selectAll("g.parcatslayer").data([null]);k.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var n=k.selectAll("g.trace.parcats").data(j,e),q=n.enter().append("g").attr("class","trace parcats");n.attr("transform",function(a){return"translate("+a.x+", "+a.y+")"}),q.append("g").attr("class","paths");var r=n.select("g.paths").selectAll("path.path").data(function(a){return a.paths},e);r.attr("fill",function(a){return a.model.color});var s=r.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(a){return a.model.color}).attr("fill-opacity",0);m(s),r.attr("d",function(a){return a.svgD}),s.empty()||r.sort(g),r.exit().remove(),r.on("mouseover",h).on("mouseout",i).on("click",l),q.append("g").attr("class","dimensions");var t=n.select("g.dimensions").selectAll("g.dimension").data(function(a){return a.dimensions},e);t.enter().append("g").attr("class","dimension"),t.attr("transform",function(a){return"translate("+a.x+", 0)"}),t.exit().remove();var z=t.selectAll("g.category").data(function(a){return a.categories},e),A=z.enter().append("g").attr("class","category");z.attr("transform",function(a){return"translate(0, "+a.y+")"}),A.append("rect").attr("class","catrect").attr("pointer-events","none"),z.select("rect.catrect").attr("fill","none").attr("width",function(a){return a.width}).attr("height",function(a){return a.height}),o(A);var B=z.selectAll("rect.bandrect").data(function(a){return a.bands},e);B.each(function(){J.raiseToTop(this)}),B.attr("fill",function(a){return a.color});var C=B.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(a){return a.color}).attr("fill-opacity",0);B.attr("fill",function(a){return a.color}).attr("width",function(a){return a.width}).attr("height",function(a){return a.height}).attr("y",function(a){return a.y}).attr("cursor",function(a){return"fixed"===a.parcatsViewModel.arrangement?"default":"perpendicular"===a.parcatsViewModel.arrangement?"ns-resize":"move"}),p(C),B.exit().remove(),A.append("text").attr("class","catlabel").attr("pointer-events","none");var F=b._fullLayout.paper_bgcolor;z.select("text.catlabel").attr("text-anchor",function(a){return f(a)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",F+" -1px  1px 2px, "+F+" 1px  1px 2px, "+F+"  1px -1px 2px, "+F+" -1px -1px 2px").style("fill","rgb(0, 0, 0)").attr("x",function(a){return f(a)?a.width+5:-5}).attr("y",function(a){return a.height/2}).text(function(a){return a.model.categoryLabel}).each(function(a){K.font(G.select(this),a.parcatsViewModel.categorylabelfont),M.convertToTspans(G.select(this),b)}),A.append("text").attr("class","dimlabel"),z.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(a){return"fixed"===a.parcatsViewModel.arrangement?"default":"ew-resize"}).attr("x",function(a){return a.width/2}).attr("y",-5).text(function(a,b){return 0===b?a.parcatsViewModel.model.dimensions[a.model.dimensionInd].dimensionLabel:null}).each(function(a){K.font(G.select(this),a.parcatsViewModel.labelfont)}),z.selectAll("rect.bandrect").on("mouseover",u).on("mouseout",v),z.exit().remove(),t.call(G.behavior.drag().origin(function(a){return{x:a.x,y:0}}).on("dragstart",w).on("drag",x).on("dragend",y)),n.each(function(a){a.traceSelection=G.select(this),a.pathSelection=G.select(this).selectAll("g.paths").selectAll("path.path"),a.dimensionSelection=G.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),n.exit().remove()}function e(a){return a.key}function f(a){var b=a.parcatsViewModel.dimensions.length,c=a.parcatsViewModel.dimensions[b-1].model.dimensionInd;return a.model.dimensionInd===c}function g(a,b){return a.model.rawColor>b.model.rawColor?1:a.model.rawColor<b.model.rawColor?-1:0}function h(a){if(!a.parcatsViewModel.dragDimension&&-1===a.parcatsViewModel.hoverinfoItems.indexOf("skip")){J.raiseToTop(this),n(G.select(this));var b=j(a),c=k(a);if(a.parcatsViewModel.graphDiv.emit("plotly_hover",{points:b,event:G.event,constraints:c}),-1===a.parcatsViewModel.hoverinfoItems.indexOf("none")){var d,e,f,g=G.mouse(this)[0],h=a.parcatsViewModel.graphDiv,i=a.parcatsViewModel.trace,l=h._fullLayout,m=l._paperdiv.node().getBoundingClientRect(),o=a.parcatsViewModel.graphDiv.getBoundingClientRect();for(f=0;f<a.leftXs.length-1;f++)if(a.leftXs[f]+a.dimWidths[f]-2<=g&&g<=a.leftXs[f+1]+2){var p=a.parcatsViewModel.dimensions[f],q=a.parcatsViewModel.dimensions[f+1];d=(p.x+p.width+q.x)/2,e=(a.topYs[f]+a.topYs[f+1]+a.height)/2;break}var r=a.parcatsViewModel.x+d,s=a.parcatsViewModel.y+e,t=L.mostReadable(a.model.color,["black","white"]),u=a.model.count,v=u/a.parcatsViewModel.model.count,w={countLabel:u,probabilityLabel:v.toFixed(3)},x=[];-1!==a.parcatsViewModel.hoverinfoItems.indexOf("count")&&x.push(["Count:",w.countLabel].join(" ")),-1!==a.parcatsViewModel.hoverinfoItems.indexOf("probability")&&x.push(["P:",w.probabilityLabel].join(" "));var y=x.join("<br>"),z=G.mouse(h)[0];I.loneHover({trace:i,x:r-m.left+o.left,y:s-m.top+o.top,text:y,color:a.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:t,idealAlign:z<r?"right":"left",hovertemplate:(i.line||{}).hovertemplate,hovertemplateLabels:w,eventData:[{data:i._input,fullData:i,count:u,probability:v}]},{container:l._hoverlayer.node(),outerContainer:l._paper.node(),gd:h})}}}function i(a){if(!a.parcatsViewModel.dragDimension&&(m(G.select(this)),I.loneUnhover(a.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),a.parcatsViewModel.pathSelection.sort(g),-1===a.parcatsViewModel.hoverinfoItems.indexOf("skip"))){var b=j(a),c=k(a);a.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:b,event:G.event,constraints:c})}}function j(a){for(var b=[],c=z(a.parcatsViewModel),d=0;d<a.model.valueInds.length;d++){var e=a.model.valueInds[d];b.push({curveNumber:c,pointNumber:e})}return b}function k(a){for(var b={},c=a.parcatsViewModel.model.dimensions,d=0;d<c.length;d++){var e=c[d],f=e.categories[a.model.categoryInds[d]];b[e.containerInd]=f.categoryValue}return void 0!==a.model.rawColor&&(b.color=a.model.rawColor),b}function l(a){if(-1===a.parcatsViewModel.hoverinfoItems.indexOf("skip")){var b=j(a),c=k(a);a.parcatsViewModel.graphDiv.emit("plotly_click",{points:b,event:G.event,constraints:c})}}function m(a){a.attr("fill",function(a){return a.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function n(a){a.attr("fill-opacity",.8).attr("stroke",function(a){return L.mostReadable(a.model.color,["black","white"])}).attr("stroke-width",.3)}function o(a){a.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function p(a){a.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function q(a){var b=a.parcatsViewModel.pathSelection,c=a.categoryViewModel.model.dimensionInd,d=a.categoryViewModel.model.categoryInd
;return b.filter(function(b){return b.model.categoryInds[c]===d&&b.model.color===a.color})}function r(a,b,c){var d=G.select(a).datum(),e=d.categoryViewModel.model,f=d.parcatsViewModel.graphDiv,g=G.select(a.parentNode).selectAll("rect.bandrect"),h=[];g.each(function(a){q(a).each(function(a){Array.prototype.push.apply(h,j(a))})});var i={};i[e.dimensionInd]=e.categoryValue,f.emit(b,{points:h,event:c,constraints:i})}function s(a,b,c){var d=G.select(a).datum(),e=d.categoryViewModel.model,f=d.parcatsViewModel.graphDiv,g=q(d),h=[];g.each(function(a){Array.prototype.push.apply(h,j(a))});var i={};i[e.dimensionInd]=e.categoryValue,void 0!==d.rawColor&&(i.color=d.rawColor),f.emit(b,{points:h,event:c,constraints:i})}function t(a,b){var c,d,e=G.select(b.parentNode).select("rect.catrect"),f=e.node().getBoundingClientRect(),g=e.datum(),h=g.parcatsViewModel,i=h.model.dimensions[g.model.dimensionInd],j=h.trace,k=f.top+f.height/2;h.dimensions.length>1&&i.displayInd===h.dimensions.length-1?(c=f.left,d="left"):(c=f.left+f.width,d="right");var l=g.model.count,m=g.model.categoryLabel,n=l/g.parcatsViewModel.model.count,o={countLabel:l,categoryLabel:m,probabilityLabel:n.toFixed(3)},p=[];-1!==g.parcatsViewModel.hoverinfoItems.indexOf("count")&&p.push(["Count:",o.countLabel].join(" ")),-1!==g.parcatsViewModel.hoverinfoItems.indexOf("probability")&&p.push(["P("+o.categoryLabel+"):",o.probabilityLabel].join(" "));var q=p.join("<br>");return{trace:j,x:c-a.left,y:k-a.top,text:q,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:d,hovertemplate:j.hovertemplate,hovertemplateLabels:o,eventData:[{data:j._input,fullData:j,count:l,category:m,probability:n}]}}function u(a){if(!a.parcatsViewModel.dragDimension&&-1===a.parcatsViewModel.hoverinfoItems.indexOf("skip")){if(G.mouse(this)[1]<-1)return;var b,c=a.parcatsViewModel.graphDiv,d=c._fullLayout,e=d._paperdiv.node().getBoundingClientRect(),f=a.parcatsViewModel.hoveron;"color"===f?(function(a){var b=G.select(a).datum(),c=q(b);n(c),c.each(function(){J.raiseToTop(this)}),G.select(a.parentNode).selectAll("rect.bandrect").filter(function(a){return a.color===b.color}).each(function(){J.raiseToTop(this),G.select(this).attr("stroke","black").attr("stroke-width",1.5)})}(this),s(this,"plotly_hover",G.event)):(function(a){G.select(a.parentNode).selectAll("rect.bandrect").each(function(a){var b=q(a);n(b),b.each(function(){J.raiseToTop(this)})}),G.select(a.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),r(this,"plotly_hover",G.event)),-1===a.parcatsViewModel.hoverinfoItems.indexOf("none")&&("category"===f?b=t(e,this):"color"===f?b=function(a,b){var c,d,e=b.getBoundingClientRect(),f=G.select(b).datum(),g=f.categoryViewModel,h=g.parcatsViewModel,i=h.model.dimensions[g.model.dimensionInd],j=h.trace,k=e.y+e.height/2;h.dimensions.length>1&&i.displayInd===h.dimensions.length-1?(c=e.left,d="left"):(c=e.left+e.width,d="right");var l=g.model.categoryLabel,m=f.parcatsViewModel.model.count,n=0;f.categoryViewModel.bands.forEach(function(a){a.color===f.color&&(n+=a.count)});var o=g.model.count,p=0;h.pathSelection.each(function(a){a.model.color===f.color&&(p+=a.model.count)});var q=n/m,r=n/p,s=n/o,t={countLabel:m,categoryLabel:l,probabilityLabel:q.toFixed(3)},u=[];-1!==g.parcatsViewModel.hoverinfoItems.indexOf("count")&&u.push(["Count:",t.countLabel].join(" ")),-1!==g.parcatsViewModel.hoverinfoItems.indexOf("probability")&&(u.push("P(color  "+l+"): "+t.probabilityLabel),u.push("P("+l+" | color): "+r.toFixed(3)),u.push("P(color | "+l+"): "+s.toFixed(3)));var v=u.join("<br>"),w=L.mostReadable(f.color,["black","white"]);return{trace:j,x:c-a.left,y:k-a.top,text:v,color:f.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:w,fontSize:10,idealAlign:d,hovertemplate:j.hovertemplate,hovertemplateLabels:t,eventData:[{data:j._input,fullData:j,category:l,count:m,probability:q,categorycount:o,colorcount:p,bandcolorcount:n}]}}(e,this):"dimension"===f&&(b=function(a,b){var c=[];return G.select(b.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){c.push(t(a,this))}),c}(e,this)),b&&I.loneHover(b,{container:d._hoverlayer.node(),outerContainer:d._paper.node(),gd:c}))}}function v(a){var b=a.parcatsViewModel;b.dragDimension||(m(b.pathSelection),o(b.dimensionSelection.selectAll("g.category")),p(b.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),I.loneUnhover(b.graphDiv._fullLayout._hoverlayer.node()),b.pathSelection.sort(g),-1!==b.hoverinfoItems.indexOf("skip"))||("color"===a.parcatsViewModel.hoveron?s(this,"plotly_unhover",G.event):r(this,"plotly_unhover",G.event))}function w(a){"fixed"!==a.parcatsViewModel.arrangement&&(a.dragDimensionDisplayInd=a.model.displayInd,a.initialDragDimensionDisplayInds=a.parcatsViewModel.model.dimensions.map(function(a){return a.displayInd}),a.dragHasMoved=!1,a.dragCategoryDisplayInd=null,G.select(this).selectAll("g.category").select("rect.catrect").each(function(b){var c=G.mouse(this)[0],d=G.mouse(this)[1];-2<=c&&c<=b.width+2&&-2<=d&&d<=b.height+2&&(a.dragCategoryDisplayInd=b.model.displayInd,a.initialDragCategoryDisplayInds=a.model.categories.map(function(a){return a.displayInd}),b.model.dragY=b.y,J.raiseToTop(this.parentNode),G.select(this.parentNode).selectAll("rect.bandrect").each(function(b){b.y<d&&d<=b.y+b.height&&(a.potentialClickBand=this)}))}),a.parcatsViewModel.dragDimension=a,I.loneUnhover(a.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function x(a){if("fixed"!==a.parcatsViewModel.arrangement&&(a.dragHasMoved=!0,null!==a.dragDimensionDisplayInd)){var b=a.dragDimensionDisplayInd,c=b-1,d=b+1,e=a.parcatsViewModel.dimensions[b];if(null!==a.dragCategoryDisplayInd){var f=e.categories[a.dragCategoryDisplayInd];f.model.dragY+=G.event.dy;var g=f.model.dragY,h=f.model.displayInd,i=e.categories,j=i[h-1],k=i[h+1];void 0!==j&&g<j.y+j.height/2&&(f.model.displayInd=j.model.displayInd,j.model.displayInd=h),void 0!==k&&g+f.height>k.y+k.height/2&&(f.model.displayInd=k.model.displayInd,k.model.displayInd=h),a.dragCategoryDisplayInd=f.model.displayInd}if(null===a.dragCategoryDisplayInd||"freeform"===a.parcatsViewModel.arrangement){e.model.dragX=G.event.x;var l=a.parcatsViewModel.dimensions[c],m=a.parcatsViewModel.dimensions[d];void 0!==l&&e.model.dragX<l.x+l.width&&(e.model.displayInd=l.model.displayInd,l.model.displayInd=b),void 0!==m&&e.model.dragX+e.width>m.x&&(e.model.displayInd=m.model.displayInd,m.model.displayInd=a.dragDimensionDisplayInd),a.dragDimensionDisplayInd=e.model.displayInd}E(a.parcatsViewModel),D(a.parcatsViewModel),B(a.parcatsViewModel),A(a.parcatsViewModel)}}function y(a){if("fixed"!==a.parcatsViewModel.arrangement&&null!==a.dragDimensionDisplayInd){G.select(this).selectAll("text").attr("font-weight","normal");var b={},c=z(a.parcatsViewModel),d=a.parcatsViewModel.model.dimensions.map(function(a){return a.displayInd}),e=a.initialDragDimensionDisplayInds.some(function(a,b){return a!==d[b]});e&&d.forEach(function(c,d){var e=a.parcatsViewModel.model.dimensions[d].containerInd;b["dimensions["+e+"].displayindex"]=c});var f=!1;if(null!==a.dragCategoryDisplayInd){var g=a.model.categories.map(function(a){return a.displayInd});if(f=a.initialDragCategoryDisplayInds.some(function(a,b){return a!==g[b]})){var h=a.model.categories.slice().sort(function(a,b){return a.displayInd-b.displayInd}),i=h.map(function(a){return a.categoryValue}),j=h.map(function(a){return a.categoryLabel});b["dimensions["+a.model.containerInd+"].categoryarray"]=[i],b["dimensions["+a.model.containerInd+"].ticktext"]=[j],b["dimensions["+a.model.containerInd+"].categoryorder"]="array"}}-1===a.parcatsViewModel.hoverinfoItems.indexOf("skip")&&!a.dragHasMoved&&a.potentialClickBand&&("color"===a.parcatsViewModel.hoveron?s(a.potentialClickBand,"plotly_click",G.event.sourceEvent):r(a.potentialClickBand,"plotly_click",G.event.sourceEvent)),a.model.dragX=null,null!==a.dragCategoryDisplayInd&&(a.parcatsViewModel.dimensions[a.dragDimensionDisplayInd].categories[a.dragCategoryDisplayInd].model.dragY=null,a.dragCategoryDisplayInd=null),a.dragDimensionDisplayInd=null,a.parcatsViewModel.dragDimension=null,a.dragHasMoved=null,a.potentialClickBand=null,E(a.parcatsViewModel),D(a.parcatsViewModel),G.transition().duration(300).ease("cubic-in-out").each(function(){B(a.parcatsViewModel,!0),A(a.parcatsViewModel,!0)}).each("end",function(){(e||f)&&H.restyle(a.parcatsViewModel.graphDiv,b,[c])})}}function z(a){for(var b,c=a.graphDiv._fullData,d=0;d<c.length;d++)if(a.key===c[d].uid){b=d;break}return b}function A(a,b){var c;void 0===b&&(b=!1),a.pathSelection.data(function(a){return a.paths},e),(c=a.pathSelection,b?c.transition():c).attr("d",function(a){return a.svgD})}function B(a,b){function c(a){return b?a.transition():a}void 0===b&&(b=!1),a.dimensionSelection.data(function(a){return a.dimensions},e);var d=a.dimensionSelection.selectAll("g.category").data(function(a){return a.categories},e);c(a.dimensionSelection).attr("transform",function(a){return"translate("+a.x+", 0)"}),c(d).attr("transform",function(a){return"translate(0, "+a.y+")"}),d.select(".dimlabel").text(function(a,b){return 0===b?a.parcatsViewModel.model.dimensions[a.model.dimensionInd].dimensionLabel:null}),d.select(".catlabel").attr("text-anchor",function(a){return f(a)?"start":"end"}).attr("x",function(a){return f(a)?a.width+5:-5}).each(function(a){var b,c;f(a)?(b=a.width+5,c="start"):(b=-5,c="end"),G.select(this).selectAll("tspan").attr("x",b).attr("text-anchor",c)});var g=d.selectAll("rect.bandrect").data(function(a){return a.bands},e),h=g.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(a){return a.color}).attr("fill-opacity",0);g.attr("fill",function(a){return a.color}).attr("width",function(a){return a.width}).attr("height",function(a){return a.height}).attr("y",function(a){return a.y}),p(h),g.each(function(){J.raiseToTop(this)}),g.exit().remove()}function C(a,b,c,d,e){var f,g,h=[],i=[];for(g=0;g<c.length-1;g++)f=G.interpolateNumber(c[g]+a[g],a[g+1]),h.push(f(e)),i.push(f(1-e));var j="M "+a[0]+","+b[0];for(j+="l"+c[0]+",0 ",g=1;g<c.length;g++)j+="C"+h[g-1]+","+b[g-1]+" "+i[g-1]+","+b[g]+" "+a[g]+","+b[g],j+="l"+c[g]+",0 ";for(j+="l0,"+d+" ",j+="l -"+c[c.length-1]+",0 ",g=c.length-2;g>=0;g--)j+="C"+i[g]+","+(b[g+1]+d)+" "+h[g]+","+(b[g]+d)+" "+(a[g]+c[g])+","+(b[g]+d),j+="l-"+c[g]+",0 ";return j+="Z"}function D(a){function b(a){var b=a.categoryInds.map(function(a,b){return f[b][a]});return h.map(function(a){return b[a]})}var c=a.dimensions,d=a.model,e=c.map(function(a){return a.categories.map(function(a){return a.y})}),f=a.model.dimensions.map(function(a){return a.categories.map(function(a){return a.displayInd})}),g=a.model.dimensions.map(function(a){return a.displayInd}),h=a.dimensions.map(function(a){return a.model.dimensionInd}),i=c.map(function(a){return a.x}),j=c.map(function(a){return a.width}),k=[];for(var l in d.paths)d.paths.hasOwnProperty(l)&&k.push(d.paths[l]);k.sort(function(c,d){var e=b(c),f=b(d);return"backward"===a.sortpaths&&(e.reverse(),f.reverse()),e.push(c.valueInds[0]),f.push(d.valueInds[0]),a.bundlecolors&&(e.unshift(c.rawColor),f.unshift(d.rawColor)),e<f?-1:e>f?1:0});for(var m=new Array(k.length),n=c[0].model.count,o=c[0].categories.map(function(a){return a.height}).reduce(function(a,b){return a+b}),p=0;p<k.length;p++){var q,r=k[p];q=n>0?o*(r.count/n):0;for(var s,t=new Array(e.length),u=0;u<r.categoryInds.length;u++){var v=r.categoryInds[u],w=f[u][v],x=g[u];t[x]=e[x][w],e[x][w]+=q;var y=a.dimensions[x].categories[w],z=y.bands.length,A=y.bands[z-1];if(void 0===A||r.rawColor!==A.rawColor){var B=void 0===A?0:A.y+A.height;y.bands.push({key:B,color:r.color,rawColor:r.rawColor,height:q,width:y.width,count:r.count,y:B,categoryViewModel:y,parcatsViewModel:a})}else{var D=y.bands[z-1];D.height+=q,D.count+=r.count}}s="hspline"===a.pathShape?C(i,t,j,q,.5):C(i,t,j,q,0),m[p]={key:r.valueInds[0],model:r,height:q,leftXs:i,topYs:t,dimWidths:j,svgD:s,parcatsViewModel:a}}a.paths=m}function E(a){var b=a.model.dimensions.map(function(a){return{displayInd:a.displayInd,dimensionInd:a.dimensionInd}});b.sort(function(a,b){return a.displayInd-b.displayInd});var c=[];for(var d in b){var e=b[d].dimensionInd,f=a.model.dimensions[e];c.push(F(a,f))}a.dimensions=c}function F(a,b){var c,d=a.model.dimensions.length,e=b.displayInd;c=40+(d>1?(a.width-80-16)/(d-1):0)*e;var f,g,h,i,j,k=[],l=a.model.maxCats,m=b.categories.length,n=b.count,o=a.height-8*(l-1),p=8*(l-m)/2,q=b.categories.map(function(a){return{displayInd:a.displayInd,categoryInd:a.categoryInd}});for(q.sort(function(a,b){return a.displayInd-b.displayInd}),j=0;j<m;j++)i=q[j].categoryInd,g=b.categories[i],f=n>0?g.count/n*o:0,h={key:g.valueInds[0],model:g,width:16,height:f,y:null!==g.dragY?g.dragY:p,bands:[],parcatsViewModel:a},p=p+f+8,k.push(h);return{key:b.dimensionInd,x:null!==b.dragX?b.dragX:c,y:0,width:16,model:b,categories:k,parcatsViewModel:a,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}var G=a("d3"),H=a("../../plot_api/plot_api"),I=a("../../components/fx"),J=a("../../lib"),K=a("../../components/drawing"),L=a("tinycolor2"),M=a("../../lib/svg_text_utils");b.exports=function(a,b,c,e){d(c,a,e,b)}},{"../../components/drawing":615,"../../components/fx":632,"../../lib":719,"../../lib/svg_text_utils":743,"../../plot_api/plot_api":754,d3:164,tinycolor2:538}],1072:[function(a,b,c){"use strict";var d=a("./parcats");b.exports=function(a,b,c,e){var f=a._fullLayout,g=f._paper,h=f._size;d(a,g,b,{width:h.w,height:h.h,margin:{t:h.t,r:h.r,b:h.b,l:h.l}},c,e)}},{"./parcats":1071}],1073:[function(a,b,c){"use strict";var d=a("../../components/colorscale/attributes"),e=a("../../plots/cartesian/layout_attributes"),f=a("../../plots/font_attributes"),g=a("../../plots/domain").attributes,h=a("../../lib/extend").extendFlat,i=a("../../plot_api/plot_template").templatedArray;b.exports={domain:g({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:f({editType:"plot"}),tickfont:f({editType:"plot"}),rangefont:f({editType:"plot"}),dimensions:i("dimension",{label:{valType:"string",editType:"plot"},tickvals:h({},e.tickvals,{editType:"plot"}),ticktext:h({},e.ticktext,{editType:"plot"}),tickformat:h({},e.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:h({editType:"calc"},d("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plot_api/plot_template":757,"../../plots/cartesian/layout_attributes":779,"../../plots/domain":792,"../../plots/font_attributes":793}],1074:[function(a,b,c){"use strict";function d(a,b){return a*(1-z)+b*z}function e(a,b){return a*(1-A)+b*A}function f(a,b,c,f){if(function(a,b){for(var c=0;c<b.length;c++)if(a>=b[c][0]&&a<=b[c][1])return!0;return!1}(c,f))return c;var g=a?-1:1,h=0,i=b.length-1;if(g<0){var j=h;h=i,i=j}for(var k=b[h],l=k,m=h;g*m<g*i;m+=g){var n=m+g,o=b[n];if(g*c<g*e(k,o))return d(k,l);if(g*c<g*o||n===i)return d(o,k);l=k,k=o}}function g(a){a.attr("x",-u.bar.captureWidth/2).attr("width",u.bar.captureWidth)}function h(a){a.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function i(a){if(!a.brush.filterSpecified)return"0,"+a.height;for(var b,c,d,e=j(a.brush.filter.getConsolidated(),a.height),f=[0],g=e.length?e[0][0]:null,h=0;h<e.length;h++)c=(b=e[h])[1]-b[0],f.push(g),f.push(c),(d=h+1)<e.length&&(g=e[d][0]-b[1]);return f.push(a.height),f}function j(a,b){return a.map(function(a){return a.map(function(a){return Math.max(0,a*b)}).sort(y)})}function k(){v.select(document.body).style("cursor",null)}function l(a){a.attr("stroke-dasharray",i)}function m(a,b){var c=v.select(a).selectAll(".highlight, .highlight-shadow");l(b?c.transition().duration(u.bar.snapDuration).each("end",b):c)}function n(a,b){var c,d=a.brush,e=NaN,f={};if(d.filterSpecified){var g=a.height,h=d.filter.getConsolidated(),i=j(h,g),k=NaN,l=NaN,m=NaN;for(c=0;c<=i.length;c++){var n=i[c];if(n&&n[0]<=b&&b<=n[1]){k=c;break}if(l=c?c-1:NaN,n&&n[0]>b){m=c;break}}if(e=k,isNaN(e)&&(e=isNaN(l)||isNaN(m)?isNaN(l)?m:l:b-i[l][1]<i[m][0]-b?l:m),!isNaN(e)){var o=i[e],p=function(a,b){var c=u.bar.handleHeight;if(!(b>a[1]+c||b<a[0]-c))return b>=.9*a[1]+.1*a[0]?"n":b<=.9*a[0]+.1*a[1]?"s":"ns"}(o,b);p&&(f.interval=h[e],f.intervalPix=o,f.region=p)}}if(a.ordinal&&!f.region){var q=a.unitTickvals,r=a.unitToPaddedPx.invert(b);for(c=0;c<q.length;c++){var s=[.25*q[Math.max(c-1,0)]+.75*q[c],.25*q[Math.min(c+1,q.length-1)]+.75*q[c]];if(r>=s[0]&&r<=s[1]){f.clickableOrdinalRange=s;break}}}return f}function o(a,b){v.event.sourceEvent.stopPropagation();var c=b.height-v.mouse(a)[1]-2*u.verticalPadding,d=b.brush.svgBrush;d.wasDragged=!0,d._dragging=!0,d.grabbingBar?d.newExtent=[c-d.grabPoint,c+d.barLength-d.grabPoint].map(b.unitToPaddedPx.invert):d.newExtent=[d.startExtent,b.unitToPaddedPx.invert(c)].sort(y),b.brush.filterSpecified=!0,d.extent=d.stayingIntervals.concat([d.newExtent]),d.brushCallback(b),m(a.parentNode)}function p(a,b){var c=n(b,b.height-v.mouse(a)[1]-2*u.verticalPadding),d="crosshair";c.clickableOrdinalRange?d="pointer":c.region&&(d=c.region+"-resize"),v.select(document.body).style("cursor",d)}function q(a){a.on("mousemove",function(a){v.event.preventDefault(),a.parent.inBrushDrag||p(this,a)}).on("mouseleave",function(a){a.parent.inBrushDrag||k()}).call(v.behavior.drag().on("dragstart",function(a){!function(a,b){v.event.sourceEvent.stopPropagation();var c=b.height-v.mouse(a)[1]-2*u.verticalPadding,d=b.unitToPaddedPx.invert(c),e=b.brush,f=n(b,c),g=f.interval,h=e.svgBrush;if(h.wasDragged=!1,h.grabbingBar="ns"===f.region,h.grabbingBar){var i=g.map(b.unitToPaddedPx);h.grabPoint=c-i[0]-u.verticalPadding,h.barLength=i[1]-i[0]}h.clickableOrdinalRange=f.clickableOrdinalRange,h.stayingIntervals=b.multiselect&&e.filterSpecified?e.filter.getConsolidated():[],g&&(h.stayingIntervals=h.stayingIntervals.filter(function(a){return a[0]!==g[0]&&a[1]!==g[1]})),h.startExtent=f.region?g["s"===f.region?1:0]:d,b.parent.inBrushDrag=!0,h.brushStartCallback()}(this,a)}).on("drag",function(a){o(this,a)}).on("dragend",function(a){!function(a,b){var c=b.brush,d=c.filter,e=c.svgBrush;e._dragging||(p(a,b),o(a,b),b.brush.svgBrush.wasDragged=!1),e._dragging=!1,v.event.sourceEvent.stopPropagation();var g=e.grabbingBar;if(e.grabbingBar=!1,e.grabLocation=void 0,b.parent.inBrushDrag=!1,k(),!e.wasDragged)return e.wasDragged=void 0,e.clickableOrdinalRange?c.filterSpecified&&b.multiselect?e.extent.push(e.clickableOrdinalRange):(e.extent=[e.clickableOrdinalRange],c.filterSpecified=!0):g?(e.extent=e.stayingIntervals,0===e.extent.length&&s(c)):s(c),e.brushCallback(b),m(a.parentNode),void e.brushEndCallback(c.filterSpecified?d.getConsolidated():[]);var h=function(){d.set(d.getConsolidated())};if(b.ordinal){var i=b.unitTickvals;i[i.length-1]<i[0]&&i.reverse(),e.newExtent=[f(0,i,e.newExtent[0],e.stayingIntervals),f(1,i,e.newExtent[1],e.stayingIntervals)];var j=e.newExtent[1]>e.newExtent[0];e.extent=e.stayingIntervals.concat(j?[e.newExtent]:[]),e.extent.length||s(c),e.brushCallback(b),j?m(a.parentNode,h):(h(),m(a.parentNode))}else h();e.brushEndCallback(c.filterSpecified?d.getConsolidated():[])}(this,a)}))}function r(a,b){return a[0]-b[0]}function s(a){a.filterSpecified=!1,a.svgBrush.extent=[[-1/0,1/0]]}function t(a){for(var b,c=a.slice(),d=[],e=c.shift();e;){for(b=e.slice();(e=c.shift())&&e[0]<=b[1];)b[1]=Math.max(b[1],e[1]);d.push(b)}return d}var u=a("./constants"),v=a("d3"),w=a("../../lib/gup").keyFun,x=a("../../lib/gup").repeat,y=a("../../lib").sorterAsc,z=u.bar.snapRatio,A=u.bar.snapClose;b.exports={makeBrush:function(a,b,c,d,e,f){var g,h=function(){var a,b,c=[];return{set:function(d){1===(c=d.map(function(a){return a.slice().sort(y)}).sort(r)).length&&c[0][0]===-1/0&&c[0][1]===1/0&&(c=[[0,-1]]),a=t(c),b=c.reduce(function(a,b){return[Math.min(a[0],b[0]),Math.max(a[1],b[1])]},[1/0,-1/0])},get:function(){return c.slice()},getConsolidated:function(){return a},getBounds:function(){return b}}}();return h.set(c),{filter:h,filterSpecified:b,svgBrush:{extent:[],brushStartCallback:d,brushCallback:(g=e,function(a){var b=a.brush,c=function(a){return a.svgBrush.extent.map(function(a){return a.slice()})}(b).slice();b.filter.set(c),g()}),brushEndCallback:f}}},ensureAxisBrush:function(a){var b=a.selectAll("."+u.cn.axisBrush).data(x,w);b.enter().append("g").classed(u.cn.axisBrush,!0),function(a){var b=a.selectAll(".background").data(x);b.enter().append("rect").classed("background",!0).call(g).call(h).style("pointer-events","auto").attr("transform","translate(0 "+u.verticalPadding+")"),b.call(q).attr("height",function(a){return a.height-u.verticalPadding});var c=a.selectAll(".highlight-shadow").data(x);c.enter().append("line").classed("highlight-shadow",!0).attr("x",-u.bar.width/2).attr("stroke-width",u.bar.width+u.bar.strokeWidth).attr("stroke",u.bar.strokeColor).attr("opacity",u.bar.strokeOpacity).attr("stroke-linecap","butt"),c.attr("y1",function(a){return a.height}).call(l);var d=a.selectAll(".highlight").data(x);d.enter().append("line").classed("highlight",!0).attr("x",-u.bar.width/2).attr("stroke-width",u.bar.width-u.bar.strokeWidth).attr("stroke",u.bar.fillColor).attr("opacity",u.bar.fillOpacity).attr("stroke-linecap","butt"),d.attr("y1",function(a){return a.height}).call(l)}(b)},cleanRanges:function(a,b){if(Array.isArray(a[0])?(a=a.map(function(a){return a.sort(y)}),a=b.multiselect?t(a.sort(r)):[a[0]]):a=[a.sort(y)],b.tickvals){var c=b.tickvals.slice().sort(y);if(!(a=a.map(function(a){var b=[f(0,c,a[0],[]),f(1,c,a[1],[])];if(b[1]>b[0])return b}).filter(function(a){return a})).length)return}return a.length>1?a:a[0]}}},{"../../lib":719,"../../lib/gup":717,"./constants":1077,d3:164}],1075:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../plots/get_data").getModuleCalcData,f=a("./plot"),g=a("../../constants/xmlns_namespaces");c.name="parcoords",c.plot=function(a){var b=e(a.calcdata,"parcoords")[0];b.length&&f(a,b)},c.clean=function(a,b,c,d){var e=d._has&&d._has("parcoords"),f=b._has&&b._has("parcoords");e&&!f&&(d._paperdiv.selectAll(".parcoords").remove(),d._glimages.selectAll("*").remove())},c.toSVG=function(a){var b=a._fullLayout._glimages,c=d.select(a).selectAll(".svg-container");c.filter(function(a,b){return b===c.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var a=this.toDataURL("image/png");b.append("svg:image").attr({xmlns:g.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:this.width,height:this.height})}),window.setTimeout(function(){d.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":696,"../../plots/get_data":802,"./plot":1084,d3:164}],1076:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray,e=a("../../components/colorscale"),f=a("../../lib/gup").wrap;b.exports=function(a,b){var c,g;return e.hasColorscale(b,"line")&&d(b.line.color)?(c=b.line.color,g=e.extractOpts(b.line).colorscale,e.calc(a,b,{vals:c,containerStr:"line",cLetter:"c"})):(c=function(a){for(var b=new Array(a),c=0;c<a;c++)b[c]=.5;return b}(b._length),g=[[0,b.line.color],[1,b.line.color]]),f({lineColor:c,cscale:g})}},{"../../components/colorscale":606,"../../lib":719,"../../lib/gup":717}],1077:[function(a,b,c){"use strict";b.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeColor:"white",strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1078:[function(a,b,c){"use strict";function d(a,b,c,d){function f(c,d){return e.coerce(a,b,k.dimensions,c,d)}var g=f("values"),h=f("visible");if(g&&g.length||(h=b.visible=!1),h){f("label"),f("tickvals"),f("ticktext"),f("tickformat");var i=f("range");b._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:i},j.setConvert(b._ax,d.layout),f("multiselect");var m=f("constraintrange");m&&(b.constraintrange=l.cleanRanges(m,b))}}var e=a("../../lib"),f=a("../../components/colorscale/helpers").hasColorscale,g=a("../../components/colorscale/defaults"),h=a("../../plots/domain").defaults,i=a("../../plots/array_container_defaults"),j=a("../../plots/cartesian/axes"),k=a("./attributes"),l=a("./axisbrush"),m=a("./constants").maxDimensionCount,n=a("./merge_length");b.exports=function(a,b,c,j){function l(c,d){return e.coerce(a,b,k,c,d)}var o=a.dimensions;Array.isArray(o)&&o.length>m&&(e.log("parcoords traces support up to "+m+" dimensions at the moment"),o.splice(m));var p=i(a,b,{name:"dimensions",layout:j,handleItemDefaults:d}),q=function(a,b,c,d,h){var i=h("line.color",c);if(f(a,"line")&&e.isArrayOrTypedArray(i)){if(i.length)return h("line.colorscale"),g(a,b,d,h,{prefix:"line.",cLetter:"c"}),i.length;b.line.color=c}return 1/0}(a,b,c,j,l);h(b,j,l),Array.isArray(p)&&p.length||(b.visible=!1),n(b,p,"values",q);var r={family:j.font.family,size:Math.round(j.font.size/1.2),color:j.font.color};e.coerceFont(l,"labelfont",r),e.coerceFont(l,"tickfont",r),e.coerceFont(l,"rangefont",r),l("labelangle"),l("labelside")}},{"../../components/colorscale/defaults":604,"../../components/colorscale/helpers":605,"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/cartesian/axes":767,"../../plots/domain":792,"./attributes":1073,"./axisbrush":1074,"./constants":1077,"./merge_length":1082}],1079:[function(a,b,c){"use strict";var d=a("../../lib").isTypedArray;c.convertTypedArray=function(a){return d(a)?Array.prototype.slice.call(a):a},c.isOrdinal=function(a){return!!a.tickvals},c.isVisible=function(a){return a.visible||!("visible"in a)}},{"../../lib":719}],1080:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:a("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":1073,"./base_plot":1075,"./calc":1076,"./defaults":1078,"./plot":1084}],1081:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=a._gl;f.enable(f.SCISSOR_TEST),f.scissor(b,c,d,e),a.clear({color:[0,0,0,0],depth:1})}function e(a,b,c,e,f,g){var h=g.key;c.drawCompleted||(function(a){a.read({x:0,y:0,width:1,height:1,data:s})}(a),c.drawCompleted=!0),function i(j){var k=Math.min(e,f-j*e);0===j&&(window.cancelAnimationFrame(c.currentRafs[h]),delete c.currentRafs[h],d(a,g.scissorX,g.scissorY,g.scissorWidth,g.viewBoxSize[1])),c.clearOnly||(g.count=2*k,g.offset=2*j*e,b(g),j*e+k<f&&(c.currentRafs[h]=window.requestAnimationFrame(function(){i(j+1)})),c.drawCompleted=!1)}(0)}function f(a,b){return(a>>>8*b)%256/255}function g(a,b,c){for(var d=new Array(8*b),e=0,f=0;f<b;f++)for(var g=0;g<2;g++)for(var h=0;h<4;h++){var i=4*a+h,j=c[64*f+i];63===i&&0===g&&(j*=-1),d[e++]=j}return d}function h(a){var b="0"+a;return b.substr(b.length-2)}function i(a){return a<o?"p"+h(a+1)+"_"+h(a+4):"colors"}function j(a,b,c,d,e,f,g,h,i,j,k,l,m){for(var n=[[],[]],o=0;o<64;o++)n[0][o]=o===e?1:0,n[1][o]=o===f?1:0;var q=a.lines.canvasOverdrag,r=a.domain,s=a.canvasWidth,t=a.canvasHeight,u=a.deselectedLines.color;return p.extendFlat({key:k,resolution:[s,t],viewBoxPos:[g+q,h],viewBoxSize:[i,j],i0:e,i1:f,dim0A:n[0].slice(0,16),dim0B:n[0].slice(16,32),dim0C:n[0].slice(32,48),dim0D:n[0].slice(48,64),dim1A:n[1].slice(0,16),dim1B:n[1].slice(16,32),dim1C:n[1].slice(32,48),dim1D:n[1].slice(48,64),drwLayer:l,contextColor:[u[0]/255,u[1]/255,u[2]/255,u[3]<1?u[3]:Math.max(1/255,Math.pow(1/a.lines.color.length,1/3))],scissorX:(d===b?0:g+q)+(a.pad.l-q)+a.layoutWidth*r.x[0],scissorWidth:(d===c?s-g+q:i+.5)+(d===b?g+q:0),scissorY:h+a.pad.b+a.layoutHeight*r.y[0],scissorHeight:j,viewportX:a.pad.l-q+a.layoutWidth*r.x[0],viewportY:a.pad.b+a.layoutHeight*r.y[0],viewportWidth:s,viewportHeight:t},m)}function k(a){var b=r-1,c=Math.max(0,Math.floor(a[0]*b),0),d=Math.min(b,Math.ceil(a[1]*b),b);return[Math.min(c,d),Math.max(c,d)]}
var l=a("glslify"),m=l(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nattribute vec4 p01_04, p05_08, p09_12, p13_16,\n               p17_20, p21_24, p25_28, p29_32,\n               p33_36, p37_40, p41_44, p45_48,\n               p49_52, p53_56, p57_60, colors;\n\nuniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution, viewBoxPos, viewBoxSize;\nuniform sampler2D mask, palette;\nuniform float maskHeight;\nuniform float drwLayer; // 0: context, 1: focus, 2: pick\nuniform vec4 contextColor;\n\nbool isPick    = (drwLayer > 1.5);\nbool isContext = (drwLayer < 0.5);\n\nconst vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);\nconst vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * UNITS, UNITS);\n}\n\nfloat axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);\n    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);\n    return y1 * (1.0 - ratio) + y2 * ratio;\n}\n\nint iMod(int a, int b) {\n    return a - b * (a / b);\n}\n\nbool fOutside(float p, float lo, float hi) {\n    return (lo < hi) && (lo > p || p > hi);\n}\n\nbool vOutside(vec4 p, vec4 lo, vec4 hi) {\n    return (\n        fOutside(p[0], lo[0], hi[0]) ||\n        fOutside(p[1], lo[1], hi[1]) ||\n        fOutside(p[2], lo[2], hi[2]) ||\n        fOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool mOutside(mat4 p, mat4 lo, mat4 hi) {\n    return (\n        vOutside(p[0], lo[0], hi[0]) ||\n        vOutside(p[1], lo[1], hi[1]) ||\n        vOutside(p[2], lo[2], hi[2]) ||\n        vOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {\n    return mOutside(A, loA, hiA) ||\n           mOutside(B, loB, hiB) ||\n           mOutside(C, loC, hiC) ||\n           mOutside(D, loD, hiD);\n}\n\nbool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {\n    mat4 pnts[4];\n    pnts[0] = A;\n    pnts[1] = B;\n    pnts[2] = C;\n    pnts[3] = D;\n\n    for(int i = 0; i < 4; ++i) {\n        for(int j = 0; j < 4; ++j) {\n            for(int k = 0; k < 4; ++k) {\n                if(0 == iMod(\n                    int(255.0 * texture2D(mask,\n                        vec2(\n                            (float(i * 2 + j / 2) + 0.5) / 8.0,\n                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight\n                        ))[3]\n                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),\n                    2\n                )) return true;\n            }\n        }\n    }\n    return false;\n}\n\nvec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float x = 0.5 * sign(v) + 0.5;\n    float y = axisY(x, A, B, C, D);\n    float z = 1.0 - abs(v);\n\n    z += isContext ? 0.0 : 2.0 * float(\n        outsideBoundingBox(A, B, C, D) ||\n        outsideRasterMask(A, B, C, D)\n    );\n\n    return vec4(\n        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,\n        z,\n        1.0\n    );\n}\n\nvoid main() {\n    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);\n    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);\n    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);\n    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);\n\n    float v = colors[3];\n\n    gl_Position = position(isContext, v, A, B, C, D);\n\n    fragColor =\n        isContext ? vec4(contextColor) :\n        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));\n}\n"]),n=l(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]),o=a("./constants").maxDimensionCount,p=a("../../lib"),q=1e-6,r=2048,s=new Uint8Array(4),t=new Uint8Array(4),u={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};b.exports=function(a,b){function c(a){h=a.model,l=a.viewModel,s=l.dimensions.slice(),v=s[0]?s[0].values.length:0;var b=h.lines,c=y?b.color.map(function(a,c){return c/b.color.length}):b.color,d=function(a,b,c){for(var d,e=new Array(a*(o+4)),g=0,h=0;h<a;h++){for(var i=0;i<o;i++)e[g++]=i<b.length?b[i].paddedUnitValues[h]:.5;e[g++]=f(h,2),e[g++]=f(h,1),e[g++]=f(h,0),e[g++]=(d=c[h],Math.max(q,Math.min(1-q,d)))}return e}(v,s,c);!function(a,b,c){for(var d=0;d<=o;d+=4)a[i(d)](g(d/4,b,c))}(B,v,d),x||y||(C=z.texture(p.extendFlat({data:function(a,b){for(var c=new Array(256),d=0;d<256;d++)c[d]=a(d/255).concat(255);return c}(h.unitToColor)},u)))}var h,l,s,v,w,x=b.context,y=b.pick,z=b.regl,A={currentRafs:{},drawCompleted:!0,clearOnly:!1},B=function(a){for(var b={},c=0;c<=o;c+=4)b[i(c)]=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return b}(z),C=z.texture(u),D=[];c(b);var E=z({profile:!1,blend:{enable:x,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!x,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:z.prop("scissorX"),y:z.prop("scissorY"),width:z.prop("scissorWidth"),height:z.prop("scissorHeight")}},viewport:{x:z.prop("viewportX"),y:z.prop("viewportY"),width:z.prop("viewportWidth"),height:z.prop("viewportHeight")},dither:!1,vert:m,frag:n,primitive:"lines",lineWidth:1,attributes:B,uniforms:{resolution:z.prop("resolution"),viewBoxPos:z.prop("viewBoxPos"),viewBoxSize:z.prop("viewBoxSize"),dim0A:z.prop("dim0A"),dim1A:z.prop("dim1A"),dim0B:z.prop("dim0B"),dim1B:z.prop("dim1B"),dim0C:z.prop("dim0C"),dim1C:z.prop("dim1C"),dim0D:z.prop("dim0D"),dim1D:z.prop("dim1D"),loA:z.prop("loA"),hiA:z.prop("hiA"),loB:z.prop("loB"),hiB:z.prop("hiB"),loC:z.prop("loC"),hiC:z.prop("hiC"),loD:z.prop("loD"),hiD:z.prop("hiD"),palette:C,contextColor:z.prop("contextColor"),mask:z.prop("maskTexture"),drwLayer:z.prop("drwLayer"),maskHeight:z.prop("maskHeight")},offset:z.prop("offset"),count:z.prop("count")});return{render:function(a,b,c){var f,g,i,l=a.length,m=1/0,n=-1/0;for(f=0;f<l;f++)a[f].dim0.canvasX<m&&(m=a[f].dim0.canvasX,g=f),a[f].dim1.canvasX>n&&(n=a[f].dim1.canvasX,i=f);0===l&&d(z,0,0,h.canvasWidth,h.canvasHeight);var o=function(a){var b,c,d,e=[[],[]];for(d=0;d<64;d++){var f=!a&&d<s.length?s[d].brush.filter.getBounds():[-1/0,1/0];e[0][d]=f[0],e[1][d]=f[1]}var g=8*r,h=new Array(g);for(b=0;b<g;b++)h[b]=255;if(!a)for(b=0;b<s.length;b++){var i=b%8,j=(b-i)/8,l=Math.pow(2,i),m=s[b].brush.filter.get();if(!(m.length<2)){var n=k(m[0])[1];for(c=1;c<m.length;c++){var o=k(m[c]);for(d=n+1;d<o[0];d++)h[8*d+j]&=~l;n=Math.max(n,o[1])}}}var p={shape:[8,r],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:h};return w?w(p):w=z.texture(p),{maskTexture:w,maskHeight:r,loA:e[0].slice(0,16),loB:e[0].slice(16,32),loC:e[0].slice(32,48),loD:e[0].slice(48,64),hiA:e[1].slice(0,16),hiB:e[1].slice(16,32),hiC:e[1].slice(32,48),hiD:e[1].slice(48,64)}}(x);for(f=0;f<l;f++){var p=a[f],q=p.dim0.crossfilterDimensionIndex,t=p.dim1.crossfilterDimensionIndex,u=p.canvasX,B=p.canvasY,C=u+p.panelSizeX;if(b||!D[q]||D[q][0]!==u||D[q][1]!==C){D[q]=[u,C];var F=j(h,g,i,f,q,t,u,B,p.panelSizeX,p.panelSizeY,p.dim0.crossfilterDimensionIndex,x?0:y?2:1,o);A.clearOnly=c;var G=b?h.lines.blockLineCount:v;e(z,E,A,G,v,F)}}},readPixel:function(a,b){return z.read({x:a,y:b,width:1,height:1,data:t}),t},readPixels:function(a,b,c,d){var e=new Uint8Array(4*c*d);return z.read({x:a,y:b,width:c,height:d,data:e}),e},destroy:function(){for(var b in a.style["pointer-events"]="none",C.destroy(),w&&w.destroy(),B)B[b].destroy()},update:c}}},{"../../lib":719,"./constants":1077,glslify:410}],1082:[function(a,b,c){"use strict";b.exports=function(a,b,c,d){var e,f;for(d||(d=1/0),e=0;e<b.length;e++)(f=b[e]).visible&&(d=Math.min(d,f[c].length));for(d===1/0&&(d=0),a._length=d,e=0;e<b.length;e++)(f=b[e]).visible&&(f._length=d);return d}},{}],1083:[function(a,b,c){"use strict";function d(a,b,c){return s.aggNums(a,null,b,c)}function e(a,b){return g(d(Math.min,a,b),d(Math.max,a,b))}function f(a){var b=a.range;return b?g(b[0],b[1]):e(a.values,a._length)}function g(a,b){return!isNaN(a)&&isFinite(a)||(a=0),!isNaN(b)&&isFinite(b)||(b=0),a===b&&(0===a?(a-=1,b+=1):(a*=.9,b*=1.1)),[a,b]}function h(a){return a.dimensions.some(function(a){return a.brush.filterSpecified})}function i(a,b,c){var d=z(b),e=d.trace,g=A.convertTypedArray(d.lineColor),h=e.line,i={color:q(B.deselectedLineColor)},j=v.extractOpts(h),k=j.reversescale?v.flipScale(d.cscale):d.cscale,l=e.domain,m=e.dimensions,n=a.width,o=e.labelangle,r=e.labelside,t=e.labelfont,u=e.tickfont,w=e.rangefont,x=s.extendDeepNoArrays({},h,{color:g.map(p.scale.linear().domain(f({values:g,range:[j.min,j.max],_length:e._length}))),blockLineCount:B.blockLineCount,canvasOverdrag:B.overdrag*B.canvasPixelRatio}),y=Math.floor(n*(l.x[1]-l.x[0])),C=Math.floor(a.height*(l.y[1]-l.y[0])),D=a.margin||{l:80,r:80,t:100,b:80},E=y,F=C;return{key:c,colCount:m.filter(A.isVisible).length,dimensions:m,tickDistance:B.tickDistance,unitToColor:function(a){var b=a.map(function(a){return a[0]}),c=a.map(function(a){var b=q(a[1]);return p.rgb("rgb("+b[0]+","+b[1]+","+b[2]+")")}),d="rgb".split("").map(function(a){return p.scale.linear().clamp(!0).domain(b).range(c.map((d=a,function(a){return a[d]})));var d});return function(a){return d.map(function(b){return b(a)})}}(k),lines:x,deselectedLines:i,labelAngle:o,labelSide:r,labelFont:t,tickFont:u,rangeFont:w,layoutWidth:n,layoutHeight:a.height,domain:l,translateX:l.x[0]*n,translateY:a.height-l.y[1]*a.height,pad:D,canvasWidth:E*B.canvasPixelRatio+2*x.canvasOverdrag,canvasHeight:F*B.canvasPixelRatio,width:E,height:F,canvasPixelRatio:B.canvasPixelRatio}}function j(a,b,c){var d=c.width,e=c.height,g=c.dimensions,i=c.canvasPixelRatio,j=function(a){return d*a/Math.max(1,c.colCount-1)},k=B.verticalPadding/e,l=function(a,b){return p.scale.linear().range([b,a-b])}(e,B.verticalPadding),m={key:c.key,xScale:j,model:c,inBrushDrag:!1},n={};return m.dimensions=g.filter(A.isVisible).map(function(d,g){function o(a,b){return{val:a,text:z[b]}}function q(a,b){return a.val-b.val}var r=function(a,b){return p.scale.linear().domain(f(a)).range([b,1-b])}(d,k),t=n[d.label];n[d.label]=(t||0)+1;var u=d.label+(t?"__"+t:""),v=d.constraintrange,w=v&&v.length;w&&!Array.isArray(v[0])&&(v=[v]);var x=w?v.map(function(a){return a.map(r)}):[[-1/0,1/0]],y=d.values;y.length>d._length&&(y=y.slice(0,d._length));var z,D=d.tickvals;if(Array.isArray(D)&&D.length){z=d.ticktext,Array.isArray(z)&&z.length?z.length>D.length?z=z.slice(0,D.length):D.length>z.length&&(D=D.slice(0,z.length)):z=D.map(p.format(d.tickformat));for(var E=1;E<D.length;E++)if(D[E]<D[E-1]){for(var F=D.map(o).sort(q),G=0;G<D.length;G++)D[G]=F[G].val,z[G]=F[G].text;break}}else D=void 0;return y=A.convertTypedArray(y),y=A.convertTypedArray(y),{key:u,label:d.label,tickFormat:d.tickformat,tickvals:D,ticktext:z,ordinal:A.isOrdinal(d),multiselect:d.multiselect,xIndex:g,crossfilterDimensionIndex:g,visibleIndex:d._index,height:e,values:y,paddedUnitValues:y.map(r),unitTickvals:D&&D.map(r),xScale:j,x:j(g),canvasX:j(g)*i,unitToPaddedPx:l,domainScale:function(a,b,c,d,e){var g,h,i=f(c);return d?p.scale.ordinal().domain(d.map((g=p.format(c.tickformat),h=e,h?function(a,b){var c=h[b];return null==c?g(a):c}:g))).range(d.map(function(c){var d=(c-i[0])/(i[1]-i[0]);return a-b+d*(2*b-a)})):p.scale.linear().domain(i).range([a-b,b])}(e,B.verticalPadding,d,D,z),ordinalScale:function(a){if(a.tickvals){var b=f(a);return p.scale.ordinal().domain(a.tickvals).range(a.tickvals.map(function(a){return(a-b[0])/(b[1]-b[0])}))}}(d),parent:m,model:c,brush:C.makeBrush(a,w,x,function(){a.linePickActive(!1)},function(){var b=m;b.focusLayer&&b.focusLayer.render(b.panels,!0);var c=h(b);!a.contextShown()&&c?(b.contextLayer&&b.contextLayer.render(b.panels,!0),a.contextShown(!0)):a.contextShown()&&!c&&(b.contextLayer&&b.contextLayer.render(b.panels,!0,!0),a.contextShown(!1))},function(c){if(m.focusLayer.render(m.panels,!0),m.pickLayer&&m.pickLayer.render(m.panels,!0),a.linePickActive(!0),b&&b.filterChanged){var e=r.invert,f=c.map(function(a){return a.map(e).sort(s.sorterAsc)}).sort(function(a,b){return a[0]-b[0]});b.filterChanged(m.key,d._index,f)}})}}),m}function k(a){a.classed(B.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default").style("user-select","none")}function l(a,b){var c="top"===b?1:-1,d=a*Math.PI/180;return{dir:c,dx:Math.sin(d),dy:Math.cos(d),degrees:a}}function m(a,b){for(var c=b.panels||(b.panels=[]),d=a.data(),e=0;e<d.length-1;e++){var f=c[e]||(c[e]={}),g=d[e],h=d[e+1];f.dim0=g,f.dim1=h,f.canvasX=g.canvasX,f.panelSizeX=h.canvasX-g.canvasX,f.panelSizeY=b.model.canvasHeight,f.y=0,f.canvasY=0}}function n(a,b){return r.tickText(a._ax,b,!1).text}function o(a,b){if(a.ordinal)return"";var c=a.domainScale.domain(),d=c[b?c.length-1:0];return n(a.model.dimensions[a.visibleIndex],d)}var p=a("d3"),q=a("color-rgba"),r=a("../../plots/cartesian/axes"),s=a("../../lib"),t=a("../../lib/svg_text_utils"),u=a("../../components/drawing"),v=a("../../components/colorscale"),w=a("../../lib/gup"),x=w.keyFun,y=w.repeat,z=w.unwrap,A=a("./helpers"),B=a("./constants"),C=a("./axisbrush"),D=a("./lines");b.exports=function(a,b,c,d){var f=a._fullLayout,q=f._toppaper,v=f._glcontainer;!function(a){for(var b=0;b<a.length;b++)for(var c=0;c<a[b].length;c++)for(var d=a[b][c].trace,f=d.dimensions,h=0;h<f.length;h++){var i=f[h].values,j=f[h]._ax;j&&(j.range?j.range=g(j.range[0],j.range[1]):j.range=e(i,d._length),j.dtick||(j.dtick=.01*(Math.abs(j.range[1]-j.range[0])||1)),j.tickformat=f[h].tickformat,r.calcTicks(j),j.cleanRange())}}(b);var w,E,F=(w=!0,E=!1,{linePickActive:function(a){return arguments.length?w=!!a:w},contextShown:function(a){return arguments.length?E=!!a:E}}),G=b.filter(function(a){return z(a).trace.visible}).map(i.bind(0,c)).map(j.bind(0,F,d));v.each(function(a,b){return s.extendFlat(a,G[b])});var H=v.selectAll(".gl-canvas").each(function(a){a.viewModel=G[0],a.model=a.viewModel?a.viewModel.model:null}),I=null;H.filter(function(a){return a.pick}).style("pointer-events","auto").on("mousemove",function(a){if(F.linePickActive()&&a.lineLayer&&d&&d.hover){var b=p.event,c=this.width,e=this.height,f=p.mouse(this),g=f[0],h=f[1];if(g<0||h<0||g>=c||h>=e)return;var i=a.lineLayer.readPixel(g,e-1-h),j=0!==i[3],k=j?i[2]+256*(i[1]+256*i[0]):null,l={x:g,y:h,clientX:b.clientX,clientY:b.clientY,dataIndex:a.model.key,curveNumber:k};k!==I&&(j?d.hover(l):d.unhover&&d.unhover(l),I=k)}}),H.style("opacity",function(a){return a.pick?0:1}),q.style("background","rgba(255, 255, 255, 0)");var J=q.selectAll("."+B.cn.parcoords).data(G,x);J.exit().remove(),J.enter().append("g").classed(B.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),J.attr("transform",function(a){return"translate("+a.model.translateX+","+a.model.translateY+")"});var K=J.selectAll("."+B.cn.parcoordsControlView).data(y,x);K.enter().append("g").classed(B.cn.parcoordsControlView,!0),K.attr("transform",function(a){return"translate("+a.model.pad.l+","+a.model.pad.t+")"});var L=K.selectAll("."+B.cn.yAxis).data(function(a){return a.dimensions},x);L.enter().append("g").classed(B.cn.yAxis,!0),K.each(function(a){m(L,a)}),H.each(function(a){if(a.viewModel){!a.lineLayer||d?a.lineLayer=D(this,a):a.lineLayer.update(a),(a.key||0===a.key)&&(a.viewModel[a.key]=a.lineLayer);var b=!a.context||d;a.lineLayer.render(a.viewModel.panels,b)}}),L.attr("transform",function(a){return"translate("+a.xScale(a.xIndex)+", 0)"}),L.call(p.behavior.drag().origin(function(a){return a}).on("drag",function(a){var b=a.parent;F.linePickActive(!1),a.x=Math.max(-B.overdrag,Math.min(a.model.width+B.overdrag,p.event.x)),a.canvasX=a.x*a.model.canvasPixelRatio,L.sort(function(a,b){return a.x-b.x}).each(function(b,c){b.xIndex=c,b.x=a===b?b.x:b.xScale(b.xIndex),b.canvasX=b.x*b.model.canvasPixelRatio}),m(L,b),L.filter(function(b){return 0!==Math.abs(a.xIndex-b.xIndex)}).attr("transform",function(a){return"translate("+a.xScale(a.xIndex)+", 0)"}),p.select(this).attr("transform","translate("+a.x+", 0)"),L.each(function(c,d,e){e===a.parent.key&&(b.dimensions[d]=c)}),b.contextLayer&&b.contextLayer.render(b.panels,!1,!h(b)),b.focusLayer.render&&b.focusLayer.render(b.panels)}).on("dragend",function(a){var b=a.parent;a.x=a.xScale(a.xIndex),a.canvasX=a.x*a.model.canvasPixelRatio,m(L,b),p.select(this).attr("transform",function(a){return"translate("+a.x+", 0)"}),b.contextLayer&&b.contextLayer.render(b.panels,!1,!h(b)),b.focusLayer&&b.focusLayer.render(b.panels),b.pickLayer&&b.pickLayer.render(b.panels,!0),F.linePickActive(!0),d&&d.axesMoved&&d.axesMoved(b.key,b.dimensions.map(function(a){return a.crossfilterDimensionIndex}))})),L.exit().remove();var M=L.selectAll("."+B.cn.axisOverlays).data(y,x);M.enter().append("g").classed(B.cn.axisOverlays,!0),M.selectAll("."+B.cn.axis).remove();var N=M.selectAll("."+B.cn.axis).data(y,x);N.enter().append("g").classed(B.cn.axis,!0),N.each(function(a){var b=a.model.height/a.model.tickDistance,c=a.domainScale,d=c.domain();p.select(this).call(p.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(b,a.tickFormat).tickValues(a.ordinal?d:null).tickFormat(function(b){return A.isOrdinal(a)?b:n(a.model.dimensions[a.visibleIndex],b)}).scale(c)),u.font(N.selectAll("text"),a.model.tickFont)}),N.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),N.selectAll("text").style("text-shadow","1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff").style("cursor","default").style("user-select","none");var O=M.selectAll("."+B.cn.axisHeading).data(y,x);O.enter().append("g").classed(B.cn.axisHeading,!0);var P=O.selectAll("."+B.cn.axisTitle).data(y,x);P.enter().append("text").classed(B.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("user-select","none").style("pointer-events","auto"),P.text(function(a){return a.label}).each(function(b){var c=p.select(this);u.font(c,b.model.labelFont),t.convertToTspans(c,a)}).attr("transform",function(a){var b=l(a.model.labelAngle,a.model.labelSide),c=B.axisTitleOffset;return(b.dir>0?"":"translate(0,"+(2*c+a.model.height)+")")+"rotate("+b.degrees+")translate("+-c*b.dx+","+-c*b.dy+")"}).attr("text-anchor",function(a){var b=l(a.model.labelAngle,a.model.labelSide);return 2*Math.abs(b.dx)>Math.abs(b.dy)?b.dir*b.dx<0?"start":"end":"middle"});var Q=M.selectAll("."+B.cn.axisExtent).data(y,x);Q.enter().append("g").classed(B.cn.axisExtent,!0);var R=Q.selectAll("."+B.cn.axisExtentTop).data(y,x);R.enter().append("g").classed(B.cn.axisExtentTop,!0),R.attr("transform","translate(0,"+-B.axisExtentOffset+")");var S=R.selectAll("."+B.cn.axisExtentTopText).data(y,x);S.enter().append("text").classed(B.cn.axisExtentTopText,!0).call(k),S.text(function(a){return o(a,!0)}).each(function(a){u.font(p.select(this),a.model.rangeFont)});var T=Q.selectAll("."+B.cn.axisExtentBottom).data(y,x);T.enter().append("g").classed(B.cn.axisExtentBottom,!0),T.attr("transform",function(a){return"translate(0,"+(a.model.height+B.axisExtentOffset)+")"});var U=T.selectAll("."+B.cn.axisExtentBottomText).data(y,x);U.enter().append("text").classed(B.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(k),U.text(function(a){return o(a,!1)}).each(function(a){u.font(p.select(this),a.model.rangeFont)}),C.ensureAxisBrush(M)}},{"../../components/colorscale":606,"../../components/drawing":615,"../../lib":719,"../../lib/gup":717,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"./axisbrush":1074,"./constants":1077,"./helpers":1079,"./lines":1081,"color-rgba":123,d3:164}],1084:[function(a,b,c){"use strict";function d(a,b,c){var d=b.indexOf(c),e=a.indexOf(d);return-1===e&&(e+=b.length),e}var e=a("./parcoords"),f=a("../../lib/prepare_regl"),g=a("./helpers").isVisible;b.exports=function(a,b){var c=a._fullLayout;if(f(a)){var h={},i={},j={},k={},l=c._size;b.forEach(function(b,c){var d=b[0].trace;j[c]=d.index;var e=k[c]=d._fullInput.index;h[c]=a.data[e].dimensions,i[c]=a.data[e].dimensions.slice()}),e(a,b,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},{filterChanged:function(b,d,e){var f=i[b][d],g=e.map(function(a){return a.slice()}),h="dimensions["+d+"].constraintrange",l=c._tracePreGUI[a._fullData[j[b]]._fullInput.uid];if(void 0===l[h]){var m=f.constraintrange;l[h]=m||null}var n=a._fullData[j[b]].dimensions[d];g.length?(1===g.length&&(g=g[0]),f.constraintrange=g,n.constraintrange=g.slice(),g=[g]):(delete f.constraintrange,delete n.constraintrange,g=null);var o={};o[h]=g,a.emit("plotly_restyle",[o,[k[b]]])},hover:function(b){a.emit("plotly_hover",b)},unhover:function(b){a.emit("plotly_unhover",b)},axesMoved:function(b,c){var e=function(a,b){return function(c,e){return d(a,b,c)-d(a,b,e)}}(c,i[b].filter(g));h[b].sort(e),i[b].filter(function(a){return!g(a)}).sort(function(a){return i[b].indexOf(a)}).forEach(function(a){h[b].splice(h[b].indexOf(a),1),h[b].splice(i[b].indexOf(a),0,a)}),a.emit("plotly_restyle",[{dimensions:[h[b]]},[k[b]]])}})}}},{"../../lib/prepare_regl":732,"./helpers":1079,"./parcoords":1083}],1085:[function(a,b,c){"use strict";var d=a("../../plots/attributes"),e=a("../../plots/domain").attributes,f=a("../../plots/font_attributes"),g=a("../../components/color/attributes"),h=a("../../plots/template_attributes").hovertemplateAttrs,i=a("../../plots/template_attributes").texttemplateAttrs,j=a("../../lib/extend").extendFlat,k=f({editType:"plot",arrayOk:!0,colorEditType:"plot"});b.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:g.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:j({},d.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:h({},{keys:["label","color","value","percent","text"]}),texttemplate:i({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:j({},k,{}),insidetextfont:j({},k,{}),outsidetextfont:j({},k,{}),title:{text:{valType:"string",dflt:"",editType:"plot"},font:j({},k,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:e({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:j({},k,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":593,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/domain":792,"../../plots/font_attributes":793,"../../plots/template_attributes":843}],1086:[function(a,b,c){"use strict";var d=a("../../plots/plots");c.name="pie",c.plot=function(a,b,e,f){d.plotBasePlot(c.name,a,b,e,f)},c.clean=function(a,b,e,f){d.cleanBasePlot(c.name,a,b,e,f)}},{"../../plots/plots":828}],1087:[function(a,b,c){"use strict";function d(a){return function(b,c){return!!b&&!!(b=h(b)).isValid()&&(b=i.addOpacity(b,b.getAlpha()),a[c]||(a[c]=b),b)}}function e(a,b){var c,d=JSON.stringify(a),e=b[d];if(!e){for(e=a.slice(),c=0;c<a.length;c++)e.push(h(a[c]).lighten(20).toHexString());for(c=0;c<a.length;c++)e.push(h(a[c]).darken(20).toHexString());b[d]=e}return e}var f=a("fast-isnumeric"),g=a("../../lib").isArrayOrTypedArray,h=a("tinycolor2"),i=a("../../components/color"),j={};b.exports={calc:function(a,b){var c,e,h=[],i=a._fullLayout,j=i.hiddenlabels||[],k=b.labels,l=b.marker.colors||[],m=b.values,n=g(m)&&m.length;if(b.dlabel)for(k=new Array(m.length),c=0;c<m.length;c++)k[c]=String(b.label0+c*b.dlabel);var o={},p=d(i["_"+b.type+"colormap"]),q=(n?m:k).length,r=0,s=!1;for(c=0;c<q;c++){var t,u,v;if(n){if(t=m[c],!f(t))continue;if((t=+t)<0)continue}else t=1;void 0!==(u=k[c])&&""!==u||(u=c);var w=o[u=String(u)];void 0===w?(o[u]=h.length,(v=-1!==j.indexOf(u))||(r+=t),h.push({v:t,label:u,color:p(l[c],u),i:c,pts:[c],hidden:v})):(s=!0,(e=h[w]).v+=t,e.pts.push(c),e.hidden||(r+=t),!1===e.color&&l[c]&&(e.color=p(l[c],u)))}return("funnelarea"===b.type?s:b.sort)&&h.sort(function(a,b){return b.v-a.v}),h[0]&&(h[0].vTotal=r),h},crossTraceCalc:function(a,b){var c=(b||{}).type;c||(c="pie");var d=a._fullLayout,f=a.calcdata,g=d[c+"colorway"],h=d["_"+c+"colormap"];d["extend"+c+"colors"]&&(g=e(g,j));for(var i=0,k=0;k<f.length;k++){var l=f[k];if(l[0].trace.type===c)for(var m=0;m<l.length;m++){var n=l[m];!1===n.color&&(h[n.label]?n.color=h[n.label]:(h[n.label]=n.color=g[i%g.length],i++))}}},makePullColorFn:d,generateExtendedColors:e}},{"../../components/color":594,"../../lib":719,"fast-isnumeric":226,tinycolor2:538}],1088:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("../../plots/domain").defaults,g=a("../bar/defaults").handleText;b.exports=function(a,b,c,h){function i(c,f){return d.coerce(a,b,e,c,f)}var j,k=i("values"),l=d.isArrayOrTypedArray(k),m=i("labels");if(Array.isArray(m)?(j=m.length,l&&(j=Math.min(j,k.length))):l&&(j=k.length,i("label0"),i("dlabel")),j){b._length=j,i("marker.line.width")&&i("marker.line.color"),i("marker.colors"),i("scalegroup");var n,o=i("text"),p=i("texttemplate");if(p||(n=i("textinfo",Array.isArray(o)?"text+percent":"percent")),i("hovertext"),i("hovertemplate"),p||n&&"none"!==n){var q=i("textposition");g(a,b,h,i,q,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}f(b,h,i);var r=i("hole");if(i("title.text")){var s=i("title.position",r?"middle center":"top center");r||"middle center"!==s||(b.title.position="top center"),d.coerceFont(i,"title.font",h.font)}i("sort"),i("direction"),i("rotation"),i("pull")}else b.visible=!1}},{"../../lib":719,"../../plots/domain":792,"../bar/defaults":862,"./attributes":1085}],1089:[function(a,b,c){"use strict";var d=a("../../components/fx/helpers").appendArrayMultiPointValues;b.exports=function(a,b){var c={curveNumber:b.index,pointNumbers:a.pts,data:b._input,fullData:b,label:a.label,color:a.color,value:a.v,percent:a.percent,text:a.text,v:a.v};return 1===a.pts.length&&(c.pointNumber=c.i=a.pts[0]),d(c,b,a.pts),"funnelarea"===b.type&&(delete c.v,delete c.i),c}},{"../../components/fx/helpers":629}],1090:[function(a,b,c){"use strict";var d=a("../../lib");c.formatPiePercent=function(a,b){var c=(100*a).toPrecision(3);return-1!==c.lastIndexOf(".")&&(c=c.replace(/[.]?0+$/,"")),d.numSeparate(c,b)+"%"},c.formatPieValue=function(a,b){var c=a.toPrecision(10);return-1!==c.lastIndexOf(".")&&(c=c.replace(/[.]?0+$/,"")),d.numSeparate(c,b)},c.getFirstFilled=function(a,b){if(Array.isArray(a))for(var c=0;c<b.length;c++){var d=a[b[c]];if(d||0===d||""===d)return d}},c.castOption=function(a,b){return Array.isArray(a)?c.getFirstFilled(a,b):a||void 0}},{"../../lib":719}],1091:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),layoutAttributes:a("./layout_attributes"),calc:a("./calc").calc,crossTraceCalc:a("./calc").crossTraceCalc,plot:a("./plot").plot,style:a("./style"),styleOne:a("./style_one"),moduleType:"trace",name:"pie",basePlotModule:a("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":1085,"./base_plot":1086,"./calc":1087,"./defaults":1088,"./layout_attributes":1092,"./layout_defaults":1093,"./plot":1094,"./style":1095,"./style_one":1096}],1092:[function(a,b,c){"use strict";b.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1093:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(a,b){function c(c,f){return d.coerce(a,b,e,c,f)}c("hiddenlabels"),c("piecolorway",b.colorway),c("extendpiecolors")}},{"../../lib":719,"./layout_attributes":1092}],1094:[function(a,b,c){"use strict";function d(a,b,c){var d=c[0],e=d.trace,f=d.cx,g=d.cy;"_hasHoverLabel"in e||(e._hasHoverLabel=!1),"_hasHoverEvent"in e||(e._hasHoverEvent=!1),a.on("mouseover",function(a){var c=b._fullLayout,h=b._fullData[e.index];if(!b._dragging&&!1!==c.hovermode){var i=h.hoverinfo;if(Array.isArray(i)&&(i=p.castHoverinfo({hoverinfo:[u.castOption(i,a.pts)],_module:e._module},c,0)),"all"===i&&(i="label+text+value+percent+name"),h.hovertemplate||"none"!==i&&"skip"!==i&&i){var j=a.rInscribed||0,k=f+a.pxmid[0]*(1-j),l=g+a.pxmid[1]*(1-j),m=c.separators,n=[];if(i&&-1!==i.indexOf("label")&&n.push(a.label),a.text=u.castOption(h.hovertext||h.text,a.pts),i&&-1!==i.indexOf("text")){var q=a.text;s.isValidTextValue(q)&&n.push(q)}a.value=a.v,a.valueLabel=u.formatPieValue(a.v,m),i&&-1!==i.indexOf("value")&&n.push(a.valueLabel),a.percent=a.v/d.vTotal,a.percentLabel=u.formatPiePercent(a.percent,m),i&&-1!==i.indexOf("percent")&&n.push(a.percentLabel);var r=h.hoverlabel,t=r.font;p.loneHover({trace:e,x0:k-j*d.r,x1:k+j*d.r,y:l,text:n.join("<br>"),name:h.hovertemplate||-1!==i.indexOf("name")?h.name:void 0,idealAlign:a.pxmid[0]<0?"left":"right",color:u.castOption(r.bgcolor,a.pts)||a.color,borderColor:u.castOption(r.bordercolor,a.pts),fontFamily:u.castOption(t.family,a.pts),fontSize:u.castOption(t.size,a.pts),fontColor:u.castOption(t.color,a.pts),nameLength:u.castOption(r.namelength,a.pts),textAlign:u.castOption(r.align,a.pts),hovertemplate:u.castOption(h.hovertemplate,a.pts),hovertemplateLabels:a,eventData:[v(a,h)]},{container:c._hoverlayer.node(),outerContainer:c._paper.node(),gd:b}),e._hasHoverLabel=!0}e._hasHoverEvent=!0,b.emit("plotly_hover",{points:[v(a,h)],event:o.event})}}),a.on("mouseout",function(a){var c=b._fullLayout,d=b._fullData[e.index],f=o.select(this).datum();e._hasHoverEvent&&(a.originalEvent=o.event,b.emit("plotly_unhover",{points:[v(f,d)],event:o.event}),e._hasHoverEvent=!1),e._hasHoverLabel&&(p.loneUnhover(c._hoverlayer.node()),e._hasHoverLabel=!1)}),a.on("click",function(a){var c=b._fullLayout,d=b._fullData[e.index];b._dragging||!1===c.hovermode||(b._hoverdata=[v(a,d)],p.click(b,o.event))})}function e(a,b,c){var d=u.castOption(a.insidetextfont.color,b.pts);!d&&a._input.textfont&&(d=u.castOption(a._input.textfont.color,b.pts));var e=u.castOption(a.insidetextfont.family,b.pts)||u.castOption(a.textfont.family,b.pts)||c.family,f=u.castOption(a.insidetextfont.size,b.pts)||u.castOption(a.textfont.size,b.pts)||c.size;return{color:d||q.contrast(b.color),family:e,size:f}}function f(a,b){for(var c,d,e=0;e<a.length;e++)if((d=(c=a[e][0]).trace).title.text){var f=d.title.text;d._meta&&(f=s.templateString(f,d._meta));var g=r.tester.append("text").attr("data-notex",1).text(f).call(r.font,d.title.font).call(t.convertToTspans,b),h=r.bBox(g.node(),!0);c.titleBox={width:h.width,height:h.height},g.remove()}}function g(a,b,c){var d=Math.sqrt(a.width*a.width+a.height*a.height),e=a.width/a.height,f=b.halfangle,g=b.ring,h=b.rInscribed,i=c.r||b.rpx1,j={scale:h*i*2/d,rCenter:1-h,rotate:0};if(j.scale>=1)return j
;var k=e+1/(2*Math.tan(f)),l=i*Math.min(1/(Math.sqrt(k*k+.5)+k),g/(Math.sqrt(e*e+g/2)+e)),m={scale:2*l/a.height,rCenter:Math.cos(l/i)-l*e/i,rotate:(180/Math.PI*b.midangle+720)%180-90},n=1/e,o=n+1/(2*Math.tan(f)),p=i*Math.min(1/(Math.sqrt(o*o+.5)+o),g/(Math.sqrt(n*n+g/2)+n)),q={scale:2*p/a.width,rCenter:Math.cos(p/i)-p/e/i,rotate:(180/Math.PI*b.midangle+810)%180-90},r=q.scale>m.scale?q:m;return j.scale<1&&r.scale>j.scale?r:j}function h(a,b){return a.v!==b.vTotal||b.trace.hole?Math.min(1/(1+1/Math.sin(a.halfangle)),a.ring/2):1}function i(a,b){var c=b.pxmid[0],d=b.pxmid[1],e=a.width/2,f=a.height/2;return c<0&&(e*=-1),d<0&&(f*=-1),{scale:1,rCenter:1,rotate:0,x:e+Math.abs(f)*(e>0?1:-1)/2,y:f/(1+c*c/(d*d)),outside:!0}}function j(a,b){var c,d,e,f=a.trace,g={x:a.cx,y:a.cy},h={tx:0,ty:0};h.ty+=f.title.font.size,e=l(f),-1!==f.title.position.indexOf("top")?(g.y-=(1+e)*a.r,h.ty-=a.titleBox.height):-1!==f.title.position.indexOf("bottom")&&(g.y+=(1+e)*a.r);var i,j,m=(i=a.r,j=a.trace.aspectratio,i/(void 0===j?1:j)),n=b.w*(f.domain.x[1]-f.domain.x[0])/2;return-1!==f.title.position.indexOf("left")?(n+=m,g.x-=(1+e)*m,h.tx+=a.titleBox.width/2):-1!==f.title.position.indexOf("center")?n*=2:-1!==f.title.position.indexOf("right")&&(n+=m,g.x+=(1+e)*m,h.tx-=a.titleBox.width/2),c=n/a.titleBox.width,d=k(a,b)/a.titleBox.height,{x:g.x,y:g.y,scale:Math.min(c,d),tx:h.tx,ty:h.ty}}function k(a,b){var c=a.trace,d=b.h*(c.domain.y[1]-c.domain.y[0]);return Math.min(a.titleBox.height,d/2)}function l(a){var b,c=a.pull;if(!c)return 0;if(Array.isArray(c))for(c=0,b=0;b<a.pull.length;b++)a.pull[b]>c&&(c=a.pull[b]);return c}function m(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d][0],f=e.trace,g=f.domain,h=b.w*(g.x[1]-g.x[0]),i=b.h*(g.y[1]-g.y[0]);f.title.text&&"middle center"!==f.title.position&&(i-=k(e,b));var j=h/2,m=i/2;"funnelarea"!==f.type||f.scalegroup||(m/=f.aspectratio),e.r=Math.min(j,m)/(1+l(f)),e.cx=b.l+b.w*(f.domain.x[1]+f.domain.x[0])/2,e.cy=b.t+b.h*(1-f.domain.y[0])-i/2,f.title.text&&-1!==f.title.position.indexOf("bottom")&&(e.cy-=k(e,b)),f.scalegroup&&-1===c.indexOf(f.scalegroup)&&c.push(f.scalegroup)}!function(a,b){for(var c,d,e,f=0;f<b.length;f++){var g=1/0,h=b[f];for(d=0;d<a.length;d++)if(c=a[d][0],(e=c.trace).scalegroup===h){var i;if("pie"===e.type)i=c.r*c.r;else if("funnelarea"===e.type){var j,k;e.aspectratio>1?(j=c.r,k=j/e.aspectratio):(k=c.r,j=k*e.aspectratio),j*=(1+e.baseratio)/2,i=j*k}g=Math.min(g,i/c.vTotal)}for(d=0;d<a.length;d++)if(c=a[d][0],(e=c.trace).scalegroup===h){var l=g*c.vTotal;"funnelarea"===e.type&&(l/=(1+e.baseratio)/2,l/=e.aspectratio),c.r=Math.sqrt(l)}}}(a,c)}function n(a,b,c){var d=a._fullLayout,e=c.trace,f=e.texttemplate,g=e.textinfo;if(!f&&g&&"none"!==g){var h,i=g.split("+"),j=function(a){return-1!==i.indexOf(a)},k=j("label"),l=j("text"),m=j("value"),n=j("percent"),o=d.separators;if(h=k?[b.label]:[],l){var p=u.getFirstFilled(e.text,b.pts);w(p)&&h.push(p)}m&&h.push(u.formatPieValue(b.v,o)),n&&h.push(u.formatPiePercent(b.v/c.vTotal,o)),b.text=h.join("<br>")}if(f){var q=s.castOption(e,b.i,"texttemplate");if(q){var r=function(a){return{label:a.label,value:a.v,valueLabel:u.formatPieValue(a.v,d.separators),percent:a.v/c.vTotal,percentLabel:u.formatPiePercent(a.v/c.vTotal,d.separators),color:a.color,text:a.text,customdata:s.castOption(e,a.i,"customdata")}}(b),t=u.getFirstFilled(e.text,b.pts);(w(t)||""===t)&&(r.text=t),b.text=s.texttemplateString(q,r,a._fullLayout._d3locale,r,e._meta||{})}else b.text=""}}var o=a("d3"),p=a("../../components/fx"),q=a("../../components/color"),r=a("../../components/drawing"),s=a("../../lib"),t=a("../../lib/svg_text_utils"),u=a("./helpers"),v=a("./event_data"),w=a("../../lib").isValidTextValue;b.exports={plot:function(a,b){var c=a._fullLayout;f(b,a),m(b,c._size);var k=s.makeTraceGroups(c._pielayer,b,"trace").each(function(b){var f=o.select(this),k=b[0],l=k.trace;!function(a){function b(a){return[f.r*Math.sin(a),-f.r*Math.cos(a)]}var c,d,e,f=a[0],g=f.trace,i=g.rotation*Math.PI/180,j=2*Math.PI/f.vTotal,k="px0",l="px1";if("counterclockwise"===g.direction){for(c=0;c<a.length&&a[c].hidden;c++);if(c===a.length)return;i+=j*a[c].v,j*=-1,k="px1",l="px0"}for(e=b(i),c=0;c<a.length;c++)(d=a[c]).hidden||(d[k]=e,i+=j*d.v/2,d.pxmid=b(i),d.midangle=i,i+=j*d.v/2,e=b(i),d[l]=e,d.largeArc=d.v>f.vTotal/2?1:0,d.halfangle=Math.PI*Math.min(d.v/f.vTotal,.5),d.ring=1-g.hole,d.rInscribed=h(d,f))}(b),f.attr("stroke-linejoin","round"),f.each(function(){var f=o.select(this).selectAll("g.slice").data(b);f.enter().append("g").classed("slice",!0),f.exit().remove();var h=[[[],[]],[[],[]]],m=!1;f.each(function(c){function f(a,b,d,e){var f=e*(b[0]-a[0]),g=e*(b[1]-a[1]);return"a"+e*k.r+","+e*k.r+" 0 "+c.largeArc+(d?" 1 ":" 0 ")+f+","+g}if(c.hidden)o.select(this).selectAll("path,g").remove();else{c.pointNumber=c.i,c.curveNumber=l.index,h[c.pxmid[1]<0?0:1][c.pxmid[0]<0?0:1].push(c);var j=k.cx,p=k.cy,q=o.select(this),v=q.selectAll("path.surface").data([c]);if(v.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),q.call(d,a,b),l.pull){var w=+u.castOption(l.pull,c.pts)||0;w>0&&(j+=w*c.pxmid[0],p+=w*c.pxmid[1])}c.cxFinal=j,c.cyFinal=p;var x=l.hole;if(c.v===k.vTotal){var y="M"+(j+c.px0[0])+","+(p+c.px0[1])+f(c.px0,c.pxmid,!0,1)+f(c.pxmid,c.px0,!0,1)+"Z";x?v.attr("d","M"+(j+x*c.px0[0])+","+(p+x*c.px0[1])+f(c.px0,c.pxmid,!1,x)+f(c.pxmid,c.px0,!1,x)+"Z"+y):v.attr("d",y)}else{var z=f(c.px0,c.px1,!0,1);if(x){var A=1-x;v.attr("d","M"+(j+x*c.px1[0])+","+(p+x*c.px1[1])+f(c.px1,c.px0,!1,x)+"l"+A*c.px0[0]+","+A*c.px0[1]+z+"Z")}else v.attr("d","M"+j+","+p+"l"+c.px0[0]+","+c.px0[1]+z+"Z")}n(a,c,k);var B=u.castOption(l.textposition,c.pts),C=q.selectAll("g.slicetext").data(c.text&&"none"!==B?[0]:[]);C.enter().append("g").classed("slicetext",!0),C.exit().remove(),C.each(function(){var b=s.ensureSingle(o.select(this),"text","",function(a){a.attr("data-notex",1)});b.text(c.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(r.font,"outside"===B?function(a,b,c){return{color:u.castOption(a.outsidetextfont.color,b.pts)||u.castOption(a.textfont.color,b.pts)||c.color,family:u.castOption(a.outsidetextfont.family,b.pts)||u.castOption(a.textfont.family,b.pts)||c.family,size:u.castOption(a.outsidetextfont.size,b.pts)||u.castOption(a.textfont.size,b.pts)||c.size}}(l,c,a._fullLayout.font):e(l,c,a._fullLayout.font)).call(t.convertToTspans,a);var d,f=r.bBox(b.node());"outside"===B?d=i(f,c):(d=g(f,c,k),"auto"===B&&d.scale<1&&(b.call(r.font,l.outsidetextfont),l.outsidetextfont.family===l.insidetextfont.family&&l.outsidetextfont.size===l.insidetextfont.size||(f=r.bBox(b.node())),d=i(f,c)));var h=j+c.pxmid[0]*d.rCenter+(d.x||0),n=p+c.pxmid[1]*d.rCenter+(d.y||0);d.outside&&(c.yLabelMin=n-f.height/2,c.yLabelMid=n,c.yLabelMax=n+f.height/2,c.labelExtraX=0,c.labelExtraY=0,m=!0),b.attr("transform","translate("+h+","+n+")"+(d.scale<1?"scale("+d.scale+")":"")+(d.rotate?"rotate("+d.rotate+")":"")+"translate("+-(f.left+f.right)/2+","+-(f.top+f.bottom)/2+")")})}});var p=o.select(this).selectAll("g.titletext").data(l.title.text?[0]:[]);p.enter().append("g").classed("titletext",!0),p.exit().remove(),p.each(function(){var b,d=s.ensureSingle(o.select(this),"text","",function(a){a.attr("data-notex",1)}),e=l.title.text;l._meta&&(e=s.templateString(e,l._meta)),d.text(e).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(r.font,l.title.font).call(t.convertToTspans,a),b="middle center"===l.title.position?function(a){var b=Math.sqrt(a.titleBox.width*a.titleBox.width+a.titleBox.height*a.titleBox.height);return{x:a.cx,y:a.cy,scale:a.trace.hole*a.r*2/b,tx:0,ty:-a.titleBox.height/2+a.trace.title.font.size}}(k):j(k,c._size),d.attr("transform","translate("+b.x+","+b.y+")"+(b.scale<1?"scale("+b.scale+")":"")+"translate("+b.tx+","+b.ty+")")}),m&&function(a,b){function c(a,b){return a.pxmid[1]-b.pxmid[1]}function d(a,b){return b.pxmid[1]-a.pxmid[1]}var e,f,g,h,i,j,k,l,m,n,o,p,q;for(f=0;f<2;f++)for(g=f?c:d,i=f?Math.max:Math.min,k=f?1:-1,e=0;e<2;e++){for(h=e?Math.max:Math.min,j=e?1:-1,(l=a[f][e]).sort(g),m=a[1-f][e],n=m.concat(l),p=[],o=0;o<l.length;o++)void 0!==l[o].yLabelMid&&p.push(l[o]);for(q=!1,o=0;f&&o<m.length;o++)if(void 0!==m[o].yLabelMid){q=m[o];break}for(o=0;o<p.length;o++){var r=o&&p[o-1];q&&!o&&(r=q),function(a,c){c||(c={});var d,e,g,l,m,o,p=c.labelExtraY+(f?c.yLabelMax:c.yLabelMin),q=f?a.yLabelMin:a.yLabelMax,r=f?a.yLabelMax:a.yLabelMin,s=a.cyFinal+i(a.px0[1],a.px1[1]),t=p-q;if(t*k>0&&(a.labelExtraY=t),Array.isArray(b.pull))for(e=0;e<n.length;e++)(g=n[e])===a||(u.castOption(b.pull,a.pts)||0)>=(u.castOption(b.pull,g.pts)||0)||((a.pxmid[1]-g.pxmid[1])*k>0?(l=g.cyFinal+i(g.px0[1],g.px1[1]),(t=l-q-a.labelExtraY)*k>0&&(a.labelExtraY+=t)):(r+a.labelExtraY-s)*k>0&&(d=3*j*Math.abs(e-n.indexOf(a)),m=g.cxFinal+h(g.px0[0],g.px1[0]),(o=m+d-(a.cxFinal+a.pxmid[0])-a.labelExtraX)*j>0&&(a.labelExtraX+=o)))}(p[o],r)}}}(h,l),function(a,b){a.each(function(a){var c=o.select(this);if(a.labelExtraX||a.labelExtraY){var d=c.select("g.slicetext text");d.attr("transform","translate("+a.labelExtraX+","+a.labelExtraY+")"+d.attr("transform"));var e=a.cxFinal+a.pxmid[0],f=a.cyFinal+a.pxmid[1],g="M"+e+","+f,h=(a.yLabelMax-a.yLabelMin)*(a.pxmid[0]<0?-1:1)/4;if(a.labelExtraX){var i=a.labelExtraX*a.pxmid[1]/a.pxmid[0],j=a.yLabelMid+a.labelExtraY-(a.cyFinal+a.pxmid[1]);Math.abs(i)>Math.abs(j)?g+="l"+j*a.pxmid[0]/a.pxmid[1]+","+j+"H"+(e+a.labelExtraX+h):g+="l"+a.labelExtraX+","+i+"v"+(j-i)+"h"+h}else g+="V"+(a.yLabelMid+a.labelExtraY)+"h"+h;s.ensureSingle(c,"path","textline").call(q.stroke,b.outsidetextfont.color).attr({"stroke-width":Math.min(2,b.outsidetextfont.size/8),d:g,fill:"none"})}else c.select("path.textline").remove()})}(f,l)})});setTimeout(function(){k.selectAll("tspan").each(function(){var a=o.select(this);a.attr("dy")&&a.attr("dy",a.attr("dy"))})},0)},formatSliceLabel:n,transformInsideText:g,determineInsideTextFont:e,positionTitleOutside:j,prerenderTitles:f,layoutAreas:m,attachFxHandlers:d}},{"../../components/color":594,"../../components/drawing":615,"../../components/fx":632,"../../lib":719,"../../lib/svg_text_utils":743,"./event_data":1089,"./helpers":1090,d3:164}],1095:[function(a,b,c){"use strict";var d=a("d3"),e=a("./style_one");b.exports=function(a){a._fullLayout._pielayer.selectAll(".trace").each(function(a){var b=a[0].trace,c=d.select(this);c.style({opacity:b.opacity}),c.selectAll("path.surface").each(function(a){d.select(this).call(e,a,b)})})}},{"./style_one":1096,d3:164}],1096:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("./helpers").castOption;b.exports=function(a,b,c){var f=c.marker.line,g=e(f.color,b.pts)||d.defaultLine,h=e(f.width,b.pts)||0;a.style("stroke-width",h).call(d.fill,b.color).call(d.stroke,g)}},{"../../components/color":594,"./helpers":1090}],1097:[function(a,b,c){"use strict";var d=a("../scatter/attributes");b.exports={x:d.x,y:d.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:d.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":1111}],1098:[function(a,b,c){"use strict";function d(a,b){this.scene=a,this.uid=b,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=e(a.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var e=a("gl-pointcloud2d"),f=a("../../lib/str2rgbarray"),g=a("../../plots/cartesian/autorange").findExtremes,h=a("../scatter/get_trace_color"),i=d.prototype;i.handlePick=function(a){var b=this.idToIndex[a.pointId];return{trace:this,dataCoord:a.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*b],this.pickXYData[2*b+1]]:[this.pickXData[b],this.pickYData[b]],textLabel:Array.isArray(this.textLabels)?this.textLabels[b]:this.textLabels,color:this.color,name:this.name,pointIndex:b,hoverinfo:this.hoverinfo}},i.update=function(a){this.index=a.index,this.textLabels=a.text,this.name=a.name,this.hoverinfo=a.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(a),this.color=h(a,{})},i.updateFast=function(a){var b,c,d,e,h,i,j=this.xData=this.pickXData=a.x,k=this.yData=this.pickYData=a.y,l=this.pickXYData=a.xy,m=a.xbounds&&a.ybounds,n=a.indices,o=this.bounds;if(l){if(d=l,b=l.length>>>1,m)o[0]=a.xbounds[0],o[2]=a.xbounds[1],o[1]=a.ybounds[0],o[3]=a.ybounds[1];else for(i=0;i<b;i++)e=d[2*i],h=d[2*i+1],e<o[0]&&(o[0]=e),e>o[2]&&(o[2]=e),h<o[1]&&(o[1]=h),h>o[3]&&(o[3]=h);if(n)c=n;else for(c=new Int32Array(b),i=0;i<b;i++)c[i]=i}else for(b=j.length,d=new Float32Array(2*b),c=new Int32Array(b),i=0;i<b;i++)e=j[i],h=k[i],c[i]=i,d[2*i]=e,d[2*i+1]=h,e<o[0]&&(o[0]=e),e>o[2]&&(o[2]=e),h<o[1]&&(o[1]=h),h>o[3]&&(o[3]=h);this.idToIndex=c,this.pointcloudOptions.idToIndex=c,this.pointcloudOptions.positions=d;var p=f(a.marker.color),q=f(a.marker.border.color),r=a.opacity*a.marker.opacity;p[3]*=r,this.pointcloudOptions.color=p;var s=a.marker.blend;null===s&&(s=j.length<100||k.length<100),this.pointcloudOptions.blend=s,q[3]*=r,this.pointcloudOptions.borderColor=q;var t=a.marker.sizemin,u=Math.max(a.marker.sizemax,a.marker.sizemin);this.pointcloudOptions.sizeMin=t,this.pointcloudOptions.sizeMax=u,this.pointcloudOptions.areaRatio=a.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var v=this.scene.xaxis,w=this.scene.yaxis,x=u/2||.5;a._extremes[v._id]=g(v,[o[0],o[2]],{ppad:x}),a._extremes[w._id]=g(w,[o[1],o[3]],{ppad:x})},i.dispose=function(){this.pointcloud.dispose()},b.exports=function(a,b){var c=new d(a,b.uid);return c.update(b),c}},{"../../lib/str2rgbarray":742,"../../plots/cartesian/autorange":766,"../scatter/get_trace_color":1120,"gl-pointcloud2d":293}],1099:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes");b.exports=function(a,b,c){function f(c,f){return d.coerce(a,b,e,c,f)}f("x"),f("y"),f("xbounds"),f("ybounds"),a.xy&&a.xy instanceof Float32Array&&(b.xy=a.xy),a.indices&&a.indices instanceof Int32Array&&(b.indices=a.indices),f("text"),f("marker.color",c),f("marker.opacity"),f("marker.blend"),f("marker.sizemin"),f("marker.sizemax"),f("marker.border.color",c),f("marker.border.arearatio"),b._length=null}},{"../../lib":719,"./attributes":1097}],1100:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("../scatter3d/calc"),plot:a("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:a("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":805,"../scatter3d/calc":1138,"./attributes":1097,"./convert":1098,"./defaults":1099}],1101:[function(a,b,c){"use strict";var d=a("../../plots/font_attributes"),e=a("../../plots/attributes"),f=a("../../components/color/attributes"),g=a("../../components/fx/attributes"),h=a("../../plots/domain").attributes,i=a("../../plots/template_attributes").hovertemplateAttrs,j=a("../../components/colorscale/attributes"),k=a("../../plot_api/plot_template").templatedArray,l=a("../../lib/extend").extendFlat,m=a("../../plot_api/edit_types").overrideAll;a("../../constants/docs").FORMAT_LINK,(b.exports=m({hoverinfo:l({},e.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:g.hoverlabel,domain:h({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s"},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:d({}),node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},line:{color:{valType:"color",dflt:f.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:g.hoverlabel,hovertemplate:i({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},line:{color:{valType:"color",dflt:f.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:g.hoverlabel,hovertemplate:i({},{keys:["value","label"]}),colorscales:k("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:l(j().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":593,"../../components/colorscale/attributes":601,"../../components/fx/attributes":624,"../../constants/docs":690,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../../plots/attributes":764,"../../plots/domain":792,"../../plots/font_attributes":793,"../../plots/template_attributes":843}],1102:[function(a,b,c){"use strict";function d(a,b){var c=a._fullData[b],d=a._fullLayout,e=d.dragmode,f="pan"===d.dragmode?"move":"crosshair",g=c._bgRect;if("pan"!==e&&"zoom"!==e){i(g,f);var h={_id:"x",c2p:l.identity,_offset:c._sankey.translateX,_length:c._sankey.width},n={_id:"y",c2p:l.identity,_offset:c._sankey.translateY,_length:c._sankey.height},o={gd:a,element:g.node(),plotinfo:{id:b,xaxis:h,yaxis:n,fillRangeItems:l.noop},subplot:b,xaxes:[h],yaxes:[n],doneFnCompleted:function(c){for(var d,e=a._fullData[b],f=e.node.groups.slice(),g=[],h=0;h<c.length;h++){var i=function(a){for(var b=e._sankey.graph.nodes,c=0;c<b.length;c++)if(b[c].pointNumber===a)return b[c]}(c[h].pointNumber);if(i)if(i.group){for(var j=0;j<i.childrenNodes.length;j++)g.push(i.childrenNodes[j].pointNumber);f[i.pointNumber-e.node._count]=!1}else g.push(i.pointNumber)}d=f.filter(Boolean).concat([g]),m.call("_guiRestyle",a,{"node.groups":[d]},b)},prepFn:function(a,b,c){k(a,b,c,o,e)}};j.init(o)}}var e=a("../../plot_api/edit_types").overrideAll,f=a("../../plots/get_data").getModuleCalcData,g=a("./plot"),h=a("../../components/fx/layout_attributes"),i=a("../../lib/setcursor"),j=a("../../components/dragelement"),k=a("../../plots/cartesian/select").prepSelect,l=a("../../lib"),m=a("../../registry");c.name="sankey",c.baseLayoutAttrOverrides=e({hoverlabel:h.hoverlabel},"plot","nested"),c.plot=function(a){var b=f(a.calcdata,"sankey")[0];g(a,b),c.updateFx(a)},c.clean=function(a,b,c,d){var e=d._has&&d._has("sankey"),f=b._has&&b._has("sankey");e&&!f&&(d._paperdiv.selectAll(".sankey").remove(),d._paperdiv.selectAll(".bgsankey").remove())},c.updateFx=function(a){for(var b=0;b<a._fullData.length;b++)d(a,b)}},{"../../components/dragelement":612,"../../components/fx/layout_attributes":633,"../../lib":719,"../../lib/setcursor":739,"../../plot_api/edit_types":750,"../../plots/cartesian/select":784,"../../plots/get_data":802,"../../registry":848,"./plot":1107}],1103:[function(a,b,c){"use strict";function d(a){var b,c=a.node,d=a.link,g=[],k=h(d.color),l={},m={},n=d.colorscales.length;for(b=0;b<n;b++){var o=d.colorscales[b],p=j.extractScale(o,{cLetter:"c"}),q=j.makeColorScaleFunc(p);m[o.label]=q}var r=0;for(b=0;b<d.value.length;b++)d.source[b]>r&&(r=d.source[b]),d.target[b]>r&&(r=d.target[b]);var s,t=r+1;a.node._count=t;var u=a.node.groups,v={};for(b=0;b<u.length;b++){var w=u[b];for(s=0;s<w.length;s++){var x=w[s],y=t+b;v.hasOwnProperty(x)?f.warn("Node "+x+" is already part of a group."):v[x]=y}}var z={source:[],target:[]};for(b=0;b<d.value.length;b++){var A=d.value[b],B=d.source[b],C=d.target[b];if(A>0&&i(B,t)&&i(C,t)&&(!v.hasOwnProperty(B)||!v.hasOwnProperty(C)||v[B]!==v[C])){v.hasOwnProperty(C)&&(C=v[C]),v.hasOwnProperty(B)&&(B=v[B]),C=+C,l[B=+B]=l[C]=!0;var D="";d.label&&d.label[b]&&(D=d.label[b]);var E=null;D&&m.hasOwnProperty(D)&&(E=m[D]),g.push({pointNumber:b,label:D,color:k?d.color[b]:d.color,concentrationscale:E,source:B,target:C,value:+A}),z.source.push(B),z.target.push(C)}}var F=t+u.length,G=h(c.color),H=[];for(b=0;b<F;b++)if(l[b]){var I=c.label[b];H.push({group:b>t-1,childrenNodes:[],pointNumber:b,label:I,color:G?c.color[b]:c.color})}var J=!1;return function(a,b,c){for(var d=f.init2dArray(a,0),g=0;g<Math.min(b.length,c.length);g++)if(f.isIndex(b[g],a)&&f.isIndex(c[g],a)){if(b[g]===c[g])return!0;d[b[g]].push(c[g])}return e(d).components.some(function(a){return a.length>1})}(F,z.source,z.target)&&(J=!0),{circular:J,links:g,nodes:H,groups:u,groupLookup:v}}var e=a("strongly-connected-components"),f=a("../../lib"),g=a("../../lib/gup").wrap,h=f.isArrayOrTypedArray,i=f.isIndex,j=a("../../components/colorscale");b.exports=function(a,b){var c=d(b);return g({circular:c.circular,_nodes:c.nodes,_links:c.links,_groups:c.groups,_groupLookup:c.groupLookup})}},{"../../components/colorscale":606,"../../lib":719,"../../lib/gup":717,"strongly-connected-components":531}],1104:[function(a,b,c){"use strict";b.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeCapture:"node-capture",nodeCentered:"node-entered",nodeLabelGuide:"node-label-guide",nodeLabel:"node-label",nodeLabelTextPath:"node-label-text-path"}}},{}],1105:[function(a,b,c){"use strict";function d(a,b){function c(c,d){return e.coerce(a,b,f.link.colorscales,c,d)}c("label"),c("cmin"),c("cmax"),c("colorscale")}var e=a("../../lib"),f=a("./attributes"),g=a("../../components/color"),h=a("tinycolor2"),i=a("../../plots/domain").defaults,j=a("../../components/fx/hoverlabel_defaults"),k=a("../../plot_api/plot_template"),l=a("../../plots/array_container_defaults");b.exports=function(a,b,c,m){function n(c,d){return e.coerce(a,b,f,c,d)}function o(a,b){return e.coerce(r,s,f.node,a,b)}function p(a,b){return e.coerce(u,v,f.link,a,b)}var q=e.extendDeep(m.hoverlabel,a.hoverlabel),r=a.node,s=k.newContainer(b,"node");o("label"),o("groups"),o("x"),o("y"),o("pad"),o("thickness"),o("line.color"),o("line.width"),o("hoverinfo",a.hoverinfo),j(r,s,o,q),o("hovertemplate");var t=m.colorway;o("color",s.label.map(function(a,b){return g.addOpacity(function(a){return t[a%t.length]}(b),.8)}));var u=a.link||{},v=k.newContainer(b,"link");p("label"),p("source"),p("target"),p("value"),p("line.color"),p("line.width"),p("hoverinfo",a.hoverinfo),j(u,v,p,q),p("hovertemplate");var w,x=h(m.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";p("color",e.repeat(x,v.value.length)),l(u,v,{name:"colorscales",handleItemDefaults:d}),i(b,m,n),n("orientation"),n("valueformat"),n("valuesuffix"),s.x.length&&s.y.length&&(w="freeform"),n("arrangement",w),e.coerceFont(n,"textfont",e.extendFlat({},m.font)),b._length=null}},{"../../components/color":594,"../../components/fx/hoverlabel_defaults":631,"../../lib":719,"../../plot_api/plot_template":757,"../../plots/array_container_defaults":763,"../../plots/domain":792,"./attributes":1101,tinycolor2:538}],1106:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot"),moduleType:"trace",name:"sankey",basePlotModule:a("./base_plot"),selectPoints:a("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":1101,"./base_plot":1102,"./calc":1103,"./defaults":1105,"./plot":1107,"./select.js":1109}],1107:[function(a,b,c){"use strict";function d(a){return""!==a}function e(a,b){return a.filter(function(a){return a.key===b.traceId})}function f(a,b){o.select(a).select("path").style("fill-opacity",b),o.select(a).select("rect").style("fill-opacity",b)}function g(a){o.select(a).select("text.name").style("fill","black")}function h(a){return function(b){return-1!==a.node.sourceLinks.indexOf(b.link)||-1!==a.node.targetLinks.indexOf(b.link)}}function i(a){return function(b){return-1!==b.node.sourceLinks.indexOf(a.link)||-1!==b.node.targetLinks.indexOf(a.link)}}function j(a,b,c){b&&c&&e(c,b).selectAll("."+t.sankeyLink).filter(h(b)).call(l.bind(0,b,c,!1))}function k(a,b,c){b&&c&&e(c,b).selectAll("."+t.sankeyLink).filter(h(b)).call(m.bind(0,b,c,!1))}function l(a,b,c,d){var f=d.datum().link.label;d.style("fill-opacity",function(a){if(!a.link.concentrationscale)return.4}),f&&e(b,a).selectAll("."+t.sankeyLink).filter(function(a){return a.link.label===f}).style("fill-opacity",function(a){if(!a.link.concentrationscale)return.4}),c&&e(b,a).selectAll("."+t.sankeyNode).filter(i(a)).call(j)}function m(a,b,c,d){var f=d.datum().link.label;d.style("fill-opacity",function(a){return a.tinyColorAlpha}),f&&e(b,a).selectAll("."+t.sankeyLink).filter(function(a){return a.link.label===f}).style("fill-opacity",function(a){return a.tinyColorAlpha}),c&&e(b,a).selectAll(t.sankeyNode).filter(i(a)).call(k)}function n(a,b){var c=a.hoverlabel||{},d=s.nestedProperty(c,b).get();return!Array.isArray(d)&&d}var o=a("d3"),p=a("./render"),q=a("../../components/fx"),r=a("../../components/color"),s=a("../../lib"),t=a("./constants").cn,u=s._;b.exports=function(a,b){for(var c=a._fullLayout,e=c._paper,h=c._size,i=0;i<a._fullData.length;i++)if(a._fullData[i].visible&&a._fullData[i].type===t.sankey&&!a._fullData[i]._viewInitial){var s=a._fullData[i].node;a._fullData[i]._viewInitial={node:{groups:s.groups.slice(),x:s.x.slice(),y:s.y.slice()}}}var v=u(a,"source:")+" ",w=u(a,"target:")+" ",x=u(a,"concentration:")+" ",y=u(a,"incoming flow count:")+" ",z=u(a,"outgoing flow count:")+" ";p(a,e,b,{width:h.w,height:h.h,margin:{t:h.t,r:h.r,b:h.b,l:h.l}},{linkEvents:{hover:function(b,c,d){!1!==a._fullLayout.hovermode&&(o.select(b).call(l.bind(0,c,d,!0)),"skip"!==c.link.trace.link.hoverinfo&&(c.link.fullData=c.link.trace,a.emit("plotly_hover",{event:o.event,points:[c.link]})))},follow:function(b,e){if(!1!==a._fullLayout.hovermode){var h=e.link.trace.link;if("none"!==h.hoverinfo&&"skip"!==h.hoverinfo){for(var i=[],j=0,k=0;k<e.flow.links.length;k++){var l=e.flow.links[k];if("closest"!==a._fullLayout.hovermode||e.link.pointNumber===l.pointNumber){e.link.pointNumber===l.pointNumber&&(j=k),l.fullData=l.trace,h=e.link.trace.link;var m=function(a){var b,c;return a.circular?(b=(a.circularPathData.leftInnerExtent+a.circularPathData.rightInnerExtent)/2+e.parent.translateX,c=a.circularPathData.verticalFullExtent+e.parent.translateY):(b=(a.source.x1+a.target.x0)/2+e.parent.translateX,c=(a.y0+a.y1)/2+e.parent.translateY),[b,c]}(l),p={valueLabel:o.format(e.valueFormat)(l.value)+e.valueSuffix};i.push({x:m[0],y:m[1],name:p.valueLabel,text:[l.label||"",v+l.source.label,w+l.target.label,l.concentrationscale?x+o.format("%0.2f")(l.flow.labelConcentration):""].filter(d).join("<br>"),color:n(h,"bgcolor")||r.addOpacity(l.color,1),borderColor:n(h,"bordercolor"),fontFamily:n(h,"font.family"),fontSize:n(h,"font.size"),fontColor:n(h,"font.color"),nameLength:n(h,"namelength"),textAlign:n(h,"align"),idealAlign:o.event.x<m[0]?"right":"left",hovertemplate:h.hovertemplate,hovertemplateLabels:p,eventData:[l]})}}q.loneHover(i,{container:c._hoverlayer.node(),outerContainer:c._paper.node(),gd:a,anchorIndex:j}).each(function(){e.link.concentrationscale||f(this,.65),g(this)})}}},unhover:function(b,d,e){!1!==a._fullLayout.hovermode&&(o.select(b).call(m.bind(0,d,e,!0)),"skip"!==d.link.trace.link.hoverinfo&&(d.link.fullData=d.link.trace,a.emit("plotly_unhover",{event:o.event,points:[d.link]})),q.loneUnhover(c._hoverlayer.node()))},select:function(b,c){var d=c.link;d.originalEvent=o.event,a._hoverdata=[d],q.click(a,{target:!0})}},nodeEvents:{hover:function(b,c,d){!1!==a._fullLayout.hovermode&&(o.select(b).call(j,c,d),"skip"!==c.node.trace.node.hoverinfo&&(c.node.fullData=c.node.trace,a.emit("plotly_hover",{event:o.event,points:[c.node]})))},follow:function(b,e){if(!1!==a._fullLayout.hovermode){var h=e.node.trace.node;if("none"!==h.hoverinfo&&"skip"!==h.hoverinfo){var i=o.select(b).select("."+t.nodeRect),j=a._fullLayout._paperdiv.node().getBoundingClientRect(),k=i.node().getBoundingClientRect(),l=k.left-2-j.left,m=k.right+2-j.left,p=k.top+k.height/4-j.top,r={valueLabel:o.format(e.valueFormat)(e.node.value)+e.valueSuffix};e.node.fullData=e.node.trace;var s=q.loneHover({x0:l,x1:m,y:p,name:o.format(e.valueFormat)(e.node.value)+e.valueSuffix,text:[e.node.label,y+e.node.targetLinks.length,z+e.node.sourceLinks.length].filter(d).join("<br>"),color:n(h,"bgcolor")||e.tinyColorHue,borderColor:n(h,"bordercolor"),fontFamily:n(h,"font.family"),fontSize:n(h,"font.size"),fontColor:n(h,"font.color"),nameLength:n(h,"namelength"),textAlign:n(h,"align"),idealAlign:"left",hovertemplate:h.hovertemplate,hovertemplateLabels:r,eventData:[e.node]},{container:c._hoverlayer.node(),outerContainer:c._paper.node(),gd:a});f(s,.85),g(s)}}},unhover:function(b,d,e){!1!==a._fullLayout.hovermode&&(o.select(b).call(k,d,e),"skip"!==d.node.trace.node.hoverinfo&&(d.node.fullData=d.node.trace,a.emit("plotly_unhover",{event:o.event,points:[d.node]})),q.loneUnhover(c._hoverlayer.node()))},select:function(b,c,d){var e=c.node;e.originalEvent=o.event,a._hoverdata=[e],o.select(b).call(k,c,d),q.click(a,{target:!0})}}})}},{"../../components/color":594,"../../components/fx":632,"../../lib":719,"./constants":1104,"./render":1108,d3:164}],1108:[function(a,b,c){"use strict";function d(){return function(a){if(a.link.circular)return b=a.link,c=b.width/2,d=b.circularPathData,
"top"===b.circularLinkType?"M "+d.targetX+" "+(d.targetY+c)+" L"+d.rightInnerExtent+" "+(d.targetY+c)+"A"+(d.rightLargeArcRadius+c)+" "+(d.rightSmallArcRadius+c)+" 0 0 1 "+(d.rightFullExtent-c)+" "+(d.targetY-d.rightSmallArcRadius)+"L"+(d.rightFullExtent-c)+" "+d.verticalRightInnerExtent+"A"+(d.rightLargeArcRadius+c)+" "+(d.rightLargeArcRadius+c)+" 0 0 1 "+d.rightInnerExtent+" "+(d.verticalFullExtent-c)+"L"+d.leftInnerExtent+" "+(d.verticalFullExtent-c)+"A"+(d.leftLargeArcRadius+c)+" "+(d.leftLargeArcRadius+c)+" 0 0 1 "+(d.leftFullExtent+c)+" "+d.verticalLeftInnerExtent+"L"+(d.leftFullExtent+c)+" "+(d.sourceY-d.leftSmallArcRadius)+"A"+(d.leftLargeArcRadius+c)+" "+(d.leftSmallArcRadius+c)+" 0 0 1 "+d.leftInnerExtent+" "+(d.sourceY+c)+"L"+d.sourceX+" "+(d.sourceY+c)+"L"+d.sourceX+" "+(d.sourceY-c)+"L"+d.leftInnerExtent+" "+(d.sourceY-c)+"A"+(d.leftLargeArcRadius-c)+" "+(d.leftSmallArcRadius-c)+" 0 0 0 "+(d.leftFullExtent-c)+" "+(d.sourceY-d.leftSmallArcRadius)+"L"+(d.leftFullExtent-c)+" "+d.verticalLeftInnerExtent+"A"+(d.leftLargeArcRadius-c)+" "+(d.leftLargeArcRadius-c)+" 0 0 0 "+d.leftInnerExtent+" "+(d.verticalFullExtent+c)+"L"+d.rightInnerExtent+" "+(d.verticalFullExtent+c)+"A"+(d.rightLargeArcRadius-c)+" "+(d.rightLargeArcRadius-c)+" 0 0 0 "+(d.rightFullExtent+c)+" "+d.verticalRightInnerExtent+"L"+(d.rightFullExtent+c)+" "+(d.targetY-d.rightSmallArcRadius)+"A"+(d.rightLargeArcRadius-c)+" "+(d.rightSmallArcRadius-c)+" 0 0 0 "+d.rightInnerExtent+" "+(d.targetY-c)+"L"+d.targetX+" "+(d.targetY-c)+"Z":"M "+d.targetX+" "+(d.targetY-c)+" L"+d.rightInnerExtent+" "+(d.targetY-c)+"A"+(d.rightLargeArcRadius+c)+" "+(d.rightSmallArcRadius+c)+" 0 0 0 "+(d.rightFullExtent-c)+" "+(d.targetY+d.rightSmallArcRadius)+"L"+(d.rightFullExtent-c)+" "+d.verticalRightInnerExtent+"A"+(d.rightLargeArcRadius+c)+" "+(d.rightLargeArcRadius+c)+" 0 0 0 "+d.rightInnerExtent+" "+(d.verticalFullExtent+c)+"L"+d.leftInnerExtent+" "+(d.verticalFullExtent+c)+"A"+(d.leftLargeArcRadius+c)+" "+(d.leftLargeArcRadius+c)+" 0 0 0 "+(d.leftFullExtent+c)+" "+d.verticalLeftInnerExtent+"L"+(d.leftFullExtent+c)+" "+(d.sourceY+d.leftSmallArcRadius)+"A"+(d.leftLargeArcRadius+c)+" "+(d.leftSmallArcRadius+c)+" 0 0 0 "+d.leftInnerExtent+" "+(d.sourceY-c)+"L"+d.sourceX+" "+(d.sourceY-c)+"L"+d.sourceX+" "+(d.sourceY+c)+"L"+d.leftInnerExtent+" "+(d.sourceY+c)+"A"+(d.leftLargeArcRadius-c)+" "+(d.leftSmallArcRadius-c)+" 0 0 1 "+(d.leftFullExtent-c)+" "+(d.sourceY+d.leftSmallArcRadius)+"L"+(d.leftFullExtent-c)+" "+d.verticalLeftInnerExtent+"A"+(d.leftLargeArcRadius-c)+" "+(d.leftLargeArcRadius-c)+" 0 0 1 "+d.leftInnerExtent+" "+(d.verticalFullExtent-c)+"L"+d.rightInnerExtent+" "+(d.verticalFullExtent-c)+"A"+(d.rightLargeArcRadius-c)+" "+(d.rightLargeArcRadius-c)+" 0 0 1 "+(d.rightFullExtent+c)+" "+d.verticalRightInnerExtent+"L"+(d.rightFullExtent+c)+" "+(d.targetY+d.rightSmallArcRadius)+"A"+(d.rightLargeArcRadius-c)+" "+(d.rightSmallArcRadius-c)+" 0 0 1 "+d.rightInnerExtent+" "+(d.targetY+c)+"L"+d.targetX+" "+(d.targetY+c)+"Z";var b,c,d,e=a.link.source.x1,f=a.link.target.x0,g=I(e,f),h=g(.5),i=g(.5),j=a.link.y0-a.link.width/2,k=a.link.y0+a.link.width/2,l=a.link.y1-a.link.width/2,m=a.link.y1+a.link.width/2;return"M"+e+","+j+"C"+h+","+j+" "+i+","+l+" "+f+","+l+"L"+f+","+m+"C"+i+","+m+" "+h+","+k+" "+e+","+k+"Z"}}function e(a){a.attr("transform",function(a){return"translate("+a.node.x0.toFixed(3)+", "+a.node.y0.toFixed(3)+")"})}function f(a){a.call(e)}function g(a,b){a.call(f),b.attr("d",d())}function h(a){a.attr("width",function(a){return a.node.x1-a.node.x0}).attr("height",function(a){return a.visibleHeight})}function i(a){return a.link.width>1||a.linkLineWidth>0}function j(a){return"translate("+a.translateX+","+a.translateY+")"+(a.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function k(a){return"translate("+(a.horizontal?0:a.labelY)+" "+(a.horizontal?a.labelY:0)+")"}function l(a){return w.svg.line()([[a.horizontal?a.left?-a.sizeAcross:a.visibleWidth+v.nodeTextOffsetHorizontal:v.nodeTextOffsetHorizontal,0],[a.horizontal?a.left?-v.nodeTextOffsetHorizontal:a.sizeAcross:a.visibleHeight-v.nodeTextOffsetHorizontal,0]])}function m(a){return a.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)"}function n(a){return a.horizontal?"scale(1 1)":"scale(-1 1)"}function o(a){return a.darkBackground&&!a.horizontal?"rgb(255,255,255)":"rgb(0,0,0)"}function p(a){return a.horizontal&&a.left?"100%":"0%"}function q(a,b,c){a.on(".basic",null).on("mouseover.basic",function(a){a.interactionState.dragInProgress||a.partOfGroup||(c.hover(this,a,b),a.interactionState.hovered=[this,a])}).on("mousemove.basic",function(a){a.interactionState.dragInProgress||a.partOfGroup||(c.follow(this,a),a.interactionState.hovered=[this,a])}).on("mouseout.basic",function(a){a.interactionState.dragInProgress||a.partOfGroup||(c.unhover(this,a,b),a.interactionState.hovered=!1)}).on("click.basic",function(a){a.interactionState.hovered&&(c.unhover(this,a,b),a.interactionState.hovered=!1),a.interactionState.dragInProgress||a.partOfGroup||c.select(this,a,b)})}function r(a,b,c,d){var e=w.behavior.drag().origin(function(a){return{x:a.node.x0+a.visibleWidth/2,y:a.node.y0+a.visibleHeight/2}}).on("dragstart",function(e){if("fixed"!==e.arrangement&&(D.ensureSingle(d._fullLayout._infolayer,"g","dragcover",function(a){d._fullLayout._dragCover=a}),D.raiseToTop(this),e.interactionState.dragInProgress=e.node,t(e.node),e.interactionState.hovered&&(c.nodeEvents.unhover.apply(0,e.interactionState.hovered),e.interactionState.hovered=!1),"snap"===e.arrangement)){var f=e.traceId+"|"+e.key;e.forceLayouts[f]?e.forceLayouts[f].alpha(1):function(a,b,c,d){!function(a){for(var b=0;b<a.length;b++)a[b].y=(a[b].y0+a[b].y1)/2,a[b].x=(a[b].x0+a[b].x1)/2}(c.graph.nodes);var e=c.graph.nodes.filter(function(a){return a.originalX===c.node.originalX}).filter(function(a){return!a.partOfGroup});c.forceLayouts[b]=C.forceSimulation(e).alphaDecay(0).force("collide",C.forceCollide().radius(function(a){return a.dy/2+c.nodePad/2}).strength(1).iterations(v.forceIterations)).force("constrain",function(a,b,c,d){return function(){for(var a=0,e=0;e<c.length;e++){var f=c[e];f===d.interactionState.dragInProgress?(f.x=f.lastDraggedX,f.y=f.lastDraggedY):(f.vx=(f.originalX-f.x)/v.forceTicksPerFrame,f.y=Math.min(d.size-f.dy/2,Math.max(f.dy/2,f.y))),a=Math.max(a,Math.abs(f.vx),Math.abs(f.vy))}!d.interactionState.dragInProgress&&a<.1&&d.forceLayouts[b].alpha()>0&&d.forceLayouts[b].alpha(0)}}(0,b,e,c)).stop()}(0,f,e),function(a,b,c,d,e){window.requestAnimationFrame(function f(){var h;for(h=0;h<v.forceTicksPerFrame;h++)c.forceLayouts[d].tick();var i=c.graph.nodes;if(function(a){for(var b=0;b<a.length;b++)a[b].y0=a[b].y-a[b].dy/2,a[b].y1=a[b].y0+a[b].dy,a[b].x0=a[b].x-a[b].dx/2,a[b].x1=a[b].x0+a[b].dx}(i),c.sankey.update(c.graph),g(a.filter(u(c)),b),c.forceLayouts[d].alpha()>0)window.requestAnimationFrame(f);else{var j=c.node.originalX;c.node.x0=j-c.visibleWidth/2,c.node.x1=j+c.visibleWidth/2,s(c,e)}})}(a,b,e,f,d)}}).on("drag",function(c){if("fixed"!==c.arrangement){var d=w.event.x,e=w.event.y;"snap"===c.arrangement?(c.node.x0=d-c.visibleWidth/2,c.node.x1=d+c.visibleWidth/2,c.node.y0=e-c.visibleHeight/2,c.node.y1=e+c.visibleHeight/2):("freeform"===c.arrangement&&(c.node.x0=d-c.visibleWidth/2,c.node.x1=d+c.visibleWidth/2),e=Math.max(0,Math.min(c.size-c.visibleHeight/2,e)),c.node.y0=e-c.visibleHeight/2,c.node.y1=e+c.visibleHeight/2),t(c.node),"snap"!==c.arrangement&&(c.sankey.update(c.graph),g(a.filter(u(c)),b))}}).on("dragend",function(a){if("fixed"!==a.arrangement){a.interactionState.dragInProgress=!1;for(var b=0;b<a.node.childrenNodes.length;b++)a.node.childrenNodes[b].x=a.node.x,a.node.childrenNodes[b].y=a.node.y;"snap"!==a.arrangement&&s(a,d)}});a.on(".drag",null).call(e)}function s(a,b){for(var c=[],d=[],e=0;e<a.graph.nodes.length;e++){var f=(a.graph.nodes[e].x0+a.graph.nodes[e].x1)/2,g=(a.graph.nodes[e].y0+a.graph.nodes[e].y1)/2;c.push(f/a.figure.width),d.push(g/a.figure.height)}J.call("_guiRestyle",b,{"node.x":[c],"node.y":[d]},a.trace.index).then(function(){b._fullLayout._dragCover&&b._fullLayout._dragCover.remove()})}function t(a){a.lastDraggedX=a.x0+a.dx/2,a.lastDraggedY=a.y0+a.dy/2}function u(a){return function(b){return b.node.originalX===a.node.originalX}}var v=a("./constants"),w=a("d3"),x=a("tinycolor2"),y=a("../../components/color"),z=a("../../components/drawing"),A=a("@plotly/d3-sankey"),B=a("@plotly/d3-sankey-circular"),C=a("d3-force"),D=a("../../lib"),E=a("../../lib/gup"),F=E.keyFun,G=E.repeat,H=E.unwrap,I=a("d3-interpolate").interpolateNumber,J=a("../../registry");b.exports=function(a,b,c,f,g){var s=!1;D.ensureSingle(a._fullLayout._infolayer,"g","first-render",function(){s=!0});var t=a._fullLayout._dragCover,u=c.filter(function(a){return H(a).trace.visible}).map(function(a,b,c){var d,e=H(b),f=e.trace,g=f.domain,h="h"===f.orientation,i=f.node.pad,j=f.node.thickness,k=a.width*(g.x[1]-g.x[0]),l=a.height*(g.y[1]-g.y[0]),m=e._nodes,n=e._links,o=e.circular;(d=o?B.sankeyCircular().circularLinkGap(0):A.sankey()).iterations(v.sankeyIterations).size(h?[k,l]:[l,k]).nodeWidth(j).nodePadding(i).nodeId(function(a){return a.pointNumber}).nodes(m).links(n);var p,q,r,s=d();for(var t in d.nodePadding()<i&&D.warn("node.pad was reduced to ",d.nodePadding()," to fit within the figure."),e._groupLookup){var u,w=parseInt(e._groupLookup[t]);for(p=0;p<s.nodes.length;p++)if(s.nodes[p].pointNumber===w){u=s.nodes[p];break}if(u){var y={pointNumber:parseInt(t),x0:u.x0,x1:u.x1,y0:u.y0,y1:u.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};s.nodes.unshift(y),u.childrenNodes.unshift(y)}}if(function(){for(p=0;p<s.nodes.length;p++){var a,b,c=s.nodes[p],d={};for(q=0;q<c.targetLinks.length;q++)a=(b=c.targetLinks[q]).source.pointNumber+":"+b.target.pointNumber,d.hasOwnProperty(a)||(d[a]=[]),d[a].push(b);var e=Object.keys(d);for(q=0;q<e.length;q++){var f=d[a=e[q]],g=0,h={};for(r=0;r<f.length;r++)h[(b=f[r]).label]||(h[b.label]=0),h[b.label]+=b.value,g+=b.value;for(r=0;r<f.length;r++)(b=f[r]).flow={value:g,labelConcentration:h[b.label]/g,concentration:b.value/g,links:f},b.concentrationscale&&(b.color=x(b.concentrationscale(b.flow.labelConcentration)))}var i=0;for(q=0;q<c.sourceLinks.length;q++)i+=c.sourceLinks[q].value;for(q=0;q<c.sourceLinks.length;q++)(b=c.sourceLinks[q]).concentrationOut=b.value/i;var j=0;for(q=0;q<c.targetLinks.length;q++)j+=c.targetLinks[q].value;for(q=0;q<c.targetLinks.length;q++)(b=c.targetLinks[q]).concenrationIn=b.value/j}}(),f.node.x.length&&f.node.y.length){for(p=0;p<Math.min(f.node.x.length,f.node.y.length,s.nodes.length);p++)if(f.node.x[p]&&f.node.y[p]){var z=[f.node.x[p]*k,f.node.y[p]*l];s.nodes[p].x0=z[0]-j/2,s.nodes[p].x1=z[0]+j/2;var C=s.nodes[p].y1-s.nodes[p].y0;s.nodes[p].y0=z[1]-C/2,s.nodes[p].y1=z[1]+C/2}"snap"===f.arrangement&&function(a){a.forEach(function(a){var b,c,d,e=0,f=a.length;for(a.sort(function(a,b){return a.y0-b.y0}),d=0;d<f;++d)(b=a[d]).y0>=e||(c=e-b.y0)>1e-6&&(b.y0+=c,b.y1+=c),e=b.y1+i})}(function(a){var b,c,d=a.map(function(a,b){return{x0:a.x0,index:b}}).sort(function(a,b){return a.x0-b.x0}),e=[],f=-1,g=-1/0;for(p=0;p<d.length;p++){var h=a[d[p].index];h.x0>g+j&&(f+=1,b=h.x0),g=h.x0,e[f]||(e[f]=[]),e[f].push(h),c=b-h.x0,h.x0+=c,h.x1+=c}return e}(m=s.nodes)),d.update(s)}return{circular:o,key:c,trace:f,guid:D.randstr(),horizontal:h,width:k,height:l,nodePad:f.node.pad,nodeLineColor:f.node.line.color,nodeLineWidth:f.node.line.width,linkLineColor:f.link.line.color,linkLineWidth:f.link.line.width,valueFormat:f.valueformat,valueSuffix:f.valuesuffix,textFont:f.textfont,translateX:g.x[0]*a.width+a.margin.l,translateY:a.height-g.y[1]*a.height+a.margin.t,dragParallel:h?l:k,dragPerpendicular:h?k:l,arrangement:f.arrangement,sankey:d,graph:s,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}.bind(null,f)),C=b.selectAll("."+v.cn.sankey).data(u,F);C.exit().remove(),C.enter().append("g").classed(v.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",j),C.each(function(b,c){a._fullData[c]._sankey=b;var d="bgsankey-"+b.trace.uid+"-"+c;D.ensureSingle(a._fullLayout._draggers,"rect",d),a._fullData[c]._bgRect=w.select("."+d),a._fullData[c]._bgRect.style("pointer-events","all").attr("width",b.width).attr("height",b.height).attr("x",b.translateX).attr("y",b.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),C.transition().ease(v.ease).duration(v.duration).attr("transform",j);var E=C.selectAll("."+v.cn.sankeyLinks).data(G,F);E.enter().append("g").classed(v.cn.sankeyLinks,!0).style("fill","none");var I=E.selectAll("."+v.cn.sankeyLink).data(function(a){return a.graph.links.filter(function(a){return a.value}).map(function(a,b,c){var e=x(b.color),f=b.source.label+"|"+b.target.label+"__"+c;return b.trace=a.trace,b.curveNumber=a.trace.index,{circular:a.circular,key:f,traceId:a.key,pointNumber:b.pointNumber,link:b,tinyColorHue:y.tinyRGB(e),tinyColorAlpha:e.getAlpha(),linkPath:d,linkLineColor:a.linkLineColor,linkLineWidth:a.linkLineWidth,valueFormat:a.valueFormat,valueSuffix:a.valueSuffix,sankey:a.sankey,parent:a,interactionState:a.interactionState,flow:b.flow}}.bind(null,a))},F);I.enter().append("path").classed(v.cn.sankeyLink,!0).call(q,C,g.linkEvents),I.style("stroke",function(a){return i(a)?y.tinyRGB(x(a.linkLineColor)):a.tinyColorHue}).style("stroke-opacity",function(a){return i(a)?y.opacity(a.linkLineColor):a.tinyColorAlpha}).style("fill",function(a){return a.tinyColorHue}).style("fill-opacity",function(a){return a.tinyColorAlpha}).style("stroke-width",function(a){return i(a)?a.linkLineWidth:1}).attr("d",d()),I.style("opacity",function(){return a._context.staticPlot||s||t?1:0}).transition().ease(v.ease).duration(v.duration).style("opacity",1),I.exit().transition().ease(v.ease).duration(v.duration).style("opacity",0).remove();var J=C.selectAll("."+v.cn.sankeyNodeSet).data(G,F);J.enter().append("g").classed(v.cn.sankeyNodeSet,!0),J.style("cursor",function(a){switch(a.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var K=J.selectAll("."+v.cn.sankeyNode).data(function(a){var b=a.graph.nodes;return function(a){var b,c=[];for(b=0;b<a.length;b++)a[b].originalX=(a[b].x0+a[b].x1)/2,a[b].originalY=(a[b].y0+a[b].y1)/2,-1===c.indexOf(a[b].originalX)&&c.push(a[b].originalX);for(c.sort(function(a,b){return a-b}),b=0;b<a.length;b++)a[b].originalLayerIndex=c.indexOf(a[b].originalX),a[b].originalLayer=a[b].originalLayerIndex/(c.length-1)}(b),b.map(function(a,b){var c=x(b.color),d=v.nodePadAcross,e=a.nodePad/2;b.dx=b.x1-b.x0,b.dy=b.y1-b.y0;var f=b.dx,g=Math.max(.5,b.dy),h="node_"+b.pointNumber;return b.group&&(h=D.randstr()),b.trace=a.trace,b.curveNumber=a.trace.index,{index:b.pointNumber,key:h,partOfGroup:b.partOfGroup||!1,group:b.group,traceId:a.key,trace:a.trace,node:b,nodePad:a.nodePad,nodeLineColor:a.nodeLineColor,nodeLineWidth:a.nodeLineWidth,textFont:a.textFont,size:a.horizontal?a.height:a.width,visibleWidth:Math.ceil(f),visibleHeight:g,zoneX:-d,zoneY:-e,zoneWidth:f+2*d,zoneHeight:g+2*e,labelY:a.horizontal?b.dy/2+1:b.dx/2+1,left:1===b.originalLayer,sizeAcross:a.width,forceLayouts:a.forceLayouts,horizontal:a.horizontal,darkBackground:c.getBrightness()<=128,tinyColorHue:y.tinyRGB(c),tinyColorAlpha:c.getAlpha(),valueFormat:a.valueFormat,valueSuffix:a.valueSuffix,sankey:a.sankey,graph:a.graph,arrangement:a.arrangement,uniqueNodeLabelPathId:[a.guid,a.key,h].join("_"),interactionState:a.interactionState,figure:a}}.bind(null,a))},F);K.enter().append("g").classed(v.cn.sankeyNode,!0).call(e).style("opacity",function(b){return!a._context.staticPlot&&!s||b.partOfGroup?0:1}),K.call(q,C,g.nodeEvents).call(r,I,g,a),K.transition().ease(v.ease).duration(v.duration).call(e).style("opacity",function(a){return a.partOfGroup?0:1}),K.exit().transition().ease(v.ease).duration(v.duration).style("opacity",0).remove();var L=K.selectAll("."+v.cn.nodeRect).data(G);L.enter().append("rect").classed(v.cn.nodeRect,!0).call(h),L.style("stroke-width",function(a){return a.nodeLineWidth}).style("stroke",function(a){return y.tinyRGB(x(a.nodeLineColor))}).style("stroke-opacity",function(a){return y.opacity(a.nodeLineColor)}).style("fill",function(a){return a.tinyColorHue}).style("fill-opacity",function(a){return a.tinyColorAlpha}),L.transition().ease(v.ease).duration(v.duration).call(h);var M=K.selectAll("."+v.cn.nodeCapture).data(G);M.enter().append("rect").classed(v.cn.nodeCapture,!0).style("fill-opacity",0),M.attr("x",function(a){return a.zoneX}).attr("y",function(a){return a.zoneY}).attr("width",function(a){return a.zoneWidth}).attr("height",function(a){return a.zoneHeight});var N=K.selectAll("."+v.cn.nodeCentered).data(G);N.enter().append("g").classed(v.cn.nodeCentered,!0).attr("transform",k),N.transition().ease(v.ease).duration(v.duration).attr("transform",k);var O=N.selectAll("."+v.cn.nodeLabelGuide).data(G);O.enter().append("path").classed(v.cn.nodeLabelGuide,!0).attr("id",function(a){return a.uniqueNodeLabelPathId}).attr("d",l).attr("transform",m),O.transition().ease(v.ease).duration(v.duration).attr("d",l).attr("transform",m);var P=N.selectAll("."+v.cn.nodeLabel).data(G);P.enter().append("text").classed(v.cn.nodeLabel,!0).attr("transform",n).style("user-select","none").style("cursor","default").style("fill","black"),P.style("text-shadow",function(a){return a.horizontal?"-1px 1px 1px #fff, 1px 1px 1px #fff, 1px -1px 1px #fff, -1px -1px 1px #fff":"none"}).each(function(a){z.font(P,a.textFont)}),P.transition().ease(v.ease).duration(v.duration).attr("transform",n);var Q=P.selectAll("."+v.cn.nodeLabelTextPath).data(G);Q.enter().append("textPath").classed(v.cn.nodeLabelTextPath,!0).attr("alignment-baseline","middle").attr("xlink:href",function(a){return"#"+a.uniqueNodeLabelPathId}).attr("startOffset",p).style("fill",o),Q.text(function(a){return a.horizontal||a.node.dy>5?a.node.label:""}).attr("text-anchor",function(a){return a.horizontal&&a.left?"end":"start"}),Q.transition().ease(v.ease).duration(v.duration).attr("startOffset",p).style("fill",o)}},{"../../components/color":594,"../../components/drawing":615,"../../lib":719,"../../lib/gup":717,"../../registry":848,"./constants":1104,"@plotly/d3-sankey":55,"@plotly/d3-sankey-circular":54,d3:164,"d3-force":157,"d3-interpolate":159,tinycolor2:538}],1109:[function(a,b,c){"use strict";b.exports=function(a,b){for(var c=[],d=a.cd[0].trace,e=d._sankey.graph.nodes,f=0;f<e.length;f++){var g=e[f];if(!g.partOfGroup){var h=[(g.x0+g.x1)/2,(g.y0+g.y1)/2];"v"===d.orientation&&h.reverse(),b&&b.contains(h,!1,f,a)&&c.push({pointNumber:g.pointNumber})}}return c}},{}],1110:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b){for(var c=0;c<a.length;c++)a[c].i=c;d.mergeArray(b.text,a,"tx"),d.mergeArray(b.texttemplate,a,"txt"),d.mergeArray(b.hovertext,a,"htx"),d.mergeArray(b.customdata,a,"data"),d.mergeArray(b.textposition,a,"tp"),b.textfont&&(d.mergeArrayCastPositive(b.textfont.size,a,"ts"),d.mergeArray(b.textfont.color,a,"tc"),d.mergeArray(b.textfont.family,a,"tf"));var e=b.marker;if(e){d.mergeArrayCastPositive(e.size,a,"ms"),d.mergeArrayCastPositive(e.opacity,a,"mo"),d.mergeArray(e.symbol,a,"mx"),d.mergeArray(e.color,a,"mc");var f=e.line;e.line&&(d.mergeArray(f.color,a,"mlc"),d.mergeArrayCastPositive(f.width,a,"mlw"));var g=e.gradient;g&&"none"!==g.type&&(d.mergeArray(g.type,a,"mgt"),d.mergeArray(g.color,a,"mgc"))}}},{"../../lib":719}],1111:[function(a,b,c){"use strict";var d=a("../../plots/template_attributes").texttemplateAttrs,e=a("../../plots/template_attributes").hovertemplateAttrs,f=a("../../components/colorscale/attributes"),g=a("../../plots/font_attributes"),h=a("../../components/drawing/attributes").dash,i=a("../../components/drawing"),j=a("./constants"),k=a("../../lib/extend").extendFlat;b.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:d({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:e({},{keys:j.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:k({},h,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},marker:k({symbol:{valType:"enumerated",values:i.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:k({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},f("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},f("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:g({editType:"calc",colorEditType:"style",arrayOk:!0}),r:{valType:"data_array",editType:"calc"},t:{valType:"data_array",editType:"calc"}}},{"../../components/colorscale/attributes":601,"../../components/drawing":615,"../../components/drawing/attributes":614,"../../lib/extend":710,"../../plots/font_attributes":793,"../../plots/template_attributes":843,"./constants":1115}],1112:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,i){var j=b._length,l=a._fullLayout,n=c._id,o=d._id,p=l._firstScatter[g(b)]===b.uid,q=(h(b,l,c,d)||{}).orientation,r=b.fill;c._minDtick=0,d._minDtick=0;var s={padded:!0},t={padded:!0};i&&(s.ppad=t.ppad=i);var u=j<2||e[0]!==e[j-1]||f[0]!==f[j-1];u&&("tozerox"===r||"tonextx"===r&&(p||"h"===q))?s.tozero=!0:(b.error_y||{}).visible||"tonexty"!==r&&"tozeroy"!==r&&(m.hasMarkers(b)||m.hasText(b))||(s.padded=!1,s.ppad=0),u&&("tozeroy"===r||"tonexty"===r&&(p||"v"===q))?t.tozero=!0:"tonextx"!==r&&"tozerox"!==r||(t.padded=!1),n&&(b._extremes[n]=k.findExtremes(c,e,s)),o&&(b._extremes[o]=k.findExtremes(d,f,t))}function e(a,b){if(m.hasMarkers(a)){var c,d=a.marker,e=1.6*(a.marker.sizeref||1);if(c="area"===a.marker.sizemode?function(a){return Math.max(Math.sqrt((a||0)/e),3)}:function(a){return Math.max((a||0)/e,3)},j.isArrayOrTypedArray(d.size)){var f={type:"linear"};k.setConvert(f);for(var g=f.makeCalcdata(a.marker,"size"),h=new Array(b),i=0;i<b;i++)h[i]=c(g[i]);return h}return c(d.size)}}function f(a,b){var c=g(b),d=a._firstScatter;d[c]||(d[c]=b.uid)}function g(a){var b=a.stackgroup;return a.xaxis+a.yaxis+a.type+(b?"-"+b:"")}function h(a,b,c,d){var e=a.stackgroup;if(e){var f=b._scatterStackOpts[c._id+d._id][e],g="v"===f.orientation?d:c;return"linear"===g.type||"log"===g.type?f:void 0}}var i=a("fast-isnumeric"),j=a("../../lib"),k=a("../../plots/cartesian/axes"),l=a("../../constants/numerical").BADNUM,m=a("./subtypes"),n=a("./colorscale_calc"),o=a("./arrays_to_calcdata"),p=a("./calc_selection");b.exports={calc:function(a,b){var c,g,m,q,r,s,t=a._fullLayout,u=k.getFromId(a,b.xaxis||"x"),v=k.getFromId(a,b.yaxis||"y"),w=u.makeCalcdata(b,"x"),x=v.makeCalcdata(b,"y"),y=b._length,z=new Array(y),A=b.ids,B=h(b,t,u,v),C=!1;f(t,b);var D,E="x",F="y";for(B?(j.pushUnique(B.traceIndices,b._expandedIndex),(c="v"===B.orientation)?(F="s",D="x"):(E="s",D="y"),r="interpolate"===B.stackgaps):d(a,b,u,v,w,x,e(b,y)),g=0;g<y;g++){var G=z[g]={},H=i(w[g]),I=i(x[g]);H&&I?(G[E]=w[g],G[F]=x[g]):B&&(c?H:I)?(G[D]=c?w[g]:x[g],G.gap=!0,r?(G.s=l,C=!0):G.s=0):G[E]=G[F]=l,A&&(G.id=String(A[g]))}if(o(z,b),n(a,b),p(z,b),B){for(g=0;g<z.length;)z[g][D]===l?z.splice(g,1):g++;if(j.sort(z,function(a,b){return a[D]-b[D]||a.i-b.i}),C){for(g=0;g<z.length-1&&z[g].gap;)g++;for((s=z[g].s)||(s=z[g].s=0),m=0;m<g;m++)z[m].s=s;for(q=z.length-1;q>g&&z[q].gap;)q--;for(s=z[q].s,m=z.length-1;m>q;m--)z[m].s=s;for(;g<q;)if(z[++g].gap){for(m=g+1;z[m].gap;)m++;for(var J=z[g-1][D],K=z[g-1].s,L=(z[m].s-K)/(z[m][D]-J);g<m;)z[g].s=K+(z[g][D]-J)*L,g++}}}return z},calcMarkerSize:e,calcAxisExpansion:d,setFirstScatter:f,getStackOpts:h}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767,"./arrays_to_calcdata":1110,"./calc_selection":1113,"./colorscale_calc":1114,"./subtypes":1134,"fast-isnumeric":226}],1113:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b){d.isArrayOrTypedArray(b.selectedpoints)&&d.tagSelected(a,b)}},{"../../lib":719}],1114:[function(a,b,c){"use strict";var d=a("../../components/colorscale/helpers").hasColorscale,e=a("../../components/colorscale/calc"),f=a("./subtypes");b.exports=function(a,b){f.hasLines(b)&&d(b,"line")&&e(a,b,{vals:b.line.color,containerStr:"line",cLetter:"c"}),f.hasMarkers(b)&&(d(b,"marker")&&e(a,b,{vals:b.marker.color,containerStr:"marker",cLetter:"c"}),d(b,"marker.line")&&e(a,b,{vals:b.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":602,"../../components/colorscale/helpers":605,"./subtypes":1134}],1115:[function(a,b,c){"use strict";b.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1116:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g){e[d]=!0;var h={i:null,gap:!0,s:0};if(h[g]=c,a.splice(b,0,h),b&&c===a[b-1][g]){var i=a[b-1];h.s=i.s,h.i=i.i,h.gap=i.gap}else f&&(h.s=function(a,b,c,d){var e=a[b-1],f=a[b+1];return f?e?e.s+(f.s-e.s)*(c-e[d])/(f[d]-e[d]):f.s:e.s}(a,b,c,g));b||(a[0].t=a[1].t,a[0].trace=a[1].trace,delete a[1].t,delete a[1].trace)}var e=a("./calc");b.exports=function(a,b){var c=b.xaxis,f=b.yaxis,g=c._id+f._id,h=a._fullLayout._scatterStackOpts[g];if(h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=a.calcdata;for(var y in h){var z=(r=h[y]).traceIndices;if(z.length){for(s="interpolate"===r.stackgaps,t=r.groupnorm,"v"===r.orientation?(u="x",v="y"):(u="y",v="x"),w=new Array(z.length),i=0;i<w.length;i++)w[i]=!1;n=x[z[0]];var A=new Array(n.length);for(i=0;i<n.length;i++)A[i]=n[i][u];for(i=1;i<z.length;i++){for(m=x[z[i]],j=k=0;j<m.length;j++){for(o=m[j][u];o>A[k]&&k<A.length;k++)d(m,j,A[k],i,w,s,u),j++;if(o!==A[k]){for(l=0;l<i;l++)d(x[z[l]],k,o,l,w,s,u);A.splice(k,0,o)}k++}for(;k<A.length;k++)d(m,j,A[k],i,w,s,u),j++}var B=A.length;for(j=0;j<n.length;j++){for(p=n[j][v]=n[j].s,i=1;i<z.length;i++)(m=x[z[i]])[0].trace._rawLength=m[0].trace._length,m[0].trace._length=B,p+=m[j].s,m[j][v]=p;if(t)for(q=("fraction"===t?p:p/100)||1,i=0;i<z.length;i++){var C=x[z[i]][j];C[v]/=q,C.sNorm=C.s/q}}for(i=0;i<z.length;i++){var D=(m=x[z[i]])[0].trace,E=e.calcMarkerSize(D,D._rawLength),F=Array.isArray(E);if(E&&w[i]||F){var G=E;for(E=new Array(B),j=0;j<B;j++)E[j]=m[j].gap?0:F?G[m[j].i]:G}var H=new Array(B),I=new Array(B);for(j=0;j<B;j++)H[j]=m[j].x,I[j]=m[j].y;e.calcAxisExpansion(a,D,c,f,H,I,E),m[0].t.orientation=r.orientation}}}}}},{"./calc":1112}],1117:[function(a,b,c){"use strict";b.exports=function(a){for(var b=0;b<a.length;b++){var c=a[b];if("scatter"===c.type){var d=c.fill;if("none"!==d&&"toself"!==d&&(c.opacity=void 0,"tonexty"===d||"tonextx"===d))for(var e=b-1;e>=0;e--){var f=a[e];if("scatter"===f.type&&f.xaxis===c.xaxis&&f.yaxis===c.yaxis){f.opacity=void 0;break}}}}}},{}],1118:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../registry"),f=a("./attributes"),g=a("./constants"),h=a("./subtypes"),i=a("./xy_defaults"),j=a("./stack_defaults"),k=a("./marker_defaults"),l=a("./line_defaults"),m=a("./line_shape_defaults"),n=a("./text_defaults"),o=a("./fillcolor_defaults");b.exports=function(a,b,c,p){function q(c,e){return d.coerce(a,b,f,c,e)}var r=i(a,b,p,q);if(r||(b.visible=!1),b.visible){var s=j(a,b,p,q),t=!s&&r<g.PTS_LINESONLY?"lines+markers":"lines";q("text"),q("hovertext"),q("mode",t),h.hasLines(b)&&(l(a,b,c,p,q),m(a,b,q),q("connectgaps"),q("line.simplify")),h.hasMarkers(b)&&k(a,b,c,p,q,{gradient:!0}),h.hasText(b)&&(q("texttemplate"),n(a,b,p,q));var u=[];(h.hasMarkers(b)||h.hasText(b))&&(q("cliponaxis"),q("marker.maxdisplayed"),u.push("points")),q("fill",s?s.fillDflt:"none"),"none"!==b.fill&&(o(a,b,c,q),h.hasLines(b)||m(a,b,q));var v=(b.line||{}).color,w=(b.marker||{}).color;"tonext"!==b.fill&&"toself"!==b.fill||u.push("fills"),q("hoveron",u.join("+")||"points"),"fills"!==b.hoveron&&q("hovertemplate");var x=e.getComponentMethod("errorbars","supplyDefaults");x(a,b,v||w||c,{axis:"y"}),x(a,b,v||w||c,{axis:"x",inherit:"y"}),d.coerceSelectionMarkerOpacity(b,q)}}},{"../../lib":719,"../../registry":848,"./attributes":1111,"./constants":1115,"./fillcolor_defaults":1119,"./line_defaults":1123,"./line_shape_defaults":1125,"./marker_defaults":1129,"./stack_defaults":1132,"./subtypes":1134,"./text_defaults":1135,"./xy_defaults":1136}],1119:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("../../lib").isArrayOrTypedArray;b.exports=function(a,b,c,f){var g=!1;if(b.marker){var h=b.marker.color,i=(b.marker.line||{}).color;h&&!e(h)?g=h:i&&!e(i)&&(g=i)}f("fillcolor",d.addOpacity((b.line||{}).color||g||c,.5))}},{"../../components/color":594,"../../lib":719}],1120:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("./subtypes");b.exports=function(a,b){var c,f;if("lines"===a.mode)return(c=a.line.color)&&d.opacity(c)?c:a.fillcolor;if("none"===a.mode)return a.fill?a.fillcolor:"";var g=b.mcc||(a.marker||{}).color,h=b.mlcc||((a.marker||{}).line||{}).color;return(f=g&&d.opacity(g)?g:h&&d.opacity(h)&&(b.mlw||((a.marker||{}).line||{}).width)?h:"")?d.opacity(f)<.3?d.addOpacity(f,.3):f:(c=(a.line||{}).color)&&d.opacity(c)&&e.hasLines(a)&&a.line.width?c:a.fillcolor}},{"../../components/color":594,"./subtypes":1134}],1121:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/fx"),f=a("../../registry"),g=a("./get_trace_color"),h=a("../../components/color"),i=d.fillText;b.exports=function(a,b,c,j){
var k=a.cd,l=k[0].trace,m=a.xa,n=a.ya,o=m.c2p(b),p=n.c2p(c),q=[o,p],r=l.hoveron||"",s=-1!==l.mode.indexOf("markers")?3:.5;if(-1!==r.indexOf("points")){var t=function(a){var b=Math.max(s,a.mrc||0),c=m.c2p(a.x)-o,d=n.c2p(a.y)-p;return Math.max(Math.sqrt(c*c+d*d)-b,1-s/b)},u=e.getDistanceFunction(j,function(a){var b=Math.max(3,a.mrc||0),c=1-1/b,d=Math.abs(m.c2p(a.x)-o);return d<b?c*d/b:d-b+c},function(a){var b=Math.max(3,a.mrc||0),c=1-1/b,d=Math.abs(n.c2p(a.y)-p);return d<b?c*d/b:d-b+c},t);if(e.getClosest(k,u,a),!1!==a.index){var v=k[a.index],w=m.c2p(v.x,!0),x=n.c2p(v.y,!0),y=v.mrc||1;a.index=v.i;var z=k[0].t.orientation,A=z&&(v.sNorm||v.s),B="h"===z?A:v.x,C="v"===z?A:v.y;return d.extendFlat(a,{color:g(l,v),x0:w-y,x1:w+y,xLabelVal:B,y0:x-y,y1:x+y,yLabelVal:C,spikeDistance:t(v),hovertemplate:l.hovertemplate}),i(v,l,a),f.getComponentMethod("errorbars","hoverInfo")(v,l,a),[a]}}if(-1!==r.indexOf("fills")&&l._polygons){var D,E,F,G,H,I,J,K,L,M=l._polygons,N=[],O=!1,P=1/0,Q=-1/0,R=1/0,S=-1/0;for(D=0;D<M.length;D++)(F=M[D]).contains(q)&&(O=!O,N.push(F),R=Math.min(R,F.ymin),S=Math.max(S,F.ymax));if(O){var T=((R=Math.max(R,0))+(S=Math.min(S,n._length)))/2;for(D=0;D<N.length;D++)for(G=N[D].pts,E=1;E<G.length;E++)(K=G[E-1][1])>T!=(L=G[E][1])>=T&&(I=G[E-1][0],J=G[E][0],L-K&&(H=I+(J-I)*(T-K)/(L-K),P=Math.min(P,H),Q=Math.max(Q,H)));P=Math.max(P,0),Q=Math.min(Q,m._length);var U=h.defaultLine;return h.opacity(l.fillcolor)?U=l.fillcolor:h.opacity((l.line||{}).color)&&(U=l.line.color),d.extendFlat(a,{distance:a.maxHoverDistance,x0:P,x1:Q,y0:T,y1:T,color:U,hovertemplate:!1}),delete a.index,l.text&&!Array.isArray(l.text)?a.text=String(l.text):a.text=l.name,[a]}}}},{"../../components/color":594,"../../components/fx":632,"../../lib":719,"../../registry":848,"./get_trace_color":1120}],1122:[function(a,b,c){"use strict";var d=a("./subtypes");b.exports={hasLines:d.hasLines,hasMarkers:d.hasMarkers,hasText:d.hasText,isBubble:d.isBubble,attributes:a("./attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("./cross_trace_defaults"),calc:a("./calc").calc,crossTraceCalc:a("./cross_trace_calc"),arraysToCalcdata:a("./arrays_to_calcdata"),plot:a("./plot"),colorbar:a("./marker_colorbar"),style:a("./style").style,styleOnSelect:a("./style").styleOnSelect,hoverPoints:a("./hover"),selectPoints:a("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"./arrays_to_calcdata":1110,"./attributes":1111,"./calc":1112,"./cross_trace_calc":1116,"./cross_trace_defaults":1117,"./defaults":1118,"./hover":1121,"./marker_colorbar":1128,"./plot":1130,"./select":1131,"./style":1133,"./subtypes":1134}],1123:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray,e=a("../../components/colorscale/helpers").hasColorscale,f=a("../../components/colorscale/defaults");b.exports=function(a,b,c,g,h,i){var j=(a.marker||{}).color;h("line.color",c),e(a,"line")?f(a,b,g,h,{prefix:"line.",cLetter:"c"}):h("line.color",!d(j)&&j||c),h("line.width"),(i||{}).noDash||h("line.dash")}},{"../../components/colorscale/defaults":604,"../../components/colorscale/helpers":605,"../../lib":719}],1124:[function(a,b,c){"use strict";var d=a("../../constants/numerical"),e=d.BADNUM,f=d.LOG_CLIP,g=f+.5,h=f-.5,i=a("../../lib"),j=i.segmentsIntersect,k=i.constrain,l=a("./constants");b.exports=function(a,b){function c(b){var c=a[b];if(!c)return!1;var d=S.c2p(c.x),f=T.c2p(c.y);if(d===e){if(U&&(d=S.c2p(c.x,!0)),d===e)return!1;V&&f===e&&(d*=Math.abs(S._m*X*(S._m>0?g:h)/(T._m*W*(T._m>0?g:h)))),d*=1e3}if(f===e){if(V&&(f=T.c2p(c.y,!0)),f===e)return!1;f*=1e3}return[d,f]}function d(a,b,c,d){var e=c-a,f=d-b,g=.5-a,h=.5-b,i=e*e+f*f,j=e*g+f*h;if(j>0&&j<i){var k=g*f-h*e;if(k*k<i)return!0}}function f(a,b){var c=a[0]/W,e=a[1]/X,f=Math.max(0,-c,c-1,-e,e-1);return f&&void 0!==J&&d(c,e,J,K)&&(f=0),f&&b&&d(c,e,b[0]/W,b[1]/X)&&(f=0),(1+l.toleranceGrowth*f)*Z}function m(a,b){var c=a[0]-b[0],d=a[1]-b[1];return Math.sqrt(c*c+d*d)}function n(a){if(a[0]<ha||a[0]>ia||a[1]<ja||a[1]>ka)return[k(a[0],ha,ia),k(a[1],ja,ka)]}function o(a,b){return a[0]===b[0]&&(a[0]===ha||a[0]===ia)||a[1]===b[1]&&(a[1]===ja||a[1]===ka)||void 0}function p(a,b,c){return function(d,e){var f=n(d),g=n(e),h=[];if(f&&g&&o(f,g))return h;f&&h.push(f),g&&h.push(g);var j=2*i.constrain((d[a]+e[a])/2,b,c)-((f||d)[a]+(g||e)[a]);return j&&((f&&g?j>0==f[a]>g[a]?f:g:f||g)[a]+=j),h}}function q(a){var b=a[0],c=a[1],d=b===ea[fa-1][0],e=c===ea[fa-1][1];if(!d||!e)if(fa>1){var f=b===ea[fa-2][0],g=c===ea[fa-2][1];d&&(b===ha||b===ia)&&f?g?fa--:ea[fa-1]=a:e&&(c===ja||c===ka)&&g?f?fa--:ea[fa-1]=a:ea[fa++]=a}else ea[fa++]=a}function r(a){ea[fa-1][0]!==a[0]&&ea[fa-1][1]!==a[1]&&q([N,O]),q(a),P=null,N=O=0}function s(a){if(J=a[0]/W,K=a[1]/X,L=a[0]<ha?ha:a[0]>ia?ia:0,M=a[1]<ja?ja:a[1]>ka?ka:0,L||M){if(fa)if(P){var b=R(P,a);b.length>1&&(r(b[0]),ea[fa++]=b[1])}else Q=R(ea[fa-1],a)[0],ea[fa++]=Q;else ea[fa++]=[L||a[0],M||a[1]];var c=ea[fa-1];L&&M&&(c[0]!==L||c[1]!==M)?(P&&(N!==L&&O!==M?q(N&&O?(d=P,f=(e=a)[0]-d[0],g=(e[1]-d[1])/f,(d[1]*e[0]-e[1]*d[0])/f>0?[g>0?ha:ia,ka]:[g>0?ia:ha,ja]):[N||L,O||M]):N&&O&&q([N,O])),q([L,M])):N-L&&O-M&&q([L||N,M||O]),P=a,N=L,O=M}else P&&r(R(P,a)[0]),ea[fa++]=a;var d,e,f,g}var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S=b.xaxis,T=b.yaxis,U="log"===S.type,V="log"===T.type,W=S._length,X=T._length,Y=b.connectGaps,Z=b.baseTolerance,$=b.shape,_="linear"===$,aa=b.fill&&"none"!==b.fill,ba=[],ca=l.minTolerance,da=a.length,ea=new Array(da),fa=0,ga=l.maxScreensAway,ha=-W*ga,ia=W*(1+ga),ja=-X*ga,ka=X*(1+ga),la=[[ha,ja,ia,ja],[ia,ja,ia,ka],[ia,ka,ha,ka],[ha,ka,ha,ja]];for("linear"===$||"spline"===$?R=function(a,b){for(var c=[],d=0,e=0;e<4;e++){var f=la[e],g=j(a[0],a[1],b[0],b[1],f[0],f[1],f[2],f[3]);g&&(!d||Math.abs(g.x-c[0][0])>1||Math.abs(g.y-c[0][1])>1)&&(g=[g.x,g.y],d&&m(g,a)<m(c[0],a)?c.unshift(g):c.push(g),d++)}return c}:"hv"===$||"vh"===$?R=function(a,b){var c=[],d=n(a),e=n(b);return d&&e&&o(d,e)?c:(d&&c.push(d),e&&c.push(e),c)}:"hvh"===$?R=p(0,ha,ia):"vhv"===$&&(R=p(1,ja,ka)),t=0;t<da;t++)if(u=c(t)){for(fa=0,P=null,s(u),t++;t<da;t++){if(!(w=c(t))){if(Y)continue;break}if(_&&b.simplify){var ma=c(t+1);if(C=m(w,u),aa&&(0===fa||fa===da-1)||!(C<f(w,ma)*ca)){for(A=[(w[0]-u[0])/C,(w[1]-u[1])/C],x=u,D=C,E=G=H=0,z=!1,v=w,t++;t<a.length;t++){if(y=ma,ma=c(t+1),!y){if(Y)continue;break}if(I=(B=[y[0]-u[0],y[1]-u[1]])[0]*A[1]-B[1]*A[0],G=Math.min(G,I),(H=Math.max(H,I))-G>f(y,ma))break;v=y,(F=B[0]*A[0]+B[1]*A[1])>D?(D=F,w=y,z=!1):F<E&&(E=F,x=y,z=!0)}if(z?(s(w),v!==x&&s(x)):(x!==u&&s(x),v!==w&&s(w)),s(v),t>=a.length||!y)break;s(y),u=y}}else s(w)}P&&q([N||P[0],O||P[1]]),ba.push(ea.slice(0,fa))}return ba}},{"../../constants/numerical":695,"../../lib":719,"./constants":1115}],1125:[function(a,b,c){"use strict";b.exports=function(a,b,c){"spline"===c("line.shape")&&c("line.smoothing")}},{}],1126:[function(a,b,c){"use strict";var d={tonextx:1,tonexty:1,tonext:1};b.exports=function(a,b,c){var e,f,g,h,i,j={},k=!1,l=-1,m=0,n=-1;for(f=0;f<c.length;f++)(g=(e=c[f][0].trace).stackgroup||"")?g in j?i=j[g]:(i=j[g]=m,m++):e.fill in d&&n>=0?i=n:(i=n=m,m++),i<l&&(k=!0),e._groupIndex=l=i;var o=c.slice();k&&o.sort(function(a,b){var c=a[0].trace,d=b[0].trace;return c._groupIndex-d._groupIndex||c.index-d.index});var p={};for(f=0;f<o.length;f++)g=(e=o[f][0].trace).stackgroup||"",!0===e.visible?(e._nexttrace=null,e.fill in d&&(h=p[g],e._prevtrace=h||null,h&&(h._nexttrace=e)),e._ownfill=e.fill&&("tozero"===e.fill.substr(0,6)||"toself"===e.fill||"to"===e.fill.substr(0,2)&&!e._prevtrace),p[g]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return o}},{}],1127:[function(a,b,c){"use strict";var d=a("fast-isnumeric");b.exports=function(a){var b=a.marker,c=b.sizeref||1,e=b.sizemin||0,f="area"===b.sizemode?function(a){return Math.sqrt(a/c)}:function(a){return a/c};return function(a){var b=f(a/2);return d(b)&&b>0?Math.max(b,e):0}}},{"fast-isnumeric":226}],1128:[function(a,b,c){"use strict";b.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1129:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("../../components/colorscale/helpers").hasColorscale,f=a("../../components/colorscale/defaults"),g=a("./subtypes");b.exports=function(a,b,c,h,i,j){var k=g.isBubble(a),l=(a.line||{}).color;j=j||{},l&&(c=l),i("marker.symbol"),i("marker.opacity",k?.7:1),i("marker.size"),i("marker.color",c),e(a,"marker")&&f(a,b,h,i,{prefix:"marker.",cLetter:"c"}),j.noSelect||(i("selected.marker.color"),i("unselected.marker.color"),i("selected.marker.size"),i("unselected.marker.size")),j.noLine||(i("marker.line.color",l&&!Array.isArray(l)&&b.marker.color!==l?l:k?d.background:d.defaultLine),e(a,"marker.line")&&f(a,b,h,i,{prefix:"marker.line.",cLetter:"c"}),i("marker.line.width",k?1:0)),k&&(i("marker.sizeref"),i("marker.sizemin"),i("marker.sizemode")),j.gradient&&"none"!==i("marker.gradient.type")&&i("marker.gradient.color")}},{"../../components/color":594,"../../components/colorscale/defaults":604,"../../components/colorscale/helpers":605,"./subtypes":1134}],1130:[function(a,b,c){"use strict";function d(a,b,c,d,m,o,p){function q(a){return z?a.transition():a}function r(a){q(a).attr("d","M0,0Z")}function s(a){return a.filter(function(a){return!a.gap&&a.vis})}function t(a){return a.filter(function(a){return a.vis})}function u(a){return a.filter(function(a){return!a.gap})}function v(a){return a.id}function w(a){if(a.ids)return v}function x(){return!1}var y;!function(a,b,c,d,f){var h=c.xaxis,i=c.yaxis,j=e.extent(g.simpleMap(h.range,h.r2c)),l=e.extent(g.simpleMap(i.range,i.r2c)),m=d[0].trace;if(k.hasMarkers(m)){var n=m.marker.maxdisplayed;if(0!==n){var o=d.filter(function(a){return a.x>=j[0]&&a.x<=j[1]&&a.y>=l[0]&&a.y<=l[1]}),p=Math.ceil(o.length/n),q=0;f.forEach(function(a,c){var d=a[0].trace;k.hasMarkers(d)&&d.marker.maxdisplayed>0&&c<b&&q++});var r=Math.round(q*p/3+Math.floor(q/3)*p/7.1);d.forEach(function(a){delete a.vis}),o.forEach(function(a,b){0===Math.round((b+r)%p)&&(a.vis=!0)})}}}(0,b,c,d,m);var z=!!p&&p.duration>0,A=c.xaxis,B=c.yaxis,C=d[0].trace,D=C.line,E=e.select(o),F=h(E,"g","errorbars"),G=h(E,"g","lines"),H=h(E,"g","points"),I=h(E,"g","text");if(f.getComponentMethod("errorbars","plot")(a,F,c,p),!0===C.visible){var J,K;q(E).style("opacity",C.opacity);var L=C.fill.charAt(C.fill.length-1);"x"!==L&&"y"!==L&&(L=""),d[0][c.isRangePlot?"nodeRangePlot3":"node3"]=E;var M,N,O="",P=[],Q=C._prevtrace;Q&&(O=Q._prevRevpath||"",K=Q._nextFill,P=Q._polygons);var R,S,T,U,V,W,X,Y="",Z="",$=[],_=g.noop;if(J=C._ownFill,k.hasLines(C)||"none"!==C.fill){for(K&&K.datum(d),-1!==["hv","vh","hvh","vhv"].indexOf(D.shape)?(R=j.steps(D.shape),S=j.steps(D.shape.split("").reverse().join(""))):R=S="spline"===D.shape?function(a){var b=a[a.length-1];return a.length>1&&a[0][0]===b[0]&&a[0][1]===b[1]?j.smoothclosed(a.slice(1),D.smoothing):j.smoothopen(a,D.smoothing)}:function(a){return"M"+a.join("L")},T=function(a){return S(a.reverse())},$=l(d,{xaxis:A,yaxis:B,connectGaps:C.connectgaps,baseTolerance:Math.max(D.width||1,3)/4,shape:D.shape,simplify:D.simplify,fill:C.fill}),X=C._polygons=new Array($.length),y=0;y<$.length;y++)C._polygons[y]=n($[y]);$.length&&(U=$[0][0],W=(V=$[$.length-1])[V.length-1]),_=function(a){return function(b){if(M=R(b),N=T(b),Y?L?(Y+="L"+M.substr(1),Z=N+"L"+Z.substr(1)):(Y+="Z"+M,Z=N+"Z"+Z):(Y=M,Z=N),k.hasLines(C)&&b.length>1){var c=e.select(this);if(c.datum(d),a)q(c.style("opacity",0).attr("d",M).call(j.lineGroupStyle)).style("opacity",1);else{var f=q(c);f.attr("d",M),j.singleLineStyle(d,f)}}}}}var aa=G.selectAll(".js-line").data($);q(aa.exit()).style("opacity",0).remove(),aa.each(_(!1)),aa.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(j.lineGroupStyle).each(_(!0)),j.setClipUrl(aa,c.layerClipId,a),$.length?(J?(J.datum(d),U&&W&&(L?("y"===L?U[1]=W[1]=B.c2p(0,!0):"x"===L&&(U[0]=W[0]=A.c2p(0,!0)),q(J).attr("d","M"+W+"L"+U+"L"+Y.substr(1)).call(j.singleFillStyle)):q(J).attr("d",Y+"Z").call(j.singleFillStyle))):K&&("tonext"===C.fill.substr(0,6)&&Y&&O?("tonext"===C.fill?q(K).attr("d",Y+"Z"+O+"Z").call(j.singleFillStyle):q(K).attr("d",Y+"L"+O.substr(1)+"Z").call(j.singleFillStyle),C._polygons=C._polygons.concat(P)):(r(K),C._polygons=null)),C._prevRevpath=Z,C._prevPolygons=X):(J?r(J):K&&r(K),C._polygons=C._prevRevpath=C._prevPolygons=null),H.datum(d),I.datum(d),function(b,d,f){var g,h=f[0].trace,l=k.hasMarkers(h),m=k.hasText(h),n=w(h),o=x,p=x;if(l||m){var r=i,v=h.stackgroup,y=v&&"infer zero"===a._fullLayout._scatterStackOpts[A._id+B._id][v].stackgaps;h.marker.maxdisplayed||h._needsCull?r=y?t:s:v&&!y&&(r=u),l&&(o=r),m&&(p=r)}var C,D=(g=b.selectAll("path.point").data(o,n)).enter().append("path").classed("point",!0);z&&D.call(j.pointStyle,h,a).call(j.translatePoints,A,B).style("opacity",0).transition().style("opacity",1),g.order(),l&&(C=j.makePointStyleFns(h)),g.each(function(b){var d=e.select(this),f=q(d);j.translatePoint(b,f,A,B)?(j.singlePointStyle(b,f,h,C,a),c.layerClipId&&j.hideOutsideRangePoint(b,f,A,B,h.xcalendar,h.ycalendar),h.customdata&&d.classed("plotly-customdata",null!==b.data&&void 0!==b.data)):f.remove()}),z?g.exit().transition().style("opacity",0).remove():g.exit().remove(),(g=d.selectAll("g").data(p,n)).enter().append("g").classed("textpoint",!0).append("text"),g.order(),g.each(function(a){var b=e.select(this),d=q(b.select("text"));j.translatePoint(a,d,A,B)?c.layerClipId&&j.hideOutsideRangePoint(a,b,A,B,h.xcalendar,h.ycalendar):b.remove()}),g.selectAll("text").call(j.textPointStyle,h,a).each(function(a){var b=A.c2p(a.x),c=B.c2p(a.y);e.select(this).selectAll("tspan.line").each(function(){q(e.select(this)).attr({x:b,y:c})})}),g.exit().remove()}(H,I,d);var ba=!1===C.cliponaxis?null:c.layerClipId;j.setClipUrl(H,ba,a),j.setClipUrl(I,ba,a)}}var e=a("d3"),f=a("../../registry"),g=a("../../lib"),h=g.ensureSingle,i=g.identity,j=a("../../components/drawing"),k=a("./subtypes"),l=a("./line_points"),m=a("./link_traces"),n=a("../../lib/polygon").tester;b.exports=function(a,b,c,f,g,k){var l,n,o=!g,p=!!g&&g.duration>0,q=m(a,b,c);(l=f.selectAll("g.trace").data(q,function(a){return a[0].trace.uid})).enter().append("g").attr("class",function(a){return"trace scatter trace"+a[0].trace.uid}).style("stroke-miterlimit",2),l.order(),function(a,b,c){b.each(function(b){var d=h(e.select(this),"g","fills");j.setClipUrl(d,c.layerClipId,a);var f=b[0].trace,g=[];f._ownfill&&g.push("_ownFill"),f._nexttrace&&g.push("_nextFill");var k=d.selectAll("g").data(g,i);k.enter().append("g"),k.exit().each(function(a){f[a]=null}).remove(),k.order().each(function(a){f[a]=h(e.select(this),"path","js-fill")})})}(a,l,b),p?(k&&(n=k()),e.transition().duration(g.duration).ease(g.easing).each("end",function(){n&&n()}).each("interrupt",function(){n&&n()}).each(function(){f.selectAll("g.trace").each(function(c,e){d(a,e,b,c,q,this,g)})})):l.each(function(c,e){d(a,e,b,c,q,this,g)}),o&&l.exit().remove(),f.selectAll("path:not([d])").remove()}},{"../../components/drawing":615,"../../lib":719,"../../lib/polygon":731,"../../registry":848,"./line_points":1124,"./link_traces":1126,"./subtypes":1134,d3:164}],1131:[function(a,b,c){"use strict";var d=a("./subtypes");b.exports=function(a,b){var c,e,f,g,h=a.cd,i=a.xaxis,j=a.yaxis,k=[],l=h[0].trace;if(!d.hasMarkers(l)&&!d.hasText(l))return[];if(!1===b)for(c=0;c<h.length;c++)h[c].selected=0;else for(c=0;c<h.length;c++)e=h[c],f=i.c2p(e.x),g=j.c2p(e.y),null!==e.i&&b.contains([f,g],!1,c,a)?(k.push({pointNumber:e.i,x:i.c2d(e.x),y:j.c2d(e.y)}),e.selected=1):e.selected=0;return k}},{"./subtypes":1134}],1132:[function(a,b,c){"use strict";var d=["orientation","groupnorm","stackgaps"];b.exports=function(a,b,c,e){var f=c._scatterStackOpts,g=e("stackgroup");if(g){var h=b.xaxis+b.yaxis,i=f[h];i||(i=f[h]={});var j=i[g],k=!1;j?j.traces.push(b):(j=i[g]={traceIndices:[],traces:[b]},k=!0);for(var l={orientation:b.x&&!b.y?"h":"v"},m=0;m<d.length;m++){var n=d[m],o=n+"Found";if(!j[o]){var p=void 0!==a[n],q="orientation"===n;if((p||k)&&(j[n]=e(n,l[n]),q&&(j.fillDflt="h"===j[n]?"tonextx":"tonexty"),p&&(j[o]=!0,!k&&(delete j.traces[0][n],q))))for(var r=0;r<j.traces.length-1;r++){var s=j.traces[r];s._input.fill!==s.fill&&(s.fill=j.fillDflt)}}}return j}}},{}],1133:[function(a,b,c){"use strict";function d(a,b,c){g.pointStyle(a.selectAll("path.point"),b,c)}function e(a,b,c){g.textPointStyle(a.selectAll("text"),b,c)}var f=a("d3"),g=a("../../components/drawing"),h=a("../../registry");b.exports={style:function(a){var b=f.select(a).selectAll("g.trace.scatter");b.style("opacity",function(a){return a[0].trace.opacity}),b.selectAll("g.points").each(function(b){d(f.select(this),b.trace||b[0].trace,a)}),b.selectAll("g.text").each(function(b){e(f.select(this),b.trace||b[0].trace,a)}),b.selectAll("g.trace path.js-line").call(g.lineGroupStyle),b.selectAll("g.trace path.js-fill").call(g.fillGroupStyle),h.getComponentMethod("errorbars","style")(b)},stylePoints:d,styleText:e,styleOnSelect:function(a,b,c){var f=b[0].trace;f.selectedpoints?(g.selectedPointStyle(c.selectAll("path.point"),f),g.selectedTextStyle(c.selectAll("text"),f)):(d(c,f,a),e(c,f,a))}}},{"../../components/drawing":615,"../../registry":848,d3:164}],1134:[function(a,b,c){"use strict";var d=a("../../lib");b.exports={hasLines:function(a){return a.visible&&a.mode&&-1!==a.mode.indexOf("lines")},hasMarkers:function(a){return a.visible&&(a.mode&&-1!==a.mode.indexOf("markers")||"splom"===a.type)},hasText:function(a){return a.visible&&a.mode&&-1!==a.mode.indexOf("text")},isBubble:function(a){return d.isPlainObject(a.marker)&&d.isArrayOrTypedArray(a.marker.size)}}},{"../../lib":719}],1135:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b,c,e,f){f=f||{},e("textposition"),d.coerceFont(e,"textfont",c.font),f.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":719}],1136:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../registry");b.exports=function(a,b,c,f){var g,h=f("x"),i=f("y");if(e.getComponentMethod("calendars","handleTraceDefaults")(a,b,["x","y"],c),h){var j=d.minRowLength(h);i?g=Math.min(j,d.minRowLength(i)):(g=j,f("y0"),f("dy"))}else{if(!i)return 0;g=d.minRowLength(i),f("x0"),f("dx")}return b._length=g,g}},{"../../lib":719,"../../registry":848}],1137:[function(a,b,c){"use strict";var d=a("../scatter/attributes"),e=a("../../components/colorscale/attributes"),f=a("../../plots/template_attributes").hovertemplateAttrs,g=a("../../plots/template_attributes").texttemplateAttrs,h=a("../../plots/attributes"),i=a("../../constants/gl3d_dashes"),j=a("../../constants/gl3d_markers"),k=a("../../lib/extend").extendFlat,l=a("../../plot_api/edit_types").overrideAll,m=d.line,n=d.marker,o=n.line,p=k({width:m.width,dash:{valType:"enumerated",values:Object.keys(i),dflt:"solid"}},e("line")),q=b.exports=l({x:d.x,y:d.y,z:{valType:"data_array"},text:k({},d.text,{}),texttemplate:g({},{}),hovertext:k({},d.hovertext,{}),hovertemplate:f(),mode:k({},d.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:d.connectgaps,line:p,marker:k({symbol:{valType:"enumerated",values:Object.keys(j),dflt:"circle",arrayOk:!0},size:k({},n.size,{dflt:8}),sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,opacity:k({},n.opacity,{arrayOk:!1}),colorbar:n.colorbar,line:k({width:k({},o.width,{arrayOk:!1})},e("marker.line"))},e("marker")),textposition:k({},d.textposition,{dflt:"top center"}),textfont:{color:d.textfont.color,size:d.textfont.size,family:k({},d.textfont.family,{arrayOk:!1})},hoverinfo:k({},h.hoverinfo)},"calc","nested");q.x.editType=q.y.editType=q.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":601,"../../constants/gl3d_dashes":692,"../../constants/gl3d_markers":693,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../../plots/template_attributes":843,"../scatter/attributes":1111}],1138:[function(a,b,c){"use strict";var d=a("../scatter/arrays_to_calcdata"),e=a("../scatter/colorscale_calc");b.exports=function(a,b){var c=[{x:!1,y:!1,trace:b,t:{}}];return d(c,b),e(a,b),c}},{"../scatter/arrays_to_calcdata":1110,"../scatter/colorscale_calc":1114}],1139:[function(a,b,c){"use strict";function d(a,b,c,d){if(!b||!b.visible)return null;for(var f=e.getComponentMethod("errorbars","makeComputeError")(b),g=new Array(a.length),h=0;h<a.length;h++){var i=f(+a[h],h);if("log"===d.type){var j=d.c2l(a[h]),k=a[h]-i[0],l=a[h]+i[1];if(g[h]=[(d.c2l(k,!0)-j)*c,(d.c2l(l,!0)-j)*c],k>0){var m=d.c2l(k);d._lowerLogErrorBound||(d._lowerLogErrorBound=m),d._lowerErrorBound=Math.min(d._lowerLogErrorBound,m)}}else g[h]=[-i[0]*c,i[1]*c]}return g}var e=a("../../registry");b.exports=function(a,b,c){var e=[d(a.x,a.error_x,b[0],c.xaxis),d(a.y,a.error_y,b[1],c.yaxis),d(a.z,a.error_z,b[2],c.zaxis)],f=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b].length;return 0}(e);if(0===f)return null;for(var g=new Array(f),h=0;h<f;h++){for(var i=[[0,0,0],[0,0,0]],j=0;j<3;j++)if(e[j])for(var k=0;k<2;k++)i[k][j]=e[j][h][k];g[h]=i}return g}},{"../../registry":848}],1140:[function(a,b,c){"use strict";function d(a,b){this.scene=a,this.uid=b,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}function e(a){return null==a?0:a.indexOf("left")>-1?-1:a.indexOf("right")>-1?1:0}function f(a){return null==a?0:a.indexOf("top")>-1?-1:a.indexOf("bottom")>-1?1:0}function g(a,b){return b(4*a)}function h(a){return v[a]}function i(a,b,c,d,e){var f=null;if(q.isArrayOrTypedArray(a)){f=[];for(var g=0;g<b;g++)void 0===a[g]?f[g]=d:f[g]=c(a[g],e)}else f=c(a,q.identity);return f}function j(a,b){var c,d,j,k,l,m,n=[],o=a.fullSceneLayout,p=a.dataScale,u=o.xaxis,v=o.yaxis,y=o.zaxis,z=b.marker,A=b.line,B=b.x||[],C=b.y||[],D=b.z||[],E=B.length,F=b.xcalendar,G=b.ycalendar,H=b.zcalendar;for(l=0;l<E;l++)c=u.d2l(B[l],0,F)*p[0],d=v.d2l(C[l],0,G)*p[1],j=y.d2l(D[l],0,H)*p[2],n[l]=[c,d,j];if(Array.isArray(b.text))m=b.text;else if(void 0!==b.text)for(m=new Array(E),l=0;l<E;l++)m[l]=b.text;var I=b.texttemplate;if(I){var J=Array.isArray(I),K=J?Math.min(I.length,E):E,L=J?function(a){return I[a]}:function(){return I},M=a.fullLayout._d3locale;for(m=new Array(K),l=0;l<K;l++){var N={};N.text=m[l],w(N,b,l),m[l]=q.texttemplateString(L(l),N,M,N,b._meta||{})}}if(k={position:n,mode:b.mode,text:m},"line"in b&&(k.lineColor=s(A,1,E),k.lineWidth=A.width,k.lineDashes=A.dash),"marker"in b){var O=t(b);k.scatterColor=s(z,1,E),k.scatterSize=i(z.size,E,g,20,O),k.scatterMarker=i(z.symbol,E,h,""),k.scatterLineWidth=z.line.width,k.scatterLineColor=s(z.line,1,E),k.scatterAngle=0}"textposition"in b&&(k.textOffset=function(a){var b=[0,0];if(Array.isArray(a))for(var c=0;c<a.length;c++)b[c]=[0,0],a[c]&&(b[c][0]=e(a[c]),b[c][1]=f(a[c]));else b[0]=e(a),b[1]=f(a);return b}(b.textposition),k.textColor=s(b.textfont,1,E),k.textSize=i(b.textfont.size,E,q.identity,12),k.textFont=b.textfont.family,k.textAngle=0);var P=["x","y","z"];for(k.project=[!1,!1,!1],k.projectScale=[1,1,1],k.projectOpacity=[1,1,1],l=0;l<3;++l){var Q=b.projection[P[l]];(k.project[l]=Q.show)&&(k.projectOpacity[l]=Q.opacity,k.projectScale[l]=Q.scale)}k.errorBounds=x(b,p,o);var R=function(a){for(var b=[0,0,0],c=[[0,0,0],[0,0,0],[0,0,0]],d=[1,1,1],e=0;e<3;e++){var f=a[e];f&&!1!==f.copy_zstyle&&!1!==a[2].visible&&(f=a[2]),f&&f.visible&&(b[e]=f.width/2,c[e]=r(f.color),d[e]=f.thickness)}return{capSize:b,color:c,lineWidth:d}}([b.error_x,b.error_y,b.error_z]);return k.errorColor=R.color,k.errorLineWidth=R.lineWidth,k.errorCapSize=R.capSize,k.delaunayAxis=b.surfaceaxis,k.delaunayColor=r(b.surfacecolor),k}function k(a){if(Array.isArray(a)){var b=a[0];return Array.isArray(b)&&(a=b),"rgb("+a.slice(0,3).map(function(a){return Math.round(255*a)})+")"}return null}var l=a("gl-line3d"),m=a("gl-scatter3d"),n=a("gl-error3d"),o=a("gl-mesh3d"),p=a("delaunay-triangulate"),q=a("../../lib"),r=a("../../lib/str2rgbarray"),s=a("../../lib/gl_format_color").formatColor,t=a("../scatter/make_bubble_size_func"),u=a("../../constants/gl3d_dashes"),v=a("../../constants/gl3d_markers"),w=a("../../components/fx/helpers").appendArrayPointValue,x=a("./calc_errors"),y=d.prototype;y.handlePick=function(a){if(a.object&&(a.object===this.linePlot||a.object===this.delaunayMesh||a.object===this.textMarkers||a.object===this.scatterPlot)){var b=a.index=a.data.index;return a.object.highlight&&a.object.highlight(null),this.scatterPlot&&(a.object=this.scatterPlot,this.scatterPlot.highlight(a.data)),a.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[b]||0===this.textLabels[b])&&(a.textLabel=this.textLabels[b]):a.textLabel=this.textLabels),a.traceCoordinate=[this.data.x[b],this.data.y[b],this.data.z[b]],!0}},y.update=function(a){var b,c,d,e,f=this.scene.glplot.gl,g=u.solid;this.data=a;var h=j(this.scene,a);"mode"in h&&(this.mode=h.mode),"lineDashes"in h&&h.lineDashes in u&&(g=u[h.lineDashes]),this.color=k(h.scatterColor)||k(h.lineColor),this.dataPoints=h.position,b={gl:this.scene.glplot.gl,position:h.position,color:h.lineColor,lineWidth:h.lineWidth||1,dashes:g[0],dashScale:g[1],opacity:a.opacity,connectGaps:a.connectgaps},-1!==this.mode.indexOf("lines")?this.linePlot?this.linePlot.update(b):(this.linePlot=l(b),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var i=a.opacity;if(a.marker&&a.marker.opacity&&(i*=a.marker.opacity),c={gl:this.scene.glplot.gl,position:h.position,color:h.scatterColor,size:h.scatterSize,glyph:h.scatterMarker,opacity:i,orthographic:!0,lineWidth:h.scatterLineWidth,lineColor:h.scatterLineColor,project:h.project,projectScale:h.projectScale,projectOpacity:h.projectOpacity},-1!==this.mode.indexOf("markers")?this.scatterPlot?this.scatterPlot.update(c):(this.scatterPlot=m(c),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),e={gl:this.scene.glplot.gl,position:h.position,glyph:h.text,color:h.textColor,size:h.textSize,angle:h.textAngle,alignment:h.textOffset,font:h.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:a.opacity},this.textLabels=a.hovertext||a.text,-1!==this.mode.indexOf("text")?this.textMarkers?this.textMarkers.update(e):(this.textMarkers=m(e),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),d={gl:this.scene.glplot.gl,position:h.position,color:h.errorColor,error:h.errorBounds,lineWidth:h.errorLineWidth,capSize:h.errorCapSize,opacity:a.opacity},this.errorBars?h.errorBounds?this.errorBars.update(d):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):h.errorBounds&&(this.errorBars=n(d),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),h.delaunayAxis>=0){var q=function(a,b,c){var d,e=(c+1)%3,f=(c+2)%3,g=[],h=[];for(d=0;d<a.length;++d){var i=a[d];!isNaN(i[e])&&isFinite(i[e])&&!isNaN(i[f])&&isFinite(i[f])&&(g.push([i[e],i[f]]),h.push(d))}var j=p(g);for(d=0;d<j.length;++d)for(var k=j[d],l=0;l<k.length;++l)k[l]=h[k[l]];return{positions:a,cells:j,meshColor:b}}(h.position,h.delaunayColor,h.delaunayAxis);q.opacity=a.opacity,this.delaunayMesh?this.delaunayMesh.update(q):(q.gl=f,this.delaunayMesh=o(q),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},y.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},b.exports=function(a,b){var c=new d(a,b.uid);return c.update(b),c}},{"../../components/fx/helpers":629,"../../constants/gl3d_dashes":692,"../../constants/gl3d_markers":693,"../../lib":719,"../../lib/gl_format_color":716,"../../lib/str2rgbarray":742,"../scatter/make_bubble_size_func":1127,"./calc_errors":1139,"delaunay-triangulate":166,"gl-error3d":248,"gl-line3d":256,"gl-mesh3d":281,"gl-scatter3d":298}],1141:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("../scatter/subtypes"),g=a("../scatter/marker_defaults"),h=a("../scatter/line_defaults"),i=a("../scatter/text_defaults"),j=a("./attributes");b.exports=function(a,b,c,k){function l(c,d){return e.coerce(a,b,j,c,d)}if(function(a,b,c,e){var f=0,g=c("x"),h=c("y"),i=c("z");return d.getComponentMethod("calendars","handleTraceDefaults")(a,b,["x","y","z"],e),g&&h&&i&&(f=Math.min(g.length,h.length,i.length),b._length=b._xlength=b._ylength=b._zlength=f),f}(a,b,l,k)){l("text"),l("hovertext"),l("hovertemplate"),l("mode"),f.hasLines(b)&&(l("connectgaps"),h(a,b,c,k,l)),f.hasMarkers(b)&&g(a,b,c,k,l,{noSelect:!0}),f.hasText(b)&&(l("texttemplate"),i(a,b,k,l,{noSelect:!0}));var m=(b.line||{}).color,n=(b.marker||{}).color;l("surfaceaxis")>=0&&l("surfacecolor",m||n);for(var o=["x","y","z"],p=0;p<3;++p){var q="projection."+o[p];l(q+".show")&&(l(q+".opacity"),l(q+".scale"))}var r=d.getComponentMethod("errorbars","supplyDefaults");r(a,b,m||n||c,{axis:"z"}),r(a,b,m||n||c,{axis:"y",inherit:"z"}),r(a,b,m||n||c,{axis:"x",inherit:"z"})}else b.visible=!1}},{"../../lib":719,"../../registry":848,"../scatter/line_defaults":1123,"../scatter/marker_defaults":1129,"../scatter/subtypes":1134,"../scatter/text_defaults":1135,"./attributes":1137}],1142:[function(a,b,c){"use strict";b.exports={plot:a("./convert"),attributes:a("./attributes"),markerSymbols:a("../../constants/gl3d_markers"),supplyDefaults:a("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:a("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:a("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":693,"../../plots/gl3d":807,"./attributes":1137,"./calc":1138,"./convert":1140,"./defaults":1141}],1143:[function(a,b,c){"use strict";var d=a("../scatter/attributes"),e=a("../../plots/attributes"),f=a("../../plots/template_attributes").hovertemplateAttrs,g=a("../../plots/template_attributes").texttemplateAttrs,h=a("../../components/colorscale/attributes"),i=a("../../lib/extend").extendFlat,j=d.marker,k=d.line,l=j.line;b.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:i({},d.mode,{dflt:"markers"}),text:i({},d.text,{}),texttemplate:g({editType:"plot"},{keys:["a","b","text"]}),hovertext:i({},d.hovertext,{}),line:{color:k.color,width:k.width,dash:k.dash,shape:i({},k.shape,{values:["linear","spline"]}),smoothing:k.smoothing,editType:"calc"},connectgaps:d.connectgaps,fill:i({},d.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:d.fillcolor,marker:i({symbol:j.symbol,opacity:j.opacity,maxdisplayed:j.maxdisplayed,size:j.size,sizeref:j.sizeref,sizemin:j.sizemin,sizemode:j.sizemode,
line:i({width:l.width,editType:"calc"},h("marker.line")),gradient:j.gradient,editType:"calc"},h("marker")),textfont:d.textfont,textposition:d.textposition,selected:d.selected,unselected:d.unselected,hoverinfo:i({},e.hoverinfo,{flags:["a","b","text","name"]}),hoveron:d.hoveron,hovertemplate:f()}},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/template_attributes":843,"../scatter/attributes":1111}],1144:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../scatter/colorscale_calc"),f=a("../scatter/arrays_to_calcdata"),g=a("../scatter/calc_selection"),h=a("../scatter/calc").calcMarkerSize,i=a("../carpet/lookup_carpetid");b.exports=function(a,b){var c=b._carpetTrace=i(a,b);if(c&&c.visible&&"legendonly"!==c.visible){var j;b.xaxis=c.xaxis,b.yaxis=c.yaxis;var k,l,m=b._length,n=new Array(m),o=!1;for(j=0;j<m;j++)if(k=b.a[j],l=b.b[j],d(k)&&d(l)){var p=c.ab2xy(+k,+l,!0),q=c.isVisible(+k,+l);q||(o=!0),n[j]={x:p[0],y:p[1],a:k,b:l,vis:q}}else n[j]={x:!1,y:!1};return b._needsCull=o,n[0].carpet=c,n[0].trace=b,h(b,m),e(a,b),f(n,b),g(n,b),n}}},{"../carpet/lookup_carpetid":916,"../scatter/arrays_to_calcdata":1110,"../scatter/calc":1112,"../scatter/calc_selection":1113,"../scatter/colorscale_calc":1114,"fast-isnumeric":226}],1145:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/constants"),f=a("../scatter/subtypes"),g=a("../scatter/marker_defaults"),h=a("../scatter/line_defaults"),i=a("../scatter/line_shape_defaults"),j=a("../scatter/text_defaults"),k=a("../scatter/fillcolor_defaults"),l=a("./attributes");b.exports=function(a,b,c,m){function n(c,e){return d.coerce(a,b,l,c,e)}n("carpet"),b.xaxis="x",b.yaxis="y";var o=n("a"),p=n("b"),q=Math.min(o.length,p.length);if(q){b._length=q,n("text"),n("texttemplate"),n("hovertext"),n("mode",q<e.PTS_LINESONLY?"lines+markers":"lines"),f.hasLines(b)&&(h(a,b,c,m,n),i(a,b,n),n("connectgaps")),f.hasMarkers(b)&&g(a,b,c,m,n,{gradient:!0}),f.hasText(b)&&j(a,b,m,n);var r=[];(f.hasMarkers(b)||f.hasText(b))&&(n("marker.maxdisplayed"),r.push("points")),n("fill"),"none"!==b.fill&&(k(a,b,c,n),f.hasLines(b)||i(a,b,n)),"tonext"!==b.fill&&"toself"!==b.fill||r.push("fills"),"fills"!==n("hoveron",r.join("+")||"points")&&n("hovertemplate"),d.coerceSelectionMarkerOpacity(b,n)}else b.visible=!1}},{"../../lib":719,"../scatter/constants":1115,"../scatter/fillcolor_defaults":1119,"../scatter/line_defaults":1123,"../scatter/line_shape_defaults":1125,"../scatter/marker_defaults":1129,"../scatter/subtypes":1134,"../scatter/text_defaults":1135,"./attributes":1143}],1146:[function(a,b,c){"use strict";b.exports=function(a,b,c,d,e){var f=d[e];return a.a=f.a,a.b=f.b,a.y=f.y,a}},{}],1147:[function(a,b,c){"use strict";var d=a("../scatter/hover"),e=a("../../lib").fillText;b.exports=function(a,b,c,f){function g(a,b){var c;c=a.labelprefix&&a.labelprefix.length>0?a.labelprefix.replace(/ = $/,""):a._hovertitle,w.push(c+": "+b.toFixed(3)+a.labelsuffix)}var h=d(a,b,c,f);if(h&&!1!==h[0].index){var i=h[0];if(void 0===i.index){var j=1-i.y0/a.ya._length,k=a.xa._length,l=k*j/2,m=k-l;return i.x0=Math.max(Math.min(i.x0,m),l),i.x1=Math.max(Math.min(i.x1,m),l),h}var n=i.cd[i.index];i.a=n.a,i.b=n.b,i.xLabelVal=void 0,i.yLabelVal=void 0;var o=i.trace,p=o._carpet,q=p.ab2ij([n.a,n.b]),r=Math.floor(q[0]),s=q[0]-r,t=Math.floor(q[1]),u=q[1]-t,v=p.evalxy([],r,t,s,u);i.yLabel=v[1].toFixed(3),delete i.text;var w=[];if(!o.hovertemplate){var x=(n.hi||o.hoverinfo).split("+");-1!==x.indexOf("all")&&(x=["a","b","text"]),-1!==x.indexOf("a")&&g(p.aaxis,n.a),-1!==x.indexOf("b")&&g(p.baxis,n.b),w.push("y: "+i.yLabel),-1!==x.indexOf("text")&&e(n,o,w),i.extraText=w.join("<br>")}return h}}},{"../../lib":719,"../scatter/hover":1121}],1148:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),calc:a("./calc"),plot:a("./plot"),style:a("../scatter/style").style,styleOnSelect:a("../scatter/style").styleOnSelect,hoverPoints:a("./hover"),selectPoints:a("../scatter/select"),eventData:a("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:a("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"../scatter/marker_colorbar":1128,"../scatter/select":1131,"../scatter/style":1133,"./attributes":1143,"./calc":1144,"./defaults":1145,"./event_data":1146,"./hover":1147,"./plot":1149}],1149:[function(a,b,c){"use strict";var d=a("../scatter/plot"),e=a("../../plots/cartesian/axes"),f=a("../../components/drawing");b.exports=function(a,b,c,g){var h,i,j,k=c[0][0].carpet,l={xaxis:e.getFromId(a,k.xaxis||"x"),yaxis:e.getFromId(a,k.yaxis||"y"),plot:b.plot};for(d(a,l,c,g),h=0;h<c.length;h++)i=c[h][0].trace,j=g.selectAll("g.trace"+i.uid+" .js-line"),f.setClipUrl(j,c[h][0].carpet._clipPathId,a)}},{"../../components/drawing":615,"../../plots/cartesian/axes":767,"../scatter/plot":1130}],1150:[function(a,b,c){"use strict";var d=a("../../plots/template_attributes").hovertemplateAttrs,e=a("../../plots/template_attributes").texttemplateAttrs,f=a("../scatter/attributes"),g=a("../../plots/attributes"),h=a("../../components/colorscale/attributes"),i=a("../../components/drawing/attributes").dash,j=a("../../lib/extend").extendFlat,k=a("../../plot_api/edit_types").overrideAll,l=f.marker,m=f.line,n=l.line;b.exports=k({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names"],dflt:"ISO-3"},mode:j({},f.mode,{dflt:"markers"}),text:j({},f.text,{}),texttemplate:e({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:j({},f.hovertext,{}),textfont:f.textfont,textposition:f.textposition,line:{color:m.color,width:m.width,dash:i},connectgaps:f.connectgaps,marker:j({symbol:l.symbol,opacity:l.opacity,size:l.size,sizeref:l.sizeref,sizemin:l.sizemin,sizemode:l.sizemode,colorbar:l.colorbar,line:j({width:n.width},h("marker.line")),gradient:l.gradient},h("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:f.fillcolor,selected:f.selected,unselected:f.unselected,hoverinfo:j({},g.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:d()},"calc","nested")},{"../../components/colorscale/attributes":601,"../../components/drawing/attributes":614,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../../plots/template_attributes":843,"../scatter/attributes":1111}],1151:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../constants/numerical").BADNUM,f=a("../scatter/colorscale_calc"),g=a("../scatter/arrays_to_calcdata"),h=a("../scatter/calc_selection"),i=a("../../lib")._;b.exports=function(a,b){for(var c=Array.isArray(b.locations),j=c?b.locations.length:b._length,k=new Array(j),l=0;l<j;l++){var m=k[l]={};if(c){var n=b.locations[l];m.loc="string"==typeof n?n:null}else{var o=b.lon[l],p=b.lat[l];d(o)&&d(p)?m.lonlat=[+o,+p]:m.lonlat=[e,e]}}return g(k,b),f(a,b),h(k,b),j&&(k[0].t={labels:{lat:i(a,"lat:")+" ",lon:i(a,"lon:")+" "}}),k}},{"../../constants/numerical":695,"../../lib":719,"../scatter/arrays_to_calcdata":1110,"../scatter/calc_selection":1113,"../scatter/colorscale_calc":1114,"fast-isnumeric":226}],1152:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/subtypes"),f=a("../scatter/marker_defaults"),g=a("../scatter/line_defaults"),h=a("../scatter/text_defaults"),i=a("../scatter/fillcolor_defaults"),j=a("./attributes");b.exports=function(a,b,c,k){function l(c,e){return d.coerce(a,b,j,c,e)}!function(a,b,c){var d,e,f=0,g=c("locations");return g?(c("locationmode"),f=g.length):(d=c("lon")||[],e=c("lat")||[],f=Math.min(d.length,e.length),b._length=f,f)}(0,b,l)?b.visible=!1:(l("text"),l("hovertext"),l("hovertemplate"),l("mode"),e.hasLines(b)&&(g(a,b,c,k,l),l("connectgaps")),e.hasMarkers(b)&&f(a,b,c,k,l,{gradient:!0}),e.hasText(b)&&(l("texttemplate"),h(a,b,k,l)),l("fill"),"none"!==b.fill&&i(a,b,c,l),d.coerceSelectionMarkerOpacity(b,l))}},{"../../lib":719,"../scatter/fillcolor_defaults":1119,"../scatter/line_defaults":1123,"../scatter/marker_defaults":1129,"../scatter/subtypes":1134,"../scatter/text_defaults":1135,"./attributes":1150}],1153:[function(a,b,c){"use strict";b.exports=function(a,b){return a.lon=b.lon,a.lat=b.lat,a.location=b.loc?b.loc:null,a}},{}],1154:[function(a,b,c){"use strict";var d=a("../../components/fx"),e=a("../../plots/cartesian/axes"),f=a("../../constants/numerical").BADNUM,g=a("../scatter/get_trace_color"),h=a("../../lib").fillText,i=a("./attributes");b.exports=function(a,b,c){var j=a.cd,k=j[0].trace,l=a.xa,m=a.ya,n=a.subplot,o=n.projection.isLonLatOverEdges,p=n.project;if(d.getClosest(j,function(a){var d=a.lonlat;if(d[0]===f)return 1/0;if(o(d))return 1/0;var e=p(d),g=p([b,c]),h=Math.abs(e[0]-g[0]),i=Math.abs(e[1]-g[1]),j=Math.max(3,a.mrc||0);return Math.max(Math.sqrt(h*h+i*i)-j,1-3/j)},a),!1!==a.index){var q=j[a.index],r=q.lonlat,s=[l.c2p(r),m.c2p(r)],t=q.mrc||1;a.x0=s[0]-t,a.x1=s[0]+t,a.y0=s[1]-t,a.y1=s[1]+t,a.loc=q.loc,a.lon=r[0],a.lat=r[1];var u=n.mockAxis;return a.lonLabel=e.tickText(u,u.c2l(a.lon),"hover").text,a.latLabel=e.tickText(u,u.c2l(a.lat),"hover").text,a.color=g(k,q),a.extraText=function(a,b,c,d){function e(a){return a+""}if(!a.hovertemplate){var f=b.hi||a.hoverinfo,g="all"===f?i.hoverinfo.flags:f.split("+"),j=-1!==g.indexOf("location")&&Array.isArray(a.locations),k=-1!==g.indexOf("lon"),l=-1!==g.indexOf("lat"),m=-1!==g.indexOf("text"),n=[];return j?n.push(b.loc):k&&l?n.push("("+e(c.lonLabel)+", "+e(c.latLabel)+")"):k?n.push(d.lon+e(c.lonLabel)):l&&n.push(d.lat+e(c.latLabel)),m&&h(b,a,n),n.join("<br>")}}(k,q,a,j[0].t.labels),a.hovertemplate=k.hovertemplate,[a]}}},{"../../components/fx":632,"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767,"../scatter/get_trace_color":1120,"./attributes":1150}],1155:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),calc:a("./calc"),plot:a("./plot"),style:a("./style"),styleOnSelect:a("../scatter/style").styleOnSelect,hoverPoints:a("./hover"),eventData:a("./event_data"),selectPoints:a("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:a("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":797,"../scatter/marker_colorbar":1128,"../scatter/style":1133,"./attributes":1150,"./calc":1151,"./defaults":1152,"./event_data":1153,"./hover":1154,"./plot":1156,"./select":1157,"./style":1158}],1156:[function(a,b,c){"use strict";function d(a,b){var c=a[0].trace;if(Array.isArray(c.locations))for(var d=h(c,b),e=c.locationmode,f=0;f<a.length;f++){var j=a[f],k=i(e,j.loc,d);j.lonlat=k?k.properties.ct:[g,g]}}var e=a("d3"),f=a("../../lib"),g=a("../../constants/numerical").BADNUM,h=a("../../lib/topojson_utils").getTopojsonFeatures,i=a("../../lib/geo_location_utils").locationToFeature,j=a("../../lib/geojson_utils"),k=a("../scatter/subtypes"),l=a("./style");b.exports=function(a,b,c){function h(a,b){a.lonlat[0]===g&&e.select(b).remove()}for(var i=0;i<c.length;i++)d(c[i],b.topojson);var m=b.layers.frontplot.select(".scatterlayer"),n=f.makeTraceGroups(m,c,"trace scattergeo");n.selectAll("*").remove(),n.each(function(b){var c=e.select(this),d=b[0].trace;if(k.hasLines(d)||"none"!==d.fill){var g=j.calcTraceToLineCoords(b),i="none"!==d.fill?j.makePolygon(g):j.makeLine(g);c.selectAll("path.js-line").data([{geojson:i,trace:d}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}k.hasMarkers(d)&&c.selectAll("path.point").data(f.identity).enter().append("path").classed("point",!0).each(function(a){h(a,this)}),k.hasText(d)&&c.selectAll("g").data(f.identity).enter().append("g").append("text").each(function(a){h(a,this)}),l(a,b)})}},{"../../constants/numerical":695,"../../lib":719,"../../lib/geo_location_utils":713,"../../lib/geojson_utils":714,"../../lib/topojson_utils":746,"../scatter/subtypes":1134,"./style":1158,d3:164}],1157:[function(a,b,c){"use strict";var d=a("../scatter/subtypes"),e=a("../../constants/numerical").BADNUM;b.exports=function(a,b){var c,f,g,h,i,j=a.cd,k=a.xaxis,l=a.yaxis,m=[],n=j[0].trace;if(!d.hasMarkers(n)&&!d.hasText(n))return[];if(!1===b)for(i=0;i<j.length;i++)j[i].selected=0;else for(i=0;i<j.length;i++)(f=(c=j[i]).lonlat)[0]!==e&&(g=k.c2p(f),h=l.c2p(f),b.contains([g,h],null,i,a)?(m.push({pointNumber:i,lon:f[0],lat:f[1]}),c.selected=1):c.selected=0);return m}},{"../../constants/numerical":695,"../scatter/subtypes":1134}],1158:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../components/drawing"),f=a("../../components/color"),g=a("../scatter/style"),h=g.stylePoints,i=g.styleText;b.exports=function(a,b){b&&function(a,b){var c=b[0].trace,g=b[0].node3;g.style("opacity",b[0].trace.opacity),h(g,c,a),i(g,c,a),g.selectAll("path.js-line").style("fill","none").each(function(a){var b=d.select(this),c=a.trace,g=c.line||{};b.call(f.stroke,g.color).call(e.dashLine,g.dash||"",g.width||0),"none"!==c.fill&&b.call(f.fill,c.fillcolor)})}(a,b)}},{"../../components/color":594,"../../components/drawing":615,"../scatter/style":1133,d3:164}],1159:[function(a,b,c){"use strict";var d=a("../../plots/attributes"),e=a("../scatter/attributes"),f=a("../../components/colorscale/attributes"),g=a("../../lib/extend").extendFlat,h=a("../../plot_api/edit_types").overrideAll,i=a("./constants").DASHES,j=e.line,k=e.marker,l=k.line,m=b.exports=h({x:e.x,x0:e.x0,dx:e.dx,y:e.y,y0:e.y0,dy:e.dy,text:e.text,hovertext:e.hovertext,textposition:e.textposition,textfont:e.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:j.color,width:j.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:Object.keys(i),dflt:"solid"}},marker:g({},f("marker"),{symbol:k.symbol,size:k.size,sizeref:k.sizeref,sizemin:k.sizemin,sizemode:k.sizemode,opacity:k.opacity,colorbar:k.colorbar,line:g({},f("marker.line"),{width:l.width})}),connectgaps:e.connectgaps,fill:g({},e.fill,{dflt:"none"}),fillcolor:e.fillcolor,selected:{marker:e.selected.marker,textfont:e.selected.textfont},unselected:{marker:e.unselected.marker,textfont:e.unselected.textfont},opacity:d.opacity},"calc","nested");m.x.editType=m.y.editType=m.x0.editType=m.y0.editType="calc+clearAxisTypes",m.hovertemplate=e.hovertemplate,m.texttemplate=e.texttemplate},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../scatter/attributes":1111,"./constants":1161}],1160:[function(a,b,c){"use strict";function d(a,b,c){var d=a._extremes[b._id],e=h(b,c._bnds,{padded:!0});d.min=d.min.concat(e.min),d.max=d.max.concat(e.max)}var e=a("point-cluster"),f=a("../../lib"),g=a("../../plots/cartesian/axis_ids"),h=a("../../plots/cartesian/autorange").findExtremes,i=a("../scatter/calc"),j=i.calcMarkerSize,k=i.calcAxisExpansion,l=i.setFirstScatter,m=a("../scatter/colorscale_calc"),n=a("./convert"),o=a("./scene_update"),p=a("../../constants/numerical").BADNUM,q=a("./constants").TOO_MANY_POINTS;b.exports=function(a,b){var c,h,i,r=a._fullLayout,s=g.getFromId(a,b.xaxis),t=g.getFromId(a,b.yaxis),u=r._plots[b.xaxis+b.yaxis],v=b._length,w=v>=q,x=2*v,y={},z=s.makeCalcdata(b,"x"),A=t.makeCalcdata(b,"y"),B=new Array(x);for(c=0;c<v;c++)h=z[c],i=A[c],B[2*c]=h===p?NaN:h,B[2*c+1]=i===p?NaN:i;if("log"===s.type)for(c=0;c<x;c+=2)B[c]=s.c2l(B[c]);if("log"===t.type)for(c=1;c<x;c+=2)B[c]=t.c2l(B[c]);if(w&&"log"!==s.type&&"log"!==t.type)y.tree=e(B);else{var C=y.ids=new Array(v);for(c=0;c<v;c++)C[c]=c}m(a,b);var D,E=function(a,b,c,d,e,g){var h=n.style(a,c);if(h.marker&&(h.marker.positions=d),h.line&&d.length>1&&f.extendFlat(h.line,n.linePositions(a,c,d)),h.errorX||h.errorY){var i=n.errorBarPositions(a,c,d,e,g);h.errorX&&f.extendFlat(h.errorX,i.x),h.errorY&&f.extendFlat(h.errorY,i.y)}return h.text&&(f.extendFlat(h.text,{positions:d},n.textPosition(a,c,h.text,h.marker)),f.extendFlat(h.textSel,{positions:d},n.textPosition(a,c,h.text,h.markerSel)),f.extendFlat(h.textUnsel,{positions:d},n.textPosition(a,c,h.text,h.markerUnsel))),h}(a,0,b,B,z,A),F=o(a,u);return l(r,b),w?E.marker&&(D=2*(E.marker.sizeAvg||Math.max(E.marker.size,3))):D=j(b,v),k(a,b,s,t,z,A,D),E.errorX&&d(b,s,E.errorX),E.errorY&&d(b,t,E.errorY),E.fill&&!F.fill2d&&(F.fill2d=!0),E.marker&&!F.scatter2d&&(F.scatter2d=!0),E.line&&!F.line2d&&(F.line2d=!0),!E.errorX&&!E.errorY||F.error2d||(F.error2d=!0),E.text&&!F.glText&&(F.glText=!0),E.marker&&(E.marker.snap=y.tree||q),F.lineOptions.push(E.line),F.errorXOptions.push(E.errorX),F.errorYOptions.push(E.errorY),F.fillOptions.push(E.fill),F.markerOptions.push(E.marker),F.markerSelectedOptions.push(E.markerSel),F.markerUnselectedOptions.push(E.markerUnsel),F.textOptions.push(E.text),F.textSelectedOptions.push(E.textSel),F.textUnselectedOptions.push(E.textUnsel),F.selectBatch.push([]),F.unselectBatch.push([]),y._scene=F,y.index=F.count,y.x=z,y.y=A,y.positions=B,F.count++,[{x:!1,y:!1,t:y,trace:b}]}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/autorange":766,"../../plots/cartesian/axis_ids":770,"../scatter/calc":1112,"../scatter/colorscale_calc":1114,"./constants":1161,"./convert":1162,"./scene_update":1168,"point-cluster":470}],1161:[function(a,b,c){"use strict";b.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1162:[function(a,b,c){"use strict";function d(a,b){var c,d=a._length,e=a.textfont,f=a.textposition,g=Array.isArray(f)?f:[f],h=e.color,i=e.size,k=e.family,l={},m=a.texttemplate;if(m){l.text=[];var o=Array.isArray(m),p=o?Math.min(m.length,d):d,q=o?function(a){return m[a]}:function(){return m},r=b._fullLayout._d3locale;for(c=0;c<p;c++){var s={};w(s,a,c),l.text.push(n.texttemplateString(q(c),s,r,s,a._meta||{}))}}else Array.isArray(a.text)&&a.text.length<d?l.text=a.text.slice():l.text=a.text;if(Array.isArray(l.text))for(c=l.text.length;c<d;c++)l.text[c]="";for(l.opacity=a.opacity,l.font={},l.align=[],l.baseline=[],c=0;c<g.length;c++){var t=g[c].split(/\s+/);switch(t[1]){case"left":l.align.push("right");break;case"right":l.align.push("left");break;default:l.align.push(t[1])}switch(t[0]){case"top":l.baseline.push("bottom");break;case"bottom":l.baseline.push("top");break;default:l.baseline.push(t[0])}}if(Array.isArray(h))for(l.color=new Array(d),c=0;c<d;c++)l.color[c]=h[c];else l.color=h;if(Array.isArray(i)||Array.isArray(k))for(l.font=new Array(d),c=0;c<d;c++){var u=l.font[c]={};u.size=Array.isArray(i)?j(i[c])?i[c]:0:i,u.family=Array.isArray(k)?k[c]:k}else l.font={size:i,family:k};return l}function e(a){var b,c,d=a._length,e=a.marker,f={},g=Array.isArray(e.symbol),h=n.isArrayOrTypedArray(e.color),j=n.isArrayOrTypedArray(e.line.color),k=n.isArrayOrTypedArray(e.opacity),m=n.isArrayOrTypedArray(e.size),o=n.isArrayOrTypedArray(e.line.width);if(g||(c=t.OPEN_RE.test(e.symbol)),g||h||j||k){f.colors=new Array(d),f.borderColors=new Array(d);var p=q(e,e.opacity,d),r=q(e.line,e.opacity,d);if(!Array.isArray(r[0])){var u=r;for(r=Array(d),b=0;b<d;b++)r[b]=u}if(!Array.isArray(p[0])){var v=p;for(p=Array(d),b=0;b<d;b++)p[b]=v}for(f.colors=p,f.borderColors=r,b=0;b<d;b++){if(g){var w=e.symbol[b];c=t.OPEN_RE.test(w)}c&&(r[b]=p[b].slice(),p[b]=p[b].slice(),p[b][3]=0)}f.opacity=a.opacity}else c?(f.color=l(e.color,"uint8"),f.color[3]=0,f.borderColor=l(e.color,"uint8")):(f.color=l(e.color,"uint8"),f.borderColor=l(e.line.color,"uint8")),f.opacity=a.opacity*e.opacity;if(g)for(f.markers=new Array(d),b=0;b<d;b++)f.markers[b]=i(e.symbol[b]);else f.marker=i(e.symbol);var x,y=s(a);if(m||o){var z,A=f.sizes=new Array(d),B=f.borderSizes=new Array(d),C=0;if(m){for(b=0;b<d;b++)A[b]=y(e.size[b]),C+=A[b];z=C/d}else for(x=y(e.size),b=0;b<d;b++)A[b]=x;if(o)for(b=0;b<d;b++)B[b]=e.line.width[b]/2;else for(x=e.line.width/2,b=0;b<d;b++)B[b]=x;f.sizeAvg=z}else f.size=y(e&&e.size||10),f.borderSizes=y(e.line.width);return f}function f(a,b){var c=a.marker,d={};return b?(b.marker&&b.marker.symbol?d=e(n.extendFlat({},c,b.marker)):b.marker&&(b.marker.size&&(d.size=b.marker.size/2),b.marker.color&&(d.colors=b.marker.color),void 0!==b.marker.opacity&&(d.opacity=b.marker.opacity)),d):d}function g(a,b){var c={};if(!b)return c;if(b.textfont){var e={opacity:1,text:a.text,textposition:a.textposition,textfont:n.extendFlat({},a.textfont)};b.textfont&&n.extendFlat(e.textfont,b.textfont),c=d(e)}return c}function h(a,b){var c={capSize:2*b.width,lineWidth:b.thickness,color:b.color};return b.copy_ystyle&&(c=a.error_y),c}function i(a){if("circle"===a)return null;var b,c,d=o.symbolNumber(a),e=o.symbolFuncs[d%100],f=!!o.symbolNoDot[d%100],g=!!o.symbolNoFill[d%100],h=t.DOT_RE.test(a);return A[a]?A[a]:(b=h&&!f?e(1.1*y)+B:e(y),c=k(b,{w:x,h:x,viewBox:[-y,-y,y,y],stroke:g?z:-z}),A[a]=c,c||null)}var j=a("fast-isnumeric"),k=a("svg-path-sdf"),l=a("color-normalize"),m=a("../../registry"),n=a("../../lib"),o=a("../../components/drawing"),p=a("../../plots/cartesian/axis_ids"),q=a("../../lib/gl_format_color").formatColor,r=a("../scatter/subtypes"),s=a("../scatter/make_bubble_size_func"),t=a("./constants"),u=a("../../constants/interactions").DESELECTDIM,v={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},w=a("../../components/fx/helpers").appendArrayPointValue,x=t.SYMBOL_SDF_SIZE,y=t.SYMBOL_SIZE,z=t.SYMBOL_STROKE,A={},B=o.symbolFuncs[0](.05*y);b.exports={style:function(a,b){var c,i={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0};if(!0!==b.visible)return i;if(r.hasText(b)&&(i.text=d(b,a),i.textSel=g(b,b.selected),i.textUnsel=g(b,b.unselected)),r.hasMarkers(b)&&(i.marker=e(b),i.markerSel=f(b,b.selected),i.markerUnsel=f(b,b.unselected),!b.unselected&&Array.isArray(b.marker.opacity))){var j=b.marker.opacity;for(i.markerUnsel.opacity=new Array(j.length),c=0;c<j.length;c++)i.markerUnsel.opacity[c]=u*j[c]}if(r.hasLines(b)){i.line={overlay:!0,thickness:b.line.width,color:b.line.color,opacity:b.opacity};var k=(t.DASHES[b.line.dash]||[1]).slice();for(c=0;c<k.length;++c)k[c]*=b.line.width;i.line.dashes=k}return b.error_x&&b.error_x.visible&&(i.errorX=h(b,b.error_x)),b.error_y&&b.error_y.visible&&(i.errorY=h(b,b.error_y)),b.fill&&"none"!==b.fill&&(i.fill={closed:!0,fill:b.fillcolor,thickness:0}),i},markerStyle:e,markerSelection:f,linePositions:function(a,b,c){var d,e,f=c.length,g=f/2;if(r.hasLines(b)&&g)if("hv"===b.line.shape){for(d=[],e=0;e<g-1;e++)isNaN(c[2*e])||isNaN(c[2*e+1])?d.push(NaN,NaN,NaN,NaN):(d.push(c[2*e],c[2*e+1]),isNaN(c[2*e+2])||isNaN(c[2*e+3])?d.push(NaN,NaN):d.push(c[2*e+2],c[2*e+1]));d.push(c[f-2],c[f-1])}else if("hvh"===b.line.shape){for(d=[],e=0;e<g-1;e++)if(isNaN(c[2*e])||isNaN(c[2*e+1])||isNaN(c[2*e+2])||isNaN(c[2*e+3]))isNaN(c[2*e])||isNaN(c[2*e+1])?d.push(NaN,NaN):d.push(c[2*e],c[2*e+1]),d.push(NaN,NaN);else{var h=(c[2*e]+c[2*e+2])/2;d.push(c[2*e],c[2*e+1],h,c[2*e+1],h,c[2*e+3])}d.push(c[f-2],c[f-1])}else if("vhv"===b.line.shape){for(d=[],e=0;e<g-1;e++)if(isNaN(c[2*e])||isNaN(c[2*e+1])||isNaN(c[2*e+2])||isNaN(c[2*e+3]))isNaN(c[2*e])||isNaN(c[2*e+1])?d.push(NaN,NaN):d.push(c[2*e],c[2*e+1]),d.push(NaN,NaN);else{var i=(c[2*e+1]+c[2*e+3])/2;d.push(c[2*e],c[2*e+1],c[2*e],i,c[2*e+2],i)}d.push(c[f-2],c[f-1])}else if("vh"===b.line.shape){for(d=[],e=0;e<g-1;e++)isNaN(c[2*e])||isNaN(c[2*e+1])?d.push(NaN,NaN,NaN,NaN):(d.push(c[2*e],c[2*e+1]),isNaN(c[2*e+2])||isNaN(c[2*e+3])?d.push(NaN,NaN):d.push(c[2*e],c[2*e+3]));d.push(c[f-2],c[f-1])}else d=c;var j=!1;for(e=0;e<d.length;e++)if(isNaN(d[e])){j=!0;break}var k=j||d.length>t.TOO_MANY_POINTS?"rect":r.hasMarkers(b)?"rect":"round";if(j&&b.connectgaps){var l=d[0],m=d[1];for(e=0;e<d.length;e+=2)isNaN(d[e])||isNaN(d[e+1])?(d[e]=l,d[e+1]=m):(l=d[e],m=d[e+1])}return{join:k,positions:d}},errorBarPositions:function(a,b,c,d,e){function f(a,d){var e=d._id.charAt(0),f=b["error_"+e];if(f&&f.visible&&("linear"===d.type||"log"===d.type)){for(var h=g(f),i={x:0,y:1}[e],m={x:[0,1,2,3],y:[2,3,0,1]}[e],n=new Float64Array(4*k),o=1/0,p=-1/0,q=0,r=0;q<k;q++,r+=4){var s=a[q];if(j(s)){var t=c[2*q+i],u=h(s,q),v=u[0],w=u[1];if(j(v)&&j(w)){var x=s-v,y=s+w;n[r+m[0]]=t-d.c2l(x),n[r+m[1]]=d.c2l(y)-t,n[r+m[2]]=0,n[r+m[3]]=0,o=Math.min(o,s-v),p=Math.max(p,s+w)}}}l[e]={positions:c,errors:n,_bnds:[o,p]}}}var g=m.getComponentMethod("errorbars","makeComputeError"),h=p.getFromId(a,b.xaxis),i=p.getFromId(a,b.yaxis),k=c.length/2,l={};return f(d,h),f(e,i),l},textPosition:function(a,b,c,d){var e,f=b._length,g={};if(r.hasMarkers(b)){var h=c.font,i=c.align,j=c.baseline;for(g.offset=new Array(f),e=0;e<f;e++){var k=d.sizes?d.sizes[e]:d.size,l=Array.isArray(h)?h[e].size:h.size,m=Array.isArray(i)?i.length>1?i[e]:i[0]:i,n=Array.isArray(j)?j.length>1?j[e]:j[0]:j,o=v[m],p=v[n],q=k?k/.8+1:0,s=-p*q-.5*p;g.offset[e]=[o*q/l,s/l]}}return g}}},{"../../components/drawing":615,"../../components/fx/helpers":629,"../../constants/interactions":694,"../../lib":719,"../../lib/gl_format_color":716,"../../plots/cartesian/axis_ids":770,"../../registry":848,"../scatter/make_bubble_size_func":1127,"../scatter/subtypes":1134,"./constants":1161,"color-normalize":121,"fast-isnumeric":226,"svg-path-sdf":536}],1163:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../registry"),f=a("./attributes"),g=a("../scatter/constants"),h=a("../scatter/subtypes"),i=a("../scatter/xy_defaults"),j=a("../scatter/marker_defaults"),k=a("../scatter/line_defaults"),l=a("../scatter/fillcolor_defaults"),m=a("../scatter/text_defaults");b.exports=function(a,b,c,n){function o(c,e){return d.coerce(a,b,f,c,e)}var p=!!a.marker&&/-open/.test(a.marker.symbol),q=h.isBubble(a),r=i(a,b,n,o);if(r){var s=r<g.PTS_LINESONLY?"lines+markers":"lines";o("text"),o("hovertext"),o("hovertemplate"),o("mode",s),h.hasLines(b)&&(o("connectgaps"),k(a,b,c,n,o),o("line.shape")),h.hasMarkers(b)&&(j(a,b,c,n,o),o("marker.line.width",p||q?1:0)),h.hasText(b)&&(o("texttemplate"),m(a,b,n,o));var t=(b.line||{}).color,u=(b.marker||{}).color;o("fill"),"none"!==b.fill&&l(a,b,c,o);var v=e.getComponentMethod("errorbars","supplyDefaults");v(a,b,t||u||c,{axis:"y"}),v(a,b,t||u||c,{axis:"x",inherit:"y"}),d.coerceSelectionMarkerOpacity(b,o)}else b.visible=!1}},{"../../lib":719,"../../registry":848,"../scatter/constants":1115,"../scatter/fillcolor_defaults":1119,"../scatter/line_defaults":1123,"../scatter/marker_defaults":1129,"../scatter/subtypes":1134,"../scatter/text_defaults":1135,"../scatter/xy_defaults":1136,"./attributes":1159}],1164:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/color"),f=a("../../constants/interactions").DESELECTDIM;b.exports={styleTextSelection:function(a){var b,c,g=a[0],h=g.trace,i=g.t,j=i._scene,k=i.index,l=j.selectBatch[k],m=j.unselectBatch[k],n=j.textOptions[k],o=j.textSelectedOptions[k]||{},p=j.textUnselectedOptions[k]||{},q=d.extendFlat({},n);if(l.length||m.length){var r=o.color,s=p.color,t=n.color,u=Array.isArray(t);for(q.color=new Array(h._length),b=0;b<l.length;b++)c=l[b],q.color[c]=r||(u?t[c]:t);for(b=0;b<m.length;b++){c=m[b];var v=u?t[c]:t;q.color[c]=s||(r?v:e.addOpacity(v,f))}}j.glText[k].update(q)}}},{"../../components/color":594,"../../constants/interactions":694,"../../lib":719}],1165:[function(a,b,c){"use strict";function d(a,b,c,d){var h=a.xa,i=a.ya,j=a.distance,k=a.dxy,l=a.index,m={pointNumber:l,x:b[l],y:c[l]};m.tx=Array.isArray(d.text)?d.text[l]:d.text,m.htx=Array.isArray(d.hovertext)?d.hovertext[l]:d.hovertext,m.data=Array.isArray(d.customdata)?d.customdata[l]:d.customdata,m.tp=Array.isArray(d.textposition)?d.textposition[l]:d.textposition;var n=d.textfont;n&&(m.ts=Array.isArray(n.size)?n.size[l]:n.size,m.tc=Array.isArray(n.color)?n.color[l]:n.color,m.tf=Array.isArray(n.family)?n.family[l]:n.family);var o=d.marker;o&&(m.ms=f.isArrayOrTypedArray(o.size)?o.size[l]:o.size,m.mo=f.isArrayOrTypedArray(o.opacity)?o.opacity[l]:o.opacity,m.mx=Array.isArray(o.symbol)?o.symbol[l]:o.symbol,m.mc=f.isArrayOrTypedArray(o.color)?o.color[l]:o.color);var p=o&&o.line;p&&(m.mlc=Array.isArray(p.color)?p.color[l]:p.color,m.mlw=f.isArrayOrTypedArray(p.width)?p.width[l]:p.width);var q=o&&o.gradient;q&&"none"!==q.type&&(m.mgt=Array.isArray(q.type)?q.type[l]:q.type,m.mgc=Array.isArray(q.color)?q.color[l]:q.color);var r=h.c2p(m.x,!0),s=i.c2p(m.y,!0),t=m.mrc||1,u=d.hoverlabel;u&&(m.hbg=Array.isArray(u.bgcolor)?u.bgcolor[l]:u.bgcolor,m.hbc=Array.isArray(u.bordercolor)?u.bordercolor[l]:u.bordercolor,m.hts=Array.isArray(u.font.size)?u.font.size[l]:u.font.size,m.htc=Array.isArray(u.font.color)?u.font.color[l]:u.font.color,m.htf=Array.isArray(u.font.family)?u.font.family[l]:u.font.family,m.hnl=Array.isArray(u.namelength)?u.namelength[l]:u.namelength);var v=d.hoverinfo;v&&(m.hi=Array.isArray(v)?v[l]:v);var w=d.hovertemplate;w&&(m.ht=Array.isArray(w)?w[l]:w);var x={};x[a.index]=m;var y=f.extendFlat({},a,{color:g(d,m),x0:r-t,x1:r+t,xLabelVal:m.x,y0:s-t,y1:s+t,yLabelVal:m.y,cd:x,distance:j,spikeDistance:k,hovertemplate:m.ht});return m.htx?y.text=m.htx:m.tx?y.text=m.tx:d.text&&(y.text=d.text),f.fillText(m,d,y),e.getComponentMethod("errorbars","hoverInfo")(m,d,y),y}var e=a("../../registry"),f=a("../../lib"),g=a("../scatter/get_trace_color");b.exports={hoverPoints:function(a,b,c,e){var f,g,h,i,j,k,l,m,n,o=a.cd,p=o[0].t,q=o[0].trace,r=a.xa,s=a.ya,t=p.x,u=p.y,v=r.c2p(b),w=s.c2p(c),x=a.distance;if(p.tree){var y=r.p2c(v-x),z=r.p2c(v+x),A=s.p2c(w-x),B=s.p2c(w+x);f="x"===e?p.tree.range(Math.min(y,z),Math.min(s._rl[0],s._rl[1]),Math.max(y,z),Math.max(s._rl[0],s._rl[1])):p.tree.range(Math.min(y,z),Math.min(A,B),Math.max(y,z),Math.max(A,B))}else f=p.ids;var C=x;if("x"===e)for(j=0;j<f.length;j++)h=t[f[j]],(k=Math.abs(r.c2p(h)-v))<C&&(C=k,l=s.c2p(u[f[j]])-w,n=Math.sqrt(k*k+l*l),g=f[j]);else for(j=f.length-1;j>-1;j--)h=t[f[j]],i=u[f[j]],k=r.c2p(h)-v,l=s.c2p(i)-w,(m=Math.sqrt(k*k+l*l))<C&&(C=n=m,g=f[j]);return a.index=g,a.distance=C,a.dxy=n,void 0===g?[a]:[d(a,t,u,q)]},calcHover:d}},{"../../lib":719,"../../registry":848,"../scatter/get_trace_color":1120}],1166:[function(a,b,c){"use strict";var d=a("./hover");b.exports={moduleType:"trace",name:"scattergl",basePlotModule:a("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:a("./attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("../scatter/cross_trace_defaults"),colorbar:a("../scatter/marker_colorbar"),calc:a("./calc"),plot:a("./plot"),hoverPoints:d.hoverPoints,selectPoints:a("./select"),meta:{}}},{"../../plots/cartesian":778,"../scatter/cross_trace_defaults":1117,"../scatter/marker_colorbar":1128,"./attributes":1159,"./calc":1160,"./defaults":1163,"./hover":1165,"./plot":1167,"./select":1169}],1167:[function(a,b,c){"use strict";var d=a("regl-scatter2d"),e=a("regl-line2d"),f=a("regl-error2d"),g=a("gl-text"),h=a("../../lib"),i=a("../../lib/prepare_regl"),j=a("../scatter/subtypes"),k=a("../scatter/link_traces"),l=a("./edit_style").styleTextSelection;b.exports=function(a,b,c){if(c.length){var m,n,o=a._fullLayout,p=b._scene,q=b.xaxis,r=b.yaxis;if(p)if(i(a,["ANGLE_instanced_arrays","OES_element_index_uint"])){var s=p.count,t=o._glcanvas.data()[0].regl;if(k(a,b,c),p.dirty){if(!0===p.error2d&&(p.error2d=f(t)),!0===p.line2d&&(p.line2d=e(t)),!0===p.scatter2d&&(p.scatter2d=d(t)),!0===p.fill2d&&(p.fill2d=e(t)),!0===p.glText)for(p.glText=new Array(s),m=0;m<s;m++)p.glText[m]=new g(t);if(p.glText){if(s>p.glText.length){var u=s-p.glText.length;for(m=0;m<u;m++)p.glText.push(new g(t))}else if(s<p.glText.length){var v=p.glText.length-s;p.glText.splice(s,v).forEach(function(a){a.destroy()})}for(m=0;m<s;m++)p.glText[m].update(p.textOptions[m])}if(p.line2d&&(p.line2d.update(p.lineOptions),p.lineOptions=p.lineOptions.map(function(a){if(a&&a.positions){
for(var b=a.positions,c=0;c<b.length&&(isNaN(b[c])||isNaN(b[c+1]));)c+=2;for(var d=b.length-2;d>c&&(isNaN(b[d])||isNaN(b[d+1]));)d-=2;a.positions=b.slice(c,d+2)}return a}),p.line2d.update(p.lineOptions)),p.error2d){var w=(p.errorXOptions||[]).concat(p.errorYOptions||[]);p.error2d.update(w)}p.scatter2d&&p.scatter2d.update(p.markerOptions),p.fillOrder=h.repeat(null,s),p.fill2d&&(p.fillOptions=p.fillOptions.map(function(a,b){var d=c[b];if(a&&d&&d[0]&&d[0].trace){var e,f,g=d[0],h=g.trace,i=g.t,j=p.lineOptions[b],k=[];h._ownfill&&k.push(b),h._nexttrace&&k.push(b+1),k.length&&(p.fillOrder[b]=k);var l,m,n=[],o=j&&j.positions||i.positions;if("tozeroy"===h.fill){for(l=0;l<o.length&&isNaN(o[l+1]);)l+=2;for(m=o.length-2;m>l&&isNaN(o[m+1]);)m-=2;0!==o[l+1]&&(n=[o[l],0]),n=n.concat(o.slice(l,m+2)),0!==o[m+1]&&(n=n.concat([o[m],0]))}else if("tozerox"===h.fill){for(l=0;l<o.length&&isNaN(o[l]);)l+=2;for(m=o.length-2;m>l&&isNaN(o[m]);)m-=2;0!==o[l]&&(n=[0,o[l+1]]),n=n.concat(o.slice(l,m+2)),0!==o[m]&&(n=n.concat([0,o[m+1]]))}else if("toself"===h.fill||"tonext"===h.fill){for(n=[],e=0,f=0;f<o.length;f+=2)(isNaN(o[f])||isNaN(o[f+1]))&&((n=n.concat(o.slice(e,f))).push(o[e],o[e+1]),e=f+2);n=n.concat(o.slice(e)),e&&n.push(o[e],o[e+1])}else{var q=h._nexttrace;if(q){var r=p.lineOptions[b+1];if(r){var s=r.positions;if("tonexty"===h.fill){for(n=o.slice(),b=Math.floor(s.length/2);b--;){var t=s[2*b],u=s[2*b+1];isNaN(t)||isNaN(u)||n.push(t,u)}a.fill=q.fillcolor}}}}if(h._prevtrace&&"tonext"===h._prevtrace.fill){var v=p.lineOptions[b-1].positions,w=n.length/2,x=[e=w];for(f=0;f<v.length;f+=2)(isNaN(v[f])||isNaN(v[f+1]))&&(x.push(f/2+w+1),e=f+2);n=n.concat(v),a.hole=x}return a.fillmode=h.fill,a.opacity=h.opacity,a.positions=n,a}}),p.fill2d.update(p.fillOptions))}var x=o.dragmode,y="lasso"===x||"select"===x,z=o.clickmode.indexOf("select")>-1;for(m=0;m<s;m++){var A=c[m][0],B=A.trace,C=A.t,D=C.index,E=B._length,F=C.x,G=C.y;if(B.selectedpoints||y||z){if(y||(y=!0),B.selectedpoints){var H=p.selectBatch[D]=h.selIndices2selPoints(B),I={};for(n=0;n<H.length;n++)I[H[n]]=1;var J=[];for(n=0;n<E;n++)I[n]||J.push(n);p.unselectBatch[D]=J}var K=C.xpx=new Array(E),L=C.ypx=new Array(E);for(n=0;n<E;n++)K[n]=q.c2p(F[n]),L[n]=r.c2p(G[n])}else C.xpx=C.ypx=null}if(y){if(p.select2d||(p.select2d=d(o._glcanvas.data()[1].regl)),p.scatter2d){var M=new Array(s);for(m=0;m<s;m++)M[m]=p.selectBatch[m].length||p.unselectBatch[m].length?p.markerUnselectedOptions[m]:{};p.scatter2d.update(M)}p.select2d&&(p.select2d.update(p.markerOptions),p.select2d.update(p.markerSelectedOptions)),p.glText&&c.forEach(function(a){var b=((a||[])[0]||{}).trace||{};j.hasText(b)&&l(a)})}else p.scatter2d&&p.scatter2d.update(p.markerOptions);var N={viewport:function(a,b,c){var d=a._size,e=a.width,f=a.height;return[d.l+b.domain[0]*d.w,d.b+c.domain[0]*d.h,e-d.r-(1-b.domain[1])*d.w,f-d.t-(1-c.domain[1])*d.h]}(o,q,r),range:[(q._rl||q.range)[0],(r._rl||r.range)[0],(q._rl||q.range)[1],(r._rl||r.range)[1]]},O=h.repeat(N,p.count);p.fill2d&&p.fill2d.update(O),p.line2d&&p.line2d.update(O),p.error2d&&p.error2d.update(O.concat(O)),p.scatter2d&&p.scatter2d.update(O),p.select2d&&p.select2d.update(O),p.glText&&p.glText.forEach(function(a){a.update(N)})}else p.init()}}},{"../../lib":719,"../../lib/prepare_regl":732,"../scatter/link_traces":1126,"../scatter/subtypes":1134,"./edit_style":1164,"gl-text":318,"regl-error2d":491,"regl-line2d":492,"regl-scatter2d":498}],1168:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b){var c=b._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},f={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return b._scene||((c=b._scene={}).init=function(){d.extendFlat(c,f,e)},c.init(),c.update=function(a){var b=d.repeat(a,c.count);if(c.fill2d&&c.fill2d.update(b),c.scatter2d&&c.scatter2d.update(b),c.line2d&&c.line2d.update(b),c.error2d&&c.error2d.update(b.concat(b)),c.select2d&&c.select2d.update(b),c.glText)for(var e=0;e<c.count;e++)c.glText[e].update(a)},c.draw=function(){for(var a=c.count,b=c.fill2d,e=c.error2d,f=c.line2d,g=c.scatter2d,h=c.glText,i=c.select2d,j=c.selectBatch,k=c.unselectBatch,l=0;l<a;l++){if(b&&c.fillOrder[l]&&b.draw(c.fillOrder[l]),f&&c.lineOptions[l]&&f.draw(l),e&&(c.errorXOptions[l]&&e.draw(l),c.errorYOptions[l]&&e.draw(l+a)),g&&c.markerOptions[l])if(k[l].length){var m=d.repeat([],c.count);m[l]=k[l],g.draw(m)}else j[l].length||g.draw(l);h[l]&&c.textOptions[l]&&h[l].render()}i&&i.draw(j),c.dirty=!1},c.destroy=function(){c.fill2d&&c.fill2d.destroy&&c.fill2d.destroy(),c.scatter2d&&c.scatter2d.destroy&&c.scatter2d.destroy(),c.error2d&&c.error2d.destroy&&c.error2d.destroy(),c.line2d&&c.line2d.destroy&&c.line2d.destroy(),c.select2d&&c.select2d.destroy&&c.select2d.destroy(),c.glText&&c.glText.forEach(function(a){a.destroy&&a.destroy()}),c.lineOptions=null,c.fillOptions=null,c.markerOptions=null,c.markerSelectedOptions=null,c.markerUnselectedOptions=null,c.errorXOptions=null,c.errorYOptions=null,c.textOptions=null,c.textSelectedOptions=null,c.textUnselectedOptions=null,c.selectBatch=null,c.unselectBatch=null,b._scene=null}),c.dirty||d.extendFlat(c,e),c}},{"../../lib":719}],1169:[function(a,b,c){"use strict";var d=a("../scatter/subtypes"),e=a("./edit_style").styleTextSelection;b.exports=function(a,b){var c=a.cd,f=[],g=c[0].trace,h=c[0].t,i=g._length,j=h.x,k=h.y,l=h._scene,m=h.index;if(!l)return f;var n=d.hasText(g),o=d.hasMarkers(g),p=!o&&!n;if(!0!==g.visible||p)return f;var q=[],r=[];if(!1!==b&&!b.degenerate)for(var s=0;s<i;s++)b.contains([h.xpx[s],h.ypx[s]],!1,s,a)?(q.push(s),f.push({pointNumber:s,x:j[s],y:k[s]})):r.push(s);if(o){var t=l.scatter2d;if(q.length||r.length){if(!l.selectBatch[m].length&&!l.unselectBatch[m].length){var u=new Array(l.count);u[m]=l.markerUnselectedOptions[m],t.update.apply(t,u)}}else{var v=new Array(l.count);v[m]=l.markerOptions[m],t.update.apply(t,v)}}return l.selectBatch[m]=q,l.unselectBatch[m]=r,n&&e(c),f}},{"../scatter/subtypes":1134,"./edit_style":1164}],1170:[function(a,b,c){"use strict";var d=a("../../plots/template_attributes").hovertemplateAttrs,e=a("../../plots/template_attributes").texttemplateAttrs,f=a("../scattergeo/attributes"),g=a("../scatter/attributes"),h=a("../../plots/mapbox/layout_attributes"),i=a("../../plots/attributes"),j=a("../../components/colorscale/attributes"),k=a("../../lib/extend").extendFlat,l=a("../../plot_api/edit_types").overrideAll,m=f.line,n=f.marker;b.exports=l({lon:f.lon,lat:f.lat,mode:k({},g.mode,{dflt:"markers"}),text:k({},g.text,{}),texttemplate:e({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:k({},g.hovertext,{}),line:{color:m.color,width:m.width},connectgaps:g.connectgaps,marker:k({symbol:{valType:"string",dflt:"circle",arrayOk:!0},opacity:n.opacity,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode},j("marker")),fill:f.fill,fillcolor:g.fillcolor,textfont:h.layers.symbol.textfont,textposition:h.layers.symbol.textposition,below:{valType:"string"},selected:{marker:g.selected.marker},unselected:{marker:g.unselected.marker},hoverinfo:k({},i.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:d()},"calc","nested")},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../../plots/mapbox/layout_attributes":824,"../../plots/template_attributes":843,"../scatter/attributes":1111,"../scattergeo/attributes":1150}],1171:[function(a,b,c){"use strict";function d(){return{geojson:k.makeBlank(),layout:{visibility:"none"},paint:{}}}function e(a){return i.isArrayOrTypedArray(a)?function(a){return a}:a?function(){return a}:f}function f(){return""}function g(a){return a[0]===j}var h=a("fast-isnumeric"),i=a("../../lib"),j=a("../../constants/numerical").BADNUM,k=a("../../lib/geojson_utils"),l=a("../../components/colorscale"),m=a("../../components/drawing"),n=a("../scatter/make_bubble_size_func"),o=a("../scatter/subtypes"),p=a("../../plots/mapbox/convert_text_opts"),q=a("../../lib/svg_text_utils").NEWLINES,r=a("../../lib/svg_text_utils").BR_TAG_ALL;b.exports=function(a,b){var c,j=b[0].trace,s=!0===j.visible&&0!==j._length,t="none"!==j.fill,u=o.hasLines(j),v=o.hasMarkers(j),w=o.hasText(j),x=v&&"circle"===j.marker.symbol,y=v&&"circle"!==j.marker.symbol,z=d(),A=d(),B=d(),C=d(),D={fill:z,line:A,circle:B,symbol:C};if(!s)return D;if((t||u)&&(c=k.calcTraceToLineCoords(b)),t&&(z.geojson=k.makePolygon(c),z.layout.visibility="visible",i.extendFlat(z.paint,{"fill-color":j.fillcolor})),u&&(A.geojson=k.makeLine(c),A.layout.visibility="visible",i.extendFlat(A.paint,{"line-width":j.line.width,"line-color":j.line.color,"line-opacity":j.opacity})),x){var E=function(a){function b(a){return j.opacity*a}var c,d,e,f,j=a[0].trace,k=j.marker,o=j.selectedpoints,p=i.isArrayOrTypedArray(k.color),q=i.isArrayOrTypedArray(k.size),r=i.isArrayOrTypedArray(k.opacity);p&&(d=l.hasColorscale(j,"marker")?l.makeColorScaleFuncFromTrace(k):i.identity),q&&(e=n(j)),r&&(f=function(a){return b(h(a)?+i.constrain(a,0,1):0)});var s,t=[];for(c=0;c<a.length;c++){var u=a[c],v=u.lonlat;if(!g(v)){var w={};d&&(w.mcc=u.mcc=d(u.mc)),e&&(w.mrc=u.mrc=e(u.ms)),f&&(w.mo=f(u.mo)),o&&(w.selected=u.selected||0),t.push({type:"Feature",geometry:{type:"Point",coordinates:v},properties:w})}}if(o)for(s=m.makeSelectedPointStyleFns(j),c=0;c<t.length;c++){var x=t[c].properties;s.selectedOpacityFn&&(x.mo=b(s.selectedOpacityFn(x))),s.selectedColorFn&&(x.mcc=s.selectedColorFn(x)),s.selectedSizeFn&&(x.mrc=s.selectedSizeFn(x))}return{geojson:{type:"FeatureCollection",features:t},mcc:p||s&&s.selectedColorFn?{type:"identity",property:"mcc"}:k.color,mrc:q||s&&s.selectedSizeFn?{type:"identity",property:"mrc"}:k.size/2,mo:r||s&&s.selectedOpacityFn?{type:"identity",property:"mo"}:b(k.opacity)}}(b);B.geojson=E.geojson,B.layout.visibility="visible",i.extendFlat(B.paint,{"circle-color":E.mcc,"circle-radius":E.mrc,"circle-opacity":E.mo})}if((y||w)&&(C.geojson=function(a,b){for(var c=a[0].trace,d=(c.marker||{}).symbol,h="circle"!==d?e(d):f,j=o.hasText(c)?e(c.text):f,k=[],l=0;l<a.length;l++){var m=a[l];if(!g(m.lonlat)){var n=c.texttemplate;if(n){var p=Array.isArray(n)?n[l]||"":n;m.text=m.tx,m.lon=m.lonlat[0],m.lat=m.lonlat[1],m.customdata=m.data,m.txt=i.texttemplateString(p,{},b._fullLayout._d3locale,m,c._meta||{})}var s=n?m.txt:j(m.tx);s&&(s=s.replace(q,"").replace(r,"\n")),k.push({type:"Feature",geometry:{type:"Point",coordinates:m.lonlat},properties:{symbol:h(m.mx),text:s}})}}return{type:"FeatureCollection",features:k}}(b,a),i.extendFlat(C.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),y&&(i.extendFlat(C.layout,{"icon-size":j.marker.size/10}),i.extendFlat(C.paint,{"icon-opacity":j.opacity*j.marker.opacity,"icon-color":j.marker.color})),w)){var F=(j.marker||{}).size,G=p(j.textposition,F);i.extendFlat(C.layout,{"text-size":j.textfont.size,"text-anchor":G.anchor,"text-offset":G.offset}),i.extendFlat(C.paint,{"text-color":j.textfont.color,"text-opacity":j.opacity})}return D}},{"../../components/colorscale":606,"../../components/drawing":615,"../../constants/numerical":695,"../../lib":719,"../../lib/geojson_utils":714,"../../lib/svg_text_utils":743,"../../plots/mapbox/convert_text_opts":821,"../scatter/make_bubble_size_func":1127,"../scatter/subtypes":1134,"fast-isnumeric":226}],1172:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/subtypes"),f=a("../scatter/marker_defaults"),g=a("../scatter/line_defaults"),h=a("../scatter/text_defaults"),i=a("../scatter/fillcolor_defaults"),j=a("./attributes");b.exports=function(a,b,c,k){function l(c,e){return d.coerce(a,b,j,c,e)}if(function(a,b,c){var d=c("lon")||[],e=c("lat")||[],f=Math.min(d.length,e.length);return b._length=f,f}(0,b,l)){if(l("text"),l("texttemplate"),l("hovertext"),l("hovertemplate"),l("mode"),l("below"),e.hasLines(b)&&(g(a,b,c,k,l,{noDash:!0}),l("connectgaps")),e.hasMarkers(b)){f(a,b,c,k,l,{noLine:!0});var m=b.marker;"circle"!==m.symbol&&(d.isArrayOrTypedArray(m.size)&&(m.size=m.size[0]),d.isArrayOrTypedArray(m.color)&&(m.color=m.color[0]))}e.hasText(b)&&h(a,b,k,l,{noSelect:!0}),l("fill"),"none"!==b.fill&&i(a,b,c,l),d.coerceSelectionMarkerOpacity(b,l)}else b.visible=!1}},{"../../lib":719,"../scatter/fillcolor_defaults":1119,"../scatter/line_defaults":1123,"../scatter/marker_defaults":1129,"../scatter/subtypes":1134,"../scatter/text_defaults":1135,"./attributes":1170}],1173:[function(a,b,c){"use strict";b.exports=function(a,b){return a.lon=b.lon,a.lat=b.lat,a}},{}],1174:[function(a,b,c){"use strict";var d=a("../../components/fx"),e=a("../../lib"),f=a("../scatter/get_trace_color"),g=e.fillText,h=a("../../constants/numerical").BADNUM;b.exports=function(a,b,c){var i=a.cd,j=i[0].trace,k=a.xa,l=a.ya,m=a.subplot,n=360*(b>=0?Math.floor((b+180)/360):Math.ceil((b-180)/360)),o=b-n;if(d.getClosest(i,function(a){var b=a.lonlat;if(b[0]===h)return 1/0;var d=e.modHalf(b[0],360),f=b[1],g=m.project([d,f]),i=g.x-k.c2p([o,f]),j=g.y-l.c2p([d,c]),n=Math.max(3,a.mrc||0);return Math.max(Math.sqrt(i*i+j*j)-n,1-3/n)},a),!1!==a.index){var p=i[a.index],q=p.lonlat,r=[e.modHalf(q[0],360)+n,q[1]],s=k.c2p(r),t=l.c2p(r),u=p.mrc||1;return a.x0=s-u,a.x1=s+u,a.y0=t-u,a.y1=t+u,a.color=f(j,p),a.extraText=function(a,b,c){function d(a){return a+""}if(!a.hovertemplate){var e=(b.hi||a.hoverinfo).split("+"),f=-1!==e.indexOf("all"),h=-1!==e.indexOf("lon"),i=-1!==e.indexOf("lat"),j=b.lonlat,k=[];return f||h&&i?k.push("("+d(j[0])+", "+d(j[1])+")"):h?k.push(c.lon+d(j[0])):i&&k.push(c.lat+d(j[1])),(f||-1!==e.indexOf("text"))&&g(b,a,k),k.join("<br>")}}(j,p,i[0].t.labels),a.hovertemplate=j.hovertemplate,[a]}}},{"../../components/fx":632,"../../constants/numerical":695,"../../lib":719,"../scatter/get_trace_color":1120}],1175:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),calc:a("../scattergeo/calc"),plot:a("./plot"),hoverPoints:a("./hover"),eventData:a("./event_data"),selectPoints:a("./select"),styleOnSelect:function(a,b){b&&b[0].trace._glTrace.update(b)},moduleType:"trace",name:"scattermapbox",basePlotModule:a("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":822,"../scatter/marker_colorbar":1128,"../scattergeo/calc":1151,"./attributes":1170,"./defaults":1172,"./event_data":1173,"./hover":1174,"./plot":1176,"./select":1177}],1176:[function(a,b,c){"use strict";function d(a,b){this.subplot=a,this.uid=b,this.sourceIds={fill:"source-"+b+"-fill",line:"source-"+b+"-line",circle:"source-"+b+"-circle",symbol:"source-"+b+"-symbol"},this.layerIds={fill:f+b+"-fill",line:f+b+"-line",circle:f+b+"-circle",symbol:f+b+"-symbol"},this.below=null}var e=a("./convert"),f=a("../../plots/mapbox/constants").traceLayerPrefix,g=["fill","line","circle","symbol"],h=d.prototype;h.addSource=function(a,b){this.subplot.map.addSource(this.sourceIds[a],{type:"geojson",data:b.geojson})},h.setSourceData=function(a,b){this.subplot.map.getSource(this.sourceIds[a]).setData(b.geojson)},h.addLayer=function(a,b,c){this.subplot.addLayer({type:a,id:this.layerIds[a],source:this.sourceIds[a],layout:b.layout,paint:b.paint},c)},h.update=function(a){var b,c,d,f=this.subplot,h=f.map,i=e(f.gd,a),j=f.belowLookup["trace-"+this.uid];if(j!==this.below){for(b=g.length-1;b>=0;b--)c=g[b],h.removeLayer(this.layerIds[c]);for(b=0;b<g.length;b++)d=i[c=g[b]],this.addLayer(c,d,j);this.below=j}for(b=0;b<g.length;b++)d=i[c=g[b]],f.setOptions(this.layerIds[c],"setLayoutProperty",d.layout),"visible"===d.layout.visibility&&(this.setSourceData(c,d),f.setOptions(this.layerIds[c],"setPaintProperty",d.paint));a[0].trace._glTrace=this},h.dispose=function(){for(var a=this.subplot.map,b=g.length-1;b>=0;b--){var c=g[b];a.removeLayer(this.layerIds[c]),a.removeSource(this.sourceIds[c])}},b.exports=function(a,b){for(var c=b[0].trace,f=new d(a,c.uid),h=e(a.gd,b),i=f.below=a.belowLookup["trace-"+c.uid],j=0;j<g.length;j++){var k=g[j],l=h[k];f.addSource(k,l),f.addLayer(k,l,i)}return b[0].trace._glTrace=f,f}},{"../../plots/mapbox/constants":820,"./convert":1171}],1177:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/subtypes"),f=a("../../constants/numerical").BADNUM;b.exports=function(a,b){var c,g=a.cd,h=a.xaxis,i=a.yaxis,j=[],k=g[0].trace;if(!e.hasMarkers(k))return[];if(!1===b)for(c=0;c<g.length;c++)g[c].selected=0;else for(c=0;c<g.length;c++){var l=g[c],m=l.lonlat;if(m[0]!==f){var n=[d.modHalf(m[0],360),m[1]],o=[h.c2p(n),i.c2p(n)];b.contains(o,null,c,a)?(j.push({pointNumber:c,lon:m[0],lat:m[1]}),l.selected=1):l.selected=0}}return j}},{"../../constants/numerical":695,"../../lib":719,"../scatter/subtypes":1134}],1178:[function(a,b,c){"use strict";var d=a("../../plots/template_attributes").hovertemplateAttrs,e=a("../../plots/template_attributes").texttemplateAttrs,f=a("../../lib/extend").extendFlat,g=a("../scatter/attributes"),h=a("../../plots/attributes"),i=g.line;b.exports={mode:g.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:g.text,texttemplate:e({editType:"plot"},{keys:["r","theta","text"]}),hovertext:g.hovertext,line:{color:i.color,width:i.width,dash:i.dash,shape:f({},i.shape,{values:["linear","spline"]}),smoothing:i.smoothing,editType:"calc"},connectgaps:g.connectgaps,marker:g.marker,cliponaxis:f({},g.cliponaxis,{dflt:!1}),textposition:g.textposition,textfont:g.textfont,fill:f({},g.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:g.fillcolor,hoverinfo:f({},h.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:g.hoveron,hovertemplate:d(),selected:g.selected,unselected:g.unselected}},{"../../lib/extend":710,"../../plots/attributes":764,"../../plots/template_attributes":843,"../scatter/attributes":1111}],1179:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../constants/numerical").BADNUM,f=a("../../plots/cartesian/axes"),g=a("../scatter/colorscale_calc"),h=a("../scatter/arrays_to_calcdata"),i=a("../scatter/calc_selection"),j=a("../scatter/calc").calcMarkerSize;b.exports=function(a,b){for(var c=a._fullLayout,k=b.subplot,l=c[k].radialaxis,m=c[k].angularaxis,n=l.makeCalcdata(b,"r"),o=m.makeCalcdata(b,"theta"),p=b._length,q=new Array(p),r=0;r<p;r++){var s=n[r],t=o[r],u=q[r]={};d(s)&&d(t)?(u.r=s,u.theta=t):u.r=e}var v=j(b,p);return b._extremes.x=f.findExtremes(l,n,{ppad:v}),g(a,b),h(q,b),i(q,b),q}},{"../../constants/numerical":695,"../../plots/cartesian/axes":767,"../scatter/arrays_to_calcdata":1110,"../scatter/calc":1112,"../scatter/calc_selection":1113,"../scatter/colorscale_calc":1114,"fast-isnumeric":226}],1180:[function(a,b,c){"use strict";function d(a,b,c,d){var e,f=d("r"),g=d("theta");if(f)g?e=Math.min(f.length,g.length):(e=f.length,d("theta0"),d("dtheta"));else{if(!g)return 0;e=b.theta.length,d("r0"),d("dr")}return b._length=e,e}var e=a("../../lib"),f=a("../scatter/subtypes"),g=a("../scatter/marker_defaults"),h=a("../scatter/line_defaults"),i=a("../scatter/line_shape_defaults"),j=a("../scatter/text_defaults"),k=a("../scatter/fillcolor_defaults"),l=a("../scatter/constants").PTS_LINESONLY,m=a("./attributes");b.exports={handleRThetaDefaults:d,supplyDefaults:function(a,b,c,n){function o(c,d){return e.coerce(a,b,m,c,d)}var p=d(0,b,0,o);if(p){o("thetaunit"),o("mode",p<l?"lines+markers":"lines"),o("text"),o("hovertext"),"fills"!==b.hoveron&&o("hovertemplate"),f.hasLines(b)&&(h(a,b,c,n,o),i(a,b,o),o("connectgaps")),f.hasMarkers(b)&&g(a,b,c,n,o,{gradient:!0}),f.hasText(b)&&(o("texttemplate"),j(a,b,n,o));var q=[];(f.hasMarkers(b)||f.hasText(b))&&(o("cliponaxis"),o("marker.maxdisplayed"),q.push("points")),o("fill"),"none"!==b.fill&&(k(a,b,c,o),f.hasLines(b)||i(a,b,o)),"tonext"!==b.fill&&"toself"!==b.fill||q.push("fills"),o("hoveron",q.join("+")||"points"),e.coerceSelectionMarkerOpacity(b,o)}else b.visible=!1}}},{"../../lib":719,"../scatter/constants":1115,"../scatter/fillcolor_defaults":1119,"../scatter/line_defaults":1123,"../scatter/line_shape_defaults":1125,"../scatter/marker_defaults":1129,"../scatter/subtypes":1134,"../scatter/text_defaults":1135,"./attributes":1178}],1181:[function(a,b,c){"use strict";function d(a,b,c,d){function e(a,b){m.push(a._hovertitle+": "+b)}var h=c.radialAxis,i=c.angularAxis;h._hovertitle="r",i._hovertitle="";var j=h.c2l(a.r);d.rLabel=f.tickText(h,j,"hover").text;var k="degrees"===i.thetaunit?g.rad2deg(a.theta):a.theta;d.thetaLabel=f.tickText(i,k,"hover").text;var l=a.hi||b.hoverinfo,m=[];if(!b.hovertemplate){var n=l.split("+");-1!==n.indexOf("all")&&(n=["r","theta","text"]),-1!==n.indexOf("r")&&e(h,d.rLabel),-1!==n.indexOf("theta")&&e(i,d.thetaLabel),-1!==n.indexOf("text")&&d.text&&(m.push(d.text),delete d.text),d.extraText=m.join("<br>")}}var e=a("../scatter/hover"),f=a("../../plots/cartesian/axes"),g=a("../../lib");b.exports={hoverPoints:function(a,b,c,f){var g=e(a,b,c,f);if(g&&!1!==g[0].index){var h=g[0];if(void 0===h.index)return g;var i=a.subplot,j=h.cd[h.index],k=h.trace;if(i.isPtInside(j))return h.xLabelVal=void 0,h.yLabelVal=void 0,d(j,k,i,h),h.hovertemplate=k.hovertemplate,g}},makeHoverPointText:d}},{"../../lib":719,"../../plots/cartesian/axes":767,"../scatter/hover":1121}],1182:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:a("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:a("./attributes"),supplyDefaults:a("./defaults").supplyDefaults,colorbar:a("../scatter/marker_colorbar"),calc:a("./calc"),plot:a("./plot"),style:a("../scatter/style").style,styleOnSelect:a("../scatter/style").styleOnSelect,hoverPoints:a("./hover").hoverPoints,selectPoints:a("../scatter/select"),meta:{}}},{"../../plots/polar":831,"../scatter/marker_colorbar":1128,"../scatter/select":1131,"../scatter/style":1133,"./attributes":1178,"./calc":1179,"./defaults":1180,"./hover":1181,"./plot":1183}],1183:[function(a,b,c){"use strict";var d=a("../scatter/plot"),e=a("../../constants/numerical").BADNUM;b.exports=function(a,b,c){for(var f=b.layers.frontplot.select("g.scatterlayer"),g={xaxis:b.xaxis,yaxis:b.yaxis,plot:b.framework,layerClipId:b._hasClipOnAxisFalse?b.clipIds.forTraces:null},h=b.radialAxis,i=b.angularAxis,j=0;j<c.length;j++)for(var k=c[j],l=0;l<k.length;l++){var m=k[l],n=m.r;if(n===e)m.x=m.y=e;else{var o=h.c2g(n),p=i.c2g(m.theta);m.x=o*Math.cos(p),m.y=o*Math.sin(p)}}d(a,g,c,f)}},{"../../constants/numerical":695,"../scatter/plot":1130}],1184:[function(a,b,c){"use strict";var d=a("../scatterpolar/attributes"),e=a("../scattergl/attributes"),f=a("../../plots/template_attributes").texttemplateAttrs;b.exports={mode:d.mode,r:d.r,theta:d.theta,r0:d.r0,dr:d.dr,theta0:d.theta0,dtheta:d.dtheta,thetaunit:d.thetaunit,text:d.text,texttemplate:f({editType:"plot"},{keys:["r","theta","text"]}),hovertext:d.hovertext,hovertemplate:d.hovertemplate,line:e.line,connectgaps:e.connectgaps,marker:e.marker,fill:e.fill,fillcolor:e.fillcolor,textposition:e.textposition,textfont:e.textfont,hoverinfo:d.hoverinfo,selected:d.selected,unselected:d.unselected}},{"../../plots/template_attributes":843,"../scattergl/attributes":1159,"../scatterpolar/attributes":1178}],1185:[function(a,b,c){"use strict";var d=a("../scatter/colorscale_calc"),e=a("../scatter/calc").calcMarkerSize,f=a("../scattergl/convert"),g=a("../../plots/cartesian/axes"),h=a("../scattergl/constants").TOO_MANY_POINTS;b.exports=function(a,b){var c=a._fullLayout,i=b.subplot,j=c[i].radialaxis,k=c[i].angularaxis,l=j.makeCalcdata(b,"r"),m=k.makeCalcdata(b,"theta"),n=b._length,o={};n<l.length&&(l=l.slice(0,n)),n<m.length&&(m=m.slice(0,n)),o.r=l,o.theta=m,d(a,b);var p,q=o.opts=f.style(a,b);return n<h?p=e(b,n):q.marker&&(p=2*(q.marker.sizeAvg||Math.max(q.marker.size,3))),b._extremes.x=g.findExtremes(j,l,{ppad:p}),[{x:!1,y:!1,t:o,trace:b}]}},{"../../plots/cartesian/axes":767,"../scatter/calc":1112,"../scatter/colorscale_calc":1114,"../scattergl/constants":1161,"../scattergl/convert":1162}],1186:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/subtypes"),f=a("../scatterpolar/defaults").handleRThetaDefaults,g=a("../scatter/marker_defaults"),h=a("../scatter/line_defaults"),i=a("../scatter/text_defaults"),j=a("../scatter/fillcolor_defaults"),k=a("../scatter/constants").PTS_LINESONLY,l=a("./attributes");b.exports=function(a,b,c,m){function n(c,e){return d.coerce(a,b,l,c,e)}var o=f(a,b,m,n);o?(n("thetaunit"),n("mode",o<k?"lines+markers":"lines"),n("text"),n("hovertext"),"fills"!==b.hoveron&&n("hovertemplate"),e.hasLines(b)&&(h(a,b,c,m,n),n("connectgaps")),e.hasMarkers(b)&&g(a,b,c,m,n),e.hasText(b)&&(n("texttemplate"),i(a,b,m,n)),n("fill"),"none"!==b.fill&&j(a,b,c,n),d.coerceSelectionMarkerOpacity(b,n)):b.visible=!1}},{"../../lib":719,"../scatter/constants":1115,"../scatter/fillcolor_defaults":1119,"../scatter/line_defaults":1123,"../scatter/marker_defaults":1129,"../scatter/subtypes":1134,"../scatter/text_defaults":1135,"../scatterpolar/defaults":1180,"./attributes":1184}],1187:[function(a,b,c){"use strict";var d=a("../scattergl/hover"),e=a("../scatterpolar/hover").makeHoverPointText;b.exports={hoverPoints:function(a,b,c,f){var g=a.cd[0].t,h=g.r,i=g.theta,j=d.hoverPoints(a,b,c,f);if(j&&!1!==j[0].index){var k=j[0];if(void 0===k.index)return j;var l=a.subplot,m=k.cd[k.index],n=k.trace;if(m.r=h[k.index],m.theta=i[k.index],l.isPtInside(m))return k.xLabelVal=void 0,k.yLabelVal=void 0,e(m,n,l,k),j}}}},{"../scattergl/hover":1165,"../scatterpolar/hover":1181}],1188:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:a("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),calc:a("./calc"),plot:a("./plot"),hoverPoints:a("./hover").hoverPoints,selectPoints:a("../scattergl/select"),meta:{}}},{"../../plots/polar":831,"../scatter/marker_colorbar":1128,"../scattergl/select":1169,"./attributes":1184,"./calc":1185,"./defaults":1186,"./hover":1187,"./plot":1189}],1189:[function(a,b,c){"use strict";var d=a("point-cluster"),e=a("fast-isnumeric"),f=a("../scattergl/plot"),g=a("../scattergl/scene_update"),h=a("../scattergl/convert"),i=a("../../lib"),j=a("../scattergl/constants").TOO_MANY_POINTS;b.exports=function(a,b,c){if(c.length){var k=b.radialAxis,l=b.angularAxis,m=g(a,b);return c.forEach(function(c){if(c&&c[0]&&c[0].trace){var f,g=c[0],n=g.trace,o=g.t,p=n._length,q=o.r,r=o.theta,s=o.opts,t=q.slice(),u=r.slice();for(f=0;f<q.length;f++)b.isPtInside({r:q[f],theta:r[f]})||(t[f]=NaN,u[f]=NaN);var v=new Array(2*p),w=Array(p),x=Array(p);for(f=0;f<p;f++){var y,z,A=t[f];if(e(A)){var B=k.c2g(A),C=l.c2g(u[f],n.thetaunit);y=B*Math.cos(C),z=B*Math.sin(C)}else y=z=NaN;w[f]=v[2*f]=y,x[f]=v[2*f+1]=z}o.tree=d(v),s.marker&&p>=j&&(s.marker.cluster=o.tree),s.marker&&(s.markerSel.positions=s.markerUnsel.positions=s.marker.positions=v),s.line&&v.length>1&&i.extendFlat(s.line,h.linePositions(a,n,v)),s.text&&(i.extendFlat(s.text,{positions:v},h.textPosition(a,n,s.text,s.marker)),i.extendFlat(s.textSel,{positions:v},h.textPosition(a,n,s.text,s.markerSel)),i.extendFlat(s.textUnsel,{positions:v},h.textPosition(a,n,s.text,s.markerUnsel))),s.fill&&!m.fill2d&&(m.fill2d=!0),s.marker&&!m.scatter2d&&(m.scatter2d=!0),s.line&&!m.line2d&&(m.line2d=!0),s.text&&!m.glText&&(m.glText=!0),m.lineOptions.push(s.line),m.fillOptions.push(s.fill),m.markerOptions.push(s.marker),m.markerSelectedOptions.push(s.markerSel),m.markerUnselectedOptions.push(s.markerUnsel),m.textOptions.push(s.text),m.textSelectedOptions.push(s.textSel),m.textUnselectedOptions.push(s.textUnsel),m.selectBatch.push([]),m.unselectBatch.push([]),o.x=w,o.y=x,o.rawx=w,o.rawy=x,o.r=q,o.theta=r,o.positions=v,o._scene=m,o.index=m.count,m.count++}}),f(a,b,c)}}},{"../../lib":719,"../scattergl/constants":1161,"../scattergl/convert":1162,"../scattergl/plot":1167,"../scattergl/scene_update":1168,"fast-isnumeric":226,"point-cluster":470}],1190:[function(a,b,c){"use strict";var d=a("../../plots/template_attributes").hovertemplateAttrs,e=a("../../plots/template_attributes").texttemplateAttrs,f=a("../scatter/attributes"),g=a("../../plots/attributes"),h=a("../../components/colorscale/attributes"),i=a("../../components/drawing/attributes").dash,j=a("../../lib/extend").extendFlat,k=f.marker,l=f.line,m=k.line;b.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:j({},f.mode,{dflt:"markers"}),text:j({},f.text,{}),texttemplate:e({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:j({},f.hovertext,{}),line:{color:l.color,width:l.width,dash:i,shape:j({},l.shape,{values:["linear","spline"]}),smoothing:l.smoothing,editType:"calc"},connectgaps:f.connectgaps,cliponaxis:f.cliponaxis,fill:j({},f.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:f.fillcolor,marker:j({symbol:k.symbol,opacity:k.opacity,maxdisplayed:k.maxdisplayed,size:k.size,sizeref:k.sizeref,sizemin:k.sizemin,sizemode:k.sizemode,line:j({width:m.width,editType:"calc"},h("marker.line")),gradient:k.gradient,editType:"calc"},h("marker")),textfont:f.textfont,textposition:f.textposition,selected:f.selected,unselected:f.unselected,hoverinfo:j({},g.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:f.hoveron,hovertemplate:d()}},{"../../components/colorscale/attributes":601,"../../components/drawing/attributes":614,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/template_attributes":843,"../scatter/attributes":1111}],1191:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../scatter/colorscale_calc"),f=a("../scatter/arrays_to_calcdata"),g=a("../scatter/calc_selection"),h=a("../scatter/calc").calcMarkerSize,i=["a","b","c"],j={a:["b","c"],b:["a","c"],c:["a","b"]};b.exports=function(a,b){var c,k,l,m,n,o,p=a._fullLayout[b.subplot].sum,q=b.sum||p,r={a:b.a,b:b.b,c:b.c};for(c=0;c<i.length;c++)if(!r[l=i[c]]){for(n=r[j[l][0]],o=r[j[l][1]],m=new Array(n.length),k=0;k<n.length;k++)m[k]=q-n[k]-o[k];r[l]=m}var s,t,u,v,w,x,y=b._length,z=new Array(y);for(c=0;c<y;c++)s=r.a[c],t=r.b[c],u=r.c[c],d(s)&&d(t)&&d(u)?(1!=(v=p/((s=+s)+(t=+t)+(u=+u)))&&(s*=v,t*=v,u*=v),x=s,w=u-t,z[c]={x:w,y:x,a:s,b:t,c:u}):z[c]={x:!1,y:!1};return h(b,y),e(a,b),f(z,b),g(z,b),z}},{"../scatter/arrays_to_calcdata":1110,"../scatter/calc":1112,"../scatter/calc_selection":1113,"../scatter/colorscale_calc":1114,"fast-isnumeric":226}],1192:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/constants"),f=a("../scatter/subtypes"),g=a("../scatter/marker_defaults"),h=a("../scatter/line_defaults"),i=a("../scatter/line_shape_defaults"),j=a("../scatter/text_defaults"),k=a("../scatter/fillcolor_defaults"),l=a("./attributes");b.exports=function(a,b,c,m){function n(c,e){return d.coerce(a,b,l,c,e)}var o,p=n("a"),q=n("b"),r=n("c");if(p?(o=p.length,q?(o=Math.min(o,q.length),r&&(o=Math.min(o,r.length))):o=r?Math.min(o,r.length):0):q&&r&&(o=Math.min(q.length,r.length)),o){b._length=o,n("sum"),n("text"),n("hovertext"),"fills"!==b.hoveron&&n("hovertemplate"),n("mode",o<e.PTS_LINESONLY?"lines+markers":"lines"),f.hasLines(b)&&(h(a,b,c,m,n),i(a,b,n),n("connectgaps")),f.hasMarkers(b)&&g(a,b,c,m,n,{gradient:!0}),f.hasText(b)&&(n("texttemplate"),j(a,b,m,n));var s=[];(f.hasMarkers(b)||f.hasText(b))&&(n("cliponaxis"),n("marker.maxdisplayed"),s.push("points")),n("fill"),"none"!==b.fill&&(k(a,b,c,n),f.hasLines(b)||i(a,b,n)),"tonext"!==b.fill&&"toself"!==b.fill||s.push("fills"),
n("hoveron",s.join("+")||"points"),d.coerceSelectionMarkerOpacity(b,n)}else b.visible=!1}},{"../../lib":719,"../scatter/constants":1115,"../scatter/fillcolor_defaults":1119,"../scatter/line_defaults":1123,"../scatter/line_shape_defaults":1125,"../scatter/marker_defaults":1129,"../scatter/subtypes":1134,"../scatter/text_defaults":1135,"./attributes":1190}],1193:[function(a,b,c){"use strict";b.exports=function(a,b,c,d,e){if(b.xa&&(a.xaxis=b.xa),b.ya&&(a.yaxis=b.ya),d[e]){var f=d[e];a.a=f.a,a.b=f.b,a.c=f.c}else a.a=b.a,a.b=b.b,a.c=b.c;return a}},{}],1194:[function(a,b,c){"use strict";var d=a("../scatter/hover"),e=a("../../plots/cartesian/axes");b.exports=function(a,b,c,f){function g(a,b){r.push(a._hovertitle+": "+b)}var h=d(a,b,c,f);if(h&&!1!==h[0].index){var i=h[0];if(void 0===i.index){var j=1-i.y0/a.ya._length,k=a.xa._length,l=k*j/2,m=k-l;return i.x0=Math.max(Math.min(i.x0,m),l),i.x1=Math.max(Math.min(i.x1,m),l),h}var n=i.cd[i.index];i.a=n.a,i.b=n.b,i.c=n.c,i.xLabelVal=void 0,i.yLabelVal=void 0;var o=i.subplot;i.aLabel=e.tickText(o.aaxis,n.a,"hover").text,i.bLabel=e.tickText(o.baxis,n.b,"hover").text,i.cLabel=e.tickText(o.caxis,n.c,"hover").text;var p=i.trace,q=n.hi||p.hoverinfo,r=[];if(!p.hovertemplate){var s=q.split("+");-1!==s.indexOf("all")&&(s=["a","b","c"]),-1!==s.indexOf("a")&&g(o.aaxis,i.aLabel),-1!==s.indexOf("b")&&g(o.baxis,i.bLabel),-1!==s.indexOf("c")&&g(o.caxis,i.cLabel)}return i.extraText=r.join("<br>"),i.hovertemplate=p.hovertemplate,h}}},{"../../plots/cartesian/axes":767,"../scatter/hover":1121}],1195:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),calc:a("./calc"),plot:a("./plot"),style:a("../scatter/style").style,styleOnSelect:a("../scatter/style").styleOnSelect,hoverPoints:a("./hover"),selectPoints:a("../scatter/select"),eventData:a("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:a("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":844,"../scatter/marker_colorbar":1128,"../scatter/select":1131,"../scatter/style":1133,"./attributes":1190,"./calc":1191,"./defaults":1192,"./event_data":1193,"./hover":1194,"./plot":1196}],1196:[function(a,b,c){"use strict";var d=a("../scatter/plot");b.exports=function(a,b,c){var e=b.plotContainer;e.select(".scatterlayer").selectAll("*").remove();var f={xaxis:b.xaxis,yaxis:b.yaxis,plot:e,layerClipId:b._hasClipOnAxisFalse?b.clipIdRelative:null},g=b.layers.frontplot.select("g.scatterlayer");d(a,f,c,g)}},{"../scatter/plot":1130}],1197:[function(a,b,c){"use strict";function d(a){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:i[a],editType:"plot"}}}var e=a("../scatter/attributes"),f=a("../../components/colorscale/attributes"),g=a("../../plots/template_attributes").hovertemplateAttrs,h=a("../scattergl/attributes"),i=a("../../plots/cartesian/constants").idRegex,j=a("../../plot_api/plot_template").templatedArray,k=a("../../lib/extend").extendFlat,l=e.marker,m=l.line,n=k(f("marker.line",{editTypeOverride:"calc"}),{width:k({},m.width,{editType:"calc"}),editType:"calc"}),o=k(f("marker"),{symbol:l.symbol,size:k({},l.size,{editType:"markerSize"}),sizeref:l.sizeref,sizemin:l.sizemin,sizemode:l.sizemode,opacity:l.opacity,colorbar:l.colorbar,line:n,editType:"calc"});o.color.editType=o.cmin.editType=o.cmax.editType="style",b.exports={dimensions:j("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:k({},h.text,{}),hovertext:k({},h.hovertext,{}),hovertemplate:g(),marker:o,xaxes:d("x"),yaxes:d("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:h.selected.marker,editType:"calc"},unselected:{marker:h.unselected.marker,editType:"calc"},opacity:h.opacity}},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plot_api/plot_template":757,"../../plots/cartesian/constants":773,"../../plots/template_attributes":843,"../scatter/attributes":1111,"../scattergl/attributes":1159}],1198:[function(a,b,c){"use strict";function d(a,b,c){for(var d=c.matrixOptions.data.length,e=b._visibleDims,f=c.viewOpts.ranges=new Array(d),g=0;g<e.length;g++){var h=e[g],i=f[g]=new Array(4),j=k(a,b._diag[h][0]);j&&(i[0]=j.r2l(j.range[0]),i[2]=j.r2l(j.range[1]));var l=k(a,b._diag[h][1]);l&&(i[1]=l.r2l(l.range[0]),i[3]=l.r2l(l.range[1]))}c.selectBatch.length||c.unselectBatch.length?c.matrix.update({ranges:f},{ranges:f}):c.matrix.update({ranges:f})}function e(a){var b=a._fullLayout,c=b._glcanvas.data()[0].regl,d=b._splomGrid;d||(d=b._splomGrid=f(c)),d.update(function(a){function b(a,b,c,d,e,h){var i=b[a+"color"],j=b[a+"width"],k=String(i+j);k in g?g[k].data.push(NaN,NaN,c,d,e,h):g[k]={data:[c,d,e,h],join:"rect",thickness:j,color:i,viewport:f,range:f,overlay:!1}}var c,d=a._fullLayout,e=d._size,f=[0,0,d.width,d.height],g={};for(c in d._splomSubplots){var h,i,j=d._plots[c],k=j.xaxis,m=j.yaxis,n=k._gridVals,o=m._gridVals,p=e.b+m.domain[0]*e.h,q=-m._m,r=-q*m.r2l(m.range[0],m.calendar);if(k.showgrid)for(c=0;c<n.length;c++)h=k._offset+k.l2p(n[c].x),b("grid",k,h,p,h,p+m._length);if(m.showgrid)for(c=0;c<o.length;c++)i=p+r+q*o[c].x,b("grid",m,k._offset,i,k._offset+k._length,i);l(a,k,m)&&(h=k._offset+k.l2p(0),b("zeroline",k,h,p,h,p+m._length)),l(a,m,k)&&(i=p+r+0,b("zeroline",m,k._offset,i,k._offset+k._length,i))}var s=[];for(c in g)s.push(g[c]);return s}(a))}var f=a("regl-line2d"),g=a("../../registry"),h=a("../../lib/prepare_regl"),i=a("../../plots/get_data").getModuleCalcData,j=a("../../plots/cartesian"),k=a("../../plots/cartesian/axis_ids").getFromId,l=a("../../plots/cartesian/axes").shouldShowZeroLine,m="splom";b.exports={name:m,attr:j.attr,attrRegex:j.attrRegex,layoutAttributes:j.layoutAttributes,supplyLayoutDefaults:j.supplyLayoutDefaults,drawFramework:j.drawFramework,plot:function(a){var b=a._fullLayout,c=g.getModule(m),d=i(a.calcdata,c)[0];h(a,["ANGLE_instanced_arrays","OES_element_index_uint"])&&(b._hasOnlyLargeSploms&&e(a),c.plot(a,{},d))},drag:function(a){var b=a.calcdata,c=a._fullLayout;c._hasOnlyLargeSploms&&e(a);for(var f=0;f<b.length;f++){var g=b[f][0].trace,h=c._splomScenes[g.uid];"splom"===g.type&&h&&h.matrix&&d(a,g,h)}},updateGrid:e,clean:function(a,b,c,d){var e,f={};if(d._splomScenes){for(e=0;e<a.length;e++){var g=a[e];"splom"===g.type&&(f[g.uid]=1)}for(e=0;e<c.length;e++){var h=c[e];if(!f[h.uid]){var i=d._splomScenes[h.uid];i&&i.destroy&&i.destroy(),d._splomScenes[h.uid]=null,delete d._splomScenes[h.uid]}}}0===Object.keys(d._splomScenes||{}).length&&delete d._splomScenes,d._splomGrid&&!b._hasOnlyLargeSploms&&d._hasOnlyLargeSploms&&(d._splomGrid.destroy(),d._splomGrid=null,delete d._splomGrid),j.clean(a,b,c,d)},updateFx:j.updateFx,toSVG:j.toSVG}},{"../../lib/prepare_regl":732,"../../plots/cartesian":778,"../../plots/cartesian/axes":767,"../../plots/cartesian/axis_ids":770,"../../plots/get_data":802,"../../registry":848,"regl-line2d":492}],1199:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axis_ids"),f=a("../scatter/calc").calcMarkerSize,g=a("../scatter/calc").calcAxisExpansion,h=a("../scatter/colorscale_calc"),i=a("../scattergl/convert").markerSelection,j=a("../scattergl/convert").markerStyle,k=a("./scene_update"),l=a("../../constants/numerical").BADNUM,m=a("../scattergl/constants").TOO_MANY_POINTS;b.exports=function(a,b){function c(a,c){for(var e=a.makeCalcdata({v:c.values,vcalendar:b.calendar},"v"),f=0;f<e.length;f++)e[f]=e[f]===l?NaN:e[f];w.push(e),x.push("log"===a.type?d.simpleMap(e,a.c2l):e)}var n,o,p,q,r,s,t=b.dimensions,u=b._length,v={},w=v.cdata=[],x=v.data=[],y=b._visibleDims=[];for(n=0;n<t.length;n++)if((p=t[n]).visible){if(q=e.getFromId(a,b._diag[n][0]),r=e.getFromId(a,b._diag[n][1]),q&&r&&q.type!==r.type){d.log("Skipping splom dimension "+n+" with conflicting axis types");continue}q?(c(q,p),r&&"category"===r.type&&(r._categories=q._categories.slice())):c(r,p),y.push(n)}for(h(a,b),d.extendFlat(v,j(b)),s=w.length*u>m?2*(v.sizeAvg||Math.max(v.size,3)):f(b,u),o=0;o<y.length;o++)p=t[n=y[o]],q=e.getFromId(a,b._diag[n][0])||{},r=e.getFromId(a,b._diag[n][1])||{},g(a,b,q,r,w[o],w[o],s);var z=k(a,b);return z.matrix||(z.matrix=!0),z.matrixOptions=v,z.selectedOptions=i(b,b.selected),z.unselectedOptions=i(b,b.unselected),[{x:!1,y:!1,t:{},trace:b}]}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axis_ids":770,"../scatter/calc":1112,"../scatter/colorscale_calc":1114,"../scattergl/constants":1161,"../scattergl/convert":1162,"./scene_update":1206}],1200:[function(a,b,c){"use strict";function d(a,b){function c(c,d){return e.coerce(a,b,g.dimensions,c,d)}c("label");var d=c("values");d&&d.length?c("visible"):b.visible=!1,c("axis.type"),c("axis.matches")}var e=a("../../lib"),f=a("../../plots/array_container_defaults"),g=a("./attributes"),h=a("../scatter/subtypes"),i=a("../scatter/marker_defaults"),j=a("../parcoords/merge_length"),k=/-open/;b.exports=function(a,b,c,l){function m(c,d){return e.coerce(a,b,g,c,d)}var n=f(a,b,{name:"dimensions",handleItemDefaults:d}),o=m("diagonal.visible"),p=m("showupperhalf"),q=m("showlowerhalf");if(j(b,n,"values")&&(o||p||q)){m("text"),m("hovertext"),m("hovertemplate"),i(a,b,c,l,m);var r=k.test(b.marker.symbol),s=h.isBubble(b);m("marker.line.width",r||s?1:0),function(a,b,c,d){function e(a,d,e,f){if(a){var g=a.charAt(0),h=c._splomAxes[g];if(b["_"+g+"axes"][a]=1,f.push(a),!(a in h)){var i=h[a]={};e&&(i.label=e.label||"",e.visible&&e.axis&&(e.axis.type&&(i.type=e.axis.type),e.axis.matches&&(i.matches=d)))}}}var f,g,h=b.dimensions,i=h.length,j=b.showupperhalf,k=b.showlowerhalf,l=b.diagonal.visible,m=new Array(i),n=new Array(i);for(f=0;f<i;f++){var o=f?f+1:"";m[f]="x"+o,n[f]="y"+o}var p=d("xaxes",m),q=d("yaxes",n),r=b._diag=new Array(i);b._xaxes={},b._yaxes={};var s=[],t=[],u=!l&&!k,v=!l&&!j;for(b._axesDim={},f=0;f<i;f++){var w=h[f],x=0===f,y=f===i-1,z=x&&u||y&&v?void 0:p[f],A=x&&v||y&&u?void 0:q[f];e(z,A,w,s),e(A,z,w,t),r[f]=[z,A],b._axesDim[z]=f,b._axesDim[A]=f}for(f=0;f<s.length;f++)for(g=0;g<t.length;g++){var B=s[f]+t[g];f>g&&j?c._splomSubplots[B]=1:f<g&&k?c._splomSubplots[B]=1:f!==g||!l&&k&&j||(c._splomSubplots[B]=1)}(!k||!l&&j&&k)&&(c._splomGridDflt.xside="bottom",c._splomGridDflt.yside="left")}(0,b,l,m),e.coerceSelectionMarkerOpacity(b,m)}else b.visible=!1}},{"../../lib":719,"../../plots/array_container_defaults":763,"../parcoords/merge_length":1082,"../scatter/marker_defaults":1129,"../scatter/subtypes":1134,"./attributes":1197}],1201:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/colorscale_calc"),f=a("../scattergl/convert").markerStyle;b.exports=function(a,b){var c=b.trace,g=a._fullLayout._splomScenes[c.uid];if(g){e(a,c),d.extendFlat(g.matrixOptions,f(c));var h=d.extendFlat({},g.matrixOptions,g.viewOpts);g.matrix.update(h,null)}}},{"../../lib":719,"../scatter/colorscale_calc":1114,"../scattergl/convert":1162}],1202:[function(a,b,c){"use strict";c.getDimIndex=function(a,b){for(var c=b._id,d={x:0,y:1}[c.charAt(0)],e=a._visibleDims,f=0;f<e.length;f++){var g=e[f];if(a._diag[g][d]===c)return f}return!1}},{}],1203:[function(a,b,c){"use strict";var d=a("./helpers"),e=a("../scattergl/hover").calcHover;b.exports={hoverPoints:function(a,b,c){var f=a.cd[0].trace,g=a.scene.matrixOptions.cdata,h=a.xa,i=a.ya,j=h.c2p(b),k=i.c2p(c),l=a.distance,m=d.getDimIndex(f,h),n=d.getDimIndex(f,i);if(!1===m||!1===n)return[a];for(var o,p,q=g[m],r=g[n],s=l,t=0;t<q.length;t++){var u=q[t],v=r[t],w=h.c2p(u)-j,x=i.c2p(v)-k,y=Math.sqrt(w*w+x*x);y<s&&(s=p=y,o=t)}return a.index=o,a.distance=s,a.dxy=p,void 0===o?[a]:[e(a,q,r,f)]}}},{"../scattergl/hover":1165,"./helpers":1202}],1204:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../components/grid");b.exports={moduleType:"trace",name:"splom",basePlotModule:a("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),calc:a("./calc"),plot:a("./plot"),hoverPoints:a("./hover").hoverPoints,selectPoints:a("./select"),editStyle:a("./edit_style"),meta:{}},d.register(e)},{"../../components/grid":636,"../../registry":848,"../scatter/marker_colorbar":1128,"./attributes":1197,"./base_plot":1198,"./calc":1199,"./defaults":1200,"./edit_style":1201,"./hover":1203,"./plot":1205,"./select":1207}],1205:[function(a,b,c){"use strict";function d(a,b){var c,d,h,i,j,k=a._fullLayout,l=k._size,m=b.trace,n=b.t,o=k._splomScenes[m.uid],p=o.matrixOptions,q=p.cdata,r=k._glcanvas.data()[0].regl,s=k.dragmode;if(0!==q.length){p.lower=m.showupperhalf,p.upper=m.showlowerhalf,p.diagonal=m.diagonal.visible;var t=m._visibleDims,u=q.length,v=o.viewOpts={};for(v.ranges=new Array(u),v.domains=new Array(u),j=0;j<t.length;j++){h=t[j];var w=v.ranges[j]=new Array(4),x=v.domains[j]=new Array(4);(c=g.getFromId(a,m._diag[h][0]))&&(w[0]=c._rl[0],w[2]=c._rl[1],x[0]=c.domain[0],x[2]=c.domain[1]),(d=g.getFromId(a,m._diag[h][1]))&&(w[1]=d._rl[0],w[3]=d._rl[1],x[1]=d.domain[0],x[3]=d.domain[1])}v.viewport=[l.l,l.b,l.w+l.l,l.h+l.b],!0===o.matrix&&(o.matrix=e(r));var y=k.clickmode.indexOf("select")>-1,z=!0;if("lasso"===s||"select"===s||m.selectedpoints||y){var A=m._length;if(m.selectedpoints){o.selectBatch=m.selectedpoints;var B=m.selectedpoints,C={};for(h=0;h<B.length;h++)C[B[h]]=!0;var D=[];for(h=0;h<A;h++)C[h]||D.push(h);o.unselectBatch=D}var E=n.xpx=new Array(u),F=n.ypx=new Array(u);for(j=0;j<t.length;j++){if(h=t[j],c=g.getFromId(a,m._diag[h][0]))for(E[j]=new Array(A),i=0;i<A;i++)E[j][i]=c.c2p(q[j][i]);if(d=g.getFromId(a,m._diag[h][1]))for(F[j]=new Array(A),i=0;i<A;i++)F[j][i]=d.c2p(q[j][i])}if(o.selectBatch.length||o.unselectBatch.length){var G=f.extendFlat({},p,o.unselectedOptions,v),H=f.extendFlat({},p,o.selectedOptions,v);o.matrix.update(G,H),z=!1}}else n.xpx=n.ypx=null;if(z){var I=f.extendFlat({},p,v);o.matrix.update(I,null)}}}var e=a("regl-splom"),f=a("../../lib"),g=a("../../plots/cartesian/axis_ids");b.exports=function(a,b,c){if(c.length)for(var e=0;e<c.length;e++)d(a,c[e][0])}},{"../../lib":719,"../../plots/cartesian/axis_ids":770,"regl-splom":502}],1206:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b){var c=a._fullLayout,e=b.uid,f=c._splomScenes;f||(f=c._splomScenes={});var g={dirty:!0},h=f[b.uid];return h||((h=f[e]=d.extendFlat({},g,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){h.matrix&&h.matrix.draw&&(h.selectBatch.length||h.unselectBatch.length?h.matrix.draw(h.unselectBatch,h.selectBatch):h.matrix.draw()),h.dirty=!1},h.destroy=function(){h.matrix&&h.matrix.destroy&&h.matrix.destroy(),h.matrixOptions=null,h.selectBatch=null,h.unselectBatch=null,h=null}),h.dirty||d.extendFlat(h,g),h}},{"../../lib":719}],1207:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/subtypes"),f=a("./helpers");b.exports=function(a,b){var c=a.cd,g=c[0].trace,h=c[0].t,i=a.scene,j=i.matrixOptions.cdata,k=a.xaxis,l=a.yaxis,m=[];if(!i)return m;var n=!e.hasMarkers(g)&&!e.hasText(g);if(!0!==g.visible||n)return m;var o=f.getDimIndex(g,k),p=f.getDimIndex(g,l);if(!1===o||!1===p)return m;var q=h.xpx[o],r=h.ypx[p],s=j[o],t=j[p],u=[],v=[];if(!1!==b&&!b.degenerate)for(var w=0;w<s.length;w++)b.contains([q[w],r[w]],null,w,a)?(u.push(w),m.push({pointNumber:w,x:s[w],y:t[w]})):v.push(w);var x=i.matrixOptions;return u.length||v.length?i.selectBatch.length||i.unselectBatch.length||i.matrix.update(i.unselectedOptions,d.extendFlat({},x,i.selectedOptions,i.viewOpts)):i.matrix.update(x,null),i.selectBatch=u,i.unselectBatch=v,m}},{"../../lib":719,"../scatter/subtypes":1134,"./helpers":1202}],1208:[function(a,b,c){"use strict";var d=a("../../components/colorscale/attributes"),e=a("../../plots/template_attributes").hovertemplateAttrs,f=a("../mesh3d/attributes"),g=a("../../plots/attributes"),h=a("../../lib/extend").extendFlat,i={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:e({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]})};h(i,d("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){i[a]=f[a]}),i.hoverinfo=h({},g.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),i.transforms=void 0,b.exports=i},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/template_attributes":843,"../mesh3d/attributes":1052}],1209:[function(a,b,c){"use strict";var d=a("../../components/colorscale/calc");b.exports=function(a,b){var c,e,f,g,h=b.u,i=b.v,j=b.w,k=b.x,l=b.y,m=b.z,n=Math.min(k.length,l.length,m.length,h.length,i.length,j.length),o=0;b.starts&&(e=b.starts.x||[],f=b.starts.y||[],g=b.starts.z||[],o=Math.min(e.length,f.length,g.length));var p=0,q=1/0;for(c=0;c<n;c++){var r=h[c],s=i[c],t=j[c],u=Math.sqrt(r*r+s*s+t*t);p=Math.max(p,u),q=Math.min(q,u)}d(a,b,{vals:[q,p],containerStr:"",cLetter:"c"});var v=-1/0,w=1/0,x=-1/0,y=1/0,z=-1/0,A=1/0;for(c=0;c<n;c++){var B=k[c];v=Math.max(v,B),w=Math.min(w,B);var C=l[c];x=Math.max(x,C),y=Math.min(y,C);var D=m[c];z=Math.max(z,D),A=Math.min(A,D)}for(c=0;c<o;c++){var E=e[c];v=Math.max(v,E),w=Math.min(w,E);var F=f[c];x=Math.max(x,F),y=Math.min(y,F);var G=g[c];z=Math.max(z,G),A=Math.min(A,G)}b._len=n,b._slen=o,b._normMax=p,b._xbnds=[w,v],b._ybnds=[y,x],b._zbnds=[A,z]}},{"../../components/colorscale/calc":602}],1210:[function(a,b,c){"use strict";function d(a,b){this.scene=a,this.uid=b,this.mesh=null,this.data=null}function e(a){return k.distinctVals(a).vals}function f(a){var b=a.length;return b>2?a.slice(1,b-1):2===b?[(a[0]+a[1])/2]:a}function g(a){var b=a.length;return 1===b?[.5,.5]:[a[1]-a[0],a[b-1]-a[b-2]]}function h(a,b){function c(a,b){var c=d[b],e=h[o[b]];return k.simpleMap(a,function(a){return c.d2l(a)*e})}var d=a.fullSceneLayout,h=a.dataScale,j=b._len,p={};p.vectors=n(c(b.u,"xaxis"),c(b.v,"yaxis"),c(b.w,"zaxis"),j);var q=e(b.x.slice(0,j)),r=e(b.y.slice(0,j)),s=e(b.z.slice(0,j));if(q.length*r.length*s.length>j)return{positions:[],cells:[]};var t=c(q,"xaxis"),u=c(r,"yaxis"),v=c(s,"zaxis");if(p.meshgrid=[t,u,v],b.starts){var w=b._slen;p.startingPositions=n(c(b.starts.x.slice(0,w),"xaxis"),c(b.starts.y.slice(0,w),"yaxis"),c(b.starts.z.slice(0,w),"zaxis"))}else{for(var x=u[0],y=f(t),z=f(v),A=new Array(y.length*z.length),B=0,C=0;C<y.length;C++)for(var D=0;D<z.length;D++)A[B++]=[y[C],x,z[D]];p.startingPositions=A}p.colormap=l(b),p.tubeSize=b.sizeref,p.maxLength=b.maxdisplayed;var E=c(b._xbnds,"xaxis"),F=c(b._ybnds,"yaxis"),G=c(b._zbnds,"zaxis"),H=g(t),I=g(u),J=g(v),K=[[E[0]-H[0],F[0]-I[0],G[0]-J[0]],[E[1]+H[1],F[1]+I[1],G[1]+J[1]]],L=i(p,K),M=m(b);L.vertexIntensityBounds=[M.min/b._normMax,M.max/b._normMax];var N=b.lightposition;return L.lightPosition=[N.x,N.y,N.z],L.ambient=b.lighting.ambient,L.diffuse=b.lighting.diffuse,L.specular=b.lighting.specular,L.roughness=b.lighting.roughness,L.fresnel=b.lighting.fresnel,L.opacity=b.opacity,b._pad=L.tubeScale*b.sizeref*2,L}var i=a("gl-streamtube3d"),j=i.createTubeMesh,k=a("../../lib"),l=a("../../lib/gl_format_color").parseColorScale,m=a("../../components/colorscale").extractOpts,n=a("../../plots/gl3d/zip3"),o={xaxis:0,yaxis:1,zaxis:2},p=d.prototype;p.handlePick=function(a){function b(a,b){var e=c[b],f=d[o[b]];return e.l2c(a)/f}var c=this.scene.fullSceneLayout,d=this.scene.dataScale;if(a.object===this.mesh){var e=a.data.position,f=a.data.velocity;return a.traceCoordinate=[b(e[0],"xaxis"),b(e[1],"yaxis"),b(e[2],"zaxis"),b(f[0],"xaxis"),b(f[1],"yaxis"),b(f[2],"zaxis"),a.data.intensity*this.data._normMax,a.data.divergence],a.textLabel=this.data.hovertext||this.data.text,!0}},p.update=function(a){this.data=a;var b=h(this.scene,a);this.mesh.update(b)},p.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},b.exports=function(a,b){var c=a.glplot.gl,e=h(a,b),f=j(c,e),g=new d(a,b.uid);return g.mesh=f,g.data=b,f._trace=g,a.glplot.add(f),g}},{"../../components/colorscale":606,"../../lib":719,"../../lib/gl_format_color":716,"../../plots/gl3d/zip3":818,"gl-streamtube3d":314}],1211:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/defaults"),f=a("./attributes");b.exports=function(a,b,c,g){function h(c,e){return d.coerce(a,b,f,c,e)}var i=h("u"),j=h("v"),k=h("w"),l=h("x"),m=h("y"),n=h("z");i&&i.length&&j&&j.length&&k&&k.length&&l&&l.length&&m&&m.length&&n&&n.length?(h("starts.x"),h("starts.y"),h("starts.z"),h("maxdisplayed"),h("sizeref"),h("lighting.ambient"),h("lighting.diffuse"),h("lighting.specular"),h("lighting.roughness"),h("lighting.fresnel"),h("lightposition.x"),h("lightposition.y"),h("lightposition.z"),e(a,b,g,h,{prefix:"",cLetter:"c"}),h("text"),h("hovertext"),h("hovertemplate"),b._length=null):b.visible=!1}},{"../../components/colorscale/defaults":604,"../../lib":719,"./attributes":1208}],1212:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"streamtube",basePlotModule:a("../../plots/gl3d"),categories:["gl3d"],attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:a("./calc"),plot:a("./convert"),eventData:function(a,b){return a.tubex=a.x,a.tubey=a.y,a.tubez=a.z,a.tubeu=b.traceCoordinate[3],a.tubev=b.traceCoordinate[4],a.tubew=b.traceCoordinate[5],a.norm=b.traceCoordinate[6],a.divergence=b.traceCoordinate[7],delete a.x,delete a.y,delete a.z,a},meta:{}}},{"../../plots/gl3d":807,"./attributes":1208,"./calc":1209,"./convert":1210,"./defaults":1211}],1213:[function(a,b,c){"use strict";var d=a("../../plots/attributes"),e=a("../../plots/template_attributes").hovertemplateAttrs,f=a("../../plots/template_attributes").texttemplateAttrs,g=a("../../components/colorscale/attributes"),h=a("../../plots/domain").attributes,i=a("../pie/attributes"),j=a("./constants"),k=a("../../lib/extend").extendFlat;b.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:k({colors:{valType:"data_array",editType:"calc"},line:{color:k({},i.marker.line.color,{dflt:null}),width:k({},i.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},g("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:i.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:f({editType:"plot"},{keys:j.eventDataKeys.concat(["label","value"])}),hovertext:i.hovertext,hoverinfo:k({},d.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:e({},{keys:j.eventDataKeys}),textfont:i.textfont,insidetextfont:i.insidetextfont,outsidetextfont:i.outsidetextfont,domain:h({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/domain":792,"../../plots/template_attributes":843,"../pie/attributes":1085,"./constants":1216}],1214:[function(a,b,c){"use strict";var d=a("../../plots/plots");c.name="sunburst",c.plot=function(a,b,e,f){d.plotBasePlot(c.name,a,b,e,f)},c.clean=function(a,b,e,f){d.cleanBasePlot(c.name,a,b,e,f)}},{"../../plots/plots":828}],1215:[function(a,b,c){"use strict";var d=a("d3-hierarchy"),e=a("fast-isnumeric"),f=a("../../lib"),g=a("../../components/colorscale").makeColorScaleFuncFromTrace,h=a("../pie/calc").makePullColorFn,i=a("../pie/calc").generateExtendedColors,j=a("../../components/colorscale").calc,k={},l={};c.calc=function(a,b){var c,i,k,l,m,n,o=a._fullLayout,p=b.ids,q=f.isArrayOrTypedArray(p),r=b.labels,s=b.parents,t=b.values,u=f.isArrayOrTypedArray(t),v=[],w={},x={},y=function(a){return a||"number"==typeof a},z=function(a){return!u||e(t[a])&&t[a]>=0};q?(c=Math.min(p.length,s.length),i=function(a){return y(p[a])&&z(a)},k=function(a){return String(p[a])}):(c=Math.min(r.length,s.length),i=function(a){return y(r[a])&&z(a)},k=function(a){return String(r[a])}),u&&(c=Math.min(c,t.length));for(var A=0;A<c;A++)if(i(A)){var B=k(A),C=y(s[A])?String(s[A]):"",D={i:A,id:B,pid:C,label:y(r[A])?String(r[A]):""};u&&(D.v=+t[A]),v.push(D),m=B,w[l=C]?w[l].push(m):w[l]=[m],x[m]=1}if(w[""]){if(w[""].length>1){for(var E=f.randstr(),F=0;F<v.length;F++)""===v[F].pid&&(v[F].pid=E);v.unshift({hasMultipleRoots:!0,id:E,pid:"",label:""})}}else{var G,H=[];for(G in w)x[G]||H.push(G);if(1!==H.length)return f.warn("Multiple implied roots, cannot build "+b.type+" hierarchy.");G=H[0],v.unshift({hasImpliedRoot:!0,id:G,pid:"",label:G})}try{n=d.stratify().id(function(a){return a.id}).parentId(function(a){return a.pid})(v)}catch(a){return f.warn("Failed to build "+b.type+" hierarchy. Error: "+a.message)}var I=d.hierarchy(n),J=!1;if(u)switch(b.branchvalues){case"remainder":I.sum(function(a){return a.data.v});break;case"total":I.each(function(a){var b=a.data.data,c=b.v;if(a.children){var d=a.children.reduce(function(a,b){return a+b.data.data.v},0);if((b.hasImpliedRoot||b.hasMultipleRoots)&&(c=d),c<d)return J=!0,f.warn(["Total value for node",a.data.data.id,"is smaller than the sum of its children.","\nparent value =",c,"\nchildren sum =",d].join(" "))}a.value=c})}else!function a(b,c,d){var e=0,f=b.children;if(f){for(var g=f.length,h=0;h<g;h++)e+=a(f[h],c,d);d.branches&&e++}else d.leaves&&e++;return b.value=b.data.data.value=e,c._values||(c._values=[]),c._values[b.data.data.i]=e,e}(I,b,{branches:-1!==b.count.indexOf("branches"),leaves:-1!==b.count.indexOf("leaves")});if(!J){var K,L;I.sort(function(a,b){return b.value-a.value});var M=b.marker.colors||[],N=!!M.length;return b._hasColorscale?(N||(M=u?b.values:b._values),j(a,b,{vals:M,containerStr:"marker",cLetter:"c"}),L=g(b.marker)):K=h(o["_"+b.type+"colormap"]),I.each(function(a){var c=a.data.data;c.color=b._hasColorscale?L(M[c.i]):K(M[c.i],c.id)}),v[0].hierarchy=I,v}},c._runCrossTraceCalc=function(a,b){function c(a){var b=a.data.data,c=b.id;!1===b.color&&(g[c]?b.color=g[c]:a.parent?a.parent.parent?b.color=a.parent.data.data.color:(g[c]=b.color=f[h%f.length],h++):b.color="rgba(0,0,0,0)")}var d=b._fullLayout,e=b.calcdata,f=d[a+"colorway"],g=d["_"+a+"colormap"];d["extend"+a+"colors"]&&(f=i(f,"treemap"===a?l:k));for(var h=0,j=0;j<e.length;j++){var m=e[j][0];m.trace.type===a&&m.hierarchy&&m.hierarchy.each(c)}},c.crossTraceCalc=function(a){return c._runCrossTraceCalc("sunburst",a)}},{"../../components/colorscale":606,"../../lib":719,"../pie/calc":1087,"d3-hierarchy":158,"fast-isnumeric":226}],1216:[function(a,b,c){"use strict";b.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1217:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("../../plots/domain").defaults,g=a("../bar/defaults").handleText,h=a("../../components/colorscale"),i=h.hasColorscale,j=h.handleDefaults;b.exports=function(a,b,c,h){function k(c,f){return d.coerce(a,b,e,c,f)}var l=k("labels"),m=k("parents");if(l&&l.length&&m&&m.length){var n=k("values");k(n&&n.length?"branchvalues":"count"),k("level"),k("maxdepth"),k("marker.line.width")&&k("marker.line.color",h.paper_bgcolor),k("marker.colors");var o=b._hasColorscale=i(a,"marker","colors");o&&j(a,b,h,k,{prefix:"marker.",cLetter:"c"}),k("leaf.opacity",o?1:.7);var p=k("text");k("texttemplate"),b.texttemplate||k("textinfo",Array.isArray(p)?"text+label":"label"),k("hovertext"),k("hovertemplate"),g(a,b,h,k,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),f(b,h,k),b._length=null}else b.visible=!1}},{"../../components/colorscale":606,"../../lib":719,"../../plots/domain":792,"../bar/defaults":862,"./attributes":1213}],1218:[function(a,b,c){"use strict";function d(a,b,c){for(var d=a.data.data,e={curveNumber:b.index,pointNumber:d.i,data:b._input,fullData:b},f=0;f<c.length;f++){var h=c[f];h in a&&(e[h]=a[h])}return"parentString"in a&&!k.isHierarchyRoot(a)&&(e.parent=a.parentString),g(e,b,d.i),e}var e=a("d3"),f=a("../../registry"),g=a("../../components/fx/helpers").appendArrayPointValue,h=a("../../components/fx"),i=a("../../lib"),j=a("../../lib/events"),k=a("./helpers"),l=a("../pie/helpers").formatPieValue;b.exports=function(a,b,c,g,m){var n=g[0],o=n.trace,p=n.hierarchy,q="sunburst"===o.type,r="treemap"===o.type;"_hasHoverLabel"in o||(o._hasHoverLabel=!1),"_hasHoverEvent"in o||(o._hasHoverEvent=!1),a.on("mouseover",function(f){var g=c._fullLayout;if(!c._dragging&&!1!==g.hovermode){var j=c._fullData[o.index],s=f.data.data,t=s.i,u=k.isHierarchyRoot(f),v=k.getParent(p,f),w=k.getValue(f),x=function(a){return i.castOption(j,t,a)},y=x("hovertemplate"),z=h.castHoverinfo(j,g,t),A=g.separators;if(y||z&&"none"!==z&&"skip"!==z){var B,C;q&&(B=n.cx+f.pxmid[0]*(1-f.rInscribed),C=n.cy+f.pxmid[1]*(1-f.rInscribed)),r&&(B=f._hoverX,C=f._hoverY);var D,E={},F=[],G=[],H=function(a){return-1!==F.indexOf(a)};z&&(F="all"===z?j._module.attributes.hoverinfo.flags:z.split("+")),E.label=s.label,H("label")&&E.label&&G.push(E.label),s.hasOwnProperty("v")&&(E.value=s.v,E.valueLabel=l(E.value,A),H("value")&&G.push(E.valueLabel)),E.currentPath=f.currentPath=k.getPath(f.data),H("current path")&&!u&&G.push(E.currentPath);var I=[],J=function(){-1===I.indexOf(D)&&(G.push(D),I.push(D))};E.percentParent=f.percentParent=w/k.getValue(v),E.parent=f.parentString=k.getPtLabel(v),H("percent parent")&&(D=k.formatPercent(E.percentParent,A)+" of "+E.parent,J()),E.percentEntry=f.percentEntry=w/k.getValue(b),E.entry=f.entry=k.getPtLabel(b),!H("percent entry")||u||f.onPathbar||(D=k.formatPercent(E.percentEntry,A)+" of "+E.entry,J()),E.percentRoot=f.percentRoot=w/k.getValue(p),E.root=f.root=k.getPtLabel(p),H("percent root")&&!u&&(D=k.formatPercent(E.percentRoot,A)+" of "+E.root,J()),E.text=x("hovertext")||x("text"),H("text")&&(D=E.text,i.isValidTextValue(D)&&G.push(D));var K={trace:j,y:C,text:G.join("<br>"),name:y||H("name")?j.name:void 0,color:x("hoverlabel.bgcolor")||s.color,borderColor:x("hoverlabel.bordercolor"),fontFamily:x("hoverlabel.font.family"),fontSize:x("hoverlabel.font.size"),fontColor:x("hoverlabel.font.color"),nameLength:x("hoverlabel.namelength"),textAlign:x("hoverlabel.align"),hovertemplate:y,hovertemplateLabels:E,eventData:[d(f,j,m.eventDataKeys)]};q&&(K.x0=B-f.rInscribed*f.rpx1,K.x1=B+f.rInscribed*f.rpx1,K.idealAlign=f.pxmid[0]<0?"left":"right"),r&&(K.x=B,K.idealAlign=B<0?"left":"right"),h.loneHover(K,{container:g._hoverlayer.node(),outerContainer:g._paper.node(),gd:c}),
o._hasHoverLabel=!0}if(r){var L=a.select("path.surface");m.styleOne(L,f,j,{hovered:!0})}o._hasHoverEvent=!0,c.emit("plotly_hover",{points:[d(f,j,m.eventDataKeys)],event:e.event})}}),a.on("mouseout",function(b){var f=c._fullLayout,g=c._fullData[o.index],i=e.select(this).datum();if(o._hasHoverEvent&&(b.originalEvent=e.event,c.emit("plotly_unhover",{points:[d(i,g,m.eventDataKeys)],event:e.event}),o._hasHoverEvent=!1),o._hasHoverLabel&&(h.loneUnhover(f._hoverlayer.node()),o._hasHoverLabel=!1),r){var j=a.select("path.surface");m.styleOne(j,i,g,{hovered:!1})}}),a.on("click",function(a){var b=c._fullLayout,g=c._fullData[o.index];if(!1===j.triggerHandler(c,"plotly_"+o.type+"click",{points:[d(a,g,m.eventDataKeys)],event:e.event})||q&&(k.isHierarchyRoot(a)||k.isLeaf(a)))b.hovermode&&(c._hoverdata=[d(a,g,m.eventDataKeys)],h.click(c,e.event));else if(!c._dragging&&!c._transitioning){f.call("_storeDirectGUIEdit",g,b._tracePreGUI[g.uid],{level:g.level});var i=k.getPtId(a),l=k.isEntry(a)?k.findEntryWithChild(p,i):k.findEntryWithLevel(p,i),n={data:[{level:k.getPtId(l)}],traces:[o.index]},r={frame:{redraw:!1,duration:m.transitionTime},transition:{duration:m.transitionTime,easing:m.transitionEasing},mode:"immediate",fromcurrent:!0};h.loneUnhover(b._hoverlayer.node()),f.call("animate",c,n,r)}})}},{"../../components/fx":632,"../../components/fx/helpers":629,"../../lib":719,"../../lib/events":709,"../../registry":848,"../pie/helpers":1090,"./helpers":1219,d3:164}],1219:[function(a,b,c){"use strict";function d(a){return a.data.data.pid}var e=a("../../lib"),f=a("../../components/color"),g=a("../../lib/setcursor"),h=a("../pie/helpers");c.findEntryWithLevel=function(a,b){var d;return b&&a.eachAfter(function(a){if(c.getPtId(a)===b)return d=a.copy()}),d||a},c.findEntryWithChild=function(a,b){var d;return a.eachAfter(function(a){for(var e=a.children||[],f=0;f<e.length;f++){var g=e[f];if(c.getPtId(g)===b)return d=a.copy()}}),d||a},c.isEntry=function(a){return!a.parent},c.isLeaf=function(a){return!a.children},c.getPtId=function(a){return a.data.data.id},c.getPtLabel=function(a){return a.data.data.label},c.getValue=function(a){return a.value},c.isHierarchyRoot=function(a){return""===d(a)},c.setSliceCursor=function(a,b,d){var e=d.isTransitioning;if(!e){var f=a.datum();e=d.hideOnRoot&&c.isHierarchyRoot(f)||d.hideOnLeaves&&c.isLeaf(f)}g(a,e?null:"pointer")},c.getInsideTextFontKey=function(a,b,c,d){var f=c.data.data.i;return e.castOption(b,f,"insidetextfont."+a)||e.castOption(b,f,"textfont."+a)||d.size},c.getOutsideTextFontKey=function(a,b,c,d){var f=c.data.data.i;return e.castOption(b,f,"outsidetextfont."+a)||e.castOption(b,f,"textfont."+a)||d.size},c.isOutsideText=function(a,b){return!a._hasColorscale&&c.isHierarchyRoot(b)},c.determineTextFont=function(a,b,d,g){return c.isOutsideText(a,b)?function(a,b,d){return{color:c.getOutsideTextFontKey("color",a,b,d),family:c.getOutsideTextFontKey("family",a,b,d),size:c.getOutsideTextFontKey("size",a,b,d)}}(a,b,d):function(a,b,d,g){var h=b.data.data,i=h.i,j=e.castOption(a,i,"insidetextfont.color");return!j&&a._input.textfont&&(j=e.castOption(a._input,i,"textfont.color")),{color:j||f.contrast(h.color),family:c.getInsideTextFontKey("family",g||a,b,d),size:c.getInsideTextFontKey("size",g||a,b,d)}}(a,b,d,g)},c.hasTransition=function(a){return!!(a&&a.duration>0)},c.getMaxDepth=function(a){return a.maxdepth>=0?a.maxdepth:1/0},c.isHeader=function(a,b){return!(c.isLeaf(a)||a.depth===b._maxDepth-1)},c.getParent=function(a,b){return c.findEntryWithLevel(a,d(b))},c.listPath=function(a,b){var d=a.parent;if(!d)return[];var e=b?[d.data[b]]:[d];return c.listPath(d,b).concat(e)},c.getPath=function(a){return c.listPath(a,"label").join("/")+"/"},c.formatValue=h.formatPieValue,c.formatPercent=function(a,b){var c=e.formatPercent(a,0);return"0%"===c&&(c=h.formatPiePercent(a,b)),c}},{"../../components/color":594,"../../lib":719,"../../lib/setcursor":739,"../pie/helpers":1090}],1220:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"sunburst",basePlotModule:a("./base_plot"),categories:[],animatable:!0,attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc").calc,crossTraceCalc:a("./calc").crossTraceCalc,plot:a("./plot").plot,style:a("./style").style,colorbar:a("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1128,"./attributes":1213,"./base_plot":1214,"./calc":1215,"./defaults":1217,"./layout_attributes":1221,"./layout_defaults":1222,"./plot":1223,"./style":1224}],1221:[function(a,b,c){"use strict";b.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1222:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(a,b){function c(c,f){return d.coerce(a,b,e,c,f)}c("sunburstcolorway",b.colorway),c("extendsunburstcolors")}},{"../../lib":719,"./layout_attributes":1221}],1223:[function(a,b,c){"use strict";function d(a,b,d,o){function p(a){var b=a.parent,c=G[n.getPtId(b)],d={};if(c){var f=b.children,g=f.indexOf(a),h=f.length,i=e.interpolate(c.x0,c.x1);d.x0=i(g/h),d.x1=i(g/h)}else d.x0=d.x1=0;return d}var q=a._fullLayout,r=n.hasTransition(o),s=e.select(d).selectAll("g.slice"),t=b[0],u=t.trace,v=t.hierarchy,w=n.findEntryWithLevel(v,u.level),x=n.getMaxDepth(u),y=q._size,z=u.domain,A=y.w*(z.x[1]-z.x[0]),B=y.h*(z.y[1]-z.y[0]),C=.5*Math.min(A,B),D=t.cx=y.l+y.w*(z.x[1]+z.x[0])/2,E=t.cy=y.t+y.h*(1-z.y[0])-B/2;if(!w)return s.remove();var F=null,G={};r&&s.each(function(a){G[n.getPtId(a)]={rpx0:a.rpx0,rpx1:a.rpx1,x0:a.x0,x1:a.x1,transform:a.transform},!F&&n.isEntry(a)&&(F=a)});var H=function(a){return f.partition().size([2*Math.PI,a.height+1])(a)}(w).descendants(),I=w.height+1,J=0,K=x;t.hasMultipleRoots&&n.isHierarchyRoot(w)&&(H=H.slice(1),I-=1,J=1,K+=1),H=H.filter(function(a){return a.y1<=K});var L=Math.min(I,x),M=function(a){return(a-J)/L*C},N=function(a,b){return[a*Math.cos(b),-a*Math.sin(b)]},O=function(a){return h.pathAnnulus(a.rpx0,a.rpx1,a.x0,a.x1,D,E)},P=function(a){return D+a.pxmid[0]*a.transform.rCenter+(a.transform.x||0)},Q=function(a){return E+a.pxmid[1]*a.transform.rCenter+(a.transform.y||0)};(s=s.data(H,n.getPtId)).enter().append("g").classed("slice",!0),r?s.exit().transition().each(function(){var a=e.select(this);a.select("path.surface").transition().attrTween("d",function(a){var b=function(a){var b,c=n.getPtId(a),d=G[c],f=G[n.getPtId(w)];if(f){var g=a.x1>f.x1?2*Math.PI:0;b=a.rpx1<f.rpx1?{rpx0:0,rpx1:0}:{x0:g,x1:g}}else{var h,i=n.getPtId(a.parent);s.each(function(a){if(n.getPtId(a)===i)return h=a});var j,k=h.children;k.forEach(function(a,b){if(n.getPtId(a)===c)return j=b});var l=k.length,m=e.interpolate(h.x0,h.x1);b={rpx0:C,rpx1:C,x0:m(j/l),x1:m((j+1)/l)}}return e.interpolate(d,b)}(a);return function(a){return O(b(a))}}),a.select("g.slicetext").attr("opacity",0)}).remove():s.exit().remove(),s.order();var R=null;if(r&&F){var S=n.getPtId(F);s.each(function(a){null===R&&n.getPtId(a)===S&&(R=a.x1)})}var T=s;r&&(T=T.transition().each("end",function(){var b=e.select(this);n.setSliceCursor(b,a,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),T.each(function(d){var f=e.select(this),o=h.ensureSingle(f,"path","surface",function(a){a.style("pointer-events","all")});d.rpx0=M(d.y0),d.rpx1=M(d.y1),d.xmid=(d.x0+d.x1)/2,d.pxmid=N(d.rpx1,d.xmid),d.midangle=-(d.xmid-Math.PI/2),d.halfangle=.5*Math.min(h.angleDelta(d.x0,d.x1)||Math.PI,Math.PI),d.ring=1-d.rpx0/d.rpx1,d.rInscribed=function(a){return 0===a.rpx0&&h.isFullCircle([a.x0,a.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(a.halfangle)),a.ring/2))}(d),r?o.transition().attrTween("d",function(a){var b=function(a){var b,c=G[n.getPtId(a)],d={x0:a.x0,x1:a.x1,rpx0:a.rpx0,rpx1:a.rpx1};if(c)b=c;else if(F)if(a.parent)if(R){var f=a.x1>R?2*Math.PI:0;b={x0:f,x1:f}}else b={rpx0:C,rpx1:C},h.extendFlat(b,p(a));else b={rpx0:0,rpx1:0};else b={x0:0,x1:0};return e.interpolate(b,d)}(a);return function(a){return O(b(a))}}):o.attr("d",O),f.call(l,w,a,b,{eventDataKeys:m.eventDataKeys,transitionTime:m.CLICK_TRANSITION_TIME,transitionEasing:m.CLICK_TRANSITION_EASING}).call(n.setSliceCursor,a,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:a._transitioning}),o.call(k,d,u);var s=h.ensureSingle(f,"g","slicetext"),v=h.ensureSingle(s,"text","",function(a){a.attr("data-notex",1)});v.text(c.formatSliceLabel(d,w,u,b,q)).classed("slicetext",!0).attr("text-anchor","middle").call(g.font,n.determineTextFont(u,d,q.font)).call(i.convertToTspans,a);var x=g.bBox(v.node());d.transform=j(x,d,t),d.translateX=P(d),d.translateY=Q(d);var y=function(a,b){return"translate("+a.translateX+","+a.translateY+")"+(a.transform.scale<1?"scale("+a.transform.scale+")":"")+(a.transform.rotate?"rotate("+a.transform.rotate+")":"")+"translate("+-(b.left+b.right)/2+","+-(b.top+b.bottom)/2+")"};r?v.transition().attrTween("transform",function(a){var b=function(a){var b,c=G[n.getPtId(a)],d=a.transform;if(c)b=c;else if(b={rpx1:a.rpx1,transform:{scale:0,rotate:d.rotate,rCenter:d.rCenter,x:d.x,y:d.y}},F)if(a.parent)if(R){var f=a.x1>R?2*Math.PI:0;b.x0=b.x1=f}else h.extendFlat(b,p(a));else b.x0=b.x1=0;else b.x0=b.x1=0;var g=e.interpolate(b.rpx1,a.rpx1),i=e.interpolate(b.x0,a.x0),j=e.interpolate(b.x1,a.x1),k=e.interpolate(b.transform.scale,d.scale),l=e.interpolate(b.transform.rotate,d.rotate),m=0===d.rCenter?3:0===b.transform.rCenter?1/3:1,o=e.interpolate(b.transform.rCenter,d.rCenter);return function(a){var b=g(a),c=i(a),e=j(a),f=function(a){return o(Math.pow(a,m))}(a),h={pxmid:N(b,(c+e)/2),transform:{rCenter:f,x:d.x,y:d.y}};return{rpx1:g(a),translateX:P(h),translateY:Q(h),transform:{scale:k(a),rotate:l(a),rCenter:f}}}}(a);return function(a){return y(b(a),x)}}):v.attr("transform",y(d,x))})}var e=a("d3"),f=a("d3-hierarchy"),g=a("../../components/drawing"),h=a("../../lib"),i=a("../../lib/svg_text_utils"),j=a("../pie/plot").transformInsideText,k=a("./style").styleOne,l=a("./fx"),m=a("./constants"),n=a("./helpers");c.plot=function(a,b,c,f){var g,h,i=a._fullLayout._sunburstlayer,j=!c,k=n.hasTransition(c);(g=i.selectAll("g.trace.sunburst").data(b,function(a){return a[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),g.order(),k?(f&&(h=f()),e.transition().duration(c.duration).ease(c.easing).each("end",function(){h&&h()}).each("interrupt",function(){h&&h()}).each(function(){i.selectAll("g.trace").each(function(b){d(a,b,this,c)})})):g.each(function(b){d(a,b,this,c)}),j&&g.exit().remove()},c.formatSliceLabel=function(a,b,c,d,e){var f=c.texttemplate,g=c.textinfo;if(!(f||g&&"none"!==g))return"";var i=e.separators,j=d[0],k=a.data.data,l=j.hierarchy,m=n.isHierarchyRoot(a),o=n.getParent(l,a),p=n.getValue(a);if(!f){var q,r=g.split("+"),s=function(a){return-1!==r.indexOf(a)},t=[];if(s("label")&&k.label&&t.push(k.label),k.hasOwnProperty("v")&&s("value")&&t.push(n.formatValue(k.v,i)),!m){s("current path")&&t.push(n.getPath(a.data));var u=0;s("percent parent")&&u++,s("percent entry")&&u++,s("percent root")&&u++;var v=u>1;if(u){var w,x=function(a){q=n.formatPercent(w,i),v&&(q+=" of "+a),t.push(q)};s("percent parent")&&!m&&(w=p/n.getValue(o),x("parent")),s("percent entry")&&(w=p/n.getValue(b),x("entry")),s("percent root")&&(w=p/n.getValue(l),x("root"))}}return s("text")&&(q=h.castOption(c,k.i,"text"),h.isValidTextValue(q)&&t.push(q)),t.join("<br>")}var y=h.castOption(c,k.i,"texttemplate");if(!y)return"";var z={};k.label&&(z.label=k.label),k.hasOwnProperty("v")&&(z.value=k.v,z.valueLabel=n.formatValue(k.v,i)),z.currentPath=n.getPath(a.data),m||(z.percentParent=p/n.getValue(o),z.percentParentLabel=n.formatPercent(z.percentParent,i),z.parent=n.getPtLabel(o)),z.percentEntry=p/n.getValue(b),z.percentEntryLabel=n.formatPercent(z.percentEntry,i),z.entry=n.getPtLabel(b),z.percentRoot=p/n.getValue(l),z.percentRootLabel=n.formatPercent(z.percentRoot,i),z.root=n.getPtLabel(l),k.hasOwnProperty("color")&&(z.color=k.color);var A=h.castOption(c,k.i,"text");return(h.isValidTextValue(A)||""===A)&&(z.text=A),z.customdata=h.castOption(c,k.i,"customdata"),h.texttemplateString(y,z,e._d3locale,z,c._meta||{})}},{"../../components/drawing":615,"../../lib":719,"../../lib/svg_text_utils":743,"../pie/plot":1094,"./constants":1216,"./fx":1218,"./helpers":1219,"./style":1224,d3:164,"d3-hierarchy":158}],1224:[function(a,b,c){"use strict";function d(a,b,c){var d=b.data.data,e=!b.children,h=d.i,i=g.castOption(c,h,"marker.line.color")||f.defaultLine,j=g.castOption(c,h,"marker.line.width")||0;a.style("stroke-width",j).call(f.fill,d.color).call(f.stroke,i).style("opacity",e?c.leaf.opacity:null)}var e=a("d3"),f=a("../../components/color"),g=a("../../lib");b.exports={style:function(a){a._fullLayout._sunburstlayer.selectAll(".trace").each(function(a){var b=e.select(this),c=a[0].trace;b.style("opacity",c.opacity),b.selectAll("path.surface").each(function(a){e.select(this).call(d,a,c)})})},styleOne:d}},{"../../components/color":594,"../../lib":719,d3:164}],1225:[function(a,b,c){"use strict";function d(a){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:e.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:e.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var e=a("../../components/color"),f=a("../../components/colorscale/attributes"),g=a("../../plots/template_attributes").hovertemplateAttrs,h=a("../../plots/attributes"),i=a("../../lib/extend").extendFlat,j=a("../../plot_api/edit_types").overrideAll,k=b.exports=j(i({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:g(),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},f("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:d(),y:d(),z:d()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},_deprecated:{zauto:i({},f.zauto,{}),zmin:i({},f.zmin,{}),zmax:i({},f.zmax,{})},hoverinfo:i({},h.hoverinfo)}),"calc","nested");k.x.editType=k.y.editType=k.z.editType="calc+clearAxisTypes",k.transforms=void 0},{"../../components/color":594,"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../../plots/template_attributes":843}],1226:[function(a,b,c){"use strict";var d=a("../../components/colorscale/calc");b.exports=function(a,b){b.surfacecolor?d(a,b,{vals:b.surfacecolor,containerStr:"",cLetter:"c"}):d(a,b,{vals:b.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":602}],1227:[function(a,b,c){"use strict";function d(a,b,c){this.scene=a,this.uid=c,this.surface=b,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}function e(a,b){if(a<b)return 0;for(var c=0;0===Math.floor(a%b);)a/=b,c++;return c}function f(a){for(var b=[],c=0;c<u.length;c++){var d=u[c];b.push(e(a,d))}return b}function g(a){for(var b=f(a),c=a,d=0;d<u.length;d++)if(b[d]>0){c=u[d];break}return c}function h(a,b){if(!(a<1||b<1)){for(var c=f(a),d=f(b),e=1,g=0;g<u.length;g++)e*=Math.pow(u[g],Math.max(c[g],d[g]));return e}}function i(a,b){for(var c=!1,d=0;d<a.length;d++)if(b===a[d]){c=!0;break}!1===c&&a.push(b)}var j=a("gl-surface3d"),k=a("ndarray"),l=a("ndarray-homography"),m=a("ndarray-fill"),n=a("../../lib").isArrayOrTypedArray,o=a("../../lib/gl_format_color").parseColorScale,p=a("../../lib/str2rgbarray"),q=a("../../components/colorscale").extractOpts,r=a("../heatmap/interp2d"),s=a("../heatmap/find_empties"),t=d.prototype;t.getXat=function(a,b,c,d){var e=n(this.data.x)?n(this.data.x[0])?this.data.x[b][a]:this.data.x[a]:a;return void 0===c?e:d.d2l(e,0,c)},t.getYat=function(a,b,c,d){var e=n(this.data.y)?n(this.data.y[0])?this.data.y[b][a]:this.data.y[b]:b;return void 0===c?e:d.d2l(e,0,c)},t.getZat=function(a,b,c,d){var e=this.data.z[b][a];return null===e&&this.data.connectgaps&&this.data._interpolatedZ&&(e=this.data._interpolatedZ[b][a]),void 0===c?e:d.d2l(e,0,c)},t.handlePick=function(a){if(a.object===this.surface){var b=(a.data.index[0]-1)/this.dataScaleX-1,c=(a.data.index[1]-1)/this.dataScaleY-1,d=Math.max(Math.min(Math.round(b),this.data.z[0].length-1),0),e=Math.max(Math.min(Math.round(c),this.data._ylength-1),0);a.index=[d,e],a.traceCoordinate=[this.getXat(d,e),this.getYat(d,e),this.getZat(d,e)],a.dataCoordinate=[this.getXat(d,e,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(d,e,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(d,e,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var f=0;f<3;f++){null!=a.dataCoordinate[f]&&(a.dataCoordinate[f]*=this.scene.dataScale[f])}var g=this.data.hovertext||this.data.text;return Array.isArray(g)&&g[e]&&void 0!==g[e][d]?a.textLabel=g[e][d]:a.textLabel=g||"",a.data.dataCoordinate=a.dataCoordinate.slice(),this.surface.highlight(a.data),this.scene.glplot.spikes.position=a.dataCoordinate,!0}};var u=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];t.calcXnums=function(a){var b,c=[];for(b=1;b<a;b++){var d=this.getXat(b-1,0),e=this.getXat(b,0);c[b-1]=e!==d&&null!=d&&null!=e?Math.abs(e-d):0}var f=0;for(b=1;b<a;b++)f+=c[b-1];for(b=1;b<a;b++)0===c[b-1]?c[b-1]=1:c[b-1]=Math.round(f/c[b-1]);return c},t.calcYnums=function(a){var b,c=[];for(b=1;b<a;b++){var d=this.getYat(0,b-1),e=this.getYat(0,b);c[b-1]=e!==d&&null!=d&&null!=e?Math.abs(e-d):0}var f=0;for(b=1;b<a;b++)f+=c[b-1];for(b=1;b<a;b++)0===c[b-1]?c[b-1]=1:c[b-1]=Math.round(f/c[b-1]);return c};var v=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],w=v[9],x=v[13];t.estimateScale=function(a,b){for(var c=1+function(a){if(0!==a.length){for(var b=1,c=0;c<a.length;c++)b=h(b,a[c]);return b}}(0===b?this.calcXnums(a):this.calcYnums(a));c<w;)c*=2;for(;c>x;)c--,c/=g(c),++c<w&&(c=x);var d=Math.round(c/a);return d>1?d:1},t.refineCoords=function(a){for(var b=this.dataScaleX,c=this.dataScaleY,d=a[0].shape[0],e=a[0].shape[1],f=0|Math.floor(a[0].shape[0]*b+1),g=0|Math.floor(a[0].shape[1]*c+1),h=1+d+1,i=1+e+1,j=k(new Float32Array(h*i),[h,i]),m=0;m<a.length;++m){this.surface.padField(j,a[m]);var n=k(new Float32Array(f*g),[f,g]);l(n,j,[b,0,0,0,c,0,0,0,1]),a[m]=n}},t.setContourLevels=function(){var a,b,c,d=[[],[],[]],e=[!1,!1,!1],f=!1;for(a=0;a<3;++a)if(this.showContour[a]&&(f=!0,this.contourSize[a]>0&&null!==this.contourStart[a]&&null!==this.contourEnd[a]&&this.contourEnd[a]>this.contourStart[a]))for(e[a]=!0,b=this.contourStart[a];b<this.contourEnd[a];b+=this.contourSize[a])c=b*this.scene.dataScale[a],i(d[a],c);if(f){var g=[[],[],[]];for(a=0;a<3;++a)this.showContour[a]&&(g[a]=e[a]?d[a]:this.scene.contourLevels[a]);this.surface.update({levels:g})}},t.update=function(a){var b,c,d,e,f=this.scene,g=f.fullSceneLayout,h=this.surface,i=a.opacity,j=o(a,i),l=f.dataScale,n=a.z[0].length,t=a._ylength,u=f.contourLevels;this.data=a;var v=[];for(b=0;b<3;b++)for(v[b]=[],c=0;c<n;c++)v[b][c]=[];for(c=0;c<n;c++)for(d=0;d<t;d++)v[0][c][d]=this.getXat(c,d,a.xcalendar,g.xaxis),v[1][c][d]=this.getYat(c,d,a.ycalendar,g.yaxis),v[2][c][d]=this.getZat(c,d,a.zcalendar,g.zaxis);if(a.connectgaps)for(a._emptypoints=s(v[2]),r(v[2],a._emptypoints),a._interpolatedZ=[],c=0;c<n;c++)for(a._interpolatedZ[c]=[],d=0;d<t;d++)a._interpolatedZ[c][d]=v[2][c][d];for(b=0;b<3;b++)for(c=0;c<n;c++)for(d=0;d<t;d++)null==(e=v[b][c][d])?v[b][c][d]=NaN:e=v[b][c][d]*=l[b];for(b=0;b<3;b++)for(c=0;c<n;c++)for(d=0;d<t;d++)null!=(e=v[b][c][d])&&(this.minValues[b]>e&&(this.minValues[b]=e),this.maxValues[b]<e&&(this.maxValues[b]=e));for(b=0;b<3;b++)this.objectOffset[b]=.5*(this.minValues[b]+this.maxValues[b]);for(b=0;b<3;b++)for(c=0;c<n;c++)for(d=0;d<t;d++)null!=(e=v[b][c][d])&&(v[b][c][d]-=this.objectOffset[b]);var w=[k(new Float32Array(n*t),[n,t]),k(new Float32Array(n*t),[n,t]),k(new Float32Array(n*t),[n,t])];m(w[0],function(a,b){return v[0][a][b]}),m(w[1],function(a,b){return v[1][a][b]}),m(w[2],function(a,b){return v[2][a][b]}),v=[];var y={colormap:j,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!a.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacity:a.opacity},z=q(a);if(y.intensityBounds=[z.min,z.max],a.surfacecolor){var A=k(new Float32Array(n*t),[n,t]);m(A,function(b,c){return a.surfacecolor[c][b]}),w.push(A)}else y.intensityBounds[0]*=l[2],y.intensityBounds[1]*=l[2];(x<w[0].shape[0]||x<w[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(w[0].shape[0],0),this.dataScaleY=this.estimateScale(w[0].shape[1],1),1===this.dataScaleX&&1===this.dataScaleY||this.refineCoords(w)),a.surfacecolor&&(y.intensity=w.pop());var B=[!0,!0,!0],C=["x","y","z"];for(b=0;b<3;++b){var D=a.contours[C[b]];B[b]=D.highlight,y.showContour[b]=D.show||D.highlight,y.showContour[b]&&(y.contourProject[b]=[D.project.x,D.project.y,D.project.z],D.show?(this.showContour[b]=!0,y.levels[b]=u[b],h.highlightColor[b]=y.contourColor[b]=p(D.color),D.usecolormap?h.highlightTint[b]=y.contourTint[b]=0:h.highlightTint[b]=y.contourTint[b]=1,y.contourWidth[b]=D.width,this.contourStart[b]=D.start,this.contourEnd[b]=D.end,this.contourSize[b]=D.size):(this.showContour[b]=!1,this.contourStart[b]=null,this.contourEnd[b]=null,this.contourSize[b]=0),D.highlight&&(y.dynamicColor[b]=p(D.highlightcolor),y.dynamicWidth[b]=D.highlightwidth))}(function(a){var b=a[0].rgb,c=a[a.length-1].rgb;return b[0]===c[0]&&b[1]===c[1]&&b[2]===c[2]&&b[3]===c[3]})(j)&&(y.vertexColor=!0),y.objectOffset=this.objectOffset,y.coords=w,h.update(y),h.visible=a.visible,h.enableDynamic=B,h.enableHighlight=B,h.snapToData=!0,"lighting"in a&&(h.ambientLight=a.lighting.ambient,h.diffuseLight=a.lighting.diffuse,h.specularLight=a.lighting.specular,h.roughness=a.lighting.roughness,h.fresnel=a.lighting.fresnel),"lightposition"in a&&(h.lightPosition=[a.lightposition.x,a.lightposition.y,a.lightposition.z]),i&&i<1&&(h.supportsTransparency=!0)},t.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},b.exports=function(a,b){var c=a.glplot.gl,e=j({gl:c}),f=new d(a,e,b.uid);return e._trace=f,f.update(b),a.glplot.add(e),f}},{"../../components/colorscale":606,"../../lib":719,"../../lib/gl_format_color":716,"../../lib/str2rgbarray":742,"../heatmap/find_empties":1006,"../heatmap/interp2d":1009,"gl-surface3d":317,ndarray:451,"ndarray-fill":441,"ndarray-homography":443}],1228:[function(a,b,c){"use strict";function d(a,b,c){b in a&&!(c in a)&&(a[c]=a[b])}var e=a("../../registry"),f=a("../../lib"),g=a("../../components/colorscale/defaults"),h=a("./attributes");b.exports=function(a,b,c,i){function j(c,d){return f.coerce(a,b,h,c,d)}var k,l,m=j("x"),n=j("y"),o=j("z");if(!o||!o.length||m&&m.length<1||n&&n.length<1)b.visible=!1;else{b._xlength=Array.isArray(m)&&f.isArrayOrTypedArray(m[0])?o.length:o[0].length,b._ylength=o.length,e.getComponentMethod("calendars","handleTraceDefaults")(a,b,["x","y","z"],i),j("text"),j("hovertext"),j("hovertemplate"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(a){j(a)});var p=j("surfacecolor"),q=["x","y","z"];for(k=0;k<3;++k){var r="contours."+q[k],s=j(r+".show"),t=j(r+".highlight");if(s||t)for(l=0;l<3;++l)j(r+".project."+q[l]);s&&(j(r+".color"),j(r+".width"),j(r+".usecolormap")),t&&(j(r+".highlightcolor"),j(r+".highlightwidth")),j(r+".start"),j(r+".end"),j(r+".size")}p||(d(a,"zmin","cmin"),d(a,"zmax","cmax"),d(a,"zauto","cauto")),g(a,b,i,j,{prefix:"",cLetter:"c"}),b._length=null}}},{"../../components/colorscale/defaults":604,"../../lib":719,"../../registry":848,"./attributes":1225}],1229:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:a("./calc"),plot:a("./convert"),moduleType:"trace",name:"surface",basePlotModule:a("../../plots/gl3d"),categories:["gl3d","2dMap","noOpacity"],meta:{}}},{"../../plots/gl3d":807,"./attributes":1225,"./calc":1226,"./convert":1227,"./defaults":1228}],1230:[function(a,b,c){"use strict";var d=a("../../components/annotations/attributes"),e=a("../../lib/extend").extendFlat,f=a("../../plot_api/edit_types").overrideAll,g=a("../../plots/font_attributes"),h=a("../../plots/domain").attributes;a("../../constants/docs").FORMAT_LINK,(b.exports=f({domain:h({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:e({},d.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:e({},g({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:e({},d.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:e({},g({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":577,"../../constants/docs":690,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/domain":792,"../../plots/font_attributes":793}],1231:[function(a,b,c){"use strict";var d=a("../../plots/get_data").getModuleCalcData,e=a("./plot");c.name="table",c.plot=function(a){var b=d(a.calcdata,"table")[0];b.length&&e(a,b)},c.clean=function(a,b,c,d){var e=d._has&&d._has("table"),f=b._has&&b._has("table");e&&!f&&d._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":802,"./plot":1238}],1232:[function(a,b,c){"use strict";var d=a("../../lib/gup").wrap;b.exports=function(){return d({})}},{"../../lib/gup":717}],1233:[function(a,b,c){"use strict";b.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1234:[function(a,b,c){"use strict";function d(a){if(Array.isArray(a)){for(var b=0,c=0;c<a.length;c++)b=Math.max(b,d(a[c]));return b}return a}function e(a,b){return a+b}function f(a){var b,c=a.slice(),d=1/0,e=0;for(b=0;b<c.length;b++)Array.isArray(c[b])||(c[b]=[c[b]]),d=Math.min(d,c[b].length),e=Math.max(e,c[b].length);if(d!==e)for(b=0;b<c.length;b++){var f=e-c[b].length;f&&(c[b]=c[b].concat(g(f)))}return c}function g(a){for(var b=new Array(a),c=0;c<a;c++)b[c]="";return b}function h(a){return a.calcdata.columns.reduce(function(b,c){return c.xIndex<a.xIndex?b+c.columnWidth:b},0)}function i(a,b){return Object.keys(a).map(function(c){return l({},a[c],{auxiliaryBlocks:b})})}function j(a,b){for(var c,d={},e=0,f=0,g={firstRowIndex:null,lastRowIndex:null,rows:[]},h=0,i=0,j=0;j<a.length;j++)c=a[j],g.rows.push({rowIndex:j,rowHeight:c}),((f+=c)>=b||j===a.length-1)&&(d[e]=g,g.key=i++,g.firstRowIndex=h,g.lastRowIndex=j,g={firstRowIndex:null,lastRowIndex:null,rows:[]},e+=f,h=j+1,f=0);return d}var k=a("./constants"),l=a("../../lib/extend").extendFlat,m=a("fast-isnumeric");b.exports=function(a,b){var c=f(b.cells.values),n=function(a){return a.slice(b.header.values.length,a.length)},o=f(b.header.values);o.length&&!o[0].length&&(o[0]=[""],o=f(o));var p=o.concat(n(c).map(function(){return g((o[0]||[""]).length)})),q=b.domain,r=Math.floor(a._fullLayout._size.w*(q.x[1]-q.x[0])),s=Math.floor(a._fullLayout._size.h*(q.y[1]-q.y[0])),t=b.header.values.length?p[0].map(function(){return b.header.height}):[k.emptyHeaderHeight],u=c.length?c[0].map(function(){return b.cells.height}):[],v=t.reduce(e,0),w=j(u,s-v+k.uplift),x=i(j(t,v),[]),y=i(w,x),z={},A=b._fullInput.columnorder.concat(n(c.map(function(a,b){return b}))),B=p.map(function(a,c){
var d=Array.isArray(b.columnwidth)?b.columnwidth[Math.min(c,b.columnwidth.length-1)]:b.columnwidth;return m(d)?Number(d):1}),C=B.reduce(e,0);B=B.map(function(a){return a/C*r});var D=Math.max(d(b.header.line.width),d(b.cells.line.width)),E={key:b.uid+a._context.staticPlot,translateX:q.x[0]*a._fullLayout._size.w,translateY:a._fullLayout._size.h*(1-q.y[1]),size:a._fullLayout._size,width:r,maxLineWidth:D,height:s,columnOrder:A,groupHeight:s,rowBlocks:y,headerRowBlocks:x,scrollY:0,cells:l({},b.cells,{values:c}),headerCells:l({},b.header,{values:p}),gdColumns:p.map(function(a){return a[0]}),gdColumnsOriginalOrder:p.map(function(a){return a[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:p.map(function(a,b){var c=z[a];return z[a]=(c||0)+1,{key:a+"__"+z[a],label:a,specIndex:b,xIndex:A[b],xScale:h,x:void 0,calcdata:void 0,columnWidth:B[b]}})};return E.columns.forEach(function(a){a.calcdata=E,a.x=h(a)}),E}},{"../../lib/extend":710,"./constants":1233,"fast-isnumeric":226}],1235:[function(a,b,c){"use strict";var d=a("../../lib/extend").extendFlat;c.splitToPanels=function(a){var b=[0,0],c=d({},a,{key:"header",type:"header",page:0,prevPages:b,currentRepaint:[null,null],dragHandle:!0,values:a.calcdata.headerCells.values[a.specIndex],rowBlocks:a.calcdata.headerRowBlocks,calcdata:d({},a.calcdata,{cells:a.calcdata.headerCells})});return[d({},a,{key:"cells1",type:"cells",page:0,prevPages:b,currentRepaint:[null,null],dragHandle:!1,values:a.calcdata.cells.values[a.specIndex],rowBlocks:a.calcdata.rowBlocks}),d({},a,{key:"cells2",type:"cells",page:1,prevPages:b,currentRepaint:[null,null],dragHandle:!1,values:a.calcdata.cells.values[a.specIndex],rowBlocks:a.calcdata.rowBlocks}),c]},c.splitToCells=function(a){var b=function(a){var b=a.rowBlocks[a.page],c=b?b.rows[0].rowIndex:0;return[c,b?c+b.rows.length:0]}(a);return(a.values||[]).slice(b[0],b[1]).map(function(c,d){return{keyWithinBlock:d+("string"==typeof c&&c.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:b[0]+d,column:a,calcdata:a.calcdata,page:a.page,rowBlocks:a.rowBlocks,value:c}})}},{"../../lib/extend":710}],1236:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("../../plots/domain").defaults;b.exports=function(a,b,c,g){function h(c,f){return d.coerce(a,b,e,c,f)}f(b,g,h),h("columnwidth"),h("header.values"),h("header.format"),h("header.align"),h("header.prefix"),h("header.suffix"),h("header.height"),h("header.line.width"),h("header.line.color"),h("header.fill.color"),d.coerceFont(h,"header.font",d.extendFlat({},g.font)),function(a,b){for(var c=a.columnorder||[],d=a.header.values.length,e=c.slice(0,d),f=e.slice().sort(function(a,b){return a-b}),g=e.map(function(a){return f.indexOf(a)}),h=g.length;h<d;h++)g.push(h);b("columnorder",g)}(b,h),h("cells.values"),h("cells.format"),h("cells.align"),h("cells.prefix"),h("cells.suffix"),h("cells.height"),h("cells.line.width"),h("cells.line.color"),h("cells.fill.color"),d.coerceFont(h,"cells.font",d.extendFlat({},g.font)),b._length=null}},{"../../lib":719,"../../plots/domain":792,"./attributes":1230}],1237:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot"),moduleType:"trace",name:"table",basePlotModule:a("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1230,"./base_plot":1231,"./calc":1232,"./defaults":1236,"./plot":1238}],1238:[function(a,b,c){"use strict";function d(a){return Math.ceil(a.calcdata.maxLineWidth/2)}function e(a,b){return"clip"+a._fullLayout._uid+"_scrollAreaBottomClip_"+b.key}function f(a,b){return"clip"+a._fullLayout._uid+"_columnBoundaryClippath_"+b.calcdata.key+"_"+b.specIndex}function g(a){return[].concat.apply([],a.map(function(a){return a})).map(function(a){return a.__data__})}function h(a,b,c){var d=a.selectAll("."+B.cn.scrollbarKit).data(D.repeat,D.keyFun);d.enter().append("g").classed(B.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),d.each(function(a){var b=a.scrollbarState;b.totalHeight=function(a){var b=a.rowBlocks;return x(b,b.length-1)+(b.length?y(b[b.length-1],1/0):1)}(a),b.scrollableAreaHeight=a.groupHeight-p(a),b.currentlyVisibleHeight=Math.min(b.totalHeight,b.scrollableAreaHeight),b.ratio=b.currentlyVisibleHeight/b.totalHeight,b.barLength=Math.max(b.ratio*b.currentlyVisibleHeight,B.goldenRatio*B.scrollbarWidth),b.barWiggleRoom=b.currentlyVisibleHeight-b.barLength,b.wiggleRoom=Math.max(0,b.totalHeight-b.scrollableAreaHeight),b.topY=0===b.barWiggleRoom?0:a.scrollY/b.wiggleRoom*b.barWiggleRoom,b.bottomY=b.topY+b.barLength,b.dragMultiplier=b.wiggleRoom/b.barWiggleRoom}).attr("transform",function(a){return"translate("+(a.width+B.scrollbarWidth/2+B.scrollbarOffset)+" "+p(a)+")"});var e=d.selectAll("."+B.cn.scrollbar).data(D.repeat,D.keyFun);e.enter().append("g").classed(B.cn.scrollbar,!0);var f=e.selectAll("."+B.cn.scrollbarSlider).data(D.repeat,D.keyFun);f.enter().append("g").classed(B.cn.scrollbarSlider,!0),f.attr("transform",function(a){return"translate(0 "+(a.scrollbarState.topY||0)+")"});var g=f.selectAll("."+B.cn.scrollbarGlyph).data(D.repeat,D.keyFun);g.enter().append("line").classed(B.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",B.scrollbarWidth).attr("stroke-linecap","round").attr("y1",B.scrollbarWidth/2),g.attr("y2",function(a){return a.scrollbarState.barLength-B.scrollbarWidth/2}).attr("stroke-opacity",function(a){return a.columnDragInProgress||!a.scrollbarState.barWiggleRoom||c?0:.4}),g.transition().delay(0).duration(0),g.transition().delay(B.scrollbarHideDelay).duration(B.scrollbarHideDuration).attr("stroke-opacity",0);var h=e.selectAll("."+B.cn.scrollbarCaptureZone).data(D.repeat,D.keyFun);h.enter().append("line").classed(B.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",B.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(c){var d=C.event.y,e=this.getBoundingClientRect(),f=c.scrollbarState,g=d-e.top,h=C.scale.linear().domain([0,f.scrollableAreaHeight]).range([0,f.totalHeight]).clamp(!0);f.topY<=g&&g<=f.bottomY||r(b,a,null,h(g-f.barLength/2))(c)}).call(C.behavior.drag().origin(function(a){return C.event.stopPropagation(),a.scrollbarState.scrollbarScrollInProgress=!0,a}).on("drag",r(b,a)).on("dragend",function(){})),h.attr("y2",function(a){return a.scrollbarState.scrollableAreaHeight}),b._context.staticPlot&&(g.remove(),h.remove())}function i(a,b,c,d){var e=function(a){var b=a.selectAll("."+B.cn.columnCell).data(J.splitToCells,function(a){return a.keyWithinBlock});return b.enter().append("g").classed(B.cn.columnCell,!0),b.exit().remove(),b}(function(a){var b=a.selectAll("."+B.cn.columnCells).data(D.repeat,D.keyFun);return b.enter().append("g").classed(B.cn.columnCells,!0),b.exit().remove(),b}(c));!function(a){a.each(function(a,b){var c=a.calcdata.cells.font,d=a.column.specIndex,e={size:l(c.size,d,b),color:l(c.color,d,b),family:l(c.family,d,b)};a.rowNumber=a.key,a.align=l(a.calcdata.cells.align,d,b),a.cellBorderWidth=l(a.calcdata.cells.line.width,d,b),a.font=e})}(e),function(a){a.attr("width",function(a){return a.column.columnWidth}).attr("stroke-width",function(a){return a.cellBorderWidth}).each(function(a){var b=C.select(this);K.stroke(b,l(a.calcdata.cells.line.color,a.column.specIndex,a.rowNumber)),K.fill(b,l(a.calcdata.cells.fill.color,a.column.specIndex,a.rowNumber))})}(function(a){var b=a.selectAll("."+B.cn.cellRect).data(D.repeat,function(a){return a.keyWithinBlock});return b.enter().append("rect").classed(B.cn.cellRect,!0),b}(e));var f=function(a){var b=a.selectAll("."+B.cn.cellText).data(D.repeat,function(a){return a.keyWithinBlock});return b.enter().append("text").classed(B.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){C.event.stopPropagation()}),b}(function(a){var b=a.selectAll("."+B.cn.cellTextHolder).data(D.repeat,function(a){return a.keyWithinBlock});return b.enter().append("g").classed(B.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),b}(e));!function(a){a.each(function(a){E.font(C.select(this),a.font)})}(f),j(f,b,d,a),w(e)}function j(a,b,c,d){a.text(function(a){var b=a.column.specIndex,c=a.rowNumber,d=a.value,e="string"==typeof d,f=e&&d.match(/<br>/i),g=!e||f;a.mayHaveMarkup=e&&d.match(/[<&>]/);var h,i="string"==typeof(h=d)&&h.match(B.latexCheck);a.latex=i;var j,m,n=i?"":l(a.calcdata.cells.prefix,b,c)||"",o=i?"":l(a.calcdata.cells.suffix,b,c)||"",p=i?null:l(a.calcdata.cells.format,b,c)||null,q=n+(p?C.format(p)(a.value):a.value)+o;if(a.wrappingNeeded=!a.wrapped&&!g&&!i&&(j=k(q)),a.cellHeightMayIncrease=f||i||a.mayHaveMarkup||(void 0===j?k(q):j),a.needsConvertToTspans=a.mayHaveMarkup||a.wrappingNeeded||a.latex,a.wrappingNeeded){var r=(" "===B.wrapSplitCharacter?q.replace(/<a href=/gi,"<a_href="):q).split(B.wrapSplitCharacter),s=" "===B.wrapSplitCharacter?r.map(function(a){return a.replace(/<a_href=/gi,"<a href=")}):r;a.fragments=s.map(function(a){return{text:a,width:null}}),a.fragments.push({fragment:B.wrapSpacer,width:null}),m=s.join(B.lineBreaker)+B.lineBreaker+B.wrapSpacer}else delete a.fragments,m=q;return m}).attr("dy",function(a){return a.needsConvertToTspans?0:"0.75em"}).each(function(a){var e=C.select(this),f=a.wrappingNeeded?t:u;a.needsConvertToTspans?F.convertToTspans(e,d,f(c,this,b,d,a)):C.select(this.parentNode).attr("transform",function(a){return"translate("+v(a)+" "+B.cellPad+")"}).attr("text-anchor",function(a){return{left:"start",center:"middle",right:"end"}[a.align]})})}function k(a){return-1!==a.indexOf(B.wrapSplitCharacter)}function l(a,b,c){if(Array.isArray(a)){var d=a[Math.min(b,a.length-1)];return Array.isArray(d)?d[Math.min(c,d.length-1)]:d}return a}function m(a,b,c){a.transition().ease(B.releaseTransitionEase).duration(B.releaseTransitionDuration).attr("transform","translate("+b.x+" "+c+")")}function n(a){return"cells"===a.type}function o(a){return"header"===a.type}function p(a){return(a.rowBlocks.length?a.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(a,b){return a+y(b,1/0)},0)}function q(a,b,c){var d=g(b)[0];if(void 0!==d){var e=d.rowBlocks,f=d.calcdata,i=x(e,e.length),j=d.calcdata.groupHeight-p(d),k=f.scrollY=Math.max(0,Math.min(i-j,f.scrollY)),l=function(a,b,c){for(var d=[],e=0,f=0;f<a.length;f++){for(var g=a[f],h=g.rows,i=0,j=0;j<h.length;j++)i+=h[j].rowHeight;g.allRowsHeight=i,b<e+i&&b+c>e&&d.push(f),e+=i}return d}(e,k,j);1===l.length&&(l[0]===e.length-1?l.unshift(l[0]-1):l.push(l[0]+1)),l[0]%2&&l.reverse(),b.each(function(a,b){a.page=l[b],a.scrollY=k}),b.attr("transform",function(a){return"translate(0 "+(x(a.rowBlocks,a.page)-a.scrollY)+")"}),a&&(s(a,c,b,l,d.prevPages,d,0),s(a,c,b,l,d.prevPages,d,1),h(c,a))}}function r(a,b,c,d){return function(e){var f=e.calcdata?e.calcdata:e,g=b.filter(function(a){return f.key===a.key}),h=c||f.scrollbarState.dragMultiplier,i=f.scrollY;f.scrollY=void 0===d?f.scrollY+h*C.event.dy:d;var j=g.selectAll("."+B.cn.yColumn).selectAll("."+B.cn.columnBlock).filter(n);return q(a,j,g),f.scrollY===i}}function s(a,b,c,d,e,f,g){d[g]!==e[g]&&(clearTimeout(f.currentRepaint[g]),f.currentRepaint[g]=setTimeout(function(){var f=c.filter(function(a,b){return b===g&&d[b]!==e[b]});i(a,b,f,c),e[g]=d[g]}))}function t(a,b,c,d){return function(){var e=C.select(b.parentNode);e.each(function(a){var b=a.fragments;e.selectAll("tspan.line").each(function(a,c){b[c].width=this.getComputedTextLength()});var c,d,f=b[b.length-1].width,g=b.slice(0,-1),h=[],i=0,j=a.column.columnWidth-2*B.cellPad;for(a.value="";g.length;)i+(d=(c=g.shift()).width+f)>j&&(a.value+=h.join(B.wrapSpacer)+B.lineBreaker,h=[],i=0),h.push(c.text),i+=d;i&&(a.value+=h.join(B.wrapSpacer)),a.wrapped=!0}),e.selectAll("tspan.line").remove(),j(e.select("."+B.cn.cellText),c,a,d),C.select(b.parentNode.parentNode).call(w)}}function u(a,b,c,d,e){return function(){if(!e.settledY){var f=C.select(b.parentNode),g=A(e),i=e.key-g.firstRowIndex,j=g.rows[i].rowHeight,k=e.cellHeightMayIncrease?b.parentNode.getBoundingClientRect().height+2*B.cellPad:j,l=Math.max(k,j);l-g.rows[i].rowHeight&&(g.rows[i].rowHeight=l,a.selectAll("."+B.cn.columnCell).call(w),q(null,a.filter(n),0),h(c,d,!0)),f.attr("transform",function(){var a=this.parentNode.getBoundingClientRect(),b=C.select(this.parentNode).select("."+B.cn.cellRect).node().getBoundingClientRect(),c=this.transform.baseVal.consolidate(),d=b.top-a.top+(c?c.matrix.f:B.cellPad);return"translate("+v(e,C.select(this.parentNode).select("."+B.cn.cellTextHolder).node().getBoundingClientRect().width)+" "+d+")"}),e.settledY=!0}}}function v(a,b){switch(a.align){case"left":return B.cellPad;case"right":return a.column.columnWidth-(b||0)-B.cellPad;case"center":return(a.column.columnWidth-(b||0))/2;default:return B.cellPad}}function w(a){a.attr("transform",function(a){var b=a.rowBlocks[0].auxiliaryBlocks.reduce(function(a,b){return a+y(b,1/0)},0);return"translate(0 "+(y(A(a),a.key)+b)+")"}).selectAll("."+B.cn.cellRect).attr("height",function(a){return(b=A(a),c=a.key,b.rows[c-b.firstRowIndex]).rowHeight;var b,c})}function x(a,b){for(var c=0,d=b-1;d>=0;d--)c+=z(a[d]);return c}function y(a,b){for(var c=0,d=0;d<a.rows.length&&a.rows[d].rowIndex<b;d++)c+=a.rows[d].rowHeight;return c}function z(a){var b=a.allRowsHeight;if(void 0!==b)return b;for(var c=0,d=0;d<a.rows.length;d++)c+=a.rows[d].rowHeight;return a.allRowsHeight=c,c}function A(a){return a.rowBlocks[a.page]}var B=a("./constants"),C=a("d3"),D=a("../../lib/gup"),E=a("../../components/drawing"),F=a("../../lib/svg_text_utils"),G=a("../../lib").raiseToTop,H=a("../../lib").cancelTransition,I=a("./data_preparation_helper"),J=a("./data_split_helpers"),K=a("../../components/color");b.exports=function(a,b){var c=!a._context.staticPlot,j=a._fullLayout._paper.selectAll("."+B.cn.table).data(b.map(function(b){var c=D.unwrap(b).trace;return I(a,c)}),D.keyFun);j.exit().remove(),j.enter().append("g").classed(B.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),j.attr("width",function(a){return a.width+a.size.l+a.size.r}).attr("height",function(a){return a.height+a.size.t+a.size.b}).attr("transform",function(a){return"translate("+a.translateX+","+a.translateY+")"});var k=j.selectAll("."+B.cn.tableControlView).data(D.repeat,D.keyFun),l=k.enter().append("g").classed(B.cn.tableControlView,!0).style("box-sizing","content-box");c&&l.on("mousemove",function(b){k.filter(function(a){return b===a}).call(h,a)}).on("mousewheel",function(b){if(!b.scrollbarState.wheeling){b.scrollbarState.wheeling=!0;var c=b.scrollY+C.event.deltaY;r(a,k,null,c)(b)||(C.event.stopPropagation(),C.event.preventDefault()),b.scrollbarState.wheeling=!1}}).call(h,a,!0),k.attr("transform",function(a){return"translate("+a.size.l+" "+a.size.t+")"});var p=k.selectAll("."+B.cn.scrollBackground).data(D.repeat,D.keyFun);p.enter().append("rect").classed(B.cn.scrollBackground,!0).attr("fill","none"),p.attr("width",function(a){return a.width}).attr("height",function(a){return a.height}),k.each(function(b){E.setClipUrl(C.select(this),e(a,b),a)});var s=k.selectAll("."+B.cn.yColumn).data(function(a){return a.columns},D.keyFun);s.enter().append("g").classed(B.cn.yColumn,!0),s.exit().remove(),s.attr("transform",function(a){return"translate("+a.x+" 0)"}),c&&s.call(C.behavior.drag().origin(function(b){return m(C.select(this),b,-B.uplift),G(this),b.calcdata.columnDragInProgress=!0,h(k.filter(function(a){return b.calcdata.key===a.key}),a),b}).on("drag",function(a){var b=C.select(this),c=function(b){return(a===b?C.event.x:b.x)+b.columnWidth/2};a.x=Math.max(-B.overdrag,Math.min(a.calcdata.width+B.overdrag-a.columnWidth,C.event.x)),g(s).filter(function(b){return b.calcdata.key===a.calcdata.key}).sort(function(a,b){return c(a)-c(b)}).forEach(function(b,c){b.xIndex=c,b.x=a===b?b.x:b.xScale(b)}),s.filter(function(b){return a!==b}).transition().ease(B.transitionEase).duration(B.transitionDuration).attr("transform",function(a){return"translate("+a.x+" 0)"}),b.call(H).attr("transform","translate("+a.x+" -"+B.uplift+" )")}).on("dragend",function(b){var c=C.select(this),d=b.calcdata;b.x=b.xScale(b),b.calcdata.columnDragInProgress=!1,m(c,b,0),function(a,b,c){var d=b.gdColumnsOriginalOrder;b.gdColumns.sort(function(a,b){return c[d.indexOf(a)]-c[d.indexOf(b)]}),b.columnorder=c,a.emit("plotly_restyle")}(a,d,d.columns.map(function(a){return a.xIndex}))})),s.each(function(b){E.setClipUrl(C.select(this),f(a,b),a)});var t=s.selectAll("."+B.cn.columnBlock).data(J.splitToPanels,D.keyFun);t.enter().append("g").classed(B.cn.columnBlock,!0).attr("id",function(a){return a.key}),t.style("cursor",function(a){return a.dragHandle?"ew-resize":a.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var u=t.filter(o),v=t.filter(n);c&&v.call(C.behavior.drag().origin(function(a){return C.event.stopPropagation(),a}).on("drag",r(a,k,-1)).on("dragend",function(){})),i(a,k,u,t),i(a,k,v,t);var w=k.selectAll("."+B.cn.scrollAreaClip).data(D.repeat,D.keyFun);w.enter().append("clipPath").classed(B.cn.scrollAreaClip,!0).attr("id",function(b){return e(a,b)});var x=w.selectAll("."+B.cn.scrollAreaClipRect).data(D.repeat,D.keyFun);x.enter().append("rect").classed(B.cn.scrollAreaClipRect,!0).attr("x",-B.overdrag).attr("y",-B.uplift).attr("fill","none"),x.attr("width",function(a){return a.width+2*B.overdrag}).attr("height",function(a){return a.height+B.uplift}),s.selectAll("."+B.cn.columnBoundary).data(D.repeat,D.keyFun).enter().append("g").classed(B.cn.columnBoundary,!0);var y=s.selectAll("."+B.cn.columnBoundaryClippath).data(D.repeat,D.keyFun);y.enter().append("clipPath").classed(B.cn.columnBoundaryClippath,!0),y.attr("id",function(b){return f(a,b)});var z=y.selectAll("."+B.cn.columnBoundaryRect).data(D.repeat,D.keyFun);z.enter().append("rect").classed(B.cn.columnBoundaryRect,!0).attr("fill","none"),z.attr("width",function(a){return a.columnWidth+2*d(a)}).attr("height",function(a){return a.calcdata.height+2*d(a)+B.uplift}).attr("x",function(a){return-d(a)}).attr("y",function(a){return-d(a)}),q(null,v,k)}},{"../../components/color":594,"../../components/drawing":615,"../../lib":719,"../../lib/gup":717,"../../lib/svg_text_utils":743,"./constants":1233,"./data_preparation_helper":1234,"./data_split_helpers":1235,d3:164}],1239:[function(a,b,c){"use strict";var d=a("../../plots/template_attributes").hovertemplateAttrs,e=a("../../plots/template_attributes").texttemplateAttrs,f=a("../../components/colorscale/attributes"),g=a("../../plots/domain").attributes,h=a("../pie/attributes"),i=a("../sunburst/attributes"),j=a("./constants"),k=a("../../lib/extend").extendFlat;b.exports={labels:i.labels,parents:i.parents,values:i.values,branchvalues:i.branchvalues,count:i.count,level:i.level,maxdepth:i.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:k({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:i.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:i.marker.line,editType:"calc"},f("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:k({},h.textfont,{}),editType:"calc"},text:h.text,textinfo:i.textinfo,texttemplate:e({editType:"plot"},{keys:j.eventDataKeys.concat(["label","value"])}),hovertext:h.hovertext,hoverinfo:i.hoverinfo,hovertemplate:d({},{keys:j.eventDataKeys}),textfont:h.textfont,insidetextfont:h.insidetextfont,outsidetextfont:h.outsidetextfont,textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},domain:g({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plots/domain":792,"../../plots/template_attributes":843,"../pie/attributes":1085,"../sunburst/attributes":1213,"./constants":1242}],1240:[function(a,b,c){"use strict";var d=a("../../plots/plots");c.name="treemap",c.plot=function(a,b,e,f){d.plotBasePlot(c.name,a,b,e,f)},c.clean=function(a,b,e,f){d.cleanBasePlot(c.name,a,b,e,f)}},{"../../plots/plots":828}],1241:[function(a,b,c){"use strict";var d=a("../sunburst/calc");c.calc=function(a,b){return d.calc(a,b)},c.crossTraceCalc=function(a){return d._runCrossTraceCalc("treemap",a)}},{"../sunburst/calc":1215}],1242:[function(a,b,c){"use strict";b.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1243:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("../../components/color"),g=a("../../plots/domain").defaults,h=a("../bar/defaults").handleText,i=a("../bar/constants").TEXTPAD,j=a("../../components/colorscale"),k=j.hasColorscale,l=j.handleDefaults;b.exports=function(a,b,c,j){function m(c,f){return d.coerce(a,b,e,c,f)}var n=m("labels"),o=m("parents");if(n&&n.length&&o&&o.length){var p=m("values");m(p&&p.length?"branchvalues":"count"),m("level"),m("maxdepth"),"squarify"===m("tiling.packing")&&m("tiling.squarifyratio"),m("tiling.flip"),m("tiling.pad");var q=m("text");m("texttemplate"),b.texttemplate||m("textinfo",Array.isArray(q)?"text+label":"label"),m("hovertext"),m("hovertemplate"),h(a,b,j,m,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),m("textposition");var r=-1!==b.textposition.indexOf("bottom");m("marker.line.width")&&m("marker.line.color",j.paper_bgcolor);var s=m("marker.colors"),t=b._hasColorscale=k(a,"marker","colors");t?l(a,b,j,m,{prefix:"marker.",cLetter:"c"}):m("marker.depthfade",!(s||[]).length);var u=2*b.textfont.size;m("marker.pad.t",r?u/4:u),m("marker.pad.l",u/4),m("marker.pad.r",u/4),m("marker.pad.b",r?u:u/4),t&&l(a,b,j,m,{prefix:"marker.",cLetter:"c"}),b._hovered={marker:{line:{width:2,color:f.contrast(j.paper_bgcolor)}}},m("pathbar.visible")&&(d.coerceFont(m,"pathbar.textfont",j.font),m("pathbar.thickness",b.pathbar.textfont.size+2*i),m("pathbar.side"),m("pathbar.edgeshape")),g(b,j,m),b._length=null}else b.visible=!1}},{"../../components/color":594,"../../components/colorscale":606,"../../lib":719,"../../plots/domain":792,"../bar/constants":860,"../bar/defaults":862,"./attributes":1239}],1244:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../lib"),f=a("../../components/drawing"),g=a("../../lib/svg_text_utils"),h=a("./partition"),i=a("./style").styleOne,j=a("./constants"),k=a("../sunburst/helpers"),l=a("../sunburst/fx");b.exports=function(a,b,c,m,n){var o=n.barDifY,p=n.width,q=n.height,r=n.viewX,s=n.viewY,t=n.pathSlice,u=n.toMoveInsideSlice,v=n.strTransform,w=n.hasTransition,x=n.handleSlicesExit,y=n.makeUpdateSliceInterpolator,z=n.makeUpdateTextInterpolator,A={},B=a._fullLayout,C=b[0],D=C.trace,E=C.hierarchy,F=p/D._entryDepth,G=k.listPath(c.data,"id"),H=h(E.copy(),[p,q],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(H=H.filter(function(a){var b=G.indexOf(a.data.id);return-1!==b&&(a.x0=F*b,a.x1=F*(b+1),a.y0=o,a.y1=o+q,a.onPathbar=!0,!0)})).reverse(),(m=m.data(H,k.getPtId)).enter().append("g").classed("pathbar",!0),x(m,!0,A,[p,q],t),m.order();var I=m;w&&(I=I.transition().each("end",function(){var b=d.select(this);k.setSliceCursor(b,a,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),I.each(function(h){h._hoverX=r(h.x1-q/2),h._hoverY=s(h.y1-q/2);var m=d.select(this),n=e.ensureSingle(m,"path","surface",function(a){a.style("pointer-events","all")});w?n.transition().attrTween("d",function(a){var b=y(a,!0,A,[p,q]);return function(a){return t(b(a))}}):n.attr("d",t),m.call(l,c,a,b,{styleOne:i,eventDataKeys:j.eventDataKeys,transitionTime:j.CLICK_TRANSITION_TIME,transitionEasing:j.CLICK_TRANSITION_EASING}).call(k.setSliceCursor,a,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:a._transitioning}),n.call(i,h,D,{hovered:!1}),h._text=(k.getPtLabel(h)||"").split("<br>").join(" ")||"";var o=e.ensureSingle(m,"g","slicetext"),x=e.ensureSingle(o,"text","",function(a){a.attr("data-notex",1)});x.text(h._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(f.font,k.determineTextFont(D,h,B.font,D.pathdir)).call(g.convertToTspans,a),h.textBB=f.bBox(x.node()),h.transform=u(h,{onPathbar:!0}),k.isOutsideText(D,h)&&(h.transform.targetY-=k.getOutsideTextFontKey("size",D,h,B.font)-k.getInsideTextFontKey("size",D,h,B.font)),w?x.transition().attrTween("transform",function(a){var b=z(a,!0,A,[p,q]);return function(a){return v(b(a))}}):x.attr("transform",v(h))})}},{"../../components/drawing":615,"../../lib":719,"../../lib/svg_text_utils":743,"../sunburst/fx":1218,"../sunburst/helpers":1219,"./constants":1242,"./partition":1249,"./style":1251,d3:164}],1245:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../lib"),f=a("../../components/drawing"),g=a("../../lib/svg_text_utils"),h=a("./partition"),i=a("./style").styleOne,j=a("./constants"),k=a("../sunburst/helpers"),l=a("../sunburst/fx"),m=a("../sunburst/plot").formatSliceLabel;b.exports=function(a,b,c,n,o){var p=o.width,q=o.height,r=o.viewX,s=o.viewY,t=o.pathSlice,u=o.toMoveInsideSlice,v=o.strTransform,w=o.hasTransition,x=o.handleSlicesExit,y=o.makeUpdateSliceInterpolator,z=o.makeUpdateTextInterpolator,A=o.prevEntry,B=a._fullLayout,C=b[0].trace,D=-1!==C.textposition.indexOf("left"),E=-1!==C.textposition.indexOf("right"),F=-1!==C.textposition.indexOf("bottom"),G=!F&&!C.marker.pad.t||F&&!C.marker.pad.b,H=h(c,[p,q],{packing:C.tiling.packing,squarifyratio:C.tiling.squarifyratio,flipX:C.tiling.flip.indexOf("x")>-1,flipY:C.tiling.flip.indexOf("y")>-1,pad:{inner:C.tiling.pad,top:C.marker.pad.t,left:C.marker.pad.l,right:C.marker.pad.r,bottom:C.marker.pad.b}}).descendants(),I=1/0,J=-1/0;H.forEach(function(a){var b=a.depth;b>=C._maxDepth?(a.x0=a.x1=(a.x0+a.x1)/2,a.y0=a.y1=(a.y0+a.y1)/2):(I=Math.min(I,b),J=Math.max(J,b))}),n=n.data(H,k.getPtId),C._maxVisibleLayers=isFinite(J)?J-I+1:0,n.enter().append("g").classed("slice",!0),x(n,!1,{},[p,q],t),n.order();var K=null;if(w&&A){var L=k.getPtId(A);n.each(function(a){null===K&&k.getPtId(a)===L&&(K={x0:a.x0,x1:a.x1,y0:a.y0,y1:a.y1})})}var M=function(){return K||{x0:0,x1:p,y0:0,y1:q}},N=n;return w&&(N=N.transition().each("end",function(){var b=d.select(this);k.setSliceCursor(b,a,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),N.each(function(h){var n=k.isHeader(h,C);h._hoverX=r(h.x1-C.marker.pad.r),h._hoverY=s(F?h.y1-C.marker.pad.b/2:h.y0+C.marker.pad.t/2);var o=d.select(this),x=e.ensureSingle(o,"path","surface",function(a){a.style("pointer-events","all")});w?x.transition().attrTween("d",function(a){var b=y(a,!1,M(),[p,q]);return function(a){return t(b(a))}}):x.attr("d",t),o.call(l,c,a,b,{styleOne:i,eventDataKeys:j.eventDataKeys,transitionTime:j.CLICK_TRANSITION_TIME,transitionEasing:j.CLICK_TRANSITION_EASING}).call(k.setSliceCursor,a,{isTransitioning:a._transitioning}),x.call(i,h,C,{hovered:!1}),h.x0===h.x1||h.y0===h.y1?h._text="":h._text=n?G?"":k.getPtLabel(h)||"":m(h,c,C,b,B)||"";var A=e.ensureSingle(o,"g","slicetext"),H=e.ensureSingle(A,"text","",function(a){a.attr("data-notex",1)});H.text(h._text||" ").classed("slicetext",!0).attr("text-anchor",E?"end":D||n?"start":"middle").call(f.font,k.determineTextFont(C,h,B.font)).call(g.convertToTspans,a),h.textBB=f.bBox(H.node()),h.transform=u(h,{isHeader:n}),w?H.transition().attrTween("transform",function(a){var b=z(a,!1,M(),[p,q]);return function(a){return v(b(a))}}):H.attr("transform",v(h))}),K}},{"../../components/drawing":615,"../../lib":719,"../../lib/svg_text_utils":743,"../sunburst/fx":1218,"../sunburst/helpers":1219,"../sunburst/plot":1223,"./constants":1242,"./partition":1249,"./style":1251,d3:164}],1246:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"treemap",basePlotModule:a("./base_plot"),categories:[],animatable:!0,attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc").calc,crossTraceCalc:a("./calc").crossTraceCalc,plot:a("./plot"),style:a("./style").style,colorbar:a("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1128,"./attributes":1239,"./base_plot":1240,"./calc":1241,"./defaults":1243,"./layout_attributes":1247,"./layout_defaults":1248,"./plot":1250,"./style":1251}],1247:[function(a,b,c){"use strict";b.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1248:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(a,b){function c(c,f){return d.coerce(a,b,e,c,f)}c("treemapcolorway",b.colorway),c("extendtreemapcolors")}},{"../../lib":719,"./layout_attributes":1247}],1249:[function(a,b,c){"use strict";var d=a("d3-hierarchy");b.exports=function(a,b,c){var e,f=c.flipX,g=c.flipY,h="dice-slice"===c.packing,i=c.pad[g?"bottom":"top"],j=c.pad[f?"right":"left"],k=c.pad[f?"left":"right"],l=c.pad[g?"top":"bottom"];h&&(e=j,j=i,i=e,e=k,k=l,l=e);var m=d.treemap().tile(function(a,b){switch(a){case"squarify":return d.treemapSquarify.ratio(b);case"binary":return d.treemapBinary;case"dice":return d.treemapDice;case"slice":return d.treemapSlice;default:return d.treemapSliceDice}}(c.packing,c.squarifyratio)).paddingInner(c.pad.inner).paddingLeft(j).paddingRight(k).paddingTop(i).paddingBottom(l).size(h?[b[1],b[0]]:b)(a);return(h||f||g)&&function a(b,c,d){var e;d.swapXY&&(e=b.x0,b.x0=b.y0,b.y0=e,e=b.x1,b.x1=b.y1,b.y1=e),d.flipX&&(e=b.x0,b.x0=c[0]-b.x1,b.x1=c[0]-e),d.flipY&&(e=b.y0,b.y0=c[1]-b.y1,b.y1=c[1]-e);var f=b.children;if(f)for(var g=0;g<f.length;g++)a(f[g],c,d)}(m,b,{swapXY:h,flipX:f,flipY:g}),m}},{"d3-hierarchy":158}],1250:[function(a,b,c){"use strict";function d(a){return h.isHierarchyRoot(a)?"":h.getPtId(a)}function e(a,b,c,e){function g(a,b){return a+","+b}var o=a._fullLayout,p=b[0],q=p.trace,r=p.hierarchy,s=h.hasTransition(e),t=h.findEntryWithLevel(r,q.level),u=h.isHierarchyRoot(t),v=h.getMaxDepth(q),w=o._size,x=q.domain,y=w.w*(x.x[1]-x.x[0]),z=w.h*(x.y[1]-x.y[0]),A=y,B=q.pathbar.thickness,C=q.marker.line.width+l.gapWithPathbar,D=q.pathbar.visible?q.pathbar.side.indexOf("bottom")>-1?z+C:-(B+C):0,E={x0:A,x1:A,y0:D,y1:D+B},F=function(a,b,c){var d=q.tiling.pad,e=function(a){return a-d<=b.x0},f=function(a){return a+d>=b.x1},g=function(a){return a-d<=b.y0},h=function(a){return a+d>=b.y1};return{x0:e(a.x0-d)?0:f(a.x0-d)?c[0]:a.x0,x1:e(a.x1+d)?0:f(a.x1+d)?c[0]:a.x1,y0:g(a.y0-d)?0:h(a.y0-d)?c[1]:a.y0,y1:g(a.y1+d)?0:h(a.y1+d)?c[1]:a.y1}},G=null,H={},I={},J=null,K=function(a,b){return b?H[d(a)]:I[d(a)]},L=function(a,b,c,e){if(b)return H[d(r)]||E;var f=I[q.level]||c;return function(a){return a.data.depth-t.data.depth<v}(a)?F(a,f,e):{}};p.hasMultipleRoots&&u&&v++,q._maxDepth=v,q._backgroundColor=o.paper_bgcolor,q._entryDepth=t.data.depth,q._atRootLevel=u;var M=-y/2+w.l+w.w*(x.x[1]+x.x[0])/2,N=-z/2+w.t+w.h*(1-(x.y[1]+x.y[0])/2),O=function(a){return M+a},P=function(a){return N+a},Q=P(0),R=O(0),S=function(a){return R+a},T=function(a){return Q+a},U=S(0),V=function(a){a.x=Math.max(U,a.x)},W=q.pathbar.edgeshape,X=function(a,b){var c=a.x0,d=a.x1,e=a.y0,f=a.y1,g=a.textBB;c===d&&(c-=j,d+=j),e===f&&(e-=j,f+=j);var h=function(a){return-1!==q.textposition.indexOf(a)
},i=h("bottom"),l=h("top")||b.isHeader&&!i?"start":i?"end":"middle",m=h("right"),n=h("left")||b.onPathbar,o=n?"left":m?"right":"center";!b.onPathbar&&b.isHeader||(c+=n?j:0,d-=m?j:0);var p=q.marker.pad;if(b.isHeader){if((c+=p.l-j)>=(d-=p.r-j)){var r=(c+d)/2;c=r-j,d=r+j}var s;i?e<(s=f-p.b)&&s<f&&(e=s):e<(s=e+p.t)&&s<f&&(f=s)}var t=k(c,d,e,f,g,{isHorizontal:!1,constrained:!0,angle:0,anchor:l});if("center"!==o){var u=(d-c)/2-t.scale*(g.right-g.left)/2;b.isHeader&&(u-=j),"left"===o?t.targetX-=u:"right"===o&&(t.targetX+=u)}return t.targetX=O(t.targetX),t.targetY=P(t.targetY),isNaN(t.targetX)||isNaN(t.targetY)?{}:{scale:t.scale,rotate:t.rotate,textX:t.textX,textY:t.textY,targetX:t.targetX,targetY:t.targetY}},Y=function(a,b){for(var c,d=0,e=a;!c&&d<v;)d++,(e=e.parent)?c=K(e,b):d=v;return c||{}},Z=function(a,b,c,d){var e,g=K(a,b);if(g)e=g;else if(b)e=E;else if(G)if(a.parent){var h=J||c;h&&!b?e=F(a,h,d):(e={},i.extendFlat(e,Y(a,b)))}else e=a;else e={};return f.interpolate(e,{x0:a.x0,x1:a.x1,y0:a.y0,y1:a.y1})},$=function(a,b,c,d){var e=K(a,b),g={},j=L(a,b,c,d);return i.extendFlat(g,{transform:X({x0:j.x0,x1:j.x1,y0:j.y0,y1:j.y1,textBB:a.textBB,_text:a._text},{isHeader:h.isHeader(a,q)})}),e?g=e:a.parent&&i.extendFlat(g,Y(a,b)),f.interpolate(g,{transform:{scale:a.transform.scale,rotate:a.transform.rotate,textX:a.transform.textX,textY:a.transform.textY,targetX:a.transform.targetX,targetY:a.transform.targetY}})},_=function(a,b,c,d,e){var g=d[0],h=d[1];s?a.exit().transition().each(function(){var a=f.select(this);a.select("path.surface").transition().attrTween("d",function(a){var c=function(a,b,c,d){var e,g=K(a,b);if(b)e=E;else{var h=K(t,b);e=h?F(a,h,d):{}}return f.interpolate(g,e)}(a,b,0,[g,h]);return function(a){return e(c(a))}}),a.select("g.slicetext").attr("opacity",0)}).remove():a.exit().remove()},aa=function(a){return i.getTextTransform({textX:a.transform.textX,textY:a.transform.textY,targetX:a.transform.targetX,targetY:a.transform.targetY,scale:a.transform.scale,rotate:a.transform.rotate})},ba=f.select(c),ca=ba.selectAll("g.pathbar"),da=ba.selectAll("g.slice");if(!t)return ca.remove(),void da.remove();s&&(ca.each(function(a){H[d(a)]={x0:a.x0,x1:a.x1,y0:a.y0,y1:a.y1},a.transform&&(H[d(a)].transform={textX:a.transform.textX,textY:a.transform.textY,targetX:a.transform.targetX,targetY:a.transform.targetY,scale:a.transform.scale,rotate:a.transform.rotate})}),da.each(function(a){I[d(a)]={x0:a.x0,x1:a.x1,y0:a.y0,y1:a.y1},a.transform&&(I[d(a)].transform={textX:a.transform.textX,textY:a.transform.textY,targetX:a.transform.targetX,targetY:a.transform.targetY,scale:a.transform.scale,rotate:a.transform.rotate}),!G&&h.isEntry(a)&&(G=a)})),J=m(a,b,t,da,{width:y,height:z,viewX:O,viewY:P,pathSlice:function(a){var b=O(a.x0),c=O(a.x1),d=P(a.y0),e=P(a.y1),f=c-b,h=e-d;return f&&h?"M"+g(b,d+0)+"L"+g(c-0,d)+"L"+g(c,e-0)+"L"+g(b+0,e)+"Z":""},toMoveInsideSlice:X,prevEntry:G,makeUpdateSliceInterpolator:Z,makeUpdateTextInterpolator:$,handleSlicesExit:_,hasTransition:s,strTransform:aa}),q.pathbar.visible&&n(a,b,t,ca,{barDifY:D,width:A,height:B,viewX:S,viewY:T,pathSlice:function(a){var b=S(Math.max(Math.min(a.x0,a.x0),0)),c=S(Math.min(Math.max(a.x1,a.x1),A)),d=T(a.y0),e=T(a.y1),f=B/2,h={},i={};h.x=b,i.x=c,h.y=i.y=(d+e)/2;var j={x:b,y:d},k={x:c,y:d},l={x:c,y:e},m={x:b,y:e};return">"===W?(j.x-=f,k.x-=f,l.x-=f,m.x-=f):"/"===W?(l.x-=f,m.x-=f,h.x-=f/2,i.x-=f/2):"\\"===W?(j.x-=f,k.x-=f,h.x-=f/2,i.x-=f/2):"<"===W&&(h.x-=f,i.x-=f),V(j),V(m),V(h),V(k),V(l),V(i),"M"+g(j.x,j.y)+"L"+g(k.x,k.y)+"L"+g(i.x,i.y)+"L"+g(l.x,l.y)+"L"+g(m.x,m.y)+"L"+g(h.x,h.y)+"Z"},toMoveInsideSlice:X,makeUpdateSliceInterpolator:Z,makeUpdateTextInterpolator:$,handleSlicesExit:_,hasTransition:s,strTransform:aa})}var f=a("d3"),g=a("../sunburst/helpers").hasTransition,h=a("../sunburst/helpers"),i=a("../../lib"),j=a("../bar/constants").TEXTPAD,k=a("../bar/plot").toMoveInsideBar,l=a("./constants"),m=a("./draw_descendants"),n=a("./draw_ancestors");b.exports=function(a,b,c,d){var h,i,j=a._fullLayout._treemaplayer,k=!c;(h=j.selectAll("g.trace.treemap").data(b,function(a){return a[0].trace.uid})).enter().append("g").classed("trace",!0).classed("treemap",!0),h.order(),g(c)?(d&&(i=d()),f.transition().duration(c.duration).ease(c.easing).each("end",function(){i&&i()}).each("interrupt",function(){i&&i()}).each(function(){j.selectAll("g.trace").each(function(b){e(a,b,this,c)})})):h.each(function(b){e(a,b,this,c)}),k&&h.exit().remove()}},{"../../lib":719,"../bar/constants":860,"../bar/plot":868,"../sunburst/helpers":1219,"./constants":1242,"./draw_ancestors":1244,"./draw_descendants":1245,d3:164}],1251:[function(a,b,c){"use strict";function d(a,b,c,d){var e,i,j=(d||{}).hovered,k=b.data.data,l=k.i,m=k.color,n=h.isHierarchyRoot(b),o=1;if(j)e=c._hovered.marker.line.color,i=c._hovered.marker.line.width;else if(n&&"rgba(0,0,0,0)"===m)o=0,e="rgba(0,0,0,0)",i=0;else if(e=g.castOption(c,l,"marker.line.color")||f.defaultLine,i=g.castOption(c,l,"marker.line.width")||0,!c._hasColorscale&&!b.onPathbar){var p=c.marker.depthfade;if(p){var q,r=f.combine(f.addOpacity(c._backgroundColor,.75),m);if(!0===p){var s=h.getMaxDepth(c);q=isFinite(s)?h.isLeaf(b)?0:c._maxVisibleLayers-(b.data.depth-c._entryDepth):b.data.height+1}else q=b.data.depth-c._entryDepth,c._atRootLevel||q++;if(q>0)for(var t=0;t<q;t++){var u=.5*t/q;m=f.combine(f.addOpacity(r,u),m)}}}a.style("stroke-width",i).call(f.fill,m).call(f.stroke,e).style("opacity",o)}var e=a("d3"),f=a("../../components/color"),g=a("../../lib"),h=a("../sunburst/helpers");b.exports={style:function(a){a._fullLayout._treemaplayer.selectAll(".trace").each(function(a){var b=e.select(this),c=a[0].trace;b.style("opacity",c.opacity),b.selectAll("path.surface").each(function(a){e.select(this).call(d,a,c,{hovered:!1})})})},styleOne:d}},{"../../components/color":594,"../../lib":719,"../sunburst/helpers":1219,d3:164}],1252:[function(a,b,c){"use strict";var d=a("../box/attributes"),e=a("../../lib/extend").extendFlat;b.exports={y:d.y,x:d.x,x0:d.x0,y0:d.y0,name:e({},d.name,{}),orientation:e({},d.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:d.fillcolor,points:e({},d.boxpoints,{}),jitter:e({},d.jitter,{}),pointpos:e({},d.pointpos,{}),width:e({},d.width,{}),marker:d.marker,text:d.text,hovertext:d.hovertext,hovertemplate:d.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup,selected:d.selected,unselected:d.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":710,"../box/attributes":881}],1253:[function(a,b,c){"use strict";function d(a,b,c){var d=b.max-b.min;if(!d)return a.bandwidth?a.bandwidth:0;if(a.bandwidth)return Math.max(a.bandwidth,d/1e4);var e=c.length,g=f.stdev(c,e-1,b.mean);return Math.max(function(a,b,c){return 1.059*Math.min(b,c/1.349)*Math.pow(a,-.2)}(e,g,b.q3-b.q1),d/100)}function e(a,b,c,d){function e(d){var e=i[d],f="multicategory"===c.type?c.r2c(e):c.d2c(e,0,a[b.valLetter+"calendar"]);return f===j?l[d]:f}var f,h=a.spanmode,i=a.span||[],k=[b.min,b.max],l=[b.min-2*d,b.max+2*d],m={type:"linear",range:f="soft"===h?l:"hard"===h?k:[e(0),e(1)]};return g.setConvert(m),m.cleanRange(),f}var f=a("../../lib"),g=a("../../plots/cartesian/axes"),h=a("../box/calc"),i=a("./helpers"),j=a("../../constants/numerical").BADNUM;b.exports=function(a,b){var c=h(a,b);if(c[0].t.empty)return c;for(var j=a._fullLayout,k=g.getFromId(a,b["h"===b.orientation?"xaxis":"yaxis"]),l=1/0,m=-1/0,n=0,o=0,p=0;p<c.length;p++){var q=c[p],r=q.pts.map(i.extractVal),s=q.bandwidth=d(b,q,r),t=q.span=e(b,q,k,s);if(q.min===q.max&&0===s)t=q.span=[q.min,q.max],q.density=[{v:1,t:t[0]}],q.bandwidth=s,n=Math.max(n,1);else{var u=t[1]-t[0],v=Math.ceil(u/(s/3)),w=u/v;if(!isFinite(w)||!isFinite(v))return f.error("Something went wrong with computing the violin span"),c[0].t.empty=!0,c;var x=i.makeKDE(q,b,r);q.density=new Array(v);for(var y=0,z=t[0];z<t[1]+w/2;y++,z+=w){var A=x(z);q.density[y]={v:A,t:z},n=Math.max(n,A)}}o=Math.max(o,r.length),l=Math.min(l,t[0]),m=Math.max(m,t[1])}var B=g.findExtremes(k,[l,m],{padded:!0});if(b._extremes[k._id]=B,b.width)c[0].t.maxKDE=n;else{var C=j._violinScaleGroupStats,D=b.scalegroup,E=C[D];E?(E.maxKDE=Math.max(E.maxKDE,n),E.maxCount=Math.max(E.maxCount,o)):C[D]={maxKDE:n,maxCount:o}}return c[0].t.labels.kde=f._(a,"kde:"),c}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767,"../box/calc":882,"./helpers":1256}],1254:[function(a,b,c){"use strict";var d=a("../box/cross_trace_calc").setPositionOffset,e=["v","h"];b.exports=function(a,b){for(var c=a.calcdata,f=b.xaxis,g=b.yaxis,h=0;h<e.length;h++){for(var i=e[h],j="h"===i?g:f,k=[],l=0;l<c.length;l++){var m=c[l],n=m[0].t,o=m[0].trace;!0!==o.visible||"violin"!==o.type||n.empty||o.orientation!==i||o.xaxis!==f._id||o.yaxis!==g._id||k.push(l)}d("violin",a,k,j)}}},{"../box/cross_trace_calc":883}],1255:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/color"),f=a("../box/defaults"),g=a("./attributes");b.exports=function(a,b,c,h){function i(c,e){return d.coerce(a,b,g,c,e)}function j(c,e){return d.coerce2(a,b,g,c,e)}if(f.handleSampleDefaults(a,b,i,h),!1!==b.visible){i("bandwidth"),i("side"),i("width")||(i("scalegroup",b.name),i("scalemode"));var k,l=i("span");Array.isArray(l)&&(k="manual"),i("spanmode",k);var m=i("line.color",(a.marker||{}).color||c),n=i("line.width"),o=i("fillcolor",e.addOpacity(b.line.color,.5));f.handlePointsDefaults(a,b,i,{prefix:""});var p=j("box.width"),q=j("box.fillcolor",o),r=j("box.line.color",m),s=j("box.line.width",n);i("box.visible",Boolean(p||q||r||s))||(b.box={visible:!1});var t=j("meanline.color",m),u=j("meanline.width",n);i("meanline.visible",Boolean(t||u))||(b.meanline={visible:!1})}}},{"../../components/color":594,"../../lib":719,"../box/defaults":884,"./attributes":1252}],1256:[function(a,b,c){"use strict";var d=a("../../lib"),e=function(a){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*a*a)};c.makeKDE=function(a,b,c){var d=c.length,f=e,g=a.bandwidth,h=1/(d*g);return function(a){for(var b=0,e=0;e<d;e++)b+=f((a-c[e])/g);return h*b}},c.getPositionOnKdePath=function(a,b,c){var e,f;"h"===b.orientation?(e="y",f="x"):(e="x",f="y");var g=d.findPointOnPath(a.path,c,f,{pathLength:a.pathLength}),h=a.posCenterPx,i=g[e];return[i,"both"===b.side?2*h-i:h]},c.getKdeValue=function(a,b,d){var e=a.pts.map(c.extractVal);return c.makeKDE(a,b,e)(d)/a.posDensityScale},c.extractVal=function(a){return a.v}},{"../../lib":719}],1257:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("../box/hover"),g=a("./helpers");b.exports=function(a,b,c,h,i){var j,k,l=a.cd,m=l[0].trace,n=m.hoveron,o=-1!==n.indexOf("violins"),p=-1!==n.indexOf("kde"),q=[];if(o||p){var r=f.hoverOnBoxes(a,b,c,h);if(p&&r.length>0){var s,t,u,v,w,x=a.xa,y=a.ya;"h"===m.orientation?(w=b,s="y",u=y,t="x",v=x):(w=c,s="x",u=x,t="y",v=y);var z=l[a.index];if(w>=z.span[0]&&w<=z.span[1]){var A=d.extendFlat({},a),B=v.c2p(w,!0),C=g.getKdeValue(z,m,w),D=g.getPositionOnKdePath(z,m,B),E=u._offset,F=u._length;A[s+"0"]=D[0],A[s+"1"]=D[1],A[t+"0"]=A[t+"1"]=B,A[t+"Label"]=t+": "+e.hoverLabelText(v,w)+", "+l[0].t.labels.kde+" "+C.toFixed(3),A.spikeDistance=r[0].spikeDistance;var G=s+"Spike";A[G]=r[0][G],r[0].spikeDistance=void 0,r[0][G]=void 0,A.hovertemplate=!1,q.push(A),(k={stroke:a.color})[s+"1"]=d.constrain(E+D[0],E,E+F),k[s+"2"]=d.constrain(E+D[1],E,E+F),k[t+"1"]=k[t+"2"]=v._offset+B}}o&&(q=q.concat(r))}-1!==n.indexOf("points")&&(j=f.hoverOnPoints(a,b,c));var H=i.selectAll(".violinline-"+m.uid).data(k?[0]:[]);return H.enter().append("line").classed("violinline-"+m.uid,!0).attr("stroke-width",1.5),H.exit().remove(),H.attr(k),"closest"===h?j?[j]:q:j?(q.push(j),q):q}},{"../../lib":719,"../../plots/cartesian/axes":767,"../box/hover":886,"./helpers":1256}],1258:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc"),crossTraceCalc:a("./cross_trace_calc"),plot:a("./plot"),style:a("./style"),styleOnSelect:a("../scatter/style").styleOnSelect,hoverPoints:a("./hover"),selectPoints:a("../box/select"),moduleType:"trace",name:"violin",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"../box/defaults":884,"../box/select":891,"../scatter/style":1133,"./attributes":1252,"./calc":1253,"./cross_trace_calc":1254,"./defaults":1255,"./hover":1257,"./layout_attributes":1259,"./layout_defaults":1260,"./plot":1261,"./style":1262}],1259:[function(a,b,c){"use strict";var d=a("../box/layout_attributes"),e=a("../../lib").extendFlat;b.exports={violinmode:e({},d.boxmode,{}),violingap:e({},d.boxgap,{}),violingroupgap:e({},d.boxgroupgap,{})}},{"../../lib":719,"../box/layout_attributes":888}],1260:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes"),f=a("../box/layout_defaults");b.exports=function(a,b,c){f._supply(a,b,c,function(c,f){return d.coerce(a,b,e,c,f)},"violin")}},{"../../lib":719,"../box/layout_defaults":889,"./layout_attributes":1259}],1261:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../lib"),f=a("../../components/drawing"),g=a("../box/plot"),h=a("../scatter/line_points"),i=a("./helpers");b.exports=function(a,b,c,j){function k(a){var b=h(a,{xaxis:m,yaxis:n,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0});return f.smoothopen(b[0],1)}var l=a._fullLayout,m=b.xaxis,n=b.yaxis;e.makeTraceGroups(j,c,"trace violins").each(function(a){var c=d.select(this),f=a[0],h=f.t,j=f.trace;if(!0!==j.visible||h.empty)c.remove();else{var o=h.bPos,p=h.bdPos,q=b[h.valLetter+"axis"],r=b[h.posLetter+"axis"],s="both"===j.side,t=s||"positive"===j.side,u=s||"negative"===j.side,v=c.selectAll("path.violin").data(e.identity);v.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),v.exit().remove(),v.each(function(a){var b,c,e,f,g,i,m,n,v=d.select(this),w=a.density,x=w.length,y=a.pos+o,z=r.c2p(y);if(j.width)b=h.maxKDE/p;else{var A=l._violinScaleGroupStats[j.scalegroup];b="count"===j.scalemode?A.maxKDE/p*(A.maxCount/a.pts.length):A.maxKDE/p}if(t){for(m=new Array(x),g=0;g<x;g++)(n=m[g]={})[h.posLetter]=y+w[g].v/b,n[h.valLetter]=w[g].t;c=k(m)}if(u){for(m=new Array(x),i=0,g=x-1;i<x;i++,g--)(n=m[i]={})[h.posLetter]=y-w[g].v/b,n[h.valLetter]=w[g].t;e=k(m)}if(s)f=c+"L"+e.substr(1)+"Z";else{var B=[z,q.c2p(w[0].t)],C=[z,q.c2p(w[x-1].t)];"h"===j.orientation&&(B.reverse(),C.reverse()),f=t?"M"+B+"L"+c.substr(1)+"L"+C:"M"+C+"L"+e.substr(1)+"L"+B}v.attr("d",f),a.posCenterPx=z,a.posDensityScale=b*p,a.path=v.node(),a.pathLength=a.path.getTotalLength()/(s?2:1)});var w,x,y,z=j.box,A=z.width,B=(z.line||{}).width;s?(w=p*A,x=0):t?(w=[0,p*A/2],x=-B):(w=[p*A/2,0],x=B),g.plotBoxAndWhiskers(c,{pos:r,val:q},j,{bPos:o,bdPos:w,bPosPxOffset:x}),g.plotBoxMean(c,{pos:r,val:q},j,{bPos:o,bdPos:w,bPosPxOffset:x}),!j.box.visible&&j.meanline.visible&&(y=e.identity);var C=c.selectAll("path.meanline").data(y||[]);C.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),C.exit().remove(),C.each(function(a){var b=q.c2p(a.mean,!0),c=i.getPositionOnKdePath(a,j,b);d.select(this).attr("d","h"===j.orientation?"M"+b+","+c[0]+"V"+c[1]:"M"+c[0]+","+b+"H"+c[1])}),g.plotPoints(c,{x:m,y:n},j,h)}})}},{"../../components/drawing":615,"../../lib":719,"../box/plot":890,"../scatter/line_points":1124,"./helpers":1256,d3:164}],1262:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../components/color"),f=a("../scatter/style").stylePoints;b.exports=function(a){var b=d.select(a).selectAll("g.trace.violins");b.style("opacity",function(a){return a[0].trace.opacity}),b.each(function(b){var c=b[0].trace,g=d.select(this),h=c.box||{},i=h.line||{},j=c.meanline||{},k=j.width;g.selectAll("path.violin").style("stroke-width",c.line.width+"px").call(e.stroke,c.line.color).call(e.fill,c.fillcolor),g.selectAll("path.box").style("stroke-width",i.width+"px").call(e.stroke,i.color).call(e.fill,h.fillcolor);var l={"stroke-width":k+"px","stroke-dasharray":2*k+"px,"+k+"px"};g.selectAll("path.mean").style(l).call(e.stroke,j.color),g.selectAll("path.meanline").style(l).call(e.stroke,j.color),f(g,c,a)})}},{"../../components/color":594,"../scatter/style":1133,d3:164}],1263:[function(a,b,c){"use strict";var d=a("../../components/colorscale/attributes"),e=a("../isosurface/attributes"),f=a("../../plots/attributes"),g=a("../../lib/extend").extendFlat,h=a("../../plot_api/edit_types").overrideAll,i=b.exports=h(g({x:e.x,y:e.y,z:e.z,value:e.value,isomin:e.isomin,isomax:e.isomax,surface:e.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:e.slices,caps:e.caps,text:e.text,hovertext:e.hovertext,hovertemplate:e.hovertemplate},d("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:e.colorbar,opacity:e.opacity,opacityscale:{valType:"any",editType:"calc"},lightposition:e.lightposition,lighting:e.lighting,flatshading:e.flatshading,contour:e.contour,hoverinfo:g({},f.hoverinfo)}),"calc","nested");i.x.editType=i.y.editType=i.z.editType=i.value.editType="calc+clearAxisTypes",i.transforms=void 0},{"../../components/colorscale/attributes":601,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../isosurface/attributes":1047}],1264:[function(a,b,c){"use strict";function d(a,b,c){this.scene=a,this.uid=c,this.mesh=b,this.name="",this.data=null,this.showContour=!1}var e=a("gl-mesh3d"),f=a("../../lib/gl_format_color").parseColorScale,g=a("../../lib/str2rgbarray"),h=a("../../components/colorscale").extractOpts,i=a("../../plots/gl3d/zip3"),j=a("../isosurface/convert").findNearestOnAxis,k=a("../isosurface/convert").generateIsoMeshes,l=d.prototype;l.handlePick=function(a){if(a.object===this.mesh){var b=a.data.index,c=this.data._x[b],d=this.data._y[b],e=this.data._z[b],f=this.data._Ys.length,g=this.data._Zs.length,h=j(c,this.data._Xs).id,i=j(d,this.data._Ys).id,k=j(e,this.data._Zs).id,l=a.index=k+g*i+g*f*h;a.traceCoordinate=[this.data._x[l],this.data._y[l],this.data._z[l],this.data.value[l]];var m=this.data.hovertext||this.data.text;return Array.isArray(m)&&void 0!==m[l]?a.textLabel=m[l]:m&&(a.textLabel=m),!0}},l.update=function(a){function b(a,b,c,d){return b.map(function(b){return a.d2l(b,0,d)*c})}var c=this.scene,d=c.fullSceneLayout;this.data=k(a);var e={positions:i(b(d.xaxis,a._x,c.dataScale[0],a.xcalendar),b(d.yaxis,a._y,c.dataScale[1],a.ycalendar),b(d.zaxis,a._z,c.dataScale[2],a.zcalendar)),cells:i(a._i,a._j,a._k),lightPosition:[a.lightposition.x,a.lightposition.y,a.lightposition.z],ambient:a.lighting.ambient,diffuse:a.lighting.diffuse,specular:a.lighting.specular,roughness:a.lighting.roughness,fresnel:a.lighting.fresnel,vertexNormalsEpsilon:a.lighting.vertexnormalsepsilon,faceNormalsEpsilon:a.lighting.facenormalsepsilon,opacity:a.opacity,opacityscale:a.opacityscale,contourEnable:a.contour.show,contourColor:g(a.contour.color).slice(0,3),contourWidth:a.contour.width,useFacetNormals:a.flatshading},j=h(a);e.vertexIntensity=a._intensity,e.vertexIntensityBounds=[j.min,j.max],e.colormap=f(a),this.mesh.update(e)},l.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},b.exports=function(a,b){var c=a.glplot.gl,f=e({gl:c}),g=new d(a,f,b.uid);return f._trace=g,g.update(b),a.glplot.add(f),g}},{"../../components/colorscale":606,"../../lib/gl_format_color":716,"../../lib/str2rgbarray":742,"../../plots/gl3d/zip3":818,"../isosurface/convert":1049,"gl-mesh3d":281}],1265:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("../isosurface/defaults").supplyIsoDefaults;b.exports=function(a,b,c,g){function h(c,f){return d.coerce(a,b,e,c,f)}f(a,b,c,g,h);var i=h("opacityscale");"max"===i?b.opacityscale=[[0,.1],[1,1]]:"min"===i?b.opacityscale=[[0,1],[1,.1]]:"extremes"===i?b.opacityscale=function(a,b){for(var c=[],d=0;d<32;d++){var e=d/31,f=.1+.9*(1-Math.pow(Math.sin(1*e*Math.PI),2));c.push([e,Math.max(1,Math.min(0,f))])}return c}():function(a){var b=0;if(!Array.isArray(a)||a.length<2)return!1;if(!a[0]||!a[a.length-1])return!1;if(0!=+a[0][0]||1!=+a[a.length-1][0])return!1;for(var c=0;c<a.length;c++){var d=a[c];if(2!==d.length||+d[0]<b)return!1;b=+d[0]}return!0}(i)||(b.opacityscale=void 0)}},{"../../lib":719,"../isosurface/defaults":1050,"./attributes":1263}],1266:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:a("./convert"),moduleType:"trace",name:"volume",basePlotModule:a("../../plots/gl3d"),categories:["gl3d"],meta:{}}},{"../../plots/gl3d":807,"../isosurface/calc":1048,"./attributes":1263,"./convert":1264,"./defaults":1265}],1267:[function(a,b,c){"use strict";function d(a){return{marker:{color:k({},e.marker.color,{arrayOk:!1,editType:"style"}),line:{color:k({},e.marker.line.color,{arrayOk:!1,editType:"style"}),width:k({},e.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}var e=a("../bar/attributes"),f=a("../scatter/attributes").line,g=a("../../plots/attributes"),h=a("../../plots/template_attributes").hovertemplateAttrs,i=a("../../plots/template_attributes").texttemplateAttrs,j=a("./constants"),k=a("../../lib/extend").extendFlat,l=a("../../components/color");b.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:e.x,x0:e.x0,dx:e.dx,y:e.y,y0:e.y0,dy:e.dy,hovertext:e.hovertext,hovertemplate:h({},{keys:j.eventDataKeys}),hoverinfo:k({},g.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:i({editType:"plot"},{keys:j.eventDataKeys.concat(["label"])}),text:e.text,textposition:e.textposition,insidetextanchor:e.insidetextanchor,textangle:e.textangle,textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:e.outsidetextfont,constraintext:e.constraintext,cliponaxis:e.cliponaxis,orientation:e.orientation,offset:e.offset,width:e.width,increasing:d(),decreasing:d(),totals:d(),connector:{line:{color:k({},f.color,{dflt:l.defaultLine}),width:k({},f.width,{editType:"plot"}),dash:f.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:e.offsetgroup,alignmentgroup:e.alignmentgroup}},{"../../components/color":594,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/template_attributes":843,"../bar/attributes":858,"../scatter/attributes":1111,"./constants":1269}],1268:[function(a,b,c){"use strict";function d(a){return"a"===a||"absolute"===a}function e(a){return"t"===a||"total"===a}var f=a("../../plots/cartesian/axes"),g=a("../../lib").mergeArray,h=a("../scatter/calc_selection"),i=a("../../constants/numerical").BADNUM;b.exports=function(a,b){var c,j,k=f.getFromId(a,b.xaxis||"x"),l=f.getFromId(a,b.yaxis||"y");"h"===b.orientation?(c=k.makeCalcdata(b,"x"),j=l.makeCalcdata(b,"y")):(c=l.makeCalcdata(b,"y"),j=k.makeCalcdata(b,"x"));for(var m,n=Math.min(j.length,c.length),o=new Array(n),p=0,q=!1,r=0;r<n;r++){var s=c[r]||0,t=!1;(c[r]!==i||e(b.measure[r])||d(b.measure[r]))&&r+1<n&&(c[r+1]!==i||e(b.measure[r+1])||d(b.measure[r+1]))&&(t=!0);var u=o[r]={i:r,p:j[r],s:s,rawS:s,cNext:t};d(b.measure[r])?(p=u.s,u.isSum=!0,u.dir="totals",u.s=p):e(b.measure[r])?(u.isSum=!0,u.dir="totals",u.s=p):(u.isSum=!1,u.dir=u.rawS<0?"decreasing":"increasing",m=u.s,u.s=p+m,p+=m),"totals"===u.dir&&(q=!0),b.ids&&(u.id=String(b.ids[r])),u.v=(b.base||0)+p}return o.length&&(o[0].hasTotals=q),g(b.text,o,"tx"),g(b.hovertext,o,"htx"),h(o,b),o}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767,"../scatter/calc_selection":1113}],1269:[function(a,b,c){"use strict";b.exports={eventDataKeys:["initial","delta","final"]}},{}],1270:[function(a,b,c){"use strict";var d=a("../bar/cross_trace_calc").setGroupPositions;b.exports=function(a,b){var c,e,f=a._fullLayout,g=a._fullData,h=a.calcdata,i=b.xaxis,j=b.yaxis,k=[],l=[],m=[];for(e=0;e<g.length;e++){var n=g[e];!0===n.visible&&n.xaxis===i._id&&n.yaxis===j._id&&"waterfall"===n.type&&(c=h[e],"h"===n.orientation?m.push(c):l.push(c),k.push(c))}var o={mode:f.waterfallmode,norm:f.waterfallnorm,gap:f.waterfallgap,groupgap:f.waterfallgroupgap};for(d(a,i,j,l,o),d(a,j,i,m,o),e=0;e<k.length;e++){c=k[e];for(var p=0;p<c.length;p++){var q=c[p];!1===q.isSum&&(q.s0+=0===p?0:c[p-1].s),p+1<c.length&&(c[p].nextP0=c[p+1].p0,c[p].nextS0=c[p+1].s0)}}}},{"../bar/cross_trace_calc":861}],1271:[function(a,b,c){"use strict";function d(a,b,c){a(b+".marker.color",c),a(b+".marker.line.color",j.defaultLine),a(b+".marker.line.width")}var e=a("../../lib"),f=a("../bar/defaults").handleGroupingDefaults,g=a("../bar/defaults").handleText,h=a("../scatter/xy_defaults"),i=a("./attributes"),j=a("../../components/color"),k=a("../../constants/delta.js"),l=k.INCREASING.COLOR,m=k.DECREASING.COLOR;b.exports={supplyDefaults:function(a,b,c,f){function j(c,d){return e.coerce(a,b,i,c,d)}if(h(a,b,f,j)){j("measure"),j("orientation",b.x&&!b.y?"h":"v"),j("base"),j("offset"),j("width"),j("text"),j("hovertext"),j("hovertemplate");var k=j("textposition");g(a,b,f,j,k,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"!==b.textposition&&(j("texttemplate"),b.texttemplate||j("textinfo")),d(j,"increasing",l),d(j,"decreasing",m),d(j,"totals","#4499FF"),j("connector.visible")&&(j("connector.mode"),j("connector.line.width")&&(j("connector.line.color"),j("connector.line.dash")))}else b.visible=!1},crossTraceDefaults:function(a,b){function c(a){return e.coerce(g._input,g,i,a)}var d,g;if("group"===b.waterfallmode)for(var h=0;h<a.length;h++)d=(g=a[h])._input,f(d,g,b,c)}}},{"../../components/color":594,"../../constants/delta.js":689,"../../lib":719,"../bar/defaults":862,"../scatter/xy_defaults":1136,"./attributes":1267}],1272:[function(a,b,c){"use strict";b.exports=function(a,b){return a.x="xVal"in b?b.xVal:b.x,a.y="yVal"in b?b.yVal:b.y,"initial"in b&&(a.initial=b.initial),"delta"in b&&(a.delta=b.delta),"final"in b&&(a.final=b.final),b.xa&&(a.xaxis=b.xa),b.ya&&(a.yaxis=b.ya),a}},{}],1273:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes").hoverLabelText,e=a("../../components/color").opacity,f=a("../bar/hover").hoverOnBars,g=a("../../constants/delta.js"),h=g.INCREASING.SYMBOL,i=g.DECREASING.SYMBOL;b.exports=function(a,b,c,g){function j(a){return d(o,a)}var k=f(a,b,c,g);if(k){var l=k.cd,m=l[0].trace,n="h"===m.orientation,o=n?a.xa:a.ya,p=l[k.index],q=p.isSum?p.b+p.s:p.rawS;if(!p.isSum){k.initial=p.b+p.s-q,k.delta=q,k.final=k.initial+k.delta;var r=j(Math.abs(k.delta));k.deltaLabel=q<0?"("+r+")":r,k.finalLabel=j(k.final),k.initialLabel=j(k.initial)}var s=p.hi||m.hoverinfo,t=[];if(s&&"none"!==s&&"skip"!==s){var u="all"===s,v=s.split("+"),w=function(a){return u||-1!==v.indexOf(a)};p.isSum||(!w("final")||w(n?"x":"y")||t.push(k.finalLabel),w("delta")&&(q<0?t.push(k.deltaLabel+" "+i):t.push(k.deltaLabel+" "+h)),w("initial")&&t.push("Initial: "+k.initialLabel))}return t.length&&(k.extraText=t.join("<br>")),k.color=function(a,b){var c=a[b.dir].marker,d=c.color,f=c.line.color,g=c.line.width;return e(d)?d:e(f)&&g?f:void 0}(m,p),[k]}}},{"../../components/color":594,"../../constants/delta.js":689,"../../plots/cartesian/axes":767,"../bar/hover":864}],1274:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults").supplyDefaults,crossTraceDefaults:a("./defaults").crossTraceDefaults,supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc"),crossTraceCalc:a("./cross_trace_calc"),plot:a("./plot"),style:a("./style").style,hoverPoints:a("./hover"),eventData:a("./event_data"),selectPoints:a("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:a("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"../bar/select":869,"./attributes":1267,"./calc":1268,"./cross_trace_calc":1270,"./defaults":1271,"./event_data":1272,"./hover":1273,"./layout_attributes":1275,"./layout_defaults":1276,"./plot":1277,"./style":1278}],1275:[function(a,b,c){"use strict";b.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1276:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(a,b,c){function f(c,f){return d.coerce(a,b,e,c,f)}for(var g=!1,h=0;h<c.length;h++){var i=c[h];if(i.visible&&"waterfall"===i.type){g=!0;break}}g&&(f("waterfallmode"),f("waterfallgap",.2),f("waterfallgroupgap"))}},{"../../lib":719,"./layout_attributes":1275}],1277:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../lib"),f=a("../../components/drawing"),g=a("../bar/plot").plot;b.exports=function(a,b,c,h){var i=a._fullLayout;g(a,b,c,h,{mode:i.waterfallmode,norm:i.waterfallmode,gap:i.waterfallgap,groupgap:i.waterfallgroupgap}),function(a,b,c,g){var h=b.xaxis,i=b.yaxis;e.makeTraceGroups(g,c,"trace bars").each(function(c){var g=d.select(this),j=c[0].trace,k=e.ensureSingle(g,"g","lines");if(j.connector&&j.connector.visible){var l="h"===j.orientation,m=j.connector.mode,n=k.selectAll("g.line").data(e.identity);n.enter().append("g").classed("line",!0),n.exit().remove();var o=n.size();n.each(function(c,g){if(g===o-1||c.cNext){var j=function(a,b,c,d){var e=[],f=[],g=d?b:c,h=d?c:b;return e[0]=g.c2p(a.s0,!0),f[0]=h.c2p(a.p0,!0),e[1]=g.c2p(a.s1,!0),f[1]=h.c2p(a.p1,!0),e[2]=g.c2p(a.nextS0,!0),f[2]=h.c2p(a.nextP0,!0),d?[e,f]:[f,e]}(c,h,i,l),k=j[0],n=j[1],p="";"spanning"===m&&!c.isSum&&g>0&&(p+=l?"M"+k[0]+","+n[1]+"V"+n[0]:"M"+k[1]+","+n[0]+"H"+k[0]),"between"!==m&&(c.isSum||g<o-1)&&(p+=l?"M"+k[1]+","+n[0]+"V"+n[1]:"M"+k[0]+","+n[1]+"H"+k[1]),void 0!==k[2]&&void 0!==n[2]&&(p+=l?"M"+k[1]+","+n[1]+"V"+n[2]:"M"+k[1]+","+n[1]+"H"+k[2]),""===p&&(p="M0,0Z"),e.ensureSingle(d.select(this),"path").attr("d",p).call(f.setClipUrl,b.layerClipId,a)}})}else k.remove()})}(a,b,c,h)}},{"../../components/drawing":615,"../../lib":719,"../bar/plot":868,d3:164}],1278:[function(a,b,c){"use strict";var d=a("d3"),e=a("../../components/drawing"),f=a("../../components/color"),g=a("../../constants/interactions").DESELECTDIM,h=a("../bar/style").styleTextPoints;b.exports={style:function(a,b,c){var i=c||d.select(a).selectAll("g.waterfalllayer").selectAll("g.trace");i.style("opacity",function(a){
return a[0].trace.opacity}),i.each(function(b){var c=d.select(this),i=b[0].trace;c.selectAll(".point > path").each(function(a){if(!a.isBlank){var b=i[a.dir].marker;d.select(this).call(f.fill,b.color).call(f.stroke,b.line.color).call(e.dashLine,b.line.dash,b.line.width).style("opacity",i.selectedpoints&&!a.selected?g:1)}}),h(c,i,a),c.selectAll(".lines").each(function(){var a=i.connector.line;e.lineGroupStyle(d.select(this).selectAll("path"),a.width,a.color,a.dash)})})}}},{"../../components/color":594,"../../components/drawing":615,"../../constants/interactions":694,"../bar/style":871,d3:164}],1279:[function(a,b,c){"use strict";function d(a,b,c,d){if(d.enabled){for(var j=d.target,k=i.nestedProperty(b,j),m=k.get(),n=function(a,b){var c=a.func,d=b.d2c,h=b.c2d;switch(c){case"count":return e;case"first":return f;case"last":return g;case"sum":return function(a,b){for(var c=0,e=0;e<b.length;e++){var f=d(a[b[e]]);f!==l&&(c+=f)}return h(c)};case"avg":return function(a,b){for(var c=0,e=0,f=0;f<b.length;f++){var g=d(a[b[f]]);g!==l&&(c+=g,e++)}return e?h(c/e):l};case"min":return function(a,b){for(var c=1/0,e=0;e<b.length;e++){var f=d(a[b[e]]);f!==l&&(c=Math.min(c,f))}return c===1/0?l:h(c)};case"max":return function(a,b){for(var c=-1/0,e=0;e<b.length;e++){var f=d(a[b[e]]);f!==l&&(c=Math.max(c,f))}return c===-1/0?l:h(c)};case"range":return function(a,b){for(var c=1/0,e=-1/0,f=0;f<b.length;f++){var g=d(a[b[f]]);g!==l&&(c=Math.min(c,g),e=Math.max(e,g))}return e===-1/0||c===1/0?l:h(e-c)};case"change":return function(a,b){var c=d(a[b[0]]),e=d(a[b[b.length-1]]);return c===l||e===l?l:h(e-c)};case"median":return function(a,b){for(var c=[],e=0;e<b.length;e++){var f=d(a[b[e]]);f!==l&&c.push(f)}if(!c.length)return l;c.sort();var g=(c.length-1)/2;return h((c[Math.floor(g)]+c[Math.ceil(g)])/2)};case"mode":return function(a,b){for(var c={},e=0,f=l,g=0;g<b.length;g++){var i=d(a[b[g]]);if(i!==l){var j=c[i]=(c[i]||0)+1;j>e&&(e=j,f=i)}}return e?h(f):l};case"rms":return function(a,b){for(var c=0,e=0,f=0;f<b.length;f++){var g=d(a[b[f]]);g!==l&&(c+=g*g,e++)}return e?h(Math.sqrt(c/e)):l};case"stddev":return function(b,c){var e,f=0,g=0,h=1,i=l;for(e=0;e<c.length&&i===l;e++)i=d(b[c[e]]);if(i===l)return l;for(;e<c.length;e++){var j=d(b[c[e]]);if(j!==l){var k=j-i;f+=k,g+=k*k,h++}}var m="sample"===a.funcmode?h-1:h;return m?Math.sqrt((g-f*f/h)/m):0}}}(d,h.getDataConversions(a,b,j,m)),o=new Array(c.length),p=0;p<c.length;p++)o[p]=n(m,c[p]);k.set(o),"count"===d.func&&i.pushUnique(b._arrayAttrs,j)}}function e(a,b){return b.length}function f(a,b){return a[b[0]]}function g(a,b){return a[b[b.length-1]]}var h=a("../plots/cartesian/axes"),i=a("../lib"),j=a("../plot_api/plot_schema"),k=a("./helpers").pointsAccessorFunction,l=a("../constants/numerical").BADNUM;c.moduleType="transform",c.name="aggregate";var m=c.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},n=m.aggregations;c.supplyDefaults=function(a,b){function c(b,c){return i.coerce(a,f,m,b,c)}function d(a,b){return i.coerce(o[e],l,n,a,b)}var e,f={};if(!c("enabled"))return f;var g=j.findArrayAttributes(b),h={};for(e=0;e<g.length;e++)h[g[e]]=1;var k=c("groups");if(!Array.isArray(k)){if(!h[k])return f.enabled=!1,f;h[k]=0}var l,o=a.aggregations||[],p=f.aggregations=new Array(o.length);for(e=0;e<o.length;e++){l={_index:e};var q=d("target"),r=d("func");d("enabled")&&q&&(h[q]||"count"===r&&void 0===h[q])?("stddev"===r&&d("funcmode"),h[q]=0,p[e]=l):p[e]={enabled:!1,_index:e}}for(e=0;e<g.length;e++)h[g[e]]&&p.push({target:g[e],func:n.func.dflt,enabled:!0,_index:-1});return f},c.calcTransform=function(a,b,c){if(c.enabled){var e=c.groups,f=i.getTargetArray(b,{target:e});if(f){var g,h,j,l,m={},n={},o=[],p=k(b.transforms,c),q=f.length;for(b._length&&(q=Math.min(q,b._length)),g=0;g<q;g++)void 0===(j=m[h=f[g]])?(m[h]=o.length,l=[g],o.push(l),n[m[h]]=p(g)):(o[j].push(g),n[m[h]]=(n[m[h]]||[]).concat(p(g)));c._indexToPoints=n;var r=c.aggregations;for(g=0;g<r.length;g++)d(a,b,o,r[g]);"string"==typeof e&&d(a,b,o,{target:e,func:"first",enabled:!0}),b._length=o.length}}}},{"../constants/numerical":695,"../lib":719,"../plot_api/plot_schema":756,"../plots/cartesian/axes":767,"./helpers":1282}],1280:[function(a,b,c){"use strict";var d=a("../lib"),e=a("../registry"),f=a("../plots/cartesian/axes"),g=a("./helpers").pointsAccessorFunction,h=a("../constants/filter_ops"),i=h.COMPARISON_OPS,j=h.INTERVAL_OPS,k=h.SET_OPS;c.moduleType="transform",c.name="filter",c.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(i).concat(j).concat(k),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},c.supplyDefaults=function(a){function b(b,e){return d.coerce(a,f,c.attributes,b,e)}var f={};if(b("enabled")){var g=b("target");if(d.isArrayOrTypedArray(g)&&0===g.length)return f.enabled=!1,f;b("preservegaps"),b("operation"),b("value");var h=e.getComponentMethod("calendars","handleDefaults");h(a,f,"valuecalendar",null),h(a,f,"targetcalendar",null)}return f},c.calcTransform=function(a,b,c){function e(a,c){for(var e=0;e<o.length;e++)a(d.nestedProperty(b,o[e]),c)}if(c.enabled){var h=d.getTargetArray(b,c);if(h){var l=c.target,m=h.length;b._length&&(m=Math.min(m,b._length));var n=c.targetcalendar,o=b._arrayAttrs,p=c.preservegaps;if("string"==typeof l){var q=d.nestedProperty(b,l+"calendar").get();q&&(n=q)}var r,s,t=function(a,b,c){function d(a){return-1!==a.indexOf(f)}var e,f=a.operation,g=a.value,h=Array.isArray(g),l=function(c){return b(c,0,a.valuecalendar)},m=function(a){return b(a,0,c)};switch(d(i)?e=l(h?g[0]:g):d(j)?e=h?[l(g[0]),l(g[1])]:[l(g),l(g)]:d(k)&&(e=h?g.map(l):[l(g)]),f){case"=":return function(a){return m(a)===e};case"!=":return function(a){return m(a)!==e};case"<":return function(a){return m(a)<e};case"<=":return function(a){return m(a)<=e};case">":return function(a){return m(a)>e};case">=":return function(a){return m(a)>=e};case"[]":return function(a){var b=m(a);return b>=e[0]&&b<=e[1]};case"()":return function(a){var b=m(a);return b>e[0]&&b<e[1]};case"[)":return function(a){var b=m(a);return b>=e[0]&&b<e[1]};case"(]":return function(a){var b=m(a);return b>e[0]&&b<=e[1]};case"][":return function(a){var b=m(a);return b<=e[0]||b>=e[1]};case")(":return function(a){var b=m(a);return b<e[0]||b>e[1]};case"](":return function(a){var b=m(a);return b<=e[0]||b>e[1]};case")[":return function(a){var b=m(a);return b<e[0]||b>=e[1]};case"{}":return function(a){return-1!==e.indexOf(m(a))};case"}{":return function(a){return-1===e.indexOf(m(a))}}}(c,f.getDataToCoordFunc(a,b,l,h),n),u={},v={},w=0;p?(r=function(a){u[a.astr]=d.extendDeep([],a.get()),a.set(new Array(m))},s=function(a,b){var c=u[a.astr][b];a.get()[b]=c}):(r=function(a){u[a.astr]=d.extendDeep([],a.get()),a.set([])},s=function(a,b){var c=u[a.astr][b];a.get().push(c)}),e(r);for(var x=g(b.transforms,c),y=0;y<m;y++)t(h[y])?(e(s,y),v[w++]=x(y)):p&&w++;c._indexToPoints=v,b._length=w}}}},{"../constants/filter_ops":691,"../lib":719,"../plots/cartesian/axes":767,"../registry":848,"./helpers":1282}],1281:[function(a,b,c){"use strict";function d(a,b){var c,d,i,j,k,l,m,n,o,p,q=b.transform,r=b.transformIndex,s=a.transforms[r].groups,t=h(a.transforms,q);if(!Array.isArray(s)||0===s.length)return[a];var u=e.filterUnique(s),v=new Array(u.length),w=s.length,x=f.findArrayAttributes(a),y=q.styles||[],z={};for(c=0;c<y.length;c++)z[y[c].target]=y[c].value;q.styles&&(p=e.keyedContainer(q,"styles","target","value.name"));var A={},B={};for(c=0;c<u.length;c++){A[l=u[c]]=c,B[l]=0,(m=v[c]=e.extendDeepNoArrays({},a))._group=l,m.transforms[r]._indexToPoints={};var C=null;for(p&&(C=p.get(l)),m.name=C||""===C?C:e.templateString(q.nameformat,{trace:a.name,group:l}),n=m.transforms,m.transforms=[],d=0;d<n.length;d++)m.transforms[d]=e.extendDeepNoArrays({},n[d]);for(d=0;d<x.length;d++)e.nestedProperty(m,x[d]).set([])}for(i=0;i<x.length;i++){for(j=x[i],d=0,o=[];d<u.length;d++)o[d]=e.nestedProperty(v[d],j).get();for(k=e.nestedProperty(a,j).get(),d=0;d<w;d++)o[A[s[d]]].push(k[d])}for(d=0;d<w;d++)(m=v[A[s[d]]]).transforms[r]._indexToPoints[B[s[d]]]=t(d),B[s[d]]++;for(c=0;c<u.length;c++)l=u[c],m=v[c],g.clearExpandedTraceDefaultColors(m),m=e.extendDeepNoArrays(m,z[l]||{});return v}var e=a("../lib"),f=a("../plot_api/plot_schema"),g=a("../plots/plots"),h=a("./helpers").pointsAccessorFunction;c.moduleType="transform",c.name="groupby",c.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},c.supplyDefaults=function(a,b,d){function f(b,d){return e.coerce(a,h,c.attributes,b,d)}var g,h={};if(!f("enabled"))return h;f("groups"),f("nameformat",d._dataLength>1?"%{group} (%{trace})":"%{group}");var i=a.styles,j=h.styles=[];if(i)for(g=0;g<i.length;g++){var k=j[g]={};e.coerce(i[g],j[g],c.attributes.styles,"target");var l=e.coerce(i[g],j[g],c.attributes.styles,"value");e.isPlainObject(l)?k.value=e.extendDeep({},l):l&&delete k.value}return h},c.transform=function(a,b){var c,e,f,g=[];for(e=0;e<a.length;e++)for(c=d(a[e],b),f=0;f<c.length;f++)g.push(c[f]);return g}},{"../lib":719,"../plot_api/plot_schema":756,"../plots/plots":828,"./helpers":1282}],1282:[function(a,b,c){"use strict";c.pointsAccessorFunction=function(a,b){for(var c,d,e=0;e<a.length&&(c=a[e])!==b;e++)c._indexToPoints&&!1!==c.enabled&&(d=c._indexToPoints);return d?function(a){return d[a]}:function(a){return[a]}}},{}],1283:[function(a,b,c){"use strict";var d=a("../lib"),e=a("../plots/cartesian/axes"),f=a("./helpers").pointsAccessorFunction;c.moduleType="transform",c.name="sort",c.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},c.supplyDefaults=function(a){function b(b,f){return d.coerce(a,e,c.attributes,b,f)}var e={};return b("enabled")&&(b("target"),b("order")),e},c.calcTransform=function(a,b,c){if(c.enabled){var g=d.getTargetArray(b,c);if(g){var h=c.target,i=g.length;b._length&&(i=Math.min(i,b._length));var j,k,l=b._arrayAttrs,m=function(a,b,c,d){var e,f=new Array(d),g=new Array(d);for(e=0;e<d;e++)f[e]={v:b[e],i:e};for(f.sort(function(a,b){switch(a.order){case"ascending":return function(a,c){return b(a.v)-b(c.v)};case"descending":return function(a,c){return b(c.v)-b(a.v)}}}(a,c)),e=0;e<d;e++)g[e]=f[e].i;return g}(c,g,e.getDataToCoordFunc(a,b,h,g),i),n=f(b.transforms,c),o={};for(j=0;j<l.length;j++){var p=d.nestedProperty(b,l[j]),q=p.get(),r=new Array(i);for(k=0;k<i;k++)r[k]=q[m[k]];p.set(r)}for(k=0;k<i;k++)o[k]=n(m[k]);c._indexToPoints=o,b._length=i}}}},{"../lib":719,"../plots/cartesian/axes":767,"./helpers":1282}]},{},[25])(25)}),JustGage=function(a){var b=this;if(null===a||void 0===a)return console.log("* justgage: Make sure to pass options to the constructor!"),!1;var c;if(null!==a.id&&void 0!==a.id){if(!(c=document.getElementById(a.id)))return console.log("* justgage: No element with id : %s found",a.id),!1}else{if(null===a.parentNode||void 0===a.parentNode)return console.log("* justgage: Make sure to pass the existing element id or parentNode to the constructor."),!1;c=a.parentNode}var d=c.dataset?c.dataset:{},e=null!==a.defaults&&void 0!==a.defaults&&a.defaults;!1!==e&&(a=extend({},a,e),delete a.defaults),b.config={id:a.id,value:kvLookup("value",a,d,0,"float"),defaults:kvLookup("defaults",a,d,0,!1),parentNode:kvLookup("parentNode",a,d,null),width:kvLookup("width",a,d,null),height:kvLookup("height",a,d,null),title:kvLookup("title",a,d,""),titleFontColor:kvLookup("titleFontColor",a,d,"#999999"),titleFontFamily:kvLookup("titleFontFamily",a,d,"sans-serif"),titlePosition:kvLookup("titlePosition",a,d,"above"),valueFontColor:kvLookup("valueFontColor",a,d,"#010101"),valueFontFamily:kvLookup("valueFontFamily",a,d,"Arial"),symbol:kvLookup("symbol",a,d,""),min:kvLookup("min",a,d,0,"float"),max:kvLookup("max",a,d,100,"float"),reverse:kvLookup("reverse",a,d,!1),humanFriendlyDecimal:kvLookup("humanFriendlyDecimal",a,d,0),textRenderer:kvLookup("textRenderer",a,d,null),gaugeWidthScale:kvLookup("gaugeWidthScale",a,d,1),gaugeColor:kvLookup("gaugeColor",a,d,"#edebeb"),label:kvLookup("label",a,d,""),labelFontColor:kvLookup("labelFontColor",a,d,"#b3b3b3"),shadowOpacity:kvLookup("shadowOpacity",a,d,.2),shadowSize:kvLookup("shadowSize",a,d,5),shadowVerticalOffset:kvLookup("shadowVerticalOffset",a,d,3),levelColors:kvLookup("levelColors",a,d,["#a9d70b","#f9c802","#ff0000"],"array",","),startAnimationTime:kvLookup("startAnimationTime",a,d,700),startAnimationType:kvLookup("startAnimationType",a,d,">"),refreshAnimationTime:kvLookup("refreshAnimationTime",a,d,700),refreshAnimationType:kvLookup("refreshAnimationType",a,d,">"),donutStartAngle:kvLookup("donutStartAngle",a,d,90),valueMinFontSize:kvLookup("valueMinFontSize",a,d,16),titleMinFontSize:kvLookup("titleMinFontSize",a,d,10),labelMinFontSize:kvLookup("labelMinFontSize",a,d,10),minLabelMinFontSize:kvLookup("minLabelMinFontSize",a,d,10),maxLabelMinFontSize:kvLookup("maxLabelMinFontSize",a,d,10),hideValue:kvLookup("hideValue",a,d,!1),hideMinMax:kvLookup("hideMinMax",a,d,!1),hideInnerShadow:kvLookup("hideInnerShadow",a,d,!1),humanFriendly:kvLookup("humanFriendly",a,d,!1),noGradient:kvLookup("noGradient",a,d,!1),donut:kvLookup("donut",a,d,!1),relativeGaugeSize:kvLookup("relativeGaugeSize",a,d,!1),counter:kvLookup("counter",a,d,!1),decimals:kvLookup("decimals",a,d,0),customSectors:kvLookup("customSectors",a,d,[]),formatNumber:kvLookup("formatNumber",a,d,!1),pointer:kvLookup("pointer",a,d,!1),pointerOptions:kvLookup("pointerOptions",a,d,[])};var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;b.config.value>b.config.max&&(b.config.value=b.config.max),b.config.value<b.config.min&&(b.config.value=b.config.min),b.originalValue=kvLookup("value",a,d,-1,"float"),null!==b.config.id&&null!==document.getElementById(b.config.id)?b.canvas=Raphael(b.config.id,"100%","100%"):null!==b.config.parentNode&&(b.canvas=Raphael(b.config.parentNode,"100%","100%")),!0===b.config.relativeGaugeSize&&b.canvas.setViewBox(0,0,200,150,!0),!0===b.config.relativeGaugeSize?(f=200,g=150):null!==b.config.width&&null!==b.config.height?(f=b.config.width,g=b.config.height):null!==b.config.parentNode?(b.canvas.setViewBox(0,0,200,150,!0),f=200,g=150):(f=1*getStyle(document.getElementById(b.config.id),"width").slice(0,-2),g=1*getStyle(document.getElementById(b.config.id),"height").slice(0,-2)),!0===b.config.donut?(f>g?(i=g,h=i):g>f?(h=f,(i=h)>g&&(j=i/g,i/=j,h=i/j)):(h=f,i=h),k=(f-h)/2,l=(g-i)/2,m=i/8>10?i/10:10,n=k+h/2,o=l+i/11,p=i/6.4>16?i/5.4:18,q=k+h/2,r=""!==b.config.label?l+i/1.85:l+i/1.7,s=i/16>10?i/16:10,t=k+h/2,u=r+s,v=i/16>10?i/16:10,w=k+h/10+h/6.666666666666667*b.config.gaugeWidthScale/2,x=u,y=i/16>10?i/16:10,z=k+h-h/10-h/6.666666666666667*b.config.gaugeWidthScale/2,A=u):(f>g?(i=g,(h=1.25*i)>f&&(j=h/f,h/=j,i/=j)):g>f?(h=f,(i=h/1.25)>g&&(j=i/g,i/=j,h=i/j)):(h=f,i=.75*h),k=(f-h)/2,l=(g-i)/2,"below"===b.config.titlePosition&&(l-=i/6.4),m=i/8>b.config.titleMinFontSize?i/10:b.config.titleMinFontSize,n=k+h/2,o=l+("below"===b.config.titlePosition?1.07*i:i/6.4),p=i/6.5>b.config.valueMinFontSize?i/6.5:b.config.valueMinFontSize,q=k+h/2,r=l+i/1.275,s=i/16>b.config.labelMinFontSize?i/16:b.config.labelMinFontSize,t=k+h/2,u=r+p/2+5,v=i/16>b.config.minLabelMinFontSize?i/16:b.config.minLabelMinFontSize,w=k+h/10+h/6.666666666666667*b.config.gaugeWidthScale/2,x=u,y=i/16>b.config.maxLabelMinFontSize?i/16:b.config.maxLabelMinFontSize,z=k+h-h/10-h/6.666666666666667*b.config.gaugeWidthScale/2,A=u),b.params={canvasW:f,canvasH:g,widgetW:h,widgetH:i,dx:k,dy:l,titleFontSize:m,titleX:n,titleY:o,valueFontSize:p,valueX:q,valueY:r,labelFontSize:s,labelX:t,labelY:u,minFontSize:v,minX:w,minY:x,maxFontSize:y,maxX:z,maxY:A},A=null,b.canvas.customAttributes.pki=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t;return i?(k=(1-2*(a-b)/(c-b))*Math.PI,l=d/2-d/7,m=l-d/6.666666666666667*h,n=d/2+f,o=e/1.95+g,p=d/2+f+l*Math.cos(k),q=e-(e-o)-l*Math.sin(k),r=d/2+f+m*Math.cos(k),s=e-(e-o)-m*Math.sin(k),t="M"+(n-m)+","+o+" ",t+="L"+(n-l)+","+o+" ",a>(c-b)/2&&(t+="A"+l+","+l+" 0 0 1 "+(n+l)+","+o+" "),t+="A"+l+","+l+" 0 0 1 "+p+","+q+" ",t+="L"+r+","+s+" ",a>(c-b)/2&&(t+="A"+m+","+m+" 0 0 0 "+(n+m)+","+o+" "),t+="A"+m+","+m+" 0 0 0 "+(n-m)+","+o+" ",t+="Z ",{path:t}):(k=(1-(a-b)/(c-b))*Math.PI,l=d/2-d/10,m=l-d/6.666666666666667*h,n=d/2+f,o=e/1.25+g,p=d/2+f+l*Math.cos(k),q=e-(e-o)-l*Math.sin(k),r=d/2+f+m*Math.cos(k),s=e-(e-o)-m*Math.sin(k),t="M"+(n-m)+","+o+" ",t+="L"+(n-l)+","+o+" ",t+="A"+l+","+l+" 0 0 1 "+p+","+q+" ",t+="L"+r+","+s+" ",t+="A"+m+","+m+" 0 0 0 "+(n-m)+","+o+" ",t+="Z ",{path:t})},b.canvas.customAttributes.ndl=function(a,c,d,e,f,g,h,i,j){var k=3.5*e/100,l=e/15,m=e/100;null!=b.config.pointerOptions.toplength&&void 0!=b.config.pointerOptions.toplength&&(k=b.config.pointerOptions.toplength),null!=b.config.pointerOptions.bottomlength&&void 0!=b.config.pointerOptions.bottomlength&&(l=b.config.pointerOptions.bottomlength),null!=b.config.pointerOptions.bottomwidth&&void 0!=b.config.pointerOptions.bottomwidth&&(m=b.config.pointerOptions.bottomwidth);var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;return j?(n=(1-2*(a-c)/(d-c))*Math.PI,o=e/2-e/7,p=o-e/6.666666666666667*i,e/2+g,q=f/1.95+h,r=e/2+g+o*Math.cos(n),s=f-(f-q)-o*Math.sin(n),t=e/2+g+p*Math.cos(n),u=f-(f-q)-p*Math.sin(n),v=r+k*Math.cos(n),w=s-k*Math.sin(n),x=t-l*Math.cos(n),y=u+l*Math.sin(n),z=x+m*Math.sin(n),A=y+m*Math.cos(n),B=x-m*Math.sin(n),C=y-m*Math.cos(n),D="M"+z+","+A+" ",D+="L"+B+","+C+" ",D+="L"+v+","+w+" ",D+="Z ",{path:D}):(n=(1-(a-c)/(d-c))*Math.PI,o=e/2-e/10,p=o-e/6.666666666666667*i,e/2+g,q=f/1.25+h,r=e/2+g+o*Math.cos(n),s=f-(f-q)-o*Math.sin(n),t=e/2+g+p*Math.cos(n),u=f-(f-q)-p*Math.sin(n),v=r+k*Math.cos(n),w=s-k*Math.sin(n),x=t-l*Math.cos(n),y=u+l*Math.sin(n),z=x+m*Math.sin(n),A=y+m*Math.cos(n),B=x-m*Math.sin(n),C=y-m*Math.cos(n),D="M"+z+","+A+" ",D+="L"+B+","+C+" ",D+="L"+v+","+w+" ",D+="Z ",{path:D})},b.gauge=b.canvas.path().attr({stroke:"none",fill:b.config.gaugeColor,pki:[b.config.max,b.config.min,b.config.max,b.params.widgetW,b.params.widgetH,b.params.dx,b.params.dy,b.config.gaugeWidthScale,b.config.donut,b.config.reverse]}),b.level=b.canvas.path().attr({stroke:"none",fill:getColor(b.config.value,(b.config.value-b.config.min)/(b.config.max-b.config.min),b.config.levelColors,b.config.noGradient,b.config.customSectors),pki:[b.config.min,b.config.min,b.config.max,b.params.widgetW,b.params.widgetH,b.params.dx,b.params.dy,b.config.gaugeWidthScale,b.config.donut,b.config.reverse]}),b.config.donut&&b.level.transform("r"+b.config.donutStartAngle+", "+(b.params.widgetW/2+b.params.dx)+", "+(b.params.widgetH/1.95+b.params.dy)),b.config.pointer&&(b.needle=b.canvas.path().attr({stroke:null!==b.config.pointerOptions.stroke&&void 0!==b.config.pointerOptions.stroke?b.config.pointerOptions.stroke:"none","stroke-width":null!==b.config.pointerOptions.stroke_width&&void 0!==b.config.pointerOptions.stroke_width?b.config.pointerOptions.stroke_width:0,"stroke-linecap":null!==b.config.pointerOptions.stroke_linecap&&void 0!==b.config.pointerOptions.stroke_linecap?b.config.pointerOptions.stroke_linecap:"square",fill:null!==b.config.pointerOptions.color&&void 0!==b.config.pointerOptions.color?b.config.pointerOptions.color:"#000000",ndl:[b.config.min,b.config.min,b.config.max,b.params.widgetW,b.params.widgetH,b.params.dx,b.params.dy,b.config.gaugeWidthScale,b.config.donut]}),b.config.donut&&b.needle.transform("r"+b.config.donutStartAngle+", "+(b.params.widgetW/2+b.params.dx)+", "+(b.params.widgetH/1.95+b.params.dy))),b.txtTitle=b.canvas.text(b.params.titleX,b.params.titleY,b.config.title),b.txtTitle.attr({"font-size":b.params.titleFontSize,"font-weight":"bold","font-family":b.config.titleFontFamily,fill:b.config.titleFontColor,"fill-opacity":"1"}),setDy(b.txtTitle,b.params.titleFontSize,b.params.titleY),b.txtValue=b.canvas.text(b.params.valueX,b.params.valueY,0),b.txtValue.attr({"font-size":b.params.valueFontSize,"font-weight":"bold","font-family":b.config.valueFontFamily,fill:b.config.valueFontColor,"fill-opacity":"0"}),setDy(b.txtValue,b.params.valueFontSize,b.params.valueY),b.txtLabel=b.canvas.text(b.params.labelX,b.params.labelY,b.config.label),b.txtLabel.attr({"font-size":b.params.labelFontSize,"font-weight":"normal","font-family":"Arial",fill:b.config.labelFontColor,"fill-opacity":"0"}),setDy(b.txtLabel,b.params.labelFontSize,b.params.labelY);var B=b.config.min;b.config.reverse&&(B=b.config.max),b.txtMinimum=B,b.config.humanFriendly?b.txtMinimum=humanFriendlyNumber(B,b.config.humanFriendlyDecimal):b.config.formatNumber&&(b.txtMinimum=formatNumber(B)),b.txtMin=b.canvas.text(b.params.minX,b.params.minY,b.txtMinimum),b.txtMin.attr({"font-size":b.params.minFontSize,"font-weight":"normal","font-family":"Arial",fill:b.config.labelFontColor,"fill-opacity":b.config.hideMinMax||b.config.donut?"0":"1"}),setDy(b.txtMin,b.params.minFontSize,b.params.minY);var C=b.config.max;b.config.reverse&&(C=b.config.min),b.txtMaximum=C,b.config.humanFriendly?b.txtMaximum=humanFriendlyNumber(C,b.config.humanFriendlyDecimal):b.config.formatNumber&&(b.txtMaximum=formatNumber(C)),b.txtMax=b.canvas.text(b.params.maxX,b.params.maxY,b.txtMaximum),b.txtMax.attr({"font-size":b.params.maxFontSize,"font-weight":"normal","font-family":"Arial",fill:b.config.labelFontColor,"fill-opacity":b.config.hideMinMax||b.config.donut?"0":"1"}),setDy(b.txtMax,b.params.maxFontSize,b.params.maxY);var D=b.canvas.canvas.childNodes[1],E="http://www.w3.org/2000/svg";"undefined"!==ie&&9>ie||("undefined"!==ie?onCreateElementNsReady(function(){b.generateShadow(E,D)}):b.generateShadow(E,D)),E=null,b.config.textRenderer?b.originalValue=b.config.textRenderer(b.originalValue):b.config.humanFriendly?b.originalValue=humanFriendlyNumber(b.originalValue,b.config.humanFriendlyDecimal)+b.config.symbol:b.config.formatNumber?b.originalValue=formatNumber(b.originalValue)+b.config.symbol:b.originalValue=(1*b.originalValue).toFixed(b.config.decimals)+b.config.symbol,!0===b.config.counter?(eve.on("raphael.anim.frame."+b.level.id,function(){var a=b.level.attr("pki")[0];b.config.reverse&&(a=1*b.config.max+1*b.config.min-1*b.level.attr("pki")[0]),b.config.textRenderer?b.txtValue.attr("text",b.config.textRenderer(Math.floor(a))):b.config.humanFriendly?b.txtValue.attr("text",humanFriendlyNumber(Math.floor(a),b.config.humanFriendlyDecimal)+b.config.symbol):b.config.formatNumber?b.txtValue.attr("text",formatNumber(Math.floor(a))+b.config.symbol):b.txtValue.attr("text",(1*a).toFixed(b.config.decimals)+b.config.symbol),setDy(b.txtValue,b.params.valueFontSize,b.params.valueY),a=null}),eve.on("raphael.anim.finish."+b.level.id,function(){b.txtValue.attr({text:b.originalValue}),setDy(b.txtValue,b.params.valueFontSize,b.params.valueY)})):eve.on("raphael.anim.start."+b.level.id,function(){b.txtValue.attr({text:b.originalValue}),setDy(b.txtValue,b.params.valueFontSize,b.params.valueY)});var F=b.config.value;b.config.reverse&&(F=1*b.config.max+1*b.config.min-1*b.config.value),b.level.animate({pki:[F,b.config.min,b.config.max,b.params.widgetW,b.params.widgetH,b.params.dx,b.params.dy,b.config.gaugeWidthScale,b.config.donut,b.config.reverse]},b.config.startAnimationTime,b.config.startAnimationType),b.config.pointer&&b.needle.animate({ndl:[F,b.config.min,b.config.max,b.params.widgetW,b.params.widgetH,b.params.dx,b.params.dy,b.config.gaugeWidthScale,b.config.donut]},b.config.startAnimationTime,b.config.startAnimationType),b.txtValue.animate({"fill-opacity":b.config.hideValue?"0":"1"},b.config.startAnimationTime,b.config.startAnimationType),b.txtLabel.animate({"fill-opacity":"1"},b.config.startAnimationTime,b.config.startAnimationType)},JustGage.prototype.refresh=function(a,b){var c,d,e=this,b=b||null;null!==b&&(e.config.max=b,e.txtMaximum=e.config.max,e.config.humanFriendly?e.txtMaximum=humanFriendlyNumber(e.config.max,e.config.humanFriendlyDecimal):e.config.formatNumber&&(e.txtMaximum=formatNumber(e.config.max)),e.config.reverse?(e.txtMin.attr({text:e.txtMaximum}),setDy(e.txtMin,e.params.minFontSize,e.params.minY)):(e.txtMax.attr({text:e.txtMaximum}),setDy(e.txtMax,e.params.maxFontSize,e.params.maxY))),c=a,1*a>1*e.config.max&&(a=1*e.config.max),1*a<1*e.config.min&&(a=1*e.config.min),d=getColor(a,(a-e.config.min)/(e.config.max-e.config.min),e.config.levelColors,e.config.noGradient,e.config.customSectors),c=e.config.textRenderer?e.config.textRenderer(c):e.config.humanFriendly?humanFriendlyNumber(c,e.config.humanFriendlyDecimal)+e.config.symbol:e.config.formatNumber?formatNumber((1*c).toFixed(e.config.decimals))+e.config.symbol:(1*c).toFixed(e.config.decimals)+e.config.symbol,e.originalValue=c,e.config.value=1*a,e.config.counter||(e.txtValue.attr({text:c}),setDy(e.txtValue,e.params.valueFontSize,e.params.valueY));var f=e.config.value;e.config.reverse&&(f=1*e.config.max+1*e.config.min-1*e.config.value),e.level.animate({pki:[f,e.config.min,e.config.max,e.params.widgetW,e.params.widgetH,e.params.dx,e.params.dy,e.config.gaugeWidthScale,e.config.donut,e.config.reverse],fill:d},e.config.refreshAnimationTime,e.config.refreshAnimationType),e.config.pointer&&e.needle.animate({ndl:[f,e.config.min,e.config.max,e.params.widgetW,e.params.widgetH,e.params.dx,e.params.dy,e.config.gaugeWidthScale,e.config.donut]},e.config.refreshAnimationTime,e.config.refreshAnimationType),b=null},JustGage.prototype.generateShadow=function(a,b){var c,d,e,f,g,h,i,j=this,k="inner-shadow-"+j.config.id;c=document.createElementNS(a,"filter"),c.setAttribute("id",k),b.appendChild(c),d=document.createElementNS(a,"feOffset"),d.setAttribute("dx",0),d.setAttribute("dy",j.config.shadowVerticalOffset),c.appendChild(d),e=document.createElementNS(a,"feGaussianBlur"),e.setAttribute("result","offset-blur"),e.setAttribute("stdDeviation",j.config.shadowSize),c.appendChild(e),f=document.createElementNS(a,"feComposite"),f.setAttribute("operator","out"),f.setAttribute("in","SourceGraphic"),f.setAttribute("in2","offset-blur"),f.setAttribute("result","inverse"),c.appendChild(f),g=document.createElementNS(a,"feFlood"),g.setAttribute("flood-color","black"),g.setAttribute("flood-opacity",j.config.shadowOpacity),g.setAttribute("result","color"),c.appendChild(g),h=document.createElementNS(a,"feComposite"),h.setAttribute("operator","in"),h.setAttribute("in","color"),h.setAttribute("in2","inverse"),h.setAttribute("result","shadow"),c.appendChild(h),i=document.createElementNS(a,"feComposite"),i.setAttribute("operator","over"),i.setAttribute("in","shadow"),i.setAttribute("in2","SourceGraphic"),c.appendChild(i),j.config.hideInnerShadow||(j.canvas.canvas.childNodes[2].setAttribute("filter","url(#"+k+")"),j.canvas.canvas.childNodes[3].setAttribute("filter","url(#"+k+")")),i=null};var ie=function(){for(var a=3,b=document.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e",c[0];);return a>4?a:void 0}();