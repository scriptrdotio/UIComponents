var underscore=angular.module("underscore",[]);underscore.factory("_",["$window",function(a){return a._}]),angular.module("WsClient",["ngWebSocket","ngCookies","underscore"]).provider("wsClient",function(){var a=this,b="wss://api.scriptrapps.io/",c=null,d=null,e=null,f=null,g=null,h={},i=0,j={};this.setBaseUrl=function(a){b=a},this.setPublishChannel=function(a){c=a},this.setSubscribeChannel=function(a){console.log(a),d=a},this.getSubscribeChannel=function(){return d},this.setToken=function(a){e=a};var k=function(){f=b+(e?"/"+e:"")},l=function(a){return i+=1,i>1e4&&(i=0),i},m=function(a,b){return g+"-"+(b?b+"_"+a:a)},n=function(a,b){return b?b+"_"+a:a},o=function(a,b){return g+"-"+(b?b+"_"+a:a)};this.$get=["$websocket","$cookies","$q","$rootScope","_",function(b,e,i,p,q){e.get("token")&&this.setToken(e.get("token")),k();var r=b(f),s={},t=i.defer(),u=i.defer(),v=i.defer(),w=i.defer();r.onOpen(function(){x(d)}),r.onMessage(function(a){try{var b=JSON.parse(a.data);console.log("Received message data from websocket: ",b),"connected."==b.result&&(g=b.id,t&&t.resolve()),"failure"==b.status&&"429"==b.statusCode&&(0==$("body").find(".alert-transport").length&&$("body").append('<div class="alert alert-danger alert-dismissable alert-transport" style="position: absolute; z-index: 1000; top: 0; width: 600px; left: 30%; text-align: center">You have reached you requests rate limit. For more info check the <a href="https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting" target="blank">documentation.</a><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button></div>'),console.error("You have reached your requests rate limit. For more info check the documentation. https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting")),s.data=b,z(b),A(b)}catch(b){console.log("Error when parsing message received over socket",a,b)}}),r.onClose(function(a){console.log("Socket Closed",a),v.resolve(a),"4000"==a.code||"4010"==a.code?w.resolve(a):(console.log("Trying to reconnect closed socket."),r.reconnect())}),r.onError(function(a){console.log("Socket Error",a),u.resolve()});var x=function(a){if(a)if("string"==typeof a)r.send(JSON.stringify({method:"Subscribe",params:{channel:a}}));else if("Array"==a.constructor.name)for(var b=0;b<a.length;b++)r.send(JSON.stringify({method:"Subscribe",params:{channel:a[b]}}))},y=function(a){if(a)if("string"==typeof a)r.send(JSON.stringify({method:"Unsubscribe",params:{channel:a}}));else if("Array"==a.constructor.name)for(var b=0;b<a.length;b++)r.send(JSON.stringify({method:"Unscubscribe",params:{channel:a[b]}}))},z=function(a){var b=a.id;b&&h.hasOwnProperty(b)?(console.log("Execute registered call back for received socket message.",h[b]),"failure"==a.status?p.$apply(h[b].cb.reject(a)):p.$apply(h[b].cb.resolve(a.result)),delete h[b]):console.log("No callbacks registerd for received socket message.")},A=function(a){var b=a.id;if(b&&j.hasOwnProperty("subscribeToAll")){console.log("Execute registered call back for received socket message.",j.subscribeToAll);for(var c=j.subscribeToAll,d=0;d<c.length;d++)c[d].cb(a.result)}else if(b&&j.hasOwnProperty(b)){console.log("Execute registered call back for received socket message.",j[b]);for(var c=j[b],d=0;d<c.length;d++)c[d].cb(a.result)}else console.log("No subscribers registerd for received socket message.")};return{getMessage:function(){return s},getStatus:function(){return r.readyState},subscribe:function(a,b,c){if(d){var b={time:new Date,cb:b};c&&(b.id=c),j[a]?j[a].push(b):j[a]=[b]}},unsubscribe:function(a,b,c){if(!a)return void console.log("prefix is mandatory to unsubscribe.");if(console.log("---",j[a]),d)if(!a||b||c){var e={};b&&(e.cb=b),c&&(e.id=c),j[a]=q.difference(j[a],q.where(j[a],e))}else j[a]=[];console.log("+++",j[a])},publish:function(a,b,d){var e=c;if(d&&(e=d),e){var f=i.defer(),g=l(),j=m(g,b);return h[j]={time:new Date,cb:f},a.id=j,console.log("Sending publish message",a),r.send({method:"Publish",params:{channel:e,message:JSON.stringify(a)}}),f.promise}console.log("No channel is defined, message won't be sent.",a)},call:function(a,b,c){var d=i.defer(),e={method:a,params:{body:JSON.stringify(b)}},f=l(),g=o(f,c);return h[g]={time:new Date,cb:d},e.id=n(f,c),console.log("Sending call api request over socket.",e),r.send(e),d.promise},updateSubscriptionChannel:function(b){a.getSubscribeChannel()&&y(a.getSubscribeChannel()),a.setSubscribeChannel(b),x(b)},updatePublishingChannel:function(b){a.setPublishChannel(b)},closeSocket:function(a){a?r.close(a):r.close(!1)},updateTokenAndReconnect:function(){e.get("token")&&a.setToken(e.get("token")),k(),r.url=f,r.close(),r.reconnect()},onReady:t.promise,onError:u.promise,onClose:v.promise,onInvalidAuthentication:w.promise}}]}),angular.module("HttpClient",["ngCookies"]).provider("httpClient",function(){var a="",b=null,c="",d=this;this.setBaseUrl=function(b){a=b,console.log(a)},this.setToken=function(a){b=a,console.log(b)};var e=function(b){c=a+"/"+b,console.log(c)};this.$get=["$cookies","$q","$http",function(a,f,g){a.get("token")&&(b=a.get("token"));var h=function(a,b,c){return a&&a[b]||(a||(a={}),a[b]=c),a},i=function(a,d){var i=f.defer();return e(a),d.url=c,b&&(d.headers=h(d.headers,"Authorization","Bearer "+b)),g(d).then(function(a){if(a.data&&a.data.response){var b=a.data.response;"200"==b.metadata.statusCode&&"success"==b.metadata.status?b.result&&b.result.metadata?"200"==b.result.statusCode&&"success"==b.result.status?i.resolve(b.result.result,a):i.reject(b.result.metadata,a):i.resolve(b.result,a):i.reject(b.metadata,a)}},function(a){console.log("ERROR",a),"429"==a.status&&(0==$("body").find(".alert-transport").length&&$("body").append('<div class="alert alert-danger alert-dismissable alert-transport" style="position: absolute; z-index: 1000; top: 0; width: 600px; left: 30%; text-align: center">You have reached you requests rate limit. For more info check the <a href="https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting" target="blank">documentation.</a><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button></div>'),console.error("You have reached your requests rate limit. For more info check the documentation. https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting")),a.data&&a.data.response&&a.data.response.metadata?i.reject(a.data.response.metadata):i.reject(a)}),i.promise};return{get:function(a,b){var c={method:"GET"};return c.params=b,i(a,c)},post:function(a,b,c){var d={method:"POST"};return d.data=b,c&&(d.headers=c),d.headers=h(d.headers,"Content-Type","application/json"),i(a,d)},updateToken:function(a){d.setToken(a)}}}]}),angular.module("DataService",[]).provider("dataService",function(){var a=this;this._sendRequestApi=function(a,b,c,d,e,f){var g={},h=e.apiParams?e.apiParams:{};g=e.useWindowParams&&"true"==e.useWindowParams?angular.merge(h,d.search()):angular.copy(h),"wss"==e.transport?c.onReady.then(function(){e.msgTag&&c.subscribe(e.msgTag,f,e.widgetId),e.api&&c.call(e.api,g,e.msgTag).then(function(a,b){f(a)},function(a){console.log("Reject wss call",a),f(a)})}):"https"==e.transport&&e.api&&("POST"==e.httpMethod?b.post(e.api,g).then(function(a,b){"function"==typeof f&&f(a)},function(a){"function"==typeof f&&f(a)}):b.get(e.api,g).then(function(a,b){f(a)},function(a){f(a),console.log("Reject http call",a)}))},this.$get=["$q","httpClient","wsClient","$location",function(b,c,d,e){return{scriptrRequest:function(f,g){a._sendRequestApi(b,c,d,e,f,g)}}}]}),angular.module("Display",["ComponentsCommon","DataService"]),angular.module("Display").component("scriptrDisplaycount",{bindings:{widgetLayout:"@",data:"<?",message:"@",borderSize:"@",borderColor:"@",numberFontFamily:"@",numberFontSize:"@",numberCellSize:"@",numberFontWeight:"@",numberTextColor:"@",numberBackgroundColor:"@",numberBackgroundColors:"<?",numberTextAlignment:"@",messageFontFamily:"@",messageFontSize:"@",messageFontWeight:"@",messageTextColor:"@",messageBackgroundColor:"@",messageTextAlignment:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/displayCount/displayCount.html",controller:["$scope","httpClient","wsClient","$element","$window","$timeout","$interval","$window","dataService",function(a,b,c,d,e,f,g,e,h){var i=this;i.rerenderVal=null,i.isLoading=!1,this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/display-data-bg.svg",this.hasData=null!=this.value&&""!=this.value,this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.widgetLayout="vertical"==this.widgetLayout?this.widgetLayout:"horizontal",this.borderSize=this.borderSize?this.borderSize:"1",this.numberCellSize=this.numberCellSize?this.numberCellSize:"",this.borderColor=this.borderColor?this.borderColor:"#d7d7d7",this.numberFontFamily=this.numberFontFamily?this.numberFontFamily:"Arial",this.numberFontSize=this.numberFontSize?this.numberFontSize:"42",this.numberFontWeight=this.numberFontWeight?this.numberFontWeight:"600",this.numberTextColor=this.numberTextColor?this.numberTextColor:"#ffffff",this.numberTextAlignment=this.numberTextAlignment?this.numberTextAlignment:"center",this.numberBackgroundColor=this.numberBackgroundColor?this.numberBackgroundColor:"#ff8c00",this.messageFontFamily=this.messageFontFamily?this.messageFontFamily:"Arial",this.messageFontSize=this.messageFontSize?this.messageFontSize:"18",this.messageFontWeight=this.messageFontWeight?this.messageFontWeight:"600",this.messageTextColor=this.messageTextColor?this.messageTextColor:"#686868",this.messageBackgroundColor=this.messageBackgroundColor?this.messageBackgroundColor:"white",this.messageTextAlignment=this.messageTextAlignment?this.messageTextAlignment:"center",this.rerender(),this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.fetchDataInterval=this.fetchDataInterval?parseInt(this.fetchDataInterval):null,this.style={}},this.findBackgroundColor=function(a){var b=null;"string"==typeof a.value?b=_.find(a.numberBackgroundColors,function(b){return b.value==a.value}):"number"==typeof a.value&&(b=_.find(a.numberBackgroundColors.reverse(),function(b){return a.value>=b.value})),null!=b&&(a.numberBackgroundColor=b.color)},this.rerender=function(){i.rerenderVal=!1,f(function(){i.findBackgroundColor(i),i.rerenderVal=!0},100)},this.$postLink=function(){i.timeoutId=f(i.resize.bind(i),100),angular.element(e).on("resize",i.onResize),"wss"==i.transport&&(i.api||i.msgTag)||"https"==i.transport&&i.api?j(this.transport):null!=i.data?a.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&i.consumeData(a)}):(a.$on("update-data",function(a,b){null==b?null==i.value&&(i.noResults=!0):b[i.serviceTag]?i.consumeData(b[i.serviceTag]):i.consumeData(b)}),a.$emit("waiting-for-data"))},this.onResize=function(){null!=i.timeoutId&&f.cancel(i.timeoutId),i.timeoutId=f(i.resize.bind(i),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?i.usePopover=!0:i.usePopover=!1},this.$onDestroy=function(){i.msgTag&&c.unsubscribe(i.msgTag,null,a.$id),i.refreshTimer&&g.cancel(i.refreshTimer),null!=i.timeoutId&&f.cancel(i.timeoutId),angular.element(e).off("resize",i.onResize)};var j=function(b){var c={api:i.api,transport:b,msgTag:i.msgTag,apiParams:i.apiParams,useWindowParams:i.useWindowParams,httpMethod:i.httpMethod,widgetId:a.$id};h.scriptrRequest(c,i.consumeData.bind(i)),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=g(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(i.noResults=!0,i.dataFailureMessage="Failed to fetch data.",i.value&&(i.stalledData=!0,i.dataFailureMessage="Failed to update data.")):("function"==typeof i.onFormatData()&&(a=i.onFormatData()(a,i)),null!=a?"object"==typeof a&&null!=a.value?(i.value=a.value,a.message&&(i.message=a.message),i.rerender(),i.hasData=!0,i.noResults=!1,i.stalledData=!1):(i.noResults=!0,null!=i.value&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, no data returned."):(i.noResults=!0,null!=i.value&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data."))}}]});var cachedTemplates=["$templateCache",function(a){"use strict";a.put("/UIComponents/dashboard/frontend/components/ACL/ACL.html",'<div class=acl-wrapper ng-click="$ctrl.showAccessControlList = true"><span class=acl-btn ng-class="($ctrl.users.length == 1 && $ctrl.users[0].code == \'anonymous\') ? \'unlocked\' : \'locked\'"><a ng-click=$ctrl.openModal() href=javascript:void(0); uib-tooltip={{$ctrl.accessType}} tooltip-placement=right><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAARCAYAAADZsVyDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkExOUI1NTNCNDc3MzExRTY4OEY2ODFFOTcxN0Q4QkIxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkExOUI1NTNDNDc3MzExRTY4OEY2ODFFOTcxN0Q4QkIxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTE5QjU1Mzk0NzczMTFFNjg4RjY4MUU5NzE3RDhCQjEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTE5QjU1M0E0NzczMTFFNjg4RjY4MUU5NzE3RDhCQjEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6vZpebAAAB2UlEQVR42rSUv0sCYRjH37vu0BNNdG2Qk1ocEk53F1tapdnlqECac2hIbkloFOL8F8IlwqUmQZwOsUHBIZMWRSQHFVTyeh55kzc9Ray+8OX96eee93mfVy6TyRBQCOwh2+kDbCQSiR+TAlgHn5LfKQs+Yyf4P4ASKwZP/kkCbQ2aq23koXdkCU6Cn7cER8FPq8CoS7rpiG6MbgBN1uv1fbfbTVRVXQm+Z6JOriu/Vqt1gK3L5bIPBgMVTNLp9LmmaYN+v/+IaRUscmWsq2v4obfdbl9Mp1NpPB7P51Op1N1wOCROp/MN9sgsGGF+2vdbXQjKbreL4E+EdLvd+TyOUYFAwBeLxXaEhSInTCqWVC6X8RQnDofjcBZJKGTG43ETIuR1XTebzSbX6/VIPp+/EhaK3E+hN1YRy7LsbTQaynd0kUiEwEeIJEkkHA7PwHCZ6GsWbDD9V6u6Nk1zz2az7UJ+fZPJRAQQHn221ul0OGzxIzzPGwKTX4MCo7RdfgkejwF+qFartzAM5nI5DoAIJbVabQZWFOWlWCyGBeboGwnTMBqN5uNCocCx66VSScYYODjexk+MeQT4j0hEUXyHlGjYDwaDWqVSOaZFkN0WTJiy1Gn/iF34EmAAsBK5Pr0LIbQAAAAASUVORK5CYII=" alt=restrictions> <i class="fa fa-lock acl-icon-locked red"></i> <i class="fa fa-unlock-alt acl-icon acl-icon-unlocked light-green"></i></a></span></div>'),a.put("/UIComponents/dashboard/frontend/components/dygraphs/dygraphs.html","<scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover failure-message=$ctrl.dataFailureMessage action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><div ng-if=$ctrl.datas><ng-dygraphs data=$ctrl.datas options=$ctrl.options legend=$ctrl.legend></ng-dygraphs></div>"),a.put("/UIComponents/dashboard/frontend/components/ACL/myModalContent.html",'<div class=acl-controls><div class=modal-header><h3 class=modal-title>Access Control List</h3></div><div class=modal-body><div ng-if=$ctrl.show uib-alert ng-class="\'alert-\' + ( $ctrl.message.type || \'warning\')  + \' m10\'" close=$ctrl.closeAlert() dismiss-on-timeout=5000>{{$ctrl.message.content}}</div><h5 class=text-info>List of groups and devices allowed to run the script <a href=javascript:void(0); class=text-primary uib-popover-html=$ctrl.popoverContent popover-placement=right><i class="fa fa-question-circle"></i></a></h5><div ng-show=$ctrl.showMsg class="col-xs-12 center-div alert fadeIn animated alert-info"><div class="col-xs-9 pdl0"><div class="mt8 ml10"><span>Access permission to the "anonymous" predefined group allows anyone to serve the file. Adding it to your access control list will automatically remove any other groups or devices. Are you sure you want to continue?</span></div></div><div class="col-xs-3 pdr0 text-right"><button ng-click=$ctrl.removeAnonymousAccess() type=button class="btn btn-default btn-sm mr5">No</button> <button ng-click=$ctrl.addAnonymousAccess() type=button class="btn btn-primary btn-sm">Yes</button></div></div><scriptr-autocomplete id=devicesList placeholder="Select a user/group" pause=400 hide-list=false search-fields=code default-set-object=$ctrl.defaultSetObject selected-object=$ctrl.onSelect title-field=code objects=$ctrl.users clear-selected=true description-field=description image-field=pic list-selected-object=true minlength=0 text-no-results="No results" text-searching=Searching... transport=https on-format-data=$ctrl.callback api=UIComponents/dashboard/frontend/examples/list/getDevices input-class="form-control form-control-small"></scriptr-autocomplete><div class=clearfix></div><div class="italic text-muted fnt12 mt10"><i class="fa fa-info-circle" aria-hidden=true></i><span id=permissionsNote> Note that removing scriptr device from the access control list will prevent you from serving the file from the IDE.</span></div></div><div class=modal-footer><button type=button class="btn btn-default" ng-click=$ctrl.onCancel()>Close</button> <button type=button class="btn btn-warning" ng-click=$ctrl.updateFileACL()>Save changes</button></div></div>'),a.put("/UIComponents/dashboard/frontend/components/chart/chart.html","<div style=\"position: relative\"><scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover failure-message=$ctrl.dataFailureMessage action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><div ng-if=\"$ctrl.datas.length > 0\"><div ng-if=\"$ctrl.type == 'line'\"><div class=morris-chart-wrapper ng-class=\"($ctrl.showLegend == 'true' && $ctrl.legendType != 'hover') ? 'with-legend' : ' ' \"><div style=\"height: 100%; width: 100%\" line-data=$ctrl.datas line-xkey={{$ctrl.xkey}} line-ykeys=$ctrl.ykeys line-labels=$ctrl.labels line-colors=$ctrl.colors line-line-width=$ctrl.lineWidth line-point-size=$ctrl.pointSize line-point-fill-colors=$ctrl.pointFillColors line-point-stroke-colors=$ctrl.pointStrokeColors line-ymax=$ctrl.ymax line-ymin=$ctrl.ymin line-smooth=$ctrl.smooth line-hide-hover=$ctrl.hideHover line-hover-callback=$ctrl.hoverCallback line-parse-time=$ctrl.parseTime line-units=$ctrl.units line-post-units=$ctrl.postUnits line-pre-units=$ctrl.preUnits line-line-date-format=$ctrl.dateFormat(x) line-x-labels=$ctrl.xlabels line-x-label-format=$ctrl.xlabelFormat(x) line-x-label-angle=$ctrl.xlabelAngle line-y-label-format=$ctrl.ylabelFormat(y) line-goals=$ctrl.goals line-goal-stroke-width=$ctrl.goalStrokeWidth line-goal-line-colors=$ctrl.goalLineColors line-events=$ctrl.events line-event-stroke-width=$ctrl.eventStrokeWidth line-event-line-colors=$ctrl.eventLineColors line-continuous-line=$ctrl.continuousLine line-axes=$ctrl.axes line-grid=$ctrl.grid line-grid-text-color=$ctrl.gridTextColor line-grid-text-size=$ctrl.gridTextSize , line-grid-text-family=$ctrl.gridTextFamily line-grid-text-weight=$ctrl.gridTextWeight line-fill-opacity=$ctrl.fillOpacity line-resize=$ctrl.resize line-chart></div></div><div class=morris-chart-legend ng-if=\"$ctrl.showLegend && $ctrl.legendType != 'hover'\"><div id=date_{{$ctrl.ref}}>{{$ctrl.legendDate}}</div><ul ng-repeat=\"entry in $ctrl.legendStructure\"><li><span><i class=\"fa fa-square\" ng-style=\"{ 'color' : '{{entry.color}}'}\"></i> {{entry.label}}</span> <span ng-style=\"{ 'color' : '{{entry.color}}'}\" id=value_{{$index}}_{{$ctrl.ref}}>{{entry.value}}</span></li></ul></div></div><div ng-if=\"$ctrl.type == 'bar'\"><div class=morris-chart-wrapper ng-class=\"($ctrl.showLegend == 'true' && $ctrl.legendType != 'hover') ? 'with-legend' : ' ' \"><div style=\"height: 100%; width: 100%\" bar-data=$ctrl.datas bar-x={{$ctrl.xkey}} bar-y=$ctrl.ykeys bar-labels=$ctrl.labels bar-colors=$ctrl.colors bar-resize=$ctrl.resize bar-stacked=$ctrl.stacked bar-hide-hover=$ctrl.hideHover bar-hover-callback=$ctrl.hoverCallback bar-grid=$ctrl.grid bar-grid-text-color=$ctrl.gridTextColor bar-grid-text-size=$ctrl.gridTextSize , bar-grid-text-family=$ctrl.gridTextFamily bar-grid-text-weight=$ctrl.gridTextWeight bar-axes=$ctrl.axes bar-ymax=$ctrl.ymax bar-ymin=$ctrl.ymin bar-goals=$ctrl.goals bar-goal-stroke-width=$ctrl.goalStrokeWidth bar-goal-line-colors=$ctrl.goalLineColors bar-x-label-angle=$ctrl.xlabelAngle bar-y-label-format=$ctrl.ylabelFormat(y) bar-parse-time=$ctrl.parseTime bar-events=$ctrl.events bar-event-stroke-width=$ctrl.eventStrokeWidth bar-event-line-colors=$ctrl.eventLineColors bar-post-units=$ctrl.postUnits bar-pre-units=$ctrl.preUnits bar-chart></div></div><div class=morris-chart-legend ng-if=\"$ctrl.showLegend && $ctrl.legendType != 'hover'\"><div id=date_{{$ctrl.ref}}>{{$ctrl.legendDate}}</div><ul ng-repeat=\"entry in $ctrl.legendStructure\"><li><span><i class=\"fa fa-square\" ng-style=\"{ 'color' : '{{entry.color}}'}\"></i> {{entry.label}}</span> <span ng-style=\"{ 'color' : '{{entry.color}}'}\" id=value_{{$index}}_{{$ctrl.ref}}>{{entry.value}}</span></li></ul></div></div><div ng-if=\"$ctrl.type == 'area'\"><div class=morris-chart-wrapper ng-class=\"($ctrl.showLegend == 'true' && $ctrl.legendType != 'hover') ? 'with-legend' : ' ' \"><div style=\"height: 100%; width: 100%\" area-chart line-colors=$ctrl.colors area-data=$ctrl.datas area-xkey={{$ctrl.xkey}} area-ykeys=$ctrl.ykeys area-labels=$ctrl.labels area-line-width=$ctrl.lineWidth area-point-size=$ctrl.pointSize area-point-fill-colors=$ctrl.pointFillColors area-point-stroke-colors=$ctrl.pointStrokeColors area-ymax=$ctrl.ymax area-ymin=$ctrl.ymin area-smooth=$ctrl.smooth area-hide-hover=$ctrl.hideHover area-hover-callback=\"$ctrl.hoverCallback(index, options, content, row)\" area-parse-time=$ctrl.parseTime area-units=$ctrl.units area-post-units=$ctrl.postUnits area-pre-units=$ctrl.preUnits area-area-date-format=$ctrl.dateFormat(x) area-x-labels=$ctrl.xlabels area-x-label-format=$ctrl.xlabelFormat(x) area-x-label-angle=$ctrl.xlabelAngle area-y-label-format=$ctrl.ylabelFormat(y) area-goals=$ctrl.goals area-goal-stroke-width=$ctrl.goalStrokeWidth area-goal-line-colors=$ctrl.goalLineColors area-events=$ctrl.events area-event-stroke-width=$ctrl.eventStrokeWidth area-event-line-colors=$ctrl.eventLineColors area-continuous-line=$ctrl.continuousLine area-axes=$ctrl.axes area-grid=$ctrl.grid area-grid-text-color=$ctrl.gridTextColor area-grid-text-size=$ctrl.gridTextSize , area-grid-text-family=$ctrl.gridTextFamily area-grid-text-weight=$ctrl.gridTextWeight area-fill-opacity=$ctrl.fillOpacity area-resize=$ctrl.resize area-behave-like-line=$ctrl.behaveLikeLine></div></div><div class=morris-chart-legend ng-if=\"$ctrl.showLegend && $ctrl.legendType != 'hover'\"><div id=date_{{$ctrl.ref}}>{{$ctrl.legendDate}}</div><ul ng-repeat=\"entry in $ctrl.legendStructure\"><li><span><i class=\"fa fa-square\" ng-style=\"{ 'color' : '{{entry.color}}'}\"></i> {{entry.label}}</span> <span ng-style=\"{ 'color' : '{{entry.color}}'}\" id=value_{{$index}}_{{$ctrl.ref}}>{{entry.value}}</span></li></ul></div></div><div ng-if=\"$ctrl.type == 'donut'\" style=\"height: 100%; width: 100%\" donut-data=$ctrl.datas donut-label-color=$ctrl.labelColor donut-background-color=$ctrl.backgroundColor donut-colors=$ctrl.colors donut-formatter=$ctrl.donutFormatter(y,data) donut-resize=$ctrl.resize donut-chart></div></div></div>"),a.put("/UIComponents/dashboard/frontend/components/gauge/gauge.html",'<scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover failure-message=$ctrl.dataFailureMessage action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><div style="width: {{$ctrl.width}}%; height: {{$ctrl.height}}{{$ctrl.heightUnit}}" class=gauge ng-if=$ctrl.gaugeValue><div value={{$ctrl.gaugeValue}} value-font-color={{$ctrl.valueFontColor}} min={{$ctrl.min}} max={{$ctrl.max}} hide-min-max={{$ctrl.hideMinMax}} hide-value={{$ctrl.hideValue}} show-inner-shadow={{$ctrl.showInnerShadow}} gauge-color={{$ctrl.gaugeColor}} shadow-opacity={{$ctrl.shadowOpacity}} shadow-size={{$ctrl.shadowSize}} custom-sectors={{$ctrl.customSectors}} label={{$ctrl.label}} label-font-color={{$ctrl.labelFontColor}} start-animation-type={{$ctrl.startAnimationType}} refresh-animation-type={{$ctrl.refreshAnimationType}} counter={{$ctrl.counter}} value-font-family={{$ctrl.valueFontFamily}} relative-gauge-size={{$ctrl.relativeGaugeSize}} value-min-font-size={{$ctrl.valueMinFontSize}} label-min-font-size={{$ctrl.labelMinFontSize}} min-label-min-font-size={{$ctrl.minLabelMinFontSize}} max-label-min-font-size={{$ctrl.maxLabelMinFontSize}} gauge-width-scale={{$ctrl.gaugeWidthScale}} shadow-vertical-offset={{$ctrl.shadowVerticalOffset}} level-colors={{$ctrl.levelColors}} no-gradient={{$ctrl.noGradient}} start-animation-time={{$ctrl.startAnimationTime}} refresh-animation-time={{$ctrl.refreshAnimationTime}} donut={{$ctrl.donut}} donut-start-angle={{$ctrl.donutStartAngle}} reverse={{$ctrl.reverse}} decimals={{$ctrl.decimals}} symbol={{$ctrl.symbol}} format-number={{$ctrl.formatNumber}} human-friendly={{$ctrl.humanFriendly}} human-friendly-decimal={{$ctrl.humanFriendlyDecimal}} on-animation-end={{$ctrl.onAnimationEnd}} pointer={{$ctrl.pointer}} justgage></div></div>'),a.put("/UIComponents/dashboard/frontend/components/grid/grid.html",'<div class=filter-bar><div class={{$ctrl.class}}><form><div ng-show="$ctrl.enableClientSideFilter && $ctrl.mode == \'normal\'" class="form-group col-xs-12 col-sm-6"><div class=form-group><input class=form-control ng-change=$ctrl.onFilterChanged() ng-model=$ctrl.quickFilterValue placeholder="Client filter"></div></div><div ng-show="$ctrl.enableServerSideFilter && $ctrl.mode == \'infinite\'" class="form-group col-xs-12 col-sm-6"><div class=form-group><input class=form-control ng-change=$ctrl.onServerFilterChanged() ng-model=$ctrl.serverFilterText placeholder="Server filter"></div></div><div class="col-xs-12 col-sm-6 pull-right text-right"><button ng-hide={{$ctrl.enableDeleteRow}} ng-click=$ctrl.openConfirmationPopUp() class="btn btn-default mt4" tooltip-placement=left uib-tooltip="Delete selected row"><i class="fa fa-close" aria-hidden=true></i></button> <button ng-hide={{$ctrl.enableAddRow}} ng-click=$ctrl.onAddRow() class="btn btn-warning mt4" tooltip-placement=bottom uib-tooltip="Insert row"><i class="fa fa-plus" aria-hidden=true></i></button></div></form></div></div><div class=col-xs-12 ng-show=$ctrl.showError><div class=alert ng-class="\'alert-\' + ( $ctrl.message.type || \'warning\')">{{$ctrl.message.content}}</div></div><div class=clearfix></div><div class=col-xs-12><div ag-grid=$ctrl.gridOptions class=ag-bootstrap ng-style=$ctrl.style></div></div>'),a.put("/UIComponents/dashboard/frontend/components/grid/popup.html",'<div class=modal-header><h3 class=modal-title>Delete</h3></div><div class=modal-body>Are you sure you want to delete the selected row(s)?</div><div class=modal-footer><button class="btn btn-warning" type=button ng-click=$ctrl.onCancel()>No</button> <button class="btn btn-warning" type=button ng-click=$ctrl.onSubmit()>Yes</button></div>'),a.put("/UIComponents/dashboard/frontend/components/list/autocomplete.html",'<div><span ng-show=$ctrl.showList ng-hide=$ctrl.hideObjects class=script-wrap ng-if=$ctrl.listSelectedObject ng-repeat="obj in $ctrl.objects track by $index"><span style="position: relative"><span class=script-text uib-tooltip={{obj[$ctrl.titleField]}} tooltip-placement=bottom><i class="mr5 text-primary {{obj.icon}}"></i> {{obj[$ctrl.titleField]}}</span> <a ng-if="obj[$ctrl.titleField] != \'nobody\'" href=javascript:void(0); ng-click=$ctrl.addObjectToList(obj) uib-tooltip=Remove tooltip-placement=right><i class="fa fa-close"></i></a></span></span><div class=clearfix></div><div class="text-center loading" ng-show=!$ctrl.showList><i class="fa fa-spinner fa-spin fa-3x"></i></div><angucomplete-alt ng-show=$ctrl.showList id={{$ctrl.id}} placeholder={{$ctrl.placeholder}} default-set-object=$ctrl.defaultSetObject pause={{$ctrl.pause}} hide-objects=$ctrl.hideObjects list-selected-object=$ctrl.listSelectedObject objects=$ctrl.objects selected-object=$ctrl.selectedObject local-data=$ctrl.localData image-field={{$ctrl.imageField}} search-fields={{$ctrl.searchFields}} title-field={{$ctrl.titleField}} description-field={{$ctrl.descriptionField}} image-field={{$ctrl.imageField}} minlength={{$ctrl.minlength}} input-class={{$ctrl.inputClass}} match-class={{$ctrl.matchClass}} maxlength={{$ctrl.maxlength}} selected-object-data=$ctrl.selectedObjectData input-name={{$ctrl.inputName}} clear-selected={{$ctrl.clearSelected}} override-suggestions={{$ctrl.overrideSuggestions}} field-required=$ctrl.fieldRequired field-required-class={{$ctrl.fieldRequiredClass}} initial-value=$ctrl.initialValue input-changed=$ctrl.inputChanged auto-match=$ctrl.autoMatch focus-in=$ctrl.focusIn focus-out=$ctrl.focusOut disable-input=$ctrl.disableInput focus-first=$ctrl.focusFirst field-tabindex={{$ctrl.fieldTabindex}} text-searching={{$ctrl.textSearching}} text-no-results={{$ctrl.textNoResults}}></div>'),
a.put("/UIComponents/dashboard/frontend/components/map/map.html",'<div style="height: 90%"><section class=map-wrap ng-if="$ctrl.clusteredView == true && $ctrl.showDetailedMap == false"><ng-map id="{{\'clustered-\'+$ctrl.$wdgid}}" on-zoom_changed=$ctrl.onClusteredZoomChanged(); single-info-window=true zoom-to-inlude-markers=true center="{{$ctrl.mapcenter || $ctrl.defaultCenter}}" zoom={{$ctrl.clusterZoom}}><drawing-manager ng-if="$ctrl.geofenceManager == true" on-overlaycomplete=$ctrl.onMapOverlayCompleted() drawing-control-options={{$ctrl.drawingOptions}} drawingcontrol={{$ctrl.drawingControl}} drawingmode=null rectangleoptions={{$ctrl.overlaySettings}} polygonoptions={{$ctrl.overlaySettings}} circleoptions={{$ctrl.overlaySettings}}></drawing-manager></ng-map><div class=messages ng-show="$ctrl.drawingMessages != null"><div class="alert alert-warning">{{$ctrl.drawingMessages}}</div></div><div class=heatmap ng-if="$ctrl.heatmap == true"><h5>Enable Heatmap</h5><span><scriptr-toggle-switch resize=false on-switch-change=$ctrl.activateHeatMap switch-status=$ctrl.switchStatus class="switch-success switch-small"></scriptr-toggle-switch></span></div></section><section class=map-wrap ng-if="$ctrl.clusteredView == false || $ctrl.showDetailedMap == true"><ng-map id="{{\'detailed-\'+$ctrl.$wdgid}}" on-zoom_changed=$ctrl.onDetailedZoomChanged(); single-info-window=true zoom-to-inlude-markers=true center="{{$ctrl.mapcenter || $ctrl.defaultcenter}}" zoom={{$ctrl.detailedmapzoom}}><drawing-manager ng-if="$ctrl.geofenceManager == true" on-overlaycomplete=$ctrl.onMapOverlayCompleted() drawing-control-options={{$ctrl.drawingOptions}} drawingcontrol={{$ctrl.drawingControl}} drawingmode=null rectangleoptions={{$ctrl.overlaySettings}} polygonoptions={{$ctrl.overlaySettings}} circleoptions={{$ctrl.overlaySettings}}></drawing-manager><div><div ng-repeat="(key, asset) in $ctrl.displayedAssets"><shape name=polyline path={{asset.path}} stroke-color={{asset.pathColor}} stroke-opacity={{asset.strokeOpacity}} stroke-width={{asset.strokeWeight}} icons={{asset.pathIcon}}></shape><div ng-repeat="marker in asset.markers track by $index"><div ng-if="$ctrl.trackedAsset == null"><marker position={{marker.position}} title={{marker.display}} animation={{marker.animation}} icon={{marker.icon}} data={{marker.assetKey}} on-click="$ctrl.showAssetInfo(event, marker, \'{{marker.assetKey}}\', \'{{marker.tripKey}}\', \'{{marker.id}}\')"></marker></div><div ng-if="$ctrl.trackedAsset !=null"><marker position={{marker.position}} title={{marker.title}} animation={{marker.animation}} icon={{marker.icon}} clickable=false></marker></div></div></div></div><div ng-if="$ctrl.markerInfoWindow == true"><div ng-transclude></div><info-window id="{{\'infoWindowTemplate_default_\'+$ctrl.$wdgid}}"><div ng-non-bindable=""><table class="table table-bordered"><thead><tr><th ng-repeat="(key, value) in marker.details">{{key}}</th></tr></thead><tbody><tr><td ng-repeat="(key, value) in marker.details">{{value.value || "N/A"}}</td></tr></tbody></table></div></info-window></div></ng-map><div class=messages ng-show="$ctrl.drawingMessages != null"><div class="alert alert-warning">{{$ctrl.drawingMessages}}</div></div><div class=heatmap ng-if="$ctrl.heatmap == true"><h5>Enable Heatmap</h5><span><scriptr-toggle-switch resize=false on-switch-change=$ctrl.activateHeatMap switch-status=$ctrl.switchStatus class="switch-success switch-small"></scriptr-toggle-switch></span></div></section><div><div ng-if="$ctrl.geofenceManager == true" class=drawingmanager-buttons><span><a ng-click=$ctrl.hideShowGeofences() title="Hide all geofences"><i class=fa ng-class=\'{"fa-eye-slash":  $ctrl.geofencesVisible, "fa-eye": !$ctrl.geofencesVisible }\' aria-hidden=true></i> </a></span><span><a ng-click=$ctrl.clearAllGeofences() title="Erase all geofences"><i class="fa fa-eraser" aria-hidden=true></i></a></span></div><div ng-if="$ctrl.geofenceManager == true" class=drawingmanager-action-buttons><button class="btn btn-primary btn-sm btn-block" ng-click=$ctrl.saveAllGeofences() data-toggle=tooltip title="Save all geofences">Save</button></div></div></div><div class=geofence-menu><a title="Configure this widget" ng-click=$ctrl.editSelectedGeofenceSettings()><i class="glyphicon glyphicon-pencil"></i> </a><a title="Remove this widget" ng-click=$ctrl.removeSelectedGeofence()><i class="glyphicon glyphicon-trash"></i></a></div>'),a.put("/UIComponents/dashboard/frontend/components/progressBar/progressBar.html",'<uib-progressbar ng-if=!$ctrl.stacked value=$ctrl.value title={{$ctrl.title}} max=$ctrl.max animate=$ctrl.animate type={{$ctrl.type}} class={{$ctrl.class}}></uib-progressbar><uib-progress ng-if=$ctrl.stacked class={{$ctrl.class}}><uib-bar ng-repeat="bar in $ctrl.stacked track by $index" value=bar.value title={{bar.title}} type={{bar.type}}>{{bar.value}}%</uib-bar></uib-progress>'),a.put("/UIComponents/dashboard/frontend/components/thermometer/thermometer.html","<div><scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover failure-message=$ctrl.dataFailureMessage action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><div ng-style=$ctrl.style class=thermowrapper ng-if=$ctrl.value><tg-thermometer-vertical value={{$ctrl.value}} unit={{$ctrl.thermoUnit}} percent={{$ctrl.percent}} sectors=$ctrl.sectors ticks=$ctrl.ticks height={{$ctrl.height}} mercury-color=$ctrl.mercuryColor></tg-thermometer-vertical></div></div>"),a.put("/UIComponents/dashboard/frontend/components/thermometer/tg_thermometer_vertical.html",'<div style="height: 90%" class=tg-thermometer style=display:none><div class=draw-a></div><div class=draw-b><div style="width: 6px;position: absolute;\n            left: 0;\n            right: 0;\n            width: 10px;\n            top: 0;\n            margin: auto;\n            height: 20px;\n            border-radius: 10px 10px 0 0;background-color: {{mercuryColor}}"></div><div style="width: 14px;height: 14px; position: absolute;\n            left: 0;\n            right: 0;\n            top: 0;\n            bottom: 0;\n            margin: auto;\n            width: 24px;\n            height: 24px;\n            border-radius: 50%; background-color: {{mercuryColor}}"></div></div><div class=meter><div class=statistics><div class=percent style="bottom: calc({{val.percent}}% - 2px)" ng-repeat="val in ticks track by $index">{{val.tick}}{{unit}}</div></div><div style="height: {{percent}}%; background-color: {{mercuryColor}}" class=mercury><div class=percent-current>{{value}}{{unit}}</div><div class=mask><div class=bg-color style="height: calc({{height}}% - 57px); background: {{mercuryColor}}"></div></div></div></div></div>'),a.put("/UIComponents/dashboard/frontend/components/odometer/odometer.html","<scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover failure-message=$ctrl.dataFailureMessage action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><div ng-style=$ctrl.style ng-if=$ctrl.odometerValue><span odometer=$ctrl.odometerValue odometer-options=$ctrl.odometerOptions></span></div>"),a.put("/UIComponents/dashboard/frontend/components/searchBox/searchBox.html",'<div class=row><div class="col-xs-12 col-md-8"><input class="form-control input-sm" ng-keyup="$event.keyCode == 13 ? $ctrl.onFilterChanged() : null" ng-model=$ctrl.searchValue placeholder={{$ctrl.searchText}}></div><div class="col-xs-12 col-md-4"><button ng-click=$ctrl.onFilterChanged() class="btn btn-primary btn-sm btn-block">Go</button></div><div ng-show=$ctrl.noResults class="col-xs-12 alert"><span class="alert alert-danger col-xs-12">no results</span></div></div><div><div class="text-center loading" ng-show=$ctrl.searching><i class="fa fa-spinner fa-spin fa-2x"></i></div><abn-tree tree-data=$ctrl.treeData tree-control=$ctrl.treeControl icon-leaf={{$ctrl.iconLeaf}} icon-expand={{$ctrl.iconExpand}} icon-collapse={{$ctrl.iconCollapse}} on-select=$ctrl.onSelect(branch) expand-level=$ctrl.expandLevel initial-selection=$ctrl.initialSelection></abn-tree></div>'),a.put("/UIComponents/dashboard/frontend/components/speedometer/speedometer.html","<scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover failure-message=$ctrl.dataFailureMessage action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><div class=speedometer-wrapper></div>"),a.put("/UIComponents/dashboard/frontend/components/accelerometer/accelerometer.html","<scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover failure-message=$ctrl.dataFailureMessage action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><div class=accelerometer-wrapper ng-if=\"$ctrl.xLine && $ctrl.yLine && $ctrl.angle\"><div class=\"line y\" ng-style=\"{ 'transform' :  $ctrl.yLine, 'border': '1px solid blue' }\"></div><div class=line ng-style=\"{ 'transform':  $ctrl.xLine}\"></div><div class=angle ng-style=\"{ 'transform':  $ctrl.angle }\"></div><div class=guideX></div><div class=guideY></div></div>"),a.put("/UIComponents/dashboard/frontend/components/button/button.html",'<scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover failure-message=$ctrl.dataFailureMessage action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><div ng-style=$ctrl.style ng-if=$ctrl.label><button ng-if=$ctrl.isDisabled disabled class="{{$ctrl.class}} is-disabled ui-button" ng-click=$ctrl.click() promise-btn=$ctrl.successPromise>{{$ctrl.label}}</button> <button ng-if=!$ctrl.isDisabled class="{{$ctrl.class}} ui-button" ng-click=$ctrl.click() promise-btn=$ctrl.successPromise>{{$ctrl.label}}</button></div>'),a.put("/UIComponents/dashboard/frontend/components/slider/slider.html","<scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover failure-message=$ctrl.dataFailureMessage action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><div ng-if=$ctrl.max ng-style=$ctrl.style class=slider><rzslider class={{$ctrl.theme}} rz-slider-model=$ctrl.min rz-slider-high=$ctrl.max rz-slider-options=$ctrl.options></rzslider></div><div ng-if=!$ctrl.max ng-style=$ctrl.style class=slider><rzslider class={{$ctrl.theme}} rz-slider-model=$ctrl.min rz-slider-options=$ctrl.options></rzslider></div>"),a.put("/UIComponents/dashboard/frontend/components/IFrame/IFrame.html",'<iframe style="height: 90%; width: 100%" ng-if=$ctrl.link src={{$ctrl.trustSrc($ctrl.link)}} frameborder=0 allowfullscreen></iframe><h3 ng-if=!$ctrl.link>No URL set</h3>'),a.put("/UIComponents/dashboard/frontend/components/toggleSwitch/toggle_switch.html",'<scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover data-failure-message=$ctrl.data-failure-message action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><div ng-click=$ctrl.publishData() ng-style=$ctrl.style ng-if="$ctrl.switchStatus === false || $ctrl.switchStatus === true"><toggle-switch ng-model=$ctrl.switchStatus on-label={{$ctrl.onLabel}} off-label={{$ctrl.offLabel}} knob-label={{$ctrl.knobLabel}} is-disabled=$ctrl.isDisabled class={{$ctrl.class}}></toggle-switch></div>'),a.put("/UIComponents/dashboard/frontend/components/plotly/3dsurface.html","<div class=surface><scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover failure-message=$ctrl.dataFailureMessage action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><angular-plotly plotly-data=$ctrl.transformedData plotly-options=$ctrl.options plotly-layout=$ctrl.layout></angular-plotly></div>"),a.put("/UIComponents/dashboard/frontend/components/plotly/windrose.html",'<div class=wind-rose><scriptr-notifications icon=$ctrl.icon has-data=$ctrl.hasData no-results=$ctrl.noResults stalled-data=$ctrl.stalledData use-popover=$ctrl.usePopover failure-message=$ctrl.dataFailureMessage action-message=$ctrl.actionMessage action-success=$ctrl.actionSuccess></scriptr-notifications><div ng-show="$ctrl.transformedData.length > 0" ng-style=$ctrl.style class=plotly-chart-wrapper ng-class="($ctrl.showLegend) ? \'with-legend\' : \' \' "><div class=plotly-chart-dimension><angular-plotly plotly-data=$ctrl.transformedData plotly-options=$ctrl.options plotly-layout=$ctrl.layout></angular-plotly></div></div><div class=plotly-chart-legend ng-if="$ctrl.showLegend && $ctrl.transformedData.length > 0"><ul ng-repeat="entry in $ctrl.plotCustomRanges" style="list-style: none"><li><span><i class="fa fa-square" style="color: {{entry.color}}"></i> {{entry.lo}} - {{entry.hi}} {{$ctrl.speedUnit}}</span></li></ul></div></div>'),a.put("/UIComponents/dashboard/frontend/components/metricBox/metricBox.html","<div class=metric-box ng-style=\"{ 'border' : '{{$ctrl.borderSize}}px solid {{$ctrl.borderColor}}','background' : '{{$ctrl.backgroundColor}}' }\"><div ng-if=$ctrl.disabled id=disabledOverlay></div><div class=metric-box-head><div class=metric-box-action><img ng-if='$ctrl.actionIcon!=\"\"' ng-click=actionClicked() alt=EI src={{$ctrl.actionIcon}}></div><div class=metric-box-label ng-style=\"{\t'font-weight' : '{{$ctrl.labelFontWeight}}', 'font-family' : '{{$ctrl.labelFontFamily}}', 'color' : '{{$ctrl.labelTextColor}}', 'text-align' : '{{$ctrl.labelTextAlignment}}' }\">{{$ctrl.label}}</div></div><div class=metric-box-body><div class=metric-box-value-unit><div class=metric-box-value ng-style=\"{\t'font-weight' : '{{$ctrl.valueFontWeight}}', 'font-family' : '{{$ctrl.valueFontFamily}}', 'color' : '{{$ctrl.valueTextColor}}', 'text-align' : '{{$ctrl.valueTextAlignment}}' }\"><div>{{$ctrl.value}}</div></div><div class=metric-box-unit ng-style=\"{ 'font-weight' : '{{$ctrl.unitFontWeight}}', 'font-family' : '{{$ctrl.unitFontFamily}}', 'color' : '{{$ctrl.unitTextColor}}', 'text-align' : '{{$ctrl.unitTextAlignment}}' }\"><div>{{$ctrl.unit}}</div></div></div><div ng-if='$ctrl.icon!=\"\"' class=metric-box-icon><img alt=EI src={{$ctrl.icon}}></div></div></div>"),a.put("/UIComponents/dashboard/frontend/components/common/notifications.html",'<div class="data-notification center" ng-hide="$ctrl.hasData || $ctrl.noResults"><i class="fa fa-spinner fa-spin fa-1x"></i><div ng-if=!$ctrl.usePopover>Waiting for data</div></div><div class=data-notification ng-if="!$ctrl.usePopover && $ctrl.noResults" ng-class="{\'center\': !$ctrl.stalledData, \'bottom\': $ctrl.stalledData}"><div uib-alert ng-class="{\'alert-warning\': $ctrl.stalledData, \'alert-danger\': !$ctrl.stalledData}"><i class="fa fa-exclamation-triangle fa-1x"></i>{{$ctrl.failureMessage || \'Failed to fetch data or no data available.\'}}</div></div><div class="data-notification bottom" ng-if="$ctrl.usePopover && $ctrl.noResults" ng-class="{\'danger\': ($ctrl.noResults && !$ctrl.stalledData), \'warning\': $ctrl.stalledData}" ng-init="$ctrl.popClass = (($ctrl.noResults && !$ctrl.stalledData) ? \'data-notification-popup alert alert-danger\' : (($ctrl.stalledData) ? \'data-notification-popup alert alert-warning\' : \'data-notification-popup alert alert-info\'))"><div uib-popover="{{$ctrl.failureMessage || \'Failed to fetch data or no data available.\'}}" popover-placement="auto right" popover-append-to-body=true popover-class={{$ctrl.popClass}} popover-trigger="\'outsideClick\'"><i class="fa fa-exclamation-triangle fa-1x"></i></div></div><div ng-if="$ctrl.actionMessage && $ctrl.usePopover" class="data-notification action alert" ng-class="{\'alert-success\': $ctrl.actionSuccess, \'alert-danger\':  !$ctrl.actionSuccess}" ng-init="$ctrl.popClass = (($ctrl.noResults && !$ctrl.stalledData) ? \'data-notification-popup alert alert-danger\' : (($ctrl.actionSuccess) ? \'data-notification-popup alert alert-success\' : \'data-notification-popup alert alert-danger\'))"><div uib-popover={{$ctrl.actionMessage}} popover-placement="auto top" popover-append-to-body=true popover-class={{$ctrl.popClass}} popover-trigger="\'outsideClick\'"><div class=center-icon><i class="fa fa-times fa-1x" ng-if=!$ctrl.actionSuccess></i> <i class="fa fa-check fa-1x" ng-if=$ctrl.actionSuccess></i></div></div></div><div ng-if="$ctrl.actionMessage && !$ctrl.usePopover" class="data-notification action"><div uib-alert ng-class="{\'alert-success\': $ctrl.actionSuccess, \'alert-danger\':  !$ctrl.actionSuccess}">{{$ctrl.actionMessage}}</div></div><div class=greyout ng-hide=$ctrl.hasData><img ng-src={{$ctrl.icon}}></div>'),a.put("/UIComponents/dashboardBuilder/view/dashboard.html","<dashboard load-tree=true tree-search-criteria=model.Car devices-model=modules/devicemodels/api/getSensors></dashboard>"),a.put("/UIComponents/dashboardBuilder/view/dashboardTemplate.min","<script type=text/x-handlebars-template id=handlebar-template>&lt;html ng-app=&quot;myApp&quot;&gt;\n&lt;head&gt;\n\n    &lt;link rel=&quot;icon&quot; href=&quot;data:;base64,iVBORw0KGgo=&quot;&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&quot; integrity=&quot;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&quot; crossorigin=&quot;anonymous&quot;&gt;\n    &lt;script src=&quot;//use.fontawesome.com/3d61d6959e.js&quot;&gt;&lt;/script&gt;\n\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;/UIComponents/build/css/UIComponents/dt_components.min.css&quot;&gt;\n    \n    &lt;!-- JQUERY Material  To use jQuery, simply ensure it is loaded before the angular.js file. --&gt;\n    &lt;script src=&quot;/UIComponents/build/js/external_jquery_resources.min.js&quot;&gt;&lt;/script&gt;\n    \n  \n    &lt;!-- Libraries --&gt;\n    &lt;script src=&quot;/UIComponents/build/js/dt_external_libraries1.min.js&quot;&gt;&lt;/script&gt;\t\n    &lt;script src=&quot;/UIComponents/build/js/dt_external_libraries2.min.js&quot;&gt;&lt;/script&gt;\t\n    \n    &lt;!-- Plotly is very huge lib and unpackageable  --&gt;\n    &lt;script src=&quot;https://cdn.plot.ly/plotly-latest.min.js&quot;&gt;&lt;/script&gt;\t\n    \n    \n    &lt;script src=&quot;//maps.google.com/maps/api/js?key=AIzaSyBcPYghFh_BXz4dDz-TXTHbU2iV3Wbf57I&amp;libraries=drawing,visualization&quot;&gt;&lt;/script&gt;\n  \n    &lt;!-- NG material --&gt;\n    &lt;script src=&quot;/UIComponents/build/js/angular_resources_1.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;/UIComponents/build/js/angular_resources_2.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;/UIComponents/build/js/angular_resources_3.min.js&quot;&gt;&lt;/script&gt;\n  \n    &lt;!-- Directives --&gt;\n    &lt;script src=&quot;/UIComponents/build/js/directives_1.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;/UIComponents/build/js/directives_2.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;//cdnjs.cloudflare.com/ajax/libs/ag-grid/12.0.0/ag-grid.js?ignore=notused36&quot;&gt;&lt;/script&gt;\n    \n\n  \n    &lt;!-- Components --&gt;\n    &lt;script src=&quot;/UIComponents/build/js/UIComponents/Components.min.js&quot;&gt;&lt;/script&gt;\n    \n    &lt;!-- Thermometer cusing error , solve it with redefine the widget --&gt;\n    &lt;script src=&quot;/UIComponents/dashboard/frontend/components/thermometer/thermometer.js&quot;&gt;&lt;/script&gt;\n    \n    \n    &lt;!-- Theme --&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;/UIComponents/dashboardBuilder/css/{{dashboardSettings.theme}}.css&quot;&gt;\n    \n\n&lt;/head&gt; \n  \n  \n&lt;style&gt;\n  {{compiledCss}}\n&lt;/style&gt;\n&lt;style&gt;\n  {{dashboardSettings.inline-style}}\n&lt;/style&gt;\n\n&lt;script&gt;\n\n(function() {\n\t\n  if(&quot;{{{dashboardSettings.requiresLogin}}}&quot; == &quot;Yes&quot;){\n  \n   var scriptName = window.location.pathname.substring(1,window.location.pathname.length )\n   var loginTemplateTarget =&quot;/UIComponents/dashboardBuilder/loginTemplate.html?redirectTarget=&quot;+scriptName+&quot;&amp;anon_token={{{anon_token}}}&quot;\n\n    var authorization  = $.scriptr.authorization(\n        {\n          onTokenValid: function(){ }, \n          loginPage: loginTemplateTarget\n        }\n      );\n    }\n  \n  \n   $.urlParam = function(name){\n\t     var results = new RegExp('[\\?&amp;]' + name + '=([^&amp;#]*)').exec(window.location.href);\n\t     if (results==null){\n\t         return null;\n\t     }else{\n\t         return results[1] || 0;\n\t     }\n\t}\n\n\t$.getUrlVars = function() {\n\t\tvar vars = [], hash;\n\t\tvar hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&amp;');\n\t\tfor(var i = 0; i &lt; hashes.length; i++)\n\t\t{\n\t\t\thash = hashes[i].split('=');\n\t\t\tvars.push(hash[0]);\n\t\t\tvars[hash[0]] = hash[1];\n\t\t}\n\t\treturn vars;\n\t}\n    \n    var underscore = angular.module('underscore', []);\n\t\tunderscore.factory('_', ['$window', function($window) {\t\t\n  \t\treturn $window._; // assumes underscore has already been loaded on the page\t\t\n\t}]);\n    \n\n    var wssConfig = [&quot;wsClientProvider&quot;,function (wsClientProvider) {\n   \t \twsClientProvider.setBaseUrl(&quot;wss://&quot; + window.location.host + &quot;/&quot;);   \t \n        wsClientProvider.setToken($.urlParam(&quot;auth_token&quot;));\n        wsClientProvider.setPublishChannel(&quot;{{{dashboardSettings.publishChannel}}}&quot;);\n        wsClientProvider.setSubscribeChannel(&quot;{{{dashboardSettings.subscribeChannel}}}&quot;);\n    }];\n\n    var httpsConfig = [&quot;httpClientProvider&quot;,function (httpClientProvider) {\n   \t  httpClientProvider.setBaseUrl(&quot;https://&quot; + window.location.host);\n      httpClientProvider.setToken($.urlParam(&quot;auth_token&quot;));\n    }]\n\n     var myApp= angular.module(&quot;myApp&quot;, [&quot;underscore&quot; , &quot;WsClient&quot;, &quot;HttpClient&quot;, &quot;Chart&quot;, 'gridster', 'ui.bootstrap', 'ngRoute', 'Gauge', 'Speedometer', 'Odometer', 'Map', 'Grid', 'toggle-switch', 'Slider', 'Button', 'IFrame', 'Accelerometer', 'Thermometer', 'Display', &quot;ngAnimate&quot;, &quot;ngSanitize&quot;, 'Dygraphs', 'DataService', 'Plotly', 'MetricBox', 'Alert'])\n     angular.module('myApp').config(wssConfig);\n     angular.module('myApp').config(httpsConfig);\n     \n     myApp.config(function($interpolateProvider, $locationProvider) {\n        $interpolateProvider.startSymbol('{[{');\n        $interpolateProvider.endSymbol('}]}');\n        $locationProvider.html5Mode({\n          enabled: true,\n          requireBase: false\n        });\n     });\n  \n  \n     myApp.controller('RootCtrl', function($scope, $interpolate, $location) {\n       var vm = this;\n       vm.gridsterOptions = {\n          defaultSizeY: 50,\n          defaultSizeX:50,\n          minRows: 1, // the minimum height of the grid, in rows\n          maxRows: 100,\n          columns: 10, // the width of the grid, in columns\n          colWidth: 'auto', // can be an integer or 'auto'.  'auto' uses the pixel width of the element divided by 'columns'\n          rowHeight: '50', // can be an integer or 'match'.  Match uses the colWidth, giving you square widgets.\n          margins: [10, 10], // the pixel distance between each widget\n          defaultSizeX: 2, // the default width of a gridster item, if not specifed\n          defaultSizeY: 1, // the default height of a gridster item, if not specified\n          mobileBreakPoint:480, // if the screen is not wider that this, remove the grid layout and stack the items\n          minColumns: 1, // the minimum columns the grid must have\n          resizable: {\n            enabled: false\n          },\n          draggable: {\n             enabled: false\n          }\n       };\n       \n        vm.init = function() {\n          {{#each urlParams}}\n           \tconsole.log(&quot;{{this}}&quot;, $location.search()[&quot;{{this}}&quot;])\n            vm.{{this}} = $location.search()[&quot;{{this}}&quot;]\n          {{/each}}\n        }\n        {{#each items}}\n           \t{{#if this.formatFunction}}   \n                vm.{{this.formatFunction}} = function(data){\n                  {{{this.formatFunctionValue}}}\n                }\n           \t{{/if}} \n        {{/each}}\n        \n        {{#each items}}\n           \t{{#if this.functions}}   \n            \t{{#each this.functions}}\n                    vm.{{this.name}} = function(arguments){\n                      {{{this.value}}}\n                    }\n                 {{/each}}\n           \t{{/if}} \n        {{/each}}\n     });\n        \t\n})();\n  \n&lt;/script&gt;\n\n   &lt;body class=&quot;dashboard-template dashboardTheme &quot;&gt;\n      &lt;div ng-controller=&quot;RootCtrl as vm&quot; ng-init=&quot;vm.init();&quot; class=&quot;dashboardContainer&quot;&gt; \n\t\t&lt;div gridster=&quot;vm.gridsterOptions&quot;&gt;\n          &lt;ul&gt;\n             {{#each items}}\n                &lt;li class=&quot;myItem&quot; gridster-item='{sizeX: {{sizeX}}, sizeY: {{sizeY}}, col: {{col}} , row: {{row}} }'&gt;\n                    \n\t\t\t\t\t\t&lt;div class=&quot;box {{#if_eq  this.options.box-header \"false\"}} box-without-header {{/if_eq}}&quot;&gt;\n\t\t\t\t\t\t  &lt;div class=&quot;box-header&quot;&gt;\n\t\t\t\t\t\t    &lt;div class=&quot;box-label&quot;&gt;&lt;span tooltip-append-to-body=&quot;true&quot; uib-tooltip=&quot;{{this.options.boxLabel}}&quot;&gt;{{this.options.boxLabel}}&lt;/span&gt;&lt;/div&gt;\n\t\t\t\t\t\t  &lt;/div&gt;\n                          &lt;div class=&quot;clearfix&quot;&gt;&lt;/div&gt;\n\t\t\t\t\t\t  &lt;div class=&quot;box-content&quot;&gt;\n\t\t\t\t\t\t  \t\t&lt;{{type}}\n                                    {{#buildAttr this.options }}\n                                        {{this}}\n                                    {{/buildAttr}}\n                                    {{#if this.formatFunction}}   \n                                  \t\ton-format-data='vm.{{this.formatFunction}}'\n                                    {{/if}} \n                           \t\t&gt;\n                                \n                                {{#if this.functions}}   \n                                       {{#each this.functions}}\n                                  \t\t\t{{this.attribute}}='vm.{{this.name}}'\n                                        {{/each}}\n                                    {{/if}} \n                                   \n \n \n          \n \t\t\t\t\t{{#if this.options.default-info-window}}\n                                &lt;info-window id=&quot;{{this.options.default-info-window.id}}&quot; template=&quot;{{this.options.default-info-window.template}}&quot; max-width=&quot;{{this.options.default-info-window.max-width}}&quot; max-height=&quot;{{this.options.default-info-window.max-height}}&quot;&gt;\n                                 &lt;/info-window&gt;\n                    {{/if}}\n                    \n       \t\t\t{{#if this.options.source-info-window}}\n                    \t{{#each this.options.source-info-window}}\n                        \t\t &lt;info-window id=&quot;infoWindowTemplate_{{this.source}}&quot; template=&quot;{{this.template}}&quot; max-width=&quot;{{this.max-width}}&quot; max-height=&quot;{{this.max-height}}&quot;&gt;\n                                 &lt;/info-window&gt;\n                        {{/each}}\n                    {{/if}}\n                                &lt;/{{type}}&gt;\n\t\t\t\t\t\t  &lt;/div&gt;\n\t\t\t\t\t\t&lt;/div&gt;\n                &lt;/li&gt;\n             {{/each}}\n          &lt;/ul&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n  &lt;/body&gt;  \n&lt;/html&gt;<\/script>"),
a.put("/UIComponents/dashboardBuilder/ide/dashboardTemplate_ide.min","<script type=text/x-handlebars-template id=handlebar-template>&lt;html ng-app=&quot;myApp&quot;&gt;\n&lt;head&gt;\n\n    &lt;link rel=&quot;icon&quot; href=&quot;data:;base64,iVBORw0KGgo=&quot;&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&quot; integrity=&quot;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&quot; crossorigin=&quot;anonymous&quot;&gt;\n    &lt;script src=&quot;//use.fontawesome.com/3d61d6959e.js&quot;&gt;&lt;/script&gt;\n\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;//{{{staticdomain}}}/lib/UIComponents/build/ide/css//components.min.css&quot;&gt;\n    \n    &lt;script src=&quot;//maps.google.com/maps/api/js?key=AIzaSyBcPYghFh_BXz4dDz-TXTHbU2iV3Wbf57I&amp;libraries=drawing,visualization&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;//{{{staticdomain}}}/lib/UIComponents/build/ide/js/template_resources.min.js&quot;&gt;&lt;/script&gt;\n    \n&lt;/head&gt; \n  \n&lt;script&gt;\n\n(function() {  \n   $.urlParam = function(name){\n\t     var results = new RegExp('[\\?&amp;]' + name + '=([^&amp;#]*)').exec(window.location.href);\n\t     if (results==null){\n\t         return null;\n\t     }else{\n\t         return results[1] || 0;\n\t     }\n\t}\n\n\t$.getUrlVars = function() {\n\t\tvar vars = [], hash;\n\t\tvar hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&amp;');\n\t\tfor(var i = 0; i &lt; hashes.length; i++)\n\t\t{\n\t\t\thash = hashes[i].split('=');\n\t\t\tvars.push(hash[0]);\n\t\t\tvars[hash[0]] = hash[1];\n\t\t}\n\t\treturn vars;\n\t}\n\t  \n\n      \n    var underscore = angular.module('underscore', []);\n\t\tunderscore.factory('_', ['$window', function($window) {\t\t\n  \t\treturn $window._; // assumes underscore has already been loaded on the page\t\t\n\t}]);\n    \n\n    var wssConfig = [&quot;wsClientProvider&quot;,function (wsClientProvider) {\n   \t \twsClientProvider.setBaseUrl(&quot;wss://&quot; + window.location.host + &quot;/&quot;);   \t \n        wsClientProvider.setToken($.urlParam(&quot;auth_token&quot;));\n        wsClientProvider.setPublishChannel(&quot;{{{transport.publishChannel}}}&quot;);\n        wsClientProvider.setSubscribeChannel(&quot;{{{transport.subscribeChannel}}}&quot;);\n    }];\n\n    var httpsConfig = [&quot;httpClientProvider&quot;,function (httpClientProvider) {\n   \t  httpClientProvider.setBaseUrl(&quot;https://&quot; + window.location.host);\n      httpClientProvider.setToken($.urlParam(&quot;auth_token&quot;));\n    }]\n\n     var myApp= angular.module(&quot;myApp&quot;, [&quot;underscore&quot; , &quot;WsClient&quot;, &quot;HttpClient&quot;, &quot;Chart&quot;, 'gridster', 'ui.bootstrap', 'ngRoute', 'Gauge', 'Speedometer', 'Odometer', 'Message', 'Map', 'Grid', 'toggle-switch', 'Slider', 'Button', 'IFrame', 'Accelerometer', 'Thermometer'])\n     \n     angular.module('myApp').run(cachedTemplates);  \n      \n     angular.module('myApp').config(wssConfig);\n     angular.module('myApp').config(httpsConfig);\n     \n     myApp.config(function($interpolateProvider, $locationProvider) {\n        $interpolateProvider.startSymbol('{[{');\n        $interpolateProvider.endSymbol('}]}');\n        $locationProvider.html5Mode({\n          enabled: true,\n          requireBase: false\n        });\n     });\n  \n  \n     myApp.controller('RootCtrl', function($scope, $interpolate, $location) {\n       var vm = this;\n       vm.gridsterOptions = {\n          pushing: false,\n          \n          minRows: 1, // the minimum height of the grid, in rows\n          maxRows: 100,\n          columns: 5, // the width of the grid, in columns\n          colWidth: 'auto', // can be an integer or 'auto'.  'auto' uses the pixel width of the element divided by 'columns'\n          rowHeight: 'match', // can be an integer or 'match'.  Match uses the colWidth, giving you square widgets.\n          margins: [10, 10], // the pixel distance between each widget\n          defaultSizeX: 2, // the default width of a gridster item, if not specifed\n          defaultSizeY: 1, // the default height of a gridster item, if not specified\n          mobileBreakPoint: 1024, // if the screen is not wider that this, remove the grid layout and stack the items\n          minColumns: 1,\n          resizable: {\n            enabled: false\n          },\n          draggable: {\n             enabled: false\n          }\n       };\n       \n        vm.init = function() {\n          {{#each urlParams}}\n           \tconsole.log(&quot;{{this}}&quot;, $location.search()[&quot;{{this}}&quot;])\n            vm.{{this}} = $location.search()[&quot;{{this}}&quot;]\n          {{/each}}\n        }\n        {{#each items}}\n           \t{{#if this.formatFunction}}   \n                vm.{{this.formatFunction}} = function(data){\n                  {{this.formatFunctionValue}}\n                }\n           \t{{/if}} \n        {{/each}}\n     });\n        \t\n})();\n  \n&lt;/script&gt;\n\n    &lt;body&gt;\n      &lt;div ng-controller=&quot;RootCtrl as vm&quot; ng-init=&quot;vm.init();&quot;&gt; \n\t\t&lt;div gridster=&quot;vm.gridsterOptions&quot;&gt;\n          &lt;ul&gt;\n             {{#each items}}\n                &lt;li class=&quot;myItem&quot; gridster-item='{sizeX: {{sizeX}}, sizeY: {{sizeY}}, col: {{col}} , row: {{row}} }'&gt;\n                    &lt;div class=&quot;box&quot;&gt;\n                        &lt;div class=&quot;box-content&quot;&gt;\n                          &lt;div  style=&quot;height: 30px;&quot; tooltip-placement=&quot;bottom&quot; uib-tooltip=&quot;{{this.options.boxLabel}}&quot; class=&quot;box-label&quot;&gt;{{this.options.boxLabel}}&lt;/div&gt;\n                          &lt;div  style=&quot;height: calc(100% - 30px)&quot; &gt; &lt;{{type}}\n                           \t      {{#buildAttr this.options }}\n                                        {{this}}\n                                  {{/buildAttr}}\n                                  {{#if this.formatFunction}}   \n                                  \t\ton-format-data='vm.{{this.formatFunction}}'\n                                  {{/if}} \n                           &gt;&lt;/{{type}}&gt; &lt;/div&gt;\n                        &lt;/div&gt;\n                    &lt;/div&gt;\n                &lt;/li&gt;\n             {{/each}}\n          &lt;/ul&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n  &lt;/body&gt;  \n&lt;/html&gt;<\/script>"),a.put("/UIComponents/dashboardBuilder/view/dashboardsList.html","<dashboards-list></dashboards-list>")}];angular.module("Chart",["angular.morris","ComponentsCommon","DataService"]),angular.element(document).ready(function(){Morris.Line.prototype.resizeHandler=function(){clearTimeout(this.timeoutId);var a=this;return this.timeoutId=setTimeout(function(){a.el&&a.el.width()>0&&a.el.height()>0&&(a.raphael.setSize(a.el.width(),a.el.height()-8),a.redraw())},600),this},Morris.Donut.prototype.resizeHandler=function(){return this.timeoutId=null,this.el&&this.el.width()>0&&this.el.height()>0?(this.raphael.setSize(this.el.width(),this.el.height()),this.redraw()):null},Morris.Donut.prototype.setData=function(a){var b;return this.data=a,this.values=function(){var a,c,d,e;for(d=this.data,e=[],a=0,c=d.length;a<c;a++)b=d[a],e.push(parseFloat(b.value));return e}.call(this),this.el&&this.el.width()>0&&this.el.height()>0?this.redraw():null}}),angular.module("Chart").component("scriptrChart",{bindings:{onLoad:"&onLoad",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",delta:"<?",resize:"<?",data:"<?",type:"@",xkey:"@",yconfig:"<?",ykeys:"<?",stacked:"<?",labels:"<?",colors:"<?",lineWidth:"@",pointSize:"@",pointFillColors:"@",pointStrokeColors:"@",ymax:"@",ymin:"@",smooth:"@",hideHover:"@",parseTime:"@",units:"@",postUnits:"@",preUnits:"@",xlabels:"@",xlabelAngle:"<?",goals:"@",goalStrokeWidth:"@",goalLineColors:"@",goalsconfig:"<?",events:"@",eventStrokeWidth:"@",eventLineColors:"@",eventconfig:"<?",continuousLine:"@",axes:"@",grid:"@",gridTextColor:"@",gridTextSize:"@",gridTextFamily:"@",gridTextWeight:"@",fillOpacity:"@",resize:"@",behaveLikeLine:"@",labelColor:"@",donutFormatter:"&",backgroundColor:"@",hoverCallback:"&?",dateFormat:"&?",xlabelFormat:"&?",ylabelFormat:"&?",showLegend:"@",legendType:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/chart/chart.html",controller:["httpClient","wsClient","$scope","$element","$timeout","$window","$interval","dataService",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){if(this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/"+this.type+"-chart-bg.svg",this.hasData=!!(this.datas&&this.datas.length>0),i.yconfig){var a=[],b=[],d=[];i.yconfig.forEach(function(c){a.push(c.key),b.push(c.label),d.push(c.color)}),i.ykeys=a,i.labels=b,i.colors=d}if(i.goalsconfig&&(i.goals=[],i.goalLineColors=[],i.goalsconfig.forEach(function(a){i.goals.push(a.goal),i.goalLineColors.push(a.lineColor)})),i.eventsconfig&&(i.events=[],i.eventLineColors=[],i.eventsconfig.forEach(function(a){i.events.push(a.event),i.eventLineColors.push(a.lineColor)})),this.colors=this.colors?this.colors:["#CC5464","#FCC717","#38B9D6","#1DBC68","#E90088"],this.stacked=!!this.stacked&&this.stacked,this.resize=!this.resize||this.resize,this.labelColor=this.labelColor?this.labelColor:"#eee",this.backgroundColor=this.backgroundColor?this.backgroundColor:"#fff",this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.showLegend=this.showLegend?this.showLegend:"true",this.legendType=this.legendType?this.legendType:"hover",this.hideHover=this.hideHover?this.hideHover:"auto",this.showLegend&&"true"==this.showLegend)if(this.legendType&&"right"==this.legendType){this.hideHover="always",this.ref=c.$id,this.legendStructure=[];for(var e=0;e<this.ykeys.length;e++){var f={};f.key=this.ykeys[e],this.labels&&this.labels[e]?f.label=this.labels[e]:f.label=this.ykeys[e],this.colors&&this.colors[e]&&(f.color=this.colors[e]),this.legendStructure.push(f)}this.hoverCallback=function(a,b,d,e){i.datas&&(e&&e.date&&(c.$ctrl.legendDate=e[i.xkey]),_.mapObject(e,function(a,b){var f=_.findIndex(c.$ctrl.legendStructure,{key:"donut"!=i.type?b:a});if(-1!=f){c.$ctrl.legendStructure[f].value="donut"==i.type?d:a;var g=document.getElementById("value_"+f+"_"+i.ref),h=document.getElementById("date_"+i.ref);g&&(g.innerHTML="donut"==i.type?d:a),"donut"!=i.type&&h&&(h.innerHTML=e[i.xkey])}}))}}else this.legendType&&"hover"==this.legendType&&console.log("Legend type",this.legendType)},this.$postLink=function(){i.timeoutId=e(i.resize.bind(i),100),angular.element(f).on("resize",i.onResize),"wss"==i.transport&&(i.api||i.msgTag)||"https"==i.transport&&i.api?j(this.transport):null!=i.data?c.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&i.consumeData(a)}):(c.$on("update-data",function(a,b){null==b?i.datas&&0!=i.datas.length||(i.noResults=!0):b[i.serviceTag]?i.consumeData(b[i.serviceTag]):i.consumeData(b)}),c.$emit("waiting-for-data"))},this.onResize=function(){null!=i.timeoutId&&e.cancel(i.timeoutId),i.timeoutId=e(i.resize.bind(i),100)},this.resize=function(){d.parent().innerWidth()<240?i.usePopover=!0:i.usePopover=!1},this.$onDestroy=function(){i.msgTag&&b.unsubscribe(i.msgTag,null,c.$id),i.refreshTimer&&g.cancel(i.refreshTimer),null!=i.timeoutId&&e.cancel(i.timeoutId),angular.element(f).off("resize",i.onResize)};var j=function(a){var b={api:i.api,transport:a,msgTag:i.msgTag,apiParams:i.apiParams,useWindowParams:i.useWindowParams,httpMethod:i.httpMethod,widgetId:c.$id};h.scriptrRequest(b,i.consumeData.bind(i)),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=g(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(this.noResults=!0,this.dataFailureMessage="Failed to fetch data.",this.datas&&this.datas.length>0&&(this.stalledData=!0,this.dataFailureMessage="Failed to update data.")):("function"==typeof i.onFormatData()&&(a=i.onFormatData()(a)),null!=a&&"object"==typeof a&&Array.isArray(a)?a.length>0?(null!=this.datas&&this.delta?this.datas=this.datas.concat(a):this.datas=a,i.hasData=!0,i.noResults=!1,i.stalledData=!1):(i.noResults=!0,null!=i.datas&&i.datas.length>0&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, no data returned."):(i.noResults=!0,null!=i.datas&&i.datas.length>0&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format."))}}]}),angular.module("Odometer",["ui.odometer","ComponentsCommon","DataService"]),angular.module("Odometer").component("scriptrOdometer",{bindings:{onLoad:"&onLoad",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",enableResize:"<?",theme:"@",duration:"@",animation:"@",odometerValue:"<?",data:"<?",size:"<?"},templateUrl:"/UIComponents/dashboard/frontend/components/odometer/odometer.html",controller:["$scope","httpClient","wsClient","$element","$window","$timeout","$interval","dataService",function(a,b,c,d,f,g,h,i){var j=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/odometer-bg.svg",this.hasData=!(isNaN(parseFloat(this.odometerValue))||!isFinite(this.odometerValue)),this.config={duration:this.duration?this.duration:1e3,animation:this.animation?this.animation:"count",theme:this.theme?this.theme:"car"},this.odometerOptions=this.config,this.size=this.size?this.size:1,this.enableResize=void 0===this.enableResize||this.enableResize,this.style={},this.style["font-size"]=this.size+"em",this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true"},this.onResize=function(){null!=j.timeoutId&&g.cancel(j.timeoutId),j.timeoutId=g(j.resize.bind(j),300)},j.resize=function(){j.timeoutId=null,j.enableResize&&(j.style["margin-top"]=d.parent().outerHeight()/2-d.outerHeight()/2),j.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?j.usePopover=!0:j.usePopover=!1},this.$postLink=function(){j.timeoutId=g(j.resize.bind(j),300),angular.element(f).on("resize",j.onResize),"wss"==j.transport&&(j.api||j.msgTag)||"https"==j.transport&&j.api?k(this.transport):null!=j.data?a.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&j.consumeData(a)}):(a.$on("update-data",function(a,b){null==b?null==j.odometerValue&&(j.noResults=!0):b[j.serviceTag]?j.consumeData(b[j.serviceTag]):j.consumeData(b)}),a.$emit("waiting-for-data"))},this.$onDestroy=function(){j.msgTag&&c.unsubscribe(j.msgTag,null,a.$id),j.refreshTimer&&h.cancel(j.refreshTimer),null!=j.timeoutId&&g.cancel(j.timeoutId),angular.element(f).off("resize",j.onResize)};var k=function(b){var c={api:j.api,transport:b,msgTag:j.msgTag,apiParams:j.apiParams,useWindowParams:j.useWindowParams,httpMethod:j.httpMethod,widgetId:a.$id};i.scriptrRequest(c,j.consumeData.bind(j)),j.fetchDataInterval&&!j.refreshTimer&&(j.refreshTimer=h(function(){k(j.transport)},1e3*j.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(j.noResults=!0,j.dataFailureMessage="Failed to fetch data.",j.odometerValue&&(j.stalledData=!0,j.dataFailureMessage="Failed to update data.")):("function"==typeof j.onFormatData()&&(a=j.onFormatData()(a)),null!=a?(a=parseFloat(a),!isNaN(a)&&isFinite(a)?(j.odometerValue=a,j.hasData=!0,j.noResults=!1,j.stalledData=!1):(j.noResults=!0,null!=j.odometerValue&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format.")):(j.noResults=!0,null!=j.odometerValue&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format.",console.log(e)))}}]}),angular.module("Speedometer",["meterGauge","ComponentsCommon","DataService"]),angular.module("Speedometer").component("scriptrSpeedometer",{bindings:{onLoad:"&onLoad",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",gaugeRadius:"<?",theme:"@",minValue:"<?",maxValue:"<?",needleVal:"<?",data:"<?",tickSpaceMinVal:"<?",tickSpaceMajVal:"<?",gaugeUnits:"@",tickColMaj:"@",tickColMin:"@",outerEdgeCol:"@",pivotCol:"@",innerCol:"@",unitsLabelCol:"@",tickLabelCol:"@",needleCol:"@",defaultFonts:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/speedometer/speedometer.html",controller:["httpClient","wsClient","$element","$window","$scope","$compile","$timeout","$interval","dataService",function(a,b,c,d,e,f,g,h,i){var j=this;this.$onInit=function(){this.speedoConfig={},this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/speedometer-bg.svg",this.hasData=!(isNaN(parseFloat(this.speedoConfig.needleVal))||!isFinite(this.speedoConfig.needleVal)),"speed"==this.theme||void 0===this.theme?(this.speedoConfig.gaugeRadius=this.gaugeRadius?this.gaugeRadius:150,this.speedoConfig.minVal=this.minValue?this.minValue:0,this.speedoConfig.maxVal=this.maxValue?this.maxValue:220,this.speedoConfig.tickSpaceMinVal=this.tickSpaceMinVal?this.tickSpaceMinVal:10,this.speedoConfig.tickSpaceMajVal=this.tickSpaceMajVal?this.tickSpaceMajVal:20,this.speedoConfig.gaugeUnits=this.gaugeUnits?this.gaugeUnits:"kmh",this.speedoConfig.tickColMaj=this.tickColMaj?this.tickColMaj:"#C64DFF",this.speedoConfig.tickColMin=this.tickColMin?this.tickColMin:"#999999",this.speedoConfig.outerEdgeCol=this.outerEdgeCol?this.outerEdgeCol:"#f4f4f4",this.speedoConfig.pivotCol=this.pivotCol?this.pivotCol:"#434a54",this.speedoConfig.innerCol=this.innerCol?this.innerCol:"#ffffff",this.speedoConfig.unitsLabelCol=this.unitsLabelCol?this.unitsLabelCol:"#C64DFF",this.speedoConfig.tickLabelCol=this.tickLabelCol?this.tickLabelCol:"#656D78",this.speedoConfig.needleCol=this.needleCol?this.needleCol:"#C64DFF",this.speedoConfig.defaultFonts=this.defaultFonts?this.defaultFonts:""):"rpm"==this.theme&&(this.speedoConfig.gaugeRadius=this.gaugeRadius?this.gaugeRadius:120,this.speedoConfig.minVal=this.minValue?this.minValue:0,this.speedoConfig.maxVal=this.maxValue?this.maxValue:1e3,this.speedoConfig.needleVal=this.needleVal?Math.round(this.needleVal):this.data?Math.round(this.data):0,this.speedoConfig.tickSpaceMinVal=this.tickSpaceMinVal?this.tickSpaceMinVal:10,this.speedoConfig.tickSpaceMajVal=this.tickSpaceMajVal?this.tickSpaceMajVal:100,this.speedoConfig.gaugeUnits=this.gaugeUnits?this.gaugeUnits:"kmh",this.speedoConfig.tickColMaj=this.tickColMaj?this.tickColMaj:"#0194D9",this.speedoConfig.tickColMin=this.tickColMin?this.tickColMin:"#999999",this.speedoConfig.outerEdgeCol=this.outerEdgeCol?this.outerEdgeCol:"#ffffff",this.speedoConfig.pivotCol=this.pivotCol?this.pivotCol:"#434A54",this.speedoConfig.innerCol=this.innerCol?this.innerCol:"#ffffff",this.speedoConfig.unitsLabelCol=this.unitsLabelCol?this.unitsLabelCol:"#0194d9",this.speedoConfig.tickLabelCol=this.tickLabelCol?this.tickLabelCol:"#656D78",this.speedoConfig.needleCol=this.needleCol?this.needleCol:"#0194d9",this.speedoConfig.defaultFonts=this.defaultFonts?this.defaultFonts:""),this.speedoConfig.speedoTag=e.$id,this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",angular.element(d).on("resize",function(){null!=j.timeoutId&&g.cancel(j.timeoutId),j.timeoutId=g(function(){j.renderGauge()},100)})},this.calculateGaugeRadius=function(){var a=c.parent().height(),b=c.parent().width();j.speedoConfig.gaugeRadius=0==a?b/2:b>=a?a/2:b/2},this.calculateNotificationsDisplay=function(){c.parent().innerWidth()<240?j.usePopover=!0:j.usePopover=!1},this.renderGauge=function(){angular.element(c).find(".speedometer-wrapper").html(""),j.speedo=angular.element(document.createElement("meter-gauge")),j.calculateGaugeRadius(),j.speedo.attr("gaugeconfig",JSON.stringify(j.speedoConfig)),this.el=f(j.speedo)(e),angular.element(c).find(".speedometer-wrapper").append(this.el)},this.onResize=function(){null!=j.timeoutId&&g.cancel(j.timeoutId),j.timeoutId=g(j.resize.bind(j),100)},this.resize=function(){this.speedoConfig.needleVal&&j.renderGauge(),j.calculateNotificationsDisplay()},this.$postLink=function(){j.timeoutId=g(j.resize.bind(j),100),angular.element(d).on("resize",j.onResize),"wss"==j.transport&&(j.api||j.msgTag)||"https"==j.transport&&j.api?k(this.transport):null!=j.data?e.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&j.consumeData(a)}):(e.$on("update-data",function(a,b){null==b?null==j.speedoConfig.needleVal&&(j.noResults=!0):b[j.serviceTag]?j.consumeData(b[j.serviceTag]):j.consumeData(b)}),e.$emit("waiting-for-data"))},this.$onDestroy=function(){j.msgTag&&b.unsubscribe(j.msgTag,null,e.$id),j.refreshTimer&&h.cancel(j.refreshTimer),null!=j.timeoutId&&g.cancel(j.timeoutId),angular.element(d).off("resize",j.onResize)};var k=function(a){var b={api:j.api,transport:a,msgTag:j.msgTag,apiParams:j.apiParams,useWindowParams:j.useWindowParams,httpMethod:j.httpMethod,widgetId:e.$id};i.scriptrRequest(b,j.consumeData.bind(j)),j.fetchDataInterval&&!j.refreshTimer&&(j.refreshTimer=h(function(){k(j.transport)},1e3*j.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(j.noResults=!0,j.dataFailureMessage="Failed to fetch data.",j.speedoConfig.needleVal&&(j.stalledData=!0,j.dataFailureMessage="Failed to update data.")):("function"==typeof j.onFormatData()&&(a=j.onFormatData()(a)),null!=a?(a=parseFloat(a),!isNaN(a)&&isFinite(a)?(j.speedoConfig.needleVal=Math.round(a),j.hasData=!0,j.noResults=!1,j.stalledData=!1,j.renderGauge()):(j.noResults=!0,null!=j.speedoConfig.needleVal&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format.")):(j.noResults=!0,null!=j.speedoConfig.needleVal&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format."))}}]}),angular.module("SearchBox",["angularBootstrapNavTree"]).component("scriptrSearchbox",{bindings:{treeControl:"<?",treeData:"<?",searchText:"@",iconLeaf:"@",paramName:"@",iconExpand:"@",iconCollapse:"@",onSelect:"<?",expandLevel:"@",initialSelection:"@",apiParams:"<?",loadTree:"<?",treeSearchCriteria:"@",transport:"@",api:"@",onFormatData:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/searchBox/searchBox.html",controller:["wsClient","httpClient",function(a,b){var c=this;this.iconExpand=this.iconExpand?this.iconExpand:null,this.$onInit=function(){this.iconLeaf=this.iconLeaf&&"$ctrl.iconLeaf"!=this.iconLeaf?this.iconLeaf:"icon-file  glyphicon glyphicon-file  fa fa-file",this.iconExpand=this.iconExpand&&"$ctrl.iconExpand"!=this.iconExpand?this.iconExpand:"icon-plus  glyphicon glyphicon-plus  fa fa-plus",this.iconCollapse=this.iconCollapse&&"$ctrl.iconCollapse"!=this.iconCollapse?this.iconCollapse:"icon-minus glyphicon glyphicon-minus fa fa-minus",this.paramName=this.paramName?this.paramName:"criteria",this.searchText=this.searchText?this.searchText:"Type to search",this.treeData=this.treeData?this.treeData:[],this.iconLeaf=this.iconLeaf?this.iconLeaf:null,this.transport=this.transport?this.transport:"wss",this.loadTree&&(this.searchValue=this.treeSearchCriteria,this.searching=!0,d(this.transport,this.searchValue))},this.onFilterChanged=function(){console.log("submit"),null!=this.searchValue&&""!=this.searchValue&&(this.searchValue=this.treeSearchCriteria,this.searching=!0,d(this.transport,this.searchValue))};var d=function(d,e){var f={};if(f[c.paramName]=e||c.treeSearchCriteria,c.apiParams)for(var g in c.apiParams)f[g]=c.apiParams[g];"wss"==d?a.onReady.then(function(){a.subscribe(c.msgTag,c.consumeData.bind(c)),c.api&&a.call(c.api,f,c.msgTag).then(function(a,b){c.consumeData(a)},function(a){console.log("reject published promise",a),c.consumeData()})}):"https"==d&&c.api&&b.get(c.api,f).then(function(a,b){c.consumeData(a)},function(a){c.consumeData(),console.log("reject published promise",a)})};this.consumeData=function(a,b){"function"==typeof c.onFormatData()&&(a=c.onFormatData()(a)),console.log("display tree"),"object"==typeof a&&a.length>0?(this.treeData=a,this.noResults=!1):(this.treeData=[],this.noResults=!0),this.searching=!1}}]}),angular.module("Gauge",["frapontillo.gage","ComponentsCommon","DataService"]),angular.module("Gauge").component("scriptrGauge",{bindings:{onLoad:"&onLoad",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",valueFontColor:"@",min:"@",max:"@",hideMinMax:"@",hideValue:"@",showInnerShadow:"<?",gaugeColor:"@",data:"<?",customSectors:"<?",shadowSize:"@",shadowOpacity:"@",label:"@",labelFontColor:"@",startAnimationType:"@",refreshAnimationType:"@",valueFontFamily:"@",relativeGaugeSize:"@",valueMinFontSize:"@",hideMinMax:"@",labelMinFontSize:"@",minLabelMinFontSize:"@",maxLabelMinFontSize:"@",gaugeWidthScale:"@",shadowVerticalOffset:"@",levelColors:"@",noGradient:"@",startAnimationTime:"@",refreshAnimationTime:"@",donut:"@",donutStartAngle:"@",reverse:"@",decimals:"@",symbol:"@",formatNumber:"@",humanFriendly:"@",humanFriendlyDecimal:"@",textRenderer:"&",onAnimationEnd:"&",pointer:"<?",heightUnit:"@",counter:"@",width:"@",height:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/gauge/gauge.html",controller:["$scope","httpClient","wsClient","$interval","dataService","$timeout","$window","$element",function(a,b,c,d,f,g,h,i){var j=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/gauge-bg.svg",this.hasData=!(isNaN(parseFloat(this.gaugeValue))||!isFinite(this.gaugeValue)),this.heightUnit=this.heightUnit?this.heightUnit:"px",this.customSectors=this.customSectors?this.customSectors:{percents:!0,ranges:[{color:"#A3CD3B",lo:0,hi:25},{color:"#FF4A43",lo:25,hi:100}]},this.valueFontColor=this.valueFontColor?this.valueFontColor:"#999",this.min=this.min?this.min:0,this.max=this.max?this.max:100,this.hideMinMax=!!this.hideMinMax&&this.hideMinMax,this.hideValue=!!this.hideValue&&this.hideValue,this.gaugeColor=this.gaugeColor?this.gaugeColor:"#e9e9e9",this.shadowSize=this.shadowSize?this.shadowSize:0,this.label=this.label?this.label:"",this.labelFontColor=this.labelFontColor?this.labelFontColor:"#666",this.startAnimationType=this.startAnimationType?this.startAnimationType:"linear",this.refreshAnimationType=this.refreshAnimationType?this.refreshAnimationType:"linear",this.counter=!this.counter||this.counter,this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true"},this.$postLink=function(){j.timeoutId=g(j.resize.bind(j),100),angular.element(h).on("resize",j.onResize),"wss"==j.transport&&(j.api||j.msgTag)||"https"==j.transport&&j.api?k(this.transport):null!=j.data?a.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&j.consumeData(a)}):(a.$on("update-data",function(a,b){null==b?null==j.gaugeValue&&(j.noResults=!0):b[j.serviceTag]?j.consumeData(b[j.serviceTag]):j.consumeData(b)}),a.$emit("waiting-for-data"))},this.onResize=function(){null!=j.timeoutId&&g.cancel(j.timeoutId),j.timeoutId=g(j.resize.bind(j),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){i.parent().innerWidth()<240?j.usePopover=!0:j.usePopover=!1},this.$onDestroy=function(){j.msgTag&&c.unsubscribe(j.msgTag,null,a.$id),j.refreshTimer&&d.cancel(j.refreshTimer),null!=j.timeoutId&&g.cancel(j.timeoutId),angular.element(h).off("resize",j.onResize)};var k=function(b){var c={api:j.api,transport:b,msgTag:j.msgTag,apiParams:j.apiParams,useWindowParams:j.useWindowParams,httpMethod:j.httpMethod,widgetId:a.$id};f.scriptrRequest(c,j.consumeData.bind(j)),j.fetchDataInterval&&!j.refreshTimer&&(j.refreshTimer=d(function(){k(j.transport)},1e3*j.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(j.noResults=!0,j.dataFailureMessage="Failed to fetch data.",j.gaugeValue&&(j.stalledData=!0,j.dataFailureMessage="Failed to update data.")):("function"==typeof j.onFormatData()&&(a=j.onFormatData()(a)),null!=a?(a=parseFloat(a),!isNaN(a)&&isFinite(a)?(j.gaugeValue=a,j.hasData=!0,j.noResults=!1,j.stalledData=!1):(j.noResults=!0,null!=j.gaugeValue&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format.")):(j.noResults=!0,null!=j.gaugeValue&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format.",console.log(e)))}}]}),angular.module("angular-scriptrui",[]).directive("ngScriptrAlert",function(){return{restrict:"E",require:"ngModel",scope:{msg:"=ngModel",type:"@"},template:'<div class="alert alert-{{type}} scriptr-alert" role="alert"><span ng-bind="msg"></span></div>',replace:!0}}),angular.module("Alert",["angular-scriptrui","ComponentsCommon","DataService"]),angular.module("Alert").component("scriptrAlert",{bindings:{data:"<?",type:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/alert/alert.html",controller:["httpClient","wsClient","dataService","$scope","$interval","$window","$element","$timeout",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/alert-bg.svg",this.hasData=null!=this.message&&""!=this.message,this.type=this.type?this.type:"info"},this.$postLink=function(){i.timeoutId=h(i.resize.bind(i),100),angular.element(f).on("resize",i.onResize),"wss"==i.transport&&(i.api||i.msgTag)||"https"==i.transport&&i.api?j(this.transport):null!=i.data?d.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&i.consumeData(a)}):(d.$on("update-data",function(a,b){null==b?null!=i.message&&""!=i.message||(i.noResults=!0):b[i.serviceTag]?i.consumeData(b[i.serviceTag]):i.consumeData(b)}),d.$emit("waiting-for-data"))},this.calculateNotificationsDisplay=function(){g.parent().innerWidth()<240?i.usePopover=!0:i.usePopover=!1},this.onResize=function(){null!=i.timeoutId&&h.cancel(i.timeoutId),i.timeoutId=h(i.resize.bind(i),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.$onDestroy=function(){console.log("destory alert",i.msgTag,d.$id),i.msgTag&&b.unsubscribe(i.msgTag,null,d.$id),i.refreshTimer&&e.cancel(i.refreshTimer),null!=i.timeoutId&&h.cancel(i.timeoutId),angular.element(f).off("resize",i.onResize)};var j=function(a){var b={api:i.api,transport:a,msgTag:i.msgTag,apiParams:i.apiParams,useWindowParams:i.useWindowParams,httpMethod:i.httpMethod,widgetId:d.$id};c.scriptrRequest(b,i.consumeData.bind(i)),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=e(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(i.noResults=!0,i.dataFailureMessage="Failed to fetch data.",i.message&&(i.stalledData=!0,i.dataFailureMessage="Failed to update data.")):("function"==typeof i.onFormatData()&&(a=i.onFormatData()(a,i)),null!=a?"object"==typeof a?(a&&a.value&&null!=typeof a.value?(i.message=a.value,i.hasData=!0,i.noResults=!1,i.stalledData=!1):(i.noResults=!0,null!=i.message&&""!=i.message&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format."),a&&a.type&&(i.type=a.type)):(i.message=a,i.hasData=!0,i.noResults=!1,i.stalledData=!1):(i.noResults=!0,null!=i.message&&""!=i.message&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format."))}}]}),
angular.module("Accelerometer",["ComponentsCommon","DataService"]),angular.module("Accelerometer").component("scriptrAccelerometer",{bindings:{data:"<?",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/accelerometer/accelerometer.html",controller:["httpClient","wsClient","$scope","$interval","$window","$element","dataService","$timeout",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/accelerometer-bg.svg",this.hasData=!(isNaN(i.xLine)||!isFinite(i.xLine)||isNaN(i.yLine)||!isFinite(i.yLine)||isNaN(i.zLine)||!isFinite(i.zLine)),this.useWindowParams=this.useWindowParams?this.useWindowParams:"true"},this.$postLink=function(){i.timeoutId=h(i.resize.bind(i),100),angular.element(e).on("resize",i.onResize),"wss"==i.transport&&(i.api||i.msgTag)||"https"==i.transport&&i.api?j(this.transport):null!=i.data?c.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&i.consumeData(a)}):(c.$on("update-data",function(a,b){null==b?null==i.xLine&&null==i.yLine&&null==i.zLine&&(i.noResults=!0):b[i.serviceTag]?i.consumeData(b[i.serviceTag]):i.consumeData(b)}),c.$emit("waiting-for-data"))},this.onResize=function(){null!=i.timeoutId&&h.cancel(i.timeoutId),i.timeoutId=h(i.resize.bind(i),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){f.parent().innerWidth()<240?i.usePopover=!0:i.usePopover=!1};var j=function(a){var b={api:i.api,transport:a,msgTag:i.msgTag,apiParams:i.apiParams,useWindowParams:i.useWindowParams,httpMethod:i.httpMethod,widgetId:c.$id};g.scriptrRequest(b,i.consumeData.bind(i)),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=d(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.$onDestroy=function(){i.msgTag&&b.unsubscribe(i.msgTag,null,c.$id),i.refreshTimer&&d.cancel(i.refreshTimer),null!=i.timeoutId&&h.cancel(i.timeoutId),angular.element(e).off("resize",i.onResize)},this.consumeData=function(a,b){if(a.status&&"failure"==a.status)i.noResults=!0,i.dataFailureMessage="Failure to fetch data.",i.xLine&&this.yLine&&this.angle&&(i.stalledData=!0,i.dataFailureMessage="Failure to update data.");else if("function"==typeof i.onFormatData()&&(a=i.onFormatData()(a)),null!=a){var c=parseFloat(a.x),d=parseFloat(a.y),e=parseFloat(a.z);a&&!isNaN(c)&&isFinite(c)&&!isNaN(d)&&isFinite(d)&&!isNaN(e)&&isFinite(e)?(a.x=a.x>20?20:a.x<-20?-20:a.x,a.y=a.y>20?20:a.y<-20?-20:a.y,i.xLine="scaleX("+Math.round(c)+")",i.yLine="scaleY("+Math.round(d)+")",i.angle="rotateZ("+Math.round(e)+"deg )",i.hasData=!0,i.noResults=!1,i.stalledData=!1):(i.noResults=!0,null!=i.xLine&&null!=i.yLine&&null!=i.angle&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format.")}else i.noResults=!0,null!=i.xLine&&null!=i.yLine&&null!=i.angle&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format."}}]}),angular.module("ToggleSwitch",["DataService","toggle-switch","ui.bootstrap","ComponentsCommon","DataService"]),angular.module("ToggleSwitch").component("scriptrToggleSwitch",{bindings:{onLoad:"&onLoad",type:"@",size:"@",class:"@",data:"<?",switchStatus:"<?",onLabel:"@",offLabel:"@",knobLabel:"@",isDisabled:"<?",onSwitchChange:"&",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",actionTransport:"@",actionApi:"@",actionApiParams:"<?",actionUseWindowParams:"@",actionHttpMethod:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/toggleSwitch/toggle_switch.html",controller:["$scope","$element","$window","$timeout","httpClient","wsClient","dataService","$interval",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/toggle-switch-bg.svg",this.hasData=!1===this.switchStatus||!0===this.switchStatus,!1!==this.switchStatus&&!0!==this.switchStatus||this.data?!this.data||!1!==this.data.state&&!0!==this.data.state||(this.switchStatus=null):this.data={state:this.switchStatus},this.onLabel=void 0!==this.onLabel?this.onLabel:"on",this.offLabel=void 0!==this.offLabel?this.offLabel:"off",this.knobLabel=void 0!==this.knobLabel?this.knobLabel:"",this.disabled=void 0!==this.isDisabled&&this.isDisabled,this.type=void 0!==this.type?this.type:"switch-success",this.size=void 0!==this.size?this.size:"switch-large",this.actionParams="undefined"!=this.actionParams?this.actionParams:this.apiParams?this.apiParams:{},this.class=this.type+" "+this.size,this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.style={}},this.$postLink=function(){i.timeoutId=d(i.resize.bind(i),100),angular.element(c).on("resize",i.onResize),"wss"==i.transport&&(i.api||i.msgTag)||"https"==i.transport&&i.api?(i.timeout=!0,j(this.transport)):(i.timeout=!1,i.data&&d(function(){0==i.timeout&&i.consumeData(i.data)},2e3),a.$watch(function(a){if(a.$ctrl.data&&1==i.timeout)return a.$ctrl.data},function(a,b){JSON.stringify(a)!=JSON.stringify(b)&&i.consumeData(a)}),a.$on("update-data",function(a,b){null==b?null==i.data&&(i.noResults=!0):b[i.serviceTag]?i.consumeData(b[i.serviceTag]):i.consumeData(b)}),a.$emit("waiting-for-data"))},this.$onDestroy=function(){i.msgTag&&f.unsubscribe(i.msgTag,null,a.$id),i.refreshTimer&&h.cancel(i.refreshTimer),null!=i.timeoutId&&d.cancel(i.timeoutId),angular.element(c).off("resize",i.onResize)},this.onResize=function(){null!=i.timeoutId&&d.cancel(i.timeoutId),i.timeoutId=d(i.resize.bind(i),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(a){b.parent().innerWidth()<240?i.usePopover=!0:i.usePopover=!1};var j=function(b){var c={api:i.api,transport:b,msgTag:i.msgTag,apiParams:i.apiParams,useWindowParams:i.useWindowParams,httpMethod:i.httpMethod,widgetId:a.$id};g.scriptrRequest(c,i.consumeData.bind(i)),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=h(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){if(a&&a.status&&"failure"==a.status)i.noResults=!0,i.dataFailureMessage="Failed to load toggle state.",!1!==i.switchStatus&&!0!==i.switchStatus||(i.stalledData=!0,i.dataFailureMessage="Failed to update toggle state.");else if("function"==typeof i.onFormatData()&&(a=i.onFormatData()(a,i)),null!=a)if("object"==typeof a&&a.hasOwnProperty("state")){var c=a.state;i.switchStatus=function(a){switch(a){case!0:case"true":case 1:case"1":case"on":case"yes":return!0;default:return!1}}(c),i.hasData=!0,i.noResults=!1,i.stalledData=!1,i.timeout=!0;var d=a.disabled;null!=d&&(i.isDisabled=d)}else i.noResults=!0,!1!==i.switchStatus&&!0!==i.switchStatus||(i.stalledData=!0,i.dataFailureMessage="Toggle state update data is invalid."),i.dataFailureMessage="Toggle state data is invalid.";else i.noResults=!0,i.dataFailureMessage="Failed to load toggle state.",!1!==i.switchStatus&&!0!==i.switchStatus||(i.stalledData=!0,i.dataFailureMessage="Failed to update toggle state.")},this.publishData=function(){if(!i.isDisabled){"function"==typeof i.onSwitchChange()&&i.onSwitchChange()(i.switchStatus),void 0===i.actionApiParams&&(i.actionApiParams={}),i.actionApiParams.value=i.switchStatus;var a={api:i.actionApi?i.actionApi:i.api,transport:i.actionTransport?i.actionTransport:i.transport,apiParams:i.actionApiParams,useWindowParams:i.actionUseWindowParams?i.actionUseWindowParams:i.useWindowParams,httpMethod:i.actionHttpMethod?i.actionHttpMethod:i.httpMehtod};g.scriptrRequest(a,i.consumeActionData.bind(i))}},this.consumeActionData=function(a,b){a.status&&"failure"==a.status?(i.actionSuccess=!1,i.actionMessage=a.errorDetail||"Toggle action failed.",i.consumeData({state:!i.switchStatus})):(i.actionSuccess=!0,i.actionMessage=a.successMessage||"Toggle action succeeded."),d(function(){i.actionSuccess=null,i.actionMessage=null},5e3)}}]}),angular.module("Slider",["rzModule","ui.bootstrap","ComponentsCommon","DataService"]),angular.module("Slider").component("scriptrSlider",{bindings:{onLoad:"&onLoad",theme:"@",id:"@",min:"<?",max:"<?",floor:"<?",ceil:"<?",step:"<?",precision:"<?",minLimit:"<?",maxLimit:"<?",minRange:"<?",maxRange:"<?",pushRange:"<?",id:"<?",translate:"<?",getLegend:"<?",stepsArray:"<?",bindIndexForStepsArray:"<?",draggableRange:"<?",draggableRangeOnly:"<?",showSelectionBar:"<?",showSelectionBarEnd:"<?",showSelectionBarFromValue:"<?",hidePointerLabels:"<?",hideLimitLabels:"<?",autoHideLimitLabels:"<?",readOnly:"<?",isDisabled:"<?",interval:"<?",showTicks:"<?",showTicksValues:"<?",ticksArray:"<?",ticksTooltip:"<?",ticksValuesTooltip:"<?",vertical:"<?",getSelectionBarColor:"&",getTickColor:"<?",getPointerColor:"<?",keyboardSupport:"<?",scale:"<?",enforceStep:"<?",enforceRange:"<?",noSwitching:"<?",onlyBindHandles:"<?",onStart:"&",onChange:"&",onEnd:"&",rightToLeft:"<?",boundPointerLabels:"<?",mergeRangeLabelsIfSame:"<?",customTemplateScope:"<?",logScale:"<?",customValueToPosition:"<?",customPositionToValue:"<?",selectionBarGradient:"<?",ariaLabel:"<?",ariaLabelledBy:"<?",ariaLabelHigh:"<?",ariaLabelledByHigh:"<?",enableResize:"<?",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",actionTransport:"@",actionApi:"@",actionApiParams:"<?",actionUseWindowParams:"@",actionHttpMethod:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/slider/slider.html",controller:["$scope","$element","$window","$timeout","httpClient","wsClient","dataService","$interval",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/slider-bg.svg",this.hasData=!(isNaN(parseFloat(this.min))||!isFinite(this.min)),this.min&&!this.data?(this.data=this.min,this.rollBackData=this.min):this.data&&(this.min=null),this.max=this.max?this.max:null,this.theme=this.theme?this.theme:"",this.options={},this.options.id=void 0!==this.id?this.id:null,this.options.floor=void 0!==this.floor?this.floor:0,this.options.ceil=void 0!==this.ceil?this.ceil:10,this.options.step=void 0!==this.step?this.step:1,this.options.precision=void 0!==this.precision?this.precision:0,this.options.minLimit=void 0!==this.minLimit?this.minLimit:null,this.options.maxLimit=void 0!==this.maxLimit?this.maxLimit:null,this.options.minRange=void 0!==this.minRange?this.minRange:null,this.options.maxRange=void 0!==this.maxRange?this.maxRange:null,this.options.pushRange=void 0!==this.pushRange&&this.pushRange,this.options.translate=void 0!==this.translate?this.translate:null,this.options.getLegend=void 0!==this.getLegend?this.getLegend:null,this.options.stepsArray=void 0!==this.stepsArray?this.stepsArray:null,this.options.bindIndexForStepsArray=void 0!==this.bindIndexForStepsArray&&this.bindIndexForStepsArray,this.options.draggableRange=void 0!==this.draggableRange&&this.draggableRange,this.options.draggableRangeOnly=void 0!==this.draggableRangeOnly&&this.draggableRangeOnly,this.options.showSelectionBar=void 0!==this.showSelectionBar&&this.showSelectionBar,this.options.showSelectionBarEnd=void 0!==this.showSelectionBarEnd&&this.showSelectionBarEnd,this.options.showSelectionBarFromValue=void 0!==this.showSelectionBarFromValue?this.showSelectionBarFromValue:null,this.options.hidePointerLabels=void 0!==this.hidePointerLabels&&this.hidePointerLabels,this.options.hideLimitLabels=void 0!==this.hideLimitLabels&&this.hideLimitLabels,this.options.autoHideLimitLabels=void 0===this.autoHideLimitLabels||this.autoHideLimitLabels,this.options.readOnly=void 0!==this.readOnly&&this.readOnly,this.options.disabled=void 0!==this.isDisabled&&this.isDisabled,this.options.interval=void 0!==this.interval?this.interval:350,this.options.showTicks=void 0!==this.showTicks&&this.showTicks,this.options.showTicksValues=void 0!==this.showTicksValues&&this.showTicksValues,this.options.ticksArray=void 0!==this.ticksArray?this.ticksArray:null,this.options.ticksTooltip=void 0!==this.ticksTooltip?this.ticksTooltip:null,this.options.ticksValuesTooltip=void 0!==this.ticksValuesTooltip?this.ticksValuesTooltip:null,this.options.vertical=void 0!==this.vertical&&this.vertical,this.options.getSelectionBarColor="function"==typeof this.getSelectionBarColor()?this.getSelectionBarColor():null,this.options.getTickColor=void 0!==this.getTickColor?this.getTickColor:null,this.options.getPointerColor=void 0!==this.getPointerColor?this.getPointerColor:null,this.options.keyboardSupport=void 0===this.keyboardSupport||this.keyboardSupport,this.options.scale=void 0!==this.scale?this.scale:1,this.options.enforceStep=void 0!==this.enforceStep&&this.enforceStep,this.options.enforceRange=void 0!==this.enforceRange&&this.enforceRange,this.options.noSwitching=void 0!==this.noSwitching&&this.noSwitching,this.options.onlyBindHandles=void 0!==this.onlyBindHandles?this.onlyBindHandles:null,this.options.onStart="function"!=typeof this.onStart()?this.onStart:null,this.options.onChange="function"!=typeof this.onChange()?this.onChange:null,this.options.onEnd=this.publishData,this.options.rightToLeft=void 0!==this.rightToLeft&&this.rightToLeft,this.options.boundPointerLabels=void 0===this.boundPointerLabels||this.boundPointerLabels,this.options.mergeRangeLabelsIfSame=void 0!==this.mergeRangeLabelsIfSame&&this.mergeRangeLabelsIfSame,this.options.customTemplateScope=void 0!==this.customTemplateScope?this.customTemplateScope:null,this.options.logScale=void 0!==this.logScale&&this.logScale,this.options.customValueToPosition=void 0!==this.customValueToPosition?this.customValueToPosition:null,this.options.customPositionToValue=void 0!==this.customPositionToValue?this.customPositionToValue:null,this.options.selectionBarGradient=void 0!==this.selectionBarGradient?this.selectionBarGradient:null,this.options.ariaLabel=void 0!==this.ariaLabel?this.ariaLabel:null,this.options.ariaLabelledBy=void 0!==this.ariaLabelledBy?this.ariaLabelledBy:null,this.options.ariaLabelHigh=void 0!==this.ariaLabelHigh?this.ariaLabelHigh:null,this.options.ariaLabelledByHigh=void 0!==this.ariaLabelledByHigh?this.ariaLabelledByHigh:null,this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.enableResize=void 0===this.enableResize||this.enableResize,this.actionParams="undefined"!=this.actionParams?this.actionParams:this.apiParams?this.apiParams:{},this.style={},d(function(){a.$broadcast("reCalcViewDimensions"),a.$broadcast("rzSliderForceRender")},2e3)},this.$postLink=function(){i.timeoutId=d(i.resize.bind(i),100),angular.element(c).on("resize",i.onResize),"wss"==i.transport&&(i.api||i.msgTag)||"https"==i.transport&&i.api?j(this.transport):null!=i.data?a.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&i.consumeData(a)}):(a.$on("update-data",function(a,b){null==b?null==i.min&&(i.noResults=!0):b[i.serviceTag]?i.consumeData(b[i.serviceTag]):i.consumeData(b)}),a.$emit("waiting-for-data"))},this.onResize=function(){null!=i.timeoutId&&d.cancel(i.timeoutId),i.timeoutId=d(i.resize.bind(i),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(a){b.parent().innerWidth()<240?i.usePopover=!0:i.usePopover=!1},this.$onDestroy=function(){i.msgTag&&f.unsubscribe(i.msgTag,null,a.$id),i.refreshTimer&&h.cancel(i.refreshTimer),null!=i.timeoutId&&d.cancel(i.timeoutId),angular.element(c).off("resize",i.onResize)};var j=function(b){var c={api:i.api,transport:b,msgTag:i.msgTag,apiParams:i.apiParams,useWindowParams:i.useWindowParams,httpMethod:i.httpMethod,widgetId:a.$id};g.scriptrRequest(c,i.consumeData.bind(i)),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=h(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(i.noResults=!0,i.dataFailureMessage="Failed to fetch data.","number"==typeof i.min&&"NaN"!=i.min.toString()&&(i.stalledData=!0,i.dataFailureMessage="Failed to update data.")):("function"==typeof i.onFormatData()&&(a=i.onFormatData()(a)),null!=a?(a=parseFloat(a),!isNaN(a)&&isFinite(a)?(i.min=a,i.rollBackData=a,i.hasData=!0,i.noResults=!1,i.stalledData=!1):(i.noResults=!0,i.min&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format.")):(i.noResults=!0,i.min&&(i.stalledData=!0),i.dataFailureMessage="Failed to update data, invalid data format."))},this.publishData=function(a,b,c,d){"function"==typeof i.onEnd()&&i.onEnd()(a,b,c,d),void 0===i.actionApiParams&&(i.actionApiParams={}),a&&(i.actionApiParams.sliderId=a),b&&(i.actionApiParams.minValue=b),c&&(i.actionApiParams.maxValue=c),d&&(i.actionApiParams.pointerType=d);var e={api:i.actionApi?i.actionApi:i.api,transport:i.actionTransport?i.actionTransport:i.transport,apiParams:i.actionApiParams,useWindowParams:i.actionUseWindowParams?i.actionUseWindowParams:i.useWindowParams,httpMethod:i.actionHttpMethod?i.actionHttpMethod:i.httpMehtod};g.scriptrRequest(e,i.onSlideCallback.bind(i))},i.onSlideCallback=function(a,b){a.status&&"failure"==a.status?(i.actionSuccess=!1,i.min=i.rollBackData,i.actionMessage=a.errorDetail||"Slide action failed."):(i.actionSuccess=!0,i.rollBackData=i.min,i.actionMessage=a.successMessage||"Slide action succeeded."),d(function(){i.actionSuccess=null,i.actionMessage=null},5e3)}}]}),angular.module("Button",["ngAnimate","angularPromiseButtons","ui.bootstrap","ComponentsCommon","DataService"]),angular.module("Button").component("scriptrButton",{bindings:{size:"@",isDisabled:"<?",label:"@",type:"@",onButtonclick:"&",onSuccess:"&",onFailure:"&",data:"<?",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",actionTransport:"@",actionApi:"@",actionApiParams:"<?",actionUseWindowParams:"@",actionHttpMethod:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/button/button.html",controller:["$scope","$q","$element","$window","$timeout","httpClient","wsClient","dataService","$interval",function(a,b,c,d,e,f,g,h,i){var j=this;this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/button-bg.svg",this.hasData=null!=this.label&&""!=this.label,this.label&&!this.data?this.data={label:this.label}:this.data&&this.data.label&&(this.label=null),this.transport=this.transport?this.transport:null,this.actionParams="undefined"!=this.actionParams?this.actionParams:this.apiParams?this.apiParams:{},this.msgTag=this.msgTag?this.msgTag:null,this.type=this.type?this.type:"btn-success",this.size=this.size?this.size:"",this.class=this.type+" "+this.size,this.style={}},this.$postLink=function(){j.timeoutId=e(j.resize.bind(j),100),angular.element(d).on("resize",j.onResize),"wss"==j.transport&&(j.api||j.msgTag)||"https"==j.transport&&j.api?k(this.transport):null!=j.data?a.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&j.consumeData(a)}):(a.$on("update-data",function(a,b){null==b?null!=j.label&&""!=j.label||(j.noResults=!0):b[j.serviceTag]?j.consumeData(b[j.serviceTag]):j.consumeData(b)}),a.$emit("waiting-for-data"))},this.onResize=function(){null!=j.timeoutId&&e.cancel(j.timeoutId),j.timeoutId=e(j.resize.bind(j),100)},this.resize=function(){this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(a){c.parent().innerWidth()<240?j.usePopover=!0:j.usePopover=!1};var k=function(b){var c={api:j.api,transport:b,msgTag:j.msgTag,apiParams:j.apiParams,useWindowParams:j.useWindowParams,httpMethod:j.httpMethod,widgetId:a.$id};h.scriptrRequest(c,j.consumeData.bind(j)),j.fetchDataInterval&&!j.refreshTimer&&(j.refreshTimer=i(function(){k(j.transport)},1e3*j.fetchDataInterval))};this.$onDestroy=function(){j.msgTag&&g.unsubscribe(j.msgTag,null,a.$id),j.refreshTimer&&i.cancel(j.refreshTimer),null!=j.timeoutId&&e.cancel(j.timeoutId),angular.element(d).off("resize",j.onResize)},this.consumeData=function(a,b){a&&a.status&&"failure"==a.status?(j.noResults=!0,j.dataFailureMessage="Failed to load button label.",j.label&&(j.stalledData=!0,j.dataFailureMessage="Failed to update button label.")):("function"==typeof j.onFormatData()&&(a=j.onFormatData()(a,j)),null!=a&&"object"==typeof a&&a.hasOwnProperty("label")?(j.label=a.label,j.hasData=!0,j.noResults=!1,j.stalledData=!1):(j.noResults=!0,null!=j.label&&""!=j.label&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format."))},j.click=function(a){if(!j.isDisabled){var b={api:j.actionApi?j.actionApi:j.api,transport:j.actionTransport?j.actionTransport:j.transport,apiParams:j.actionApiParams,useWindowParams:j.actionUseWindowParams?j.actionUseWindowParams:j.useWindowParams,httpMethod:j.actionHttpMethod?j.actionHttpMethod:j.httpMehtod};h.scriptrRequest(b,j.onClickCallback.bind(j))}},j.onClickCallback=function(a,b){a.status&&"failure"==a.status?(j.actionSuccess=!1,j.actionMessage=a.errorDetail||"Click action failed."):(j.actionSuccess=!0,j.actionMessage=a.successMessage||"Click action succeeded."),e(function(){j.actionSuccess=null,j.actionMessage=null},1e4)}}]}),angular.module("IFrame",[]),angular.module("IFrame").component("scriptrIframe",{bindings:{link:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/IFrame/IFrame.html",controller:["$scope","$sce","$q","$element","$window","$timeout",function(a,b,c,d,e,f){this.$onInit=function(){},this.$postLink=function(){},this.trustSrc=function(a){return b.trustAsResourceUrl(a)}}]}),angular.module("Map",["ngMap","ToggleSwitch","ui.bootstrap","schemaForm","ngAnimate","ngSanitize","angular-underscore/filters","pascalprecht.translate","ngMessages","ComponentsCommon","DataService"]),angular.module("Map").constant("geofenceDetails",{form:[{type:"section",htmlClass:"col-xs-12",items:[{key:"identifier",validationMessage:{unique:"Identifier already taken"},$validators:{unique:function(a,b,c,d){return-1==c.inUseIdentifiers.indexOf(a)}}}]},{type:"section",htmlClass:"col-xs-12",items:[{key:"properties",title:"Geofence Properties",startEmpty:!0,items:[{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-xs-6",items:[{key:"properties[].key"}]},{type:"section",htmlClass:"col-xs-6",items:[{key:"properties[].value"}]}]}]}]}],schema:{type:"object",title:"Schema",properties:{identifier:{title:"Identifier",type:"string"},properties:{type:"array",default:[],items:{type:"object",properties:{key:{title:"Key",type:"string"},value:{title:"Value",type:"string"}}}}},required:[]}}).component("scriptrMap",{transclude:!0,bindings:{sourcesInfo:"<?",clusteredView:"<?",clusteredZoomMax:"<?",clusterZoom:"<?",detailedZoomMin:"<?",focusedMarkerZoom:"<?",pathStrokeOpacity:"@",pathStrokeWeight:"@",maxAssetPoints:"<?",defaultCenter:"@",trackedAsset:"@",selectedTrackedAsset:"@",summaryIcons:"<?",assetsData:"<?",heatMapWeight:"@",heatMapRadius:"@",heatMapOpacity:"@",heatMapGradient:"<?",setMarkerIcon:"&",onSelectAsset:"&",clusterStyles:"<?",geofenceManager:"<?",geofenceData:"<?",heatmap:"<?",bounce:"<?",markerInfoWindow:"<?",customDefaultInfoWindow:"@",data:"<?",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",useWindowParams:"@",serviceTag:"@",fetchDataInterval:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/map/map.html",controller:["$scope","$rootElement","$location","$sce","$compile","$timeout","$interval","$controller","NgMap","defaultConstants","wsClient","httpClient","dataService","$uibModal","$element","geofenceDetails",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this;q.$onInit=function(){var b=this;b.transport=b.transport?b.transport:"wss",b.$wdgid=a.$id,b.pathStrokeOpacity=b.pathStrokeOpacity?b.pathStrokeOpacity:0,b.pathStrokeWeight=b.pathStrokeWeight?b.pathStrokeWeight:5,b.maxAssetPoints=b.maxAssetPoints?b.maxAssetPoints:100,b.defaultcenter=b.defaultcenter?b.defaultcenter:"40.7053111,-74.258188",b.trackedAsset=b.trackedAsset?b.trackedAsset:null,b.clusterStyles=b.clusterStyles?b.clusterStyles:[],b.geofenceManager=!!b.geofenceManager&&b.geofenceManager,a.$parent.summaryIcons={},b.summaryIcons&&angular.forEach(b.summaryIcons,function(b,c){a.$parent.summaryIcons[c]=d.trustAsHtml(b)}),b.trackedAsset?(b.showDetailedMap=!0,b.clusteredView=!1):b.showDetailedMap=!1,b.clusteredView?(b.clusteredZoomMax||(b.clusteredZoomMax=11),b.detailedZoomMin=b.clusteredZoomMax<20?b.clusteredZoomMax+1:b.clusteredZoomMax,b.clusterZoom||(b.clusterZoom=3)):(b.detailedZoomMin||(b.detailedZoomMin=0),b.detailedmapzoom=b.detailedZoomMin),(!b.focusedMarkerZoom||b.clusteredView&&b.focusedMarkerZoom<b.clusteredZoomMax)&&(b.focusedMarkerZoom=b.detailedZoomMin<18?b.detailedZoomMin+3:b.detailedZoomMin),b.selectedTrackedAsset&&(b.showDetailedMap=!0,b.detailedmapzoom=b.detailedZoomMin),r(),b.sourcesInfo=b.sourcesInfo,b.markerInfoWindow=void 0===b.markerInfoWindow||b.markerInfoWindow,a.$on("mapFoucsOnMarker",function(a,c){b.focusOnAsset(c)}),a.$on("mapInitialized",function(a,c){b.map=c,1==b.switchStatus&&b.heatmap?(heatmap=new google.maps.visualization.HeatmapLayer({data:_.toArray(b.heatMap),radius:b.heatMapRadius,gradient:b.heatMapGradient,opacity:b.heatMapOpacity}),heatmap.setMap(b.map)):"undefined"!=typeof heatmap&&heatmap.setMap(null),b.geofenceManager&&b.attachGeofencesToMap(c),b.selectedTrackedAsset&&1==b.showDetailedMap&&f(function(){b.selectedTrackedMarker&&b.showAssetInfo(null,b.selectedTrackedMarker,b.selectedTrackedMarker.assetKey,b.selectedTrackedMarker.tripKey,b.selectedTrackedMarker.id)},1e3)}),b.geofenceManager&&(b.geofencesIncrement=0,b.geofenceMenuDisplayed=!1,b.geofencesLoaded||b.loadGeofences(),google.maps.event.addDomListener(document,"click",function(a){1==b.geofenceMenuDisplayed&&(menuBox=o.find(".geofence-menu")[0],menuBox.style.display="none",b.geofenceMenuDisplayed=!1)}))},this.$onDestroy=function(){q.msgTag&&k.unsubscribe(q.msgTag,null,a.$id),q.refreshTimer&&g.cancel(q.refreshTimer)},q.sources={},q.assets={},q.selectedAsset="all",q.markerClusterer=null,q._hiddenAssets={},q.assetsKeys=[],q.mapcenter=null,q.infoWindow=null,q.dynMarkers={},q.heatMap={},q.heatMapRadius=q.heatMapRadius?q.heatMapRadius:40,q.heatMapOpacity=q.heatMapOpacity?q.heatMapOpacity:.8,q.heatMapGradient=q.heatMapGradient?q.heatMapGradient:["rgba(0, 255, 255, 0)","rgba(0, 255, 255, 1)","rgba(0, 191, 255, 1)","rgba(0, 127, 255, 1)","rgba(0, 63, 255, 1)","rgba(0, 0, 255, 1)","rgba(0, 0, 223, 1)","rgba(0, 0, 191, 1)","rgba(0, 0, 159, 1)","rgba(0, 0, 127, 1)","rgba(63, 0, 91, 1)","rgba(127, 0, 63, 1)","rgba(191, 0, 31, 1)","rgba(255, 0, 0, 1)"];var r=function(){s(q.transport),q.assetsData?(console.log("static assets data",q.assetsData),q.processAssets(q.assetsData)):q.data&&(console.log("static assets data",q.data),q.processAssets(q.data))},s=function(b){if("wss"==b&&(q.api||q.msgTag)||"https"==b&&q.api){var c={api:q.api,transport:b,msgTag:q.msgTag,apiParams:q.apiParams,useWindowParams:q.useWindowParams,httpMethod:q.httpMethod,widgetId:a.$id};m.scriptrRequest(c,q.processAssets.bind(q)),q.fetchDataInterval&&!q.refreshTimer&&(q.refreshTimer=g(function(){s(q.transport)},1e3*q.fetchDataInterval))}else a.$emit("waiting-for-data"),a.$on("update-data",function(a,b){b&&(b[q.serviceTag]?q.consumeData(b[q.serviceTag]):q.consumeData(b))})};q.processAssets=function(a){q.onFormatData&&"function"==typeof q.onFormatData()&&(a=q.onFormatData()(a));var b=a,c=function(a){if(q.trackedAsset&&q.trackedAsset!=b)a.hasOwnProperty(q.trackedAsset)&&q.pushAssets(q.trackedAsset,a[q.trackedAsset]);else for(var b in a)a.hasOwnProperty(b)&&(console.log(b,a[b]),q.pushAssets(b,a[b]));q.renderAssets(),!q.clusteredView||q.trackedAsset||q.selectedTrackedAsset||q.renderClusterer()};!q.clusteredView||q.markerClusterer||q.trackedAsset||q.selectedTrackedAsset?c(b):i.getMap({id:"clustered-"+q.$wdgid}).then(function(a){q.markerClusterer||q.buildClusterer(a),c(b)},function(a){console.log("Clusterer Map error",a)})},q.activateHeatMap=function(a){1==a?(heatmap=new google.maps.visualization.HeatmapLayer({data:_.toArray(q.heatMap),radius:q.heatMapRadius,gradient:q.heatMapGradient,opacity:q.heatMapOpacity}),heatmap.setMap(q.map)):"undefined"!=typeof heatmap&&heatmap.setMap(null)},q.buildClusterer=function(a){console.log(q.clusterStyles),q.markerClusterer=new MarkerClusterer(a,_.toArray(q.dynMarkers),{maxZoom:q.clusteredZoomMax,imagePath:"https://cdn.rawgit.com/googlemaps/js-marker-clusterer/gh-pages/images/m",minimumClusterSize:-1,gridSize:50,averageCenter:!0,styles:q.clusterStyles})};var t=function(){q.selectedAsset="all",q.renderAssets()};q.renderAssets=function(){console.log("Render New Assets."),"all"==q.selectedAsset?q.showAllAssets():(q.displayedAssets={},q.displayedAssets[q.selectedAsset]=q.assets[q.selectedAsset])},q.renderClusterer=function(){console.log("Render clusterer."),q.markerClusterer.resetViewport(!0),q.markerClusterer.clearMarkers(),q.markerClusterer.addMarkers(_.toArray(q.dynMarkers),!1),q.markerClusterer.repaint()},q.showAllAssets=function(){q.displayedAssets=angular.copy(q.assets,{})},q.onClusteredZoomChanged=function(){q.trackedAsset||q.selectedTrackedAsset||i.getMap({id:"clustered-"+q.$wdgid}).then(function(a){q.map=a,a.getZoom()>=q.detailedZoomMin?(q.showDetailedMap=!0,q.mapcenter=a.getCenter(),q.detailedmapzoom=q.detailedZoomMin):(q.showDetailedMap=!1,q.markerClusterer&&q.markerClusterer.setMap(a),t())})},q.onDetailedZoomChanged=function(){q.trackedAsset||q.selectedTrackedAsset||1!=q.clusteredView||i.getMap({id:"detailed-"+q.$wdgid}).then(function(a){q.map=a,a.getZoom()<=q.clusteredZoomMax?(q.showDetailedMap=!1,q.clusterZoom=q.clusteredZoomMax,t()):q.showDetailedMap=!0})},q.pushAssets=function(a,b){var c=b.source,d=c+"_"+a,e=null;if(q.assets[d]){var f=q.assets[d].markers;e=f[f.length-1]}else q.instantiateAsset(d),q.assets[d].pathColor=w();var g=null,h=null,i=b.order;if(i)for(var k=i.length-1;k>=0;k--){var l=i[k];if(b.hasOwnProperty(l))for(var m=b[l],n=w(),o=w(),p=m.length-1;p>=0;p--){var r=m[p],s={position:r.lat.value+","+r.long.value};s.title="Source: "+c+", Asset: "+a+", trip: "+l+".",s.source=c,s.assetId=a,s.assetKey=d,s.tripKey=l,s.details=r,g=s.details&&s.details.model?s.details.model.value:"",h=s.details&&s.details.make?s.details.make.value:"",s.display=v(h,g,a),e||null!=e?l==e.tripKey?(s.id=d+"-"+l+"-"+(e.pointRef+1),s.pointRef=e.pointRef+1,s.strokeColor=e.strokeColor,s.fillColor=e.fillColor,q.assets[d].markers[f.length-1].icon=u(6,.8,.8,e.strokeColor,e.fillColor)):q.assets[d].markers[f.length-1].icon=u(10,1,1,e.strokeColor,e.fillColor):(s.id=d+"-"+l+"-"+p,s.pointRef=p,s.strokeColor=n,s.fillColor=o),0==k&&0==p?(s.icon=q.sourcesInfo&&q.sourcesInfo[c]&&q.sourcesInfo[c].icon?q.sourcesInfo[c].icon:j.sourceIcon.default,q.assets[d].latestMarker=s):s.icon=0==p?u(10,1,1,n,o):u(6,.8,.8,n,o),q.setMarkerIcon&&"function"==typeof q.setMarkerIcon()&&(s=q.setMarkerIcon()(r,s)),q.controlVehicleTrips(d),q.addMarkerToMap(d,s,r),null==q.mapcenter&&(q.mapcenter=s.position)}}q.addAssetToSourceList(c,d,s.display)},q.addAssetToSourceList=function(a,b,c){q.sources[a]?void 0==_.findWhere(q.sources[a],{key:b})&&q.sources[a].push({key:b,label:c}):q.sources[a]=[{key:b,label:c}]},q.addMarkerToMap=function(b,c,d){if(q.bounce&&d.bounce&&("true"==d.bounce.value||1==d.bounce.value)&&(c.animation=google.maps.Animation.BOUNCE),q.assets[b].markers.push(c),q.assets[b].path.push([d.lat.value,d.long.value]),q.selectedTrackedAsset==c.assetId&&(q.selectedTrackedMarker=c),q.selectedAsset==b&&(a.$parent.marker=c),!q.trackedAsset){var e=angular.copy(c,{});e.position=new google.maps.LatLng(d.lat.value,d.long.value);var f=new google.maps.Marker(e);q.dynMarkers[b]=f;var g={};g.location=e.position,g.weight=q.heatMapWeight?q.heatMapWeight:40,q.heatMap[b]=g}},q.controlVehicleTrips=function(a){
q.maxAssetPoints&&q.assets[a].markers.length>=q.maxAssetPoints&&(q.assets[a].markers.shift(),q.assets[a].path.shift())},q.instantiateAsset=function(a){q.assets[a]={markers:[],path:[],pathColor:"",latestMarker:{},strokeOpacity:q.pathStrokeOpacity,strokeWeight:q.pathStrokeWeight,pathIcon:[{icon:{path:"M 0,-1 0,1",strokeOpacity:1,scale:4},offset:"0",repeat:"20px"}]}};var u=function(a,b,c,d,e){return{path:google.maps.SymbolPath.CIRCLE,fillOpacity:b,strokeWeight:c,scale:a,strokeColor:d,fillColor:e}},v=function(a,b,c){var d=a?a+" ":"";return d+=b?b+"-":"",d+=c};q.focusOnAsset=function(a,b){q.onSelectAsset&&"function"==typeof q.onSelectAsset()&&q.onSelectAsset()(b),q.selectedAsset=a,console.log("selectedAsset",q.selectedAsset),console.log("markerInfoWindow",q.markerInfoWindow),q.showDetailedMap=!0,null!=q.infoWindow&&q.infoWindow.close(),"all"==q.selectedAsset?(q.detailedmapzoom=q.detailedZoomMin,q.searchText=""):(q.searchText=q.assets[a].latestMarker.display,q.mapcenter=q.assets[q.selectedAsset].latestMarker.position,q.detailedmapzoom=q.focusedMarkerZoom)},q.showAssetInfo=function(b,c,d,e,f){console.log("Show assetInfo assetKey",d),q.selectedAsset=d,q.focusOnAsset(d,c);var g=b?this:null;console.log("self.$wdgid",q.$wdgid),i.getMap({id:"detailed-"+q.$wdgid}).then(function(d){a.$parent.marker=c,g=g||_.findWhere(d.markers,{data:c.assetKey});var e="infoWindowTemplate_"+a.$parent.marker.source;if(console.log("Info window",e),console.log("self.markerInfoWindow",q.markerInfoWindow),console.log("$scope.map.infoWindows",d.infoWindows),a.map=d,q.markerInfoWindow)if(a.map.infoWindows[e])a.map.showInfoWindow(b,e,g),q.infoWindow=a.map.infoWindows[e];else if(q.customDefaultInfoWindow&&a.map.infoWindows[q.customDefaultInfoWindow])a.map.showInfoWindow(b,q.customDefaultInfoWindow,g),q.infoWindow=a.map.infoWindows[q.customDefaultInfoWindow];else{a.marker=c;var e="infoWindowTemplate_default_"+q.$wdgid;a.map.showInfoWindow(b,e,g),q.infoWindow=a.map.infoWindows[e]}})};var w=function(){var a=Math.floor(16777215*Math.random()).toString(16);return x("#"+a,0)},x=function(a,b){var c=parseInt(a.slice(1),16),d=b<0?0:255,e=b<0?-1*b:b,f=c>>16,g=c>>8&255,h=255&c;return"#"+(16777216+65536*(Math.round((d-f)*e)+f)+256*(Math.round((d-g)*e)+g)+(Math.round((d-h)*e)+h)).toString(16).slice(1)};q.isEmptyObject=function(a){return 0==Object.keys(a).length},q.drawingControl=["rectangle","circle","polygon"],q.drawingOptions={position:"TOP_CENTER",drawingModes:["rectangle","circle","polygon"]},q.geoFencesList=[],q.geofencesVisible=!0,q.overlaySettings={fillColor:"#444",fillOpacity:.2,strokeWeight:3,strokeColor:"#ff8c00",clickable:!0,zIndex:1,editable:!0,draggable:!0},q.loadGeofences=function(){q.geofenceData["api-params"]?q.geofenceData["api-params"].assetId=q.selectedAsset:q.geofenceData["api-params"]={assetId:q.selectedAsset};var b={api:q.geofenceData["load-api"],transport:q.geofenceData.transport||q.transport,apiParams:q.geofenceData["api-params"],useWindowParams:q.geofenceData["use-window-params"],httpMethod:q.geofenceData["http-method"],widgetId:a.$id};m.scriptrRequest(b,q.consumeLoadedGeofences.bind(q))},q.consumeLoadedGeofences=function(a){q.geofencesLoaded=!0,_.each(a,function(a){y(a,null)}),i.getMap({id:"detailed-"+q.$wdgid}).then(function(a){q.attachGeofencesToMap(a)}),i.getMap({id:"clustered-"+q.$wdgid}).then(function(a){q.attachGeofencesToMap(a)})},q.attachGeofencesToMap=function(a){_.each(q.geoFencesList,function(b){b.overlayInstance.setMap(a)})};var y=function(a,b){var c={};c.fillColor=q.overlaySettings.fillColor,c.fillOpacity=q.overlaySettings.fillOpacity,c.strokeWeight=q.overlaySettings.strokeWeight,c.strokeColor=q.overlaySettings.strokeColor,c.clickable=q.overlaySettings.clickable,c.zIndex=q.overlaySettings.zIndex,c.editable=q.overlaySettings.editable,c.draggable=q.overlaySettings.draggable,b&&(c.map=b);var d="string"==typeof a?JSON.parse(a):a,e=d.type,f=null;"rectangle"==e&&(c.bounds=d.overlay.bounds,f=new google.maps.Rectangle(c)),"circle"==e&&(c.center=d.overlay.center,c.radius=d.overlay.radius,f=new google.maps.Circle(c)),"polygon"==e&&(c.path=d.overlay.path,f=new google.maps.Polygon(c)),delete d.overlay,delete d.type,f&&q.setupOverlay(f,e,d.dataModel)},z=function(a,b,c){return"circle"==b?{dataModel:c,type:"circle",overlay:{radius:a.getRadius(),center:a.getCenter()},overlayInstance:a}:"rectangle"==b?{dataModel:c,type:"rectangle",overlay:{bounds:a.getBounds()},overlayInstance:a}:"polygon"==b?{dataModel:c,type:"polygon",overlay:{path:a.getPath().getArray()},overlayInstance:a}:void 0};q.createLocalGeofence=function(a,b,c){var d=z(a,b,c);d&&(q.geoFencesList.push(d),console.log("Push to list: ",q.geoFencesList)),q.reminderToSave()},q.updateLocalGeofence=function(a,b){_.each(q.geoFencesList,function(c,d,e){if(a===c.dataModel.identifier){var f=z(b,c.type,b.get("dataModel"));f&&(e[d]=f,console.log("Push to list: ",q.geoFencesList))}}),q.reminderToSave()},q.onMapOverlayCompleted=function(a){q.setupOverlay(a.overlay,a.type)},q.setupOverlay=function(a,b,c){var d={},e=_.pluck(_.pluck(q.geoFencesList,"dataModel"),"identifier");do{q.geofencesIncrement++;var f="Geofence_"+q.geofencesIncrement}while(e.indexOf(f)>-1);var d=c&&c.identifier?c:{identifier:f};a.set("dataModel",d),q.createLocalGeofence(a,b,d),c&&c.identifier||(q.rightClickedOverlay=a,q.editSelectedGeofenceSettings()),q.disableContextMenuListener=null,google.maps.event.addListener(a,"mouseover",function(a){q.disableContextMenuListener=google.maps.event.addDomListener(document,"contextmenu",function(a){return a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),!1})}),google.maps.event.addListener(a,"mouseout",function(a){q.disableContextMenuListener&&google.maps.event.removeListener(q.disableContextMenuListener)}),google.maps.event.addListener(a,"rightclick",function(a){q.rightClickedOverlay=this;for(prop in a)if(a[prop]instanceof MouseEvent){mouseEvt=a[prop];var b=mouseEvt.clientX,c=mouseEvt.clientY;menuBox=o.find(".geofence-menu"),menuBox.attr("style","left: "+b+"px; top:"+c+"px; display: block;"),mouseEvt.preventDefault(),q.geofenceMenuDisplayed=!0}return!1});var g=function(a){var b=a.get("dataModel").identifier;q.updateLocalGeofence(b,a)};"circle"==b&&(google.maps.event.addListener(a,"center_changed",function(){g(this)}),google.maps.event.addListener(a,"radius_changed",function(){g(this)})),"rectangle"==b&&google.maps.event.addListener(a,"bounds_changed",function(){g(this)})},q.editSelectedGeofenceSettings=function(){var b=null;q.rightClickedOverlay.get("dataModel")&&(b=q.rightClickedOverlay.get("dataModel").identifier);var c=_.pluck(_.pluck(q.geoFencesList,"dataModel"),"identifier"),d={};q.rightClickedOverlay.get("dataModel")&&(d=q.rightClickedOverlay.get("dataModel")),d.inUseIdentifiers=_.filter(c,function(a){return a!=b}),n.open({animation:!0,component:"mapModalComponent",size:"md",scope:a,resolve:{widget:function(){return{label:"Geofence Properties",model:d,schema:angular.copy(p.schema),form:angular.copy(p.form)}}}}).result.then(function(a){"cancel"!=a&&(delete a.inUseIdentifiers,q.rightClickedOverlay.set("dataModel",a),q.updateLocalGeofence(b,q.rightClickedOverlay))},function(){console.info("modal-component for widget update dismissed at: "+new Date)})},q.removeSelectedGeofence=function(){if(q.rightClickedOverlay.get("dataModel")){var a=q.rightClickedOverlay.get("dataModel").identifier;q.geoFencesList=_.filter(q.geoFencesList,function(b,c,d){return a!=b.dataModel.identifier})}q.rightClickedOverlay.setMap(null),q.reminderToSave()},q.drawingMessages=null,q.drawingMessagesTimeout=null,q.clearAllGeofences=function(){_.each(q.geoFencesList,function(a){a.overlayInstance.setMap(null)}),q.geoFencesList=[],q.reminderToSave()},q.hideShowGeofences=function(){_.map(q.geoFencesList,function(a){return a.overlayInstance.setVisible(!q.geofencesVisible)}),q.geofencesVisible=!q.geofencesVisible},q.saveAllGeofences=function(){var b=_.map(q.geoFencesList,function(a){return{dataModel:a.dataModel,overlay:a.overlay,type:a.type}});q.geofenceData["api-params"]?q.geofenceData["api-params"].geofences=b:q.geofenceData["api-params"]={geofences:b};var c={api:q.geofenceData["save-api"],transport:q.geofenceData.transport||q.transport,apiParams:q.geofenceData["api-params"],useWindowParams:q.geofenceData["use-window-params"],httpMethod:q.geofenceData["http-method"],widgetId:a.$id};m.scriptrRequest(c,function(a){q.drawingMessages=JSON.stringify(a),q.drawingMessagesTimeout=f(function(){q.drawingMessages=null},5e3)})},q.reminderToSave=function(){q.drawingMessages="Do not forget to save your changes, once you are done defining your geofences.",q.drawingMessagesTimeout=f(function(){q.drawingMessages=null},5e3)}}]}).constant("defaultConstants",{sourceIcon:{default:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAoCAMAAAA1+gEjAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM5Q0JGQjdENzVBNTExRTY4RDczRThCNDhCQkVDQ0REIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM5Q0JGQjdFNzVBNTExRTY4RDczRThCNDhCQkVDQ0REIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MzlDQkZCN0I3NUE1MTFFNjhENzNFOEI0OEJCRUNDREQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MzlDQkZCN0M3NUE1MTFFNjhENzNFOEI0OEJCRUNDREQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4YqnkxAAAAY1BMVEUAAAD///8fitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitItkdU7mdhJoNpXp91ztuOBveaPxemdzOur0+652vHH4vTV6ffj8Pnx+Pz////2ehAtAAAAEXRSTlMAABAgMEBQYHCAj5+vv8/f7/4ucL8AAAFeSURBVBgZfcEBYqIwFEXRP1FBEUtuVEAa5O1/lY0iFrTOOfaU7Stuqn1mL9zO88vvnM1sKpaqjT3l3NTdVdK1q7nJ7SEnqa+aXGuS3O4yIHxr7jsAmSXOQ+i11AfwzswKIOpVBAozB9RKYmAUopIacLYFBiWnYxwdz0oGYGsHqJX0dBp19EpqOJiHTknNoNFAraQDb0CU1DDXSIqAAZJ6QsOkCfSSAAMGKdLqxOikligNgAFRioQTk1MgShGwEi5SZClKFzhYDmcpshSlM2zNeYiSoNWoBUkRWJnt4SwpcNHoQpB0htLMVkArXaMm8Sq1wMaSPdBpqQMOdrPyQKO5hmRjdzuSY6dJdyQ52MhV3IS6izF2deBuZQ8b3hX2VPLKO3tynheZzWQslbZQMOdXtuAqZrb2Ys2v0t5smXhn70oeMvuD++KusD+tPcmXfZADfm2fFJDZZ2VhC//+5wfrMULZDg3JQwAAAABJRU5ErkJggg=="}}}).component("mapModalComponent",{bindings:{resolve:"<",close:"&",dismiss:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/map/modalContent.html",controller:["$scope",function(a){this.$onInit=function(){this.widget=this.resolve.widget,a.$broadcast("schemaFormRedraw"),this.frmGlobalOptions={destroyStrategy:"remove",formDefaults:{feedback:!1}},this.widget&&(this.widget.schema&&(this.schema=angular.copy(this.widget.schema)),this.widget.form&&(this.form=angular.copy(this.widget.form)),this.model=this.widget.model?angular.copy(this.widget.model):{})},this.onSubmit=function(b){a.$broadcast("schemaFormValidate"),b.$valid&&this.close({$value:this.model})},this.onCancel=function(a){this.schema={},this.form={},this.dismiss({$value:"cancel"}),console.log("Dissmissed")}}]}),agGrid.initialiseAgGridWithAngular1(angular),angular.module("Grid",["agGrid","ui.bootstrap"]),angular.module("Grid").component("scriptrGrid",{bindings:{onLoad:"&onLoad",columnsDefinition:"<columnsDefinition",rowHeight:"<?",enableServerSideSorting:"<?",enableServerSideFilter:"<?",refreshOnEdit:"<?",enableColResize:"<?",pagination:"@",enableDeleteRow:"<?",fixedHeight:"<?",enableAddRow:"<?",cellEditable:"<?",enableClientSideSorting:"<?",api:"@",onInsertRowScript:"@",onDeleteRowScript:"@",transport:"@",enableClientSideFilter:"<?",rowModelType:"@",rowModelSelection:"@",rowDeselection:"<?",onSelectionChanged:"&?",rowData:"<?",suppressFilter:"<?",gridHeight:"@",paginationPageSize:"<?",paginationOverflowSize:"<?",maxConcurrentDatasourceRequests:"<?",paginationInitialRowCount:"<?",maxPagesInCache:"<?",apiParams:"<?",deleteParams:"<?",addParams:"<?",editParams:"<?",onFormatData:"&",onCellValueChanged:"&",onCellClicked:"&",msgTag:"@",class:"@",defaultCellRenderer:"&",onGridReady:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/grid/grid.html",controller:["$scope","$window","$uibModal","$timeout","wsClient","dataStore",function(a,b,c,d,e,f){var g=this;g.broadcastData=null,this.dataSource={getRows:function(a){if(null!=g.broadcastData){if(null!=g.broadcastData.api)var b=g.broadcastData.api;else var b=g.api;if(null!=g.broadcastData.params&&(g.apiParams=g.broadcastData.params),null!=g.broadcastData.transport)var c=g.broadcastData.transport;else var c=g.transport}else var b=g.api,c=g.transport;var d=g.buildParams(a),e=null;"function"==typeof g.onFormatData()&&(e=function(a){return g.onFormatData()(a)}),f.getGridData(b,d,c,e).then(function(b,c){if(b&&b.documents){var d=b.documents,e=parseInt(b.count),f=g.cleanRows(d);a.successCallback(f,e),g.gridOptions.api.sizeColumnsToFit(),null==f||0==f.length?(g.gridOptions.api.showNoRowsOverlay(),angular.element(document.querySelector("#btNext")).attr("disabled","true")):g.gridOptions.api.hideOverlay()}else a.failCallback(),g.gridOptions.api.showNoRowsOverlay()},function(a){console.log("reject",a)})}},this.$onDestroy=function(){g.msgTag&&e.unsubscribe(g.msgTag,null,a.$id),console.log("destory Grid")},this.cleanRows=function(a){Array.isArray(a)||(a=[a]);for(var b=!1,c=0;c<a.length;c++)for(row in a[c])if("key"!=row){b=!1;for(var d=0;d<g.gridOptions.columnDefs.length;d++)if(row==g.gridOptions.columnDefs[d].field){b=!0;break}b||delete a[c][row]}return a},this._createNewDatasource=function(){this.gridOptions.api.setDatasource(this.dataSource)},this.$onInit=function(){this.gridOptions={angularCompileRows:!0,rowHeight:this.rowHeight?this.rowHeight:25,enableSorting:void 0===this.enableClientSideSorting||this.enableClientSideSorting,enableServerSideSorting:void 0===this.enableServerSideSorting||this.enableServerSideSorting,enableServerSideFilter:void 0===this.enableServerSideFilter||this.enableServerSideFilter,enableColResize:void 0!==this.enableColResize&&this.enableColResize,enableFilter:!0,columnDefs:this.columnsDefinition,editType:"fullRow",pagination:void 0!==this.pagination&&this.pagination,cacheBlockSize:this.paginationPageSize?this.paginationPageSize:50,rowData:this.rowData?this.rowData:null,rowModelType:this.api?"infinite":"",rowSelection:this.rowModelSelection?this.rowModelSelection:"multiple",paginationPageSize:this.paginationPageSize?this.paginationPageSize:50,overlayLoadingTemplate:'<span class="ag-overlay-loading-center"><i class="fa fa-spinner fa-spin fa-fw fa-2x"></i> Please wait while your rows are loading</span>',defaultColDef:{filterParams:{apply:!0},suppressFilter:void 0!==this.suppressFilter&&this.suppressFilter,editable:void 0===this.cellEditable||this.cellEditable,cellRenderer:"function"==typeof this.defaultCellRenderer()?this.defaultCellRenderer():null},onSelectionChanged:function(){if(null!=g.onSelectionChanged&&"function"==typeof g.onSelectionChanged())return g.onSelectionChanged()(g.gridOptions,g.gridApi)},onCellClicked:function(){if(null!=g.onCellClicked&&"function"==typeof g.onCellClicked())return g.onCellClicked()(g.gridOptions,g.gridApi)},onRowValueChanged:function(a){g.cellEditable&&(null!=g.onCellValueChanged&&"function"==typeof g.onCellValueChanged()&&g.onCellValueChanged()(g.gridOptions),"infinite"==g.gridOptions.rowModelType&&(g.api?(g.gridOptions.api.showLoadingOverlay(),g._saveData(a)):(g.undoChanges(),g.showAlert("danger","No script defined for cell edit"))))},onGridReady:function(a){if(console.log("the grid is now ready"),d(function(){g.gridOptions.api=a.api,g.gridApi=a.api},3e3),"function"==typeof g.onGridReady()&&g.onGridReady()(g),a.api.filterManager.availableFilters.text.CONTAINS="startsWith",void 0===g.rowData||null==g.rowData||g.rowData&&0==g.rowData.length?g.api?g._createNewDatasource():a.api.setRowData([]):a.api.sizeColumnsToFit(),this.columnsDefinition)for(var b=0;b<this.columnsDefinition.length;b++)this.columnsDefinition[b].hasOwnProperty("type")&&"numeric"==this.columnsDefinition[b].type&&(this.columnsDefinition[b].filter="number")},onGridSizeChanged:function(a){g.gridOptions.api.sizeColumnsToFit()}},this.fixedHeight=void 0===this.fixedHeight||this.fixedHeight,this.style={},this.fixedHeight?(this.gridHeight=this.gridHeight?this.gridHeight:"500",this.style.height=this.gridHeight,this.style.clear="left",this.style.width="100%"):this.style.height="77%",this.refreshOnEdit=void 0!==this.refreshOnEdit&&this.refreshOnEdit,this.transport=this.transport?this.transport:"wss",this.enableDeleteRow=1!=this.enableDeleteRow,this.enableAddRow=1!=this.enableAddRow,this.mode="infinite"==this.gridOptions.rowModelType?"infinite":"normal",g.msgTag&&f.subscribe(this.onServerCall,g.msgTag,a),a.$on("updateGridData",function(a,b){g.broadcastData=b,g._createNewDatasource()})},this.closeAlert=function(){this.show=!1},this.showAlert=function(a,b){g.message={type:a,content:b},g.showError=!0,d(function(){g.showError=!1},5e3)},this._saveData=function(a){if(a.data&&a.data.key){var b=a.data;if(b.action="edit",this.editParams)for(var c in this.editParams)b[c]=this.editParams[c];f.gridHelper(g.api,b).then(function(a,b){g.gridOptions.api.hideOverlay(),!a||"success"!=a.result&&"success"!=a.status?(g.undoChanges(),a&&a.errorDetail?g.showAlert("danger",a.errorDetail):g.showAlert("danger","An error has occured")):g.refreshOnEdit&&g.onServerCall(a)},function(a){g.gridOptions.api.hideOverlay(),console.log("reject",a),g.showAlert("danger","An error has occured")})}else{var b=a.data;if(b.action="add",this.addParams)for(var c in this.addParams)b[c]=this.addParams[c];f.gridHelper(g.api,a.data).then(function(a,b){g.gridOptions.api.hideOverlay(),!a||"success"!=a.result&&"success"!=a.status?(g.undoChanges(),a&&a.errorDetail?g.showAlert("danger",a.errorDetail):g.showAlert("danger","An error has occured")):g.refreshOnEdit&&g.onServerCall(a)},function(a){g.gridOptions.api.hideOverlay(),console.log("reject",a),g.showAlert("danger","An error has occured")})}},this.onAddRow=function(){for(var a={},b=0;b<g.gridOptions.columnDefs.length;b++)a[g.gridOptions.columnDefs[b].field]="";g.gridOptions.api.insertItemsAtIndex(0,[a]),g.gridOptions.api.setFocusedCell(0,g.gridOptions.columnDefs[0].field),g.gridOptions.api.startEditingCell({rowIndex:0,colKey:g.gridOptions.columnDefs[0].field,charPress:g.gridOptions.columnDefs[0].field})},this.openConfirmationPopUp=function(){g.gridOptions.api.getSelectedNodes().length>0&&c.open({animation:!0,component:"deleteConfirmation",size:"md",resolve:{grid:function(){return g}}})},this.onRemoveRow=function(a){if("infinite"==g.gridOptions.rowModelType)if(g.api){for(var b=g.gridOptions.api.getSelectedNodes(),c=[],d=0;d<b.length;d++)c.push(b[d].data.key);if(c.length>0){g.gridOptions.api.showLoadingOverlay();var e={keys:c,action:"delete"};if(this.deleteParams)for(var a in this.deleteParams)e[a]=this.deleteParams[a];f.gridHelper(g.api,e).then(function(a,b){g.gridOptions.api.hideOverlay(),!a||"success"!=a.result&&"success"!=a.status?a&&a.errorDetail?g.showAlert("danger",a.errorDetail):g.showAlert("danger","An error has occured"):g.onServerCall(a)},function(a){g.gridOptions.api.hideOverlay(),console.log("reject",a),g.showAlert("danger","An error has occured")})}}else g.showAlert("danger","No script defined for delete row");else{var b=g.gridOptions.api.getSelectedNodes();g.gridOptions.api.removeItems(b)}},this.onServerCall=function(a){g.gridOptions.api.refreshInfiniteCache()},this.undoChanges=function(a){g.oldEditedValue?(g.gridOptions.api.forEachNode(function(a){a.childIndex!=g.editedChildIndex&&a.id!=g.editedChildIndex||a.setSelected(!0,!0)}),g.gridOptions.api.getSelectedNodes()[0].data[g.editedColumn]=g.oldEditedValue,g.gridOptions.api.refreshView()):g.gridOptions.api.refreshInfiniteCache()},this.onFilterChanged=function(){this.gridOptions.enableServerSideFilter=!1,this.gridOptions.api.setQuickFilter(this.quickFilterValue),this.gridOptions.enableServerSideFilter=!0},this.onServerFilterChanged=function(){g._createNewDatasource()},this.buildParams=function(a){var b=g.serverFilterText,c=null,d=a.endRow/this.gridOptions.paginationPageSize;if(a.sortModel&&a.sortModel.length>0){var e=a.sortModel[0].sort,f=a.sortModel[0].colId;c=this.gridOptions.api.getColumnDef(f).type?this.gridOptions.api.getColumnDef(f).type:null}if(a.filterModel)for(p in a.filterModel){b=a.filterModel[p].filter;var h=a.filterModel[p].type,i=p;c=this.gridOptions.api.getColumnDef(i).type?this.gridOptions.api.getColumnDef(i).type:null}var j={resultsPerPage:this.gridOptions.paginationPageSize,pageNumber:d};if(f&&(j.sortingColumnName=f),i&&(j.filterColumnName=i),e&&(j.sort=e),c&&(j.sortType=c),b&&(j.queryFilter=b),h&&(j.queryType=h),j.startRow=a.startRow,j.endRow=a.endRow,this.apiParams)for(var k in this.apiParams)j[k]=this.apiParams[k];return j}}]}),angular.module("Grid").service("dataStore",["httpClient","wsClient","$q",function(a,b,c){this.subscribe=function(a,c,d){b.onReady.then(function(){b.subscribe(c,a.bind(self),d.$id)})},this.gridHelper=function(b,d){var e=c.defer();return a.get(b,d,"grid").then(function(a,b){e.resolve(a,b)},function(a){e.reject(a)}),e.promise},this.getGridData=function(d,e,f,g){var h=c.defer();return"https"==f?(a.get(d,e).then(function(a,b){if(g&&(a=g(a)),a&&a.documents){var a={documents:a.documents,count:a.count};h.resolve(a,b)}else h.resolve(null,b)},function(a){h.resolve(null),h.reject(a)}),h.promise):"wss"==f?d&&void 0!==d?(b.onReady.then(function(){b.call(d,e,"grid").then(function(a,b){if(g&&(a=g(a)),a&&a.documents){var a={documents:a.documents,count:a.count};h.resolve(a,b)}else h.resolve(null,b)},function(a){h.resolve(null),h.reject(a)})}),h.promise):(b.onReady.then(function(){b.publish(e,"publish").then(function(a,b){if(a&&a.documents){var a={documents:a.documents,count:a.count};h.resolve(a,b)}else h.resolve(null,b)},function(a){h.resolve(null),h.reject(a)})}),h.promise):void 0}}]),angular.module("Grid").component("deleteConfirmation",{bindings:{resolve:"<",close:"&",dismiss:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/grid/popup.html",controller:["$scope",function(a){this.onSubmit=function(){this.resolve.grid.onRemoveRow(),this.close({$value:!0})},this.onCancel=function(){this.dismiss({$value:!1})}}]}),angular.module("List",["angucomplete-alt"]).component("scriptrAutocomplete",{bindings:{id:"@",objects:"<?",hideObjects:"<?",listSelectedObject:"<?",defaultSetObject:"<?",placeholder:"@",maxlength:"@",pause:"@",selectedObject:"<?",selectedObjectData:"<?",titleField:"@",descriptionField:"@",imageField:"@",minlength:"@",inputName:"@",inputClass:"@",matchClass:"@",localData:"<?",searchFields:"@",clearSelected:"@",overrideSuggestions:"@",fieldRequired:"@",fieldRequiredClass:"@",textSearching:"@",textNoResults:"@",initialValue:"@",inputChanged:"&",autoMatch:"@",focusIn:"&",focusOut:"&",disableInput:"@",focusFirst:"@",fieldTabindex:"@",parseInput:"&",localSearch:"&",transport:"@",msgTag:"@",api:"@",onFormatData:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/list/autocomplete.html",controller:["$scope","wsClient","httpClient",function(a,b,c){var d=this;this.$onInit=function(){this.localData=this.localData?this.localData:[],this.fieldRequired=void 0!==this.fieldRequired&&this.fieldRequired,this.textSearching=void 0!==this.textSearching&&this.textSearching,this.transport=this.transport?this.transport:"wss",this.objects=this.objects?this.objects:[],this.listSelectedObject&&this.objects.length>0&&!d.api&&(a.$broadcast("angucomplete-alt:setData",d.id,this.localData),a.$broadcast("angucomplete-alt:setSelectedObjects",d.id,this.objects)),d.api&&(d.showList=!1,e(this.transport))},d.addObjectToList=function(b){a.$broadcast("angucomplete-alt:addObjectToList",d.id,b),0==this.objects.length&&void 0!==this.defaultSetObject&&(this.objects=JSON.parse(JSON.stringify(this.defaultSetObject)))};var e=function(a){"wss"==a?b.onReady.then(function(){b.subscribe(d.msgTag,d.consumeData.bind(d)),d.api&&b.call(d.api,d.apiParams,d.msgTag).then(function(a,b){d.consumeData(a)})}):"https"==a&&d.api&&c.get(d.api,d.apiParams).then(function(a,b){d.consumeData(a)},function(a){console.log("reject published promise",a)})};this.consumeData=function(b,c){d.showList=!0,"function"==typeof d.onFormatData()&&(b=d.onFormatData()(b)),this.localData=b,this.listSelectedObject&&this.objects.length>0&&(a.$broadcast("angucomplete-alt:setData",d.id,this.localData),a.$broadcast("angucomplete-alt:setSelectedObjects",d.id,this.objects))}}]}),angular.module("ACL",["ui.bootstrap","List"]),angular.module("ACL").component("scriptrAcl",{bindings:{users:"<?",defaultSetObject:"<?",onSave:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/ACL/ACL.html",controller:["$uibModal",function(a){var b=this;this.$onInit=function(){console.log("$onInit initialized"),b.accessType=1==b.users.length&&"anonymous"==b.users[0].code?"Anonymous access":"Restricted access"},this.$postLink=function(){console.log("$postLink initialized")},this.openModal=function(){a.open({animation:!0,size:"lg",component:"aclPopup",resolve:{widget:function(){return{parent:b,users:b.users,defaultSetObject:b.defaultSetObject,onSave:b.onSave}}}}).result.then(function(a){console.log("selectedItem: "+a)},function(){})}}]}),angular.module("ACL").component("aclPopup",{bindings:{resolve:"<",users:"<?",defaultSetObject:"<?",close:"&",dismiss:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/ACL/myModalContent.html",controller:["$scope","$sce",function(a,b){var c=this;c.listScope,this.$onInit=function(){c.users=c.resolve.widget.users,c.defaultSetObject=c.resolve.widget.defaultSetObject,c.popoverContent=b.trustAsHtml("<span style='color: #323232;'><strong>Scriptr.io provides the following predefined groups:</strong><div class='mt10 mb5'><i class='fa fa-caret-right text-primary'></i> authenticated represents anyone with a valid token.</div><div class='mb5'><i class='fa fa-caret-right text-primary'></i> anonymous represents everyone.</div><div class='mb5'><i class='fa fa-caret-right text-primary'></i> nobody represents no one.</div></span>")},this.onSelect=function(a){c.resolve.modalScope=this,"anonymous"==a.originalObject[this.titleField]&&(this.disableInput=!0,this.hideObjects=!0,c.showMsg=!0)},this.removeAnonymousAccess=function(){c.showMsg=!1,c.resolve.modalScope.disableInput=!1,c.resolve.modalScope.hideObjects=!1;var b=[{code:"anonymous",icon:"fa fa-group"}];a.$broadcast("angucomplete-alt:addObjectToList",c.id,b)},this.addAnonymousAccess=function(){c.showMsg=!1,c.resolve.modalScope.disableInput=!1,c.resolve.modalScope.hideObjects=!1;for(var b=[],d=0;d<c.resolve.modalScope.objects.length;d++)"anonymous"!=c.resolve.modalScope.objects[d].code&&b.push(c.resolve.modalScope.objects[d]);a.$broadcast("angucomplete-alt:addObjectToList",c.id,b)},this.closeAlert=function(){this.show=!1},this.showAlert=function(a,b){this.closeAlert(),this.message={type:a,content:b},this.show=!0},this.updateFileACL=function(){c.listScope||(c.listScope=a.$broadcast("angucomplete-alt:getSetObjects",c.id));var b=c.listScope.targetScope.$$childTail.$ctrl;if("function"==typeof c.resolve.widget.onSave()){var d=[];if(void 0===b.objects&&(b.objects=c.resolve.modalScope.objects),b.objects.length>0)var e=b.objects;else var e=c.resolve.widget.defaultSetObject;for(var f=0;f<e.length;f++)d.push(e[f].code);b.showList=!1,c.resolve.widget.onSave()(d).then(function(a,d){b.showList=!0,c.showAlert("success","The Access Control List is saved successfully."),c.resolve.widget.parent.users=b.objects,c.resolve.widget.parent.accessType=1==b.objects.length&&"anonymous"==b.objects[0].code?"Anonymous access":"Restricted access",console.log("success")},function(a){b.showList=!0,c.showMsg("danger",a.data.response.metadata.errorDetail),console.log("reject",a)})}},this.onCancel=function(a){this.dismiss({$value:"cancel"}),console.log("Dissmisseddd")}}]}),angular.module("angular-dygraphs",["ngSanitize"]).directive("ngDygraphs",["$window","$sce",function($window,$sce){return{restrict:"E",scope:{data:"=",options:"="},template:'<div class="ng-dygraphs"><div class="graph"></div></div>',link:function(scope,element,attrs){var parent=element.parent(),mainDiv=element.children()[0],chartDiv=$(mainDiv).children()[0],graph_initialized=!1,annotations=[],legendElement=null;scope.options.showLabelsOnHighlight?(scope.options.labelsDiv="legend_"+scope.$id,div=document.createElement("div"),div.id="legend_"+scope.$id,div.classList.add("dygraphs-legend"),mainDiv.appendChild(div),chartDiv.classList.add("with-legend")):$("#legend_"+scope.$id).hide(),scope.options.labelsSeparateLines=!0,scope.goals=scope.options.goals,scope.goalLineColors=scope.options.goalLineColors,delete scope.options.goals,delete scope.options.goalLineColors,scope.events=scope.options.events,scope.eventLineColors=scope.options.eventLineColors,delete scope.options.events,delete scope.options.eventLineColors,delete scope.options.legendPosition;var graph=new Dygraph(chartDiv,scope.data,scope.options);scope.$watch("data",function(){var a=scope.options;void 0===a&&(a={}),a.file=scope.data,a.underlayCallback=scope.underlayCallback,a.zoomCallback=scope.zoomCallback},!0),scope.$watch("options",function(a){graph.updateOptions(a)},!0),scope.underlayCallback=function(canvas,area,g){var goals=angular.copy(scope.goals);if(goals&&goals.length>0){for(var goalLineColors=angular.copy(scope.goalLineColors),colorsMapping={},x=0;x<goals.length;x++)goalLineColors[x]&&(colorsMapping[goals[x]]=goalLineColors[x]);goals.sort(function(a,b){return a-b});for(var x=goals.length-1;x>=0;x--){var goal=goals[x];if(colorsMapping[goal]){var splitDate=moment().valueOf(),coords=g.toDomCoords(splitDate,goal),splitX=coords[0],splitY=coords[1];canvas.fillStyle=colorsMapping[goal];var topHeight=splitY-area.y,bottomHeight=area.h-topHeight;canvas.fillRect(area.x,splitY,area.w,bottomHeight)}}}var events=eval(scope.events),eventLineColors,colorsMapping,x,x,dayOne,firstDateTime,nextDay,nextDateTime,canvas_left_x,canvas_right_x,canvas_width}}}}]),angular.module("Dygraphs",["angular-dygraphs","ComponentsCommon","DataService"]),angular.module("Dygraphs").component("scriptrDygraphs",{bindings:{onLoad:"&onLoad",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",delta:"<?",resize:"<?",data:"<?",legend:"<?",drawX1Axis:"@",drawYAxis:"@",drawY2Axis:"@",colors:"<?",x1AxisLabelFontSize:"@",yAxisLabelFontSize:"@",y2AxisLabelFontSize:"@",yAxisLabelsKmb:"@",y2AxisLabelsKmb:"@",x1AxisLabelWidth:"@",yAxisLabelWidth:"@",y2AxisLabelWidth:"@",x1AxisLineColor:"@",yAxisLineColor:"@",y2AxisLineColor:"@",x1AxisLineWidth:"@",yAxisLineWidth:"@",y2AxisLineWidth:"@",x1AxisTickSize:"@",x1MinGranularity:"@",yAxisTickSize:"@",y2AxisTickSize:"@",yAxisIncludeZero:"@",y2AxisIncludeZero:"@",x1AxisLabel:"@",yAxisLabel:"@",y2AxisLabel:"@",showRangeSelector:"@",rangeSelectorAlpha:"@",rangeSelectorBackgroundLineWidth:"@",rangeSelectorBackgroundStrokeColor:"@",rangeSelectorForegroundLineWidth:"@",rangeSelectorForegroundStrokeColor:"@",rangeSelectorHeight:"@",rangeSelectorPlotFillColor:"@",rangeSelectorPlotFillGradientColor:"@",rangeSelectorPlotLineWidth:"@",rangeSelectorPlotStrokeColor:"@",goals:"<?",goalLineColors:"<?",events:"<?",eventLineColors:"<?",legendPosition:"@",showLegend:"@",x1DrawGrid:"@",yDrawGrid:"@",y2DrawGrid:"@",x1GridLineColor:"@",yGridLineColor:"@",y2GridLineColor:"@",x1GridLineWidth:"@",yGridLineWidth:"@",y2GridLineWidth:"@",legendLabels:"<?",independentTicks:"@",legendMapping:"<?",customGoals:"<?",customEvents:"<?",colorsMapping:"<?",connectSeparatedPoints:"<?",drawPoints:"<?",pointSize:"<?",strokeWidth:"<?"},
templateUrl:"/UIComponents/dashboard/frontend/components/dygraphs/dygraphs.html",controller:["$rootScope","httpClient","wsClient","$scope","$element","$timeout","$interval","$window","dataService",function(a,b,c,d,e,f,g,h,i){var j=this;this.$onInit=function(){if(this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/dygraphs-line-bg.svg",this.hasData=null!=this.datas&&this.datas.length>0,this._apiParams=this.apiParams?angular.copy(this.apiParams):[],void 0===this.api&&void 0===this.msgTag&&(this.data&&0==this.data.length||null==this.data)&&(this.noResults=!0),this.options={},this.options.axes={},this.options.series={},this.drawX1Axis=!this.drawX1Axis||JSON.parse(this.drawX1Axis),this.drawYAxis=!this.drawYAxis||JSON.parse(this.drawYAxis),this.drawY2Axis=!this.drawY2Axis||JSON.parse(this.drawY2Axis),this.colors=this.colors?this.colors:["#CC5464","#FCC717","#38B9D6","#1DBC68","#E90088"],this.colorsMapping&&this.showLegend&&"true"==this.showLegend){this.colors=_.pluck(this.colorsMapping,"colors"),this.legendLabels=["x"],this.legendLabels=this.legendLabels.concat(_.pluck(this.colorsMapping,"labels")),this.legendMapping=["X"],this.legendMapping=this.legendMapping.concat(_.pluck(this.colorsMapping,"axisSelection")),this.legendUnitsMapping=_.pluck(this.colorsMapping,"unit");for(var a=1;a<this.legendLabels.length;a++)this.legendUnitsMapping[a-1]&&""!=this.legendUnitsMapping[a-1]&&(this.legendLabels[a]=this.legendLabels[a]+" ("+this.legendUnitsMapping[a-1]+")");this.legendLabels=this.legendLabels?this.legendLabels:["X","Y1","Y2","Y3","Y4"],console.log("labels",this.legendLabels),this.legendMapping=this.legendMapping?this.legendMapping:["x","y","y","y2","y2"];for(var b=0;b<this.legendLabels.length;b++){var c=this.legendLabels[b];0!=b&&"y2"==this.legendMapping[b]&&this.drawY2Axis&&(c?this.options.series[c]={axis:this.legendMapping[b]}:this.options.series["Y"+b]={axis:this.legendMapping[b]})}}this.legendLabels&&""!=this.legendLabels&&(this.options.labels=this.legendLabels),this.customGoals=this.customGoals?_.reject(this.customGoals,function(a){return""===a.goals||null==a.goals}):[],this.goalLineColors=_.pluck(this.customGoals,"goal-line-colors"),this.goals=_.pluck(this.customGoals,"goals"),this.customEvents=this.customEvents?_.reject(this.customEvents,function(a){return""===a.events||null==a.events}):[],this.eventLineColors=_.pluck(this.customEvents,"event-line-colors"),this.events=_.pluck(this.customEvents,"events"),this.x1AxisLabelFontSize=this.x1AxisLabelFontSize?JSON.parse(this.x1AxisLabelFontSize):14,this.yAxisLabelFontSize=this.yAxisLabelFontSize?JSON.parse(this.yAxisLabelFontSize):14,this.y2AxisLabelFontSize=this.y2AxisLabelFontSize?JSON.parse(this.y2AxisLabelFontSize):14,this.yAxisLabelsKmb=!!this.yAxisLabelsKmb&&JSON.parse(this.yAxisLabelsKmb),this.y2AxisLabelsKmb=!!this.y2AxisLabelsKmb&&JSON.parse(this.y2AxisLabelsKmb),this.x1AxisLabelWidth=this.x1AxisLabelWidth?JSON.parse(this.x1AxisLabelWidth):60,this.yAxisLabelWidth=this.yAxisLabelWidth?JSON.parse(this.yAxisLabelWidth):250,this.y2AxisLabelWidth=this.y2AxisLabelWidth?JSON.parse(this.y2AxisLabelWidth):50,this.x1AxisLineColor=this.x1AxisLineColor?this.x1AxisLineColor:"#a9a9a9",this.yAxisLineColor=this.yAxisLineColor?this.yAxisLineColor:"#a9a9a9",this.y2AxisLineColor=this.y2AxisLineColor?this.y2AxisLineColor:"#a9a9a9",this.showLegend=!this.showLegend||JSON.parse(this.showLegend),this.x1AxisLabel=this.x1AxisLabel?this.x1AxisLabel:"",this.yAxisLabel=this.yAxisLabel?this.yAxisLabel:"",this.y2AxisLabel=this.y2AxisLabel?this.y2AxisLabel:"",this.x1AxisLineWidth=this.x1AxisLineWidth?JSON.parse(this.x1AxisLineWidth):.3,this.yAxisLineWidth=this.yAxisLineWidth?JSON.parse(this.yAxisLineWidth):.3,this.y2AxisLineWidth=this.y2AxisLineWidth?JSON.parse(this.y2AxisLineWidth):.3,this.x1AxisTickSize=this.x1AxisTickSize?JSON.parse(this.x1AxisTickSize):3,this.yAxisTickSize=this.yAxisTickSize?JSON.parse(this.yAxisTickSize):3,this.y2AxisTickSize=this.y2AxisTickSize?JSON.parse(this.y2AxisTickSize):3,this.yAxisIncludeZero=!!this.yAxisIncludeZero&&JSON.parse(this.yAxisIncludeZero),this.y2AxisIncludeZero=!!this.y2AxisIncludeZero&&JSON.parse(this.y2AxisIncludeZero),this.showRangeSelector=!!this.showRangeSelector&&JSON.parse(this.showRangeSelector),this.rangeSelectorAlpha=this.rangeSelectorAlpha?JSON.parse(this.rangeSelectorAlpha):.6,this.rangeSelectorBackgroundLineWidth=this.rangeSelectorBackgroundLineWidth?JSON.parse(this.rangeSelectorBackgroundLineWidth):1,this.rangeSelectorBackgroundStrokeColor=this.rangeSelectorBackgroundStrokeColor?this.rangeSelectorBackgroundStrokeColor:"#808080",this.rangeSelectorForegroundLineWidth=this.rangeSelectorForegroundLineWidth?JSON.parse(this.rangeSelectorForegroundLineWidth):1,this.rangeSelectorForegroundStrokeColor=this.rangeSelectorForegroundStrokeColor?this.rangeSelectorForegroundStrokeColor:"#000000",this.rangeSelectorHeight=this.rangeSelectorHeight?JSON.parse(this.rangeSelectorHeight):40,this.rangeSelectorPlotFillColor=this.rangeSelectorPlotFillColor?this.rangeSelectorPlotFillColor:"#A7B1C4",this.rangeSelectorPlotFillGradientColor=this.rangeSelectorPlotFillGradientColor?this.rangeSelectorPlotFillGradientColor:"#FFFFFF",this.rangeSelectorPlotLineWidth=this.rangeSelectorPlotLineWidth?JSON.parse(this.rangeSelectorPlotLineWidth):1.5,this.rangeSelectorPlotStrokeColor=this.rangeSelectorPlotStrokeColor?this.rangeSelectorPlotStrokeColor:"#808FAB",this.x1DrawGrid=!this.x1DrawGrid||JSON.parse(this.x1DrawGrid),this.yDrawGrid=!this.yDrawGrid||JSON.parse(this.yDrawGrid),this.y2DrawGrid=!!this.y2DrawGrid&&JSON.parse(this.y2DrawGrid),this.x1GridLineColor=this.x1GridLineColor?this.x1GridLineColor:"#e5e5e5",this.yGridLineColor=this.yGridLineColor?this.yGridLineColor:"#e5e5e5",this.y2GridLineColor=this.y2GridLineColor?this.y2GridLineColor:"#e5e5e5",this.x1GridLineWidth=this.x1GridLineWidth?JSON.parse(this.x1GridLineWidth):.3,this.yGridLineWidth=this.yGridLineWidth?JSON.parse(this.yGridLineWidth):.3,this.y2GridLineWidth=this.y2GridLineWidth?JSON.parse(this.y2GridLineWidth):.3,this.xDrawGrid=!this.xDrawGrid||JSON.parse(this.xDrawGrid),this.independentTicks=this.independentTicks?this.independentTicks:"y-primary",this.x1AxisLabel&&""!=this.x1AxisLabel&&(this.options.xlabel=this.x1AxisLabel),this.yAxisLabel&&""!=this.yAxisLabel&&(this.options.ylabel=this.yAxisLabel),this.y2AxisLabel&&""!=this.y2AxisLabel&&(this.options.y2label=this.y2AxisLabel),this.options.yRangePad="10",this.options.axes.x={},this.options.axes.x.drawAxis=JSON.parse(this.drawX1Axis),this.options.axes.x.axisLabelFontSize=JSON.parse(this.x1AxisLabelFontSize),this.options.axes.x.axisLabelWidth=JSON.parse(this.x1AxisLabelWidth),this.options.axes.x.axisLineColor=this.x1AxisLineColor,this.options.axes.x.axisLineWidth=JSON.parse(this.x1AxisLineWidth),this.options.axes.x.axisTickSize=JSON.parse(this.x1AxisTickSize),this.options.axes.x.independentTicks=!0,this.options.axes.x.ticker=Dygraph.dateTicker,this.options.xValueParser=function(a){return moment(a).format("YYYY-MM-DD kk:mm")},this.options.axes.x.axisLabelFormatter=function(a,b,c){return j.x1MinGranularity&&b<j.x1MinGranularity?Dygraph.dateAxisLabelFormatter(new Date(a),this.x1MinGranularity,c):Dygraph.dateAxisLabelFormatter(new Date(a),b,c)},this.options.axes.x.valueFormatter=function(a){return moment(a).format("YYYY-MM-DD kk:mm")},this.options.axes.y={},this.options.axes.y.drawAxis=JSON.parse(this.drawYAxis),this.options.axes.y.axisLabelFontSize=JSON.parse(this.yAxisLabelFontSize),$(window).innerWidth()<=480?this.options.axes.y.axisLabelWidth=40:this.options.axes.y.axisLabelWidth=JSON.parse(this.yAxisLabelWidth),this.options.axes.y.axisLineColor=this.yAxisLineColor,this.options.axes.y.axisLineWidth=JSON.parse(this.yAxisLineWidth),this.options.axes.y.axisTickSize=JSON.parse(this.yAxisTickSize),this.options.axes.y.includeZero=JSON.parse(this.yAxisIncludeZero),this.options.axes.y.labelsKMB=JSON.parse(this.yAxisLabelsKmb),this.options.digitsAfterDecimal=4;var d=function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c};this.options.axes.y.ticker=Dygraph.numericLinearTicks,this.options.axes.y.axisLabelFormatter=function(a){return d(a,4)},this.options.axes.y2={},this.options.axes.y2.drawAxis=JSON.parse(this.drawY2Axis),this.options.axes.y2.axisLabelFontSize=JSON.parse(this.y2AxisLabelFontSize),$(window).innerWidth()<=480?this.options.axes.y2.axisLabelWidth=40:this.options.axes.y2.axisLabelWidth=JSON.parse(this.yAxisLabelWidth),this.options.axes.y2.axisLineColor=this.y2AxisLineColor,this.options.axes.y2.axisLineWidth=JSON.parse(this.y2AxisLineWidth),this.options.axes.y2.axisTickSize=JSON.parse(this.y2AxisTickSize),this.options.axes.y2.includeZero=JSON.parse(this.y2AxisIncludeZero),this.options.axes.y2.labelsKMB=JSON.parse(this.y2AxisLabelsKmb),this.options.axes.y2.ticker=Dygraph.numericLinearTicks,this.options.axes.y2.axisLabelFormatter=function(a){return d(a,4)},this.options.showRangeSelector=JSON.parse(this.showRangeSelector),this.options.rangeSelectorAlpha=JSON.parse(this.rangeSelectorAlpha),this.options.rangeSelectorBackgroundLineWidth=JSON.parse(this.rangeSelectorBackgroundLineWidth),this.options.rangeSelectorBackgroundStrokeColor=this.rangeSelectorBackgroundStrokeColor,this.options.rangeSelectorForegroundLineWidth=JSON.parse(this.rangeSelectorForegroundLineWidth),this.options.rangeSelectorForegroundStrokeColor=this.rangeSelectorForegroundStrokeColor,this.options.rangeSelectorHeight=JSON.parse(this.rangeSelectorHeight),this.options.rangeSelectorPlotFillColor=this.rangeSelectorPlotFillColor,this.options.rangeSelectorPlotFillGradientColor=this.rangeSelectorPlotFillGradientColor,this.options.rangeSelectorPlotLineWidth=JSON.parse(this.rangeSelectorPlotLineWidth),this.options.rangeSelectorPlotStrokeColor=this.rangeSelectorPlotStrokeColor,this.options.colors=this.colors,this.showLegend?(this.options.showLabelsOnHighlight=!0,this.options.legend="always"):(this.options.showLabelsOnHighlight=!1,this.options.hideOverlayOnMouseOut=!0),this.options.legendPosition=this.legendPosition?this.legendPosition:"top",this.options.axes.x.drawGrid=JSON.parse(this.x1DrawGrid),this.options.axes.y.drawGrid=JSON.parse(this.yDrawGrid),this.options.axes.y2.drawGrid=JSON.parse(this.y2DrawGrid),this.options.axes.x.gridLineColor=this.x1GridLineColor,this.options.axes.y.gridLineColor=this.yGridLineColor,this.options.axes.y2.gridLineColor=this.y2GridLineColor,this.options.axes.x.gridLineWidth=JSON.parse(this.x1GridLineWidth),this.options.axes.y.gridLineWidth=JSON.parse(this.yGridLineWidth),this.options.axes.y2.gridLineWidth=JSON.parse(this.y2GridLineWidth),"y-primary"==this.independentTicks?(this.options.axes.y.independentTicks=!0,this.options.axes.y2.independentTicks=!1):"y2-primary"==this.independentTicks?(this.options.axes.y.independentTicks=!1,this.options.axes.y2.independentTicks=!0):"independent"==this.independentTicks&&(this.options.axes.y.independentTicks=!0,this.options.axes.y2.independentTicks=!0),this.options.goals=this.goals?this.goals:[],this.options.goalLineColors=this.goalLineColors?this.goalLineColors:["#ffffff"],this.options.events=this.events?this.events:[],this.options.eventLineColors=this.eventLineColors?this.eventLineColors:["#ffffff"],this.options.connectSeparatedPoints=null==this.connectSeparatedPoints||this.connectSeparatedPoints,this.options.drawPoints=null==this.drawPoints||this.drawPoints,this.options.strokeWidth=null!=this.strokeWidth?this.strokeWidth:1,this.options.pointSize=null!=this.pointSize?this.pointSize:3,this.transport=this.transport?this.transport:null,this.httpMethod=this.httpMethod?this.httpMethod:"GET",this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.fetchDataInterval=this.fetchDataInterval?parseInt(this.fetchDataInterval):null},this.$postLink=function(){j.timeoutId=f(j.resize.bind(j),100),angular.element(h).on("resize",j.onResize),"wss"==j.transport&&(j.api||j.msgTag)||"https"==j.transport&&j.api?k(this.transport):null!=j.data?d.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&j.consumeData(a)}):(d.$on("update-data",function(a,b){null==b?j.data&&0!=j.data.length||(j.noResults=!0):b[j.serviceTag]?j.consumeData(b[j.serviceTag]):j.consumeData(b)}),d.$emit("waiting-for-data"))},this.onResize=function(){null!=j.timeoutId&&f.cancel(j.timeoutId),j.timeoutId=f(j.resize.bind(j),100)},this.resize=function(){$(window).innerWidth()<=480?(j.options.axes.y2.axisLabelWidth=40,j.options.axes.y.axisLabelWidth=40):(j.options.axes.y2.axisLabelWidth=JSON.parse(j.y2AxisLabelWidth),j.options.axes.y.axisLabelWidth=JSON.parse(j.yAxisLabelWidth)),this.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(a){e.parent().innerWidth()<240?j.usePopover=!0:j.usePopover=!1},this.$onDestroy=function(){console.log("destory chart",j.msgTag,d.$id),j.msgTag&&c.unsubscribe(j.msgTag,null,d.$id),j.refreshTimer&&g.cancel(j.refreshTimer),null!=j.timeoutId&&f.cancel(j.timeoutId),angular.element(h).off("resize",j.onResize)};var k=function(a){var b={api:j.api,transport:a,msgTag:j.msgTag,apiParams:j.apiParams,useWindowParams:j.useWindowParams,httpMethod:j.httpMethod,widgetId:d.$id};i.scriptrRequest(b,j.consumeData.bind(j)),null!=j.fetchDataInterval&&null!=!j.refreshTimer&&(j.refreshTimer=g(function(){k(j.transport)},1e3*j.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(this.noResults=!0,this.dataFailureMessage="Failed to fetch data.",this.datas&&this.datas.length>0&&(this.stalledData=!0,this.dataFailureMessage="Failed to update data.")):null!=a?"object"==typeof a&&Array.isArray(a)?a.length>0?(this.datas&&this.delta?this.datas=this.datas.concat(a):this.datas=a,j.hasData=!0,j.noResults=!1,j.stalledData=!1):(j.noResults=!0,null!=j.datas&&j.datas.length>0&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, no data returned."):(j.noResults=!0,null!=j.datas&&j.datas.length>0&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, invalid data format."):(j.noResults=!0,null!=j.datas&&j.datas.length>0&&(j.stalledData=!0),j.dataFailureMessage="Failed to update data, no data returned.")}}]}),angular.module("angularPlotly",[]).directive("angularPlotly",["$window",function(a,b){return{restrict:"E",template:"<div></div>",scope:{plotlyData:"=",plotlyLayout:"=",plotlyOptions:"=",plotlyEvents:"=",plotlyManualDataUpdate:"="},link:function(b,c){function d(a){b.plotlyEvents(a)}function e(){if(!b.plotlyData)return void(h&&(Plotly.Plots.purge(g),g.innerHTML=""));h=!0,Plotly.newPlot(g,b.plotlyData,b.plotlyLayout,b.plotlyOptions),b.plotlyEvents&&d(g)}function f(){if(h&&b.plotlyData){var a=window.getComputedStyle(g).display;if(a&&"none"!==a&&h&&b.plotlyData)try{Plotly.Plots.resize(g)}catch(a){}}}var g=c[0].children[0],h=!1;b.$watch(function(a){return a.plotlyLayout},function(a,b){angular.equals(a,b)&&h||e()},!0),b.plotlyManualDataUpdate||b.$watch(function(a){return a.plotlyData},function(a,b){angular.equals(a,b)&&h||e()},!1),b.$on("tracesUpdated",function(){e()}),b.$watch(function(){return{h:c[0].offsetHeight,w:c[0].offsetWidth}},function(a,b){angular.equals(a,b)||f()},!0),angular.element(a).bind("resize",f)}}}]),angular.module("Plotly",["angularPlotly","ComponentsCommon","DataService"]),angular.module("Plotly").component("scriptrThreeDSurface",{bindings:{onLoad:"&onLoad",data:"<?",layout:"<?",options:"<?",title:"@",xaxis:"@",yaxis:"@",zaxis:"@",barTitle:"@",barThickness:"<?",showBar:"<?",displaylogo:"<?",showModeBar:"<?",modeBarButtonsToRemove:"<?",colorScale:"<?",contours:"<?",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/plotly/3dsurface.html",controller:["$rootScope","$scope","$window","$element","$timeout","httpClient","wsClient","_","$interval","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;k.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/3dsurface-bg.svg",this.hasData=null!=this.transformedData&&this.transformedData.length>0,k._apiParams=k.apiParams?angular.copy(k.apiParams):[],k.data=k.data?k.data:[],k.contours=k.contours?k.contours:{},k.modeBarButtonsToRemove=k.modeBarButtonsToRemove?k.modeBarButtonsToRemove:[],k.options=k.options?k.options:{displayModeBar:k.showModeBar,modeBarButtonsToRemove:k.modeBarButtonsToRemove,displaylogo:k.displaylogo},angular.element(c).on("resize",k.onResize),k.style={},k.layout=k.layout?k.layout:{autosize:!0,height:d.parent().height(),width:d.parent().width(),scene:{xaxis:{title:k.xaxis},yaxis:{title:k.yaxis},zaxis:{title:k.zaxis}},margin:{l:5,r:5,b:5,t:5}}},k.resize=function(){k.layout.height=d.parent().height(),k.layout.width=d.parent().width(),k.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?k.usePopover=!0:k.usePopover=!1},k.$postLink=function(){k.timeoutId=e(k.resize.bind(k),100),angular.element(c).on("resize",k.onResize),"wss"==k.transport&&(k.api||k.msgTag)||"https"==k.transport&&k.api?initDataService(this.transport):null!=k.data?b.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&k.consumeData(a)}):(b.$on("update-data",function(a,b){null==b?null!=k.transformedData&&0!=k.transformedData.length||(k.noResults=!0):b[k.serviceTag]?k.consumeData(b[k.serviceTag]):k.consumeData(b)}),b.$emit("waiting-for-data"))},k.$onDestroy=function(){k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer),null!=k.timeoutId&&(console.log("timeout inside destroy"),e.cancel(k.timeoutId)),angular.element(c).off("resize",k.onResize)},k.onResize=function(){return null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize,100)},initDataService=function(a){var c={api:k.api,transport:a,msgTag:k.msgTag,apiParams:k.apiParams,useWindowParams:k.useWindowParams,httpMethod:k.httpMethod,widgetId:b.$id};j.scriptrRequest(c,k.consumeData.bind(k)),k.fetchDataInterval&&!k.refreshTimer&&(k.refreshTimer=i(function(){initDataService(k.transport)},1e3*k.fetchDataInterval))},k.consumeData=function(a,b){a.status&&"failure"==a.status?(k.noResults=!0,k.dataFailureMessage="Failed to fetch data.",k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0,k.dataFailureMessage="Failed to update data.")):("function"==typeof this.onFormatData()&&(a=this.onFormatData()(a)),null!=a?"object"==typeof a&&null!=a.x&&Array.isArray(a.x)&&null!=a.y&&Array.isArray(a.y)&&null!=a.z&&Array.isArray(a.z)?(k.transformedData=[{showscale:k.showBar,colorscale:k.colorScale,colorbar:{title:k.barTitle,thickness:k.barThickness},contours:k.contours,z:a.z,x:a.x,y:a.y,type:"surface"}],k.hasData=!0,k.noResults=!1,k.stalledData=!1):(k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, invalid data format."):(k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, no data returned."))}}]}),angular.module("Plotly").component("scriptrWindrose",{bindings:{onLoad:"&onLoad",data:"<?",customRanges:"<?",layout:"<?",options:"<?",showLegend:"@",speedUnit:"@",fontSize:"@",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/plotly/windrose.html",controller:["$rootScope","$scope","$window","$element","$timeout","httpClient","wsClient","_","$interval","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.directions=["N","NNE","ENE","E","ESE","SSE","S","SSW","WSW","W","WNW","NNW"],this.speedUnit=this.speedUnit?this.speedUnit:"m/h",this.noResults=!1,this.showSelectStream=!k.api,this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/wind-rose-bg.svg",this.hasData=null!=this.transformedData&&this.transformedData.length>0,this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.plotCustomRanges=this.customRanges&&this.customRanges.length>0?this.customRanges:[{color:"#CC5464",lo:0,hi:2},{color:"#FCC717",lo:2,hi:4},{color:"#38B9D6",lo:4,hi:6},{color:"#1DBC68",lo:6,hi:8},{color:"#E90088",lo:8,hi:10},{color:"#ffac47",lo:10,hi:20}],this.data=this.data?this.data:[],this.showLegend=this.showLegend?this.showLegend:"true",this.fontSize=this.fontSize?this.fontSize:"12",this.layout={title:"",font:{size:this.fontSize},radialaxis:{ticksuffix:"%"},orientation:270,margin:{l:25,r:15,b:10,t:10}},this.maxRange=h.max(h.pluck(this.plotCustomRanges,"hi")),this.listOfMinRanges=h.pluck(this.plotCustomRanges,"lo"),this.listOfMaxRanges=h.pluck(this.plotCustomRanges,"hi"),this.listOfColors=h.pluck(this.plotCustomRanges,"color"),this.listOfColors.push("#10c3e0"),this.speedUnit=this.speedUnit?this.speedUnit:"",this.style={}},this.onResize=function(){null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize.bind(k),100)},k.resize=function(){if(k.timeoutId=null,c.matchMedia(a.mobileBreakPoint).matches)k.style.height="300";else if(null==k.showLegend||"true"!=k.showLegend){var b=d.parent().innerHeight(),e=d.parent().innerWidth();e<b?k.style.width=e:k.style.height=b}else{var b=d.parent().innerHeight()-10,e=d.parent().innerWidth()-d.find(".plotly-chart-legend").outerWidth(!0)-10;e<b?(k.style.width=e,k.style.height=e):(k.style.height=b,k.style.width=b)}k.layout={title:"",font:{size:k.fontSize},radialaxis:{ticksuffix:"%"},orientation:270,width:k.style.width,height:k.style.height,margin:{l:25,r:15,b:10,t:10}},k.calculateNotificationsDisplay()},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?k.usePopover=!0:k.usePopover=!1},this.$postLink=function(){k.timeoutId=e(k.resize.bind(k),100),angular.element(c).on("resize",k.onResize),"wss"==k.transport&&(k.api||k.msgTag)||"https"==k.transport&&k.api?l(this.transport):null!=k.data?b.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&k.consumeData(a)}):(b.$on("update-data",function(a,b){null==b?null!=k.transformedData&&0!=k.transformedData.length||(k.noResults=!0):b[k.serviceTag]?k.consumeData(b[k.serviceTag]):k.consumeData(b)}),b.$emit("waiting-for-data"))},this.$onDestroy=function(){k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer),null!=k.timeoutId&&e.cancel(k.timeoutId),angular.element(c).off("resize",k.onResize)};var l=function(a){var c={api:k.api,transport:a,msgTag:k.msgTag,apiParams:k.apiParams,useWindowParams:k.useWindowParams,httpMethod:k.httpMethod,widgetId:b.$id};j.scriptrRequest(c,k.consumeData.bind(k)),k.fetchDataInterval&&!k.refreshTimer&&(k.refreshTimer=i(function(){l(k.transport)},1e3*k.fetchDataInterval))};this.consumeData=function(a,b){if(a.status&&"failure"==a.status)k.noResults=!0,k.dataFailureMessage="Failed to fetch data.",k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0,k.dataFailureMessage="Failed to update data.");else if("function"==typeof this.onFormatData()&&(a=this.onFormatData()(a)),null!=a)if("object"==typeof a&&Array.isArray(a))if(a.length>0){if(this.fetchDataInterval&&this.fetchDataInterval>0&&this.data&&this.data.length>0&&this.delta)for(var c=0;c<a.length;c++)this.data[c].speeds=this.data[c].speeds.concat(a[c].speeds),this.data[c].dates=this.data[c].dates.concat(a[c].dates);else this.data=a;a.latestDate&&(this.latestRetrievedDataDate=a.latestDate),this.buildWindRoseData(),k.hasData=!0,k.noResults=!1,k.stalledData=!1}else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, no data returned.";else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, invalid data format.";else k.noResults=!0,null!=k.transformedData&&k.transformedData.length>0&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, no data returned."},this.buildWindRoseData=function(){var a=h.pluck(k.data,"speeds");k.totalSpeeds=0;for(var b=0;b<a.length;b++)k.totalSpeeds+=a[b].length;k.speedRangeDirectionObj={};for(var b=0;b<k.listOfMinRanges.length;b++)k.speedRangeDirectionObj[k.listOfMinRanges[b]+"-"+k.listOfMaxRanges[b]]=[];k.speedRangeDirectionObj[">="+k.maxRange]=[];for(var b=0;k.data&&b<k.data.length;b++){for(var c=k.data[b].direction,d=k.data[b].speeds,f=0;f<k.plotCustomRanges.length;f++){var g=this.plotCustomRanges[f],i=h.filter(d,function(a){return a>=g.lo&&a<g.hi}).length;k.speedRangeDirectionObj[k.plotCustomRanges[f].lo+"-"+k.plotCustomRanges[f].hi].push({direction:c,percentage:i/k.totalSpeeds*100})}var j=k.maxRange,l=h.filter(d,function(a){return a>=j}).length;k.speedRangeDirectionObj[">="+k.maxRange].push({direction:c,percentage:l/k.totalSpeeds*100})}for(var m=Object.keys(k.speedRangeDirectionObj),n=Object.keys(k.speedRangeDirectionObj)[0],o=(k.speedRangeDirectionObj[n],JSON.parse(JSON.stringify(k.speedRangeDirectionObj))[n]),b=0;b<m.length;b++){var p=m[b],q=k.speedRangeDirectionObj[p];if(p!=n){for(var f=0;f<q.length;f++)o[f].percentage=q[f].percentage+o[f].percentage,0!=q[f].percentage&&(q[f].percentage=o[f].percentage);k.speedRangeDirectionObj[p]=q}}k.transformedData=[],m=Object.keys(k.speedRangeDirectionObj);for(var b=m.length-1;b>=0;b--){var r=h.pluck(k.speedRangeDirectionObj[m[b]],"percentage"),s=m[b],t=k.listOfColors[b],u={r:r,t:k.directions,name:s+" "+k.speedUnit,marker:{color:t},type:"area",showlegend:!1};k.transformedData.push(u)}e(k.resize,100)}}]}),angular.module("MetricBox",[]),angular.module("MetricBox").component("scriptrMetricbox",{bindings:{value:"<?",disabled:"<?",label:"@",unit:"@",borderSize:"@",icon:"@",tag:"@",actionIcon:"@",borderColor:"@",backgroundColor:"@",valueFontFamily:"@",valueFontSize:"@",valueCellSize:"@",valueFontWeight:"@",valueTextColor:"@",valueBackgroundColor:"@",valueTextAlignment:"@",labelFontFamily:"@",labelFontSize:"@",labelFontWeight:"@",labelTextColor:"@",labelBackgroundColor:"@",labelTextAlignment:"@",unitFontFamily:"@",unitFontSize:"@",unitCellSize:"@",unitFontWeight:"@",unitTextColor:"@",unitBackgroundColor:"@",unitTextAlignment:"@",api:"@",enableResize:"<?",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&",onActionClicked:"&",fetchDataInterval:"@",useWindowParams:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/metricBox/metricBox.html",controller:["$scope","httpClient","wsClient","$element","$window","$timeout","$interval","$window","dataService",function(a,b,c,d,e,f,g,e,h){var i=this;i.isLoading=!1,this.$onInit=function(){this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.widgetLayout="vertical"==this.widgetLayout?this.widgetLayout:"horizontal",this.value=this.value?isNaN(this.value)?"0":this.value:"0",this.label=this.label?this.label:"Items",this.unit=this.unit?this.unit:"",this.actionIcon=this.actionIcon?this.actionIcon:"",this.icon=this.icon?this.icon:"",this.tag=this.tag?this.tag:"NO_TAG",this.disabled=!!this.disabled&&this.disabled,this.borderSize=this.borderSize?this.borderSize:"1",this.valueCellSize=this.valueCellSize?this.valueCellSize:"",this.borderColor=this.borderColor?this.borderColor:"#ff8c00",this.backgroundColor=this.backgroundColor?this.backgroundColor:"#d7d7d7",this.valueFontFamily=this.valueFontFamily?this.valueFontFamily:"Arial",this.valueFontSize=this.valueFontSize?this.valueFontSize:"42",this.valueFontWeight=this.valueFontWeight?this.valueFontWeight:"600",this.valueTextColor=this.valueTextColor?this.valueTextColor:"#ff8c00",this.valueTextAlignment=this.valueTextAlignment?this.valueTextAlignment:"center",this.labelFontFamily=this.labelFontFamily?this.labelFontFamily:"Arial",this.labelFontSize=this.labelFontSize?this.labelFontSize:"18",this.labelFontWeight=this.labelFontWeight?this.labelFontWeight:"600",this.labelTextColor=this.labelTextColor?this.labelTextColor:"#ff8c00",this.labelTextAlignment=this.labelTextAlignment?this.labelTextAlignment:"center",this.unitFontFamily=this.unitFontFamily?this.unitFontFamily:"Arial",this.unitFontSize=this.unitFontSize?this.unitFontSize:"42",this.unitFontWeight=this.unitFontWeight?this.unitFontWeight:"600",this.unitTextColor=this.unitTextColor?this.unitTextColor:"#ff8c00",this.unitTextAlignment=this.unitTextAlignment?this.unitTextAlignment:"center",this.enableResize=void 0===this.enableResize||this.enableResize,angular.element(e).on("resize",function(){return null!=i.timeoutId&&f.cancel(i.timeoutId),i.timeoutId=f(i.resize,100)}),this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.fetchDataInterval=this.fetchDataInterval?parseInt(this.fetchDataInterval):null,this.style={}},this.$postLink=function(){f(i.resize,100),null!=i.timeoutId&&f.cancel(i.timeoutId),i.timeoutId=f(i.resize,100),j(this.transport)},this.$onDestroy=function(){i.msgTag&&c.unsubscribe(i.msgTag,null,a.$id),i.refreshTimer&&g.cancel(i.refreshTimer)};var j=function(b){h.getData(b,i.api,i.apiParams,i.useWindowParams,i.msgTag,i.consumeData.bind(i),i.fetchDataInterval,a.$id),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=g(function(){j(i.transport)},1e3*i.fetchDataInterval))};a.actionClicked=function(){console.log("actionClicked"),"function"==typeof i.onActionClicked()&&i.onActionClicked()(i.tag,i.value)},this.consumeData=function(a,b){"function"==typeof i.onFormatData()&&(a=i.onFormatData()(a)),i.value=a,"object"==typeof a&&a&&a.value&&"string"==typeof a.value&&(i.value=a.value),"string"==typeof a&&(i.value=a)}}]}),angular.module("Thermometer",["angularThermometer","ComponentsCommon","DataService"]),angular.module("Thermometer").component("scriptrThermometer",{bindings:{onLoad:"&onLoad",transport:"@",api:"@",msgTag:"@",httpMethod:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@",serviceTag:"@",data:"<?",step:"<?",customSectors:"<?",outOfRangeColor:"@",ticks:"<?",percent:"@",unit:"@",height:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/thermometer/thermometer.html",controller:function(a,b,c,d,e,f,g,h,i,j){var k=this;k.showSelectStream=!k.api,this.$onInit=function(){this.icon=this.icon?this.icon:"//scriptr-cdn.s3.amazonaws.com/uicomponents/dashboard-builder/images/thermometer-bg.svg",this.hasData=!(isNaN(parseFloat(this.value))||!isFinite(this.value)),this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.fetchDataInterval=this.fetchDataInterval?parseInt(this.fetchDataInterval):null,this.customSectors=this.customSectors&&this.customSectors.length>0?this.customSectors:[{color:"#CC5464",lo:0,hi:30},{color:"#FCC717",lo:30,hi:60},{color:"#38B9D6",lo:60,hi:90}],this.customSectors&&(this.customSectors=h.reject(this.customSectors,h.isEmpty)),this.outOfRangeColor=this.outOfRangeColor?this.outOfRangeColor:"#E90088",this.thermoUnit=this.unit?this.unit:"C",this.height=this.height?this.height:"100",this.mercuryColor=this.evaluateColor(this.value),this.step=this.step?this.step:"30";var a=this.getLowestTick(),b=this.getHighestTick(),c=parseInt(a);for(this.sectors=[],this.sectors.push(c);c<b;)c+=parseInt(this.step),this.sectors.push(c);this.sectors=this.sectors?this.sectors:[0,30,60,90],this.mercuryMax=h.max(this.sectors),this.minSectorValue=h.min(this.sectors),this.ticks=[];for(var d=0;d<this.sectors.length;d++){var e={};e.tick=this.sectors[d],e.percent=(this.sectors[d]-this.minSectorValue)*this.height/(this.mercuryMax-this.minSectorValue),this.ticks.push(e)}this.transport=this.transport?this.transport:null,this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.style={}},this.onResize=function(){null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize.bind(k),100)},k.resize=function(){k.timeoutId=null,k.style["margin-left"]=d.parent().outerWidth(!0)/2-50,
k.calculateNotificationsDisplay()},this.$postLink=function(){k.timeoutId=e(k.resize.bind(k),100),angular.element(c).on("resize",k.onResize),"wss"==k.transport&&(k.api||k.msgTag)||"https"==k.transport&&k.api?l(this.transport):null!=k.data?b.$watch(function(a){if(a.$ctrl.data)return a.$ctrl.data},function(a,b){JSON.stringify(a)&&k.consumeData(a)}):(b.$on("update-data",function(a,b){null==b?null==k.value&&(k.noResults=!0):b[k.serviceTag]?k.consumeData(b[k.serviceTag]):k.consumeData(b)}),b.$emit("waiting-for-data"))},this.calculateNotificationsDisplay=function(){d.parent().innerWidth()<240?k.usePopover=!0:k.usePopover=!1},this.$onDestroy=function(){k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer),null!=k.timeoutId&&(console.log("timeout inside destroy"),e.cancel(k.timeoutId)),angular.element(c).off("resize",k.onResize)};var l=function(a){var c={api:k.api,transport:a,msgTag:k.msgTag,apiParams:k.apiParams,useWindowParams:k.useWindowParams,httpMethod:k.httpMethod,widgetId:b.$id};j.scriptrRequest(c,k.consumeData.bind(k)),k.fetchDataInterval&&!k.refreshTimer&&(k.refreshTimer=i(function(){l(k.transport)},1e3*k.fetchDataInterval))};this.consumeData=function(a,b){a.status&&"failure"==a.status?(this.noResults=!0,k.dataFailureMessage="Failed to fetch data.",null!=k.value&&(k.stalledData=!0,k.dataFailureMessage="Failed to update data.")):("function"==typeof this.onFormatData()&&(a=k.onFormatData()(a,k)),null!=a?(a=parseFloat(a),!isNaN(a)&&isFinite(a)?(k.mercuryColor=k.evaluateColor(a),k.value=a>k.mercuryMax?k.mercuryMax:a,k.percent=parseInt((a-k.minSectorValue)*k.height/(k.mercuryMax-k.minSectorValue)),k.hasData=!0,k.noResults=!1,k.stalledData=!1,k.timeout=!0):(k.noResults=!0,null!=k.value&&(k.stalledData=!0),k.dataFailureMessage="Failed to update data, invalid data format.")):(k.noResults=!0,null!=k.value&&(k.stalledData=!0)))},this.evaluateColor=function(a){var b=k.outOfRangeColor;return h.some(k.customSectors,function(c){if(c.lo<=a&&a<=c.hi)return b=c.color,!0}),b},this.getLowestTick=function(){return h.min(h.pluck(this.customSectors,"lo"))},this.getHighestTick=function(){return h.max(h.pluck(this.customSectors,"hi"))}}}),angular.module("ProgressBar",["ngAnimate","ngSanitize","ui.bootstrap"]),angular.module("ProgressBar").component("scriptrProgressbar",{bindings:{onLoad:"&onLoad",value:"@",data:"@",type:"@",max:"@",title:"@",class:"@",animate:"<?",stacked:"<?",api:"@",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/progressBar/progressBar.html",controller:function(a,b,c){var d=this;this.$onInit=function(){this.value=this.value?this.value:this.data?this.data:0,this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,e(this.transport)};var e=function(e){"wss"==e?c.onReady.then(function(){d.msgTag&&c.subscribe(d.msgTag,d.consumeData.bind(d),a.$id),d.api&&c.call(d.api,d.apiParams,d.msgTag).then(function(a,b){d.consumeData(a)},function(a){console.log("reject published promise",a),d.consumeData()})}):"https"==e&&d.api&&b.get(d.api,d.apiParams).then(function(a,b){d.consumeData(a)},function(a){console.log("reject published promise",a)})};this.$onDestroy=function(){console.log("destory Progress bar"),d.msgTag&&c.unsubscribe(d.msgTag,null,a.$id)},this.consumeData=function(a,b){"function"==typeof d.onFormatData()&&(a=d.onFormatData()(a)),this.value=Math.round(a)}}});