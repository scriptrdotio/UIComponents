var underscore=angular.module("underscore",[]);underscore.factory("_",["$window",function(a){return a._}]),angular.module("WsClient",["ngWebSocket","ngCookies","underscore"]).provider("wsClient",function(){var a=this,b="wss://api.scriptrapps.io/",c=null,d=null,e=null,f=null,g=null,h={},i=0,j={};this.setBaseUrl=function(a){b=a},this.setPublishChannel=function(a){c=a},this.setSubscribeChannel=function(a){console.log(a),d=a},this.getSubscribeChannel=function(){return d},this.setToken=function(a){e=a};var k=function(){f=b+(e?"/"+e:"")},l=function(a){return i+=1,i>1e4&&(i=0),i},m=function(a,b){return g+"-"+(b?b+"_"+a:a)},n=function(a,b){return b?b+"_"+a:a},o=function(a,b){return g+"-"+(b?b+"_"+a:a)};this.$get=["$websocket","$cookies","$q","$rootScope","_",function(b,e,i,p,q){e.get("token")&&this.setToken(e.get("token")),k();var r=b(f),s={},t=i.defer(),u=i.defer(),v=i.defer(),w=i.defer();r.onOpen(function(){x(d)}),r.onMessage(function(a){try{var b=JSON.parse(a.data);console.log("Received message data from websocket: ",b),"connected."==b.result&&(g=b.id,t&&t.resolve()),"failure"==b.status&&"429"==b.statusCode&&(0==$("body").find(".alert-transport").length&&$("body").append('<div class="alert alert-danger alert-dismissable alert-transport" style="position: absolute; z-index: 1000; top: 0; width: 600px; left: 30%; text-align: center">You have reached you requests rate limit. For more info check the <a href="https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting" target="blank">documentation.</a><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button></div>'),console.error("You have reached your requests rate limit. For more info check the documentation. https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting")),s.data=b,z(b),A(b)}catch(b){console.log("Error when parsing message received over socket",a,b)}}),r.onClose(function(a){console.log("Socket Closed",a),v.resolve(a),"4000"==a.code||"4010"==a.code?w.resolve(a):(console.log("Trying to reconnect closed socket."),r.reconnect())}),r.onError(function(a){console.log("Socket Error",a),u.resolve()});var x=function(a){if(a)if("string"==typeof a)r.send(JSON.stringify({method:"Subscribe",params:{channel:a}}));else if("Array"==a.constructor.name)for(var b=0;b<a.length;b++)r.send(JSON.stringify({method:"Subscribe",params:{channel:a[b]}}))},y=function(a){if(a)if("string"==typeof a)r.send(JSON.stringify({method:"Unsubscribe",params:{channel:a}}));else if("Array"==a.constructor.name)for(var b=0;b<a.length;b++)r.send(JSON.stringify({method:"Unscubscribe",params:{channel:a[b]}}))},z=function(a){var b=a.id;b&&h.hasOwnProperty(b)?(console.log("Execute registered call back for received socket message.",h[b]),p.$apply(h[b].cb.resolve(a.result)),delete h[b]):console.log("No callbacks registerd for received socket message.")},A=function(a){var b=a.id;if(b&&j.hasOwnProperty("subscribeToAll")){console.log("Execute registered call back for received socket message.",j.subscribeToAll);for(var c=j.subscribeToAll,d=0;d<c.length;d++)c[d].cb(a.result)}else if(b&&j.hasOwnProperty(b)){console.log("Execute registered call back for received socket message.",j[b]);for(var c=j[b],d=0;d<c.length;d++)c[d].cb(a.result)}else console.log("No subscribers registerd for received socket message.")};return{getMessage:function(){return s},getStatus:function(){return r.readyState},subscribe:function(a,b,c){if(d){var b={time:new Date,cb:b};c&&(b.id=c),j[a]?j[a].push(b):j[a]=[b]}},unsubscribe:function(a,b,c){if(!a)return void console.log("prefix is mandatory to unsubscribe.");if(console.log("---",j[a]),d)if(!a||b||c){var e={};b&&(e.cb=b),c&&(e.id=c),j[a]=q.difference(j[a],q.where(j[a],e))}else j[a]=[];console.log("+++",j[a])},publish:function(a,b,d){var e=c;if(d&&(e=d),e){var f=i.defer(),g=l(),j=m(g,b);return h[j]={time:new Date,cb:f},a.id=j,console.log("Sending publish message",a),r.send({method:"Publish",params:{channel:e,message:JSON.stringify(a)}}),f.promise}console.log("No channel is defined, message won't be sent.",a)},call:function(a,b,c){var d=i.defer(),e={method:a,params:{body:JSON.stringify(b)}},f=l(),g=o(f,c);return h[g]={time:new Date,cb:d},e.id=n(f,c),console.log("Sending call api request over socket.",e),r.send(e),d.promise},updateSubscriptionChannel:function(b){a.getSubscribeChannel()&&y(a.getSubscribeChannel()),a.setSubscribeChannel(b),x(b)},updatePublishingChannel:function(b){a.setPublishChannel(b)},closeSocket:function(a){a?r.close(a):r.close(!1)},updateTokenAndReconnect:function(){e.get("token")&&a.setToken(e.get("token")),k(),r.url=f,r.close(),r.reconnect()},onReady:t.promise,onError:u.promise,onClose:v.promise,onInvalidAuthentication:w.promise}}]}),angular.module("HttpClient",["ngCookies"]).provider("httpClient",function(){var a="",b=null,c="",d=this;this.setBaseUrl=function(b){a=b,console.log(a)},this.setToken=function(a){b=a,console.log(b)};var e=function(b){c=a+"/"+b,console.log(c)};this.$get=["$cookies","$q","$http",function(a,f,g){a.get("token")&&(b=a.get("token"));var h=function(a,b,c){return a&&a[b]||(a||(a={}),a[b]=c),a},i=function(a,d){var i=f.defer();return e(a),d.url=c,b&&(d.headers=h(d.headers,"Authorization","Bearer "+b)),g(d).then(function(a){if(a.data&&a.data.response){var b=a.data.response;"200"==b.metadata.statusCode&&"success"==b.metadata.status?b.result&&b.result.metadata?"200"==b.result.statusCode&&"success"==b.result.status?i.resolve(b.result.result,a):i.reject(b.result.metadata,a):i.resolve(b.result,a):i.reject(b.metadata,a)}},function(a){console.log("ERROR",a),"429"==a.status&&(0==$("body").find(".alert-transport").length&&$("body").append('<div class="alert alert-danger alert-dismissable alert-transport" style="position: absolute; z-index: 1000; top: 0; width: 600px; left: 30%; text-align: center">You have reached you requests rate limit. For more info check the <a href="https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting" target="blank">documentation.</a><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button></div>'),console.error("You have reached your requests rate limit. For more info check the documentation. https://www.scriptr.io/documentation#documentation-ratelimitingRateLimiting")),i.reject(a)}),i.promise};return{get:function(a,b){var c={method:"GET"};return c.params=b,i(a,c)},post:function(a,b,c){var d={method:"POST"};return d.data=b,c&&(d.headers=c),d.headers=h(d.headers,"Content-Type","application/json"),i(a,d)},updateToken:function(a){d.setToken(a)}}}]}),angular.module("DataService",[]).service("dataService",["$q","httpClient","wsClient","$location",function(a,b,c,d){this.getData=function(a,e,f,g,h,i,j,k){var l={};f||(f={}),l="true"==g?angular.merge(f,d.search()):angular.copy(f),"wss"==a?c.onReady.then(function(){h&&c.subscribe(h,i,k),e&&c.call(e,l,h).then(function(a,b){i(a)},function(a){console.log("reject published promise",a),i()})}):"https"==a&&e&&b.get(e,l).then(function(a,b){i(a)},function(a){console.log("reject published promise",a)})},this.postData=function(e,f,g,h,i,j,k){var l=a.defer(),m={};return g||(g={}),m="true"==h?angular.merge(g,d.search()):angular.copy(g),f?"wss"==e?c.onReady.then(function(){i&&c.subscribe(i,j,k),c.call(f,m,i).then(function(a,b){"function"==typeof j&&j(a),l.resolve({msg:"SUCCESS",details:"",data:a})},function(a){"function"==typeof j&&j(a),l.resolve({msg:"ERROR",details:a,data:{}})})}):"https"==e&&b.post(f,m).then(function(a,b){"function"==typeof j&&j(a),l.resolve({msg:"SUCCESS",details:"",data:a})},function(a){"function"==typeof j&&j(a),l.resolve({msg:"ERROR",details:a,data:{}})}):l.reject({msg:"ERROR",details:"api is undefined",data:{}}),l.promise}}]),angular.module("Display",[]),angular.module("Display").component("scriptrDisplaycount",{bindings:{widgetLayout:"@",data:"@",message:"@",borderSize:"@",borderColor:"@",numberFontFamily:"@",numberFontSize:"@",numberCellSize:"@",numberFontWeight:"@",numberTextColor:"@",numberBackgroundColor:"@",numberTextAlignment:"@",messageFontFamily:"@",messageFontSize:"@",messageFontWeight:"@",messageTextColor:"@",messageBackgroundColor:"@",messageTextAlignment:"@",api:"@",enableResize:"<?",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/displayCount/displayCount.html",controller:["$scope","httpClient","wsClient","$element","$window","$timeout","$interval","$window","dataService",function(a,b,c,d,e,f,g,e,h){var i=this;i.isLoading=!1,this.$onInit=function(){this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.widgetLayout="vertical"==this.widgetLayout?this.widgetLayout:"horizontal",this.data=this.data?isNaN(this.data)?"0":this.data:"0",this.message=this.message?this.message:"Items",this.borderSize=this.borderSize?this.borderSize:"1",this.numberCellSize=this.numberCellSize?this.numberCellSize:"",this.borderColor=this.borderColor?this.borderColor:"#d7d7d7",this.numberFontFamily=this.numberFontFamily?this.numberFontFamily:"Arial",this.numberFontSize=this.numberFontSize?this.numberFontSize:"42",this.numberFontWeight=this.numberFontWeight?this.numberFontWeight:"600",this.numberTextColor=this.numberTextColor?this.numberTextColor:"#ffffff",this.numberTextAlignment=this.numberTextAlignment?this.numberTextAlignment:"center",this.numberBackgroundColor=this.numberBackgroundColor?this.numberBackgroundColor:"#ff8c00",this.messageFontFamily=this.messageFontFamily?this.messageFontFamily:"Arial",this.messageFontSize=this.messageFontSize?this.messageFontSize:"18",this.messageFontWeight=this.messageFontWeight?this.messageFontWeight:"600",this.messageTextColor=this.messageTextColor?this.messageTextColor:"#686868",this.messageBackgroundColor=this.messageBackgroundColor?this.messageBackgroundColor:"white",this.messageTextAlignment=this.messageTextAlignment?this.messageTextAlignment:"center",this.enableResize=void 0===this.enableResize||this.enableResize,angular.element(e).on("resize",function(){return null!=i.timeoutId&&f.cancel(i.timeoutId),i.timeoutId=f(i.resize,100)}),this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.fetchDataInterval=this.fetchDataInterval?parseInt(this.fetchDataInterval):null,this.style={}},this.$postLink=function(){f(i.resize,100),null!=i.timeoutId&&f.cancel(i.timeoutId),i.timeoutId=f(i.resize,100),j(this.transport)},this.$onDestroy=function(){i.msgTag&&c.unsubscribe(i.msgTag,null,a.$id),i.refreshTimer&&g.cancel(i.refreshTimer)};var j=function(b){h.getData(b,i.api,i.apiParams,i.useWindowParams,i.msgTag,i.consumeData.bind(i),i.fetchDataInterval,a.$id),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=g(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){"function"==typeof i.onFormatData()&&(a=i.onFormatData()(a)),i.data=a,"object"==typeof a&&a&&a.data&&"string"==typeof a.data&&(i.data=a.data),"string"==typeof a&&(i.data=a)}}]});var cachedTemplates=["$templateCache",function(a){"use strict";a.put("/UIComponents/dashboard/frontend/components/ACL/ACL.html",'<div class=acl-wrapper ng-click="$ctrl.showAccessControlList = true"><span class=acl-btn ng-class="($ctrl.users.length == 1 && $ctrl.users[0].code == \'anonymous\') ? \'unlocked\' : \'locked\'"><a ng-click=$ctrl.openModal() href=javascript:void(0); uib-tooltip={{$ctrl.accessType}} tooltip-placement=right><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAARCAYAAADZsVyDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkExOUI1NTNCNDc3MzExRTY4OEY2ODFFOTcxN0Q4QkIxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkExOUI1NTNDNDc3MzExRTY4OEY2ODFFOTcxN0Q4QkIxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTE5QjU1Mzk0NzczMTFFNjg4RjY4MUU5NzE3RDhCQjEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTE5QjU1M0E0NzczMTFFNjg4RjY4MUU5NzE3RDhCQjEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6vZpebAAAB2UlEQVR42rSUv0sCYRjH37vu0BNNdG2Qk1ocEk53F1tapdnlqECac2hIbkloFOL8F8IlwqUmQZwOsUHBIZMWRSQHFVTyeh55kzc9Ray+8OX96eee93mfVy6TyRBQCOwh2+kDbCQSiR+TAlgHn5LfKQs+Yyf4P4ASKwZP/kkCbQ2aq23koXdkCU6Cn7cER8FPq8CoS7rpiG6MbgBN1uv1fbfbTVRVXQm+Z6JOriu/Vqt1gK3L5bIPBgMVTNLp9LmmaYN+v/+IaRUscmWsq2v4obfdbl9Mp1NpPB7P51Op1N1wOCROp/MN9sgsGGF+2vdbXQjKbreL4E+EdLvd+TyOUYFAwBeLxXaEhSInTCqWVC6X8RQnDofjcBZJKGTG43ETIuR1XTebzSbX6/VIPp+/EhaK3E+hN1YRy7LsbTQaynd0kUiEwEeIJEkkHA7PwHCZ6GsWbDD9V6u6Nk1zz2az7UJ+fZPJRAQQHn221ul0OGzxIzzPGwKTX4MCo7RdfgkejwF+qFartzAM5nI5DoAIJbVabQZWFOWlWCyGBeboGwnTMBqN5uNCocCx66VSScYYODjexk+MeQT4j0hEUXyHlGjYDwaDWqVSOaZFkN0WTJiy1Gn/iF34EmAAsBK5Pr0LIbQAAAAASUVORK5CYII=" alt=restrictions> <i class="fa fa-lock acl-icon-locked red"></i> <i class="fa fa-unlock-alt acl-icon acl-icon-unlocked light-green"></i></a></span></div>'),a.put("/UIComponents/dashboard/frontend/components/dygraphs/dygraphs.html",'<div class="text-center loading" ng-hide=$ctrl.datas><i class="fa fa-spinner fa-spin fa-3x"></i></div><div class=parent><div class="alert alert-danger" ng-show=$ctrl.noResults>No data to display</div></div><div ng-if="$ctrl.datas && !$ctrl.noResults"><ng-dygraphs data=$ctrl.datas options=$ctrl.options legend=$ctrl.legend></ng-dygraphs></div>'),a.put("/UIComponents/dashboard/frontend/components/ACL/myModalContent.html",'<div class=acl-controls><div class=modal-header><h3 class=modal-title>Access Control List</h3></div><div class=modal-body><div ng-if=$ctrl.show uib-alert ng-class="\'alert-\' + ( $ctrl.message.type || \'warning\')  + \' m10\'" close=$ctrl.closeAlert() dismiss-on-timeout=5000>{{$ctrl.message.content}}</div><h5 class=text-info>List of groups and devices allowed to run the script <a href=javascript:void(0); class=text-primary uib-popover-html=$ctrl.popoverContent popover-placement=right><i class="fa fa-question-circle"></i></a></h5><div ng-show=$ctrl.showMsg class="col-xs-12 center-div alert fadeIn animated alert-info"><div class="col-xs-9 pdl0"><div class="mt8 ml10"><span>Access permission to the "anonymous" predefined group allows anyone to serve the file. Adding it to your access control list will automatically remove any other groups or devices. Are you sure you want to continue?</span></div></div><div class="col-xs-3 pdr0 text-right"><button ng-click=$ctrl.removeAnonymousAccess() type=button class="btn btn-default btn-sm mr5">No</button> <button ng-click=$ctrl.addAnonymousAccess() type=button class="btn btn-primary btn-sm">Yes</button></div></div><scriptr-autocomplete id=devicesList placeholder="Select a user/group" pause=400 hide-list=false search-fields=code default-set-object=$ctrl.defaultSetObject selected-object=$ctrl.onSelect title-field=code objects=$ctrl.users clear-selected=true description-field=description image-field=pic list-selected-object=true minlength=0 text-no-results="No results" text-searching=Searching... transport=https on-format-data=$ctrl.callback api=UIComponents/dashboard/frontend/examples/list/getDevices input-class="form-control form-control-small"></scriptr-autocomplete><div class=clearfix></div><div class="italic text-muted fnt12 mt10"><i class="fa fa-info-circle" aria-hidden=true></i><span id=permissionsNote> Note that removing scriptr device from the access control list will prevent you from serving the file from the IDE.</span></div></div><div class=modal-footer><button type=button class="btn btn-default" ng-click=$ctrl.onCancel()>Close</button> <button type=button class="btn btn-warning" ng-click=$ctrl.updateFileACL()>Save changes</button></div></div>'),a.put("/UIComponents/dashboard/frontend/components/chart/chart.html","<div class=\"text-center loading\" ng-hide=$ctrl.datas><i class=\"fa fa-spinner fa-spin fa-3x\"></i></div><div class=padder10><div ng-show=$ctrl.noResults class=\"alert alert-danger\">No data to display</div></div><div ng-if=\"$ctrl.datas.length > 0\"><div ng-if=\"$ctrl.type == 'line'\"><div class=morris-chart-wrapper ng-class=\"($ctrl.showLegend == 'true' && $ctrl.legendType != 'hover') ? 'with-legend' : ' ' \"><div style=\"height: 85%; width: 100%\" line-data=$ctrl.datas line-xkey={{$ctrl.xkey}} line-ykeys=$ctrl.ykeys line-labels=$ctrl.labels line-colors=$ctrl.colors line-line-width=$ctrl.lineWidth line-point-size=$ctrl.pointSize line-point-fill-colors=$ctrl.pointFillColors line-point-stroke-colors=$ctrl.pointStrokeColors line-ymax=$ctrl.ymax line-ymin=$ctrl.ymin line-smooth=$ctrl.smooth line-hide-hover=$ctrl.hideHover line-hover-callback=$ctrl.hoverCallback line-parse-time=$ctrl.parseTime line-units=$ctrl.units line-post-units=$ctrl.postUnits line-pre-units=$ctrl.preUnits line-line-date-format=$ctrl.dateFormat(x) line-x-labels=$ctrl.xlabels line-x-label-format=$ctrl.xlabelFormat(x) line-x-label-angle=$ctrl.xlabelAngle line-y-label-format=$ctrl.ylabelFormat(y) line-goals=$ctrl.goals line-goal-stroke-width=$ctrl.goalStrokeWidth line-goal-line-colors=$ctrl.goalLineColors line-events=$ctrl.events line-event-stroke-width=$ctrl.eventStrokeWidth line-event-line-colors=$ctrl.eventLineColors line-continuous-line=$ctrl.continuousLine line-axes=$ctrl.axes line-grid=$ctrl.grid line-grid-text-color=$ctrl.gridTextColor line-grid-text-size=$ctrl.gridTextSize , line-grid-text-family=$ctrl.gridTextFamily line-grid-text-weight=$ctrl.gridTextWeight line-fill-opacity=$ctrl.fillOpacity line-resize=$ctrl.resize line-chart></div></div><div class=morris-chart-legend ng-if=\"$ctrl.showLegend && $ctrl.legendType != 'hover'\"><div id=date_{{$ctrl.ref}}>{{$ctrl.legendDate}}</div><ul ng-repeat=\"entry in $ctrl.legendStructure\"><li><span><i class=\"fa fa-square\" ng-style=\"{ 'color' : '{{entry.color}}'}\"></i> {{entry.label}}</span> <span ng-style=\"{ 'color' : '{{entry.color}}'}\" id=value_{{$index}}_{{$ctrl.ref}}>{{entry.value}}</span></li></ul></div></div><div ng-if=\"$ctrl.type == 'bar'\"><div class=morris-chart-wrapper ng-class=\"($ctrl.showLegend == 'true' && $ctrl.legendType != 'hover') ? 'with-legend' : ' ' \"><div style=\"height: 85%; width: 100%\" bar-data=$ctrl.datas bar-x={{$ctrl.xkey}} bar-y=$ctrl.ykeys bar-labels=$ctrl.labels bar-colors=$ctrl.colors bar-resize=$ctrl.resize bar-stacked=$ctrl.stacked bar-hide-hover=$ctrl.hideHover bar-hover-callback=$ctrl.hoverCallback bar-grid=$ctrl.grid bar-grid-text-color=$ctrl.gridTextColor bar-grid-text-size=$ctrl.gridTextSize , bar-grid-text-family=$ctrl.gridTextFamily bar-grid-text-weight=$ctrl.gridTextWeight bar-axes=$ctrl.axes bar-ymax=$ctrl.ymax bar-ymin=$ctrl.ymin bar-goals=$ctrl.goals bar-goal-stroke-width=$ctrl.goalStrokeWidth bar-goal-line-colors=$ctrl.goalLineColors bar-x-label-angle=$ctrl.xlabelAngle bar-y-label-format=$ctrl.ylabelFormat(y) bar-parse-time=$ctrl.parseTime bar-events=$ctrl.events bar-event-stroke-width=$ctrl.eventStrokeWidth bar-event-line-colors=$ctrl.eventLineColors bar-post-units=$ctrl.postUnits bar-pre-units=$ctrl.preUnits bar-chart></div></div><div class=morris-chart-legend ng-if=\"$ctrl.showLegend && $ctrl.legendType != 'hover'\"><div id=date_{{$ctrl.ref}}>{{$ctrl.legendDate}}</div><ul ng-repeat=\"entry in $ctrl.legendStructure\"><li><span><i class=\"fa fa-square\" ng-style=\"{ 'color' : '{{entry.color}}'}\"></i> {{entry.label}}</span> <span ng-style=\"{ 'color' : '{{entry.color}}'}\" id=value_{{$index}}_{{$ctrl.ref}}>{{entry.value}}</span></li></ul></div></div><div ng-if=\"$ctrl.type == 'area'\"><div class=morris-chart-wrapper ng-class=\"($ctrl.showLegend == 'true' && $ctrl.legendType != 'hover') ? 'with-legend' : ' ' \"><div style=\"height: 85%; width: 100%\" area-chart line-colors=$ctrl.colors area-data=$ctrl.datas area-xkey={{$ctrl.xkey}} area-ykeys=$ctrl.ykeys area-labels=$ctrl.labels area-line-width=$ctrl.lineWidth area-point-size=$ctrl.pointSize area-point-fill-colors=$ctrl.pointFillColors area-point-stroke-colors=$ctrl.pointStrokeColors area-ymax=$ctrl.ymax area-ymin=$ctrl.ymin area-smooth=$ctrl.smooth area-hide-hover=$ctrl.hideHover area-hover-callback=\"$ctrl.hoverCallback(index, options, content, row)\" area-parse-time=$ctrl.parseTime area-units=$ctrl.units area-post-units=$ctrl.postUnits area-pre-units=$ctrl.preUnits area-area-date-format=$ctrl.dateFormat(x) area-x-labels=$ctrl.xlabels area-x-label-format=$ctrl.xlabelFormat(x) area-x-label-angle=$ctrl.xlabelAngle area-y-label-format=$ctrl.ylabelFormat(y) area-goals=$ctrl.goals area-goal-stroke-width=$ctrl.goalStrokeWidth area-goal-line-colors=$ctrl.goalLineColors area-events=$ctrl.events area-event-stroke-width=$ctrl.eventStrokeWidth area-event-line-colors=$ctrl.eventLineColors area-continuous-line=$ctrl.continuousLine area-axes=$ctrl.axes area-grid=$ctrl.grid area-grid-text-color=$ctrl.gridTextColor area-grid-text-size=$ctrl.gridTextSize , area-grid-text-family=$ctrl.gridTextFamily area-grid-text-weight=$ctrl.gridTextWeight area-fill-opacity=$ctrl.fillOpacity area-resize=$ctrl.resize area-behave-like-line=$ctrl.behaveLikeLine></div></div><div class=morris-chart-legend ng-if=\"$ctrl.showLegend && $ctrl.legendType != 'hover'\"><div id=date_{{$ctrl.ref}}>{{$ctrl.legendDate}}</div><ul ng-repeat=\"entry in $ctrl.legendStructure\"><li><span><i class=\"fa fa-square\" ng-style=\"{ 'color' : '{{entry.color}}'}\"></i> {{entry.label}}</span> <span ng-style=\"{ 'color' : '{{entry.color}}'}\" id=value_{{$index}}_{{$ctrl.ref}}>{{entry.value}}</span></li></ul></div></div><div ng-if=\"$ctrl.type == 'donut'\" style=\"height: 85%; width: 100%\" donut-data=$ctrl.datas donut-label-color=$ctrl.labelColor donut-background-color=$ctrl.backgroundColor donut-colors=$ctrl.colors donut-formatter=$ctrl.donutFormatter(y,data) donut-resize=$ctrl.resize donut-chart></div></div>"),a.put("/UIComponents/dashboard/frontend/components/gauge/gauge.html",'<div style="width: {{$ctrl.width}}%; height: {{$ctrl.height}}{{$ctrl.heightUnit}};" class=gauge><div value={{$ctrl.gaugeValue}} value-font-color={{$ctrl.valueFontColor}} min={{$ctrl.min}} max={{$ctrl.max}} hide-min-max={{$ctrl.hideMinMax}} hide-value={{$ctrl.hideValue}} show-inner-shadow={{$ctrl.showInnerShadow}} gauge-color={{$ctrl.gaugeColor}} shadow-opacity={{$ctrl.shadowOpacity}} shadow-size={{$ctrl.shadowSize}} custom-sectors={{$ctrl.customSectors}} label={{$ctrl.label}} label-font-color={{$ctrl.labelFontColor}} start-animation-type={{$ctrl.startAnimationType}} refresh-animation-type={{$ctrl.refreshAnimationType}} counter={{$ctrl.counter}} value-font-family={{$ctrl.valueFontFamily}} relative-gauge-size={{$ctrl.relativeGaugeSize}} value-min-font-size={{$ctrl.valueMinFontSize}} label-min-font-size={{$ctrl.labelMinFontSize}} min-label-min-font-size={{$ctrl.minLabelMinFontSize}} max-label-min-font-size={{$ctrl.maxLabelMinFontSize}} gauge-width-scale={{$ctrl.gaugeWidthScale}} shadow-vertical-offset={{$ctrl.shadowVerticalOffset}} level-colors={{$ctrl.levelColors}} no-gradient={{$ctrl.noGradient}} start-animation-time={{$ctrl.startAnimationTime}} refresh-animation-time={{$ctrl.refreshAnimationTime}} donut={{$ctrl.donut}} donut-start-angle={{$ctrl.donutStartAngle}} reverse={{$ctrl.reverse}} decimals={{$ctrl.decimals}} symbol={{$ctrl.symbol}} format-number={{$ctrl.formatNumber}} human-friendly={{$ctrl.humanFriendly}} human-friendly-decimal={{$ctrl.humanFriendlyDecimal}} on-animation-end={{$ctrl.onAnimationEnd}} pointer={{$ctrl.pointer}} justgage></div></div>'),a.put("/UIComponents/dashboard/frontend/components/grid/grid.html",'<div class=filter-bar><div class={{$ctrl.class}}><form><div ng-show="$ctrl.enableClientSideFilter && $ctrl.mode == \'normal\'" class="form-group col-xs-12 col-sm-6"><div class=form-group><input class=form-control ng-change=$ctrl.onFilterChanged() ng-model=$ctrl.quickFilterValue placeholder="Client filter"></div></div><div ng-show="$ctrl.enableServerSideFilter && $ctrl.mode == \'infinite\'" class="form-group col-xs-12 col-sm-6"><div class=form-group><input class=form-control ng-change=$ctrl.onServerFilterChanged() ng-model=$ctrl.serverFilterText placeholder="Server filter"></div></div><div class="col-xs-12 col-sm-6 pull-right text-right"><button ng-hide={{$ctrl.enableDeleteRow}} ng-click=$ctrl.openConfirmationPopUp() class="btn btn-default mt4" tooltip-placement=left uib-tooltip="Delete selected row"><i class="fa fa-close" aria-hidden=true></i></button> <button ng-hide={{$ctrl.enableAddRow}} ng-click=$ctrl.onAddRow() class="btn btn-warning mt4" tooltip-placement=bottom uib-tooltip="Insert row"><i class="fa fa-plus" aria-hidden=true></i></button></div></form></div></div><div class=col-xs-12 ng-show=$ctrl.showError><div class=alert ng-class="\'alert-\' + ( $ctrl.message.type || \'warning\')">{{$ctrl.message.content}}</div></div><div class=clearfix></div><div class=col-xs-12><div ag-grid=$ctrl.gridOptions class=ag-bootstrap ng-style=$ctrl.style></div></div>'),a.put("/UIComponents/dashboard/frontend/components/grid/popup.html",'<div class=modal-header><h3 class=modal-title>Delete</h3></div><div class=modal-body>Are you sure you want to delete the selected row(s)?</div><div class=modal-footer><button class="btn btn-warning" type=button ng-click=$ctrl.onCancel()>No</button> <button class="btn btn-warning" type=button ng-click=$ctrl.onSubmit()>Yes</button></div>'),a.put("/UIComponents/dashboard/frontend/components/list/autocomplete.html",'<div><span ng-show=$ctrl.showList ng-hide=$ctrl.hideObjects class=script-wrap ng-if=$ctrl.listSelectedObject ng-repeat="obj in $ctrl.objects track by $index"><span style="position: relative;"><span class=script-text uib-tooltip={{obj[$ctrl.titleField]}} tooltip-placement=bottom><i class="mr5 text-primary {{obj.icon}}"></i> {{obj[$ctrl.titleField]}}</span> <a ng-if="obj[$ctrl.titleField] != \'nobody\'" href=javascript:void(0); ng-click=$ctrl.addObjectToList(obj) uib-tooltip=Remove tooltip-placement=right><i class="fa fa-close"></i></a></span></span><div class=clearfix></div><div class="text-center loading" ng-show=!$ctrl.showList><i class="fa fa-spinner fa-spin fa-3x"></i></div><angucomplete-alt ng-show=$ctrl.showList id={{$ctrl.id}} placeholder={{$ctrl.placeholder}} default-set-object=$ctrl.defaultSetObject pause={{$ctrl.pause}} hide-objects=$ctrl.hideObjects list-selected-object=$ctrl.listSelectedObject objects=$ctrl.objects selected-object=$ctrl.selectedObject local-data=$ctrl.localData image-field={{$ctrl.imageField}} search-fields={{$ctrl.searchFields}} title-field={{$ctrl.titleField}} description-field={{$ctrl.descriptionField}} image-field={{$ctrl.imageField}} minlength={{$ctrl.minlength}} input-class={{$ctrl.inputClass}} match-class={{$ctrl.matchClass}} maxlength={{$ctrl.maxlength}} selected-object-data=$ctrl.selectedObjectData input-name={{$ctrl.inputName}} clear-selected={{$ctrl.clearSelected}} override-suggestions={{$ctrl.overrideSuggestions}} field-required=$ctrl.fieldRequired field-required-class={{$ctrl.fieldRequiredClass}} initial-value=$ctrl.initialValue input-changed=$ctrl.inputChanged auto-match=$ctrl.autoMatch focus-in=$ctrl.focusIn focus-out=$ctrl.focusOut disable-input=$ctrl.disableInput focus-first=$ctrl.focusFirst field-tabindex={{$ctrl.fieldTabindex}} text-searching={{$ctrl.textSearching}} text-no-results={{$ctrl.textNoResults}}></div>'),
a.put("/UIComponents/dashboard/frontend/components/map/map.html",'<div style="height: 90%;"> \r\n    <section class="map-wrap" ng-if="$ctrl.clusteredView == true || $ctrl.showDetailedMap == false">\r\n        <ng-map id="{{\'clustered-\'+$ctrl.$wdgid}}" on-zoom_changed="$ctrl.onClusteredZoomChanged();"\r\n                single-info-window="true" zoom-to-inlude-markers="true"\r\n                center="{{$ctrl.mapcenter || $ctrl.defaultCenter}}"\r\n                zoom="{{$ctrl.clusterZoom}}">\r\n            \x3c!--heatmap-layer ng-if="$ctrl.heatmap == true"></heatmap-layer--\x3e\r\n        </ng-map>\r\n          <div  class="heatmap" ng-if="$ctrl.heatmap == true">\r\n                <h5>Enable Heatmap</h5>\r\n                  <span>\r\n                    <scriptr-toggle-switch resize="false" on-switch-change="$ctrl.activateHeatMap" switch-status="$ctrl.switchStatus"class="switch-success switch-small"></scriptr-toggle-switch>\r\n                  </span>\r\n        </div>\r\n    </section>\r\n\t<section class="map-wrap" ng-if="$ctrl.clusteredView == false || $ctrl.showDetailedMap == true">\r\n\t\t<ng-map id="{{\'detailed-\'+$ctrl.$wdgid}}" on-zoom_changed="$ctrl.onDetailedZoomChanged();"\r\n\t\t\tsingle-info-window="true" zoom-to-inlude-markers="true"\r\n\t\t\tcenter="{{$ctrl.mapcenter || $ctrl.defaultcenter}}"\r\n\t\t\tzoom="{{$ctrl.detailedmapzoom}}">\r\n            <drawing-manager ng-if="$ctrl.geofenceManager == true"\r\n                on-overlaycomplete="$ctrl.onMapOverlayCompleted()"\r\n                drawing-control-options="{{$ctrl.drawingOptions}}"\r\n                drawingControl="{{$ctrl.drawingControl}}"\r\n                drawingMode="null"\r\n                rectangleOptions="{{$ctrl.overlaySettings}}"\r\n               >\r\n              </drawing-manager>\r\n\t\t<div>\r\n\t\t\t<div ng-repeat="(key, asset) in $ctrl.displayedAssets">\r\n\t\t\t\t<shape name="polyline" path="{{asset.path}}"\r\n\t\t\t\t\tstroke-color="{{asset.pathColor}}"\r\n\t\t\t\t\tstroke-opacity="{{asset.strokeOpacity}}"\r\n\t\t\t\t\tstroke-width="{{asset.strokeWeight}}" icons="{{asset.pathIcon}}">\r\n\t\t\t\t</shape>\r\n\t\t\t\t<div ng-repeat="marker in asset.markers track by $index">\r\n\t\t\t\t\t<div ng-if="$ctrl.trackedAsset == null">\r\n\t\t\t\t\t\t<marker position="{{marker.position}}" title="{{marker.display}}" animation={{marker.animation}}\r\n\t\t\t\t\t\t\ticon="{{marker.icon}}" data="{{marker.assetKey}}"\r\n\t\t\t\t\t\t\ton-click="$ctrl.showAssetInfo(event, marker, \'{{marker.assetKey}}\', \'{{marker.tripKey}}\', \'{{marker.id}}\')">\r\n\t\t\t\t\t\t</marker>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div ng-if="$ctrl.trackedAsset !=null">\r\n\t\t\t\t\t\t<marker position="{{marker.position}}" title="{{marker.title}}" animation={{marker.animation}}\r\n\t\t\t\t\t\t\ticon="{{marker.icon}}" clickable="false">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t\x3c!-- end trip markers loop --\x3e\r\n\t\t\t</div>\r\n\t\t</div>\r\n        <div ng-if="$ctrl.selectedAsset != null && $ctrl.markerInfoWindow == true"  >\r\n\t\t\t<div ng-transclude></div>\r\n          \t<info-window id="{{\'infoWindowTemplate_default_\'+$ctrl.$wdgid}}">\r\n              \t<div ng-non-bindable="">\r\n                  \x3c!-- begin table --\x3e\r\n                  <table class="table table-bordered">\r\n                    <thead>\r\n                      <tr>\r\n                        <th ng-repeat="(key, value) in marker.details">{{key}}</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      <tr>\r\n                        <td ng-repeat="(key, value) in marker.details">{{value.value || "N/A"}}</td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n               </div>\r\n          \t</info-window>\r\n\t\t</div>\r\n        \x3c!--heatmap-layer ng-if="$ctrl.heatmap == true"></heatmap-layer--\x3e     \r\n\t\t</ng-map>\r\n          \r\n        <div  class="messages" ng-show="$ctrl.drawingMessages != null">\r\n            <div class="alert alert-warning">\r\n              {{$ctrl.drawingMessages}}\r\n            </div>\r\n        </div>\r\n        <div  class="heatmap" ng-if="$ctrl.heatmap == true">\r\n                <h5>Enable Heatmap</h5>\r\n                  <span>\r\n                    <scriptr-toggle-switch resize="false" on-switch-change="$ctrl.activateHeatMap" switch-status="$ctrl.switchStatus"class="switch-success switch-small"></scriptr-toggle-switch>\r\n                  </span>\r\n        </div>         \r\n        <div ng-if="$ctrl.geofenceManager == true" class="drawingmanager-buttons">\r\n            <span>\r\n              <a ng-click="$ctrl.removeGeofence()" data-toggle="tooltip" title="Delete geofence" data-placement="bottom"><i class="fa fa-trash" aria-hidden="true"></i></a>\r\n              <a  ng-click="$ctrl.saveGeofence()" data-toggle="tooltip" title="Save geofence" data-placement="bottom"><i class="fa fa-floppy-o" aria-hidden="true"></i></a>\r\n              <a type="button" data-toggle="tooltip" title="Locate geofence" ng-click="$ctrl.focusGeofence()" data-placement="bottom"><i class="fa fa-location-arrow" aria-hidden="true"></i></a>\r\n              <a type="button" data-toggle="tooltip" title="Locate vehicle" ng-click="$ctrl.focusVehicle()" data-placement="bottom"><i class="fa fa-car aria-hidden="true"></i> </a>\r\n            </span>\r\n      </div>\r\n\t</section>\r\n</div>\r\n'),a.put("/UIComponents/dashboard/frontend/components/progressBar/progressBar.html",'<uib-progressbar ng-if=!$ctrl.stacked value=$ctrl.value title={{$ctrl.title}} max=$ctrl.max animate=$ctrl.animate type={{$ctrl.type}} class={{$ctrl.class}}></uib-progressbar><uib-progress ng-if=$ctrl.stacked class={{$ctrl.class}}><uib-bar ng-repeat="bar in $ctrl.stacked track by $index" value=bar.value title={{bar.title}} type={{bar.type}}>{{bar.value}}%</uib-bar></uib-progress>'),a.put("/UIComponents/dashboard/frontend/components/thermometer/thermometer.html",'<div><div ng-style=$ctrl.style class=thermowrapper><tg-thermometer-vertical value={{$ctrl.value}} unit={{$ctrl.thermoUnit}} percent={{$ctrl.percent}} sectors=$ctrl.sectors ticks=$ctrl.ticks height={{$ctrl.height}} mercury-color=$ctrl.mercuryColor ng-show=!$ctrl.noResults></tg-thermometer-vertical></div><div class=parent><div class="alert alert-danger" ng-show=$ctrl.noResults>No data to display</div></div></div>'),a.put("/UIComponents/dashboard/frontend/components/thermometer/tg_thermometer_vertical.html",'<div style="height: 90%" class=tg-thermometer style=display:none><div class=draw-a></div><div class=draw-b><div style="width: 6px;position: absolute;\r\n            left: 0;\r\n            right: 0;\r\n            width: 10px;\r\n            top: 0;\r\n            margin: auto;\r\n            height: 20px;\r\n            border-radius: 10px 10px 0 0;background-color: {{mercuryColor}};"></div><div style="width: 14px;height: 14px; position: absolute;\r\n            left: 0;\r\n            right: 0;\r\n            top: 0;\r\n            bottom: 0;\r\n            margin: auto;\r\n            width: 24px;\r\n            height: 24px;\r\n            border-radius: 50%; background-color: {{mercuryColor}};"></div></div><div class=meter><div class=statistics><div class=percent style="bottom: calc({{val.percent}}% - 2px);" ng-repeat="val in ticks track by $index">{{val.tick}}{{unit}}</div></div><div style="height: {{percent}}%; background-color: {{mercuryColor}}" class=mercury><div class=percent-current>{{value}}{{unit}}</div><div class=mask><div class=bg-color style="height: calc({{height}}% - 57px); background: {{mercuryColor}};"></div></div></div></div></div>'),a.put("/UIComponents/dashboard/frontend/components/odometer/odometer.html","<div ng-style=$ctrl.style><span odometer=$ctrl.odometerValue odometer-options=$ctrl.odometerOptions></span></div>"),a.put("/UIComponents/dashboard/frontend/components/searchBox/searchBox.html",'<div class=row><div class="col-xs-12 col-md-8"><input class="form-control input-sm" ng-keyup="$event.keyCode == 13 ? $ctrl.onFilterChanged() : null" ng-model=$ctrl.searchValue placeholder={{$ctrl.searchText}}></div><div class="col-xs-12 col-md-4"><button ng-click=$ctrl.onFilterChanged() class="btn btn-primary btn-sm btn-block">Go</button></div><div ng-show=$ctrl.noResults class="col-xs-12 alert"><span class="alert alert-danger col-xs-12">no results</span></div></div><div><div class="text-center loading" ng-show=$ctrl.searching><i class="fa fa-spinner fa-spin fa-2x"></i></div><abn-tree tree-data=$ctrl.treeData tree-control=$ctrl.treeControl icon-leaf={{$ctrl.iconLeaf}} icon-expand={{$ctrl.iconExpand}} icon-collapse={{$ctrl.iconCollapse}} on-select=$ctrl.onSelect(branch) expand-level=$ctrl.expandLevel initial-selection=$ctrl.initialSelection></abn-tree></div>'),a.put("/UIComponents/dashboard/frontend/components/speedometer/speedometer.html","<div class=speedometer-wrapper></div>"),a.put("/UIComponents/dashboard/frontend/components/accelerometer/accelerometer.html","<div class=accelerometer-wrapper><div class=\"line y\" ng-style=\"{ 'transform' :  $ctrl.yLine, 'border': '1px solid blue' }\"></div><div class=line ng-style=\"{ 'transform':  $ctrl.xLine}\"></div><div class=angle ng-style=\"{ 'transform':  $ctrl.angle }\"></div><div class=guideX></div><div class=guideY></div></div>"),a.put("/UIComponents/dashboard/frontend/components/button/button.html",'<div ng-style=$ctrl.style><button ng-if=$ctrl.isDisabled disabled class="{{$ctrl.class}} is-disabled ui-button" ng-click=$ctrl.success() promise-btn=$ctrl.successPromise>{{$ctrl.label}}</button> <button ng-if=!$ctrl.isDisabled class="{{$ctrl.class}} ui-button" ng-click=$ctrl.success() promise-btn=$ctrl.successPromise>{{$ctrl.label}}</button></div>'),a.put("/UIComponents/dashboard/frontend/components/slider/slider.html",'<div ng-if=$ctrl.max ng-style=$ctrl.style style="display: none;"><rzslider class={{$ctrl.theme}} rz-slider-model=$ctrl.min rz-slider-high=$ctrl.max rz-slider-options=$ctrl.options></rzslider></div><div ng-if=!$ctrl.max ng-style=$ctrl.style style="display: none;"><rzslider class={{$ctrl.theme}} rz-slider-model=$ctrl.min rz-slider-options=$ctrl.options></rzslider></div>'),a.put("/UIComponents/dashboard/frontend/components/IFrame/IFrame.html",'<iframe style="height: 90%; width: 100%" ng-if=$ctrl.link src={{$ctrl.trustSrc($ctrl.link)}} frameborder=0 allowfullscreen></iframe><h3 ng-if=!$ctrl.link>No URL set</h3>'),a.put("/UIComponents/dashboard/frontend/components/toggleSwitch/toggle_switch.html","<div ng-click=$ctrl.publishData() ng-style=$ctrl.style><toggle-switch ng-model=$ctrl.switchStatus on-label={{$ctrl.onLabel}} off-label={{$ctrl.offLabel}} knob-label={{$ctrl.knobLabel}} is-disabled=$ctrl.isDisabled class={{$ctrl.class}}></toggle-switch></div>"),a.put("/UIComponents/dashboard/frontend/components/plotly/3dsurface.html","<div class=surface><angular-plotly plotly-data=$ctrl.transformedData plotly-options=$ctrl.options plotly-layout=$ctrl.layout></angular-plotly></div>"),a.put("/UIComponents/dashboard/frontend/components/plotly/windrose.html",'<div class=wind-rose><div class=parent><div class="alert alert-danger" ng-show=$ctrl.noResults>No data to display</div></div><div ng-show="$ctrl.transformedData.length > 0" ng-style=$ctrl.style class=plotly-chart-wrapper ng-class="($ctrl.showLegend) ? \'with-legend\' : \' \' "><div class=plotly-chart-dimension><angular-plotly plotly-data=$ctrl.transformedData plotly-options=$ctrl.options plotly-layout=$ctrl.layout></angular-plotly></div></div><div class=plotly-chart-legend ng-if="$ctrl.showLegend && $ctrl.transformedData.length > 0"><ul ng-repeat="entry in $ctrl.plotCustomRanges" style="list-style: none"><li><span><i class="fa fa-square" style="color: {{entry.color}}"></i> {{entry.lo}} - {{entry.hi}} {{$ctrl.speedUnit}}</span></li></ul></div></div>'),a.put("/UIComponents/dashboard/frontend/components/metricBox/metricBox.html","<div class=metric-box ng-style=\"{ 'border' : '{{$ctrl.borderSize}}px solid {{$ctrl.borderColor}}','background' : '{{$ctrl.backgroundColor}}' }\"><div ng-if=$ctrl.disabled id=disabledOverlay></div><div class=metric-box-head><div class=metric-box-action><img ng-if='$ctrl.actionIcon!=\"\"' ng-click=actionClicked() alt=EI src={{$ctrl.actionIcon}}></div><div class=metric-box-label ng-style=\"{\t'font-weight' : '{{$ctrl.labelFontWeight}}', 'font-family' : '{{$ctrl.labelFontFamily}}', 'color' : '{{$ctrl.labelTextColor}}', 'text-align' : '{{$ctrl.labelTextAlignment}}' }\">{{$ctrl.label}}</div></div><div class=metric-box-body><div class=metric-box-value-unit><div class=metric-box-value ng-style=\"{\t'font-weight' : '{{$ctrl.valueFontWeight}}', 'font-family' : '{{$ctrl.valueFontFamily}}', 'color' : '{{$ctrl.valueTextColor}}', 'text-align' : '{{$ctrl.valueTextAlignment}}' }\"><div>{{$ctrl.value}}</div></div><div class=metric-box-unit ng-style=\"{ 'font-weight' : '{{$ctrl.unitFontWeight}}', 'font-family' : '{{$ctrl.unitFontFamily}}', 'color' : '{{$ctrl.unitTextColor}}', 'text-align' : '{{$ctrl.unitTextAlignment}}' }\"><div>{{$ctrl.unit}}</div></div></div><div ng-if='$ctrl.icon!=\"\"' class=metric-box-icon><img alt=EI src={{$ctrl.icon}}></div></div></div>"),a.put("/UIComponents/dashboardBuilder/view/dashboard.html","<dashboard load-tree=true tree-search-criteria=model.Car devices-model=modules/devicemodels/api/getSensors></dashboard>"),a.put("/UIComponents/dashboardBuilder/view/dashboardTemplate.min","<script type=text/x-handlebars-template id=handlebar-template>&lt;html ng-app=&quot;myApp&quot;&gt;\r\n&lt;head&gt;\r\n\r\n    &lt;link rel=&quot;icon&quot; href=&quot;data:;base64,iVBORw0KGgo=&quot;&gt;\r\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&quot; integrity=&quot;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&quot; crossorigin=&quot;anonymous&quot;&gt;\r\n    &lt;script src=&quot;//use.fontawesome.com/3d61d6959e.js&quot;&gt;&lt;/script&gt;\r\n\r\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;/UIComponents/build/external/css/dt_components.min.css&quot;&gt;\r\n    \r\n    &lt;!-- JQUERY Material  To use jQuery, simply ensure it is loaded before the angular.js file. --&gt;\r\n    &lt;script src=&quot;/UIComponents/build/external/js/external_jquery_resources.min.js&quot;&gt;&lt;/script&gt;\r\n  \r\n    &lt;!-- Libraries --&gt;\r\n    &lt;script src=&quot;/UIComponents/build/external/js/dt_external_libraries.min.js&quot;&gt;&lt;/script&gt;\t\r\n    &lt;script src=&quot;//maps.google.com/maps/api/js?key=AIzaSyBcPYghFh_BXz4dDz-TXTHbU2iV3Wbf57I&amp;libraries=drawing,visualization&quot;&gt;&lt;/script&gt;\r\n  \r\n    &lt;!-- NG material --&gt;\r\n    &lt;script src=&quot;/UIComponents/build/external/js/external_angular_resources_1.min.js&quot;&gt;&lt;/script&gt;\r\n    &lt;script src=&quot;/UIComponents/build/external/js/external_angular_resources_2.min.js&quot;&gt;&lt;/script&gt;\r\n    &lt;script src=&quot;/UIComponents/build/external/js/external_angular_resources_3.min.js&quot;&gt;&lt;/script&gt;\r\n  \r\n    &lt;!-- Directives --&gt;\r\n    &lt;script src=&quot;/UIComponents/build/external/js/directives_1.min.js&quot;&gt;&lt;/script&gt;\r\n    &lt;script src=&quot;/UIComponents/build/external/js/directives_2.min.js&quot;&gt;&lt;/script&gt;\r\n    &lt;script src=&quot;//cdnjs.cloudflare.com/ajax/libs/ag-grid/12.0.0/ag-grid.js?ignore=notused36&quot;&gt;&lt;/script&gt;\r\n  \r\n    &lt;!-- Components --&gt;\r\n    &lt;script src=&quot;/UIComponents/build/external/js/components.min.js&quot;&gt;&lt;/script&gt;\r\n    \r\n    \r\n    &lt;!-- Theme --&gt;\r\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;/UIComponents/dashboardBuilder/css/{{dashboardSettings.theme}}.css&quot;&gt;\r\n    \r\n\r\n&lt;/head&gt; \r\n  \r\n  \r\n&lt;style&gt;\r\n  {{compiledCss}}\r\n&lt;/style&gt;\r\n&lt;style&gt;\r\n  {{dashboardSettings.inline-style}}\r\n&lt;/style&gt;\r\n\r\n&lt;script&gt;\r\n\r\n(function() {\r\n\t\r\n  if(&quot;{{{dashboardSettings.requiresLogin}}}&quot; == &quot;Yes&quot;){\r\n  \r\n   var scriptName = window.location.pathname.substring(1,window.location.pathname.length )\r\n   var loginTemplateTarget =&quot;/UIComponents/dashboardBuilder/loginTemplate.html?redirectTarget=&quot;+scriptName+&quot;&amp;anon_token={{{anon_token}}}&quot;\r\n\r\n    var authorization  = $.scriptr.authorization(\r\n        {\r\n          onTokenValid: function(){ }, \r\n          loginPage: loginTemplateTarget\r\n        }\r\n      );\r\n    }\r\n  \r\n  \r\n   $.urlParam = function(name){\r\n\t     var results = new RegExp('[\\?&amp;]' + name + '=([^&amp;#]*)').exec(window.location.href);\r\n\t     if (results==null){\r\n\t         return null;\r\n\t     }else{\r\n\t         return results[1] || 0;\r\n\t     }\r\n\t}\r\n\r\n\t$.getUrlVars = function() {\r\n\t\tvar vars = [], hash;\r\n\t\tvar hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&amp;');\r\n\t\tfor(var i = 0; i &lt; hashes.length; i++)\r\n\t\t{\r\n\t\t\thash = hashes[i].split('=');\r\n\t\t\tvars.push(hash[0]);\r\n\t\t\tvars[hash[0]] = hash[1];\r\n\t\t}\r\n\t\treturn vars;\r\n\t}\r\n    \r\n    var underscore = angular.module('underscore', []);\r\n\t\tunderscore.factory('_', ['$window', function($window) {\t\t\r\n  \t\treturn $window._; // assumes underscore has already been loaded on the page\t\t\r\n\t}]);\r\n    \r\n\r\n    var wssConfig = [&quot;wsClientProvider&quot;,function (wsClientProvider) {\r\n   \t \twsClientProvider.setBaseUrl(&quot;wss://&quot; + window.location.host + &quot;/&quot;);   \t \r\n        wsClientProvider.setToken($.urlParam(&quot;auth_token&quot;));\r\n        wsClientProvider.setPublishChannel(&quot;{{{dashboardSettings.publishChannel}}}&quot;);\r\n        wsClientProvider.setSubscribeChannel(&quot;{{{dashboardSettings.subscribeChannel}}}&quot;);\r\n    }];\r\n\r\n    var httpsConfig = [&quot;httpClientProvider&quot;,function (httpClientProvider) {\r\n   \t  httpClientProvider.setBaseUrl(&quot;https://&quot; + window.location.host);\r\n      httpClientProvider.setToken($.urlParam(&quot;auth_token&quot;));\r\n    }]\r\n\r\n     var myApp= angular.module(&quot;myApp&quot;, [&quot;underscore&quot; , &quot;WsClient&quot;, &quot;HttpClient&quot;, &quot;Chart&quot;, 'gridster', 'ui.bootstrap', 'ngRoute', 'Gauge', 'Speedometer', 'Odometer', 'Map', 'Grid', 'toggle-switch', 'Slider', 'Button', 'IFrame', 'Accelerometer', 'Thermometer', 'Display', &quot;ngAnimate&quot;, &quot;ngSanitize&quot;, 'Dygraphs', 'DataService', 'Plotly', 'MetricBox', 'Alert'])\r\n     angular.module('myApp').config(wssConfig);\r\n     angular.module('myApp').config(httpsConfig);\r\n     \r\n     myApp.config(function($interpolateProvider, $locationProvider) {\r\n        $interpolateProvider.startSymbol('{[{');\r\n        $interpolateProvider.endSymbol('}]}');\r\n        $locationProvider.html5Mode({\r\n          enabled: true,\r\n          requireBase: false\r\n        });\r\n     });\r\n  \r\n  \r\n     myApp.controller('RootCtrl', function($scope, $interpolate, $location) {\r\n       var vm = this;\r\n       vm.gridsterOptions = {\r\n          defaultSizeY: 50,\r\n          defaultSizeX:50,\r\n          minRows: 1, // the minimum height of the grid, in rows\r\n          maxRows: 100,\r\n          columns: 10, // the width of the grid, in columns\r\n          colWidth: 'auto', // can be an integer or 'auto'.  'auto' uses the pixel width of the element divided by 'columns'\r\n          rowHeight: '50', // can be an integer or 'match'.  Match uses the colWidth, giving you square widgets.\r\n          margins: [10, 10], // the pixel distance between each widget\r\n          defaultSizeX: 2, // the default width of a gridster item, if not specifed\r\n          defaultSizeY: 1, // the default height of a gridster item, if not specified\r\n          mobileBreakPoint:480, // if the screen is not wider that this, remove the grid layout and stack the items\r\n          minColumns: 1, // the minimum columns the grid must have\r\n          resizable: {\r\n            enabled: false\r\n          },\r\n          draggable: {\r\n             enabled: false\r\n          }\r\n       };\r\n       \r\n        vm.init = function() {\r\n          {{#each urlParams}}\r\n           \tconsole.log(&quot;{{this}}&quot;, $location.search()[&quot;{{this}}&quot;])\r\n            vm.{{this}} = $location.search()[&quot;{{this}}&quot;]\r\n          {{/each}}\r\n        }\r\n        {{#each items}}\r\n           \t{{#if this.formatFunction}}   \r\n                vm.{{this.formatFunction}} = function(data){\r\n                  {{{this.formatFunctionValue}}}\r\n                }\r\n           \t{{/if}} \r\n        {{/each}}\r\n        \r\n        {{#each items}}\r\n           \t{{#if this.functions}}   \r\n            \t{{#each this.functions}}\r\n                    vm.{{this.name}} = function(arguments){\r\n                      {{{this.value}}}\r\n                    }\r\n                 {{/each}}\r\n           \t{{/if}} \r\n        {{/each}}\r\n     });\r\n        \t\r\n})();\r\n  \r\n&lt;/script&gt;\r\n\r\n   &lt;body class=&quot;dashboard-template dashboardTheme &quot;&gt;\r\n      &lt;div ng-controller=&quot;RootCtrl as vm&quot; ng-init=&quot;vm.init();&quot; class=&quot;dashboardContainer&quot;&gt; \r\n\t\t&lt;div gridster=&quot;vm.gridsterOptions&quot;&gt;\r\n          &lt;ul&gt;\r\n             {{#each items}}\r\n                &lt;li class=&quot;myItem&quot; gridster-item='{sizeX: {{sizeX}}, sizeY: {{sizeY}}, col: {{col}} , row: {{row}} }'&gt;\r\n                    \r\n\t\t\t\t\t\t&lt;div class=&quot;box {{#if_eq  this.options.box-header \"false\"}} box-without-header {{/if_eq}}&quot;&gt;\r\n\t\t\t\t\t\t  &lt;div class=&quot;box-header&quot;&gt;\r\n\t\t\t\t\t\t    &lt;div class=&quot;box-label&quot;&gt;&lt;span tooltip-append-to-body=&quot;true&quot; uib-tooltip=&quot;{{this.options.boxLabel}}&quot;&gt;{{this.options.boxLabel}}&lt;/span&gt;&lt;/div&gt;\r\n\t\t\t\t\t\t  &lt;/div&gt;\r\n                          &lt;div class=&quot;clearfix&quot;&gt;&lt;/div&gt;\r\n\t\t\t\t\t\t  &lt;div class=&quot;box-content&quot;&gt;\r\n\t\t\t\t\t\t  \t\t&lt;{{type}}\r\n                                    {{#buildAttr this.options }}\r\n                                        {{this}}\r\n                                    {{/buildAttr}}\r\n                                    {{#if this.formatFunction}}   \r\n                                  \t\ton-format-data='vm.{{this.formatFunction}}'\r\n                                    {{/if}} \r\n                           \t\t&gt;\r\n                                \r\n                                {{#if this.functions}}   \r\n                                       {{#each this.functions}}\r\n                                  \t\t\t{{this.attribute}}='vm.{{this.name}}'\r\n                                        {{/each}}\r\n                                    {{/if}} \r\n                                   \r\n \r\n \r\n          \r\n \t\t\t\t\t{{#if this.options.default-info-window}}\r\n                                &lt;info-window id=&quot;{{this.options.default-info-window.id}}&quot; template=&quot;{{this.options.default-info-window.template}}&quot; max-width=&quot;{{this.options.default-info-window.max-width}}&quot; max-height=&quot;{{this.options.default-info-window.max-height}}&quot;&gt;\r\n                                 &lt;/info-window&gt;\r\n                    {{/if}}\r\n                    \r\n       \t\t\t{{#if this.options.source-info-window}}\r\n                    \t{{#each this.options.source-info-window}}\r\n                        \t\t &lt;info-window id=&quot;infoWindowTemplate_{{this.source}}&quot; template=&quot;{{this.template}}&quot; max-width=&quot;{{this.max-width}}&quot; max-height=&quot;{{this.max-height}}&quot;&gt;\r\n                                 &lt;/info-window&gt;\r\n                        {{/each}}\r\n                    {{/if}}\r\n                                &lt;/{{type}}&gt;\r\n\t\t\t\t\t\t  &lt;/div&gt;\r\n\t\t\t\t\t\t&lt;/div&gt;\r\n                &lt;/li&gt;\r\n             {{/each}}\r\n          &lt;/ul&gt;\r\n        &lt;/div&gt;\r\n      &lt;/div&gt;\r\n  &lt;/body&gt;  \r\n&lt;/html&gt;<\/script>"),a.put("/UIComponents/dashboardBuilder/ide/dashboardTemplate_ide.min","<script type=text/x-handlebars-template id=handlebar-template>&lt;html ng-app=&quot;myApp&quot;&gt;\r\n&lt;head&gt;\r\n\r\n    &lt;link rel=&quot;icon&quot; href=&quot;data:;base64,iVBORw0KGgo=&quot;&gt;\r\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&quot; integrity=&quot;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&quot; crossorigin=&quot;anonymous&quot;&gt;\r\n    &lt;script src=&quot;//use.fontawesome.com/3d61d6959e.js&quot;&gt;&lt;/script&gt;\r\n\r\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;//{{{staticdomain}}}/lib/UIComponents/build/ide/css//components.min.css&quot;&gt;\r\n    \r\n    &lt;script src=&quot;//maps.google.com/maps/api/js?key=AIzaSyBcPYghFh_BXz4dDz-TXTHbU2iV3Wbf57I&amp;libraries=drawing,visualization&quot;&gt;&lt;/script&gt;\r\n    &lt;script src=&quot;//{{{staticdomain}}}/lib/UIComponents/build/ide/js/template_resources.min.js&quot;&gt;&lt;/script&gt;\r\n    \r\n&lt;/head&gt; \r\n  \r\n&lt;script&gt;\r\n\r\n(function() {  \r\n   $.urlParam = function(name){\r\n\t     var results = new RegExp('[\\?&amp;]' + name + '=([^&amp;#]*)').exec(window.location.href);\r\n\t     if (results==null){\r\n\t         return null;\r\n\t     }else{\r\n\t         return results[1] || 0;\r\n\t     }\r\n\t}\r\n\r\n\t$.getUrlVars = function() {\r\n\t\tvar vars = [], hash;\r\n\t\tvar hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&amp;');\r\n\t\tfor(var i = 0; i &lt; hashes.length; i++)\r\n\t\t{\r\n\t\t\thash = hashes[i].split('=');\r\n\t\t\tvars.push(hash[0]);\r\n\t\t\tvars[hash[0]] = hash[1];\r\n\t\t}\r\n\t\treturn vars;\r\n\t}\r\n\t  \r\n\r\n      \r\n    var underscore = angular.module('underscore', []);\r\n\t\tunderscore.factory('_', ['$window', function($window) {\t\t\r\n  \t\treturn $window._; // assumes underscore has already been loaded on the page\t\t\r\n\t}]);\r\n    \r\n\r\n    var wssConfig = [&quot;wsClientProvider&quot;,function (wsClientProvider) {\r\n   \t \twsClientProvider.setBaseUrl(&quot;wss://&quot; + window.location.host + &quot;/&quot;);   \t \r\n        wsClientProvider.setToken($.urlParam(&quot;auth_token&quot;));\r\n        wsClientProvider.setPublishChannel(&quot;{{{transport.publishChannel}}}&quot;);\r\n        wsClientProvider.setSubscribeChannel(&quot;{{{transport.subscribeChannel}}}&quot;);\r\n    }];\r\n\r\n    var httpsConfig = [&quot;httpClientProvider&quot;,function (httpClientProvider) {\r\n   \t  httpClientProvider.setBaseUrl(&quot;https://&quot; + window.location.host);\r\n      httpClientProvider.setToken($.urlParam(&quot;auth_token&quot;));\r\n    }]\r\n\r\n     var myApp= angular.module(&quot;myApp&quot;, [&quot;underscore&quot; , &quot;WsClient&quot;, &quot;HttpClient&quot;, &quot;Chart&quot;, 'gridster', 'ui.bootstrap', 'ngRoute', 'Gauge', 'Speedometer', 'Odometer', 'Message', 'Map', 'Grid', 'toggle-switch', 'Slider', 'Button', 'IFrame', 'Accelerometer', 'Thermometer'])\r\n     \r\n     angular.module('myApp').run(cachedTemplates);  \r\n      \r\n     angular.module('myApp').config(wssConfig);\r\n     angular.module('myApp').config(httpsConfig);\r\n     \r\n     myApp.config(function($interpolateProvider, $locationProvider) {\r\n        $interpolateProvider.startSymbol('{[{');\r\n        $interpolateProvider.endSymbol('}]}');\r\n        $locationProvider.html5Mode({\r\n          enabled: true,\r\n          requireBase: false\r\n        });\r\n     });\r\n  \r\n  \r\n     myApp.controller('RootCtrl', function($scope, $interpolate, $location) {\r\n       var vm = this;\r\n       vm.gridsterOptions = {\r\n          pushing: false,\r\n          \r\n          minRows: 1, // the minimum height of the grid, in rows\r\n          maxRows: 100,\r\n          columns: 5, // the width of the grid, in columns\r\n          colWidth: 'auto', // can be an integer or 'auto'.  'auto' uses the pixel width of the element divided by 'columns'\r\n          rowHeight: 'match', // can be an integer or 'match'.  Match uses the colWidth, giving you square widgets.\r\n          margins: [10, 10], // the pixel distance between each widget\r\n          defaultSizeX: 2, // the default width of a gridster item, if not specifed\r\n          defaultSizeY: 1, // the default height of a gridster item, if not specified\r\n          mobileBreakPoint: 1024, // if the screen is not wider that this, remove the grid layout and stack the items\r\n          minColumns: 1,\r\n          resizable: {\r\n            enabled: false\r\n          },\r\n          draggable: {\r\n             enabled: false\r\n          }\r\n       };\r\n       \r\n        vm.init = function() {\r\n          {{#each urlParams}}\r\n           \tconsole.log(&quot;{{this}}&quot;, $location.search()[&quot;{{this}}&quot;])\r\n            vm.{{this}} = $location.search()[&quot;{{this}}&quot;]\r\n          {{/each}}\r\n        }\r\n        {{#each items}}\r\n           \t{{#if this.formatFunction}}   \r\n                vm.{{this.formatFunction}} = function(data){\r\n                  {{this.formatFunctionValue}}\r\n                }\r\n           \t{{/if}} \r\n        {{/each}}\r\n     });\r\n        \t\r\n})();\r\n  \r\n&lt;/script&gt;\r\n\r\n    &lt;body&gt;\r\n      &lt;div ng-controller=&quot;RootCtrl as vm&quot; ng-init=&quot;vm.init();&quot;&gt; \r\n\t\t&lt;div gridster=&quot;vm.gridsterOptions&quot;&gt;\r\n          &lt;ul&gt;\r\n             {{#each items}}\r\n                &lt;li class=&quot;myItem&quot; gridster-item='{sizeX: {{sizeX}}, sizeY: {{sizeY}}, col: {{col}} , row: {{row}} }'&gt;\r\n                    &lt;div class=&quot;box&quot;&gt;\r\n                        &lt;div class=&quot;box-content&quot;&gt;\r\n                          &lt;div  style=&quot;height: 30px;&quot; tooltip-placement=&quot;bottom&quot; uib-tooltip=&quot;{{this.options.boxLabel}}&quot; class=&quot;box-label&quot;&gt;{{this.options.boxLabel}}&lt;/div&gt;\r\n                          &lt;div  style=&quot;height: calc(100% - 30px)&quot; &gt; &lt;{{type}}\r\n                           \t      {{#buildAttr this.options }}\r\n                                        {{this}}\r\n                                  {{/buildAttr}}\r\n                                  {{#if this.formatFunction}}   \r\n                                  \t\ton-format-data='vm.{{this.formatFunction}}'\r\n                                  {{/if}} \r\n                           &gt;&lt;/{{type}}&gt; &lt;/div&gt;\r\n                        &lt;/div&gt;\r\n                    &lt;/div&gt;\r\n                &lt;/li&gt;\r\n             {{/each}}\r\n          &lt;/ul&gt;\r\n        &lt;/div&gt;\r\n      &lt;/div&gt;\r\n  &lt;/body&gt;  \r\n&lt;/html&gt;<\/script>"),a.put("/UIComponents/dashboardBuilder/view/dashboardsList.html","<dashboards-list></dashboards-list>")}];angular.module("Chart",["angular.morris"]),angular.element(document).ready(function(){Morris.Line.prototype.resizeHandler=function(){clearTimeout(this.timeoutId);var a=this;return this.timeoutId=setTimeout(function(){a.el&&a.el.width()>0&&a.el.height()>0&&(a.raphael.setSize(a.el.width(),a.el.height()-8),a.redraw())},600),this},Morris.Donut.prototype.resizeHandler=function(){return this.timeoutId=null,this.el&&this.el.width()>0&&this.el.height()>0?(this.raphael.setSize(this.el.width(),this.el.height()),this.redraw()):null},Morris.Donut.prototype.setData=function(a){var b;return this.data=a,this.values=function(){var a,c,d,e;for(d=this.data,e=[],a=0,c=d.length;a<c;a++)b=d[a],e.push(parseFloat(b.value));return e}.call(this),
this.el&&this.el.width()>0&&this.el.height()>0?this.redraw():null}}),angular.module("Chart").component("scriptrChart",{bindings:{onLoad:"&onLoad",resize:"<?",data:"<?",type:"@",xkey:"@",yconfig:"<?",ykeys:"<?",stacked:"<?",labels:"<?",colors:"<?",api:"@",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&",lineWidth:"@",pointSize:"@",pointFillColors:"@",pointStrokeColors:"@",ymax:"@",ymin:"@",smooth:"@",hideHover:"@",parseTime:"@",units:"@",postUnits:"@",preUnits:"@",xlabels:"@",xlabelAngle:"<?",goals:"@",goalStrokeWidth:"@",goalLineColors:"@",goalsconfig:"<?",events:"@",eventStrokeWidth:"@",eventLineColors:"@",eventconfig:"<?",continuousLine:"@",axes:"@",grid:"@",gridTextColor:"@",gridTextSize:"@",gridTextFamily:"@",gridTextWeight:"@",fillOpacity:"@",resize:"@",behaveLikeLine:"@",labelColor:"@",donutFormatter:"&",backgroundColor:"@",hoverCallback:"&?",dateFormat:"&?",xlabelFormat:"&?",ylabelFormat:"&?",fetchDataInterval:"@",useWindowParams:"@",showLegend:"@",legendType:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/chart/chart.html",controller:["httpClient","wsClient","$scope","$timeout","$interval","dataService",function(a,b,c,d,e,f){var g=this;this.$onInit=function(){if(void 0===this.api&&void 0===this.msgTag&&(this.data&&0==this.data.length||null==this.data)&&(this.noResults=!0),g.yconfig){var a=[],b=[],d=[];g.yconfig.forEach(function(c){a.push(c.key),b.push(c.label),d.push(c.color)}),g.ykeys=JSON.stringify(a),g.labels=JSON.stringify(b),g.colors=d}if(g.goalsconfig&&(g.goals=[],g.goalLineColors=[],g.goalsconfig.forEach(function(a){g.goals.push(a.goal),g.goalLineColors.push(a.lineColor)})),g.eventsconfig&&(g.events=[],g.eventLineColors=[],g.eventsconfig.forEach(function(a){g.events.push(a.event),g.eventLineColors.push(a.lineColor)})),this.colors=this.colors?this.colors:["#CC5464","#FCC717","#38B9D6","#1DBC68","#E90088"],this.stacked=!!this.stacked&&this.stacked,this.resize=!this.resize||this.resize,this.labelColor=this.labelColor?this.labelColor:"#eee",this.backgroundColor=this.backgroundColor?this.backgroundColor:"#fff",this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.showLegend=this.showLegend?this.showLegend:"true",this.legendType=this.legendType?this.legendType:"hover",this.hideHover=this.hideHover?this.hideHover:"auto",this.showLegend&&"true"==this.showLegend)if(this.legendType&&"right"==this.legendType){this.hideHover="always",this.ref=c.$id,this.legendStructure=[];for(var e=0;e<this.ykeys.length;e++){var f={};f.key=this.ykeys[e],this.labels&&this.labels[e]?f.label=this.labels[e]:f.label=this.ykeys[e],this.colors&&this.colors[e]&&(f.color=this.colors[e]),this.legendStructure.push(f)}this.hoverCallback=function(a,b,d,e){g.datas&&(e&&e.date&&(c.$ctrl.legendDate=e[g.xkey]),_.mapObject(e,function(a,b){var f=_.findIndex(c.$ctrl.legendStructure,{key:"donut"!=g.type?b:a});if(-1!=f){c.$ctrl.legendStructure[f].value="donut"==g.type?d:a;var h=document.getElementById("value_"+f+"_"+g.ref),i=document.getElementById("date_"+g.ref);h&&(h.innerHTML="donut"==g.type?d:a),"donut"!=g.type&&i&&(i.innerHTML=e[g.xkey])}}))}}else this.legendType&&"hover"==this.legendType&&console.log("Legend type",this.legendType)},this.$postLink=function(){h(this.transport),this.data&&!this.api?(g.timeout=!1,d(function(){g.consumeData(g.data)},2e3)):g.timeout=!0,c.$watch(function(a){if(a.$ctrl.data&&1==g.timeout)return a.$ctrl.data},function(a){a&&(g.datas=a,g.noResults=!1)})},this.$onDestroy=function(){console.log("destory chart",g.msgTag,c.$id),g.msgTag&&b.unsubscribe(g.msgTag,null,c.$id),g.refreshTimer&&e.cancel(g.refreshTimer)};var h=function(a){f.getData(a,g.api,g.apiParams,g.useWindowParams,g.msgTag,g.consumeData.bind(g),g.fetchDataInterval,c.$id),g.fetchDataInterval&&!g.refreshTimer&&(g.refreshTimer=e(function(){h(g.transport)},1e3*g.fetchDataInterval))};this.consumeData=function(a,b){g.timeout=!0,"function"==typeof g.onFormatData()&&(a=g.onFormatData()(a)),a&&a.length>0&&"object"==typeof a?(this.datas=a,this.noResults=!1):(this.datas=[],this.noResults=!0)}}]}),angular.module("Odometer",["ui.odometer"]),angular.module("Odometer").component("scriptrOdometer",{bindings:{onLoad:"&onLoad",api:"@",enableResize:"<?",theme:"@",duration:"@",animation:"@",transport:"@",odometerValue:"<?",data:"<?",msgTag:"@",apiParams:"<?",size:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/odometer/odometer.html",controller:["$scope","httpClient","wsClient","$element","$window","$timeout","$interval","dataService",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){this.config={duration:this.duration?this.duration:1e3,animation:this.animation?this.animation:"count",theme:this.theme?this.theme:"car"},this.odometerOptions=this.config,this.odometerValue=this.odometerValue?this.odometerValue:this.data?this.data:0,this.size=this.size?this.size:1,this.enableResize=void 0===this.enableResize||this.enableResize,this.style={},this.style["font-size"]=this.size+"em",angular.element(e).on("resize",function(){return null!=i.timeoutId&&f.cancel(i.timeoutId),i.timeoutId=f(i.resize,100)}),this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",j(this.transport)},i.resize=function(){i.timeoutId=null,i.enableResize&&(i.style["margin-top"]=d.parent().outerHeight()/2-d.outerHeight()/2)},this.$postLink=function(){f(i.resize,100),null!=i.timeoutId&&f.cancel(i.timeoutId),i.timeoutId=f(i.resize,100)},this.$onDestroy=function(){angular.element(e).off("resize"),i.msgTag&&c.unsubscribe(i.msgTag,null,a.$id),i.refreshTimer&&g.cancel(i.refreshTimer),console.log("destroy odometer")};var j=function(b){h.getData(b,i.api,i.apiParams,i.useWindowParams,i.msgTag,i.consumeData.bind(i),i.fetchDataInterval,a.$id),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=g(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){"function"==typeof i.onFormatData()&&(a=i.onFormatData()(a)),this.odometerValue=a}}]}),angular.module("Speedometer",["meterGauge"]),angular.module("Speedometer").component("scriptrSpeedometer",{bindings:{onLoad:"&onLoad",gaugeRadius:"<?",theme:"@",minValue:"<?",maxValue:"<?",needleVal:"<?",data:"<?",tickSpaceMinVal:"<?",tickSpaceMajVal:"<?",gaugeUnits:"@",tickColMaj:"@",tickColMin:"@",outerEdgeCol:"@",pivotCol:"@",innerCol:"@",unitsLabelCol:"@",tickLabelCol:"@",needleCol:"@",defaultFonts:"@",api:"@",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/speedometer/speedometer.html",controller:["httpClient","wsClient","$element","$window","$scope","$compile","$timeout","$interval","dataService",function(a,b,c,d,e,f,g,h,i){var j=this;this.$onInit=function(){this.speedoConfig={},"speed"==this.theme||void 0===this.theme?(this.speedoConfig.gaugeRadius=this.gaugeRadius?this.gaugeRadius:150,this.speedoConfig.minVal=this.minValue?this.minValue:0,this.speedoConfig.maxVal=this.maxValue?this.maxValue:220,this.speedoConfig.needleVal=this.needleVal?Math.round(this.needleVal):this.data?Math.round(this.data):0,this.speedoConfig.tickSpaceMinVal=this.tickSpaceMinVal?this.tickSpaceMinVal:10,this.speedoConfig.tickSpaceMajVal=this.tickSpaceMajVal?this.tickSpaceMajVal:20,this.speedoConfig.gaugeUnits=this.gaugeUnits?this.gaugeUnits:"kmh",this.speedoConfig.tickColMaj=this.tickColMaj?this.tickColMaj:"#C64DFF",this.speedoConfig.tickColMin=this.tickColMin?this.tickColMin:"#999999",this.speedoConfig.outerEdgeCol=this.outerEdgeCol?this.outerEdgeCol:"#f4f4f4",this.speedoConfig.pivotCol=this.pivotCol?this.pivotCol:"#434a54",this.speedoConfig.innerCol=this.innerCol?this.innerCol:"#ffffff",this.speedoConfig.unitsLabelCol=this.unitsLabelCol?this.unitsLabelCol:"#C64DFF",this.speedoConfig.tickLabelCol=this.tickLabelCol?this.tickLabelCol:"#656D78",this.speedoConfig.needleCol=this.needleCol?this.needleCol:"#C64DFF",this.speedoConfig.defaultFonts=this.defaultFonts?this.defaultFonts:""):"rpm"==this.theme&&(this.speedoConfig.gaugeRadius=this.gaugeRadius?this.gaugeRadius:120,this.speedoConfig.minVal=this.minValue?this.minValue:0,this.speedoConfig.maxVal=this.maxValue?this.maxValue:1e3,this.speedoConfig.needleVal=this.needleVal?Math.round(this.needleVal):this.data?Math.round(this.data):0,this.speedoConfig.tickSpaceMinVal=this.tickSpaceMinVal?this.tickSpaceMinVal:10,this.speedoConfig.tickSpaceMajVal=this.tickSpaceMajVal?this.tickSpaceMajVal:100,this.speedoConfig.gaugeUnits=this.gaugeUnits?this.gaugeUnits:"kmh",this.speedoConfig.tickColMaj=this.tickColMaj?this.tickColMaj:"#0194D9",this.speedoConfig.tickColMin=this.tickColMin?this.tickColMin:"#999999",this.speedoConfig.outerEdgeCol=this.outerEdgeCol?this.outerEdgeCol:"#ffffff",this.speedoConfig.pivotCol=this.pivotCol?this.pivotCol:"#434A54",this.speedoConfig.innerCol=this.innerCol?this.innerCol:"#ffffff",this.speedoConfig.unitsLabelCol=this.unitsLabelCol?this.unitsLabelCol:"#0194d9",this.speedoConfig.tickLabelCol=this.tickLabelCol?this.tickLabelCol:"#656D78",this.speedoConfig.needleCol=this.needleCol?this.needleCol:"#0194d9",this.speedoConfig.defaultFonts=this.defaultFonts?this.defaultFonts:""),this.speedoConfig.speedoTag=e.$id,this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true"},this.calculateGaugeRadius=function(){j.timeoutId=null;var a=c.parent().height(),b=c.parent().width();j.speedoConfig.gaugeRadius=0==a?b/2:b>=a?a/2:b/2},this.$postLink=function(){g(function(){j.gaugeRadius||(j.calculateGaugeRadius(),angular.element(d).on("resize",function(){null!=j.timeoutId&&g.cancel(j.timeoutId),j.timeoutId=g(j.calculateGaugeRadius,100)})),j.renderGauge(),e.$watch(function(a){return a.$ctrl.needleVal&&(j.speedoConfig.needleVal=a.$ctrl.needleVal),JSON.stringify(j.speedoConfig)},function(a){j.renderGauge()}),k(j.transport)},500)},this.$onDestroy=function(){this.gaugeRadius||angular.element(d).off("resize"),j.msgTag&&b.unsubscribe(j.msgTag,null,e.$id),j.refreshTimer&&h.cancel(j.refreshTimer),console.log("destory speedo")},this.renderGauge=function(){angular.element(c).html(""),this.speedo=angular.element(document.createElement("meter-gauge")),this.speedo.attr("gaugeconfig",JSON.stringify(this.speedoConfig));var a=f(this.speedo)(e);angular.element(c).append(a)};var k=function(a){console.log("Gauge Size",j.speedoConfig.gaugeRadius),i.getData(a,j.api,j.apiParams,j.useWindowParams,j.msgTag,j.consumeData.bind(j),j.fetchDataInterval,e.$id),j.fetchDataInterval&&!j.refreshTimer&&(j.refreshTimer=h(function(){k(j.transport)},1e3*j.fetchDataInterval))};this.consumeData=function(a,b){"function"==typeof j.onFormatData()&&(a=j.onFormatData()(a)),a=parseInt(a),a="number"==typeof a&&"NaN"!=a.toString()?a:0,this.speedoConfig.needleVal=Math.round(a)}}]}),angular.module("SearchBox",["angularBootstrapNavTree"]).component("scriptrSearchbox",{bindings:{treeControl:"<?",treeData:"<?",searchText:"@",iconLeaf:"@",paramName:"@",iconExpand:"@",iconCollapse:"@",onSelect:"<?",expandLevel:"@",initialSelection:"@",apiParams:"<?",loadTree:"<?",treeSearchCriteria:"@",transport:"@",api:"@",onFormatData:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/searchBox/searchBox.html",controller:["wsClient","httpClient",function(a,b){var c=this;this.iconExpand=this.iconExpand?this.iconExpand:null,this.$onInit=function(){this.iconLeaf=this.iconLeaf&&"$ctrl.iconLeaf"!=this.iconLeaf?this.iconLeaf:"icon-file  glyphicon glyphicon-file  fa fa-file",this.iconExpand=this.iconExpand&&"$ctrl.iconExpand"!=this.iconExpand?this.iconExpand:"icon-plus  glyphicon glyphicon-plus  fa fa-plus",this.iconCollapse=this.iconCollapse&&"$ctrl.iconCollapse"!=this.iconCollapse?this.iconCollapse:"icon-minus glyphicon glyphicon-minus fa fa-minus",this.paramName=this.paramName?this.paramName:"criteria",this.searchText=this.searchText?this.searchText:"Type to search",this.treeData=this.treeData?this.treeData:[],this.iconLeaf=this.iconLeaf?this.iconLeaf:null,this.transport=this.transport?this.transport:"wss",this.loadTree&&(this.searchValue=this.treeSearchCriteria,this.searching=!0,d(this.transport,this.searchValue))},this.onFilterChanged=function(){console.log("submit"),null!=this.searchValue&&""!=this.searchValue&&(this.searchValue=this.treeSearchCriteria,this.searching=!0,d(this.transport,this.searchValue))};var d=function(d,e){var f={};if(f[c.paramName]=e||c.treeSearchCriteria,c.apiParams)for(var g in c.apiParams)f[g]=c.apiParams[g];"wss"==d?a.onReady.then(function(){a.subscribe(c.msgTag,c.consumeData.bind(c)),c.api&&a.call(c.api,f,c.msgTag).then(function(a,b){c.consumeData(a)},function(a){console.log("reject published promise",a),c.consumeData()})}):"https"==d&&c.api&&b.get(c.api,f).then(function(a,b){c.consumeData(a)},function(a){c.consumeData(),console.log("reject published promise",a)})};this.consumeData=function(a,b){"function"==typeof c.onFormatData()&&(a=c.onFormatData()(a)),console.log("display tree"),"object"==typeof a&&a.length>0?(this.treeData=a,this.noResults=!1):(this.treeData=[],this.noResults=!0),this.searching=!1}}]}),angular.module("Gauge",["frapontillo.gage"]),angular.module("Gauge").component("scriptrGauge",{bindings:{onLoad:"&onLoad",api:"@",transport:"@",msgTag:"@",apiParams:"<?",valueFontColor:"@",min:"@",max:"@",hideMinMax:"@",hideValue:"@",showInnerShadow:"<?",gaugeColor:"@",gaugeValue:"<?",data:"<?",customSectors:"<?",shadowSize:"@",shadowOpacity:"@",label:"@",labelFontColor:"@",startAnimationType:"@",refreshAnimationType:"@",valueFontFamily:"@",relativeGaugeSize:"@",valueMinFontSize:"@",hideMinMax:"@",labelMinFontSize:"@",minLabelMinFontSize:"@",maxLabelMinFontSize:"@",gaugeWidthScale:"@",shadowVerticalOffset:"@",levelColors:"@",noGradient:"@",startAnimationTime:"@",refreshAnimationTime:"@",donut:"@",donutStartAngle:"@",reverse:"@",decimals:"@",symbol:"@",formatNumber:"@",humanFriendly:"@",humanFriendlyDecimal:"@",textRenderer:"&",onAnimationEnd:"&",pointer:"<?",onFormatData:"&",heightUnit:"@",counter:"@",width:"@",height:"@",fetchDataInterval:"@",useWindowParams:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/gauge/gauge.html",controller:["$scope","httpClient","wsClient","$interval","dataService",function(a,b,c,d,e){var f=this;this.$onInit=function(){this.gaugeValue=this.gaugeValue?this.gaugeValue:this.data?this.data:0,this.heightUnit=this.heightUnit?this.heightUnit:"px",this.customSectors=this.customSectors?this.customSectors:{percents:!0,ranges:[{color:"#A3CD3B",lo:0,hi:25},{color:"#FF4A43",lo:25,hi:100}]},this.valueFontColor=this.valueFontColor?this.valueFontColor:"#999",this.min=this.min?this.min:0,this.max=this.max?this.max:100,this.hideMinMax=!!this.hideMinMax&&this.hideMinMax,this.hideValue=!!this.hideValue&&this.hideValue,this.gaugeColor=this.gaugeColor?this.gaugeColor:"#e9e9e9",this.shadowSize=this.shadowSize?this.shadowSize:0,this.label=this.label?this.label:"",this.labelFontColor=this.labelFontColor?this.labelFontColor:"#666",this.startAnimationType=this.startAnimationType?this.startAnimationType:"linear",this.refreshAnimationType=this.refreshAnimationType?this.refreshAnimationType:"linear",this.counter=!this.counter||this.counter,this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",g(this.transport)},this.$onDestroy=function(){console.log("destory gauge"),f.msgTag&&c.unsubscribe(f.msgTag,null,a.$id),f.refreshTimer&&d.cancel(f.refreshTimer)};var g=function(b){e.getData(b,f.api,f.apiParams,f.useWindowParams,f.msgTag,f.consumeData.bind(f),f.fetchDataInterval,a.$id),f.fetchDataInterval&&!f.refreshTimer&&(f.refreshTimer=d(function(){g(f.transport)},1e3*f.fetchDataInterval))};this.consumeData=function(a,b){"function"==typeof this.onFormatData()&&(a=this.onFormatData()(a)),a=parseFloat(a),a="number"==typeof a&&"NaN"!=a.toString()?a:0,this.gaugeValue=a}}]}),angular.module("angular-scriptrui",[]).directive("ngScriptrAlert",function(){return{restrict:"E",require:"ngModel",scope:{msg:"=ngModel",type:"@"},template:'<div class="alert alert-{{type}}" role="alert"><span ng-bind="msg"></span></div>',replace:!0}}),angular.module("Alert",["angular-scriptrui","DataService"]),angular.module("Alert").component("scriptrAlert",{bindings:{data:"<?",type:"@",api:"@",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/alert/alert.html",controller:["httpClient","wsClient","dataService","$scope",function(a,b,c,d){var e=this;this.$onInit=function(){this.type=this.type?this.type:"info",this.data=this.data?this.data:"Waiting for info...",this.data&&this.consumeData(this.data)},this.$postLink=function(){f(this.transport)};var f=function(a){c.getData(a,e.api,e.apiParams,e.useWindowParams,e.msgTag,e.consumeData.bind(e),e.fetchDataInterval,d.$id)};this.consumeData=function(a,b){"function"==typeof e.onFormatData()&&(a=e.onFormatData()(a)),"object"==typeof a&&(a&&a.data&&"string"==typeof a.data&&(this.message=a.data),a&&a.type&&(this.type=a.type)),"string"==typeof a&&(this.message=a)}}]}),angular.module("Accelerometer",[]),angular.module("Accelerometer").component("scriptrAccelerometer",{bindings:{data:"<?",api:"@",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/accelerometer/accelerometer.html",controller:["httpClient","wsClient","$scope","$interval","dataService",function(a,b,c,d,e){var f=this;this.$onInit=function(){this.data&&(this.data.x&&(this.data.x=this.data.x>20?20:this.data.x<-20?-20:this.data.x,this.xLine="scaleX("+Math.round(this.data.x)+")"),this.data.y&&(this.data.y=this.data.y>20?20:this.data.y<-20?-20:this.data.y,this.yLine="scaleY("+Math.round(this.data.y)+")"),this.data.z&&(this.angle="rotateZ("+Math.round(this.data.z)+"deg )")),this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",g(this.transport)};var g=function(a){e.getData(a,f.api,f.apiParams,f.useWindowParams,f.msgTag,f.consumeData.bind(f),f.fetchDataInterval,c.$id),f.fetchDataInterval&&!f.refreshTimer&&(f.refreshTimer=d(function(){g(f.transport)},1e3*f.fetchDataInterval))};this.$onDestroy=function(){f.msgTag&&b.unsubscribe(f.msgTag,null,c.$id),f.refreshTimer&&d.cancel(f.refreshTimer),console.log("destory accelerometer")},this.consumeData=function(a,b){"function"==typeof f.onFormatData()&&(a=f.onFormatData()(a)),a.x=a.x>20?20:a.x<-20?-20:a.x,a.y=a.y>20?20:a.y<-20?-20:a.y,this.xLine="scaleX("+Math.round(a.x)+")",this.yLine="scaleY("+Math.round(a.y)+")",this.angle="rotateZ("+Math.round(a.z)+"deg )"}}]}),angular.module("ToggleSwitch",["DataService","toggle-switch"]),angular.module("ToggleSwitch").component("scriptrToggleSwitch",{bindings:{onLoad:"&onLoad",type:"@",size:"@",class:"@",api:"@",switchStatus:"<?",onLabel:"@",offLabel:"@",knobLabel:"@",isDisabled:"<?",msgTag:"@",apiParams:"<?",onSwitchChange:"&",publishApiParams:"<?",enableResize:"<?",onFormatData:"&",transport:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/toggleSwitch/toggle_switch.html",controller:["$scope","$element","$window","$timeout","httpClient","wsClient","dataService",function(a,b,c,d,e,f,g){var h=this;this.$onInit=function(){this.switchStatus=void 0!==this.switchStatus&&this.switchStatus,this.onLabel=void 0!==this.onLabel?this.onLabel:"on",this.offLabel=void 0!==this.offLabel?this.offLabel:"off",this.knobLabel=void 0!==this.knobLabel?this.knobLabel:"",this.disabled=void 0!==this.isDisabled&&this.isDisabled,this.type=void 0!==this.type?this.type:"switch-success",this.size=void 0!==this.size?this.size:"switch-large",this.enableResize=void 0===this.enableResize||this.enableResize,this.class=this.type+" "+this.size,console.log(this.transport),this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.style={},angular.element(c).on("resize",function(){return null!=h.timeoutId&&d.cancel(h.timeoutId),h.timeoutId=d(h.resize,100)}),i(this.api,h.apiParams,this.transport)},this.$onDestroy=function(){console.log("destory toggle switch"),angular.element(c).off("resize"),h.msgTag&&f.unsubscribe(h.msgTag,null,a.$id)},this.publishData=function(){this.isDisabled||("function"==typeof this.onSwitchChange()&&this.onSwitchChange()(h.switchStatus),void 0===h.publishApiParams&&(h.publishApiParams={}),h.publishApiParams.value=this.switchStatus,i(h.api,h.publishApiParams,h.transport))},h.resize=function(){h.enableResize&&(h.timeoutId=null)},this.$postLink=function(){d(h.resize,100),null!=h.timeoutId&&d.cancel(h.timeoutId),h.timeoutId=d(h.resize,100)};var i=function(b,c,d){g.getData(d,h.api,h.apiParams,h.useWindowParams,h.msgTag,h.consumeData.bind(h),h.fetchDataInterval,a.$id),h.fetchDataInterval&&!h.refreshTimer&&(h.refreshTimer=$interval(function(){i(h.transport)},1e3*h.fetchDataInterval))};this.consumeData=function(a,b){"function"==typeof this.onFormatData()&&(a=this.onFormatData()(a));var c=a.status,d=a.disabled;1!=c&&0!=c&&"true"!=c&&"false"!=c||(this.switchStatus=a),void 0!==d&&(this.isDisabled=d)}}]}),angular.module("Slider",["rzModule"]),angular.module("Slider").component("scriptrSlider",{bindings:{onLoad:"&onLoad",theme:"@",id:"@",min:"<?",max:"<?",floor:"<?",ceil:"<?",step:"<?",precision:"<?",minLimit:"<?",maxLimit:"<?",minRange:"<?",maxRange:"<?",pushRange:"<?",id:"<?",translate:"<?",getLegend:"<?",stepsArray:"<?",bindIndexForStepsArray:"<?",draggableRange:"<?",draggableRangeOnly:"<?",showSelectionBar:"<?",showSelectionBarEnd:"<?",showSelectionBarFromValue:"<?",hidePointerLabels:"<?",hideLimitLabels:"<?",autoHideLimitLabels:"<?",readOnly:"<?",isDisabled:"<?",interval:"<?",showTicks:"<?",showTicksValues:"<?",ticksArray:"<?",ticksTooltip:"<?",ticksValuesTooltip:"<?",vertical:"<?",getSelectionBarColor:"&",getTickColor:"<?",getPointerColor:"<?",keyboardSupport:"<?",scale:"<?",enforceStep:"<?",enforceRange:"<?",noSwitching:"<?",onlyBindHandles:"<?",onStart:"&",onChange:"&",onEnd:"&",rightToLeft:"<?",boundPointerLabels:"<?",mergeRangeLabelsIfSame:"<?",customTemplateScope:"<?",logScale:"<?",customValueToPosition:"<?",customPositionToValue:"<?",selectionBarGradient:"<?",ariaLabel:"<?",ariaLabelledBy:"<?",ariaLabelHigh:"<?",ariaLabelledByHigh:"<?",publishApi:"@",enableResize:"<?",api:"@",transport:"@",msgTag:"@",apiParams:"<?",publishApiParams:"<?",onFormatData:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/slider/slider.html",controller:["$scope","$element","$window","$timeout","httpClient","wsClient","dataService",function(a,b,c,d,e,f,g){var h=this;this.$onInit=function(){this.min=this.min?this.min:null,this.max=this.max?this.max:null,this.theme=this.theme?this.theme:"",this.options={},this.options.id=void 0!==this.id?this.id:null,this.options.floor=void 0!==this.floor?this.floor:0,this.options.ceil=void 0!==this.ceil?this.ceil:10,this.options.step=void 0!==this.step?this.step:1,this.options.precision=void 0!==this.precision?this.precision:0,this.options.minLimit=void 0!==this.minLimit?this.minLimit:null,this.options.maxLimit=void 0!==this.maxLimit?this.maxLimit:null,this.options.minRange=void 0!==this.minRange?this.minRange:null,this.options.maxRange=void 0!==this.maxRange?this.maxRange:null,this.options.pushRange=void 0!==this.pushRange&&this.pushRange,this.options.id=void 0!==this.id?this.id:null,this.options.translate=void 0!==this.translate?this.translate:null,this.options.getLegend=void 0!==this.getLegend?this.getLegend:null,this.options.stepsArray=void 0!==this.stepsArray?this.stepsArray:null,this.options.bindIndexForStepsArray=void 0!==this.bindIndexForStepsArray&&this.bindIndexForStepsArray,this.options.draggableRange=void 0!==this.draggableRange&&this.draggableRange,this.options.draggableRangeOnly=void 0!==this.draggableRangeOnly&&this.draggableRangeOnly,this.options.showSelectionBar=void 0!==this.showSelectionBar&&this.showSelectionBar,this.options.showSelectionBarEnd=void 0!==this.showSelectionBarEnd&&this.showSelectionBarEnd,this.options.showSelectionBarFromValue=void 0!==this.showSelectionBarFromValue?this.showSelectionBarFromValue:null,this.options.hidePointerLabels=void 0!==this.hidePointerLabels&&this.hidePointerLabels,this.options.hideLimitLabels=void 0!==this.hideLimitLabels&&this.hideLimitLabels,this.options.autoHideLimitLabels=void 0===this.autoHideLimitLabels||this.autoHideLimitLabels,this.options.readOnly=void 0!==this.readOnly&&this.readOnly,this.options.disabled=void 0!==this.isDisabled&&this.isDisabled,this.options.interval=void 0!==this.interval?this.interval:350,this.options.showTicks=void 0!==this.showTicks&&this.showTicks,this.options.showTicksValues=void 0!==this.showTicksValues&&this.showTicksValues,this.options.ticksArray=void 0!==this.ticksArray?this.ticksArray:null,this.options.ticksTooltip=void 0!==this.ticksTooltip?this.ticksTooltip:null,this.options.ticksValuesTooltip=void 0!==this.ticksValuesTooltip?this.ticksValuesTooltip:null,this.options.vertical=void 0!==this.vertical&&this.vertical,this.options.getSelectionBarColor="function"==typeof this.getSelectionBarColor()?this.getSelectionBarColor():null,this.options.getTickColor=void 0!==this.getTickColor?this.getTickColor:null,this.options.getPointerColor=void 0!==this.getPointerColor?this.getPointerColor:null,this.options.keyboardSupport=void 0===this.keyboardSupport||this.keyboardSupport,this.options.scale=void 0!==this.scale?this.scale:1,this.options.enforceStep=void 0!==this.enforceStep&&this.enforceStep,this.options.enforceRange=void 0!==this.enforceRange&&this.enforceRange,this.options.noSwitching=void 0!==this.noSwitching&&this.noSwitching,this.options.onlyBindHandles=void 0!==this.onlyBindHandles?this.onlyBindHandles:null,this.options.onStart="function"!=typeof this.onStart()?this.onStart:null,this.options.onChange="function"!=typeof this.onChange()?this.onChange:null,this.options.onEnd=i,this.options.rightToLeft=void 0!==this.rightToLeft&&this.rightToLeft,this.options.boundPointerLabels=void 0===this.boundPointerLabels||this.boundPointerLabels,this.options.mergeRangeLabelsIfSame=void 0!==this.mergeRangeLabelsIfSame&&this.mergeRangeLabelsIfSame,this.options.customTemplateScope=void 0!==this.customTemplateScope?this.customTemplateScope:null,this.options.logScale=void 0!==this.logScale&&this.logScale,this.options.customValueToPosition=void 0!==this.customValueToPosition?this.customValueToPosition:null,this.options.customPositionToValue=void 0!==this.customPositionToValue?this.customPositionToValue:null,this.options.selectionBarGradient=void 0!==this.selectionBarGradient?this.selectionBarGradient:null,this.options.ariaLabel=void 0!==this.ariaLabel?this.ariaLabel:null,this.options.ariaLabelledBy=void 0!==this.ariaLabelledBy?this.ariaLabelledBy:null,this.options.ariaLabelHigh=void 0!==this.ariaLabelHigh?this.ariaLabelHigh:null,this.options.ariaLabelledByHigh=void 0!==this.ariaLabelledByHigh?this.ariaLabelledByHigh:null,this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.enableResize=void 0===this.enableResize||this.enableResize,this.style={},angular.element(c).on("resize",function(){return null!=h.timeoutId&&d.cancel(h.timeoutId),h.timeoutId=d(h.resize,100)}),d(function(){a.$broadcast("reCalcViewDimensions"),a.$broadcast("rzSliderForceRender")},2e3),j(this.api,h.apiParams,this.transport)};var i=function(a,b,c,d){"function"==typeof h.onEnd()&&h.onEnd()(a,b,c,d),void 0===h.publishApiParams&&(h.publishApiParams={}),a&&(h.publishApiParams.sliderId=a),b&&(h.publishApiParams.modelValue=b),c&&(h.publishApiParams.highValue=c),d&&(h.publishApiParams.pointerType=d),j(h.api,h.publishApiParams,h.transport)};h.resize=function(){h.timeoutId=null,$(b).children()[0].style.display=""},this.$postLink=function(){d(h.resize,700),null!=h.timeoutId&&d.cancel(h.timeoutId),h.timeoutId=d(h.resize,700)},this.$onDestroy=function(){console.log("destory slider"),angular.element(c).off("resize"),h.msgTag&&f.unsubscribe(h.msgTag,null,a.$id)};var j=function(b,c,d){g.getData(d,h.api,h.apiParams,h.useWindowParams,h.msgTag,h.consumeData.bind(h),h.fetchDataInterval,a.$id),h.fetchDataInterval&&!h.refreshTimer&&(h.refreshTimer=$interval(function(){j(h.transport)},1e3*h.fetchDataInterval))};this.consumeData=function(a,b){"function"==typeof this.onFormatData()&&(a=this.onFormatData()(a)),a=parseInt(a),"number"==typeof a&&"NaN"!=a.toString()?(a=a,this.min=a):a=0}}]}),angular.module("Button",["ngAnimate","angularPromiseButtons"]),angular.module("Button").component("scriptrButton",{bindings:{size:"@",enableResize:"<?",isDisabled:"<?",label:"@",type:"@",onButtonclick:"&",onSuccess:"&",onFailure:"&",api:"@",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/button/button.html",controller:["$scope","$q","$element","$window","$timeout","httpClient","wsClient","dataService",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){this.label=this.label?this.label:"Publish Data",this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.type=this.type?this.type:"btn-success",this.size=this.size?this.size:"",this.enableResize=void 0===this.enableResize||this.enableResize,this.class=this.type+" "+this.size,this.style={},angular.element(d).on("resize",function(){return null!=i.timeoutId&&e.cancel(i.timeoutId),i.timeoutId=e(i.resize,100)})},i.call=function(b,c,d){h.postData(c,b,d,!1,i.msgTag,null,a.$id).then(function(a){i._apiResult=a,"SUCCESS"==a.msg?"function"==typeof i.onSuccess()&&i.onSuccess()(i):"function"==typeof i.onFailure()&&i.onFailure()(i)},function(a){i._apiResult=null,console.log("Button.js post data Error ",a)})},this.$onDestroy=function(){angular.element(d).off("resize")},i.success=function(){"function"==typeof this.onButtonclick()&&this.onButtonclick()(i),i.call(i.api,i.transport,i.apiParams)},i.resize=function(){i.enableResize&&(i.timeoutId=null)},this.$postLink=function(){e(i.resize,100),null!=i.timeoutId&&e.cancel(i.timeoutId),i.timeoutId=e(i.resize,100)}}]}),angular.module("IFrame",[]),angular.module("IFrame").component("scriptrIframe",{bindings:{link:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/IFrame/IFrame.html",controller:["$scope","$sce","$q","$element","$window","$timeout",function(a,b,c,d,e,f){this.$onInit=function(){},this.$postLink=function(){},this.trustSrc=function(a){return b.trustAsResourceUrl(a)}}]}),angular.module("Map",["ngMap","ToggleSwitch"]),angular.module("Map").component("scriptrMap",{transclude:!0,bindings:{sourcesInfo:"<?",clusteredView:"<?",clusteredZoomMax:"<?",clusterZoom:"<?",detailedZoomMin:"<?",focusedMarkerZoom:"<?",pathStrokeOpacity:"@",pathStrokeWeight:"@",maxAssetPoints:"<?",defaultCenter:"@",trackedAsset:"@",selectedTrackedAsset:"@",summaryIcons:"<?",assetsData:"<?",data:"<?",heatMapWeight:"@",heatMapRadius:"@",heatMapOpacity:"@",heatMapGradient:"<?",api:"@",apiParams:"@",msgTag:"@",onFormatData:"&",setMarkerIcon:"&",onSelectAsset:"&",clusterStyles:"<?",geofenceManager:"<?",apiGeofence:"<?",apiGeofenceParams:"<?",msgTagGeofence:"<?",heatmap:"<?",bounce:"<?",markerInfoWindow:"<?",customDefaultInfoWindow:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/map/map.html",controller:["$scope","$rootElement","$location","$sce","$compile","$timeout","$interval","$controller","NgMap","defaultConstants","wsClient",function(a,b,c,d,e,f,g,h,i,j,k){var l=this;l.$onInit=function(){var b=this;b.$wdgid=a.$id,b.pathStrokeOpacity=b.pathStrokeOpacity?b.pathStrokeOpacity:0,b.pathStrokeWeight=b.pathStrokeWeight?b.pathStrokeWeight:5,b.maxAssetPoints=b.maxAssetPoints?b.maxAssetPoints:100,b.defaultcenter=b.defaultcenter?b.defaultcenter:"40.7053111,-74.258188",b.trackedAsset=b.trackedAsset?b.trackedAsset:null,
b.clusterStyles=b.clusterStyles?b.clusterStyles:[],b.geofenceManager=!!b.geofenceManager&&b.geofenceManager,a.$parent.summaryIcons={},b.summaryIcons&&angular.forEach(b.summaryIcons,function(b,c){a.$parent.summaryIcons[c]=d.trustAsHtml(b)}),b.trackedAsset?(b.showDetailedMap=!0,b.clusteredView=!1):b.showDetailedMap=!1,b.clusteredView?(b.clusteredZoomMax||(b.clusteredZoomMax=11),b.detailedZoomMin=b.clusteredZoomMax<20?b.clusteredZoomMax+1:b.clusteredZoomMax,b.clusterZoom||(b.clusterZoom=3)):(b.detailedZoomMin||(b.detailedZoomMin=0),b.detailedmapzoom=b.detailedZoomMin),(!b.focusedMarkerZoom||b.clusteredView&&b.focusedMarkerZoom<b.clusteredZoomMax)&&(b.focusedMarkerZoom=b.detailedZoomMin<18?b.detailedZoomMin+3:b.detailedZoomMin),b.selectedTrackedAsset&&(b.showDetailedMap=!0,b.detailedmapzoom=b.detailedZoomMin),m(),b.sourcesInfo=b.sourcesInfo,b.markerInfoWindow=void 0===b.markerInfoWindow||b.markerInfoWindow,a.$on("mapFoucsOnMarker",function(a,c){b.focusOnAsset(c)}),a.$on("mapInitialized",function(a,c){b.map=c,1==b.switchStatus&&b.heatmap?(heatmap=new google.maps.visualization.HeatmapLayer({data:_.toArray(b.heatMap),radius:b.heatMapRadius,gradient:b.heatMapGradient,opacity:b.heatMapOpacity}),heatmap.setMap(b.map)):"undefined"!=typeof heatmap&&heatmap.setMap(null),b.selectedTrackedAsset&&1==b.showDetailedMap&&f(function(){b.selectedTrackedMarker&&b.showAssetInfo(null,b.selectedTrackedMarker,b.selectedTrackedMarker.assetKey,b.selectedTrackedMarker.tripKey,b.selectedTrackedMarker.id)},1e3)})},this.$onDestroy=function(){l.msgTag&&k.unsubscribe(l.msgTag,null,a.$id),console.log("destory Map")};l.sources={},l.assets={},l.selectedAsset="all",l.markerClusterer=null,l._hiddenAssets={},l.assetsKeys=[],l.mapcenter=null,l.infoWindow=null,l.dynMarkers={},l.heatMap={},l.heatMapRadius=l.heatMapRadius?l.heatMapRadius:40,l.heatMapOpacity=l.heatMapOpacity?l.heatMapOpacity:.8,l.heatMapGradient=l.heatMapGradient?l.heatMapGradient:["rgba(0, 255, 255, 0)","rgba(0, 255, 255, 1)","rgba(0, 191, 255, 1)","rgba(0, 127, 255, 1)","rgba(0, 63, 255, 1)","rgba(0, 0, 255, 1)","rgba(0, 0, 223, 1)","rgba(0, 0, 191, 1)","rgba(0, 0, 159, 1)","rgba(0, 0, 127, 1)","rgba(63, 0, 91, 1)","rgba(127, 0, 63, 1)","rgba(191, 0, 31, 1)","rgba(255, 0, 0, 1)"];var m=function(){k.onReady.then(function(){l.api&&(l.apiParams=l.apiParams?l.apiParams:{},k.call(l.api,l.apiParams).then(function(a,b){l.processAssets(a),console.log("api call "+l.api+" response returned",a)},function(a){l.callError=JSON.stringify(error),console.log("api call "+l.apiParams+" reject call promise",a)})),l.msgTag&&k.subscribe(l.msgTag,l.processAssets,a.$id)}),l.assetsData?(console.log("static assets data",l.assetsData),l.processAssets(l.assetsData)):l.data&&(console.log("static assets data",l.data),l.processAssets(l.data))};l.processAssets=function(a){l.onFormatData&&"function"==typeof l.onFormatData()&&(a=l.onFormatData()(a));var b=a,c=function(a){if(l.trackedAsset&&l.trackedAsset!=b)a.hasOwnProperty(l.trackedAsset)&&l.pushAssets(l.trackedAsset,a[l.trackedAsset]);else for(var b in a)a.hasOwnProperty(b)&&(console.log(b,a[b]),l.pushAssets(b,a[b]));l.renderAssets(),l.clusteredView&&!l.trackedAsset&&l.renderClusterer()};!l.clusteredView||l.markerClusterer||l.trackedAsset?c(b):i.getMap({id:"clustered-"+l.$wdgid}).then(function(a){l.markerClusterer||l.buildClusterer(a),c(b)})},l.activateHeatMap=function(a){1==a?(heatmap=new google.maps.visualization.HeatmapLayer({data:_.toArray(l.heatMap),radius:l.heatMapRadius,gradient:l.heatMapGradient,opacity:l.heatMapOpacity}),heatmap.setMap(l.map)):"undefined"!=typeof heatmap&&heatmap.setMap(null)},l.buildClusterer=function(a){console.log(l.clusterStyles),l.markerClusterer=new MarkerClusterer(a,_.toArray(l.dynMarkers),{maxZoom:l.clusteredZoomMax,imagePath:"https://cdn.rawgit.com/googlemaps/js-marker-clusterer/gh-pages/images/m",minimumClusterSize:-1,gridSize:50,averageCenter:!0,styles:l.clusterStyles})};var n=function(){l.selectedAsset="all",l.renderAssets()};l.renderAssets=function(){console.log("Render New Assets."),"all"==l.selectedAsset?l.showAllAssets():(l.displayedAssets={},l.displayedAssets[l.selectedAsset]=l.assets[l.selectedAsset])},l.renderClusterer=function(){console.log("Render clusterer."),l.markerClusterer.resetViewport(!0),l.markerClusterer.clearMarkers(),l.markerClusterer.addMarkers(_.toArray(l.dynMarkers),!1),l.markerClusterer.repaint()},l.showAllAssets=function(){l.displayedAssets=angular.copy(l.assets,{})},l.onClusteredZoomChanged=function(){l.trackedAsset||i.getMap({id:"clustered-"+l.$wdgid}).then(function(a){l.map=a,a.getZoom()>=l.detailedZoomMin?(l.showDetailedMap=!0,l.mapcenter=a.getCenter(),l.detailedmapzoom=l.detailedZoomMin):(l.showDetailedMap=!1,l.markerClusterer&&l.markerClusterer.setMap(a),n())})},l.onDetailedZoomChanged=function(){l.trackedAsset||1!=l.clusteredView||i.getMap({id:"detailed-"+l.$wdgid}).then(function(a){l.map=a,a.getZoom()<=l.clusteredZoomMax?(l.showDetailedMap=!1,l.clusterZoom=l.clusteredZoomMax,n()):l.showDetailedMap=!0})},l.pushAssets=function(a,b){var c=b.source,d=c+"_"+a,e=null;if(l.assets[d]){var f=l.assets[d].markers;e=f[f.length-1]}else l.instantiateAsset(d),l.assets[d].pathColor=q();var g=null,h=null,i=b.order;if(i)for(var k=i.length-1;k>=0;k--){var m=i[k];if(b.hasOwnProperty(m))for(var n=b[m],r=q(),s=q(),t=n.length-1;t>=0;t--){var u=n[t],v={position:u.lat.value+","+u.long.value};v.title="Source: "+c+", Asset: "+a+", trip: "+m+".",v.source=c,v.assetId=a,v.assetKey=d,v.tripKey=m,v.details=u,g=v.details&&v.details.model?v.details.model.value:"",h=v.details&&v.details.make?v.details.make.value:"",v.display=p(h,g,a),e||null!=e?m==e.tripKey?(v.id=d+"-"+m+"-"+(e.pointRef+1),v.pointRef=e.pointRef+1,v.strokeColor=e.strokeColor,v.fillColor=e.fillColor,l.assets[d].markers[f.length-1].icon=o(6,.8,.8,e.strokeColor,e.fillColor)):l.assets[d].markers[f.length-1].icon=o(10,1,1,e.strokeColor,e.fillColor):(v.id=d+"-"+m+"-"+t,v.pointRef=t,v.strokeColor=r,v.fillColor=s),0==k&&0==t?(v.icon=l.sourcesInfo&&l.sourcesInfo[c]&&l.sourcesInfo[c].icon?l.sourcesInfo[c].icon:j.sourceIcon.default,l.assets[d].latestMarker=v):v.icon=0==t?o(10,1,1,r,s):o(6,.8,.8,r,s),l.setMarkerIcon&&"function"==typeof l.setMarkerIcon()&&(v=l.setMarkerIcon()(u,v)),l.controlVehicleTrips(d),l.addMarkerToMap(d,v,u),null==l.mapcenter&&(l.mapcenter=v.position)}}l.addAssetToSourceList(c,d,v.display)},l.addAssetToSourceList=function(a,b,c){l.sources[a]?void 0==_.findWhere(l.sources[a],{key:b})&&l.sources[a].push({key:b,label:c}):l.sources[a]=[{key:b,label:c}]},l.addMarkerToMap=function(b,c,d){if(l.bounce&&d.bounce&&("true"==d.bounce.value||1==d.bounce.value)&&(c.animation=google.maps.Animation.BOUNCE),l.assets[b].markers.push(c),l.assets[b].path.push([d.lat.value,d.long.value]),l.selectedTrackedAsset==c.assetId&&(l.selectedTrackedMarker=c),l.selectedAsset==b&&(a.$parent.marker=c),!l.trackedAsset){var e=angular.copy(c,{});e.position=new google.maps.LatLng(d.lat.value,d.long.value);var f=new google.maps.Marker(e);l.dynMarkers[b]=f;var g={};g.location=e.position,g.weight=l.heatMapWeight?l.heatMapWeight:40,l.heatMap[b]=g}},l.controlVehicleTrips=function(a){l.maxAssetPoints&&l.assets[a].markers.length>=l.maxAssetPoints&&(l.assets[a].markers.shift(),l.assets[a].path.shift())},l.instantiateAsset=function(a){l.assets[a]={markers:[],path:[],pathColor:"",latestMarker:{},strokeOpacity:l.pathStrokeOpacity,strokeWeight:l.pathStrokeWeight,pathIcon:[{icon:{path:"M 0,-1 0,1",strokeOpacity:1,scale:4},offset:"0",repeat:"20px"}]}};var o=function(a,b,c,d,e){return{path:google.maps.SymbolPath.CIRCLE,fillOpacity:b,strokeWeight:c,scale:a,strokeColor:d,fillColor:e}},p=function(a,b,c){var d=a?a+" ":"";return d+=b?b+"-":"",d+=c};l.focusOnAsset=function(a,b){l.onSelectAsset&&"function"==typeof l.onSelectAsset()&&l.onSelectAsset()(b),l.selectedAsset=a,console.log("selectedAsset",l.selectedAsset),console.log("markerInfoWindow",l.markerInfoWindow),l.showDetailedMap=!0,null!=l.infoWindow&&l.infoWindow.close(),"all"==l.selectedAsset?(l.detailedmapzoom=l.detailedZoomMin,l.searchText=""):(l.searchText=l.assets[a].latestMarker.display,l.mapcenter=l.assets[l.selectedAsset].latestMarker.position,l.detailedmapzoom=l.focusedMarkerZoom)},l.showAssetInfo=function(b,c,d,e,f){console.log("Show assetInfo assetKey",d),l.selectedAsset=d,l.focusOnAsset(d,c);var g=b?this:null;console.log("self.$wdgid",l.$wdgid),i.getMap({id:"detailed-"+l.$wdgid}).then(function(d){a.$parent.marker=c,g=g||_.findWhere(d.markers,{data:c.assetKey});var e="infoWindowTemplate_"+a.$parent.marker.source;if(console.log("Info window",e),console.log("self.markerInfoWindow",l.markerInfoWindow),console.log("$scope.map.infoWindows",d.infoWindows),a.map=d,l.markerInfoWindow)if(a.map.infoWindows[e])a.map.showInfoWindow(b,e,g),l.infoWindow=a.map.infoWindows[e];else if(l.customDefaultInfoWindow&&a.map.infoWindows[l.customDefaultInfoWindow])a.map.showInfoWindow(b,l.customDefaultInfoWindow,g),l.infoWindow=a.map.infoWindows[l.customDefaultInfoWindow];else{a.marker=c;var e="infoWindowTemplate_default_"+l.$wdgid;a.map.showInfoWindow(b,e,g),l.infoWindow=a.map.infoWindows[e]}})};var q=function(){var a=Math.floor(16777215*Math.random()).toString(16);return r("#"+a,0)},r=function(a,b){var c=parseInt(a.slice(1),16),d=b<0?0:255,e=b<0?-1*b:b,f=c>>16,g=c>>8&255,h=255&c;return"#"+(16777216+65536*(Math.round((d-f)*e)+f)+256*(Math.round((d-g)*e)+g)+(Math.round((d-h)*e)+h)).toString(16).slice(1)};l.isEmptyObject=function(a){return 0==Object.keys(a).length},l.assetsFences=[],l.drawingControl=["rectangle"],l.drawingOptions={position:"TOP_CENTER",drawingModes:["rectangle"]},l.overlaySettings={fillColor:"#444",fillOpacity:.2,strokeWeight:3,strokeColor:"#ff8c00",clickable:!0,zIndex:1,editable:!0},l.setupDrawingManager=function(){l.assetsFences=[],a.invoke("telematics/api/getVehicleGeofence",{vehicleId:l.selectedAsset},"main-getgeofence_"+l.selectedAsset),t()},l.drawGeofence=function(a){null!=a?i.getMap({id:"detailed-"+l.$wdgid}).then(function(b){var c={};c.fillColor=l.overlaySettings.fillColor,c.fillOpacity=l.overlaySettings.fillOpacity,c.strokeWeight=l.overlaySettings.strokeWeight,c.strokeColor=l.overlaySettings.strokeColor,c.clickable=l.overlaySettings.clickable,c.zIndex=l.overlaySettings.zIndex,c.editable=l.overlaySettings.editable,c.map=b,c.bounds=JSON.parse(a);var d=new google.maps.Rectangle(c);l.assetsFences.push({assetId:l.selectedAsset,thissetFence:d})}):s(),$('[data-toggle="tooltip"]').tooltip(),$(".gmnoprint").each(function(){newObj=$(this).find("[title='Stop drawing']"),newObj.attr("class","btnStop"),newObj=$(this).find("[title='Draw a rectangle']"),newObj.attr("id","btnRectangle")})};var s=function(){l.drawingOptions={position:"TOP_CENTER",drawingModes:["rectangle"]}},t=function(){l.drawingOptions={position:"TOP_CENTER",drawingModes:[]}};l.onMapOverlayCompleted=function(a){t(),l.assetsFences.push({assetId:l.selectedAsset,assetFence:a.overlay}),l.drawingMessagesTimeout&&f.cancel(l.drawingMessagesTimeout),l.drawingMessages="Do not forget to save your geofence before selecting another vehicle.",l.drawingMessagesTimeout=f(function(){l.drawingMessages=null},5e3)},l.focusVehicle=function(){l.selectedAsset&&(l.mapcenter=l.assets[l.selectedAsset].latestMarker.position)},l.drawingMessages=null,l.drawingMessagesTimeout=null,l.focusGeofence=function(){var a=_.findWhere(l.assetsFences,{assetId:l.selectedAsset});a?l.mapcenter=a.assetFence.getBounds().getCenter():(l.drawingMessagesTimeout&&f.cancel(l.drawingMessagesTimeout),l.drawingMessages="No geofence has been defined yet for selected vehicle.",l.drawingMessagesTimeout=f(function(){l.drawingMessages=null},5e3))},l.removeGeofence=function(){var b=_.findWhere(l.assetsFences,{assetId:l.selectedAsset});b&&(l.assetsFences=_.without(l.assetsFences,b),a.invoke("telematics/api/removeVehicleGeofence",{vehicleId:l.selectedAsset},"main-removegeofence_"+l.selectedAsset),b.assetFence.setMap(null)),s()},l.hideAllGeofences=function(){_.every(l.assetsFences,function(a){return a.assetFence.setMap(null),!0})},l.saveGeofence=function(){var b=_.findWhere(l.assetsFences,{assetId:l.selectedAsset});b&&a.invoke("telematics/api/saveVehicleGeofence",{vehicleId:l.selectedAsset,bounds:JSON.stringify(b.assetFence.getBounds())},"main-savegeofence_"+l.selectedAsset)}}]}).constant("defaultConstants",{sourceIcon:{default:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAoCAMAAAA1+gEjAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM5Q0JGQjdENzVBNTExRTY4RDczRThCNDhCQkVDQ0REIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM5Q0JGQjdFNzVBNTExRTY4RDczRThCNDhCQkVDQ0REIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MzlDQkZCN0I3NUE1MTFFNjhENzNFOEI0OEJCRUNDREQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MzlDQkZCN0M3NUE1MTFFNjhENzNFOEI0OEJCRUNDREQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4YqnkxAAAAY1BMVEUAAAD///8fitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitIfitItkdU7mdhJoNpXp91ztuOBveaPxemdzOur0+652vHH4vTV6ffj8Pnx+Pz////2ehAtAAAAEXRSTlMAABAgMEBQYHCAj5+vv8/f7/4ucL8AAAFeSURBVBgZfcEBYqIwFEXRP1FBEUtuVEAa5O1/lY0iFrTOOfaU7Stuqn1mL9zO88vvnM1sKpaqjT3l3NTdVdK1q7nJ7SEnqa+aXGuS3O4yIHxr7jsAmSXOQ+i11AfwzswKIOpVBAozB9RKYmAUopIacLYFBiWnYxwdz0oGYGsHqJX0dBp19EpqOJiHTknNoNFAraQDb0CU1DDXSIqAAZJ6QsOkCfSSAAMGKdLqxOikligNgAFRioQTk1MgShGwEi5SZClKFzhYDmcpshSlM2zNeYiSoNWoBUkRWJnt4SwpcNHoQpB0htLMVkArXaMm8Sq1wMaSPdBpqQMOdrPyQKO5hmRjdzuSY6dJdyQ52MhV3IS6izF2deBuZQ8b3hX2VPLKO3tynheZzWQslbZQMOdXtuAqZrb2Ys2v0t5smXhn70oeMvuD++KusD+tPcmXfZADfm2fFJDZZ2VhC//+5wfrMULZDg3JQwAAAABJRU5ErkJggg=="}}}),agGrid.initialiseAgGridWithAngular1(angular),angular.module("Grid",["agGrid","ui.bootstrap"]),angular.module("Grid").component("scriptrGrid",{bindings:{onLoad:"&onLoad",columnsDefinition:"<columnsDefinition",rowHeight:"<?",enableServerSideSorting:"<?",enableServerSideFilter:"<?",refreshOnEdit:"<?",enableColResize:"<?",pagination:"@",enableDeleteRow:"<?",fixedHeight:"<?",enableAddRow:"<?",cellEditable:"<?",enableClientSideSorting:"<?",api:"@",onInsertRowScript:"@",onDeleteRowScript:"@",transport:"@",enableClientSideFilter:"<?",rowModelType:"@",rowModelSelection:"@",rowDeselection:"<?",onSelectionChanged:"&?",rowData:"<?",suppressFilter:"<?",gridHeight:"@",paginationPageSize:"<?",paginationOverflowSize:"<?",maxConcurrentDatasourceRequests:"<?",paginationInitialRowCount:"<?",maxPagesInCache:"<?",apiParams:"<?",deleteParams:"<?",addParams:"<?",editParams:"<?",onFormatData:"&",onCellValueChanged:"&",onCellClicked:"&",msgTag:"@",class:"@",defaultCellRenderer:"&",onGridReady:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/grid/grid.html",controller:["$scope","$window","$uibModal","$timeout","wsClient","dataStore",function(a,b,c,d,e,f){var g=this;g.broadcastData=null,this.dataSource={getRows:function(a){if(null!=g.broadcastData){if(null!=g.broadcastData.api)var b=g.broadcastData.api;else var b=g.api;if(null!=g.broadcastData.params&&(g.apiParams=g.broadcastData.params),null!=g.broadcastData.transport)var c=g.broadcastData.transport;else var c=g.transport}else var b=g.api,c=g.transport;var d=g.buildParams(a),e=null;"function"==typeof g.onFormatData()&&(e=function(a){return g.onFormatData()(a)}),f.getGridData(b,d,c,e).then(function(b,c){if(b&&b.documents){var d=b.documents,e=parseInt(b.count),f=g.cleanRows(d);if(a.successCallback(f,e),g.gridOptions.api.sizeColumnsToFit(),null==f||0==f.length){g.gridOptions.api.showNoRowsOverlay();angular.element(document.querySelector("#btNext")).attr("disabled","true")}else g.gridOptions.api.hideOverlay()}else a.failCallback(),g.gridOptions.api.showNoRowsOverlay()},function(a){console.log("reject",a)})}},this.$onDestroy=function(){g.msgTag&&e.unsubscribe(g.msgTag,null,a.$id),console.log("destory Grid")},this.cleanRows=function(a){Array.isArray(a)||(a=[a]);for(var b=!1,c=0;c<a.length;c++)for(row in a[c])if("key"!=row){b=!1;for(var d=0;d<g.gridOptions.columnDefs.length;d++)if(row==g.gridOptions.columnDefs[d].field){b=!0;break}b||delete a[c][row]}return a},this._createNewDatasource=function(){this.gridOptions.api.setDatasource(this.dataSource)},this.$onInit=function(){this.gridOptions={angularCompileRows:!0,rowHeight:this.rowHeight?this.rowHeight:25,enableSorting:void 0===this.enableClientSideSorting||this.enableClientSideSorting,enableServerSideSorting:void 0===this.enableServerSideSorting||this.enableServerSideSorting,enableServerSideFilter:void 0===this.enableServerSideFilter||this.enableServerSideFilter,enableColResize:void 0!==this.enableColResize&&this.enableColResize,enableFilter:!0,columnDefs:this.columnsDefinition,editType:"fullRow",pagination:void 0!==this.pagination&&this.pagination,cacheBlockSize:this.paginationPageSize?this.paginationPageSize:50,rowData:this.rowData?this.rowData:null,rowModelType:this.api?"infinite":"",rowSelection:this.rowModelSelection?this.rowModelSelection:"multiple",paginationPageSize:this.paginationPageSize?this.paginationPageSize:50,overlayLoadingTemplate:'<span class="ag-overlay-loading-center"><i class="fa fa-spinner fa-spin fa-fw fa-2x"></i> Please wait while your rows are loading</span>',defaultColDef:{filterParams:{apply:!0},suppressFilter:void 0!==this.suppressFilter&&this.suppressFilter,editable:void 0===this.cellEditable||this.cellEditable,cellRenderer:"function"==typeof this.defaultCellRenderer()?this.defaultCellRenderer():null},onSelectionChanged:function(){if(null!=g.onSelectionChanged&&"function"==typeof g.onSelectionChanged())return g.onSelectionChanged()(g.gridOptions,g.gridApi)},onCellClicked:function(){if(null!=g.onCellClicked&&"function"==typeof g.onCellClicked())return g.onCellClicked()(g.gridOptions,g.gridApi)},onRowValueChanged:function(a){g.cellEditable&&(null!=g.onCellValueChanged&&"function"==typeof g.onCellValueChanged()&&g.onCellValueChanged()(g.gridOptions),"infinite"==g.gridOptions.rowModelType&&(g.api?(g.gridOptions.api.showLoadingOverlay(),g._saveData(a)):(g.undoChanges(),g.showAlert("danger","No script defined for cell edit"))))},onGridReady:function(a){if(console.log("the grid is now ready"),d(function(){g.gridOptions.api=a.api,g.gridApi=a.api},3e3),"function"==typeof g.onGridReady()&&g.onGridReady()(g),a.api.filterManager.availableFilters.text.CONTAINS="startsWith",void 0===g.rowData||null==g.rowData||g.rowData&&0==g.rowData.length?g.api?g._createNewDatasource():a.api.setRowData([]):a.api.sizeColumnsToFit(),this.columnsDefinition)for(var b=0;b<this.columnsDefinition.length;b++)this.columnsDefinition[b].hasOwnProperty("type")&&"numeric"==this.columnsDefinition[b].type&&(this.columnsDefinition[b].filter="number")},onGridSizeChanged:function(a){g.gridOptions.api.sizeColumnsToFit()}},this.fixedHeight=void 0===this.fixedHeight||this.fixedHeight,this.style={},this.fixedHeight?(this.gridHeight=this.gridHeight?this.gridHeight:"500",this.style.height=this.gridHeight,this.style.clear="left",this.style.width="100%"):this.style.height="77%",this.refreshOnEdit=void 0!==this.refreshOnEdit&&this.refreshOnEdit,this.transport=this.transport?this.transport:"wss",this.enableDeleteRow=1!=this.enableDeleteRow,this.enableAddRow=1!=this.enableAddRow,this.mode="infinite"==this.gridOptions.rowModelType?"infinite":"normal",g.msgTag&&f.subscribe(this.onServerCall,g.msgTag,a),a.$on("updateGridData",function(a,b){g.broadcastData=b,g._createNewDatasource()})},this.closeAlert=function(){this.show=!1},this.showAlert=function(a,b){g.message={type:a,content:b},g.showError=!0,d(function(){g.showError=!1},5e3)},this._saveData=function(a){if(a.data&&a.data.key){var b=a.data;if(b.action="edit",this.editParams)for(var c in this.editParams)b[c]=this.editParams[c];f.gridHelper(g.api,b).then(function(a,b){g.gridOptions.api.hideOverlay(),!a||"success"!=a.result&&"success"!=a.status?(g.undoChanges(),a&&a.errorDetail?g.showAlert("danger",a.errorDetail):g.showAlert("danger","An error has occured")):g.refreshOnEdit&&g.onServerCall(a)},function(a){g.gridOptions.api.hideOverlay(),console.log("reject",a),g.showAlert("danger","An error has occured")})}else{var b=a.data;if(b.action="add",this.addParams)for(var c in this.addParams)b[c]=this.addParams[c];f.gridHelper(g.api,a.data).then(function(a,b){g.gridOptions.api.hideOverlay(),!a||"success"!=a.result&&"success"!=a.status?(g.undoChanges(),a&&a.errorDetail?g.showAlert("danger",a.errorDetail):g.showAlert("danger","An error has occured")):g.refreshOnEdit&&g.onServerCall(a)},function(a){g.gridOptions.api.hideOverlay(),console.log("reject",a),g.showAlert("danger","An error has occured")})}},this.onAddRow=function(){for(var a={},b=0;b<g.gridOptions.columnDefs.length;b++)a[g.gridOptions.columnDefs[b].field]="";g.gridOptions.api.insertItemsAtIndex(0,[a]),g.gridOptions.api.setFocusedCell(0,g.gridOptions.columnDefs[0].field),g.gridOptions.api.startEditingCell({rowIndex:0,colKey:g.gridOptions.columnDefs[0].field,charPress:g.gridOptions.columnDefs[0].field})},this.openConfirmationPopUp=function(){if(g.gridOptions.api.getSelectedNodes().length>0){c.open({animation:!0,component:"deleteConfirmation",size:"md",resolve:{grid:function(){return g}}})}},this.onRemoveRow=function(a){if("infinite"==g.gridOptions.rowModelType)if(g.api){for(var b=g.gridOptions.api.getSelectedNodes(),c=[],d=0;d<b.length;d++)c.push(b[d].data.key);if(c.length>0){g.gridOptions.api.showLoadingOverlay();var e={keys:c,action:"delete"};if(this.deleteParams)for(var a in this.deleteParams)e[a]=this.deleteParams[a];f.gridHelper(g.api,e).then(function(a,b){g.gridOptions.api.hideOverlay(),!a||"success"!=a.result&&"success"!=a.status?a&&a.errorDetail?g.showAlert("danger",a.errorDetail):g.showAlert("danger","An error has occured"):g.onServerCall(a)},function(a){g.gridOptions.api.hideOverlay(),console.log("reject",a),g.showAlert("danger","An error has occured")})}}else g.showAlert("danger","No script defined for delete row");else{var b=g.gridOptions.api.getSelectedNodes();g.gridOptions.api.removeItems(b)}},this.onServerCall=function(a){g.gridOptions.api.refreshInfiniteCache()},this.undoChanges=function(a){if(g.oldEditedValue){g.gridOptions.api.forEachNode(function(a){a.childIndex!=g.editedChildIndex&&a.id!=g.editedChildIndex||a.setSelected(!0,!0)});g.gridOptions.api.getSelectedNodes()[0].data[g.editedColumn]=g.oldEditedValue,g.gridOptions.api.refreshView()}else g.gridOptions.api.refreshInfiniteCache()},this.onFilterChanged=function(){this.gridOptions.enableServerSideFilter=!1,this.gridOptions.api.setQuickFilter(this.quickFilterValue),this.gridOptions.enableServerSideFilter=!0},this.onServerFilterChanged=function(){g._createNewDatasource()},this.buildParams=function(a){var b=g.serverFilterText,c=null,d=a.endRow/this.gridOptions.paginationPageSize;if(a.sortModel&&a.sortModel.length>0){var e=a.sortModel[0].sort,f=a.sortModel[0].colId;c=this.gridOptions.api.getColumnDef(f).type?this.gridOptions.api.getColumnDef(f).type:null}if(a.filterModel)for(p in a.filterModel){b=a.filterModel[p].filter;var h=a.filterModel[p].type,i=p;c=this.gridOptions.api.getColumnDef(i).type?this.gridOptions.api.getColumnDef(i).type:null}var j={resultsPerPage:this.gridOptions.paginationPageSize,pageNumber:d};if(f&&(j.sortingColumnName=f),i&&(j.filterColumnName=i),e&&(j.sort=e),c&&(j.sortType=c),b&&(j.queryFilter=b),h&&(j.queryType=h),j.startRow=a.startRow,j.endRow=a.endRow,this.apiParams)for(var k in this.apiParams)j[k]=this.apiParams[k];return j}}]}),angular.module("Grid").service("dataStore",["httpClient","wsClient","$q",function(a,b,c){this.subscribe=function(a,c,d){b.onReady.then(function(){b.subscribe(c,a.bind(self),d.$id)})},this.gridHelper=function(b,d){var e=c.defer();return a.get(b,d,"grid").then(function(a,b){e.resolve(a,b)},function(a){e.reject(a)}),e.promise},this.getGridData=function(d,e,f,g){var h=c.defer();return"https"==f?(a.get(d,e).then(function(a,b){if(g&&(a=g(a)),a&&a.documents){var a={documents:a.documents,count:a.count};h.resolve(a,b)}else h.resolve(null,b)},function(a){h.resolve(null),h.reject(a)}),h.promise):"wss"==f?d&&void 0!==d?(b.onReady.then(function(){b.call(d,e,"grid").then(function(a,b){if(g&&(a=g(a)),a&&a.documents){var a={documents:a.documents,count:a.count};h.resolve(a,b)}else h.resolve(null,b)},function(a){h.resolve(null),h.reject(a)})}),h.promise):(b.onReady.then(function(){b.publish(e,"publish").then(function(a,b){if(a&&a.documents){var a={documents:a.documents,count:a.count};h.resolve(a,b)}else h.resolve(null,b)},function(a){h.resolve(null),h.reject(a)})}),h.promise):void 0}}]),angular.module("Grid").component("deleteConfirmation",{bindings:{resolve:"<",close:"&",dismiss:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/grid/popup.html",controller:["$scope",function(a){this.onSubmit=function(){this.resolve.grid.onRemoveRow(),this.close({$value:!0})},this.onCancel=function(){this.dismiss({$value:!1})}}]}),angular.module("List",["angucomplete-alt"]).component("scriptrAutocomplete",{bindings:{id:"@",objects:"<?",hideObjects:"<?",listSelectedObject:"<?",defaultSetObject:"<?",placeholder:"@",maxlength:"@",pause:"@",selectedObject:"<?",selectedObjectData:"<?",titleField:"@",descriptionField:"@",imageField:"@",minlength:"@",inputName:"@",inputClass:"@",matchClass:"@",localData:"<?",searchFields:"@",clearSelected:"@",overrideSuggestions:"@",fieldRequired:"@",fieldRequiredClass:"@",textSearching:"@",textNoResults:"@",initialValue:"@",inputChanged:"&",autoMatch:"@",focusIn:"&",focusOut:"&",disableInput:"@",focusFirst:"@",fieldTabindex:"@",parseInput:"&",localSearch:"&",transport:"@",msgTag:"@",api:"@",onFormatData:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/list/autocomplete.html",controller:["$scope","wsClient","httpClient",function(a,b,c){var d=this;this.$onInit=function(){this.localData=this.localData?this.localData:[],this.fieldRequired=void 0!==this.fieldRequired&&this.fieldRequired,this.textSearching=void 0!==this.textSearching&&this.textSearching,this.transport=this.transport?this.transport:"wss",this.objects=this.objects?this.objects:[],this.listSelectedObject&&this.objects.length>0&&!d.api&&(a.$broadcast("angucomplete-alt:setData",d.id,this.localData),a.$broadcast("angucomplete-alt:setSelectedObjects",d.id,this.objects)),d.api&&(d.showList=!1,e(this.transport))},d.addObjectToList=function(b){a.$broadcast("angucomplete-alt:addObjectToList",d.id,b),0==this.objects.length&&void 0!==this.defaultSetObject&&(this.objects=JSON.parse(JSON.stringify(this.defaultSetObject)))};var e=function(a){"wss"==a?b.onReady.then(function(){b.subscribe(d.msgTag,d.consumeData.bind(d)),d.api&&b.call(d.api,d.apiParams,d.msgTag).then(function(a,b){d.consumeData(a)})}):"https"==a&&d.api&&c.get(d.api,d.apiParams).then(function(a,b){d.consumeData(a)},function(a){console.log("reject published promise",a)})};this.consumeData=function(b,c){d.showList=!0,"function"==typeof d.onFormatData()&&(b=d.onFormatData()(b)),this.localData=b,this.listSelectedObject&&this.objects.length>0&&(a.$broadcast("angucomplete-alt:setData",d.id,this.localData),a.$broadcast("angucomplete-alt:setSelectedObjects",d.id,this.objects))}}]}),angular.module("ACL",["ui.bootstrap","List"]),angular.module("ACL").component("scriptrAcl",{bindings:{users:"<?",defaultSetObject:"<?",onSave:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/ACL/ACL.html",controller:["$uibModal",function(a){var b=this;this.$onInit=function(){console.log("$onInit initialized"),b.accessType=1==b.users.length&&"anonymous"==b.users[0].code?"Anonymous access":"Restricted access"},this.$postLink=function(){console.log("$postLink initialized")},this.openModal=function(){a.open({animation:!0,size:"lg",component:"aclPopup",resolve:{widget:function(){return{parent:b,users:b.users,defaultSetObject:b.defaultSetObject,onSave:b.onSave}}}}).result.then(function(a){console.log("selectedItem: "+a)},function(){})}}]}),angular.module("ACL").component("aclPopup",{bindings:{resolve:"<",users:"<?",defaultSetObject:"<?",close:"&",dismiss:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/ACL/myModalContent.html",controller:["$scope","$sce",function(a,b){var c=this;c.listScope,this.$onInit=function(){c.users=c.resolve.widget.users,c.defaultSetObject=c.resolve.widget.defaultSetObject,c.popoverContent=b.trustAsHtml("<span style='color: #323232;'><strong>Scriptr.io provides the following predefined groups:</strong><div class='mt10 mb5'><i class='fa fa-caret-right text-primary'></i> authenticated represents anyone with a valid token.</div><div class='mb5'><i class='fa fa-caret-right text-primary'></i> anonymous represents everyone.</div><div class='mb5'><i class='fa fa-caret-right text-primary'></i> nobody represents no one.</div></span>")},this.onSelect=function(a){c.resolve.modalScope=this,"anonymous"==a.originalObject[this.titleField]&&(this.disableInput=!0,this.hideObjects=!0,c.showMsg=!0)},this.removeAnonymousAccess=function(){c.showMsg=!1,c.resolve.modalScope.disableInput=!1,c.resolve.modalScope.hideObjects=!1;var b=[{code:"anonymous",icon:"fa fa-group"}];a.$broadcast("angucomplete-alt:addObjectToList",c.id,b)},this.addAnonymousAccess=function(){c.showMsg=!1,c.resolve.modalScope.disableInput=!1,c.resolve.modalScope.hideObjects=!1;for(var b=[],d=0;d<c.resolve.modalScope.objects.length;d++)"anonymous"!=c.resolve.modalScope.objects[d].code&&b.push(c.resolve.modalScope.objects[d]);a.$broadcast("angucomplete-alt:addObjectToList",c.id,b)},this.closeAlert=function(){this.show=!1},this.showAlert=function(a,b){this.closeAlert(),this.message={type:a,content:b},this.show=!0},this.updateFileACL=function(){c.listScope||(c.listScope=a.$broadcast("angucomplete-alt:getSetObjects",c.id));var b=c.listScope.targetScope.$$childTail.$ctrl;if("function"==typeof c.resolve.widget.onSave()){var d=[];if(void 0===b.objects&&(b.objects=c.resolve.modalScope.objects),b.objects.length>0)var e=b.objects;else var e=c.resolve.widget.defaultSetObject;for(var f=0;f<e.length;f++)d.push(e[f].code);b.showList=!1,c.resolve.widget.onSave()(d).then(function(a,d){b.showList=!0,c.showAlert("success","The Access Control List is saved successfully."),c.resolve.widget.parent.users=b.objects,c.resolve.widget.parent.accessType=1==b.objects.length&&"anonymous"==b.objects[0].code?"Anonymous access":"Restricted access",console.log("success")},function(a){b.showList=!0,c.showMsg("danger",a.data.response.metadata.errorDetail),console.log("reject",a)})}},this.onCancel=function(a){this.dismiss({$value:"cancel"}),console.log("Dissmisseddd")}}]}),angular.module("angular-dygraphs",["ngSanitize"]).directive("ngDygraphs",["$window","$sce",function($window,$sce){return{restrict:"E",scope:{data:"=",options:"="},template:'<div class="ng-dygraphs"><div class="graph"></div></div>',link:function(scope,element,attrs){var parent=element.parent(),mainDiv=element.children()[0],chartDiv=$(mainDiv).children()[0],graph_initialized=!1,annotations=[],legendElement=null;scope.options.showLabelsOnHighlight?(scope.options.labelsDiv="legend_"+scope.$id,div=document.createElement("div"),div.id="legend_"+scope.$id,div.classList.add("dygraphs-legend"),mainDiv.appendChild(div),chartDiv.classList.add("with-legend"),scope.options.labelsDiv="legend_"+scope.$id):$("#legend_"+scope.$id).hide(),scope.options.labelsSeparateLines=!0,scope.goals=scope.options.goals,scope.goalLineColors=scope.options.goalLineColors,delete scope.options.goals,delete scope.options.goalLineColors,scope.events=scope.options.events,
scope.eventLineColors=scope.options.eventLineColors,delete scope.options.events,delete scope.options.eventLineColors,delete scope.options.legendPosition;var graph=new Dygraph(chartDiv,scope.data,scope.options);scope.$watch("data",function(){var a=scope.options;void 0===a&&(a={}),a.file=scope.data,a.underlayCallback=scope.underlayCallback,a.zoomCallback=scope.zoomCallback},!0),scope.$watch("options",function(a){graph.updateOptions(a)},!0),scope.underlayCallback=function(canvas,area,g){var goals=angular.copy(scope.goals);if(goals&&goals.length>0){for(var goalLineColors=angular.copy(scope.goalLineColors),colorsMapping={},x=0;x<goals.length;x++)goalLineColors[x]&&(colorsMapping[goals[x]]=goalLineColors[x]);goals.sort(function(a,b){return a-b});for(var x=goals.length-1;x>=0;x--){var goal=goals[x];if(colorsMapping[goal]){var splitDate=moment().valueOf(),coords=g.toDomCoords(splitDate,goal),splitX=coords[0],splitY=coords[1];canvas.fillStyle=colorsMapping[goal];var topHeight=splitY-area.y,bottomHeight=area.h-topHeight;canvas.fillRect(area.x,splitY,area.w,bottomHeight)}}}var events=eval(scope.events),eventLineColors,colorsMapping,x,x,dayOne,firstDateTime,nextDay,nextDateTime,canvas_left_x,canvas_right_x,canvas_width}}}}]),angular.module("Dygraphs",["angular-dygraphs"]),angular.module("Dygraphs").component("scriptrDygraphs",{bindings:{onLoad:"&onLoad",api:"@",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&",resize:"<?",data:"<?",legend:"<?",drawX1Axis:"@",drawYAxis:"@",drawY2Axis:"@",colors:"<?",x1AxisLabelFontSize:"@",yAxisLabelFontSize:"@",y2AxisLabelFontSize:"@",yAxisLabelsKmb:"@",y2AxisLabelsKmb:"@",x1AxisLabelWidth:"@",yAxisLabelWidth:"@",y2AxisLabelWidth:"@",x1AxisLineColor:"@",yAxisLineColor:"@",y2AxisLineColor:"@",x1AxisLineWidth:"@",yAxisLineWidth:"@",y2AxisLineWidth:"@",x1AxisTickSize:"@",yAxisTickSize:"@",y2AxisTickSize:"@",yAxisIncludeZero:"@",y2AxisIncludeZero:"@",x1AxisLabel:"@",yAxisLabel:"@",y2AxisLabel:"@",showRangeSelector:"@",rangeSelectorAlpha:"@",rangeSelectorBackgroundLineWidth:"@",rangeSelectorBackgroundStrokeColor:"@",rangeSelectorForegroundLineWidth:"@",rangeSelectorForegroundStrokeColor:"@",rangeSelectorHeight:"@",rangeSelectorPlotFillColor:"@",rangeSelectorPlotFillGradientColor:"@",rangeSelectorPlotLineWidth:"@",rangeSelectorPlotStrokeColor:"@",goals:"<?",goalLineColors:"<?",events:"<?",eventLineColors:"<?",legendPosition:"@",showLegend:"@",x1DrawGrid:"@",yDrawGrid:"@",y2DrawGrid:"@",x1GridLineColor:"@",yGridLineColor:"@",y2GridLineColor:"@",x1GridLineWidth:"@",yGridLineWidth:"@",y2GridLineWidth:"@",legendLabels:"<?",independentTicks:"@",legendMapping:"<?",customGoals:"<?",customEvents:"<?",colorsMapping:"<?",connectSeparatedPoints:"<?",drawPoints:"<?",pointSize:"<?",strokeWidth:"<?",fetchDataInterval:"@",useWindowParams:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/dygraphs/dygraphs.html",controller:["$rootScope","httpClient","wsClient","$scope","$timeout","$interval","$window","dataService",function(a,b,c,d,e,f,g,h){var i=this;this.$onInit=function(){if(this._apiParams=this.apiParams?angular.copy(this.apiParams):[],void 0===this.api&&void 0===this.msgTag&&(this.data&&0==this.data.length||null==this.data)&&(this.noResults=!0),this.options={},this.options.axes={},this.options.series={},this.drawX1Axis=!this.drawX1Axis||JSON.parse(this.drawX1Axis),this.drawYAxis=!this.drawYAxis||JSON.parse(this.drawYAxis),this.drawY2Axis=!this.drawY2Axis||JSON.parse(this.drawY2Axis),this.colors=this.colors?this.colors:["#CC5464","#FCC717","#38B9D6","#1DBC68","#E90088"],this.colorsMapping&&this.showLegend&&"true"==this.showLegend){this.colors=_.pluck(this.colorsMapping,"colors"),this.legendLabels=["x"],this.legendLabels=this.legendLabels.concat(_.pluck(this.colorsMapping,"labels")),this.legendMapping=["X"],this.legendMapping=this.legendMapping.concat(_.pluck(this.colorsMapping,"axisSelection")),this.legendUnitsMapping=_.pluck(this.colorsMapping,"unit");for(var a=1;a<this.legendLabels.length;a++)this.legendUnitsMapping[a-1]&&""!=this.legendUnitsMapping[a-1]&&(this.legendLabels[a]=this.legendLabels[a]+" ("+this.legendUnitsMapping[a-1]+")");this.legendLabels=this.legendLabels?this.legendLabels:["X","Y1","Y2","Y3","Y4"],console.log("labels",this.legendLabels),this.legendMapping=this.legendMapping?this.legendMapping:["x","y","y","y2","y2"];for(var b=0;b<this.legendLabels.length;b++){var c=this.legendLabels[b];0!=b&&"y2"==this.legendMapping[b]&&this.drawY2Axis&&(c?this.options.series[c]={axis:this.legendMapping[b]}:this.options.series["Y"+b]={axis:this.legendMapping[b]})}}this.legendLabels&&""!=this.legendLabels&&(this.options.labels=this.legendLabels),this.customGoals=this.customGoals?_.reject(this.customGoals,function(a){return""===a.goals||null==a.goals}):[],this.goalLineColors=_.pluck(this.customGoals,"goal-line-colors"),this.goals=_.pluck(this.customGoals,"goals"),this.customEvents=this.customEvents?_.reject(this.customEvents,function(a){return""===a.events||null==a.events}):[],this.eventLineColors=_.pluck(this.customEvents,"event-line-colors"),this.events=_.pluck(this.customEvents,"events"),this.x1AxisLabelFontSize=this.x1AxisLabelFontSize?JSON.parse(this.x1AxisLabelFontSize):14,this.yAxisLabelFontSize=this.yAxisLabelFontSize?JSON.parse(this.yAxisLabelFontSize):14,this.y2AxisLabelFontSize=this.y2AxisLabelFontSize?JSON.parse(this.y2AxisLabelFontSize):14,this.yAxisLabelsKmb=!!this.yAxisLabelsKmb&&JSON.parse(this.yAxisLabelsKmb),this.y2AxisLabelsKmb=!!this.y2AxisLabelsKmb&&JSON.parse(this.y2AxisLabelsKmb),this.x1AxisLabelWidth=this.x1AxisLabelWidth?JSON.parse(this.x1AxisLabelWidth):60,this.yAxisLabelWidth=this.yAxisLabelWidth?JSON.parse(this.yAxisLabelWidth):250,this.y2AxisLabelWidth=this.y2AxisLabelWidth?JSON.parse(this.y2AxisLabelWidth):50,this.x1AxisLineColor=this.x1AxisLineColor?this.x1AxisLineColor:"#000000",this.yAxisLineColor=this.yAxisLineColor?this.yAxisLineColor:"#000000",this.y2AxisLineColor=this.y2AxisLineColor?this.y2AxisLineColor:"#000000",this.showLegend=!this.showLegend||JSON.parse(this.showLegend),this.x1AxisLabel=this.x1AxisLabel?this.x1AxisLabel:"",this.yAxisLabel=this.yAxisLabel?this.yAxisLabel:"",this.y2AxisLabel=this.y2AxisLabel?this.y2AxisLabel:"",this.x1AxisLineWidth=this.x1AxisLineWidth?JSON.parse(this.x1AxisLineWidth):.3,this.yAxisLineWidth=this.yAxisLineWidth?JSON.parse(this.yAxisLineWidth):.3,this.y2AxisLineWidth=this.y2AxisLineWidth?JSON.parse(this.y2AxisLineWidth):.3,this.x1AxisTickSize=this.x1AxisTickSize?JSON.parse(this.x1AxisTickSize):3,this.yAxisTickSize=this.yAxisTickSize?JSON.parse(this.yAxisTickSize):3,this.y2AxisTickSize=this.y2AxisTickSize?JSON.parse(this.y2AxisTickSize):3,this.yAxisIncludeZero=!!this.yAxisIncludeZero&&JSON.parse(this.yAxisIncludeZero),this.y2AxisIncludeZero=!!this.y2AxisIncludeZero&&JSON.parse(this.y2AxisIncludeZero),this.showRangeSelector=!!this.showRangeSelector&&JSON.parse(this.showRangeSelector),this.rangeSelectorAlpha=this.rangeSelectorAlpha?JSON.parse(this.rangeSelectorAlpha):.6,this.rangeSelectorBackgroundLineWidth=this.rangeSelectorBackgroundLineWidth?JSON.parse(this.rangeSelectorBackgroundLineWidth):1,this.rangeSelectorBackgroundStrokeColor=this.rangeSelectorBackgroundStrokeColor?this.rangeSelectorBackgroundStrokeColor:"#808080",this.rangeSelectorForegroundLineWidth=this.rangeSelectorForegroundLineWidth?JSON.parse(this.rangeSelectorForegroundLineWidth):1,this.rangeSelectorForegroundStrokeColor=this.rangeSelectorForegroundStrokeColor?this.rangeSelectorForegroundStrokeColor:"#000000",this.rangeSelectorHeight=this.rangeSelectorHeight?JSON.parse(this.rangeSelectorHeight):40,this.rangeSelectorPlotFillColor=this.rangeSelectorPlotFillColor?this.rangeSelectorPlotFillColor:"#A7B1C4",this.rangeSelectorPlotFillGradientColor=this.rangeSelectorPlotFillGradientColor?this.rangeSelectorPlotFillGradientColor:"#FFFFFF",this.rangeSelectorPlotLineWidth=this.rangeSelectorPlotLineWidth?JSON.parse(this.rangeSelectorPlotLineWidth):1.5,this.rangeSelectorPlotStrokeColor=this.rangeSelectorPlotStrokeColor?this.rangeSelectorPlotStrokeColor:"#808FAB",this.x1DrawGrid=!this.x1DrawGrid||JSON.parse(this.x1DrawGrid),this.yDrawGrid=!this.yDrawGrid||JSON.parse(this.yDrawGrid),this.y2DrawGrid=!!this.y2DrawGrid&&JSON.parse(this.y2DrawGrid),this.x1GridLineColor=this.x1GridLineColor?this.x1GridLineColor:"#000000",this.yGridLineColor=this.yGridLineColor?this.yGridLineColor:"#000000",this.y2GridLineColor=this.y2GridLineColor?this.y2GridLineColor:"#000000",this.x1GridLineWidth=this.x1GridLineWidth?JSON.parse(this.x1GridLineWidth):.3,this.yGridLineWidth=this.yGridLineWidth?JSON.parse(this.yGridLineWidth):.3,this.y2GridLineWidth=this.y2GridLineWidth?JSON.parse(this.y2GridLineWidth):.3,this.xDrawGrid=!this.xDrawGrid||JSON.parse(this.xDrawGrid),this.independentTicks=this.independentTicks?this.independentTicks:"y-primary",this.x1AxisLabel&&""!=this.x1AxisLabel&&(this.options.xlabel=this.x1AxisLabel),this.yAxisLabel&&""!=this.yAxisLabel&&(this.options.ylabel=this.yAxisLabel),this.y2AxisLabel&&""!=this.y2AxisLabel&&(this.options.y2label=this.y2AxisLabel),this.options.yRangePad="10",this.options.axes.x={},this.options.axes.x.drawAxis=JSON.parse(this.drawX1Axis),this.options.axes.x.axisLabelFontSize=JSON.parse(this.x1AxisLabelFontSize),this.options.axes.x.axisLabelWidth=JSON.parse(this.x1AxisLabelWidth),this.options.axes.x.axisLineColor=this.x1AxisLineColor,this.options.axes.x.axisLineWidth=JSON.parse(this.x1AxisLineWidth),this.options.axes.x.axisTickSize=JSON.parse(this.x1AxisTickSize),this.options.axes.x.independentTicks=!0,this.options.axes.x.ticker=Dygraph.dateTicker,this.options.axes.x.axisLabelFormatter=function(a,b,c){return Dygraph.dateAxisLabelFormatter(new Date(a),b,c)},this.options.axes.y={},this.options.axes.y.drawAxis=JSON.parse(this.drawYAxis),this.options.axes.y.axisLabelFontSize=JSON.parse(this.yAxisLabelFontSize),$(window).innerWidth()<=480?this.options.axes.y.axisLabelWidth=40:this.options.axes.y.axisLabelWidth=JSON.parse(this.yAxisLabelWidth),this.options.axes.y.axisLineColor=this.yAxisLineColor,this.options.axes.y.axisLineWidth=JSON.parse(this.yAxisLineWidth),this.options.axes.y.axisTickSize=JSON.parse(this.yAxisTickSize),this.options.axes.y.includeZero=JSON.parse(this.yAxisIncludeZero),this.options.axes.y.labelsKMB=JSON.parse(this.yAxisLabelsKmb);this.options.digitsAfterDecimal=4;var d=function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c};this.options.axes.y.ticker=Dygraph.numericLinearTicks,this.options.axes.y.axisLabelFormatter=function(a){return d(a,4)},this.options.axes.y2={},this.options.axes.y2.drawAxis=JSON.parse(this.drawY2Axis),this.options.axes.y2.axisLabelFontSize=JSON.parse(this.y2AxisLabelFontSize),$(window).innerWidth()<=480?this.options.axes.y2.axisLabelWidth=40:this.options.axes.y2.axisLabelWidth=JSON.parse(this.yAxisLabelWidth),this.options.axes.y2.axisLineColor=this.y2AxisLineColor,this.options.axes.y2.axisLineWidth=JSON.parse(this.y2AxisLineWidth),this.options.axes.y2.axisTickSize=JSON.parse(this.y2AxisTickSize),this.options.axes.y2.includeZero=JSON.parse(this.y2AxisIncludeZero),this.options.axes.y2.labelsKMB=JSON.parse(this.y2AxisLabelsKmb),this.options.axes.y2.ticker=Dygraph.numericLinearTicks,this.options.axes.y2.axisLabelFormatter=function(a){return d(a,4)},this.options.showRangeSelector=JSON.parse(this.showRangeSelector),this.options.rangeSelectorAlpha=JSON.parse(this.rangeSelectorAlpha),this.options.rangeSelectorBackgroundLineWidth=JSON.parse(this.rangeSelectorBackgroundLineWidth),this.options.rangeSelectorBackgroundStrokeColor=this.rangeSelectorBackgroundStrokeColor,this.options.rangeSelectorForegroundLineWidth=JSON.parse(this.rangeSelectorForegroundLineWidth),this.options.rangeSelectorForegroundStrokeColor=this.rangeSelectorForegroundStrokeColor,this.options.rangeSelectorHeight=JSON.parse(this.rangeSelectorHeight),this.options.rangeSelectorPlotFillColor=this.rangeSelectorPlotFillColor,this.options.rangeSelectorPlotFillGradientColor=this.rangeSelectorPlotFillGradientColor,this.options.rangeSelectorPlotLineWidth=JSON.parse(this.rangeSelectorPlotLineWidth),this.options.rangeSelectorPlotStrokeColor=this.rangeSelectorPlotStrokeColor,this.options.colors=this.colors,this.showLegend?(this.options.showLabelsOnHighlight=!0,this.options.legend="always"):(this.options.showLabelsOnHighlight=!1,this.options.hideOverlayOnMouseOut=!0),this.options.legendPosition=this.legendPosition?this.legendPosition:"top",this.options.axes.x.drawGrid=JSON.parse(this.x1DrawGrid),this.options.axes.y.drawGrid=JSON.parse(this.yDrawGrid),this.options.axes.y2.drawGrid=JSON.parse(this.y2DrawGrid),this.options.axes.x.gridLineColor=this.x1GridLineColor,this.options.axes.y.gridLineColor=this.yGridLineColor,this.options.axes.y2.gridLineColor=this.y2GridLineColor,this.options.axes.x.gridLineWidth=JSON.parse(this.x1GridLineWidth),this.options.axes.y.gridLineWidth=JSON.parse(this.yGridLineWidth),this.options.axes.y2.gridLineWidth=JSON.parse(this.y2GridLineWidth),"y-primary"==this.independentTicks?(this.options.axes.y.independentTicks=!0,this.options.axes.y2.independentTicks=!1):"y2-primary"==this.independentTicks?(this.options.axes.y.independentTicks=!1,this.options.axes.y2.independentTicks=!0):"independent"==this.independentTicks&&(this.options.axes.y.independentTicks=!0,this.options.axes.y2.independentTicks=!0),this.options.goals=this.goals?this.goals:[],this.options.goalLineColors=this.goalLineColors?this.goalLineColors:["#ffffff"],this.options.events=this.events?this.events:[],this.options.eventLineColors=this.eventLineColors?this.eventLineColors:["#ffffff"],this.options.connectSeparatedPoints=null==this.connectSeparatedPoints||this.connectSeparatedPoints,this.options.drawPoints=null==this.drawPoints||this.drawPoints,this.options.strokeWidth=null!=this.strokeWidth?this.strokeWidth:1,this.options.pointSize=null!=this.pointSize?this.pointSize:3,this.resize=!this.resize||this.resize,this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.fetchDataInterval=this.fetchDataInterval?parseInt(this.fetchDataInterval):null,this.delta=!1,angular.element(g).on("resize",function(){$(window).innerWidth()<=480?(i.options.axes.y2.axisLabelWidth=40,i.options.axes.y.axisLabelWidth=40):(i.options.axes.y2.axisLabelWidth=JSON.parse(i.y2AxisLabelWidth),i.options.axes.y.axisLabelWidth=JSON.parse(i.yAxisLabelWidth))})},this.$postLink=function(){j(this.transport),this.data&&!this.api?(i.timeout=!1,e(function(){i.consumeData(i.data)},2e3)):i.timeout=!0,d.$watch(function(a){if(a.$ctrl.data&&1==i.timeout)return a.$ctrl.data},function(a){a&&(i.datas=a,i.noResults=!1)})},this.$onDestroy=function(){console.log("destory chart",i.msgTag,d.$id),i.msgTag&&c.unsubscribe(i.msgTag,null,d.$id),i.refreshTimer&&f.cancel(i.refreshTimer)};var j=function(a){h.getData(a,i.api,i.apiParams,i.useWindowParams,i.msgTag,i.consumeData.bind(i),i.fetchDataInterval,d.$id),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=f(function(){j(i.transport)},1e3*i.fetchDataInterval))};this.consumeData=function(a,b){console.log(a),"object"==typeof a&&a.timeZone&&(i.timeZone=a.timeZone,i.options.offset=a.timeZone,a=a.data),i.timeout=!0,"function"==typeof i.onFormatData()&&(a=i.onFormatData()(a)),a&&a.length>0&&"object"==typeof a?this.fetchDataInterval&&this.fetchDataInterval>0&&this.datas&&this.delta?this.datas=this.datas.concat(a):(this.datas=a,this.noResults=!1):this.api&&a&&0==a.length&&(!this.datas||this.datas&&0==this.datas.length)&&(this.datas=[],this.noResults=!0),console.log("datas",this.datas)}}]}),angular.module("angularPlotly",[]).directive("angularPlotly",["$window",function(a,b){return{restrict:"E",template:"<div></div>",scope:{plotlyData:"=",plotlyLayout:"=",plotlyOptions:"=",plotlyEvents:"=",plotlyManualDataUpdate:"="},link:function(b,c){function d(a){b.plotlyEvents(a)}function e(){if(!b.plotlyData)return void(h&&(Plotly.Plots.purge(g),g.innerHTML=""));h=!0,Plotly.newPlot(g,b.plotlyData,b.plotlyLayout,b.plotlyOptions),b.plotlyEvents&&d(g)}function f(){if(h&&b.plotlyData){var a=window.getComputedStyle(g).display;if(a&&"none"!==a&&h&&b.plotlyData)try{Plotly.Plots.resize(g)}catch(a){}}}var g=c[0].children[0],h=!1;b.$watch(function(a){return a.plotlyLayout},function(a,b){angular.equals(a,b)&&h||e()},!0),b.plotlyManualDataUpdate||b.$watch(function(a){return a.plotlyData},function(a,b){angular.equals(a,b)&&h||e()},!1),b.$on("tracesUpdated",function(){e()}),b.$watch(function(){return{h:c[0].offsetHeight,w:c[0].offsetWidth}},function(a,b){angular.equals(a,b)||f()},!0),angular.element(a).bind("resize",f)}}}]),angular.module("Plotly",["angularPlotly"]),angular.module("Plotly").component("scriptrThreeDSurface",{bindings:{onLoad:"&onLoad",api:"@",data:"<?",layout:"<?",options:"<?",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",title:"@",xaxis:"@",yaxis:"@",zaxis:"@",barTitle:"@",barThickness:"<?",showBar:"<?",displaylogo:"<?",showModeBar:"<?",modeBarButtonsToRemove:"<?",colorScale:"<?",contours:"<?"},templateUrl:"/UIComponents/dashboard/frontend/components/plotly/3dsurface.html",controller:["$rootScope","$scope","$window","$element","$timeout","httpClient","wsClient","_","$interval","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;k.$onInit=function(){console.log("on init started",this),k._apiParams=k.apiParams?angular.copy(k.apiParams):[],k.data=k.data?k.data:[],k.contours=k.contours?k.contours:{},k.modeBarButtonsToRemove=k.modeBarButtonsToRemove?k.modeBarButtonsToRemove:[],k.options=k.options?k.options:{displayModeBar:k.showModeBar,modeBarButtonsToRemove:k.modeBarButtonsToRemove,displaylogo:k.displaylogo},console.log(k.options),k.staticData=angular.copy(k.data),k.transformedData=angular.copy(k.data),angular.element(c).on("resize",k.scheduleResize),k.style={},k.layout=k.layout?k.layout:{autosize:!0,height:d.parent().height(),width:d.parent().width(),scene:{xaxis:{title:k.xaxis},yaxis:{title:k.yaxis},zaxis:{title:k.zaxis}},margin:{l:5,r:5,b:5,t:5}},k.transformedData=[{showscale:k.showBar,colorscale:k.colorScale,colorbar:{title:k.barTitle,thickness:k.barThickness},contours:k.contours,z:k.staticData.z,x:k.staticData.x,y:k.staticData.y,type:"surface"}],k.initDataService(k.transport)},k.resize=function(){console.log("resize called"),k.layout.height=d.parent().height(),k.layout.width=d.parent().width()},k.$postLink=function(){null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize,300),b.$watch(function(a){return a.$ctrl.data},function(a){k.data=a}),k.data&&(k.timeout=!1,e(function(){k.consumeData(k.data)},200))},k.$onDestroy=function(){angular.element(c).off("resize",k.scheduleResize),k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer)},k.scheduleResize=function(){return console.log("scheduleResize called"),null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize,100)},k.initDataService=function(a){console.log("initDataService called"),j.getData(a,k.api,k.apiParams,k.useWindowParams,k.msgTag,k.consumeData.bind(k),k.fetchDataInterval,b.$id),k.fetchDataInterval&&!k.refreshTimer&&(k.refreshTimer=i(function(){k.initDataService(k.transport)},1e3*k.fetchDataInterval))},k.consumeData=function(a,b){console.log("consumeData called",a),a&&a.x&&a.y&&a.z&&(k.transformedData=[{showscale:k.showBar,colorscale:k.colorScale,colorbar:{title:k.barTitle,thickness:k.barThickness},contours:k.contours,z:a.z,x:a.x,y:a.y,type:"surface"}],console.log("transformedData called",k.transformedData))}}]}),angular.module("Plotly").component("scriptrWindrose",{bindings:{onLoad:"&onLoad",api:"@",data:"<?",customRanges:"<?",layout:"<?",options:"<?",transport:"@",showLegend:"@",speedUnit:"@",fontSize:"@",msgTag:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/plotly/windrose.html",controller:["$rootScope","$scope","$window","$element","$timeout","httpClient","wsClient","_","$interval","dataService",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.directions=["N","NNE","ENE","E","ESE","SSE","S","SSW","WSW","W","WNW","NNW"],this.speedUnit=this.speedUnit?this.speedUnit:"m/h",this.noResults=!1,this.showSelectStream=!k.api,this.$onInit=function(){console.log("on init started"),this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.plotCustomRanges=this.customRanges&&this.customRanges.length>0?this.customRanges:[{color:"#CC5464",lo:0,hi:2},{color:"#FCC717",lo:2,hi:4},{color:"#38B9D6",lo:4,hi:6},{color:"#1DBC68",lo:6,hi:8},{color:"#E90088",lo:8,hi:10},{color:"#ffac47",lo:10,hi:20}],this.data=this.data?this.data:[],this.staticData=angular.copy(this.data),this.transformedData=angular.copy(this.data),this.showLegend=this.showLegend?this.showLegend:"true",this.fontSize=this.fontSize?this.fontSize:"12",this.layout={title:"",font:{size:this.fontSize},radialaxis:{ticksuffix:"%"},orientation:270,margin:{l:25,r:15,b:10,t:10}},this.maxRange=h.max(h.pluck(this.plotCustomRanges,"hi")),this.listOfMinRanges=h.pluck(this.plotCustomRanges,"lo"),this.listOfMaxRanges=h.pluck(this.plotCustomRanges,"hi"),this.listOfColors=h.pluck(this.plotCustomRanges,"color"),this.listOfColors.push("#10c3e0"),this.speedUnit=this.speedUnit?this.speedUnit:"",this.style={},angular.element(c).on("resize",k.scheduleResize),k.initDataService(this.transport)},k.resize=function(){console.log("resize called"),k.timeoutId=null,c.matchMedia(a.mobileBreakPoint).matches?(k.style.height="300",k.style.width=d.parent()[0].clientWidth):null==k.showLegend||"true"!=k.showLegend?(k.style.height=d.parent()[0].clientHeight,k.style.width=d.parent()[0].clientWidth):(k.style.height=d.parent()[0].clientHeight,k.style.width=d.parent()[0].clientWidth-d.find(".plotly-chart-legend").outerWidth(!0)-10,k.style.width<=0&&(k.style.width=d.parent()[0].clientWidth)),k.layout={title:"",font:{size:k.fontSize},radialaxis:{ticksuffix:"%"},orientation:270,width:k.style.width,height:k.style.height,margin:{l:25,r:15,b:10,t:10}}},this.$postLink=function(){null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize,300),b.$watch(function(a){return a.$ctrl.data},function(a){k.data=a}),this.data&&(k.timeout=!1,e(function(){k.consumeData(k.data)},200))},this.$onDestroy=function(){angular.element(c).off("resize",k.scheduleResize),console.log("destory wind rose"),k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer)},k.scheduleResize=function(){return console.log("scheduleResize called"),null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize,100)},k.initDataService=function(a){console.log("initDataService called"),j.getData(a,k.api,k.apiParams,k.useWindowParams,k.msgTag,k.consumeData.bind(k),k.fetchDataInterval,b.$id),k.fetchDataInterval&&!k.refreshTimer&&(k.refreshTimer=i(function(){k.initDataService(k.transport)},1e3*k.fetchDataInterval))},this.consumeData=function(a,b){if(console.log("consumeData called",a),h.isEqual(this.data.data,this.staticData)&&(this.data=[]),"function"==typeof this.onFormatData()&&(a=this.onFormatData()(a),console.log("data after format",a)),a&&a.data&&a.data.length>0){if(this.fetchDataInterval&&this.fetchDataInterval>0&&this.retrievedData&&this.retrievedData.length>0&&this.delta)for(var c=0;c<a.data.length;c++)this.data[c].speeds=this.data[c].speeds.concat(a.data[c].speeds),this.data[c].dates=this.data[c].dates.concat(a.data[c].dates);else this.data=a.data;a.latestDate&&(this.latestRetrievedDataDate=a.latestDate),this.buildWindRoseData()}else this.api&&0==a.length&&(!this.data||this.data&&0==this.data.length)&&(this.data=[],this.noResults=!0);console.log(this.data)},this.buildWindRoseData=function(){var a=h.pluck(k.data,"speeds");k.totalSpeeds=0;for(var b=0;b<a.length;b++)k.totalSpeeds+=a[b].length;k.speedRangeDirectionObj={};for(var b=0;b<k.listOfMinRanges.length;b++)k.speedRangeDirectionObj[k.listOfMinRanges[b]+"-"+k.listOfMaxRanges[b]]=[];k.speedRangeDirectionObj[">="+k.maxRange]=[];for(var b=0;k.data&&b<k.data.length;b++){for(var c=k.data[b].direction,d=k.data[b].speeds,e=0;e<k.plotCustomRanges.length;e++){var f=this.plotCustomRanges[e],g=h.filter(d,function(a){return a>=f.lo&&a<f.hi}).length;k.speedRangeDirectionObj[k.plotCustomRanges[e].lo+"-"+k.plotCustomRanges[e].hi].push({direction:c,percentage:g/k.totalSpeeds*100})}var i=k.maxRange,j=h.filter(d,function(a){return a>=i}).length;k.speedRangeDirectionObj[">="+k.maxRange].push({direction:c,percentage:j/k.totalSpeeds*100})}for(var l=Object.keys(k.speedRangeDirectionObj),m=Object.keys(k.speedRangeDirectionObj)[0],n=(k.speedRangeDirectionObj[m],JSON.parse(JSON.stringify(k.speedRangeDirectionObj))[m]),b=0;b<l.length;b++){var o=l[b],p=k.speedRangeDirectionObj[o];if(o!=m){for(var e=0;e<p.length;e++)n[e].percentage=p[e].percentage+n[e].percentage,0!=p[e].percentage&&(p[e].percentage=n[e].percentage);k.speedRangeDirectionObj[o]=p}}k.transformedData=[],l=Object.keys(k.speedRangeDirectionObj);for(var b=l.length-1;b>=0;b--){var q=h.pluck(k.speedRangeDirectionObj[l[b]],"percentage"),r=l[b],s=k.listOfColors[b],t={r:q,t:k.directions,name:r+" "+k.speedUnit,marker:{color:s},type:"area",showlegend:!1};k.transformedData.push(t)}}}]}),angular.module("MetricBox",[]),angular.module("MetricBox").component("scriptrMetricbox",{bindings:{value:"<?",disabled:"<?",label:"@",unit:"@",borderSize:"@",icon:"@",tag:"@",actionIcon:"@",borderColor:"@",backgroundColor:"@",valueFontFamily:"@",valueFontSize:"@",valueCellSize:"@",valueFontWeight:"@",valueTextColor:"@",valueBackgroundColor:"@",valueTextAlignment:"@",labelFontFamily:"@",labelFontSize:"@",labelFontWeight:"@",labelTextColor:"@",labelBackgroundColor:"@",labelTextAlignment:"@",unitFontFamily:"@",unitFontSize:"@",unitCellSize:"@",unitFontWeight:"@",unitTextColor:"@",unitBackgroundColor:"@",unitTextAlignment:"@",api:"@",enableResize:"<?",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&",onActionClicked:"&",fetchDataInterval:"@",useWindowParams:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/metricBox/metricBox.html",controller:["$scope","httpClient","wsClient","$element","$window","$timeout","$interval","$window","dataService",function(a,b,c,d,e,f,g,e,h){var i=this;i.isLoading=!1,this.$onInit=function(){this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.widgetLayout="vertical"==this.widgetLayout?this.widgetLayout:"horizontal",this.value=this.value?isNaN(this.value)?"0":this.value:"0",this.label=this.label?this.label:"Items",this.unit=this.unit?this.unit:"",this.actionIcon=this.actionIcon?this.actionIcon:"",this.icon=this.icon?this.icon:"",this.tag=this.tag?this.tag:"NO_TAG",this.disabled=!!this.disabled&&this.disabled,this.borderSize=this.borderSize?this.borderSize:"1",this.valueCellSize=this.valueCellSize?this.valueCellSize:"",this.borderColor=this.borderColor?this.borderColor:"#ff8c00",this.backgroundColor=this.backgroundColor?this.backgroundColor:"#d7d7d7",this.valueFontFamily=this.valueFontFamily?this.valueFontFamily:"Arial",this.valueFontSize=this.valueFontSize?this.valueFontSize:"42",this.valueFontWeight=this.valueFontWeight?this.valueFontWeight:"600",this.valueTextColor=this.valueTextColor?this.valueTextColor:"#ff8c00",this.valueTextAlignment=this.valueTextAlignment?this.valueTextAlignment:"center",this.labelFontFamily=this.labelFontFamily?this.labelFontFamily:"Arial",this.labelFontSize=this.labelFontSize?this.labelFontSize:"18",this.labelFontWeight=this.labelFontWeight?this.labelFontWeight:"600",this.labelTextColor=this.labelTextColor?this.labelTextColor:"#ff8c00",this.labelTextAlignment=this.labelTextAlignment?this.labelTextAlignment:"center",this.unitFontFamily=this.unitFontFamily?this.unitFontFamily:"Arial",this.unitFontSize=this.unitFontSize?this.unitFontSize:"42",this.unitFontWeight=this.unitFontWeight?this.unitFontWeight:"600",this.unitTextColor=this.unitTextColor?this.unitTextColor:"#ff8c00",this.unitTextAlignment=this.unitTextAlignment?this.unitTextAlignment:"center",this.enableResize=void 0===this.enableResize||this.enableResize,console.log(this),angular.element(e).on("resize",function(){return null!=i.timeoutId&&f.cancel(i.timeoutId),i.timeoutId=f(i.resize,100)}),this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.fetchDataInterval=this.fetchDataInterval?parseInt(this.fetchDataInterval):null,this.style={}},this.$postLink=function(){f(i.resize,100),null!=i.timeoutId&&f.cancel(i.timeoutId),i.timeoutId=f(i.resize,100),j(this.transport)},this.$onDestroy=function(){i.msgTag&&c.unsubscribe(i.msgTag,null,a.$id),i.refreshTimer&&g.cancel(i.refreshTimer)};var j=function(b){console.log(h),h.getData(b,i.api,i.apiParams,i.useWindowParams,i.msgTag,i.consumeData.bind(i),i.fetchDataInterval,a.$id),i.fetchDataInterval&&!i.refreshTimer&&(i.refreshTimer=g(function(){j(i.transport)},1e3*i.fetchDataInterval))};a.actionClicked=function(){console.log("actionClicked"),"function"==typeof i.onActionClicked()&&i.onActionClicked()(i.tag)},this.consumeData=function(a,b){"function"==typeof i.onFormatData()&&(a=i.onFormatData()(a)),i.value=a,"object"==typeof a&&a&&a.value&&"string"==typeof a.value&&(i.value=a.value),"string"==typeof a&&(i.value=a)}}]}),angular.module("Thermometer",["angularThermometer"]),angular.module("Thermometer").component("scriptrThermometer",{bindings:{onLoad:"&onLoad",api:"@",data:"<?",step:"<?",customSectors:"<?",outOfRangeColor:"@",ticks:"<?",percent:"@",unit:"@",height:"@",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&",fetchDataInterval:"@",useWindowParams:"@"},templateUrl:"/UIComponents/dashboard/frontend/components/thermometer/thermometer.html",controller:function(a,b,c,d,e,f,g,h,i,j){var k=this;k.showSelectStream=!k.api,this.$onInit=function(){this._apiParams=this.apiParams?angular.copy(this.apiParams):[],this.fetchDataInterval=this.fetchDataInterval?parseInt(this.fetchDataInterval):null,this.customSectors=this.customSectors&&this.customSectors.length>0?this.customSectors:[{color:"#CC5464",lo:0,hi:30},{color:"#FCC717",lo:30,hi:60},{color:"#38B9D6",lo:60,hi:90}],this.customSectors&&(this.customSectors=h.reject(this.customSectors,h.isEmpty)),this.outOfRangeColor=this.outOfRangeColor?this.outOfRangeColor:"#E90088",this.thermoUnit=this.unit?this.unit:"C",this.height=this.height?this.height:"100",this.mercuryColor=this.evaluateColor(this.value),this.step=this.step?this.step:"30";var a=this.getLowestTick(),b=this.getHighestTick(),d=parseInt(a);for(this.sectors=[],this.sectors.push(d);d<b;)d+=parseInt(this.step),this.sectors.push(d);this.sectors=this.sectors?this.sectors:[0,30,60,90],this.mercuryMax=h.max(this.sectors),this.minSectorValue=h.min(this.sectors),this.ticks=[];for(var f=0;f<this.sectors.length;f++){var g={};g.tick=this.sectors[f],g.percent=(this.sectors[f]-this.minSectorValue)*this.height/(this.mercuryMax-this.minSectorValue),this.ticks.push(g)}this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,this.useWindowParams=this.useWindowParams?this.useWindowParams:"true",this.style={},angular.element(c).on("resize",function(){return null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize,100)}),this.consumeData(this.data),l(this.transport)},k.resize=function(){k.timeoutId=null,k.style["margin-left"]=d.parent().outerWidth(!0)/2-50},this.$postLink=function(){e(k.resize,100),null!=k.timeoutId&&e.cancel(k.timeoutId),k.timeoutId=e(k.resize,100),b.$watch(function(a){return a.$ctrl.value},function(a){!isNaN(parseFloat(a))&&isFinite(a)&&(a=a>b.$ctrl.mercuryMax?b.$ctrl.mercuryMax:a,k.percent=parseInt((a-b.$ctrl.minSectorValue)*b.$ctrl.height/(b.$ctrl.mercuryMax-b.$ctrl.minSectorValue)))})},this.$onDestroy=function(){k.msgTag&&g.unsubscribe(k.msgTag,null,b.$id),k.refreshTimer&&i.cancel(k.refreshTimer)};var l=function(a){j.getData(a,k.api,k.apiParams,k.useWindowParams,k.msgTag,k.consumeData.bind(k),k.fetchDataInterval,b.$id),k.fetchDataInterval&&!k.refreshTimer&&(k.refreshTimer=i(function(){
l(k.transport)},1e3*k.fetchDataInterval))};this.consumeData=function(a,b){"function"==typeof this.onFormatData()&&(a=this.onFormatData()(a,k)),null!=a?(this.noResults=!1,this.value=parseFloat(a),this.mercuryColor=this.evaluateColor(a)):this.noResults=!0},this.evaluateColor=function(a){var b=k.outOfRangeColor;return h.some(k.customSectors,function(c){if(c.lo<=a&&a<=c.hi)return b=c.color,!0}),b},this.getLowestTick=function(){return h.min(h.pluck(this.customSectors,"lo"))},this.getHighestTick=function(){return h.max(h.pluck(this.customSectors,"hi"))}}}),angular.module("ProgressBar",["ngAnimate","ngSanitize","ui.bootstrap"]),angular.module("ProgressBar").component("scriptrProgressbar",{bindings:{onLoad:"&onLoad",value:"@",data:"@",type:"@",max:"@",title:"@",class:"@",animate:"<?",stacked:"<?",api:"@",transport:"@",msgTag:"@",apiParams:"<?",onFormatData:"&"},templateUrl:"/UIComponents/dashboard/frontend/components/progressBar/progressBar.html",controller:function(a,b,c){var d=this;this.$onInit=function(){this.value=this.value?this.value:this.data?this.data:0,this.transport=this.transport?this.transport:"wss",this.msgTag=this.msgTag?this.msgTag:null,e(this.transport)};var e=function(e){"wss"==e?c.onReady.then(function(){d.msgTag&&c.subscribe(d.msgTag,d.consumeData.bind(d),a.$id),d.api&&c.call(d.api,d.apiParams,d.msgTag).then(function(a,b){d.consumeData(a)},function(a){console.log("reject published promise",a),d.consumeData()})}):"https"==e&&d.api&&b.get(d.api,d.apiParams).then(function(a,b){d.consumeData(a)},function(a){console.log("reject published promise",a)})};this.$onDestroy=function(){console.log("destory Progress bar"),d.msgTag&&c.unsubscribe(d.msgTag,null,a.$id)},this.consumeData=function(a,b){"function"==typeof d.onFormatData()&&(a=d.onFormatData()(a)),this.value=Math.round(a)}}});